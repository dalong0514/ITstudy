I'm working on a web project that involves a dynamically generated map of the US coloring different states based on a set of data.  This SVG file gives me a good blank map of the US and is very easy to change the color of each state.  The difficulty is that IE browsers don't support SVG so in order for me to use the handy syntax the svg offers, I'll need to convert it to a JPG.  Ideally, I'd like to do this with only the GD2 library but could also use ImageMagick.  I have absolutely no clue how to do this.  Any solution that would allow me to dynamically change the colors of states on a map of the US will be considered.  The key is that it is easy to change the colors on the fly and that it is cross browser.  PHP/Apache solutions only, please.

2011-01-26 19:42:17Z

I'm working on a web project that involves a dynamically generated map of the US coloring different states based on a set of data.  This SVG file gives me a good blank map of the US and is very easy to change the color of each state.  The difficulty is that IE browsers don't support SVG so in order for me to use the handy syntax the svg offers, I'll need to convert it to a JPG.  Ideally, I'd like to do this with only the GD2 library but could also use ImageMagick.  I have absolutely no clue how to do this.  Any solution that would allow me to dynamically change the colors of states on a map of the US will be considered.  The key is that it is easy to change the colors on the fly and that it is cross browser.  PHP/Apache solutions only, please.That's funny you asked this, I just did this recently for my work's site and I was thinking I should write a tutorial... Here is how to do it with PHP/Imagick, which uses ImageMagick:the steps regex color replacement may vary depending on the svg path xml and how you id & color values are stored. If you don't want to store a file on the server, you can output the image as base 64 like(before you use clear/destroy) but ie has issues with PNG as base64 so you'd probably have to output base64 as jpegyou can see an example here I did for a former employer's sales territory map:Start: https://upload.wikimedia.org/wikipedia/commons/1/1a/Blank_US_Map_(states_only).svg Finish: EditSince writing the above, I've come up with 2 improved techniques:1) instead of a regex loop to change the fill on state , use CSS to make style rules like and then you can do a single text replace to inject your css rules into the svg before proceeding with the imagick jpeg/png creation. If the colors don't change, check to make sure you don't have any inline fill styles in your path tags overriding the css.2) If you don't have to actually create a jpeg/png image file (and don't need to support outdated browsers), you can manipulate the svg directly with jQuery. You can't access the svg paths when embedding the svg using img or object tags, so you'll have to directly include the svg xml in your webpage html like:then changing the colors is as easy as:You mention that you are doing this because IE doesn't support SVG.The good news is that IE does support vector graphics. Okay, so it's in the form of a language called VML which only IE supports, rather than SVG, but it is there, and you can use it.Google Maps, among others, will detect the browser capabilities to determine whether to serve SVG or VML.Then there's the Raphael library, which is a Javascript browswer-based graphics library, which supports either SVG or VML, again depending on the browser.Another one which may help: SVGWeb.All of which means that you can support your IE users without having to resort to bitmap graphics.See also the top answer to this question, for example: XSL Transform SVG to VMLWhen converting SVG to transparent PNG, don't forget to put this BEFORE $imagick->readImageBlob():This is v. easy, have been doing work on this for the past few weeks. You need the Batik SVG Toolkit. Download, and place the files in the same directory as the SVG you want to convert to a JPEG, also make sure you unzip it first.Open the terminal, and run this command:That should output a JPEG of the SVG file. Really easy. 

You can even just place it in a loop and convert loads of SVGs, I do not know of a standalone PHP / Apache solution, as this would require a PHP library that can read and render SVG images. I'm not sure such a library exists - I don't know any.ImageMagick is able to rasterize SVG files, either through the command line or the PHP binding, IMagick, but seems to have a number of quirks and external dependencies as shown e.g. in this forum thread. I think it's still the most promising way to go, it's the first thing I would look into if I were you. This is a method for converting a svg picture to a gif using standard php GD tools1) You put the image into a canvas element in the browser:And then convert it at the server (ProcessPicture.php) from (default) png to gif and save it. (you could have saved as png too then use imagepng instead of image gif):You can use Raphaël—JavaScript Library and achieve it easily. It will work in IE also.or using : potrace

demo :Tool4dev.com

How to query all the GraphQL type fields without writing a long query?

BlackSigma

[How to query all the GraphQL type fields without writing a long query?](https://stackoverflow.com/questions/34199982/how-to-query-all-the-graphql-type-fields-without-writing-a-long-query)

Assume you have a GraphQL type and it includes many fields.

How to query all the fields without writing down a long query that includes the names of all the fields?For example, If I have these fields :To query all the fields usually the query is something like this: But I want a way to have the same results without writing all the fields, something like this:Is there a way to do this in GraphQL ??I'm using Folkloreatelier/laravel-graphql library.

2015-12-10 10:50:43Z

Assume you have a GraphQL type and it includes many fields.

How to query all the fields without writing down a long query that includes the names of all the fields?For example, If I have these fields :To query all the fields usually the query is something like this: But I want a way to have the same results without writing all the fields, something like this:Is there a way to do this in GraphQL ??I'm using Folkloreatelier/laravel-graphql library.Unfortunately what you'd like to do is not possible. GraphQL requires you to be explicit about specifying which fields you would like returned from your query.Yes, you can do this using introspection.  Make a GraphQL query like (for type UserType)and you'll get a response like (actual field names will depend on your actual schema/type definition)You can then read this list of fields in your client and dynamically build a second GraphQL query to get all of these fields.This relies on you knowing the name of the type that you want to get the fields for -- if you don't know the type, you could get all the types and fields together using introspection likeNOTE: this is the over-the-wire GraphQL data -- you're on your own to figure out how to read and write with your actual client.  Your graphQL javascript library may already employ introspection in some capacity, for example the apollo codegen command uses introspection to generate types.I guess the only way to do this is by utilizing reusable fragments:I faced this same issue when I needed to load location data that I had serialized into the database from the google places API. Generally I would want the whole thing so it works with maps but I didn't want to have to specify all of the fields every time.I was working in Ruby so I can't give you the PHP implementation but the principle should be the same.I defined a custom scalar type called JSON which just returns a literal JSON object.The ruby implementation was like so (using graphql-ruby)Then I used it for our objects like soI would use this very sparingly though, using it only where you know you always need the whole JSON object (as I did in my case). Otherwise it is defeating the object of GraphQL more generally speaking.GraphQL query format was designed in order to allow:However, according to GraphQL documentation, you may create fragments in order to make selection sets more reusable:Then you could query all user details by:You can also add additional fields alongside your fragment:Package graphql-type-json supports custom-scalars type JSON.

Use it can show all the field of your json objects.

Here is the link of the example in ApolloGraphql Server.

https://www.apollographql.com/docs/apollo-server/schema/scalars-enums/#custom-scalars

What does new self(); mean in PHP?

user198729

[What does new self(); mean in PHP?](https://stackoverflow.com/questions/2396415/what-does-new-self-mean-in-php)

I've never seen code like this:Is it the same as new className() ?EDITIf the class is inheritant,which class does it point to?

2010-03-07 13:36:39Z

I've never seen code like this:Is it the same as new className() ?EDITIf the class is inheritant,which class does it point to?self points to the class in which it is written.So, if your getInstance method is in a class name MyClass, the following line :Will do the same as :Edit : a couple more informations, after the comments.If you have two classes that extend each other, you have two situations : The first situation would look like this (I've removed all non-necessary code, for this example -- you'll have to add it back to get the singleton behavior)* :Here, you'll get :Which means self means MyChildClass -- i.e. the class in which it is written.

For the second situation, the code would look like this :And you'd get this kind of output :Which means self means MyParentClass -- i.e. here too, the class in which it is written.

With PHP < 5.3, that "the class in which it is written" is important -- and can sometimes cause problems.That's why PHP 5.3 introduces a new usage for the static keyword : it can now be used exactly where we used self in those examples :But, with static instead of self, you'll now get :Which means that static sort of points to the class that is used (we used MyChildClass::getInstance()), and not the one in which it is written.Of course, the behavior of self has not been changed, to not break existing applications -- PHP 5.3 just added a new behavior, recycling the static keyword.

And, speaking about PHP 5.3, you might want to take a look at the Late Static Bindings page of the PHP manual.This seems to be an implementation of the Singleton pattern.

The function is called statically and checks whether the static class has the variable $_instance set. If it isn't, it initializes an instance of itself (new self()) and stores it in $_instance.If you call className::getInstance() you will get one and the same class instance on every call, which is the point of the singleton pattern.I've never seen it this done this way, though, and honestly didn't know it was possible.

What is $_instance declared as in the class? This is most likely used in singleton design pattern, wherein the constructor is defined as private so as to avoid being instantiated, the double colon (::) operator can access members that are declared static inside the class, so if there are static members, the pseudo variable $this cannot be used, hence the code used self instead, Singletons are good programming practices that will only allow 1 instance of an object like database connector handlers. From client code, accessing that instance would be done by creating a single access point, in this case he named it getInstance(), The getInstance in itself was the function that created the the object basically using the new keyword to create an object meaning the constructor method was also called.the line if(!isset(self::instance)) checks if an object has already been created, you could not understand this becuase the code is just a fragment, somewhere in the top, there should be static members like probablyin normal classes we would have accessed this member by simplybut its declared static and so we could not use the $this code we use insteadby checking if there is an object stored on this static class variable, the class can then decide to create or not to create a single instance, so if its not set, !isset, meaning no object exists on the static member $_instance, then it generates a new object, stored it in the static member $_instance by the commandand returned it to client code. The client code can then happily use the single instance of the object with its public methods, but in the client code, calling the single access point, that is, the getInstance() method is also tricky, it has to be called like thisthe reason, the function in itself is declared static.Yes, it's like new className() (referring to the class containing that method), probably used in a Singleton pattern where the constructor is private.If the class is inherited then calling getInstance() from child will not give you a instance of child. It will only returns an instance of parent instance.

This is because we call new self().If you want that the child class will return an instance of child class then use new static() in the getInstance() and it will then return the child class instance. This is called late binding!!

Get current URL path in PHP [duplicate]

totallyuneekname

[Get current URL path in PHP [duplicate]](https://stackoverflow.com/questions/16198790/get-current-url-path-in-php)

I need to get the path from the URL of the current request. For example, if the current URL is:I would want this:

2013-04-24 17:45:36Z

I need to get the path from the URL of the current request. For example, if the current URL is:I would want this:You want $_SERVER['REQUEST_URI']. From the docs:it should be : Take a look at : Get the full URL in PHP

How to use phpexcel to read data and insert into database?

coder101

[How to use phpexcel to read data and insert into database?](https://stackoverflow.com/questions/9695695/how-to-use-phpexcel-to-read-data-and-insert-into-database)

I have a php application where I want to read data from excel, Insert into database and then generate pdf reports for specific users.

I searched a lot but nothing specific given about both things.

2012-03-14 03:54:55Z

I have a php application where I want to read data from excel, Insert into database and then generate pdf reports for specific users.

I searched a lot but nothing specific given about both things.Using the PHPExcel library to read an Excel file and transfer the data into a databaseAnything more becomes very dependent on your database, and how you want the data structured in itIn order to read data from microsoft excel 2007 by codeigniter just create a helper function excel_helper.php and add the following in:Using the PHPExcel library, the following code will do.Here is a very recent answer to this question from the file: 07reader.phpInci framework  you can do download like so:

How to solve PHP error 'Notice: Array to string conversion in…'

t4thilina

[How to solve PHP error 'Notice: Array to string conversion in…'](https://stackoverflow.com/questions/20017409/how-to-solve-php-error-notice-array-to-string-conversion-in)

I have a PHP file that tries to echo a $_POST and I get an error, here is the code:Here is the code to echo the POST.But when the code runs I get an error like:What does this error mean and how do I fix it?

2013-11-16 10:38:36Z

I have a PHP file that tries to echo a $_POST and I get an error, here is the code:Here is the code to echo the POST.But when the code runs I get an error like:What does this error mean and how do I fix it?When you have many HTML inputs named C[] what you get in the POST array on the other end is an array of these values in $_POST['C']. So when you echo that, you are trying to print an array, so all it does is print Array and a notice.To print properly an array, you either loop through it and echo each element, or you can use print_r.Alternatively, if you don't know if it's an array or a string or whatever, you can use var_dump($var) which will tell you what type it is and what it's content is. Use that for debugging purposes only.If you send a PHP array into a function that expects a string like: echo or print, then the PHP interpreter will convert your array to the literal string Array, throw this Notice and keep going.  For example:In this case, the function print dumps the literal string: Array to stdout and then logs the Notice to stderr and keeps going.  Another example in a PHP script:You have 2 options, either cast your PHP array to String using an array to string converter or suppress the PHP Notice.http://php.net/manual/en/function.print-r.php or http://php.net/manual/en/function.var-dump.phpPrints:You are using <input name='C[]' in your HTML. This creates an array in PHP when the form is sent.You are using echo $_POST['C']; to echo that array - this will not work, but instead emit that notice and the word "Array".Depending on what you did with the rest of the code, you should probably use echo $_POST['C'][0];Array to string conversion in latest versions of php 7.x is error, rather than notice, and prevents further code execution. Using print, echo on array is not an option anymore. Suppressing errors and notices is not a good practice, especially when in development environment and still debugging code. Use var_dump,print_r, iterate through input value using foreach or for to output input data for names that are declared as input arrays ('name[]') Most common practice to catch errors is using try/catch blocks, that helps us prevent interruption of code execution that might cause possible errors wrapped within try block. if you want to capture the result in a variable

PHP cURL vs file_get_contents

Salvador Dali

[PHP cURL vs file_get_contents](https://stackoverflow.com/questions/11064980/php-curl-vs-file-get-contents)

How do these two pieces of code differ when accessing a REST API?andThey both produce the same result, judging by

2012-06-16 15:58:12Z

How do these two pieces of code differ when accessing a REST API?andThey both produce the same result, judging byfile_get_contents() is a simple screwdriver. Great for simple GET requests where the header, HTTP request method, timeout, cookiejar, redirects, and other important things do not matter.fopen() with a stream context or cURL with setopt are powerdrills with every bit and option you can think of.In addition to this, due to some recent website hacks we had to secure our sites more. In doing so, we discovered that file_get_contents failed to work, where curl still would work.Not 100%, but I believe that this php.ini setting may have been blocking the file_get_contents request.Either way, our code now works with curl.This is old topic but on my last test on one my API, cURL is faster and more stable. Sometimes file_get_contents on larger request need over 5 seconds when cURL need only from 1.4 to 1.9 seconds what is double faster.I need to add one note on this that I just send GET and recive JSON content. If you setup cURL properly, you will have a great response. Just "tell" to cURL what you need to send and what you need to recive and that's it.On your exampe I would like to do this setup:This request will return data in 0.01 second max

Reset PHP Array Index

Walter Johnson

[Reset PHP Array Index](https://stackoverflow.com/questions/7536961/reset-php-array-index)

I have a PHP array that looks like this:What PHP function makes this?

2011-09-24 04:08:27Z

I have a PHP array that looks like this:What PHP function makes this?The array_values() function [docs] does that:If you want to reset the key count of the array for some reason;Output:Use array_keys() function get keys of an array and array_values() function to get values of an array.You want to get values of an array:Output:You want to get keys of an array:Output:

json_encode/json_decode - returns stdClass instead of Array in PHP

Derek Adair

[json_encode/json_decode - returns stdClass instead of Array in PHP](https://stackoverflow.com/questions/2281973/json-encode-json-decode-returns-stdclass-instead-of-array-in-php)

Observe this little script:Why does PHP turn the JSON Object into a class?Shouldn't an array that is json_encoded then json_decoded yield the EXACT same result?

2010-02-17 15:35:30Z

Observe this little script:Why does PHP turn the JSON Object into a class?Shouldn't an array that is json_encoded then json_decoded yield the EXACT same result?Take a closer look at the second parameter of json_decode($json, $assoc, $depth) at https://secure.php.net/json_decodegives you an array.Take a closer look at the output of the encoded JSON, I've extended the example the OP is giving a little bit:The JSON format was derived from the same standard as JavaScript (ECMAScript Programming Language Standard) and if you would look at the format it looks like JavaScript. It is a JSON object ({} = object) having a property "stuff" with value "things" and has a property "things" with it's value being an array of strings ([] = array).JSON (as JavaScript) doesn't know associative arrays only indexed arrays. So when JSON encoding a PHP associative array, this will result in a JSON string containing this array as an "object".Now we're decoding the JSON again using json_decode($arrayEncoded). The decode function doesn't know where this JSON string originated from (a PHP array) so it is decoding into an unknown object, which is stdClass in PHP. As you will see, the "things" array of strings WILL decode into an indexed PHP array.Also see:Thanks to https://www.randomlists.com/things for the 'things'Although, as mentioned, you could add a second parameter here to indicate you want an array returned:Many people might prefer to cast the results instead:It might be more clear to read.tl;dr: JavaScript doesn't support associative arrays, therefore neither does JSON.  After all, it's JSON, not JSAAN. :)So PHP has to convert your array into an object in order to encode into JSON.If you decode the json into array, information will be lost in this situation.There is also a good PHP 4 json encode / decode library (that is even PHP 5 reverse compatible) written about in this blog post: Using json_encode() and json_decode() in PHP4 (Jun 2009).The concrete code is by Michal Migurski and by Matt Knapp: 

PHP Sort Array By SubArray Value

Sjwdavies

[PHP Sort Array By SubArray Value](https://stackoverflow.com/questions/2477496/php-sort-array-by-subarray-value)

I have the following array structure:What is the best way to order the array in an incremental way, based on the optionNumber?So the results look like:

2010-03-19 13:09:56Z

I have the following array structure:What is the best way to order the array in an incremental way, based on the optionNumber?So the results look like:Use usort.In PHP ≥5.3, you should use an anonymous function instead:Note that both code above assume $a['optionNumber'] is an integer. Use @St. John Johnson's solution if they are strings.In PHP ≥7.0, use the spaceship operator <=> instead of subtraction to prevent overflow/truncation problems.Use usortI used both solutions by KennyTM and AJ Quick and came up with a function that can help in this issue for many cases like using ASC or DESC sorting or preserving keys or if you have objects as children of array.Here is this function (works for PHP7 and higher because of spaceship operator):Usage:EditThe first part can be rewritten using uasort() and the function will be shorter (works for PHP7 and higher because of spaceship operator):The keys are removed when using a function like the ones above. If the keys are important, the following function would maintain it... but foreach loops are pretty inefficient.Use arsort instead of asort if you want from high to low.Code credit: http://www.firsttube.com/read/sorting-a-multi-dimensional-array-with-php/ PHP 5.3+Using array_multisort(), array_map()DEMO

How to convert an array into an object using stdClass() [duplicate]

Alexandrw

[How to convert an array into an object using stdClass() [duplicate]](https://stackoverflow.com/questions/19272011/how-to-convert-an-array-into-an-object-using-stdclass)

I have made the following array:I would like to know how to convert this array into an object using stdClass(), I'm a PHP beginner, a simple example would be very helpful, I've tried searching for similar questions, but the answers are complicated and go beyond my understanding of basic classes and objects.

2013-10-09 12:27:33Z

I have made the following array:I would like to know how to convert this array into an object using stdClass(), I'm a PHP beginner, a simple example would be very helpful, I've tried searching for similar questions, but the answers are complicated and go beyond my understanding of basic classes and objects.You just add this code If you want to see is this stdClass object just call thisIf you want to convert an array to object code will be You don't need to use stdClass. It will automatically converted to stdClassThe quick and dirty way is using json_encode and json_decode which will turn the entire array (including sub elements) into an object.The same can be used to convert an object into an array. Simply add , true to json_decode to return an associated array:An alternate way (without being dirty) is simply a recursive function:or in full code:which outputs (note that there's no arrays - only stdClass's):So you'd refer to it by $obj->e5->nume.DEMOIf you want to recursively convert the entire array into an Object type (stdClass) then , below is the best method and it's not time-consuming or memory deficient  especially when you want to do a  recursive (multi-level) conversion compared to writing your own function.One of the easiest solution isTo convert array to object using stdClass just add (object) to array u declare.EX:to convert object to arrayto convert array to objectwith these methods you can swap between array and object very easily.Another method is to use jsonBut this is a much more memory intensive way to do and is not supported by versions of PHP <= 5.1Array to stdClass can be done in php this way.

(stdClass is already PHP's generic empty class)Actually calling stdClass::__set_state() in PHP 5 will produce a fatal error. thanks @Ozzy for pointing outThis is an example of how you can use __set_state() with a stdClass object in PHP5Or a nicer way.or you can use this thing use this  Tutorial

Calculate business days

AdamTheHutt

[Calculate business days](https://stackoverflow.com/questions/336127/calculate-business-days)

I need a method for adding "business days" in PHP. For example, Friday 12/5 + 3 business days = Wednesday 12/10.At a minimum I need the code to understand weekends, but ideally it should account for US federal holidays as well. I'm sure I could come up with a solution by brute force if necessary, but I'm hoping there's a more elegant approach out there. Anyone?Thanks.

2008-12-03 03:07:45Z

I need a method for adding "business days" in PHP. For example, Friday 12/5 + 3 business days = Wednesday 12/10.At a minimum I need the code to understand weekends, but ideally it should account for US federal holidays as well. I'm sure I could come up with a solution by brute force if necessary, but I'm hoping there's a more elegant approach out there. Anyone?Thanks.Here's a function from the user comments on the date() function page in the PHP manual. It's an improvement of an earlier function in the comments that adds support for leap years.Enter the starting and ending dates, along with an array of any holidays that might be in between, and it returns the working days as an integer:Get the number of working days without holidays between two dates :There are some args for the date() function that should help. If you check date("w") it will give you a number for the day of the week, from 0 for Sunday through 6 for Saturday. So.. maybe something like..This is just a rough example of one possibility..Holiday calculation is non-standard in each State. I am writing a bank application which I need some hard business rules for but can still only get a rough standard.Here is a function for adding buisness days to a dateAnother post mentions getWorkingDays (from php.net comments and included here) but I think it breaks if you start on a Sunday and finish on a work day.Using the following (you'll need to include the getWorkingDays function from previous post)Gives the result as 5 not 4The following function was used to generate the above.Bring on the holidays...You can try this function which is more simple.A function to add or subtract business days from a given date, this doesn't account for holidays.use like so...My version based on the work by @mcgrailm... tweaked because the report needed to be reviewed within 3 business days, and if submitted on a weekend, the counting would start on the following Monday:And working out the difference of two dates in terms of business days:As a note, everyone who is using 86400, or 24*60*60, please don't... your forgetting time changes from winter/summer time, where a day it not exactly 24 hours. While it's a little slower the strtotime('+1 day', $timestamp), it much more reliable.Brute attempt to detect working time - Monday to Friday 8am-4pm:Below is the working code to calculate working business days from a given date.Here is another solution without for loop for each day.For holidays, make an array of days in some format that date() can produce. Example:Then use the in_array() and date() functions to check if the timestamp represents a holiday:I had this same need i started with bobbin's first example and ended up with thishth someoneVariant 1:Variant 2:Variant 3:The additional holiday considerations can be made using variations of the above by doing the following. Note! assure all the timestamps are the same time of the day (i.e. midnight). Make an array of holiday dates (as unixtimestamps) i.e.:Modify line : to be :Done!Here is a recursive solution. It can easily be modified to only keep track of and return the latest date.calculate workdays between two dates including holidays and custom workweekThe answer is not that trivial - thus my suggestion would be to use a class where you can configure more than relying on simplistic function (or assuming a fixed locale and culture). To get the date after a certain number of workdays you'll:Functional ApproachThis is another solution, it is nearly 25% faster than checking holidays with in_array:This code snippet is very easy to calculate business day without week end and holidays:I know I'm late to the party, but I use this old set of functions by Marcos J. Montes for figuring out holidays and business days.  He took the time to add an algorithm from 1876 for Easter and he added all the major US holidays.  This can easily be updated for other countries.function get_business_days_forward_from_date($num_days, $start_date='', $rtn_fmt='Y-m-d')

 {}The add_business_days has a small bug. Try the following with the existing function and the output will be a Saturday.Startdate = Friday

Business days to add = 1

Holidays array = Add date for the following Monday.I have fixed that in my function below.I just get my function working based on Bobbin and mcgrailm code, adding some things that worked perfect to me.An enhancement to the function offered by James Pasta above, to include all Federal Holidays, and to correct 4th July (was calculated as 4th June above!), and to also include the holiday name as the array key.../**

 * National American Holidays

 * @param string $year

 * @return array

 */

public static function getNationalAmericanHolidays($year) {}Just finished writing an API that can be used to manipulate business days (none of these solutions quite worked for my situation :-); linking to it here in case anyone else finds it useful.~ NatePHP Class to Calculate Business DaysThanks to Bobbin, mcgrailm, Tony, James Pasta and a few others who posted here. I had written my own function to add business days to a date, but modified it with some code I found here. This will handle the start date being on a weekend/holiday. This will also handle business hours. I added some comments and break up the code to make it easier to read.Personally, I think this is a cleaner and more concise solution:Just send the proposed new date to this function.

How can I create an error 404 in PHP?

Eric

[How can I create an error 404 in PHP?](https://stackoverflow.com/questions/1381123/how-can-i-create-an-error-404-in-php)

My .htaccess redirects all requests to /word_here to /page.php?name=word_here. The PHP script then checks if the requested page is in its array of pages.If not, how can I simulate an error 404?

I tried this, but it didn't result in my 404 page configured via ErrorDocument in the .htaccess showing up.Am I right in thinking that it's wrong to redirect to my error 404 page?

2009-09-04 19:29:58Z

My .htaccess redirects all requests to /word_here to /page.php?name=word_here. The PHP script then checks if the requested page is in its array of pages.If not, how can I simulate an error 404?

I tried this, but it didn't result in my 404 page configured via ErrorDocument in the .htaccess showing up.Am I right in thinking that it's wrong to redirect to my error 404 page?The up-to-date answer (as of PHP 5.4 or newer) for generating 404 pages is to use http_response_code:die() is not strictly necessary, but it makes sure that you don't continue the normal execution.What you're doing will work, and the browser will receive a 404 code. What it won't do is display the "not found" page that you might be expecting, e.g.:The requested URL /test.php was not found on this server.That's because the web server doesn't send that page when PHP returns a 404 code (at least Apache doesn't). PHP is responsible for sending all its own output. So if you want a similar page, you'll have to send the HTML yourself, e.g.:You could configure Apache to use the same page for its own 404 messages, by putting this in httpd.conf:Try this:Create custom error pages through .htaccess file1. 404 - page not found2. 500 - Internal Server Error3. 403 - Forbidden4. 400 - Bad request5. 401 - Authorization RequiredYou can also redirect all error to single page. likeDid you remember to die() after sending the header?  The 404 header doesn't automatically stop processing, so it may appear not to have done anything if there is further processing happening.It's not good to REDIRECT to your 404 page, but you can INCLUDE the content from it with no problem.  That way, you have a page that properly sends a 404 status from the correct URL, but it also has your "what are you looking for?" page for the human reader.try putting  in .htaccess file.Do this for any error but substitute 404 for your error.In the Drupal or Wordpress CMS (and likely others), if you are trying to make some custom php code appear not to exist (unless some condition is met), the following works well by making the CMS's 404 handler take over:Immediately after that line try closing the response using exit or die()or

「The page has expired due to inactivity」- Laravel 5.5

Sougata Bose

[「The page has expired due to inactivity」- Laravel 5.5](https://stackoverflow.com/questions/46141705/the-page-has-expired-due-to-inactivity-laravel-5-5)

My register page is showing the form properly with CsrfToken ({{ csrf_field() }}) present in the form).Form HTMLI am using inbuilt authentication for the users. Have not changed anything except the routes and redirects.When I submit the form (just after reloading also), it gives that The page has expired due to inactivity. Please refresh and try again. error.My be I am missing a very small thing. But not sure what it is. Any help?UpdateFound the issue. The session driver was set to array. Changed it to file and the error is gone now.

But what is wrong if I use array?

2017-09-10 14:18:35Z

My register page is showing the form properly with CsrfToken ({{ csrf_field() }}) present in the form).Form HTMLI am using inbuilt authentication for the users. Have not changed anything except the routes and redirects.When I submit the form (just after reloading also), it gives that The page has expired due to inactivity. Please refresh and try again. error.My be I am missing a very small thing. But not sure what it is. Any help?UpdateFound the issue. The session driver was set to array. Changed it to file and the error is gone now.

But what is wrong if I use array?If you're coming to this answer directly from a search, make sure you have already added the csrf token to your form with {{ csrf_field() }} like the OP.If you have your session driver set to file:May have something to do with the storage_path not being writable. This is where it stores session data regarding tokens if you're using file based sessions.  The can be verified with is_writable(config('session.files'))For the OP, the session driver was set to array.  Array is for testing only.  Since data is not persisted, it will not be able to compare the token on the next request.https://laravel.com/docs/5.5/session#configurationCheck config/session.phpLastly, an issue I just had, we had a project which has the session domain and secure settings in config/session.php but the development site was not using HTTPS (SSL/TLS).  This caused this generic error since sessions.secure was set to true by default.I ran into the same issue in Laravel 5.5. In my case, it happened after changing a route from GET to POST. The issue was because I forgot to pass a CSRF token when I switched to POST. You can either post a CSRF token in your form by calling:Or exclude your route in app/Http/Middleware/VerifyCsrfToken.php Try all of them.This caused because of Illuminate\Session\TokenMismatchException

look at this code sample how to handle it properly:My case was solved with SESSION_DOMAIN, in my local machine had to be set to xxx.localhost. It was causing conflicts with the production SESSION_DOMAIN, xxx.com that was set directly in the session.php config file.Some information is stored in the cookie which is related to previous versions of laravel in development. So it's conflicting with csrf generated tokens which are generated by another's versions. Just  Clear the cookie and give a try. For those who still has problem and nothing helped. Pay attention on php.ini mbstring.func_overload parameter. It has to be set to 0. And mbstring.internal_encoding set to UTF-8. In my case that was a problem.I change permission to storage and error was gone. It seemed lack of permission was the issue.add @csrf in the form

and also go to VerifyCsrfToken.phpapp->Http->Middleware->VerifyCsrfToken.phpIn my case, the site was fine in server but not in local. Then I remember I was working on secure website.

So in file config.session.php, set the variable secure to falseI had the app with multiple subdomains and session cookie was the problem between those. Clearing the cookies resolved my problem.Also, try setting the SESSION_DOMAIN in .env file. Use the exact subdomain you are browsing.Be sure to have the correct system time on your web server.  In my case, the vagrant machine was in the future (Jan 26 14:08:26 UTC 2226) so of course the time in my browser's session cookie had expired some 200+ years ago.set mbstring.func_overload = 2it helped meI have figured out two solution to avoid these error

1)by adding protected $except = ['/yourroute'] possible disable csrf token inspection from defined root.

2)just comment  \App\Http\Middleware\VerifyCsrfToken::class line in protected middleware group in kernelI had the same problem but the problem is not in the framework but in the browser. I don't know why but google chrome blocks cookies automatically, in my case. After allowed cookies the problem was resolved.Short answerAdd the route entry for register in app/Http/Middleware/VerifyCsrfToken.phpand clear the cache and the cache route with the commands:DetailsEvery time you access a Laravel site, a token is generated, even if the session has not been started. Then, in each request, this token (stored in the cookies) will be validated against its expiration time, set in the SESSION_LIFETIME field on config/session.php file.If you keep the site open for more than the expiration time and try to make a request, this token will be evaluated and the expiration error will return. So, to skip this validation on forms that are outside the functions of authenticated users (such as register or login) you can add the except route in app/Http/Middleware/VerifyCsrfToken.php.

Use PHP composer to clone git repo

martin

[Use PHP composer to clone git repo](https://stackoverflow.com/questions/12954051/use-php-composer-to-clone-git-repo)

I'm trying to use composer to automatically clone a git repository from github that isn't in packagist but it's not working and I can't figure out what am I doing wrong.I think I have to include it among "repositories" like so:and then probably list it in "require" section. It should be similar to this example but it doesn't work. It just gives this error:Have anyone tried to do something like this already?

2012-10-18 11:56:47Z

I'm trying to use composer to automatically clone a git repository from github that isn't in packagist but it's not working and I can't figure out what am I doing wrong.I think I have to include it among "repositories" like so:and then probably list it in "require" section. It should be similar to this example but it doesn't work. It just gives this error:Have anyone tried to do something like this already?At the time of writing in 2013, this was one way to do it. Composer has added support for better ways:  See @igorw 's answerDO YOU HAVE A REPOSITORY?Git, Mercurial and SVN is supported by Composer.DO YOU HAVE WRITE ACCESS TO THE REPOSITORY?Yes?DOES THE REPOSITORY HAVE A composer.json FILEIf you have a repository you can write to: Add a composer.json file, or fix the existing one, and DON'T use the solution below.Go to @igorw 's answerONLY USE THIS IF YOU DON'T HAVE A REPOSITORY

OR IF THE REPOSITORY DOES NOT HAVE A composer.json AND YOU CANNOT ADD ITThis will override everything that Composer may be able to read from the original repository's composer.json, including the dependencies of the package and the autoloading.Using the package type will transfer the burden of correctly defining everything onto you. The easier way is to have a composer.json file in the repository, and just use it.This solution really only is for the rare cases where you have an abandoned ZIP download that you cannot alter, or a repository you can only read, but it isn't maintained anymore.That package in fact is available through packagist. You don't need a custom repository definition in this case. Just make sure you add a require (which is always needed) with a matching version constraint.In general, if a package is available on packagist, do not add a VCS repo. It will just slow things down.For packages that are not available via packagist, use a VCS (or git) repository, as shown in your question. When you do, make sure that:Here is a sample composer.json that installs the same package via a VCS repo:The VCS repo docs explain all of this quite well.If there is a git (or other VCS) repository with a composer.json available, do not use a "package" repo. Package repos require you to provide all of the metadata in the definition and will completely ignore any composer.json present in the provided dist and source. They also have additional limitations, such as not allowing for proper updates in most cases.Avoid package repos (see also the docs).You can include git repository to composer.json like this:Just tell composer to use source if available:Or:Then you will get packages as cloned repositories instead of extracted tarballs, so you can make some changes and commit them back. Of course, assuming you have write/push permissions to the repository and Composer knows about project's repository.Disclaimer: I think I may answered a little bit different question, but this was what I was looking for when I found this question, so I hope it will be useful to others as well.If Composer does not know, where the project's repository is, or the project does not have proper composer.json, situation is a bit more complicated, but others answered such scenarios already.I was encountering the following error: The requested package my-foo/bar could not be found in any version, there may be a typo in the package name.If you're forking another repo to make your own changes you will end up with a new repository.E.g:The new url will need to go into your repositories section of your composer.json.Remember if you want refer to your fork as my-foo/bar in your require section, you will have to rename the package in the composer.json file inside of your new repo.If you've just forked the easiest way to do this is edit it right inside github.In my case, I use Symfony2.3.x and the minimum-stability parameter is by default "stable" (which is good). I wanted to import a repo not in packagist but had the same issue "Your requirements could not be resolved to an installable set of packages.".

It appeared that the composer.json in the repo I tried to import use a minimum-stability "dev".So to resolve this issue, don't forget to verify the minimum-stability. I solved it by requiring a dev-master version instead of master as stated in this post.If you want to use a composer.json from GitHub you would look at this example (under the VCS section).The package section is for packages that do not have the composer.json. However, you didn't follow that example as well or it would also have worked. Do read what it says about package repositories:

Can I mix MySQL APIs in PHP?

N3mo

[Can I mix MySQL APIs in PHP?](https://stackoverflow.com/questions/17498216/can-i-mix-mysql-apis-in-php)

I have searched the net and so far what I have seen is that you can use mysql_ and mysqli_ together meaning:or Are valid but when I use this code what I get is:For the first and the same except with mysqli_close(). For the second one.What is the problem? Can't I use mysql_ and mysqli together? Or is it normal? Is the way I can check if the connections are valid at all? (the if(mysq...))

2013-07-05 23:48:36Z

I have searched the net and so far what I have seen is that you can use mysql_ and mysqli_ together meaning:or Are valid but when I use this code what I get is:For the first and the same except with mysqli_close(). For the second one.What is the problem? Can't I use mysql_ and mysqli together? Or is it normal? Is the way I can check if the connections are valid at all? (the if(mysq...))No, you can't use mysql and mysqli together.  They are separate APIs and the resources they create are incompatible with one another.There is a mysqli_close, though.Just to give a general answer here about all three MYSQL API's with a reference:You can't mix any of the three (mysql_*, mysqli_*, PDO) MYSQL API's from PHP together, it just doesn't work. It's even in the manual FAQ:You need to use the same MySQL API and its related functions, from connection to querying.Technically you can use as many separate connections as you want, while your problem is caused by a mere typo - you only cannot use resources from one extension with functions from another, which is quite obviously.However, you should avoid multiple connections from the same script, no matter from single API or different ones. As it will burden your database server and exhaust its resources. So, although technically you can, you shouldn't mix different extensions in your code, save for the short period of refactoring.MySQLi is a lot more secure than MySQL which is anyway now deprecated. That's why you should stick with MySQLi and also you can't mix them as they are both different.

Pros and Cons of Interface constants [closed]

Gordon

[Pros and Cons of Interface constants [closed]](https://stackoverflow.com/questions/5350672/pros-and-cons-of-interface-constants)

PHP interfaces allow the definition of constants in an interface, e.g.Any implementing class will automatically have these constants available, e.g.My own take on this is that anything Global is Evil. But I wonder if the same applies to Interface Constants. Given that Coding against an Interface is considered good practise in general, is using Interface Constants the only constants that are acceptable to use outside a class context?While I am curious to hear your personal opinion and whether you use Interface constants or not, I'm mainly looking for objective reasons in your answers. I dont want this to be a Poll Type question. I'm interested in what effect using interface constants has on Maintainability. Coupling. Or Unit Testing. How does it relate to SOLID PHP? Does it violate any coding principles that are considered Good Practise in PHP? You get the idea …Note: there is a similar question for Java that listed some quite good reasons why they are Bad Practice, but since Java isn't PHP, I felt it justified to ask it within the PHP tag again.

2011-03-18 10:27:25Z

PHP interfaces allow the definition of constants in an interface, e.g.Any implementing class will automatically have these constants available, e.g.My own take on this is that anything Global is Evil. But I wonder if the same applies to Interface Constants. Given that Coding against an Interface is considered good practise in general, is using Interface Constants the only constants that are acceptable to use outside a class context?While I am curious to hear your personal opinion and whether you use Interface constants or not, I'm mainly looking for objective reasons in your answers. I dont want this to be a Poll Type question. I'm interested in what effect using interface constants has on Maintainability. Coupling. Or Unit Testing. How does it relate to SOLID PHP? Does it violate any coding principles that are considered Good Practise in PHP? You get the idea …Note: there is a similar question for Java that listed some quite good reasons why they are Bad Practice, but since Java isn't PHP, I felt it justified to ask it within the PHP tag again.Well, I think that it boils down to the difference between good and good enough.  While in most cases you can avoid the use of constants by implementing other patterns (strategy or perhaps flyweight), there is something to be said for not needing a half dozen other classes to represent a concept.  I think what it boils down to, is how likely is there a need for other constants.  In other words, is there a need to extend the ENUM provided by the constants on the interface.  If you can foresee needing to expand it, then go with a more formal pattern.  If not, then it may suffice (it'll be good enough, and hence be less code to write and test).  Here's an example of a good enough and a bad use:Bad:Good Enough:Now, the reason that I chose those examples is simple.  The User interface is defining an enum of user types.  This is very likely to expand over time and would be better suited by another pattern.  But the HTTPRequest_1_1 is a decent use-case, since the enum is defined by RFC2616 and will not change for the lifetime of the class.  In general, I don't see the problem with constants and class constants as being a global problem.  I see it as a dependency problem.  It's a narrow distinction, but a definite one.  I see global problems as in global variables which are not enforced, and as such create a soft global dependency.  But a hard-coded class creates an enforced dependency, and as such create a hard global dependency.  So both are dependencies.  But I consider the global to be far worse since it's not enforced...  Which is why I don't like to lump class dependencies with global dependencies under the same banner...If you write MyClass::FOO, you're hard-coded to the implementation details of MyClass.  This creates a hard-coupling, which makes your code less flexible, and as such should be avoided.  However, interfaces exist to permit exactly this type of coupling.  Therefore MyInterface::FOO doesn't introduce any concrete coupling.  With that said, I wouldn't introduce an interface just to add a constant to it.So if you're using interfaces, and you're very sure that you (or anyone else for that matter) won't need additional values, then I don't really see a huge issue with the interface constants...  The best designs wouldn't include any constants or conditionals or magic-numbers or magic-strings or hard-coded anything.  However, that adds additional time to the development, as you must consider the uses.  My view is that most times it's absolutely worth taking the additional time to build a great solid design.  But there are times when good enough really is acceptable (and it takes an experienced developer to understand the difference), and in those cases it's fine.Again, that's just my view on it...I think that its usually better to handle constants, specially enumerated constants, as a separate type ("class") from your interface:or, if you want to use a class as a namespace:Its not that you are using just constants, you are using the concept of enumerated values or enumerations, which a set of restricted values, are considered a specific type, with a specific usage ("domain" ? )

PHP_SELF vs PATH_INFO vs SCRIPT_NAME vs REQUEST_URI

Eli

[PHP_SELF vs PATH_INFO vs SCRIPT_NAME vs REQUEST_URI](https://stackoverflow.com/questions/279966/php-self-vs-path-info-vs-script-name-vs-request-uri)

I am building a PHP application in CodeIgniter. CodeIgniter sends all requests to the main controller: index.php. However, I don't like to see index.php in the URI. For example, http://www.example.com/faq/whatever will route to http://www.example.com/index.php/faq/whatever. I need a reliable way for a script to know what it's address is, so it will know what to do with the navigation. I've used mod_rewrite, as per CodeIgniter documentation.The rule is as follows:Normally, I would just check php_self, but in this case it's always index.php. I can get it from REQUEST_URI, PATH_INFO, etc., but I'm trying to decide which will be most reliable. Does anyone know (or know where to find) the real difference between PHP_SELF, PATH_INFO, SCRIPT_NAME, and REQUEST_URI? Thanks for your help!Note: I've had to add spaces, as SO sees the underscore, and makes it italic for some reason. Updated: Fixed the spaces.

2008-11-11 04:00:16Z

I am building a PHP application in CodeIgniter. CodeIgniter sends all requests to the main controller: index.php. However, I don't like to see index.php in the URI. For example, http://www.example.com/faq/whatever will route to http://www.example.com/index.php/faq/whatever. I need a reliable way for a script to know what it's address is, so it will know what to do with the navigation. I've used mod_rewrite, as per CodeIgniter documentation.The rule is as follows:Normally, I would just check php_self, but in this case it's always index.php. I can get it from REQUEST_URI, PATH_INFO, etc., but I'm trying to decide which will be most reliable. Does anyone know (or know where to find) the real difference between PHP_SELF, PATH_INFO, SCRIPT_NAME, and REQUEST_URI? Thanks for your help!Note: I've had to add spaces, as SO sees the underscore, and makes it italic for some reason. Updated: Fixed the spaces.The PHP documentation can tell you the difference:PATH_INFO doesn't seem to be documented...Some practical examples of the differences between these variables:

Example 1.

PHP_SELF is different from SCRIPT_NAME only when requested url is in form:

http://example.com/test.php/foo/bar(this seems to be the only case when PATH_INFO contains sensible information [PATH_INFO] => /foo/bar)

Note: this used to be different in some older PHP versions (<= 5.0 ?).Example 2.

REQUEST_URI is different from SCRIPT_NAME when a non-empty query string is entered:

http://example.com/test.php?foo=barExample 3.

REQUEST_URI is different from SCRIPT_NAME when server-side redirecton is in effect (for example mod_rewrite on apache):http://example.com/test.phpExample 4.

REQUEST_URI is different from SCRIPT_NAME when handling HTTP errors with scripts.

Using apache directive ErrorDocument 404 /404error.php

http://example.com/test.phpOn IIS server using custom error pages

http://example.com/test.phpPATH_INFO is only available when using htaccess like this:http://domain.com/http://domain.com/testhttp://domain.com/test?123http://domain.com/http://domain.com/testhttp://domain.com/test?123orhttp://domain.com/http://domain.com/testhttp://domain.com/enhttp://domain.com/en/testhttp://domain.com/en/test?123    $_SERVER['REQUEST_URI']       = Web path, requested URI

    $_SERVER['PHP_SELF']          = Web path, requested file + path info

    $_SERVER['SCRIPT_NAME']       = Web path, requested file

    $_SERVER['SCRIPT_FILENAME']   = File path, requested file

    __FILE__                      = File path, current file You may want to look into the URI Class and make use of $this->uri->uri_string()Returns a string with the complete URI. For example, if this is your full URL:The function would return this:Or you could make use of the segments to drill down specific areas without having to come up with parsing/regex valuesPersonally I use the $REQUEST_URI as it references the URI entered and not the location on the server's disc.There is very little to add to Odin's answer. I just felt to provide a complete example from the HTTP request to the actual file on the file system to illustrate the effects of URL rewriting and aliases. On the file system the script /var/www/test/php/script.php iswhere /var/www/test/php/script_included.php isand  /var/www/test/.htaccess  isand the Apache configuration file includes the aliasand the http request is The output will beThe following always holds If there is no mod_rewrite, mod_dir, ErrorDocument rewrite or any form of URL rewriting, we also haveThe aliases affect the system file paths SCRIPT_FILENAME and __FILE__, not the URL paths, which are defined before - see exceptions below. Aliases might use the entire URL path, including PATH_INFO. There could be no connection at all between SCRIPT_NAME and SCRIPT_FILENAME . It is not totally exact that aliases are not resolved at the time the URL path [PHP_SELF] = [SCRIPT_NAME] + [PATH_INFO]  is defined, because aliases are considered to search the file system and we know from example 4 in Odin's answer that the file system is searched to determine if the file exists, but this is only relevant when the file is not found. Similarly, mod_dir calls mod_alias to search the file system, but this is only relevant if you have an alias such as Alias \index.php \var\www\index.php and the request uri is a directory.   If you ever forget which variables do what, you can write a little script that uses phpinfo() and call it from a URL with a query string. Since server software installations present the variables that PHP returns it's always a good idea to check the machine's output in case rewrites at the server config file are causing different results than expected. Save it as something like _inf0.php:Then you would call /_inf0.php?q=500Backup a second, you've taken the wrong approach to begin with. Why not just do thisinstead? Then grab it with $_GET['url'];

PHP expresses two different strings to be the same [duplicate]

xdazz

[PHP expresses two different strings to be the same [duplicate]](https://stackoverflow.com/questions/12598407/php-expresses-two-different-strings-to-be-the-same)

Why does the following statement return true?I have also tried this with single quotes around the strings. The only way I can get it to evaulate to false is by using the === operator instead of ==My guess is PHP is treating it as some sort of equation but it seems a bit of a strange one.Can anybody elaborate?

2012-09-26 09:22:38Z

Why does the following statement return true?I have also tried this with single quotes around the strings. The only way I can get it to evaulate to false is by using the === operator instead of ==My guess is PHP is treating it as some sort of equation but it seems a bit of a strange one.Can anybody elaborate?"608E-4234" is the float number format, so they will cast into number when they compares.608E-4234 and 272E-3063 will both be float(0) because they are too small.For == in php, http://php.net/manual/en/language.operators.comparison.phpAttention:What about the behavior in javascript which also has both == and ===?The answer is the behavior is different from PHP. In javascript, if you compare two value with same type, == is just same as ===, so type cast won't happen for compare with two same type values.In javascript:So in javascript, when you know the type of the result, you could use == instead of === to save one character.For example, typeof operator always returns a string, so you could just use typeof foo == 'string' instead of typeof foo === 'string' with no harm.PHP uses IEEE 754 for floats, and your numbers are so small that they evalue to 0.See: http://en.wikipedia.org/wiki/IEEE_floating_pointI think that PHP reads this as a scientific syntax, which will be translated as:PHP interprets this as being 0 = 0.PHP is comparing those strings as floating point numbers, and they both are zero, so you MUST use the === operator,I'm trying to answer. 

If you are using "===", you also check with the type instead of the value.

If you are using "==", you just check the value is the same or not.you can reference to here and here.This is what it is seeing:

http://www.wolframalpha.com/input/?i=608E-4234&dataset=

http://www.wolframalpha.com/input/?i=272E-3063As they don't fit into the variable, they both equate to 0, or whatever default value php chooses, and therefore are equivalent.

in_array multiple values

daryl

[in_array multiple values](https://stackoverflow.com/questions/7542694/in-array-multiple-values)

How do I check for multiple values, such as:That's an example so you understand a bit better, I know it won't work.

2011-09-24 23:49:03Z

How do I check for multiple values, such as:That's an example so you understand a bit better, I know it won't work.Intersect the targets with the haystack and make sure the intersection is precisely equal to the targets:Note that you only need to verify the size of the resulting intersection is the same size as the array of target values to say that $haystack is a superset of $target.To verify that at least one value in $target is also in $haystack, you can do this check:As a developer, you should probably start learning set operations (difference, union, intersection). You can imagine your array as one "set", and the keys you are searching for the other.Going off of @Rok Kralj answer (best IMO) to check if any of needles exist in the haystack, you can use (bool) instead of !! which sometimes can be confusing during code review.https://glot.io/snippets/f7dhw4kmjuIMHO Mark Elliot's solution's best one for this problem. If you need to make more complex comparison operations between array elements AND you're on PHP 5.3, you might also think about something like the following:This relies on a closure; comparison function can become much more powerful.

Good luck!array_intersect() returns an array containing all the values of array1 that are present in all the arguments. Note that keys are preserved.Returns an array containing all of the values in array1 whose values exist in all of the parameters.empty() — Determine whether a variable is emptyReturns FALSE if var exists and has a non-empty, non-zero value. Otherwise returns TRUE.

Determining Referer in PHP

UnkwnTech

[Determining Referer in PHP](https://stackoverflow.com/questions/165975/determining-referer-in-php)

What is the most reliable and secure way to determine what page either sent, or called (via AJAX),  the current page.  I don't want to use the $_SERVER['HTTP_REFERER'], because of the (lack of) reliability, and I need the page being called to only come from requests originating on my site.

Edit: I am looking to verify that a script that preforms a series of actions is being called from a page on my website.

2008-10-03 07:17:41Z

What is the most reliable and secure way to determine what page either sent, or called (via AJAX),  the current page.  I don't want to use the $_SERVER['HTTP_REFERER'], because of the (lack of) reliability, and I need the page being called to only come from requests originating on my site.

Edit: I am looking to verify that a script that preforms a series of actions is being called from a page on my website.The REFERER is sent by the client's browser as part of the HTTP protocol, and is therefore unreliable indeed. It might not be there, it might be forged, you just can't trust it if it's for security reasons.If you want to verify if a request is coming from your site, well you can't, but you can verify the user has been to your site and/or is authenticated. Cookies are sent in AJAX requests so you can rely on that.What I have found best is a CSRF token and save it in the session for links where you need to verify the referrer. So if you are generating a FB callback then it would look something like this:Then the index.php will look like this:I do know of secure sites that do the equivalent of this for all their secure pages.Using $_SERVER['HTTP_REFERER']There is no reliable way to check this. It's really under client's hand to tell you where it came from. You could imagine to use cookie or sessions informations put only on some pages of your website, but doing so your would break user experience with bookmarks.We have only single option left after reading all the fake referrer problems:

i.e.

The page we desire to track as referrer should be kept in session, and as ajax called then checking in session if it has referrer page value and doing the action other wise no action.While on the other hand as he request any different page then make the referrer session value to null.Remember that session variable is set on desire page request only.

isset() and empty() - what to use

Dmitry Belaventsev

[isset() and empty() - what to use](https://stackoverflow.com/questions/7191626/isset-and-empty-what-to-use)

Could you help me to improve my coding style?:) In some tasks I need to check - is variable empty or contains something. To solve this task, I usually do the following. Check - is this variable set or not? If it's set - I check - it's empty or not?And I have a question - should I use isset() before empty() - is it necessary? TIA!

2011-08-25 13:55:48Z

Could you help me to improve my coding style?:) In some tasks I need to check - is variable empty or contains something. To solve this task, I usually do the following. Check - is this variable set or not? If it's set - I check - it's empty or not?And I have a question - should I use isset() before empty() - is it necessary? TIA!It depends what you are looking for, if you are just looking to see if it is empty just use empty as it checks whether it is set as well, if you want to know whether something is set or not use isset.Empty checks if the variable is set and if it is it checks it for null, "", 0, etcIsset just checks if is it set, it could be anything not nullWith empty, the following things are considered empty:From http://php.net/manual/en/function.empty.phpAs mentioned in the comments the lack of warning is also important with empty()PHP Manual saysRegarding issetPHP Manual saysYour code would be fine as:For example:In your particular case: if ($var).You need to use isset if you don't know whether the variable exists or not. Since you declared it on the very first line though, you know it exists, hence you don't need to, nay, should not use isset.The same goes for empty, only that empty also combines a check for the truthiness of the value. empty is equivalent to !isset($var) || !$var and !empty is equivalent to isset($var) && $var, or isset($var) && $var == true.If you only want to test a variable that should exist for truthiness, if ($var) is perfectly adequate and to the point.You can just use empty() - as seen in the documentation, it will return false if the variable has no value. An example on that same page: You can use isset if you just want to know if it is not NULL. Otherwise it seems empty() is just fine to use alone. Empty returns true if the var is not set. But isset returns true even if the var is not empty.Here are the outputs of isset() and empty() for the 4 possibilities: undeclared, null, false and true.You'll notice that all the 'isset' results are opposite of the 'empty' results except for case $b=false. All the values (except null which isn't a value but a non-value) that evaluate to false will return true when tested for by isset and false when tested by 'empty'.So use isset() when you're concerned about the existence of a variable.  And use empty when you're testing for true or false. If the actual type of emptiness matters, use is_null and ===0, ===false, ===''.This is a simple example. Hope it helps.edit: added isset in the event a variable isn't defined like above, it would cause an error, checking to see if its first set at the least will help remove some headache down the road.

A numeric string as array key in PHP

Wile E. Coyote

[A numeric string as array key in PHP](https://stackoverflow.com/questions/4100488/a-numeric-string-as-array-key-in-php)

Is it possible to use a numeric string like "123" as a key in a PHP array, without it being converted to an integer?printsI want

2010-11-04 19:30:13Z

Is it possible to use a numeric string like "123" as a key in a PHP array, without it being converted to an integer?printsI wantNo; no it's not:From the manual:AddendumBecause of the comments below, I thought it would be fun to point out that the behaviour is similar but not identical to JavaScript object keys.Yes, it is possible by array-casting an stdClass object:That gives you (up to PHP version 7.1):(Update: My original answer showed a more complicated way by using json_decode() and json_encode() which is not necessary.)Note the comment: It's unfortunately not possible to reference the value directly: $data['12'] will result in a notice.Update:

From PHP 7.2 on it is also possible to use a numeric string as key to reference the value: If you need to use a numeric key in a php data structure, an object will work.  And objects preserve order, so you can iterate.My workaround is:The space char (prepend) is a good solution because keep the int conversion:You'll see 55 as int.You can typecast the key to a string but it will eventually be converted to an integer due to PHP's loose-typing. See for yourself:From the PHP manual:I had this problem trying to merge arrays which had both string and integer keys. It was important that the integers would also be handled as string since these were names for input fields (as in shoe sizes etc,..)When I used $data = array_merge($data, $extra); PHP would 're-order' the keys. In an attempt doing the ordering, the integer keys (I tried with 6 - '6'- "6" even (string)"6" as keys) got renamed from 0 to n ... If you think about it, in most cases this would be the desired behaviour.You can work around this by using $data = $data + $extra; instead.

Pretty straight forward, but I didn't think of it at first ^^.WRONGI have a casting function which handles sequential to associative array casting, As workaround, you can encode PHP array into json object, with JSON_FORCE_OBJECT option.i.e., This example:will result in:I ran into this problem on an array with both '0' and '' as keys.  It meant that I couldn't check my array keys with either == or ===.The workaround is to cast the array keys back to strings before use.Regarding @david solution, please note that when you try to access the string values in the associative array, the numbers will not work. My guess is that they are casted to integers behind the scenes (when accessing the array) and no value is found. Accessing the values as integers won't work either. But you can use array_shift() to get the values or iterate the array.I had this problem while trying to sort an array where I needed the sort key to be a hex sha1.  When a resulting sha1 value has no letters, PHP turns the key into an integer.  But I needed to sort the array on the relative order of the strings.  So I needed to find a way to force the key to be a string without changing the sorting order. Looking at the ASCII chart (https://en.wikipedia.org/wiki/ASCII) the exclamation point sorts just about the same as space and certainly lower than all numbers and letters. So I appended an exclamation point at the end of the key string.

Easiest way to activate PHP and MySQL on Mac OS 10.6 (Snow Leopard), 10.7 (Lion), 10.8 (Mountain Lion)?

Matt Sephton

[Easiest way to activate PHP and MySQL on Mac OS 10.6 (Snow Leopard), 10.7 (Lion), 10.8 (Mountain Lion)?](https://stackoverflow.com/questions/1293484/easiest-way-to-activate-php-and-mysql-on-mac-os-10-6-snow-leopard-10-7-lion)

What is the easiest way to activate PHP and MySQL on Mac OS 10.6 (Snow Leopard), 10.7 (Lion), 10.8 (Mountain Lion)?I'd prefer to use any bundled versions before resorting to downloading from the PHP or MySQL websites. That also rules out MAMP and similar.I'm comfortable at the command line in Terminal.

2009-08-18 12:18:58Z

What is the easiest way to activate PHP and MySQL on Mac OS 10.6 (Snow Leopard), 10.7 (Lion), 10.8 (Mountain Lion)?I'd prefer to use any bundled versions before resorting to downloading from the PHP or MySQL websites. That also rules out MAMP and similar.I'm comfortable at the command line in Terminal.Open a good text editor (I'd recommend TextMate, but the free TextWrangler or vi or nano will do too), and open:Find the line: And uncomment it (remove the #).Download and install the latest MySQL version from mysql.com. Choose the x86_64 version for Intel (unless your Intel Mac is the original Macbook Pro or Macbook, which are not 64 bit chips. In those cases, use the 32 bit x86 version).Install all the MySQL components. Using the pref pane, start MySQL.In the Sharing System Pref, turn on (or if it was already on, turn off/on) Web Sharing.You should now have Apache/PHP/MySQL running.In 10.4 and 10.5 it was necessary to modify the php.ini file to point to the correct location of mysql.sock. There are reports that this is fixed in 10.6, but that doesn't appear to be the case for all of us, given some of the comments below.To complete your setup or MySQL:I strongly prefer HomeBrew over MacPorts for installing software from source.HomeBrew sequesters everything in /usr/local/Cellar so it doesn't spew files all over the place. (Yes, MacPorts keeps everything in /opt/local, but it requires sudo access, and I don't trust MacPorts with root.) Installing MySQL is as simple as:To start mysql, in Terminal type:There's a way to start it upon boot, but I like to start it manually.It's an invisible folder. Just hit Command + Shift + G (takes you to the Go to Folder menu item) and type /etc/. Then it will take you to inside that folder.This help me a lot:http://maestric.com/doc/mac/apache_php_mysql_snow_leopardIt also works for Mac OS X Lion :D.:EDIT:.

On my case the prefepane only allows to start and stop mysql, but after some issues i've uninstalled him.

If you need a application to run queries and create DB, you could use: Sequel Pro (it's free) or NavicatIf you need start and stop mysql in ~/.bash_profile you can add these lines:After reloaded the console just call: or agreding the desired action. 

Hope helped you.I would agree with Benjamin, either install MAMP or MacPorts (http://www.macports.org/). Keeping your PHP install separate is simpler and avoids messing up the core PHP install if you make any mistakes!MacPorts is a bit better for installing other software, such as ImageMagick. See a full list of available ports at http://www.macports.org/ports.phpMAMP just really does PHP, Apache and MySQL so any future PHP modules you want will need to be manually enabled. It is incredibly easy to use though.Considering it hasn't been released yet, I'm assuming this is a question for ahead-of-time or you have a developer's build.  As Benjamin mentioned, MAMP is the easiest way.  However, if you want a native install, the process should be like 10.5.  PHP comes installed on OS X by default (not always activated for some), just download the 32-bit version of MySQL, start Apache, and you should be good to go.  You may have to tweak Apache for PHP or MySQL, depending on what builds are present.  I didn't have to tweak anything to have it working.FYI - if anyone experience issues with launching Apache, and getting errors about /usr/sbin/apachectl: line 82: ulimit: open files: cannot modify limit: Invalid argumentit's because of a recent update to Apache in Snow Leopard. The fix is easy, just open /usr/sbin/apachectl and set ULIMIT=""http://blog.deversus.com/2010/11/mac-os-1065-apachectl-usrsbinapachectl-line-82-ulimit-open-files-cannot-modify-limit-invalid-argument/If you've upgraded to Mac OS X 10.8 Mountain Lion, and previously had a working system, all you should need to do is re-enable PHP as in Step 1 of the above chosen answer.You may also find the following Preference Pane useful for managing "web sharing" (Apache web server), which replaces system functionality removed in OS X 10.8:

http://clickontyler.com/blog/2012/02/web-sharing-mountain-lion/I also had to re-add my virtual hosts include line to the httpd.confIn addition to the native versions, but you may want to try BitNami MAMP Stacks (disclaimer, I am one of the developers). They are completely free, all-in-one bundles of Apache, MySQL, PHP and a several other third-party libraries and utilities that are useful when developing locally. In particular, they are completely self-contained so you can have several one installed at the same time, with different versions of Apache and MySQL and they will not interfere with each other. You can get them from http://bitnami.org/stack/mampstack or directly from the Mac OS X app store https://itunes.apple.com/app/mamp-stack/id571310406ammps was super easy for me and has a nice web-based configuration:There's a great guide here:https://discussions.apple.com/docs/DOC-3083However, it didn't work for me first try. I found this tip: run "httpd -t" in Terminao to check the syntax of your config files. Turns out using copy & paste from the tutorial introduced some strange characters. After fixing this, it worked great. There are some links from the guide for adding MySQL as well.This worked much better for me than MAMP. With MAMP, I was having delays of about 20 seconds or so before changes to the .php file would be reflected in the browser when you refresh, even if you cleared the cache, history, cookies, etc.This problem was resolved in MAMP PRO, but MAMP PRO had a new issue of its own: the .php files would be downloaded instead of being rendered as a page in the browser! I contacted support and they didn't know what was going on.The built-in Apache server didn't have any of these issues. Definitely the way to go. The guide below is almost identical to the one above, but it has user comments that are helpful:http://osxdaily.com/2012/09/02/start-apache-web-server-mac-os-x/#comment-572991

How to check if an array value exists?

Uffo

[How to check if an array value exists?](https://stackoverflow.com/questions/2440506/how-to-check-if-an-array-value-exists)

How can I check if $something['say'] has the value of 'bla' or 'omg'?

2010-03-13 23:33:40Z

How can I check if $something['say'] has the value of 'bla' or 'omg'?Using if?Btw, you are assigning an value with the key say twice, hence your array will result in an array with only one value.You could use the PHP in_array functionUsing: in_array()Here is output:  The 'prize_id' element is in the arrayUsing: array_key_exists()No outputIn conclusion, array_key_exists() does not work with a simple array. Its only to find whether an array key exist or not. Use in_array() instead.Here is more example:Here is PHP DEMOYou can use:To check if the index is defined: isset($something['say'])You can test whether an array has a certain element at all or not with isset() or sometimes even better array_key_exists() (the documentation explains the differences). If you can't be sure if the array has an element with the index 'say' you should test that first or you might get 'warning: undefined index....' messages.  As for the test whether the element's value is equal to a string you can use == or (again sometimes better) the identity operator === which doesn't allow type juggling.  in_array() is fine if you're only checking but if you need to check that a value exists and return the associated key, array_search is a better option.This will print "Key is 1"Just use the PHP function array_key_exists()Well, first off an associative array can only have a key defined once, so this array would never exist. Otherwise, just use in_array() to determine if that specific array element is in an array of possible solutions.Another use of in_array

 in_array() with an array as needle. i.e.You can use this functionUsage:

Has Facebook sharer.php changed to no longer accept detailed parameters?

tdous

[Has Facebook sharer.php changed to no longer accept detailed parameters?](https://stackoverflow.com/questions/20956229/has-facebook-sharer-php-changed-to-no-longer-accept-detailed-parameters)

We have been opening a sharing popup (via window.open) with the URL likeand until some unknown point in the last month or so everything was fine.What is happening now is; the popup dialog appears and correctly includes the Title, Description, Image and URL provided by the query string parameters, but when the post is submitted, the resulting wall post on Facebook is missing the Title, Description and Image, though it still links to the correct URL.Does anyone know if there have been recent changes which could have suddenly stopped this from working?Pre-empting some common responses:

2014-01-06 17:59:17Z

We have been opening a sharing popup (via window.open) with the URL likeand until some unknown point in the last month or so everything was fine.What is happening now is; the popup dialog appears and correctly includes the Title, Description, Image and URL provided by the query string parameters, but when the post is submitted, the resulting wall post on Facebook is missing the Title, Description and Image, though it still links to the correct URL.Does anyone know if there have been recent changes which could have suddenly stopped this from working?Pre-empting some common responses:Use dialog/feeds instead of sharer.phpOfficial answer from fb teamThe parameters have changed. The currently accepted answer states:But this is not entirely correct. Well, maybe they do not support or endorse them, but custom parameters can be used if you know the correct names. These include:For instance, you can share this very question with the following URL:I've built a tool which makes it easier to share URLs on Facebook with custom parameters. You can use it to generate your sharer.php link, just press the button and copy the URL from the tab that opens.Your problem is caused by the lack of markers OpenGraph, as you say it is not possible that you implement for some reason. For you, the only solution is to use the PHP Facebook API. You can find more examples in the Facebook Developers site:https://developers.facebook.com/docs/reference/phpI review your url in use:and see this differences:I use this URL string:In the "title" and "summary" section, I use the php function urlencode(); like this:And working fine for me.If you encode the & in your URL to %26 it works correctly. Just tested and verified.

Path of assets in CSS files in Symfony 2

apfelbox

[Path of assets in CSS files in Symfony 2](https://stackoverflow.com/questions/9500573/path-of-assets-in-css-files-in-symfony-2)

I have a CSS file with some paths in it (for images, fonts, etc.. url(..)).My path structure is like this:I want to reference my images in the stylesheet. I changed all paths in the CSS file to absolute paths. This is no solution, as the application should (and has to!) be working in a subdirectory, too.Use Assetic with filter="cssrewrite".So I changed all my paths in my CSS file to to represent the actual path from my resources directory to the /web/images directory. This does not work, since cssrewrite produces the following code:which is obviously the wrong path.After assetic:dump this path is created, which is still wrong:The twig code of Assetic:Since all CSS files end up in /web/css/stylexyz.css, I changed all paths in the CSS file to be relative:This (bad) solution works, except in the dev environment:

The CSS path is /app_dev.php/css/stylexyz.css and therefore the image path resulting from this is /app_dev.php/images/myimage.png, which results in a NotFoundHttpException.Is there a better and working solution?

2012-02-29 14:06:35Z

I have a CSS file with some paths in it (for images, fonts, etc.. url(..)).My path structure is like this:I want to reference my images in the stylesheet. I changed all paths in the CSS file to absolute paths. This is no solution, as the application should (and has to!) be working in a subdirectory, too.Use Assetic with filter="cssrewrite".So I changed all my paths in my CSS file to to represent the actual path from my resources directory to the /web/images directory. This does not work, since cssrewrite produces the following code:which is obviously the wrong path.After assetic:dump this path is created, which is still wrong:The twig code of Assetic:Since all CSS files end up in /web/css/stylexyz.css, I changed all paths in the CSS file to be relative:This (bad) solution works, except in the dev environment:

The CSS path is /app_dev.php/css/stylexyz.css and therefore the image path resulting from this is /app_dev.php/images/myimage.png, which results in a NotFoundHttpException.Is there a better and working solution?I have came across the very-very-same problem.In short:I have made a test with ALL possible (sane) combinations of the following:This gave me a total of 14 combinations on the same twig, and this route was launched fromthus giving 14 x 3 = 42 tests.Additionally, all this has been tested working in a subdirectory, so there is no way to fool by giving absolute URLs because they would simply not work.The tests were two unnamed images and then divs named from 'a' to 'f' for the CSS built FROM the public folder and named 'g to 'l' for the ones built from the internal path.I observed the following:Only 3 of the 14 tests were shown adequately on the three URLs. And NONE was from the "internal" folder (Resources/assets). It was a pre-requisite to have the spare CSS PUBLIC and then build with assetic FROM there.These are the results:So... ONLY

 - The second image

 - Div B

 - Div C

are the allowed syntaxes.Here there is the TWIG code:The container.css:And a.css, b.css, c.css, etc: all identical, just changing the color and the CSS selector.The "directories" structure is:Directories

All this came, because I did not want the individual original files exposed to the public, specially if I wanted to play with "less" filter or "sass" or similar... I did not want my "originals" published, only the compiled one.But there are good news. If you don't want to have the "spare CSS" in the public directories... install them not with --symlink, but really making a copy. Once "assetic" has built the compound CSS, and you can DELETE the original CSS from the filesystem, and leave the images:Compilation process

Note I do this for the --env=prod environment.Just a few final thoughts:BUT ANYWAY, CAUTION NOW: As now the originals are not there anymore (rm -Rf), there are only two solutions, not three. The working div "B" does not work anymore as it was an asset() call assuming there was the original asset. Only "C" (the compiled one) will work.So... there is ONLY a FINAL WINNER: Div "C" allows EXACTLY what it was asked in the topic: To be compiled, respect the path to the images and do not expose the original source to the public.The winner is CThe cssrewrite filter is not compatible with the @bundle notation for now. So you have two choices:I'll post what worked for me, thanks to @xavi-montero.Put your CSS in your bundle's Resource/public/css directory, and your images in say Resource/public/img.Change assetic paths to the form 'bundles/mybundle/css/*.css', in your layout.In config.yml, add rule css_rewrite to assetic:Now install assets and compile with assetic:This is good enough for the development box, and --symlink is useful, so you don't have to reinstall your assets (for example, you add a new image) when you enter through app_dev.php.For the production server, I just removed the '--symlink' option (in my deployment script), and added this command at the end:All is done. With this, you can use paths like this in your .css files: ../img/picture.jpegI had the same problem and I just tried using the following as a workaround. Seems to work so far. You can even create a dummy template that just contains references to all those static assets.Notice the omission of any output which means nothing shows up on the template. When I run assetic:dump the files are copied over to the desired location and the css includes work as expected.If it can help someone, we have struggled a lot with Assetic, and we are now doing the following in development mode:I offen manage css/js plugin with composer which install it under vendor.

I symlink those to the web/bundles directory, that's let composer update bundles as needed.exemple: 1 - symlink once at all (use command fromweb/bundles/2 - use asset where needed, in twig template : Regards.

Resumable downloads when using PHP to send the file?

Theo

[Resumable downloads when using PHP to send the file?](https://stackoverflow.com/questions/157318/resumable-downloads-when-using-php-to-send-the-file)

We are using a PHP scripting for tunnelling file downloads, since we don't want to expose the absolute path of downloadable file:Unfortunately we noticed that downloads passed through this script can't be resumed by the end user. Is there any way to support resumable downloads with such a PHP-based solution?

2008-10-01 12:22:19Z

We are using a PHP scripting for tunnelling file downloads, since we don't want to expose the absolute path of downloadable file:Unfortunately we noticed that downloads passed through this script can't be resumed by the end user. Is there any way to support resumable downloads with such a PHP-based solution?The first thing you need to do is to send the Accept-Ranges: bytes header in all responses, to tell the client that you support partial content. Then, if request with a Range: bytes=x-y header is received (with x and y being numbers) you parse the range the client is requesting, open the file as usual, seek x bytes ahead and send the next y - x bytes. Also set the response to HTTP/1.0 206 Partial Content.Without having tested anything, this could work, more or less:I may have missed something obvious, and I have most definitely ignored some potential sources of errors, but it should be a start.There's a description of partial content here and I found some info on partial content on the documentation page for fread.EDIT 2017/01 - I wrote a library to do this in PHP >=7.0 https://github.com/DaveRandom/ResumeEDIT 2016/02 - Code completely rewritten to a set of modular tools an an example usage, rather than a monolithic function. Corrections mentioned in comments below have been incorporated.A tested, working solution (based heavily on Theo's answer above) which deals with resumable downloads, in a set of a few standalone tools. This code requires PHP 5.4 or later.This solution can still only cope with one range per request, but under any circumstance with a standard browser that I can think of, this should not cause a problem.Example usage:This works 100% super check it 

I am using it and no problems any more.

            

Yes. Support byteranges. See RFC 2616 section 14.35 .It basically means that you should read the Range header, and start serving the file from the specified offset.This means that you can't use readfile(), since that serves the whole file. Instead, use fopen() first, then fseek() to the correct position, and then use fpassthru() to serve the file.A really nice way to solve this without having to "roll your own" PHP code is to use the mod_xsendfile Apache module. Then in PHP, you just set the appropriate headers. Apache gets to do its thing.If you're willing to install a new PECL module, the easiest way to support resumeable downloads with PHP is through http_send_file(), like thissource : http://www.php.net/manual/en/function.http-send-file.phpWe use it to serve database-stored content and it works like a charm !The top answer has various bugs.Here's my modified code:Yes, you can use the Range header for that. You need to give 3 more headers to the client for a full download:Than for an interrupted download you need to check the Range request header by:And in this case don't forget to serve the content with 206 status code:You'll get the $start and $to variables from the request header, and use fseek() to seek to the correct position in the file.This worked very well for me: https://github.com/pomle/php-serveFilePartialSmall composer enabled class which works the same way as pecl http_send_file. This means support for resumable downloads and throttle. https://github.com/diversen/http-send-fileResuming downloads in HTTP is done through the Range header. If the request contains a Range header, and if other indicators (e.g. If-Match, If-Unmodified-Since) indicate that the content hasn't changed since the download was started, you give a 206 response code (rather than 200), indicate the range of bytes you're returning in the Content-Range header, then provide that range in the response body.I don't know how to do that in PHP, though.Thanks Theo! your method did not directly work for streaming divx because i found the divx player was sending ranges like bytes=9932800-but it showed me how to do it so thanks :DYou could use the below code for byte range request support across any browser

how to check and set max_allowed_packet mysql variable [duplicate]

John

[how to check and set max_allowed_packet mysql variable [duplicate]](https://stackoverflow.com/questions/5688403/how-to-check-and-set-max-allowed-packet-mysql-variable)

Hi I am getting the error :[1153] Got a packet bigger than 'max_allowed_packet'bytesbut I made no changes in my source code and the hosting states that they did not made any change in server settings.I don't know what happened. But I am trying to find the reason.so, how to check max_allowed_packet mysql variable by php script?and is that possible to set it in source code?

2011-04-16 17:51:14Z

Hi I am getting the error :[1153] Got a packet bigger than 'max_allowed_packet'bytesbut I made no changes in my source code and the hosting states that they did not made any change in server settings.I don't know what happened. But I am trying to find the reason.so, how to check max_allowed_packet mysql variable by php script?and is that possible to set it in source code?max_allowed_packet

is set in mysql config, not on php sideYou can see it's curent value in mysql like this:You can try to change it like this, but it's unlikely this will work on shared hosting:You can read about it here http://dev.mysql.com/doc/refman/5.1/en/packet-too-large.htmlEDITThe [mysqld] is necessary to make the max_allowed_packet working since at least mysql version 5.5. Recently setup an instance on AWS EC2 with Drupal and Solr Search Engine, which required 32M max_allowed_packet. It you set the value under [mysqld_safe] (which is default settings came with the mysql installation) mode in /etc/my.cnf, it did no work. I did not dig into the problem. But after I change it to [mysqld] and restarted the mysqld, it worked.The following PHP worked for me (using mysqli extension but queries should be the same for other extensions):So if you've got a query you expect to be pretty long, you can make sure that mysql will accept it with something like:Notice that I added on an extra 1024 bytes to the length of the string because according to the manual, That should hopefully set the max_allowed_packet size large enough to handle your query.  I haven't tried this on a shared host, so the same caveat as @Glebushka applies.goto cpanel and login as Main Admin or Super AdministratorNow upload and enjoy!!!

Is there a point to minifying PHP?

Bojangles

[Is there a point to minifying PHP?](https://stackoverflow.com/questions/4079920/is-there-a-point-to-minifying-php)

I know you can minify PHP, but I'm wondering if there is any point. PHP is an interpreted language so will run a little slower than a compiled language. My question is: would clients see a visible speed improvement in page loads and such if I were to minify my PHP?Also, is there a way to compile PHP or something similar?

2010-11-02 16:38:37Z

I know you can minify PHP, but I'm wondering if there is any point. PHP is an interpreted language so will run a little slower than a compiled language. My question is: would clients see a visible speed improvement in page loads and such if I were to minify my PHP?Also, is there a way to compile PHP or something similar?PHP is compiled into bytecode, which is then interpreted on top of something resembling a VM.  Many other scripting languages follow the same general process, including Perl and Ruby.  It's not really a traditional interpreted language like, say, BASIC.There would be no effective speed increase if you attempted to "minify" the source.  You would get a major increase by using a bytecode cache like APC.Facebook introduced a compiler named HipHop that transforms PHP source into C++ code.  Rasmus Lerdorf, one of the big PHP guys did a presentation for Digg earlier this year that covers the performance improvements given by HipHop.  In short, it's not too much faster than optimizing code and using a bytecode cache.  HipHop is overkill for the majority of users.Facebook also recently unveiled HHVM, a new virtual machine based on their work making HipHop.  It's still rather new and it's not clear if it will provide a major performance boost to the general public.Just to make sure it's stated expressly, please read that presentation in full.  It points out numerous ways to benchmark and profile code and identify bottlenecks using tools like xdebug and xhprof, also from Facebook.Forgo the idea of minifying PHP in favor of using an opcode cache, like PHP Accelerator, or APC.Or something else like memcached With some rewriting (shorter variable names) you could save a few bytes of memory, but that's also seldomly significant.However I do design some of my applications in a way that allows to concatenate include scripts together. With php -w it can be compacted significantly, adding a little speed gain for script startup. On an opcode-enabled server this however only saves a few file mtime checks.This is less an answer than an advertisement. I'm been working on a PHP extension that translates Zend opcodes to run on a VM with static typing. It doesn't accelerate arbitrary PHP code. It does allow you to write code that run way faster than what regular PHP allows. The key here is static typing. On a modern CPU, a dynamic language eats branch misprediction penalty left and right. Fact that PHP arrays are hash tables also imposes high cost: lot of branch mispredictions, inefficient use of cache, poor memory prefetching, and no SIMD optimization whatsoever. Branch misprediction and cache misses in particular are achilles' heel for today's processors. My little VM sidesteps those problem by using static types and C array instead of hash table. The result ends up running roughly ten times faster. This is using bytecode interpretation. The extension can optionally compile a function through gcc. In that case, you get two to five times more speed.Here's the link for anyone interested:https://github.com/chung-leong/qb/wikiAgain, the extension is not a general PHP accelerator. You have to write code specific for it.There are PHP compilers... see this previous question for a list; but (unless you're the size of Facebook or are targetting your application to run client-side) they're generally a lot more trouble than they're worthSimple opcode caching will give you more benefit for the effort involved. Or profile your code to identify the bottlenecks, and then optimise it.You don't need to minify PHP. 

In order to get a better performance, install an Opcode cache; but the ideal solution would be to upgrade your PHP to the 5.5 version or above because the newer versions have an opcode cache by default called Zend Optimiser that is performing better than the other ones http://massivescale.blogspot.com/2013/06/php-55-zend-optimiser-opcache-vs-xcache.html.Yes there is one (non-technical) point. Your hoster can spy your code on his server. If you minify and uglify it, it is for spys more difficult to steal your ideas. One reason for minifying and uglifying php may be spy-protection. I think uglyfing code should one step in an automatic deployment.

How to post pictures to instagram using API

Altaf Hussain

[How to post pictures to instagram using API](https://stackoverflow.com/questions/18844706/how-to-post-pictures-to-instagram-using-api)

I am building a php application which needs to post the user uploaded picture directly to Instagram, but after a quick search i found that there is no such function in the API :( and it feels weird... because they should provide one. I am not sure if there is any other way (except the apps for android and iOS) to upload picture using php. Kindly give me any sort of idea if there is any possibility.I also read this ,How do I share a link and photo with Instagram using PHPThank you

2013-09-17 08:17:59Z

I am building a php application which needs to post the user uploaded picture directly to Instagram, but after a quick search i found that there is no such function in the API :( and it feels weird... because they should provide one. I am not sure if there is any other way (except the apps for android and iOS) to upload picture using php. Kindly give me any sort of idea if there is any possibility.I also read this ,How do I share a link and photo with Instagram using PHPThank youIf you read the link you shared, the accepted answer is:It seems you can emulate instagram on PC though.Bluestacks is an emulator which lets you run android apps on your PC/Mac etc.I'm not sure how well it works though.Update:Instagram are now banning accounts and removing the images based on this method. Please use with caution.It seems that everyone who has answered this question with something along the lines of it can't be done is somewhat correct. Officially, you cannot post a photo to Instagram with their API. However, if you reverse engineer the API, you can. Just copy and paste the code above in your text editor, change the few variables accordingly and VOILA! I wrote an article about this and I've done it many times. See a demo here.UPDATE

It is now possible:https://developers.facebook.com/docs/instagram-api/content-publishingThe Content Publishing API is a subset of Instagram Graph API endpoints that allow you to publish media objects. Publishing media objects with this API is a two step process — you first create a media object container, then publish the container on your Business Account.Instagram now allows businesses to schedule their posts, using the new Content Publishing Beta endpoints. https://developers.facebook.com/blog/post/2018/01/30/instagram-graph-api-updates/However, this blog post - https://business.instagram.com/blog/instagram-api-features-updates - makes it clear that they are only opening that API to their Facebook Marketing Partners or Instagram Partners.This link from Facebook - https://developers.facebook.com/docs/instagram-api/content-publishing - lists it as a closed beta. But this is how you would do it:You have a photo at...You want to publish it with the hashtag "#BronzFonz".You could use the /user/media edge to create the container like this:This would return a container ID (let's say 17889455560051444), which you would then publish using the /user/media_publish edge, like this:This example from the docs.I tried using IFTTT and many other services but all were doing things or post from Instagram to another platform not to Instagram. I read more to found Instagram does not provide any such API as of now.Using blue stack is again involving heavy installation and doing things manually only.However, you can use your Google Chrome on the desktop version to make a post on Instagram. It needs a bit tweak.You will notice a change in UI and the option to make a post on Instagram.

Your life is now easy.

Let me know an easier way if you can find any. For users who find this question, you can pass photos to the instagram sharing flow (from your app to the filters screen) on iPhone using iPhone hooks: http://help.instagram.com/355896521173347 Other than that, there is currently no way in version 1 of the api. There is no API to post photo to instagram using API , But there is a simple way is that install google extension " User Agent " it will covert your browser to android mobile chrome version . Here is the extension link https://chrome.google.com/webstore/detail/user-agent-switcher/clddifkhlkcojbojppdojfeeikdkgiae?utm_source=chrome-ntp-icon just click on extension icon and choose chrome for android and open Instagram.com 

Too much data with var_dump in symfony2 doctrine2

Mirage

[Too much data with var_dump in symfony2 doctrine2](https://stackoverflow.com/questions/11902099/too-much-data-with-var-dump-in-symfony2-doctrine2)

I have around 40 entities and many bidirectional relationships.

Whenever i use var_dump($user) or any entity my browser gets loaded with too much data of arrays and variables then it just crashed.i want to whats the problem.The data is being inserted fine. Can i cause issue in production.

2012-08-10 12:54:30Z

I have around 40 entities and many bidirectional relationships.

Whenever i use var_dump($user) or any entity my browser gets loaded with too much data of arrays and variables then it just crashed.i want to whats the problem.The data is being inserted fine. Can i cause issue in production.Replace var_dump() with the debug method dump() provided by Doctrine Common.It works for single objects and Doctrine collections and should prevent browser displaying issues you are having.well formatted :Simple and easy example.Symfony < 2.6You can use \Doctrine\Common\Util\Debug::dump($variable, $depth); it displays doctrine output without the proxy information.Symfony > 2.6If you are using symfony 2.6 or more, I strongly advice you to use dump().

It shows a well formated and colored output, and you can dynamically expend/hide rows.

The problem is that in a bidirectional relationship both entities have a link to each other, so while displaying entity1 var_dump will also have to print all properties of entity2, which include entity1 itself giving you a loop.The get_object_vars() improve the visualization too.With Symfony 2.6 you can now just use dump($var) in your controller and {{ dump(var) }} in twig.Make sure to add this to your AppKernal.php file, in the array('dev', 'test') section.use dump($user) and you can see perfect result in Symfony Profiler! good luckJust use

echo serialize($user);

Laravel - Session store not set on request

mattrick

[Laravel - Session store not set on request](https://stackoverflow.com/questions/34449770/laravel-session-store-not-set-on-request)

I recently created a new Laravel project and was following along the guide on Authentication. When I visit either my login or register route, I get the following error:I haven't edited any core Laravel files, I've only created the views and added the routes to my routes.php fileI don't have much experience with Laravel, so please excuse my ignorance. I'm aware that there is another question asking this same thing, but neither of the answers seem to work for me. Thanks for reading!Edit:Here's my register.blade.php as requested.

2015-12-24 08:42:04Z

I recently created a new Laravel project and was following along the guide on Authentication. When I visit either my login or register route, I get the following error:I haven't edited any core Laravel files, I've only created the views and added the routes to my routes.php fileI don't have much experience with Laravel, so please excuse my ignorance. I'm aware that there is another question asking this same thing, but neither of the answers seem to work for me. Thanks for reading!Edit:Here's my register.blade.php as requested.You'll need to use the web middleware if you need session state, CSRF protection, and more.If adding your routes inside the web middleware doesn't work for any reason then try adding this to $middleware into Kernel.phpIn my case (using Laravel 5.3) adding only the following 2 middleware allowed me to access session data in my API routes:Whole declaration ($middlewareGroups in Kernel.php):If Cas Bloem's answer does not apply (i.e. you've definitely got the web middleware on the applicable route), you might want to check the order of middlewares in your HTTP Kernel.The default order in Kernel.php is this:Note that VerifyCsrfToken comes after StartSession. If you've got these in a different order, the dependency between them can also lead to the Session store not set on request. exception. A problem can be that you try to access you session inside of your controller's  __constructor() function.From Laravel 5.3+ this is not possible anymore because it is not intended to work anyway, as stated in the upgrade guide.For more background information also read Taylor his response.WorkaroundIf you still want to use this, you can dynamically create a middleware and run it in the constructor, as described in the upgrade guide:Laravel [5.4]My solution was to use global session helper:

session()Its functionality is a little bit harder than $request->session().writing:pushing:retrieving:In my case I added the following 4 lines to $middlewareGroups (in app/Http/Kernel.php):IMPORTANT: The 4 new lines must be added BEFORE 'throttle' and 'bindings'!Otherwise a "CSRF token not match" error will rise. I've struggled in this for several hours just to find the order is important.This allowed me to access session in my API. I also added VerifyCsrfToken as when cookies/sessions are involved, CSRF needs to be taken care of.in my case it was just to put 

return ; 

at the end of function where  i have set session If you are using CSRF enter 'before'=>'csrf'In your case

Route::get('auth/login', ['before'=>'csrf','uses' => 'Auth\AuthController@getLogin', 'as' => 'login']);For more details view Laravel 5 Documentation Security Protecting RoutesDo you can use ->stateless() before the ->redirect().

Then you dont need the session anymore.It's not on the laravel documentation, I have been an hour to achieve this:My session didn't persist until i used the "save" method...Laravel 5.3+  web middleware group is automatically applied to your routes/web.php file by the RouteServiceProvider. Unless you modify kernel $middlewareGroups array in an unsupported order, probably you are trying to inject requests as a regular dependency from the constructor.Use request asinstead of 

Maximum execution time in phpMyadmin

ahmed

[Maximum execution time in phpMyadmin](https://stackoverflow.com/questions/1263680/maximum-execution-time-in-phpmyadmin)

When I try to execute (some) queries in phpMyadmin I get this errorbecause I have a very large table (over 9 millions records)I have edited the file C:\xampp\php\php.ini and changed the value of "max execution time" from 60 to 1000 then restarts the PHP and still have the same error.Any solution?

2009-08-12 00:32:47Z

When I try to execute (some) queries in phpMyadmin I get this errorbecause I have a very large table (over 9 millions records)I have edited the file C:\xampp\php\php.ini and changed the value of "max execution time" from 60 to 1000 then restarts the PHP and still have the same error.Any solution?I have the same error, please go toLook for : $cfg['ExecTimeLimit'] = 600;You can change '600' to any higher value, like '6000'.Maximum execution time in seconds is (0 for no limit). This will fix your error.For Xampp version on WindowsAdd this line to xampp\phpmyadmin\config.inc.phpAnd Change xampp\php\php.ini toAnd change xampp\mysql\bin\my.iniI faced the same problem while executing a curl.

I got it right when I changed the following in the php.ini file:and also Probably your problem should be solved by making above two changes and restarting the apache server.Even after changing the above the problem persists and if you think it's because of some database operation using mysql you can try changing this also:Your change should work. However, there are potentially few php.ini configuration files with the 'xampp' stack. Try to identify whether or not there's an 'apache' specific php.ini. One potential location is:C:\xampp\apache\bin\php.iniChanging php.ini for a web application requires restarting Apache.You should verify that the change took place by running a PHP script that executes the function phpinfo().  The output of that function will tell you a lot of PHP parameters, including the timeout value.You might also have changed a copy of php.ini that is not the same file used by Apache.ini_set('max_execution_time', 0); or create file name called php.ini and enter the first line max_execution_time=0 then save it and put the file in your root folder of your application.That's it. Good luck.Well for Wamp User,Go to: wamp\apps\phpmyadmin3.3.9\librariesUnder line 536, locate $cfg['ExecTimeLimit'] = 0;and change the value from 0 to 6000. e.gToRestart wamp server and phew.It works like magic !In php.ini you must check mysql.connect_timeout either. 

That's responsible for socket closing and returning the Fatal.

So, for example, change it to:That time will be always counted in seconds, so in my example you have 1 hour.What worked for me on WAMP was modifying file:

\Wamp64\alias\phpmyadmin.conf, lines:I did not have to change the library file.Probabily you are using XMAPP as service, to restart XMAPP properly, you have to open XMAPP control panel un-check  both  "Svc" mdodules against Apache and MySQL. Then click on exit, now restart XMAPP and you are done. Go to xampp/php/php.iniFind this line:And change its value to any number you want. Restart Apache.'ZERO' for unlimited time.C:\Apache24\htdocs\phpmyadmin\libraries\Config.class.phpYou could also import the large file right from MySQL as query or a PHP query.500,000 rows just took me 18 seconds to import on local server, using this method.(create table first) - then:

Can I Install Laravel without using Composer?

ryanwinchester

[Can I Install Laravel without using Composer?](https://stackoverflow.com/questions/15940140/can-i-install-laravel-without-using-composer)

I'd like to know if I can install or use the Laravel PHP framework on any web server without using Composer (PHP package/dependency manager) every time?I would like to be able to drop my app on to any web server (like a shared server without access to the command line).If I run composer install the first time (locally), then all the dependencies should be present, correct?Then, I should be able to drop it onto any server with all of the files (including the vendor directory)?

2013-04-11 03:18:56Z

I'd like to know if I can install or use the Laravel PHP framework on any web server without using Composer (PHP package/dependency manager) every time?I would like to be able to drop my app on to any web server (like a shared server without access to the command line).If I run composer install the first time (locally), then all the dependencies should be present, correct?Then, I should be able to drop it onto any server with all of the files (including the vendor directory)?If you really wanted to, you could do all the work that Composer does manually, but you definitely should not. Installing Composer is easy, it's just a matter of getting the composer.phar file and running commands on it.You do not need to run Composer on your server as well as locally, once you run composer install or composer update your project will have all its dependencies available and you can just upload it straight to your server.You cannot install laravel local without composer in your project.On this site you can download everything what you can download also with the composer build tool. But you do not need a composer installation. Of course laravel is also present there: https://php-download.com/package/laravel/laravelIf you have shared server and you are not able to install composer and run cmd to install a new package or update an existing package. You can one thing by installing composer on your local machine and install(ex composer require package/name) or update(ex composer update package/name) all the packages, then upload your vendor directory on the server with your code. it will work for you same as in your local environment.NOTE: I strongly recommend that you should use the Laravel with the composer, it is an important part of laravel and you can try to convince your client to provide a server that supports laravel. Please check the link below and you can find the server requirements. https://laravel.com/docs/5.5#installationIf you don't want to use composer on server then you will have to run composer install/update and download all the libraries locally and then manually upload all those files on the server i.e. Vendor Directory.In-Case of shared hosting where you can't connect to server with shh there you might have to do that but it will take lot of time to upload all the files on server so I would recommend that you should composer and then download the libraries through composer install/update.Yes, you can install all project dependencies via composer in your localhost first, and then transfer all the files via FTP to your actual website.Just download the zip file from github and upload to your htdoc and voilà it will work for you

Tetris-ing an array

Pekka

[Tetris-ing an array](https://stackoverflow.com/questions/3275258/tetris-ing-an-array)

Consider the following array:what is the shortest and most elegant way of detecting the common base path - in this caseand removing it from all elements in the array?

2010-07-18 11:04:15Z

Consider the following array:what is the shortest and most elegant way of detecting the common base path - in this caseand removing it from all elements in the array?Write a function longest_common_prefix that takes two strings as input. Then apply it to the strings in any order to reduce them to their common prefix. Since it is associative and commutative the order doesn't matter for the result.This is the same as for other binary operations like for example addition or greatest common divisor.Load them into a trie data structure. Starting from the parent node, see which is having a children count great than one. Once you find that magic node, just dismantle the parent node structure and have the current node as root.Well, considering that you can use XOR in this situation to find the common parts of the string.  Any time you xor two bytes that are the same, you get a nullbyte as the output.  So we can use that to our advantage:After that single loop, the $length variable will be equal to the longest common basepart between the array of strings.  Then, we can extract the common part from the first element:And there you have it.  As a function:Note that it does use more than one iteration, but those iterations are done in libraries, so in interpreted languages this will have a huge efficiency gain...Now, if you want only full paths, we need to truncate to the last / character.  So:Now, it may overly cut two strings such as /foo/bar and /foo/bar/baz will be cut to /foo.  But short of adding another iteration round to determine if the next character is either / or end-of-string, I can't see a way around that...A naive approach would be to explode the paths at the / and successive compare every element in the arrays. So e.g. the first element would be empty in all arrays, so it will be removed, the next element will be www, it is the same in all arrays, so it gets removed, etc.Something like (untested)Afterwards you just have to implode the elements in $exploded_paths again:Which gives me:This might not scale well ;)Ok, I'm not sure this is bullet-proof, but I think it works:This will take the first value in the array as reference string. Then it will iterate over the reference string and compare each char with the char of the second string at the same position. If a char doesnt match, the reference string will be shortened to the position of the char and the next string is compared. The function will return the shortest matching string then.Performance depends on the strings given. The earlier the reference string gets shorter, the quicker the code will finish. I really have no clue how to put that in a formula though.I found that Artefacto's approach to sort the strings increases performance. Addingbefore the array_reduce will significantly increase performance.Also note that this will return the longest matching initial substring, which is more versatile but wont give you the common path. You have to runon the result. And then you can use the result to remove the valueswhich should give:Feedback welcome.You could remove prefix the fastest way, reading each character only once:This has de advantage of not having linear time complexity; however, for most cases the sort will definitely not be the operation taking more time.Basically, the clever part (at least I couldn't find a fault with it) here is that after sorting you will only have to compare the first path with the last.EDIT Variant of my original method using an array_walk to rebuild the arrayEDITThe most efficient and elegant answer is likely to involve taking functions and methods from each of the provided answersI would explode the values based on the / and then use array_intersect_assoc to detect the common elements and ensure they have the correct corresponding index in the array. The resulting array could be recombined to produce the common path.This is untested, but, the idea is that the $commonPath array only ever contains the elements of the path that have been contained in all path arrays that have been compared against it. When the loop is complete, we simply recombine it with / to get the true $commonPathUpdate

As pointed out by Felix Kling, array_intersect won't consider paths that have common elements but in different orders... To solve this, I used array_intersect_assoc instead of array_intersectUpdate

Added code to remove the common path (or tetris it!) from the array as well.The problem can be simplified if just viewed from the string comparison angle. This is probably faster than array-splitting:Perhaps porting the algorithm Python's os.path.commonprefix(m) uses would work?That is, uh... something likeAfter that you can just substr each element of the original list with the length of the common prefix as the start offset.I'll throw my hat in the ring …Usage:Well, there are already some solutions here but, just because it was fun:Output:This works fine... similar to mark baker but uses str_replaceProbably too naive and noobish but it works. I have used this algorithm:Output::)

PHP Remove elements from associative array

user648198

[PHP Remove elements from associative array](https://stackoverflow.com/questions/5450148/php-remove-elements-from-associative-array)

I have an PHP array that looks something like this: When I var_dump the array values i get this:I wanted to remove Completed and Mark As Spam. I know I can unset[$array[3],$array[4]), but the problem is that sometimes the index number can be different.Is there a way to remove them by matching the value name instead of the key value?

2011-03-27 15:17:20Z

I have an PHP array that looks something like this: When I var_dump the array values i get this:I wanted to remove Completed and Mark As Spam. I know I can unset[$array[3],$array[4]), but the problem is that sometimes the index number can be different.Is there a way to remove them by matching the value name instead of the key value?Your array is quite strange : why not just use the key as index, and the value as... the value ?Wouldn't it be a lot easier if your array was declared like this :That would allow you to use your values of key as indexes to access the array... And you'd be able to use functions to search on the values, such as array_search() :Easier than with your array, no ?Instead, with your array that looks like this :You'll have to loop over all items, to analyse the value, and unset the right items :Even if do-able, it's not that simple... and I insist : can you not change the format of your array, to work with a simpler key/value system ?For 2D arrays...You can use this Why do not use array_diff?Just note that your array would be reindexed.Try this:/edit

As mentioned by JohnP, this method only works for non-nested arrays.The way to do this to take your nested target array and copy it in single step to a non-nested array.

Delete the key(s) and then assign the final trimmed array to the nested node of the earlier array.

Here is a code to make it simple:I kinda disagree with the accepted answer. Sometimes an application architecture doesn't want you to mess with the array id, or makes it inconvenient. For instance, I use CakePHP quite a lot, and a database query returns the primary key as a value in each record, very similar to the above. Assuming the array is not stupidly large, I would use array_filter. This will create a copy of the array, minus the records you want to remove, which you can assign back to the original array variable. Although this may seem inefficient it's actually very much in vogue these days to have variables be immutable, and the fact that most php array functions return a new array rather than futzing with the original implies that PHP kinda wants you to do this too. And the more you work with arrays, and realize how difficult and annoying the unset() function is, this approach makes a lot of sense.Anyway:You can use whatever inclusion logic (eg. your id field) in the embedded function that you want.for single array Item use reset($item)

Include CSS,javascript file in Yii Framework

viji

[Include CSS,javascript file in Yii Framework](https://stackoverflow.com/questions/1998449/include-css-javascript-file-in-yii-framework)

How to include a Javascript or CSS file in Yii Framework?I want to create a page on my site that has a little Javascript application running, so I want to include .js and .css files in a specific view.

2010-01-04 09:34:29Z

How to include a Javascript or CSS file in Yii Framework?I want to create a page on my site that has a little Javascript application running, so I want to include .js and .css files in a specific view.Something like this:You can do so by addingI liked to answer this question.Their are many places where we have css & javascript files, like in css folder which is outside the protected folder, css & js files of extension & widgets which we need to include externally sometime when use ajax a lot, js & css files of core framework which also we need to include externally sometime. So their are some ways to do this.Include core js files of framework like jquery.js, jquery.ui.jsInclude files from css folder outside of protected folder.Include css & js files from extension or widgets.Here fancybox is an extension which is placed under protected folder.

Files we including has path : /protected/extensions/fancybox/assets/Also we can include core framework files:

Example : I am including CListView js file.For more detail Look at my blog articleEasy in your conf/main.php. This is my example with bootstrap. You can see that hereIn the view, add the following:Please notice the second parameter when you register the js file, it's the position of your script, when you set it CClientScript::POS_END, you let the HTML renders before the javascript is loaded.There are many methods that we can include javascript, css into your Yii App. Today I will demonstrate three simple and helpul methods.A simple way to add js, css by editing config/main.phpUsing getClientScriptUsually, We add in block of code into Controller or layout of your themeOr shorter:Include core js filesFaster Yii API Document: http://yii.codexamples.com/To include JS and CSS files in a specific view you can do it via controller by passing the parameters false, true, which will include the CSS and JS for, e.g.:here is a good solution to use CDN and offline scriptsI use this code in every application I build, so you can use this in any app.Included Scripts:STEP1: put this code in config/main.phpSTEP2:create resoreses folder in root app folder and put your script thereSTEP3:put this code in components/controller.phpSTEP4:call the functions like this in //layouts/main.phpDo somthing like this by adding these line to your view files;Also, if you want to add module assets both CSS and JS, you can use the following logic. See how you need to indicate the correct path to getPathOfAlias:The above code has been taken from GPLed Yii based Webshop app.You can also add scripts from controller action. Just add this line in an action method then that script will apear only in that view:where POS_HEAD tell framework to put script in head sectionIn Yii framework, You can include js and css using below method.Including CSS:Including JS:Including Image:Note: By using layout concept in yii, You can add css and js instead of specifying in view template.link must input over the first php tag in the view pagUsing bootstrap extensionmy css file: themes/bootstrap/css/style.cssmy js file: root/js/script.jsat theme/bootstrap/views/layouts/main.php This was also an easy way to add script and css in main.php    If you are using Theme then you can the below Syntaxinclude CSS File :Include JS FileIf you are not using themeUse Like this

How do I resolve a HTTP 414「Request URI too long」error?

JPro

[How do I resolve a HTTP 414「Request URI too long」error?](https://stackoverflow.com/questions/2891574/how-do-i-resolve-a-http-414-request-uri-too-long-error)

I have developed a PHP web app. I am giving an option to the user to update multiple issues on one go. In doing so, sometimes the user is encountering this error. Is there any way to increase the lenght of URL in apache?

2010-05-23 11:50:15Z

I have developed a PHP web app. I am giving an option to the user to update multiple issues on one go. In doing so, sometimes the user is encountering this error. Is there any way to increase the lenght of URL in apache?Under Apache, the limit is a configurable value, LimitRequestLine. Change this value to something larger than its default of 8190 if you want to support a longer request URI. The value is in /etc/apache2/apache2.conf. If not, add a new line (LimitRequestLine 10000) under AccessFileName .htaccess. However, note that if you're actually running into this limit, you are probably abusing GET to begin with. You should use POST to transmit this sort of data -- especially since you even concede that you're using it to update values. If you check the link above, you'll notice that Apache even says "Under normal conditions, the value should not be changed from the default."Based on John's answer, I changed the GET request to a POST request. It works, without having to change the server configuration. So I went looking how to implement this. The following pages were helpful:jQuery Ajax POST example with PHP

(Note the sanitize posted data remark) andhttp://www.openjs.com/articles/ajax_xmlhttp_using_post.phpBasically, the difference is that the GET request has the url and parameters in one string and then sends null:whereas the POST request sends the url and the parameters in separate commands:Here is a working example:ajaxPOST.html:ajaxPOST.php:I just sent over 12,000 characters without any problems.I have a simple workaround. Suppose your URI has a string stringdata that is too long. You can simply break it into a number of parts depending on the limits of your server. Then submit the first one, in my case to write a file. Then submit the next ones to append to previously added data.I got this error after using $.getJSON() from JQuery. I just changed to post:An excerpt from the RFC 2616: Hypertext Transfer Protocol -- HTTP/1.1:

Logical Operators, || or OR?

ItsPronounced

[Logical Operators, || or OR?](https://stackoverflow.com/questions/5998309/logical-operators-or-or)

I remember reading a while back in regards to logical operators that in the case of OR, using || was better than or (or vice versa).I just had to use this in my project when it came back to me, but I can't remember which operator was recommended or if it was even true.Which is better and why?

2011-05-13 22:15:03Z

I remember reading a while back in regards to logical operators that in the case of OR, using || was better than or (or vice versa).I just had to use this in my project when it came back to me, but I can't remember which operator was recommended or if it was even true.Which is better and why?There is no "better" but the more common one is ||. They have different precedence and || would work like one would expect normally.See also: Logical operators (the following example is taken from there):They are used for different purposes and in fact have different operator precedences.  The && and || operators are intended for Boolean conditions, whereas and and or are intended for control flow.For example, the following is a Boolean condition:This differs from control flow:The difference between respectively || and OR and && and AND is operator precedence :Source: http://wallstreetdeveloper.com/php-logical-operators/Here is sample code for working with logical operators:I know it's an old topic but still. I've just met the problem in the code I am debugging at work and maybe somebody may have similar issue...Let's say the code looks like this:You would expect (as you are used to from e.g. javascript) that when $this->positions() returns false or null, $positions is empty array. But it isn't. The value is TRUE or FALSE depends on what $this->positions() returns. If you need to get value of $this->positions() or empty array, you have to use:EDIT:The above example doesn't work as intended but the truth is that || and or is not the same... Try this:This is the result:So, actually the third option ?: is the correct solution when you want to set returned value or empty array.Tested with PHP 7.2.1I don't think one is inherently better than another one, but I would suggest sticking with || because it is the default in most languages.EDIT: As others have pointed out there is indeed a difference between the two.There is nothing bad or better, It just depends on the precedence of operators. Since || has higher precedence than or, so || is mostly used.Some languages use short-circuit, and others use full Boolean evaluation (if you know, this is similar to the directive $B in Pascal).Explanations:In this example the function B() will never be executed. Since the function A() returns TRUE, the result of the OR statement is known from the first part without it being necessary to evaluate the second part of the expression.However with ( A() || B() ), the second part is always evaluated regardless of the value of the first.For optimized programming, you should always use OR which is faster (except for the case when the first part returns false and second part actually needs to be evaluated).

How to access route, post, get etc. parameters in Zend Framework 2

Matsemann

[How to access route, post, get etc. parameters in Zend Framework 2](https://stackoverflow.com/questions/12077126/how-to-access-route-post-get-etc-parameters-in-zend-framework-2)

How can I get various parameters related to the page request in zf2? Like post/get parameters, the route being accessed, headers sent and files uploaded.

2012-08-22 16:05:25Z

How can I get various parameters related to the page request in zf2? Like post/get parameters, the route being accessed, headers sent and files uploaded.The easiest way to do that would be to use the Params plugin, introduced in beta5. It has utility methods to make it easy to access different types of parameters. As always, reading the tests can prove valuable to understand how something is supposed to be used.To get the value of a named parameter in a controller, you will need to select the appropriate method for the type of parameter you are looking for and pass in the name. All of these methods also support default values that will be returned if no parameter with the given name is found. When visiting http://example.com/?orderby=birthdate,

$orderBy will have the value birthdate.

When visiting http://example.com/,

$orderBy will have the default value name.

 To get all parameters of one type, just don't pass in anything and the Params plugin will return an array of values with their names as keys. When visiting http://example.com/?orderby=birthdate&filter=hasphone $allGetValues will be an array like If you check the source code for the Params plugin, you will see that it's just a thin wrapper around other controllers to allow for more consistent parameter retrieval. If you for some reason want/need to access them directly, you can see in the source code how it's done.NOTE: You could have used the superglobals $_GET, $_POST etc., but that is discouraged.The easisest way to get a posted json string, for example, is to read the contents of 'php://input' and then decode it. For example i had a simple Zend route:and i wanted to post data to it using Angular's $http.post. The post was fine but the retrive method in Zend didn't get anything in this case. So my solution was, after trying all kinds of methods like $_POST and the other methods stated above, to read from 'php://':I got my json array in the end. 

Hope this helps.All the above methods will work fine if your content-type is "application/-www-form-urlencoded".

But if your content-type is "application/json" then you will have to do the following:$params = json_decode(file_get_contents('php://input'), true);

print_r($params);Reason : See #7 in https://www.toptal.com/php/10-most-common-mistakes-php-programmers-makeIf You have no access to plugin for instance outside of  controller You can get params from servicelocator like this

Why can't I overload constructors in PHP?

tom

[Why can't I overload constructors in PHP?](https://stackoverflow.com/questions/2169448/why-cant-i-overload-constructors-in-php)

I have abandoned all hope of ever being able to overload my constructors in PHP, so what I'd really like to know is why.Is there even a reason for it? Does it create inherently bad code? Is it widely accepted language design to not allow it, or are other languages nicer than PHP?

2010-01-30 21:12:19Z

I have abandoned all hope of ever being able to overload my constructors in PHP, so what I'd really like to know is why.Is there even a reason for it? Does it create inherently bad code? Is it widely accepted language design to not allow it, or are other languages nicer than PHP?You can use variable arguments to produce the same effect. Without strong typing, it doesn't make much sense to add, given default arguments and all of the other "work arounds."You can't overload ANY method in PHP. If you want to be able to instantiate a PHP object while passing several different combinations of parameters, use the factory pattern with a private constructor. For example:True overloading is indeed unsupported in PHP. As @Pestilence mentioned, you can use variable arguments. Some people just use an Associative Array of various options to overcome this.For completeness, I'll suggest Fluent Interfaces.  The idea is that by adding return $this; to the end of your methods you can chain calls together.  So instead of(which simply wouldn't work), you can do:That way you can pick exactly which properties you want to set.  In a lot of ways it's similar to passing in an array of options to your initial call:PHP Manual: Function Arguments, Default ValuesI have overcome this simply by using default values for function parameters. In __constuct, list the required parameters first. List the optional parameters after that in the general form $param = null.This can be instantiated as:orThis is not a perfect solution, but I have made this work by separating parameters into absolutely mandatory parameters no matter when the object is constructed, and, as a group, optional parameters listed in order of importance.It works.they say this work:and, it seem every one are happy with it, but for me it didn't work...

if you get it to work, its one kind of overloading too...it take all argoments and pass them to the secondary function constructor...?>You can use conditional statements in your constructor and then perform your task.

Eg.and so on...You can of course overload any function in PHP using __call() and __callStatic() magic methods.

It is a little bit tricky, but the implementation can do exactly what your are looking for.

Here is the resource on the official PHP.net website:https://www.php.net/manual/en/language.oop5.overloading.php#object.callAnd here is the example which works for both static and non-static methods:And you can apply this to constructors by using the following code in the __construct():Pretty easy.

And you may want to implement __clone() to make a clone copy of the class with the method that you called without having the function that you called in every instance...As far as I know, constructor overloading in PHP is not allowed, simply because the developers of PHP did not include that functionality - this is one of the many complaints about PHP.I've heard of tricks and workarounds, but true overloading in the OOP sense is missing.  Maybe in future versions, it will be included.I'm really no OOP expert, but as I understand it overloading means the ability of a method to act differently depending in the parameters it receives as input. This is very much possible with PHP, you just don't declare the input types since PHP does not have strong typing, and all the overloading is done at runtime instead of compile time.I think we can also use constructor with default arguments as a potential substitute to constructor overloading in PHP.Still, it is really sad that true constructor overloading is not supported in PHP.

curl POST format for CURLOPT_POSTFIELDS

Ken

[curl POST format for CURLOPT_POSTFIELDS](https://stackoverflow.com/questions/5224790/curl-post-format-for-curlopt-postfields)

When I use curl via POST and set CURLOPT_POSTFIELD do I have to urlencode or any special format?for example: If I want to post 2 fields, first and last:what is the exact code/format that should be used with curl?

2011-03-07 20:20:56Z

When I use curl via POST and set CURLOPT_POSTFIELD do I have to urlencode or any special format?for example: If I want to post 2 fields, first and last:what is the exact code/format that should be used with curl?In case you are sending a string, urlencode() it. Otherwise if array, it should be key=>value paired and the Content-type header is automatically set to multipart/form-data.Also, you don't have to create extra functions to build the query for your arrays, you already have that:EDIT: From php5 upwards, usage of http_build_query is recommended:Simple example from the manual:before php5:From the manual:So something like this should work perfectly (with parameters passed in a associative array):You can pass an array and let php/curl do the dirty work of encoding etc.According to the PHP manual, data passed to cURL as a string should be URLencoded.  See the page for curl_setopt() and search for CURLOPT_POSTFIELDS.For CURLOPT_POSTFIELDS, the parameters can either be passed as a urlencoded string like para1=val1&para2=val2&.. or as an array with the field name as key and field data as valueTry the following format :One other major difference that is not yet mentioned here is that CURLOPT_POSTFIELDS can't handle nested arrays.If we take the nested array ['a' => 1, 'b' => [2, 3, 4]] then this should be be parameterized as a=1&b[]=2&b[]=3&b[]=4 (the [ and ] will be/should be URL encoded). This will be converted back automatically into a nested array on the other end (assuming here the other end is also PHP).This will work:This won't work:This will give you a notice. Code execution will continue and your endpoint will receive parameter b as string "Array":for nested arrays you can use:To send data the standard way, as a browser would with a form, just pass an associative array. As stated by PHP's manual:Neverthless, when communicating with JSON APIs, content must be JSON encoded for the API to understand our POST data.In such cases, content must be explicitely encoded as JSON :When communicating in JSON, we also usually set accept and content-type headers accordingly:Interestingly the way Postman does POST is a complete GET operation with these 2 additional options:Just another way, and it works very well.This answer took me forever to find as well. I discovered that all you have to do is concatenate the URL ('?' after the file name and extension) with the URL-encoded query string. It doesn't even look like you have to set the POST cURL options. See the fake example below:You can also use file_get_contents():

How to create an array from a CSV file using PHP and the fgetcsv function

Thomas

[How to create an array from a CSV file using PHP and the fgetcsv function](https://stackoverflow.com/questions/1269562/how-to-create-an-array-from-a-csv-file-using-php-and-the-fgetcsv-function)

Can someone kindly provide a code to create an array from a CSV file using fgetcsv?I've used the following code to create an array from a simple CSV file, but it doesn't work right when one of my fields has multiple commas - such as addresses.*Also, str_getcsv is not supported by my hosting service.The above code doesn't work with the following CSV file example.  First column is name, second column is address, third column is marital status.

2009-08-13 01:18:08Z

Can someone kindly provide a code to create an array from a CSV file using fgetcsv?I've used the following code to create an array from a simple CSV file, but it doesn't work right when one of my fields has multiple commas - such as addresses.*Also, str_getcsv is not supported by my hosting service.The above code doesn't work with the following CSV file example.  First column is name, second column is address, third column is marital status.Like you said in your title, fgetcsv is the way to go. It's pretty darn easy to use.You'll want to put more error checking in there in case fopen() fails, but this works to read a CSV file line by line and parse the line into an array.I think the str_getcsv() syntax is much cleaner, it also doesn't require the CSV to be stored in the file system.Or for a line by line solution:Or for a line by line solution with no str_getcsv():I have created a function which will convert a csv string to an array. The function knows how to escape special characters, and it works with or without enclosure chars.I tried it with your csv sample and it works as expected!Old question, but still relevant for PHP 5.2 users. str_getcsv is available from PHP 5.3. I've written a small function that works with fgetcsv itself.Below is my function from https://gist.github.com/4152628:

ReturnsBegin Reading CSVTry this..This function will return array with Header values as array keys.    To get an array with the right keys, you can try this:Please fin below a link to the function from @knagode, enhanced with a skip rows parameter.

https://gist.github.com/gabrieljenik/47fc38ae47d99868d5b3#file-csv_to_arrayI came up with this pretty basic code. I think it could be useful to anyone.If you want each line to be in an array, and each cell in the line in array:Try this code:

Execute raw SQL using Doctrine 2

Jiew Meng

[Execute raw SQL using Doctrine 2](https://stackoverflow.com/questions/3325012/execute-raw-sql-using-doctrine-2)

I want to execute raw SQL using Doctrine 2I need to truncate the database tables and initialize tables with default test data.

2010-07-24 12:09:27Z

I want to execute raw SQL using Doctrine 2I need to truncate the database tables and initialize tables with default test data.Here's an example of a raw query in Doctrine 2 that I'm doing:I got it to work by doing this, assuming you are using PDO.You can change the FETCH_TYPE to suit your needs. Hook onto your manager and make a new connection:Create your query and fetchAll:Get the data out of result like this:I found out the answer is probably:Source: Native SQL.I had the same problem.  You want to look the connection object supplied by the entity manager:You can then query/execute directly against it:See the docs for the connection object at http://www.doctrine-project.org/api/dbal/2.0/doctrine/dbal/connection.htmlIn your model create the raw SQL statement (example below is an example of a date interval I had to use but substitute your own. If you are doing a SELECT add ->fetchall() to the execute() call.You can't, Doctrine 2 doesn't allow for raw queries. It may seem like you can but if you try something like this:Doctrine will spit an error saying that DATE_FORMAT is an unknown function.But my database (mysql) does know that function, so basically what is hapening is Doctrine is parsing that query behind the scenes (and behind your back) and finding an expression that it doesn't understand, considering the query to be invalid.So if like me you want to be able to simply send a string to the database and let it deal with it (and let the developer take full responsibility for security), forget it.Of course you could code an extension to allow that in some way or another, but you just as well off using mysqli to do it and leave Doctrine to it's ORM buisness.

How do I show multiple recaptchas on a single page?

oym

[How do I show multiple recaptchas on a single page?](https://stackoverflow.com/questions/1241947/how-do-i-show-multiple-recaptchas-on-a-single-page)

I have 2 forms on a single page.  One of the forms has a recaptcha displaying all the time.  The other should display a recaptcha only after a certain event such as maxing out login attempts.  So there are times when I would need 2 recaptchas to appear on the same page.  Is this possible?  I know I could probably use a single one for both, but the way I have the layout, I would much prefer to have 2.  Thanks.Update: well I guess it may not be possible.  Can anybody recommend another capture library to use side by side with reCaptcha?  I really want to be able to have 2 captchas on the same page.Update 2: What if put each form in an iframe?  Would this be an acceptable solution?

2009-08-06 22:48:32Z

I have 2 forms on a single page.  One of the forms has a recaptcha displaying all the time.  The other should display a recaptcha only after a certain event such as maxing out login attempts.  So there are times when I would need 2 recaptchas to appear on the same page.  Is this possible?  I know I could probably use a single one for both, but the way I have the layout, I would much prefer to have 2.  Thanks.Update: well I guess it may not be possible.  Can anybody recommend another capture library to use side by side with reCaptcha?  I really want to be able to have 2 captchas on the same page.Update 2: What if put each form in an iframe?  Would this be an acceptable solution?A similar question was asked about doing this on an ASP page (link) and the consensus over there was that it was not possible to do with recaptcha. It seems that multiple forms on a single page must share the captcha, unless you're willing to use a different captcha. If you are not locked into recaptcha a good library to take a look at is the Zend Frameworks Zend_Captcha component (link). It contains a few With the current version of Recaptcha (reCAPTCHA API version 2.0), you can have multiple recaptchas on one page.There is no need to clone the recaptcha nor try to workaround the problem. You just have to put multiple div elements for the recaptchas and render the recaptchas inside them explicitly.This is easy with the google recaptcha api:

https://developers.google.com/recaptcha/docs/display#explicit_renderHere is the example html code:In your javascript code, you have to define a callback function for recaptcha:After this, your recaptcha script url should look like this:Or instead of giving IDs to your recaptcha fields, you can give a class name and loop these elements with your class selector and call .render()Simple and straightforward:1) Create your recaptcha fields normally with this:2) Load the script with this:3) Now call this to iterate over the fields and create the recaptchas:This is easily accomplished with jQuery's clone() function.So you must create two wrapper divs for the recaptcha. My first form's recaptcha div:The second form's div is empty (different ID). So mine is just:Then the javascript is quite simple:Probably don't need the second parameter with a true value in clone(), but doesn't hurt to have it... The only issue with this method is if you are submitting your form via ajax, the problem is that you have two elements that have the same name and you must me a bit more clever with the way you capture that correct element's values (the two ids for reCaptcha elements are #recaptcha_response_field and #recaptcha_challenge_field just in case someone needs them)I know this question is old but in case if anyone will look for it in the future. It is possible to have two captcha's on one page. Pink to documentation is here: https://developers.google.com/recaptcha/docs/display

Example below is just a copy form doc and you dont have to specify different layouts.I have contact form in footer that always displays and also some pages, like Create Account, can have captcha too, so it's dynamically and  I'm using next way with jQuery:html:javascriptThis answer is an extension to @raphadko's answer.If you need to extract manually the captcha code (like in ajax requests) you have to call:But how can you retrieve the widget id parameter?I use this definition of CaptchaCallback to store the widget id of each g-recaptcha box (as an HTML data attribute):Then I can call:to extract the code.This is a JQuery-free version of the answer provided by raphadko and noun.1) Create your recaptcha fields normally with this:2) Load the script with this:3) Now call this to iterate over the fields and create the recaptchas:Looking at the source code of the page I took the reCaptcha part and changed the code a bit. Here's the code:HTML:jQuery:I am using here simple javascript tab functionality. So, didn't included that code. When user would click on "Request Information" (#product_tabs_what) then JS will check if recapExist is false or has some value. If it has a value then this will call Recaptcha.destroy(); to destroy the old loaded reCaptcha and will recreate it for this tab. Otherwise this will just create a reCaptcha and will place into the #more_info_recaptcha_box div. Same as for "Make Offer" #product_tabs_wha tab.A good option is to generate a recaptcha input for each form on the fly (I've done it with two but you could probably do three or more forms).  I'm using jQuery, jQuery validation, and jQuery form plugin to post the form via AJAX, along with the Recaptcha AJAX API - https://developers.google.com/recaptcha/docs/display#recaptcha_methodsWhen the user submits one of the forms:Then, they can fill out the recaptcha and re-submit the form.  If they decide to submit a different form instead, well, your code checks for existing recaptchas so you'll only have one recaptcha on the page at a time.To add a bit to raphadko's answer: since you have multiple captchas (on one page), you can't use the (universal) g-recaptcha-response POST parameter (because it holds only one captcha's response). Instead, you should use grecaptcha.getResponse(opt_widget_id) call for each captcha. Here's my code (provided each captcha is inside its form):HTML:andJavaScript:Notice that I apply the event delegation (see refresh DOM after append element ) to all the dynamically modified elements. This binds every individual captha's response to its form submit event.Here's a solution that builds off many of the excellent answers. This option is jQuery free, and dynamic, not requiring you to specifically target elements by id. 1) Add your reCAPTCHA markup as you normally would:2) Add the following into the document. It will work in any browser that supports the querySelectorAll APIThe grecaptcha.getResponse() method accepts an optional "widget_id" parameter, and defaults to the first widget created if unspecified. A widget_id is returned from the grecaptcha.render() method for each widget created, it is not related to the attribute id of the reCAPTCHA container!!Each reCAPTCHA has its own response data. 

You have to give the reCAPTCHA div an ID and pass it to the getResponse method:e.g.Access response:or It is possible, just overwrite the Recaptcha Ajax callbacks. Working jsfiddle: http://jsfiddle.net/Vanit/Qu6kn/You don't even need a proxy div because with the overwrites the DOM code won't execute. Call Recaptcha.reload() whenever you want to trigger the callbacks again.Here is a nice guide for doing exactly that:http://mycodde.blogspot.com.ar/2014/12/multiple-recaptcha-demo-same-page.htmlBasically you add some parameters to the api call and manually render each recaptcha: PS: The "grecaptcha.render" method receives an IDI would use invisible recaptcha.  Then on your button use a tag like " formname='yourformname' " to specify which form is to be submitted and hide a submit form input.  The advantage of this is it allows for you to keep the html5 form validation intact, one recaptcha, but multiple button interfaces.  Just capture the "captcha" input value for the token key generated by recaptcha.I find this FAR simpler and easier to manage.  

How to create cron job using PHP?

user2738520

[How to create cron job using PHP?](https://stackoverflow.com/questions/18737407/how-to-create-cron-job-using-php)

I'm new to using cron job. I don't even know how to write it. I have tried to search from internet, but I still don't understand it well. I want to create a cron job that will execute my code every minute. I'm using PHP to create it. It is not working.Examplerun.php  (Code that will be executed every minute)cron.phpSuppose that these two files are in the same folder.Is the code that I did wrong? If wrong, please kindly tell me how to fix it.

2013-09-11 09:27:05Z

I'm new to using cron job. I don't even know how to write it. I have tried to search from internet, but I still don't understand it well. I want to create a cron job that will execute my code every minute. I'm using PHP to create it. It is not working.Examplerun.php  (Code that will be executed every minute)cron.phpSuppose that these two files are in the same folder.Is the code that I did wrong? If wrong, please kindly tell me how to fix it.This is the best explanation with code in PHP I have found so far:http://code.tutsplus.com/tutorials/managing-cron-jobs-with-php--net-19428In short:Although the syntax of scheduling a new job may seem daunting at first glance, it's actually relatively simple to understand once you break it down. A cron job will always have five columns each of which represent a chronological 'operator' followed by the full path and command to execute:* * * * * home/path/to/command/the_command.shEach of the chronological columns has a specific relevance to the schedule of the task. They are as follows:So, for example, if one wanted to schedule a task for 12am on the first day of every month it would look something like this:0 0 1 * * home/path/to/command/the_command.shIf we wanted to schedule a task to run every Saturday at 8:30am we'd write it as follows:30 8 * * 6 home/path/to/command/the_command.shThere are also a number of operators which can be used to customize the schedule even further:Visit the link for the full article, it explains:In the same way you are trying to run cron.php, you can run another PHP script.  You will have to do so via the CLI interface though.Then, add an entry to the crontab:If the run.php script had executable permissions, it could be listed directly in the crontab, without the /usr/bin/php part as well. The 'env php' part, in the script, would find the appropriate program to actually run the PHP code. So, for the 'executable' version - add executable permission to the file:and then, add the following entry into crontab: Added to Alister, you can edit the crontab usually (not always the case) by entering crontab -e in a ssh session on the server.The stars represent (* means every of this unit):You could read some more about this here. Type the following in the linux/ubuntu terminalselect an editor (sometime it asks for the editor)

and this to run for every minutewhy you not use curl?

logically, if you execute php file, you will execute that by url on your browser.

its very simple if you run curlThat may depend on your web host if you are not hosting your own content. If your web host supports creating chron jobs, they may have a form for you to fill out that lets you select the frequency and input the absolute path to the file to execute. For instance, my web host (DreamHost) allows me to create custom cron jobs by typing in the absolute path to the file and selecting the frequency from a select menu. This may not be possible for your server, in which case you need to either edit the crontab directly or through your host specific method.As Alister Bulman details above, create a PHP file to run using CLI (making sure to include #!/usr/bin/env php at the very start of the file before the <?php tag. This ensures that the shell knows which executable should be invoked when running the script.First open your SSH server with username and password and change to the default root user(User with all permissions) then follow the steps below,Create a cronjob like this to work on every minuteThere is a simple way to solve this: you can execute php file by cron every 1 minute, and inside php executable file make "if" statement to execute when time "now"  like this

How do I write unit tests in PHP? [closed]

letgo

[How do I write unit tests in PHP? [closed]](https://stackoverflow.com/questions/282150/how-do-i-write-unit-tests-in-php)

I've read everywhere about how great they are, but for some reason I can't seem to figure out how exactly I'm supposed to test something. Could someone perhaps post a piece of example code and how they would test it? If it's not too much trouble :)

2008-11-11 21:09:23Z

I've read everywhere about how great they are, but for some reason I can't seem to figure out how exactly I'm supposed to test something. Could someone perhaps post a piece of example code and how they would test it? If it's not too much trouble :)There is a 3rd "framework", which is by far easier to learn - even easier than SimpleTest, it's called phpt.A primer can be found here:

http://qa.php.net/write-test.phpEdit: Just saw your request for sample code.Let's assume you have the following function in a file called lib.php:Really simple and straight forward, the parameter you pass in, is returned. So let's look at a test for this function, we'll call the test file foo.phpt:In a nutshell, we provide the parameter $bar with value "Hello World" and we var_dump() the response of the function call to foo().To run this test, use: pear run-test path/to/foo.phptThis requires a working install of PEAR on your system, which is pretty common in most circumstances. If you need to install it, I recommend to install the latest version available. In case you need help to set it up, feel free to ask (but provide OS, etc.).There are two frameworks you can use for unit testing. Simpletest and PHPUnit, which I prefer. Read the tutorials on how to write and run tests on the homepage of PHPUnit. It is quite easy and well described.You can make unit testing more effective by changing your coding style to accommodate it. I recommend browsing the Google Testing Blog, in particular the post on Writing Testable Code.I rolled my own because i didnt have time to learn someone elses way of doing things, this took about 20 minutes to write up, 10 to adapt it for posting here. Unittesting is very usefull to me.this is kinda long but it explains itself and there is an example at the bottom.This outputs:Get PHPUnit. It is very easy to use.Then start with very simple assertions. You can do alot with AssertEquals before you get into anything else. That's a good way to get your feet wet.You may also want to try writing your test first (since you gave your question the TDD tag) and then write your code. If you haven't done this before it is an eye-opener.For simple tests AND documentation, php-doctest is quite nice and it's a really easy way to get started since you don't have to open a separate file. Imagine the function below:If you now run this file through phpdt (command-line runner of php-doctest) 1 test will be run. The doctest is contained inside the < code > block. Doctest originated in python and is fine for giving useful & runnable examples on how the code is supposed to work. You can't use it exclusively because the code itself would litter up with test cases but I've found that it's useful alongside a more formal tdd library - i use phpunit. This 1st answer here sums it up nicely (it's not unit vs doctest ).phpunit is pretty much the defacto unit testing framework for php. there is also DocTest (available as a PEAR package) and a few others.

php itself is tested for regressions and the like via phpt tests which can also be run via pear.Codeception tests are much like common unit tests but are much powerful in things where you need mocking and stubbing. Here is the sample controller test. Notice how easily stubs are created. How easily you check the method was invoked.Also there are other cool things. You can test database state, filesystem, etc.Besides the excellent suggestions about test frameworks already given, are you building your application with one of the PHP web frameworks that has automated testing built in, such as Symfony or CakePHP?  Sometimes having a place to just drop in your test methods reduces the start-up friction some people associate with automated testing and TDD.Way too much to re-post here, but here is a great article on using phpt. It covers a number of aspects around phpt that are often overlooked, so it could be worth a read to expand your knowledge of php beyond just writing a test. Fortunately the article also discusses writing tests!The main points of discussionI know there is a lot of info here already, but since this still shows up on Google searches i might as well add Chinook Test Suite to the list. It is a simple and small test framework. You can easily test your classes with it and also create mock objects. You run the tests through a web browser and (not yet) through a console.

In the browser you can specify what test class or even what test method to run. Or you can simply run all tests.A screenshot from the github page:What i like about it is the way you assert tests. This is done with so called "fluent assertions". Example:And creating mock objects is a breeze too (with a fluent like syntax):Anyway, more info can be found on the github page with a code example as well:https://github.com/w00/Chinook-TestSuite

PHP: How to check if image file exists?

PaperChase

[PHP: How to check if image file exists?](https://stackoverflow.com/questions/7991425/php-how-to-check-if-image-file-exists)

I need to see if a specific image exists on my cdn.I've tried the following and it doesn't work:Even if the image exists or doesn't exist, it always says "The file exists". I'm not sure why its not working...

2011-11-03 07:24:27Z

I need to see if a specific image exists on my cdn.I've tried the following and it doesn't work:Even if the image exists or doesn't exist, it always says "The file exists". I'm not sure why its not working...You need the filename in quotation marks at least (as string):Also, make sure $filename is properly validated. And then, it will only work when allow_url_fopen is activated in your PHP configThis didn't work for me. The way I did it was using getimagesize.Note that the '@' will mean that if the image does not exist (in which case the function would usually throw an error: getimagesize(http://www.mydomain.com/images/filename.png) [function.getimagesize]: failed) it will return false.Well, file_exists does not say if a file exists, it says if a path exists. ⚡⚡⚡⚡⚡⚡⚡So, to check if it is a file then you should use is_file together with  file_exists to know if there is really a file behind the path, otherwise file_exists will return true for any existing path.Try like this:Here is the simplest way to check if a file exist:A thing you have to understand first: you have no files.

A file is a subject of a filesystem, but you are making your request using HTTP protocol which supports no files but URLs.So, you have to request an unexisting file using your browser and see the response code. if it's not 404, you are unable to use any wrappers to see if a file exists and you have to request your cdn using some other protocol, FTP for exampleIf the file is on your local domain, you don't need to put the full URL. Only the path to the file. If the file is in a different directory, then you need to preface the path with "."Often times the "." is left off which will cause the file to be shown as not existing, when it in fact does.There is a major difference between is_file and file_exists.is_file returns true for (regular) files:file_exists returns true for both files and directories:Note: Check also this stackoverflow question for more information on this topic.You have to use absolute path to see if the file exists.If you are writing for CMS or PHP framework then as far as I know all of them have defined constant for document root path. e.g WordPress uses ABSPATH which can be used globally for working with files on the server using your code as well as site url.Wordpress example:I'm going an extra mile here :). Because this code would no need much maintenance and pretty solid, I would write it with as shorthand if statement:Shorthand IF statement explained:you can use cURL. You can get cURL to only give you the headers, and not the body, which might make it faster. A bad domain could always take a while because you will be waiting for the request to time-out; you could probably change the timeout length using cURL.Here is example: You can use the file_get_contents function to access remote files. See http://php.net/manual/en/function.file-get-contents.php for details.}Reference URL: https://hungred.com/how-to/php-check-remote-email-url-image-link-exist/try this :     Read first 5 bytes form HTTP using fopen() and fread() then use this:to detect image. file_exists reads not only files, but also paths. so when $filename is empty, the command would run as if it's written like this:if the directory /images/ exists, the function will still return true.I usually write it like this:file_exists($filepath) will return a true result for a directory and full filepath, so is not always a solution when a filename is not passed.is_file($filepath) will only return true for fully filepathsyou need server path with file_existsfor exampleIf path to your image is relative to the application root it is better to use something like this:Usage example for this function:I think it is good idea to create something like library to check image existence applicable for different situations. Above lots of great answers you can use to solve this task.

How do I make an asynchronous GET request in PHP?

Abs

[How do I make an asynchronous GET request in PHP?](https://stackoverflow.com/questions/962915/how-do-i-make-an-asynchronous-get-request-in-php)

I wish to make a simple GET request to another script on a different server.  How do I do this?In one case, I just need to request an external script without the need for any output.In the second case, I need to get the text output.To be honest, I do not want to mess around with CURL as this isn't really the job of CURL. I also do not want to make use of http_get as I do not have the PECL extensions.Would fsockopen work? If so, how do I do this without reading in the contents of the file? Is there no other way?Thanks allI should of added, in the first case, I do not want to wait for the script to return anything. As I understand file_get_contents() will wait for the page to load fully etc?

2009-06-07 21:53:04Z

I wish to make a simple GET request to another script on a different server.  How do I do this?In one case, I just need to request an external script without the need for any output.In the second case, I need to get the text output.To be honest, I do not want to mess around with CURL as this isn't really the job of CURL. I also do not want to make use of http_get as I do not have the PECL extensions.Would fsockopen work? If so, how do I do this without reading in the contents of the file? Is there no other way?Thanks allI should of added, in the first case, I do not want to wait for the script to return anything. As I understand file_get_contents() will wait for the page to load fully etc?file_get_contents will do what you wantEdit: One way to fire off a GET request and return immediately.Quoted from http://petewarden.typepad.com/searchbrowser/2008/06/how-to-post-an.htmlWhat this does is open a socket, fire off a get request, and immediately close the socket and return.This is how to make Marquis' answer work with both POST and GET requests:Regarding your update, about not wanting to wait for the full page to load - I think a HTTP HEAD request is what you're looking for..get_headers should do this - I think it only requests the headers, so will not be sent the full page content."PHP / Curl: HEAD Request takes a long time on some sites" describes how to do a HEAD request using PHP/CurlIf you want to trigger the request, and not hold up the script at all, there are a few ways, of varying complexities..You don't. While PHP offers lots of ways to call a URL, it doesn't offer out of the box support for doing any kind of asynchronous/threaded processing per request/execution cycle.  Any method of sending a request for a URL (or a SQL statement, or a etc.) is going to wait for some kind of response.  You'll need some kind of secondary system running on the local machine to achieve this (google around for "php job queue")I would recommend you well tested PHP library: curl-easyIf you are using Linux environment then you can use the PHP's exec command to invoke the linux curl. Here is a sample code, which will make a Asynchronous HTTP post. This code does not need any extra PHP libs and it can complete the http post in less than 10 milliseconds. Interesting problem. I'm guessing you just want to trigger some process or action on the other server, but don't care what the results are and want your script to continue. There is probably something in cURL that can make this happen, but you may want to consider using exec() to run another script on the server that does the call if cURL can't do it. (Typically people want the results of the script call so I'm not sure if PHP has the ability to just trigger the process.) With exec() you could run a wget or even another PHP script that makes the request with file_get_conents().You'd better consider using Message Queues instead of advised methods.

I'm sure this will be better solution, although it requires a little more job than just sending a request.let me show you my way :)needs nodejs installed on the server(my server sends 1000 https get request takes only 2 seconds)url.php : urlscript.js >For me the question about asynchronous GET request is appeared because of I met with situation when I need to do hundreds of requests, get and deal with result data on every request and every request takes significant milliseconds of executing that leads to minutes(!) of total executing with simple file_get_contents.In this case it was very helpful comment of w_haigh at php.net on function http://php.net/manual/en/function.curl-multi-init.phpSo, here is my upgraded and cleaned version of making lot of requests simultaneously.

For my case it's equivalent to "asynchronous" way. May be it helps for someone!It's easy to rewrite this to handle POST or other types of HTTP(S) requests or any combinations of them. And Cookie support, redirects, http-auth, etc.Try:This will NOT work as an apache module, you need to be using CGI.I found this interesting link to do asynchronous processing(get request).askapacheFurthermore you could do asynchronous processing by using a message queue like for instance beanstalkd.Here's an adaptation of the accepted answer for performing a simple GET request.One thing to note if the server does any url rewriting, this will not work.  You'll need to use a more full featured http client. Just a few corrections on scripts posted above. The following is working for meNobody seems to mention Guzzle, which is a PHP HTTP client that makes it easy to send HTTP requests. It can work with or without Curl. It can send both synchronous and asynchronous requests.Based on this thread I made this for my codeigniter project. It works just fine. You can have any function processed in the background.A controller that accepts the async calls.And a library that does the async callsThis method can be called to process any model::method() in the 'background'. It uses variable arguments.Suggestion: format a FRAMESET HTML page which contains, let´s say, 9 frames inside. Each frame will GET a different "instance" of your myapp.php page. There will be 9 different threads running on the Web server, in parallel.For PHP5.5+, mpyw/co is the ultimate solution. It works as if it is tj/co in JavaScript.Assume that you want to download specified multiple GitHub users' avatars. The following steps are required for each user.---: Waiting my response

...: Waiting other response in parallel flowsMany famous curl_multi based scripts already provide us the following flows.However, this is not efficient enough. Do you want to reduce worthless waiting times ...?Yes, it's very easy with mpyw/co. For more details, visit the repository page.Here is my own PHP function when I do POST to a specific URL of any page....Sample: * usage of my Function...Try this code....Please dont forget to enable CURL php extension.This works fine for me, sadly you cannot retrieve the response from your request:It works very fast, no need for raw tcp sockets :)

Which $_SERVER variables are safe?

rook

[Which $_SERVER variables are safe?](https://stackoverflow.com/questions/6474783/which-server-variables-are-safe)

Any variable that a user can control,  an attacker can also control and is therefore a source of an attack.  This is called a "tainted" variable, and is unsafe. When using $_SERVER, many of the variables can be controlled. PHP_SELF, HTTP_USER_AGENT, HTTP_X_FORWARDED_FOR, HTTP_ACCEPT_LANGUAGE and many others are a part of the HTTP request header sent by the client.Does anyone know of a "safe list"  or untainted list of $_SERVER variables?

2011-06-24 23:38:54Z

Any variable that a user can control,  an attacker can also control and is therefore a source of an attack.  This is called a "tainted" variable, and is unsafe. When using $_SERVER, many of the variables can be controlled. PHP_SELF, HTTP_USER_AGENT, HTTP_X_FORWARDED_FOR, HTTP_ACCEPT_LANGUAGE and many others are a part of the HTTP request header sent by the client.Does anyone know of a "safe list"  or untainted list of $_SERVER variables?There's no such thing as "safe" or "unsafe" values as such. There are only values that the server controls and values that the user controls and you need to be aware of where a value comes from and hence whether it can be trusted for a certain purpose. $_SERVER['HTTP_FOOBAR'] for example is entirely safe to store in a database, but I most certainly wouldn't eval it.As such, let's divide those values into three categories:These variables are set by the server environment and depend entirely on the server configuration.These variables depend on the specific request the client sent, but can only take a limited number of valid values, since all invalid values should be rejected by the web server and not cause the invocation of the script to begin with. Hence they can be considered reliable.* The REMOTE_ values are guaranteed to be the valid address of the client, as verified by a TCP/IP handshake. This is the address where any response will be sent to. REMOTE_HOST relies on reverse DNS lookups though and may hence be spoofed by DNS attacks against your server (in which case you have bigger problems anyway). This value may be a proxy, which is a simple reality of the TCP/IP protocol and nothing you can do anything about.† If your web server responds to any request regardless of HOST header, this should be considered unsafe as well. See How safe is $_SERVER[「HTTP_HOST」]?.

Also see http://shiflett.org/blog/2006/mar/server-name-versus-http-host.‡ See https://bugs.php.net/bug.php?id=64457, http://httpd.apache.org/docs/current/mod/core.html#usecanonicalphysicalport, http://httpd.apache.org/docs/2.4/mod/core.html#comment_999These values are not checked at all and do not depend on any server configuration, they are entirely arbitrary information sent by the client.§ May be considered reliable as long as the web server allows only certain request methods.‖ May be considered reliable if authentication is handled entirely by the web server.The superglobal $_SERVER also includes several environment variables. Whether these are "safe" or not depend on how (and where) they are defined. They can range from completely server controlled to completely user controlled.In PHP every $_SERVER variable starting with HTTP_ can be influenced by the user. For example the variable $_SERVER['HTTP_REINERS'] can be tainted by setting the HTTP header REINERS to an arbitrary value in the HTTP request.

Cleansing User Passwords

Jay Blanchard

[Cleansing User Passwords](https://stackoverflow.com/questions/36628418/cleansing-user-passwords)

How should I escape or cleanse user-provided passwords before I hash them and store them in my database?When PHP developers consider hashing users' passwords for security purposes, they often tend to think of those passwords like they would any other user-provided data. This subject comes up often in PHP questions related to password storage; the developer often wants to cleanse the password using functions such as escape_string()(in various iterations), htmlspecialchars(), addslashes() and others before hashing it and storing it in the database. 

2016-04-14 16:08:20Z

How should I escape or cleanse user-provided passwords before I hash them and store them in my database?When PHP developers consider hashing users' passwords for security purposes, they often tend to think of those passwords like they would any other user-provided data. This subject comes up often in PHP questions related to password storage; the developer often wants to cleanse the password using functions such as escape_string()(in various iterations), htmlspecialchars(), addslashes() and others before hashing it and storing it in the database. You should never escape, trim or use any other cleansing mechanism on passwords you'll be hashing with PHP's password_hash() for a number of reasons, the single largest of which is because doing additional cleansing to the password requires unnecessary additional code.You will argue (and you see it in every post where user data is accepted for use in your systems) that we should cleanse all user input and you would be right for every other piece of information we're accepting from our users. Passwords are different. Hashed passwords cannot offer any SQL injection threat because the string is turned into hash prior to storing in the database.The act of hashing a password is the act of making the password safe to store in your database.  The hash function doesn't give special meaning to any bytes, so no cleansing of its input is required for security reasonsIf you follow the mantras of allowing users to use the passwords / phrases they desire and you don't limit passwords, allowing any length, any number of spaces and any special characters hashing will make the password/passphrase safe no matter what is contained within the password. As of right now the most common hash (the default), PASSWORD_BCRYPT, turns the password into a 60 character wide string containing a random salt along with the hashed password information and a cost (the algorithmic cost of creating the hash):The space requirements for storing the hash are subject to change as different hashing methods are added to the function, so it is always better to go larger on the column type for the stored hash, such as VARCHAR(255) or TEXT.You could use a complete SQL query as your password and it would be hashed, making it unexecutable by the SQL engine e.g.,Could be hashed to $2y$10$1tOKcWUWBW5gBka04tGMO.BH7gs/qjAHZsC5wyG0zmI2C.KgaqU5GLet's see how different sanitizing methods affect the password -The password is I'm a "dessert topping" & a <floor wax>! (There are 5 spaces at the end of the password which are not displayed here.)When we apply the following methods of trimming we get some wildy different results:Results:What happens when we send these to password_hash()? They all get hashed, just as the query did above. The problem comes in when you try to verify the password. If we employ one or more of these methods we must re-employ them prior to comparing them with password_verify(). The following would fail:You would have to run the posted password through the cleansing method you chose before using the result of that in password verification. It is an unnecessary set of steps and will make the hash no better.Using a PHP version less than 5.5? You can use the password_hash() compatibility pack.You really shouldn't use MD5 password hashes.Before hashing the password, you should normalise it as described in section 4 of RFC 7613.  In particular:and:This attempts to ensure that if the user types the same password but using a different input method, the password should still be accepted.

Submitting a multidimensional array via POST with php

Fireflight

[Submitting a multidimensional array via POST with php](https://stackoverflow.com/questions/2433727/submitting-a-multidimensional-array-via-post-with-php)

I have a php form that has a known number of columns (ex. top diameter, bottom diameter, fabric, colour, quantity), but has an unknown number of rows, as users can add rows as they need. I've discovered how to take each of the fields(columns) and place them into an array of their own.So what I end up with in the HTML is:    What I would like to do now is take all the rows and columns put them into a multidimensional array and email the contents of that to the client (preferably in a nicely formatted table). I haven't been able to really comprehend how to combine all those inputs and selects into a nice array.At this point, I'm going to have to try to use several 1D arrays, although I have the idea that using a single 2D array would be a better practice than using several 1D arrays.

2010-03-12 15:26:28Z

I have a php form that has a known number of columns (ex. top diameter, bottom diameter, fabric, colour, quantity), but has an unknown number of rows, as users can add rows as they need. I've discovered how to take each of the fields(columns) and place them into an array of their own.So what I end up with in the HTML is:    What I would like to do now is take all the rows and columns put them into a multidimensional array and email the contents of that to the client (preferably in a nicely formatted table). I haven't been able to really comprehend how to combine all those inputs and selects into a nice array.At this point, I'm going to have to try to use several 1D arrays, although I have the idea that using a single 2D array would be a better practice than using several 1D arrays.On submitting, you would get an array as if created like this:However, I would suggest changing your form names to this format instead:Using that format, it's much easier to loop through the values.you could submit all parameters with such naming:then later you  do something like this:I made a function which handles arrays as well as single GET or POST valuesExamples:

How to add a new method to a php object on the fly?

MadBad

[How to add a new method to a php object on the fly?](https://stackoverflow.com/questions/2938004/how-to-add-a-new-method-to-a-php-object-on-the-fly)

How do I add a new method to an object "on the fly"?

2010-05-30 08:49:12Z

How do I add a new method to an object "on the fly"?You can harness __call for this:With PHP 7 you can use anonymous classes PHP RFC: Anonymous ClassesUsing simply __call in order to allow adding new methods at runtime has the major drawback that those methods cannot use the $this instance reference.

Everything work great, till the added methods don't use $this in the code.In order to solve this problem you can rewrite the pattern in this wayIn this way you can add new methods that can use the instance referenceGood question and clever idea using the new anonymous functions!Interestingly, this works: Replaceby call_user_func on the function itself:what doesn't work is the "right" way:if called that way, PHP requires the method to be declared in the class definition. Is this a  private / public / protected visibility issue?Update: Nope. It's impossible to call the function the normal way even from within the class, so this is not a visibility issue. Passing the actual function to call_user_func() is the only way I can seem to make this work.you can also save functions in an array:To see how to do this with eval, you can take a look at my PHP micro-framework, Halcyon, which is available on github. It's small enough that you should be able to figure it out without any problems - concentrate on the HalcyonClassMunger class.Without the __call solution, you can use bindTo (PHP >= 5.4), to call the method with $this bound to $me like this:The complete script could look like this:Alternatively, you could assign the bound function to a variable, and then call it without call_user_func:There's a similar post on stackoverflow that clears out that this is only achievable through the implementation of certain design patterns. The only other way is through the use of classkit, an experimental php extension. (also in the post)karim79 answer works however it stores anonymous functions inside method properties and his declarations can overwrite existing properties of same name or does not work if existing property is private causing fatal error object unusable i think storing them in separate array and using setter is cleaner solution. method injector setter can be added to every object automatically using traits.P.S. Of course this is hack that should not be used as it violates open closed principle of SOLID.

Checking for empty arrays: count vs empty

Dan McGrath

[Checking for empty arrays: count vs empty](https://stackoverflow.com/questions/2216110/checking-for-empty-arrays-count-vs-empty)

This question on 'How to tell if a PHP array is empty' had me thinking of this questionIs there a reason that count should be used instead of empty when determining if an array is empty or not?My personal thought would be if the 2 are equivalent for the case of empty arrays you should use empty because it gives a boolean answer to a boolean question. From the question linked above, it seems that count($var) == 0 is the popular method. To me, while technically correct, makes no sense. E.g. Q: $var, are you empty? A: 7. Hmmm...Is there a reason I should use count == 0 instead or just a matter of personal taste?As pointed out by others in comments for a now deleted answer, count will have performance impacts for large arrays because it will have to count all elements, whereas empty can stop as soon as it knows it isn't empty. So, if they give the same results in this case, but count is potentially inefficient, why would we ever use count($var) == 0?

2010-02-07 05:56:36Z

This question on 'How to tell if a PHP array is empty' had me thinking of this questionIs there a reason that count should be used instead of empty when determining if an array is empty or not?My personal thought would be if the 2 are equivalent for the case of empty arrays you should use empty because it gives a boolean answer to a boolean question. From the question linked above, it seems that count($var) == 0 is the popular method. To me, while technically correct, makes no sense. E.g. Q: $var, are you empty? A: 7. Hmmm...Is there a reason I should use count == 0 instead or just a matter of personal taste?As pointed out by others in comments for a now deleted answer, count will have performance impacts for large arrays because it will have to count all elements, whereas empty can stop as soon as it knows it isn't empty. So, if they give the same results in this case, but count is potentially inefficient, why would we ever use count($var) == 0?I generally use empty. Im not sure why people would use count really - If the array is large then count takes longer/has more overhead. If you simply need to know whether or not the array is empty then use empty.I was curious to see which one was actually faster so I made a simple script to benchmark those functions.Since I was doing it I also tried to check the performance doing operations that would normally be associated with count()/empty()Using PHP 5.4.39:Using HipHop VM 3.6.1 (dbg)Conclusions if you're using PHP:Conclusions if you're using HHVM:In conclusion of the conclusion, if you just need to know if the array is empty always use empty();This was just a curious test simply done without taking many things into account. It is just a proof of concept and might not reflect operations in production.I think it's only personal preference. Some people might say empty is faster (e.g. http://jamessocol.com/projects/count_vs_empty.php) while others might say count is better since it was originally made for arrays. empty is more general and can be applied to other types.php.net gives the following warning for count though :In other words, if the variable is not set, you will get a notice from PHP saying it's undefined. Therefore, before using count, it would be preferable to check the variable with isset. This is not necessary with empty.There is, when you need to do something on non-empty array knowing it's size:But I wouldn't recommend using count, unless you are 100% sure, that what you are counting is an array. Lately I have been debugging code, where on error function was returning FALSE instead of empty array, and what I discovered was:output:So since then I am using empty or if(array() === $array) to be sure that I have array that is empty.count() seems to work better with array-like interfaces that implement ArrayAccess/Countable. empty() returns true for these kinds of objects even if they have no elements. Typically these classes will implement the Countable interface, so if the question is "Does this collection contain elements?" without making an assumption about the implementation, then count() is a better option.Alternatively, you can cast the variable as a boolean (implicitly or explicitly):This method does generate an E_NOTICE if the variable is not defined, similarly to count().For more information, see the PHP Manual page on type comparisons.My personal preference is more for coding elegance (in relation to my specific use-case). I agree with Dan McG inasmuch that count() isn't responding with the correct datatype (in this case boolean) for the test in question forcing the developer to write more code to fill an 'if' statement.Whether this has any significant impact on performance is only debatable for extremely large arrays (which you probably won't have enough memory allocation for anyway in most setups).Particularly when it comes to PHP's $_POST array, it seems much more "logical" in my opinion to write/see:Hope this might help someone even though it has already been answered (and debated some what). In my own scenario, I know all my arrays all have 7 elements (checks were made earlier in my code) and I am performing an array_diff which of course returns an array of zero when equal.I had 34 sec for count and 17 sec for empty. Both give me the same calculations so my code is still fine.However you can also try the == or === as in PHP - Check if two arrays are equal. The best I would say is try count vs empty vs == empty array, then see which gives your own best perfs. In my case count was the slowest so I am using empty now... will be checking serialize nextThere is no strong reason to prefer count($myArray) == 0 over empty($myArray). They have identical semantics. Some might find one more readable than the other. One might perform marginally better than the other but it's not likely to be a significant factor in the vast majority of php applications. For all practical purposes, the choice is a matter of taste.Sometimes using empty is a must. For example this code:If you run this code like this: http://phpfiddle.org/main/code/g9x-uwiYou get this output:So if you count the empty glob output you get wrong output. You should check for emptiness.From glob documentation:Also check this question:

Why count(false) return 1?Since a variable parsed as negative would return int(1) with count()I prefer ($array === [] || !$array) to test for an empty array.Yes, we should expect an empty array, but we shouldn't expect a good implementation on functions without enforced return types.Examples with count()I remade my mind guys, thanks.Ok, there is no difference between the usage of empty and count. Technically, count should be used for arrays, and empty could be used for arrays as well as strings. So in most cases, they are interchangeable and if  you see the php docs, you will see the suggestion list of count if you are at empty and vice versa.

How to avoid isset() and empty()

Pekka

[How to avoid isset() and empty()](https://stackoverflow.com/questions/1960509/how-to-avoid-isset-and-empty)

I have several older applications that throw a lot of "xyz is undefined" and "undefined offset" messages when running on the E_NOTICE error level, because the existence of variables is not explicitly checked using isset() and consorts.I am considering working through them to make them E_NOTICE compatible, as notices about missing variables or offsets can be lifesavers, there may be some minor performance improvements to be gained, and it's overall the cleaner way. However, I don't like what inflicting hundreds of isset() empty() and array_key_exists() s does to my code. It gets bloated, becomes less readable, without gaining anything in terms of value or meaning. How can I structure my code without an excess of variable checks, while also being E_NOTICE compatible?

2009-12-25 04:55:18Z

I have several older applications that throw a lot of "xyz is undefined" and "undefined offset" messages when running on the E_NOTICE error level, because the existence of variables is not explicitly checked using isset() and consorts.I am considering working through them to make them E_NOTICE compatible, as notices about missing variables or offsets can be lifesavers, there may be some minor performance improvements to be gained, and it's overall the cleaner way. However, I don't like what inflicting hundreds of isset() empty() and array_key_exists() s does to my code. It gets bloated, becomes less readable, without gaining anything in terms of value or meaning. How can I structure my code without an excess of variable checks, while also being E_NOTICE compatible?For those interested, I have expanded this topic into a small article, which provides the below information in a somewhat better structured form: The Definitive Guide To PHP's isset And emptyIMHO you should think about not just making the app "E_NOTICE compatible", but restructuring the whole thing. Having hundreds of points in your code that regularly try to use non-existent variables sounds like a rather badly structured program. Trying to access non-existent variables should never ever happen, other languages balk at this at compile time. The fact that PHP allows you to do it doesn't mean you should.These warnings are there to help you, not to annoy you. If you get a warning "You're trying to work with something that doesn't exist!", your reaction should be "Oops, my bad, let me fix that ASAP." How else are you going to tell the difference between "variables that work just fine undefined" and honestly wrong code that may lead to serious errors? This is also the reason why you always, always, develop with error reporting turned to 11 and keep plugging away at your code until not a single NOTICE is issued. Turning error reporting off is for production environments only, to avoid information leakage and provide a better user experience even in the face of buggy code.To elaborate:You will always need isset or empty somewhere in your code, the only way to reduce their occurrence is to initialize your variables properly. Depending on the situation there are different ways to do that:Function arguments:There's no need to check whether $bar or $baz are set inside the function because you just set them, all you need to worry about is if their value evaluates to true or false (or whatever else).Regular variables anywhere:Initialize your variables at the top of a block of code in which you're going to use them. This solves the !isset problem, ensures that your variables always have a known default value, gives the reader an idea of what the following code will work on and thereby also serves as a sort of self-documentation.Arrays:The same thing as above, you're initializing the array with default values and overwrite them with actual values.In the remaining cases, let's say a template where you're outputting values that may or may not be set by a controller, you'll just have to check:If you find yourself regularly using array_key_exists, you should evaluate what you're using it for. The only time it makes a difference is here:As stated above though, if you're properly initializing your variables, you don't need to check if the key exists or not, because you know it does. If you're getting the array from an external source, the value will most likely not be null but '', 0, '0', false or something like it, i.e. a value you can evaluate with isset or empty, depending on your intent. If you regularly set an array key to null and want it to mean anything but false, i.e. if in the above example the differing results of isset and array_key_exists make a difference to your program logic, you should ask yourself why. The mere existence of a variable shouldn't be important, only its value should be of consequence. If the key is a true/false flag, then use true or false, not null. The only exception to this would be 3rd party libraries that want null to mean something, but since null is so hard to detect in PHP I have yet to find any library that does this.Just write a function for that. Something like:which you can use asDo the same for trivial stuff like get_number(), get_boolean(), get_array() and so on.I believe one of the best ways of coping with this problem is by accessing values of GET and POST (COOKIE, SESSION, etc) arrays through a class.Create a class for each of those arrays and declare __get and __set methods (overloading). __get accepts one argument which will be the name of a value. This method should check this value in the corresponding global array either using isset() or empty() and return the value if it exists or null (or some other default value) otherwise.After that you can confidently access array values in this manner: $POST->username and do any validation if needed without using any isset()s or empty()s. If username does not exist in the corresponding global array then null will be returned, so no warnings or notices will be generated.I don't mind using the array_key_exists(), in fact I prefer using this specific function rather than relying on hack functions which may change their behavior in the future like empty and isset (strikedthrough to avoid susceptibilities).I do however, use a simple function that comes handy in this, and some other situations in dealing with array indexes:Let's say you've the following arrays:How do you get the "value" out of the arrays? Simple:We already have uni and multi-dimensional arrays covered, what else can we possibly do?Take the following piece of code for instance:Pretty boring isn't it? Here is another approach using the Value() function:As an additional example, take the RealIP() function for a test:I'm here with you. But PHP designers has made a lot more worse mistakes than that. Short of defining custom function for any value reading, there's no way around it.I use these functionExamplesWelcome to Null coalescing operator (PHP >= 7.0.1):PHP says:Make a function which returns false if not set, and, if specified, false if empty. If valid it returns the variable. You can add more options as seen in the code below:I'm not sure what your definition of readability is, but proper use of empty(), isset() and try/throw/catch blocks, is pretty important to the whole process.  If your E_NOTICE is coming from $_GET or $_POST, then they should be checked against empty() right along with all the other security checks that that data should have to pass.  If it's coming from external feeds or libraries, it should be wrapped in try/catch.  If it's coming from the database, $db_num_rows() or it's equivalent should be checked.  If it's coming from internal variables, they should be properly initialized.  Often, these types of notices come from assigning a new variable to the return of a function that returns FALSE on a failure, those should be wrapped in a test that, in the event of a failure, can  either assign the variable an acceptable default value that the code can handle, or throwing an exception that the code can handle.  These things make the code longer, add extra blocks, and add extra tests, but I disagree with you in that I think they most definitely add extra value.software does not magically run by the grace of god, if you are expecting something that is missing you need to properly handle it. if you ignore it you are probably creating security holes in your applications. on static languages accessing a non-defined variable is just not possible, it won't simply compile or crash your application if it's null. furthermore makes your application unmaintainable, and you are going to go mad when unexpected things happen. language strictness is a must and php, by design, is wrong in so many aspects. it will make you a bad programmer if you are not aware.What about using the @ operator ?

e.g.:You may say this is bad because you have no control on what happens "inside" $foo (if it was a function call that contains a PHP error for example) but if you only use this technique for variables, this is equivalent to:

How do I immediately execute an anonymous function in PHP?

Emanuil Rusev

[How do I immediately execute an anonymous function in PHP?](https://stackoverflow.com/questions/3568410/how-do-i-immediately-execute-an-anonymous-function-in-php)

In JavaScript, you can define anonymous functions that are executed immediately:Can you do something like that in PHP?

2010-08-25 16:58:53Z

In JavaScript, you can define anonymous functions that are executed immediately:Can you do something like that in PHP?For PHP7: see Yasuo Ohgaki's answer: (function() {echo 'Hi';})();For previous versions: the only way to execute them immediately I can think of isIn PHP 7 is to do the same in javascriptThe output is:Well of course you can use call_user_func, but there's still another pretty simple alternative:This is the simplest for PHP 7.0 or later.It means create closure, then call it as function by following "()". Works just like JS thanks to uniform variable evaluation order.https://3v4l.org/06EL3Note, accepted answer is fine but it takes 1.41x as long (41% slower) than declaring a function and calling it in two lines.[I know it's not really a new answer but I felt it was valuable to add this somewhere for visitors.]Details:Results:I tried it out this way, but it's more verbose than the top answer by using any operator (or function) that allows you to define the function first:This isn't a direct answer, but a workaround. Using PHP >= 7. Defining an anonymous class with a named method and constructing the class and calling the method right away.Not executed inmediately, but close to ;)

Composer require local package

Sammitch

[Composer require local package](https://stackoverflow.com/questions/29994088/composer-require-local-package)

I've got a couple of libraries [Foo and Bar] that I'm developing in concert, but are still technically separate things. Previously I've just re-defined the autoloader to like "Foo\\": "../Foo/src", but now that I've added a Guzzle dependency to Foo, Bar flips it's lid because it's not one of its dependencies.Directory structure:Theoretical Autoload Statement: [in Bar/composer.json]Example code:How can I resolve this without setting up a local Composer repo? I want to maintain these as separate packages, just that one requires the other, and therefor processes the other's dependencies.Thanks to infomaniac I've done the following:Initialized the git repo:Added the composer config:And then composer update!

2015-05-01 19:50:34Z

I've got a couple of libraries [Foo and Bar] that I'm developing in concert, but are still technically separate things. Previously I've just re-defined the autoloader to like "Foo\\": "../Foo/src", but now that I've added a Guzzle dependency to Foo, Bar flips it's lid because it's not one of its dependencies.Directory structure:Theoretical Autoload Statement: [in Bar/composer.json]Example code:How can I resolve this without setting up a local Composer repo? I want to maintain these as separate packages, just that one requires the other, and therefor processes the other's dependencies.Thanks to infomaniac I've done the following:Initialized the git repo:Added the composer config:And then composer update!You can use Composer's repositories featurehttps://getcomposer.org/doc/05-repositories.md#loading-a-package-from-a-vcs-repositoryInstead of using the http format, specify a file path on disk.The way to link to a local, in-development package is to first add in your main project's composer.json a repository, like this:You also need to either have a version specified in your development package's composer.json or the way I do it is to require the package using @dev, like this:It should output:The @dev in the require command is important, composer uses this to pickup the source code and symlink it to your new package.It's a stability flag added to the version constraint (see package link).The minimum-stability flags are:After spending some time, I finally understood the solution. Maybe it'll be useful for someone like me and will save you some time, so I've decided that I have to share it here.Assuming that you have the following directory structure (relative to your project root directory):In this example you may see that the local folder is meant for nested projects of your company, e.g. bar-project. But you could configure any other layout, if you wish.Each project has to have its own composer.json file, e.g. root composer.json and local/bar-project/composer.json. Then their contents would be as follows:(root composer.json:)(local/bar-project/composer.json:)If, for example, you wish to locate each project in a separate sibling directory, as follows:- then you need to link to respective directory in repositories section:After that don't forget to composer update (or even rm -rf vendor && composer update -v as the docs suggest)!

Under the hood, composer will create a vendor/your-company/bar-project symlink that targets to local/bar-project (or ../bar-project respectively).Assuming that your public/index.php is just a front controller, e.g.:Then your config/composition-root.php would be:

How can I implement an Access Control List in my Web MVC application?

Kirzilla

[How can I implement an Access Control List in my Web MVC application?](https://stackoverflow.com/questions/3430181/how-can-i-implement-an-access-control-list-in-my-web-mvc-application)

First questionPlease, could you explain me how simpliest ACL could be implemented in MVC.Here is the first approach of using Acl in Controller...It is very bad approach, and it's minus is that we have to add Acl piece of code into each controller's method, but we don't need any additional dependencies!Next approach is to make all controller's methods private and add ACL code into controller's __call method.It is better than previous code, but main minuses are...The next approach is to put Acl code into parent Controller, but we still need to keep all child controller's methods private.What is the solution? And what is the best practice?

Where should I call Acl functions to decide allow or disallow method to be executed.Second questionSecond question is about getting role using Acl. Let's imagine that we have guests, users and user's friends. User have restricted access to viewing his profile that only friends can view it. All guests can't view this user's profile. So, here is the logic..The main question is about detecting owner of profile. We can detect who is owner of profile only executing model's method $model->getOwner(), but Acl do not have access to model. How can we implement this?I hope that my thoughts are clear. Sorry for my English.Thank you.

2010-08-07 11:11:02Z

First questionPlease, could you explain me how simpliest ACL could be implemented in MVC.Here is the first approach of using Acl in Controller...It is very bad approach, and it's minus is that we have to add Acl piece of code into each controller's method, but we don't need any additional dependencies!Next approach is to make all controller's methods private and add ACL code into controller's __call method.It is better than previous code, but main minuses are...The next approach is to put Acl code into parent Controller, but we still need to keep all child controller's methods private.What is the solution? And what is the best practice?

Where should I call Acl functions to decide allow or disallow method to be executed.Second questionSecond question is about getting role using Acl. Let's imagine that we have guests, users and user's friends. User have restricted access to viewing his profile that only friends can view it. All guests can't view this user's profile. So, here is the logic..The main question is about detecting owner of profile. We can detect who is owner of profile only executing model's method $model->getOwner(), but Acl do not have access to model. How can we implement this?I hope that my thoughts are clear. Sorry for my English.Thank you.In my humble opinion, the best way to approach this would be to use decorator pattern, Basically, this means that you take your object, and place it inside another object, which will act like a protective shell. This would NOT require you to extend the original class. Here is an example:And this would be how you use this sort of structure:As you might notice, this solution has several advantages:But, there are one major issue with this method too - you cannot natively check if secured object implements and interface ( which also applies for looking up existing methods ) or is part of some inheritance chain.In this case the main difference you should recognize is that you Domain Objects (in example: Profile) itself contains details about owner. This means, that for you to check, if (and at which level) user has access to it, it will require you to change this line:Essentially you have two options:Couple videos that might help you to come up with your own implementation:You seem to have the quite common ( and completely wrong ) understanding of what Model in MVC is. Model is not a class. If you have class named FooBarModel or something that inherits AbstractModel then you are doing it wrong.In proper MVC the Model is a layer, which contains a lot of classes. Large part of the classes can be separated in two groups , based on the responsibility:(read more: here and here):Instances from this group of classes deal with computation of values, check for different conditions, implement sales rules and do all the rest what you would call "business logic". They have no clue how data is stored, where it is stored or even if storage exists in first place.Domain Business object do not depend on database. When you are creating an invoice, it does not matter where data comes from. It can be either from SQL or from a remote REST API, or even screenshot of a MSWord document. The business logic does no change.Instances made from this group of classes are sometimes called Data Access Objects. Usually structures that implement Data Mapper pattern ( do not confuse with ORMs of same name .. no relation ). This is where your SQL statements would be (or maybe your DomDocument, because you store it in XML). Beside the two major parts, there is one more group of instances/classes, that should be mentioned: This is where your and 3rd party components come in play. For example, you can think of "authentication" as service, which can be provided by your own, or some external code. Also "mail sender" would be a service, which might knit together some domain object with a PHPMailer or SwiftMailer, or your own mail-sender component.Another source of services are abstraction on to on domain and data access layers. They are created to simplify the code used by controllers. For example: creating new user account might require to work with several domain objects and mappers. But, by using a service, it will need only one or two lines in the controller.What you have to remember when making services, is that the whole layer is supposed to be thin. There is no business logic in services. They are only there to juggle domain object, components and mappers.One of things they all have in common would be that services do not affect the View layer in any direct way, and are autonomous to such an extent, that they can be ( and quit often - are ) used outside the MVC structure itself. Also such self-sustained structures make the migration to a different framework/architecture much easier, because of extremely low coupling between service and the rest of application.First of all: These are different things / layers most often. As you criticize the exemplary controller code, it puts both together - most obviously too tight.tereško already outlined a way how you could decouple this more with the decorator pattern.I'd go one step back first to look for the original problem you're facing and discuss that a bit then.On the one hand you want to have controllers that just do the work they're commanded to (command or action, let's call it command).On the other hand you want to be able to put ACL in your application. The field of work of these ACLs should be - if I understood your question right - to control access to certain commands of your applications.This kind of access control therefore needs something else that brings these two together. Based on the context in which a command is executed in, ACL kicks in and decisions need to be done whether or not a specific command can be executed by a specific subject (e.g. the user).Let's summarize to this point what we have:The ACL component is central here: It needs to know at least something about the command (to identify the command to be precise) and it needs to be able to identify the user. Users are normally easily identified by a unique ID. But often in webapplications there are users that are not identified at all, often called guest, anonymous, everybody etc.. For this example we assume that the ACL can consume a user object and encapsulate these details away. The user object is bound to the application request object and the ACL can consume it.What about identifying a command? Your interpretation of the MVC pattern suggests that a command is compound of a classname and a method name. If we look more closely there are even arguments (parameters) for a command. So it's valid to ask what exactly identifies a command? The classname, the methodname, the number or names of arguments, even the data inside any of the arguments or a mixture of all this?Depending on which level of detail you need to identify a command in your ACL'ing, this can vary a lot. For the example let's keep it simply and specify that a command is identified by  the classname and method name.So the context of how these three parts (ACL, Command and User) are belonging to each other is now more clear.We could say, with an imaginary ACL compontent we can already do the following:Just see what is happeninig here: By making both the command and the user identifiable, the ACL can do it's work. The job of the ACL is unrelated to the work of both the user object and the concrete command.There is only one part missing, this can't live in the air. And it doesn't. So you need to locate the place where the access control needs to kick in. Let's take a look what happens in a standard webapplication:To locate that place, we know it must be before the concrete command is executed, so we can reduce that list and only need to look into the following (potential) places:At some point in your application you know that a specific user has requested to perform a concrete command. You already do some sort of ACL'ing here: If a user requests a command which does not exists, you don't allow that command to execute. So where-ever that happens in your application might be a good place to add the "real" ACL checks:The command has been located and we can create the identification of it so the ACL can deal with it. In case the command is not allowed for a user, the command will not be executed (action). Maybe a CommandNotAllowedResponse instead of the CommandNotFoundResponse for the case a request could not be resolved onto a concrete command.The place where the mapping of a concrete HTTPRequest is mapped onto a command is often called Routing. As the Routing already has the job to locate a command, why not extend it to check if the command is actually allowed per ACL? E.g. by extending the Router  to a ACL aware router: RouterACL. If your router does not yet know the User, then the Router is not the right place, because for the ACL'ing to work not only the command but also the user must be identified. So this place can vary, but I'm sure you can easily locate the place you need to extend, because it's the place that fullfills the user and command requirement:User is available since the beginning, Command first with Request(Command).So instead of putting your ACL checks inside each command's concrete implementation, you place it before it. You don't need any heavy patterns, magic or whatever, the ACL does it's job, the user does it's job and especially the command does it's job: Just the command, nothing else. The command has no interest to know whether or not roles apply to it, if it's guarded somewhere or not.So just keep things apart that don't belong to each other. Use a slightly rewording of the Single Responsibility Principle (SRP): There should be only one reason to change a command - because the command has changed. Not because you now introduce ACL'ing in your application. Not because you switch the User object. Not because you migrate from an HTTP/HTML interface to a SOAP or command-line interface.The ACL in your case controls the access to a command, not the command itself.One possibility is to wrap all your controllers in another class that extends Controller and have it delegate all the function calls to the wrapped instance after checking for authorization.You could also do it more upstream, in the dispatcher (if your application does indeed have one) and lookup the permissions based on the URLs, instead of control methods.edit: Whether you need to access a database, a LDAP server, etc. is orthogonal to the question. My point was that you could implement an authorization based on URLs instead of controller methods. These is more robust because you typically won't be changing your URLs (URLs area kind of public interface), but you might as well change the implementations of your controllers.Typically, you have one or several configuration files where you map specific URL patterns to specific authentication methods and authorization directives. The dispatcher, before dispatching the request to the controllers, determines if the user is authorized and aborts the dispatching if he's not.

How do I add PHP code/file to HTML(.html) files?

Hoon

[How do I add PHP code/file to HTML(.html) files?](https://stackoverflow.com/questions/11312316/how-do-i-add-php-code-file-to-html-html-files)

I can't use PHP in my HTML pages. For example, index.html. I've tried using both:and Neither of these work. My server offers PHP, and when I use a the .php extension, it works properly. Is this a problem or do I have to change the preferences in php.ini?

2012-07-03 13:45:21Z

I can't use PHP in my HTML pages. For example, index.html. I've tried using both:and Neither of these work. My server offers PHP, and when I use a the .php extension, it works properly. Is this a problem or do I have to change the preferences in php.ini?You can't run PHP in .html files because the server does not recognize that as a valid PHP extension unless you tell it to. To do this you need to create a .htaccess file in your root web directory and add this line to it:This will tell Apache to process files with a .htm or .html file extension as PHP files.I think writing PHP into an .html file is confusing and anti-natural. Why would you do that??Anyway, if what you want is to execute PHP files and show them as .html in the address bar, an easiest solution would be using .php as normal, and write a rule in your .htaccess like this:In order to use php in .html files, you must associate them with your PHP processor in your HTTP server's config file. In Apache, that looks like this:You can modify .htaccess like others said, but the fastest solution is to rename the file extension to .phpAdd this line to httpd.conf file for what you want to do.

But remember, if you do this then your web server will be very slow, because it will be parsing even static code which will not contain php code.

So the better way will be to make the file extension .phtml instead of just .html.For having .html files parsed as well, you need to set the appropriate handler in your server config.For Apache httpd 2.X this is the following lineSee the PHP docu for information on your specific server installation.By default you can't use PHP in HTML pages.To do that, modify your .htacccess file with the following: If you only have php code in one html file but have multiple other files that only contain html code, you can add the following to your .htaccess file so it will only serve that particular file as php. This will make the PHP executable ONLY on the "yourpage.html" file and not on all of your html pages which will prevent slowdown on your entire server. As to why someone might want to serve php via an html file, I use the IMPORTHTML function in google spreadsheets to import JSON data from an external url that must be parsed with php to clean it up and build an html table. So far I haven't found any way to import a .php file into google spreadsheets so it must be saved as an .html file for the function to work. Being able to serve php via an .html file is necessary for that particular use. Create an empty file using notepad and name it .htaccess  ,Then copy that file in your project directory and add this line and save.else save the .html file using .php as php can support html,and save it in computer/var/www/html path(linux)For combining HTML and PHP you can use .phtml files.

Is PHP's count() function O(1) or O(n) for arrays?

Dexter

[Is PHP's count() function O(1) or O(n) for arrays?](https://stackoverflow.com/questions/5835241/is-phps-count-function-o1-or-on-for-arrays)

Does count() really count the all the elements of a PHP array, or is this value cached somewhere and just gets retrieved?

2011-04-29 17:24:39Z

Does count() really count the all the elements of a PHP array, or is this value cached somewhere and just gets retrieved?Well, we can look at the source:/ext/standard/array.cPHP_FUNCTION(count) calls php_count_recursive(), which in turn calls zend_hash_num_elements() for non-recursive array, which is implemented this way:So you can see, it's O(1) for $mode = COUNT_NORMAL.In PHP 5+ the length is stored in the array so the counting is not done each time.EDIT:  You also might find this analysis interesting: PHP Count Performance.  Although the length of the array is maintained by the array, it still seems as though it is faster to hold on to it if you are going to call count() many times.PHP stores the size of an array internally, but you're still making a function call when which is slower than not making one, so you'll want to store the result in a variable if you're doing something like using it in a loop:For example,Additionally, you can't always be sure count is being called on an array. If it's called on an object that implements Countable for example, the count method of that object will be called.

Precedence and bitmask operations

infomaniac

[Precedence and bitmask operations](https://stackoverflow.com/questions/21975334/precedence-and-bitmask-operations)

I've come across a (seemingly) very strange case.Take the number 2 (0b10) and bitmask it with 1 (0b01)This should produce 0b00 which is equivalent to 0.However, here's where Mr Schrödinger comes in:Whiskey. Tango. Foxtrot.I am, admittedly, not the sharpest when it comes to bitwise operators - so maybe I've got horribly, horribly wrong somewhere?However, in Python:0b10 & 0b01 == 0 = True0b10 & 0b01 != 0 = False...so?

2014-02-23 22:10:53Z

I've come across a (seemingly) very strange case.Take the number 2 (0b10) and bitmask it with 1 (0b01)This should produce 0b00 which is equivalent to 0.However, here's where Mr Schrödinger comes in:Whiskey. Tango. Foxtrot.I am, admittedly, not the sharpest when it comes to bitwise operators - so maybe I've got horribly, horribly wrong somewhere?However, in Python:0b10 & 0b01 == 0 = True0b10 & 0b01 != 0 = False...so?You are actually doing this:Try:

Reading an Excel file in PHP

Dinah

[Reading an Excel file in PHP](https://stackoverflow.com/questions/563670/reading-an-excel-file-in-php)

I'm trying to read an Excel file (Office 2003). There is an Excel file that needs to be uploaded and its contents parsed.Via Google, I can only find answers to these related (and insufficient topics): generating Excel files, reading Excel XML files, reading Excel CSV files, or incomplete abandoned projects. I own Office 2003 so if I need any files from there, they are available. It's installed on my box but isn't and can't be installed on my shared host.Edit: so far all answers point to PHP-ExcelReader and/or this additional article about how to use it.

2009-02-19 01:53:33Z

I'm trying to read an Excel file (Office 2003). There is an Excel file that needs to be uploaded and its contents parsed.Via Google, I can only find answers to these related (and insufficient topics): generating Excel files, reading Excel XML files, reading Excel CSV files, or incomplete abandoned projects. I own Office 2003 so if I need any files from there, they are available. It's installed on my box but isn't and can't be installed on my shared host.Edit: so far all answers point to PHP-ExcelReader and/or this additional article about how to use it.I use PHP-ExcelReader to read xls files, and works great. You have 2 choices as far as I know:PHPExcel uses Spreadsheet_Excel_Reader for the Office 2003 format.Update: I once had to read some Excel files but I used the Office 2003 XML format in order to read them and told the people that were using the application to save and upload only that type of Excel file.It depends on how you want to use the data in the excel file. If you want to import it into mysql, you could simply save it as a CSV formatted file and then use fgetcsv to parse it.Read XLSX (Excel 97-2003)

https://github.com/shuchkin/simplexlsRead XLSX (Excel 2003+)

https://github.com/shuchkin/simplexlsxOutputCSV php reader

https://github.com/shuchkin/simplecsvTry this...I have used following code to read "xls and xlsx"Reference:http://coursesweb.net/php-mysql/read-excel-file-data-php_pcThere is a great article to explain how to read/write excel files through php code, They have been recommend to use MS-Excel Stream Handler PHP class, which is one of the top class library for that :)I'm using below excel file url: https://github.com/inventorbala/Sample-Excel-files/blob/master/sample-excel-files.xlsxOutput:I have used following code to read "xls and xlsx" : include 'PHPExcel/IOFactory.php';$location='sample-excel-files.xlsx';

Calculate total seconds in PHP DateInterval

efritz

[Calculate total seconds in PHP DateInterval](https://stackoverflow.com/questions/3176609/calculate-total-seconds-in-php-dateinterval)

What is the best way to calculate the total number of seconds between two dates?  So far, I've tried something along the lines of: However, the days property of the DateInterval object seems to be broken in the current PHP5.3 build (at least on Windows, it always returns the same 6015 value).  I also attempted to do it in a way which would fail to preserve number of days in each month (rounds to 30), leap years, etc:But I'm really not happy with using this half-assed solution.  

2010-07-04 23:51:48Z

What is the best way to calculate the total number of seconds between two dates?  So far, I've tried something along the lines of: However, the days property of the DateInterval object seems to be broken in the current PHP5.3 build (at least on Windows, it always returns the same 6015 value).  I also attempted to do it in a way which would fail to preserve number of days in each month (rounds to 30), leap years, etc:But I'm really not happy with using this half-assed solution.  Could you not compare the time stamps instead? This function allows you to get the total duration in seconds from a DateInterval objectYou could do it like this:time() returns the current time in seconds since the epoch time (1970-01-01T00:00:00), and strtotime does the same, but based on a specific date/time you give.You could just put in the hard numbers (instead of 60*60 - put in 3600) so it doesn't need to calculate them each time.Edit - fixed the number based off your comment.

PHP mkdir: Permission denied problem

folos

[PHP mkdir: Permission denied problem](https://stackoverflow.com/questions/5246114/php-mkdir-permission-denied-problem)

I am trying to create a directory with PHP mkdir function but I get an error as follows: Warning: mkdir() [function.mkdir]: Permission denied in .... How to settle down the problem?

2011-03-09 12:57:37Z

I am trying to create a directory with PHP mkdir function but I get an error as follows: Warning: mkdir() [function.mkdir]: Permission denied in .... How to settle down the problem?I know this is an old thread, but it needs a better answer. You shouldn't need to set the permissions to 777, that is a security problem as it gives read and write access to the world. It may be that your apache user does not have read/write permissions on the directory.Here's what you do in UbuntuThe php mkdir() function should now work without returning errorsLate answer for people who find this via google in the future. 

I ran into the same problem. NOTE: I AM ON MAC OSX LIONWhat happens is that apache is being run as the user "_www" and doesn't have permissions to edit any files. You'll notice NO filesystem functions work via php.How to fix:Open a finder window and from the menu bar, choose Go > Go To Folder > /private/etc/apache2now open httpd.conffind:change the username:Now restart apache by running this form terminal:If it still doesn't work,

I happen to do the following before I did the above. Could be related.Open terminal and run the following commands:

(note, my webserver files are located at /Library/WebServer/www. Change according to your website location)Link only answers are not considered good practice on StackOverflow, but the advice that is given here should generally NOT be followed up.I would like to revert to this great answer on a similar question. I quote:Fix the permissions of the directory you try to create a directory in.I know that this thread is old, but perhaps this will help someone, one day.The problem why PHP says "Permission denied" for mkdir() - wrong url path. So, to fix it, all you need it's to obtain correct path. I did it this way:You need to have file system permission to create the directory.Example: In Ubuntu 10.04 apache (php) runs as user: www-data in group: www-dataMeaning the user www-data needs access to create the directory.You can try this yourself by using: 'su www-data' to become the www-data user.As a quick fix, you can do: sudo chmod 777 my_parent_dirWhat the other thing you can do is go to: /etc/sudoersThere add the following line which gives the permission to that user

www-data ALL=(ALL:ALL) ALL

Why www-data ? this is because apache is running by this user name.Incase if your user is different then try 

username ALL=(ALL:ALL) ALLThis worked for me.Since you are on a mac, you could add yourself to the _www (the apache user group) group on your mac:and add _www user to the wheel group which seems to be what the mac creates files as:I have this problem just now, my best solution I can give to you right now (despite that you didn't include any of your code) would be:This is also worked for me just now.If you'r using LINUX, first let's check apache's user, since in some distros it can be different:Let's say the result is "http". Do the folowwing, just remember change path_to_folder to folders path:check if its not a issue with umask After you install the ftp server with sudo apt-get install vsftpd you will have to configure it. To enable write access you have to edit the /etc/vsftpd.conf file and uncomment the line, so it should readSave the file and restart vsftpd with sudo service vsftpd restart.For other configuration options consult this documentation or man vsftpd.conf

How would you access Object properties from within an object method? [closed]

cmcculloh

[How would you access Object properties from within an object method? [closed]](https://stackoverflow.com/questions/126/how-would-you-access-object-properties-from-within-an-object-method)

What is the "purist" or "correct" way to access an object's properties from within an object method that is not a getter/setter method?I know that from outside of the object you should use a getter/setter, but from within would you just do:Java:PHP:or would you do:Java:PHP:Forgive me if my Java is a little off, it's been a year since I programmed in Java...EDIT:It seems people are assuming I am talking about private or protected variables/properties only. When I learned OO I was taught to use getters/setters for every single property even if it was public (and actually I was told never to make any variable/property public). So, I may be starting off from a false assumption from the get go. It appears that people answering this question are maybe saying that you should have public properties and that those don't need getters and setters, which goes against what I was taught, and what I was talking about, although maybe that needs to be discussed as well. That's probably a good topic for a different question though...

2008-08-01 16:10:30Z

What is the "purist" or "correct" way to access an object's properties from within an object method that is not a getter/setter method?I know that from outside of the object you should use a getter/setter, but from within would you just do:Java:PHP:or would you do:Java:PHP:Forgive me if my Java is a little off, it's been a year since I programmed in Java...EDIT:It seems people are assuming I am talking about private or protected variables/properties only. When I learned OO I was taught to use getters/setters for every single property even if it was public (and actually I was told never to make any variable/property public). So, I may be starting off from a false assumption from the get go. It appears that people answering this question are maybe saying that you should have public properties and that those don't need getters and setters, which goes against what I was taught, and what I was talking about, although maybe that needs to be discussed as well. That's probably a good topic for a different question though...This has religious war potential, but it seems to me that if you're using a getter/setter, you should use it internally as well - using both will lead to maintenance problems down the road (e.g. somebody adds code to a setter that needs to run every time that property is set, and the property is being set internally w/o that setter being called).Personally, I feel like it's important to remain consistent.  If you have getters and setters, use them.  The only time I would access a field directly is when the accessor has a lot of overhead.  It may feel like you're bloating your code unnecessarily, but it can certainly save a whole lot of headache in the future.  The classic example:Later on, you may desire to change the way that field works.  Maybe it should be calculated on-the-fly or maybe you would like to use a different type for the backing store.  If you are accessing properties directly, a change like that can break an awful lot of code in one swell foop.I'm fairly surprised at how unanimous the sentiment is that getters and setters are fine and good. I suggest the incendiary article by Allen Holub "Getters And Setters Are Evil". Granted, the title is for shock value, but the author makes valid points.Essentially, if you have getters and setters for each and every private field, you are making those fields as good as public. You'd be very hard-pressed to change the type of a private field without ripple effects to every class that calls that getter.Moreover, from a strictly OO point of view, objects should be responding to messages (methods) that correspond to their (hopefully) single responsibility. The vast majority of getters and setters don't make sense for their constituent objects;Pen.dispenseInkOnto(Surface) makes more sense to me than Pen.getColor().Getters and setters also encourage users of the class to ask the object for some data, perform a calculation, and then set some other value in the object, better known as procedural programming. You'd be better served to simply tell the object to do what you were going to in the first place; also known as the Information Expert idiom.Getters and setters, however, are necessary evils at the boundary of layers -- UI, persistence, and so forth. Restricted access to a class's internals, such as C++'s friend keyword, Java's package protected access, .NET's internal access, and the Friend Class Pattern can help you reduce the visibility of getters and setters to only those who need them.It depends on how the property is used. For example, say you have a student object that has a name property. You could use your Get method to pull the name from the database, if it hasn't been retrieved already. This way you are reducing unnecessary calls to the database.Now let's say you have a private integer counter in your object that counts the number of times the name has been called. You may want to not use the Get method from inside the object because it would produce an invalid count.PHP offers a myriad of ways to handle this, including magic methods __get and __set, but I prefer explicit getters and setters. Here's why:Perhaps ;)Another approach would be to utilize a private/protected method to actually do the getting (caching/db/etc), and a public wrapper for it that increments the count:PHP:and then from within the object itself:PHP:This way you can still use that first argument for something else (like sending a flag for whether or not to used cached data here perhaps).I must be missing the point here, why would you use a getter inside an object to access a property of that object?Taking this to its conclusion the getter should call a getter, which should call a getter.So I'd say inside an object method access a property directly, especially seeing as calling another method in that object (which will just access the property directly anyway then return it) is just a pointless, wasteful exercise (or have I misunderstood the question).If by "purist" you mean "most encapsulation", then I typically declare all my fields as private and then use this.field from within the class itself, but all other classes, including subclasses, access instance state using the getters.i would say its better to use the accessor methods even within the object. Here are the points that come to my mind immediately:1) It should be done in the interest of maintaining consistency with accesses made outside the object.2) In some cases, these accessor methods could be doing more than just accessing the field; they could be doing some additional processing (its rare though). If this is the case, by accessing the field directly you would missing out that additional processing and your program could go awry if this processing is always to be done during those accessesThe purist OO way is to avoid both and follow the Law of Demeter by using the Tell Don't Ask approach.Instead of getting the value of the object's property, which tightly couples the two class, use the object as a parameter e.g.Where the property was a native type, e.g. int, use an access method,  name it for problem domain not the programming domain.These will allow you to maintain encapsulation and any post-conditions or dependent invariants. You can also use the setter method to maintain any pre-conditions or dependent invariants, however don't fall into the trap of naming them setters, go back to the Hollywood Principle for naming when using the idiom.i've found using setters/getters made my code easier to read. I also like the control it gives when other classes use the methods and if i change the data the property will store.Private fields with public or protected properties.  Access to the values should go through the properties, and be copied to a local variable if they will be used more than once in a method.  If and ONLY if you have the rest of your application so totally tweaked, rocked out, and otherwise optimized to where accessing values by going through their assosciated properties has become a bottleneck (And that will never EVER happen, I guarantee) should you even begin to consider letting anything other than the properties touch their backing variables directly..NET developers can use automatic properties to enforce this since you can't even see the backing variables at design time.If I won't edit the property I'll use a get_property() public method unless it's a special occasion such as a MySQLi object inside another object in which case I'll just public the property and refer to it as $obj->object_property.Inside the object it's always $this->property for me.It depends. It's more a style issue than anything else, and there is no hard rule.I can be wrong because I'm autodidact, but I NEVER user public properties in my Java classes, they are always private or protected, so that outside code must access by getters/setters. It's better for maintenance / modification purposes. And for inside class code... If getter method is trivial I use the property directly, but I always use the setter methods because I could easily add code to fire events if I wish.Well, it seems with C# 3.0 properties' default implementation, the decision is taken for you; you HAVE to set the property using the (possibly private) property setter.I personally only use the private member-behind when not doing so would cause the object to fall in an less than desirable state, such as when initializing or when caching/lazy loading is involved.I like the answer by cmcculloh, but it seems like the most correct is the answer by Greg Hurlman. Use getter/setters all the time if you started using them from the getgo and/or are used to working with them.As an aside, I personally find that using getter/setters makes the code easier to read and to debug later on.As stated in some of the comments: Sometimes you should, sometimes you shouldn't. The great part about private variables is that you are able to see all the places they are used when you change something. If your getter/setter does something you need, use it. If it doesn't matter you decide.The opposite case could be made that if you use the getter/setter and somebody changes the getter/setter they have to analyze all the places the getter and setter is used internally to see if it messes something up.

PHP how to get local IP of system

air

[PHP how to get local IP of system](https://stackoverflow.com/questions/3219178/php-how-to-get-local-ip-of-system)

I need to get local IP of computer like 192.*....

Is this possible with PHP?I need IP address of system running the script, but I do not need the external IP, I need his local network card address.

2010-07-10 12:28:13Z

I need to get local IP of computer like 192.*....

Is this possible with PHP?I need IP address of system running the script, but I do not need the external IP, I need his local network card address.$localIP = getHostByName(php_uname('n'));$localIP = getHostByName(getHostName());This is an old post, but get it with this:For example:Found it on another site, do not remove the trim command because otherwise you will get the computers name.BACKTICKS (The special quotes):

It works because PHP will attempt to run whatever it's between those "special quotes" (backticks) as a shell command and returns the resulting output.Is very similar (but much more efficient) than doing:try this (if your server is Linux):The default external IP address of the local machine can be obtained like this:How it works:Since this is UDP, socket_connect doesn't go out on the network. It only assigns a local address and port to the socket. This allows us to get the local address.This solution works without any network traffic, DNS, or command execution.It may not work if there is no route to 8.8.8.8 (e.g. you have no internet connection).Depends what you mean by local:If by local you mean the address of the server/system executing the PHP code, then there are still two avenues to discuss.  If PHP is being run through a web server, then you can get the server address by reading $_SERVER['SERVER_ADDR'].  If PHP is being run through a command line interface, then you would likely have to shell-execute ipconfig (Windows) / ifconfig (*nix) and grep out the address.If by local you mean the remote address of the website visitor, but not their external IP address (since you specifically said 192.*), then you are out of luck. The whole point of NAT routing is to hide that address. You cannot identify the local addresses of individual computers behind an IP address, but there are some tricks (user agent, possibly mac address) that can help differentiate if there are multiple computers accessing from the same IP.hostname(1) can tell the IP address: hostname --ip-address, or as man says, it's better to use hostname --all-ip-addressesYou may try this as regular user in CLI on Linux host:Output:I tried in Windows pc and Its worked and also think that Will work on Linux to.It is very simple and above answers are complicating things. Simply you can get both local and public ip addresses  using this method.It is easy one. You can get the host name by this simple code.Or you can also use $_SERVER['HTTP_HOST'] to get the hostname. I fiddled with this question for a server-side php (running from Linux terminal)I exploded 'ifconfig' and trimmed it down to the IP address.Here it is:And of course change 'wlan0' to your desired network device.My output is:If you are in a dev environment on OS X, connected via Wifi:Try this

continue processing php after sending http response

user1700214

[continue processing php after sending http response](https://stackoverflow.com/questions/15273570/continue-processing-php-after-sending-http-response)

My script is called by server. From server I'll receive ID_OF_MESSAGE and TEXT_OF_MESSAGE. In my script I'll handle incoming text and generate response with params: ANSWER_TO_ID and RESPONSE_MESSAGE.The problem is that I'm sending response to incomming "ID_OF_MESSAGE", but server which send me message to handle will set his message as delivered to me (It means I can send him response to that ID), after receiving http response 200. One of solution is to save message to database and make some cron which will be running each minute, but I need to generate response message immediately. Is there some solution how to send to server http response 200 and than continue executing php script?Thank you a lot

2013-03-07 14:20:02Z

My script is called by server. From server I'll receive ID_OF_MESSAGE and TEXT_OF_MESSAGE. In my script I'll handle incoming text and generate response with params: ANSWER_TO_ID and RESPONSE_MESSAGE.The problem is that I'm sending response to incomming "ID_OF_MESSAGE", but server which send me message to handle will set his message as delivered to me (It means I can send him response to that ID), after receiving http response 200. One of solution is to save message to database and make some cron which will be running each minute, but I need to generate response message immediately. Is there some solution how to send to server http response 200 and than continue executing php script?Thank you a lotYes. You can do this:I've seen a lot of responses on here that suggest using ignore_user_abort(true); but this code is not necessary. All this does is ensure your script continues executing before a response is sent in the event that the user aborts (by closing their browser or pressing escape to stop the request). But that's not what you're asking. You're asking to continue execution AFTER a response is sent. All you need is the following:If you're concerned that your background work will take longer than PHP's default script execution time limit, then stick  set_time_limit(0); at the top.If you're using FastCGI processing or PHP-FPM, you can:Source: https://www.php.net/manual/en/function.fastcgi-finish-request.phpI spent a few hours on this issue and I have come with this function which works on Apache and Nginx:You can call this function before your long processing. Modified the answer by @vcampitelli a bit. Don't think you need the close header. I was seeing duplicate close headers in Chrome.I use the php function register_shutdown_function for this.http://php.net/manual/en/function.register-shutdown-function.phpEdit: The above is not working. It seems I was misled by some old documentation. The behaviour of register_shutdown_function has changed since PHP 4.1 link linkin case of php file_get_contents use, connection close is not enough.

php still wait for eof witch send by server.my solution is to read 'Content-Length:'here is sample :response.php:Note the "\n" in response to close line, if not the fget read while wait eof.read.php :As you can see this script dosent wait about eof if content length is reach.hope it will helpI asked this question to Rasmus Lerdorf in April 2012, citing these articles:I suggested the development of a new PHP built-in function to notify the platform that no further output (on stdout?) will be generated (such a function might take care of closing the connection). Rasmus Lerdorf responded:I can see his point, and support his opinion for some applications/ loading scenarios! However, under some other scenarios, the solutions from vcampitelli et al, are good ones.I have something that can compressed and send the response and let other php code to execute.I can't install pthread and neither the previous solutions work for me. I found only the following solution to work (ref: https://stackoverflow.com/a/14469376/1315873):There is another approach and its worthwhile considering if you don't want to tamper with the response headers. If you start a thread on another process the called function wont wait for its response and will return to the browser with a finalized http code. You will need to configure pthread.Once we execute $continue_processing->start() PHP wont wait for the return result of this thread and therefore as far as rest_endpoint is considered. It is done.Some links to help with pthreadsGood luck.I know it's an old one, but possibly usefull at this point.With this answer i don't support the actual question but how to solve this problem correctly. Hope it helps other people to solve problems like this.I would suggest to use RabbitMQ or similar services and run the background workload using worker instances. There is a package called amqplib for php which does all the work for you to use RabbitMQ.Pro's:Neg's:

PHP memory profiling

JW.

[PHP memory profiling](https://stackoverflow.com/questions/880458/php-memory-profiling)

What's a good way to profile a PHP page's memory usage? For example, to see how much memory my data is using, and/or which function calls are allocating the most memory.Is there anything else?

2009-05-19 00:34:21Z

What's a good way to profile a PHP page's memory usage? For example, to see how much memory my data is using, and/or which function calls are allocating the most memory.Is there anything else?Xdebug reimplemented memory tracing in 2.6 (2018-01-29) which can be used in Qcachegrind or similar tool. Just make sure to select the memory option :)From the docs:I'm not familiar with the format of the file, but it's Qcachegrind has worked great for me in tracing a couple memory issues.As you probably know, Xdebug dropped the memory profiling support since the 2.* version. Please search for the "removed functions" string here: http://www.xdebug.org/updates.phpSo I've tried another tool and it worked well for me.https://github.com/arnaud-lb/php-memory-profilerThis is what I've done on my Ubuntu server to enable it:And then in my code:Finally open the callgrind.out file with KCachegrindFirst of all install the Google gperftools by downloading the latest package here: https://code.google.com/p/gperftools/Then as always:Now in your code:Then open your terminal and launch:pprof will create a new window in your existing browser session with something like shown below:With Xhprof and Xhgui you can profile the cpu usage as well or just the memory usage if that's your issue at the moment.

It's a very complete solutions, it gives you full control and the logs can be written both on mongo or in the filesystem.For more details see my answer here.Blackfire is a PHP profiler by SensioLabs, the Symfony2 guys https://blackfire.io/If you use puphpet to set up your virtual machine you'll be happy to know it's supported ;-)Well, this may not be exactly what you're looking for, but PHP does have a couple of functions built-in that will output memory usage.  If you just wanted to see how much memory a function call is using, you could use memory_get_peak_usage() before and after a call, and take the difference.You use the same technique around your data using the very similar memory_get_usage().Pretty unsophisticated approach, but it's a quick way to check out a piece of code.  I agree that xdebug mem deltas can be too verbose to be useful sometimes, so I often just use it to narrow down to a section of code, then dump out specific memory usage for small pieces manually.http://geek.michaelgrace.org/2012/04/tracing-php-memory-usage-using-xdebug-and-mamp-on-mac/I'm on a Mac so if you're on Windows you'll have to test this, but this works for me.I modified my tracefile-analyzer.php file and added the path to the PHP binary at the top so that you could call it in terminal as a normal unix script.Don't forget to chmod this file to 755.You could easily create a ruby watchr script to automatically call the script each time it creates a memory profile file (*.xt). That way you could keep testing and seeing your improvements without having to execute the command over and over.

How to get whole and decimal part of a number?

StackOverflowNewbie

[How to get whole and decimal part of a number?](https://stackoverflow.com/questions/6619377/how-to-get-whole-and-decimal-part-of-a-number)

Given, say, 1.25 - how do I get "1" and ."25" parts of this number? I need to check if the decimal part is .0, .25, .5, or .75.

2011-07-08 02:31:27Z

Given, say, 1.25 - how do I get "1" and ."25" parts of this number? I need to check if the decimal part is .0, .25, .5, or .75.Then compare against 1/4, 1/2, 3/4, etc.In cases of negative numbers, use this:The $returnUnsigned stops it from making -1.25 in to -1 & -0.25This code will split it up for you:where $whole is the whole number and $decimal will have the digits after the decimal point.Just to be different :)CodePad.As an added benefit, it will only split where both sides consist of digits.The floor() method doesn't work for negative numbers.  This works every time:...also works for negatives (same code, different number):a short way (use floor and fmod)then compare $decimal to 0, .25, .5, or .75Cast it as an int and subtractOr just to get the decimal for comparisonThere's a fmod function too, that can be used :

fmod($my_var, 1)

will return the same result, but sometime with a small round error.PHP 5.4+This is the way which I use:Brad Christie's method is essentially correct but it can be written more concisely.  This is equivalent to his method but shorter and hopefully easier to understand as a result. To prevent the extra float decimal (i.e. 50.85 - 50 give 0.850000000852), in my case I just need 2 decimals for money cents.I was having a hard time finding a way to actually separate the dollar amount and the amount after the decimal. I think I figured it out mostly and thought to share if any of yall were having troubleSo basically...if price is 1234.44... whole would be 1234 and decimal would be 44 orif price is 1234.01... whole would be 1234 and decimal would be 01 orif price is 1234.10... whole would be 1234 and decimal would be 10 and so forthIf you can count on it always having 2 decimal places, you can just use a string operation: No idea of performance but for my simple case this was much better... Not seen a simple modulus here...In this case getting both $wholeAs? and $decimal don't depend on the other. (You can just take 1 of the 3 outputs independently.) I've shown $wholeAsFloat and $wholeAsInt because floor() returns a float type number even though the number it returns will always be whole. (This is important if you're passing the result into a type-hinted function parameter.)I wanted this to split a floating point number of hours/minutes, e.g. 96.25, into hours and minutes separately for a DateInterval instance as 96 hours 15 minutes. I did this as follows:I didn't care about seconds in my case.

PHP is not recognized as an internal or external command in command prompt

Sadikhasan

[PHP is not recognized as an internal or external command in command prompt](https://stackoverflow.com/questions/31291317/php-is-not-recognized-as-an-internal-or-external-command-in-command-prompt)

I got the following error when I run a command with phpI don't get any error when I run the command with php in following path:Why I get this error?

2015-07-08 11:28:40Z

I got the following error when I run a command with phpI don't get any error when I run the command with php in following path:Why I get this error?Add C:\xampp\php to your PATH environment variable. Then close your command prompt and restart again. Note:It's very important to close your command prompt and restart again otherwise changes will not be reflected.You need to Go to My Computer->properties -> Advanced system settingNow click on Environment VariablesAdd ;C:\xampp\php in path variable valueNow restart command prompt DONE!Note: Make sure you run CMD via run as administratorYou just need to a add the path of your PHP file. In case you are using wamp or have not installed it on the C drive.Set "C:\xampp\php" in your PATH Environment Variable. Then restart CMD prompt.You need to add C:\xampp\php to your PATH Environment Variable, Only after then you would be able to execute php command line from outside php_home.Is your path correctly configured? In Windows, you can do that as described here: http://www.computerhope.com/issues/ch000549.htmI also got the following error when I run a command with PHP, I did the solution like that:Very important note: restart command prompt

Here what I DO on MY PC I install all software that i usually used in G: partian not C: 

if my operating system is fall (win 10) , Do not need  to reinstall them again and lost time , Then How windows work it update PATH automatic if you install any new programe or pice of softwore , SO I must update PATH like these HERE! all my software i usually used 

PHP GuzzleHttp. How to make a post request with params?

Arsen

[PHP GuzzleHttp. How to make a post request with params?](https://stackoverflow.com/questions/27825667/php-guzzlehttp-how-to-make-a-post-request-with-params)

How to make a post request with GuzzleHttp( version 5.0 ).I am trying to do the following:But I am getting the error:

2015-01-07 17:58:42Z

How to make a post request with GuzzleHttp( version 5.0 ).I am trying to do the following:But I am getting the error:Try this Since Marco's answer is deprecated, you must use the following syntax (according jasonlfunk's comment) : Usefull for long server operations.If you want more details information, you can use debug option like this :Documentation is more explicits about new possibilities.Note in Guzzle V6.0+, another source of getting the following error may be incorrect use of JSON as an array:Incorrect:Correct:Correct:Addopenssl.cafile in php.ini file

Laravel Eloquent ORM Transactions

wesside

[Laravel Eloquent ORM Transactions](https://stackoverflow.com/questions/15105640/laravel-eloquent-orm-transactions)

The Eloquent ORM is quite nice, though I'm wondering if there is an easy way to setup MySQL transactions using innoDB in the same fashion as PDO, or if I would have to extend the ORM to make this possible?

2013-02-27 06:33:30Z

The Eloquent ORM is quite nice, though I'm wondering if there is an easy way to setup MySQL transactions using innoDB in the same fashion as PDO, or if I would have to extend the ORM to make this possible?You can do this:Everything inside the Closure executes within a transaction. If an exception occurs it will rollback automatically.If you don't like anonymous functions:Update: For laravel 4, the pdo object isn't public anymore so:If you want to use Eloquent, you also can use thisThis is just sample code from my projectIf you want to avoid closures, and happy to use facades, the following keeps things nice and clean:If any statements fail, commit will never hit, and the transaction won't process. I'm Sure you are not looking for a closure solution, try this for a more compact solution For some reason it is quite difficult to find this information anywhere, so I decided to post it here, as my issue, while related to Eloquent transactions, was exactly changing this.After reading THIS stackoverflow answer, I realized my database tables were using MyISAM instead of InnoDB.For transactions to work on Laravel (or anywhere else as it seems), it is required that your tables are set to use InnoDBWhy?Quoting MySQL Transactions and Atomic Operations docs (here):If any exception occurs, the transaction will rollback automatically.Laravel Basic transaction format

How to properly set up a PDO connection

ThomasK

[How to properly set up a PDO connection](https://stackoverflow.com/questions/11369360/how-to-properly-set-up-a-pdo-connection)

From time to time I see questions regarding connecting to database.

Most answers is not the way I do it, or I might just not get the answers correctly. Anyway; I've never thought about it because the way I do it works for me.But here's a crazy thought; Maybe I'm doing this all wrong, and if that's the case; I would really like to know how to properly connect to a MySQL database using PHP and PDO and make it easy accessible.Here's how I'm doing it:First off, here's my file structure (stripped down):index.php

At the very top, I have require('initialize/load.initialize.php');.  load.initialize.php  I know there's a better, or more correct, way to include classes, but can't remember what it was. Haven't gotten the time to look into it yet, but I think it was something with autoload. something like that...configure.php

Here I basically just override some php.ini-properties and do some other global configuration for the siteconnect.php

I've put the connection onto a class so other classes can extends this one...Here I do believe there's room for massive improvement since I recently started learning OOP, and using PDO instead of mysql.

So I've just followed a couple of beginners tutorials and tried out different stuff...sessions.php

Beside handling regular sessions, I also initialize some classes into a session like this:  This way this class is available all over the place. This might not be good practice(?)...

Anyway, this is what this approach allows me to do from everywhere:Inside my sqlQuery-class, which extends my connect_pdo-class, I have a public function called getAreaName which handles the request to my database.

Pretty neat I think.Works like a charm

So that's basically how I'm doing it.

Also, whenever I need to fetch something from my DB from not within a class, I just do something similar to this:Since I put the connection into a variable inside connect_pdo.php, I just have referring to it and I'm good to go. It works. I get my expected results...But regardless of that; I would really appreciate if you guys could tell me if I'm way off here. What I should do instead, areas I could or should change for improvement etc... I'm eager to learn...

2012-07-06 20:37:42Z

From time to time I see questions regarding connecting to database.

Most answers is not the way I do it, or I might just not get the answers correctly. Anyway; I've never thought about it because the way I do it works for me.But here's a crazy thought; Maybe I'm doing this all wrong, and if that's the case; I would really like to know how to properly connect to a MySQL database using PHP and PDO and make it easy accessible.Here's how I'm doing it:First off, here's my file structure (stripped down):index.php

At the very top, I have require('initialize/load.initialize.php');.  load.initialize.php  I know there's a better, or more correct, way to include classes, but can't remember what it was. Haven't gotten the time to look into it yet, but I think it was something with autoload. something like that...configure.php

Here I basically just override some php.ini-properties and do some other global configuration for the siteconnect.php

I've put the connection onto a class so other classes can extends this one...Here I do believe there's room for massive improvement since I recently started learning OOP, and using PDO instead of mysql.

So I've just followed a couple of beginners tutorials and tried out different stuff...sessions.php

Beside handling regular sessions, I also initialize some classes into a session like this:  This way this class is available all over the place. This might not be good practice(?)...

Anyway, this is what this approach allows me to do from everywhere:Inside my sqlQuery-class, which extends my connect_pdo-class, I have a public function called getAreaName which handles the request to my database.

Pretty neat I think.Works like a charm

So that's basically how I'm doing it.

Also, whenever I need to fetch something from my DB from not within a class, I just do something similar to this:Since I put the connection into a variable inside connect_pdo.php, I just have referring to it and I'm good to go. It works. I get my expected results...But regardless of that; I would really appreciate if you guys could tell me if I'm way off here. What I should do instead, areas I could or should change for improvement etc... I'm eager to learn...As I see it, your aim in this case is twofold: I would recommend to use both anonymous function and factory pattern for dealing with PDO connection. The use of it would looks like this :Then in a different file or lower in the same file:The factory itself should look something like this:This way would let you have a centralized structure, which makes sure that connection is created only when required. It also would make the process of unit-testing and maintenance much easier.The provider in this case would be found somewhere at the bootstrap stage. This approach would also give a clear location where to define the configuration, that you use for connecting to the DB.Keep in mind that this is an extremely simplified example. You also might benefit from watching two following videos:Also, I would strongly recommend reading a proper tutorial about use of PDO (there are a log of bad tutorial online).I would suggest not using $_SESSION to access your DB connection globally.You can do one of a few things (in order of worst to best practices):I would highly recommend the last one. It is known as dependency injection (DI), inversion of control (IoC), or simply the Hollywood principle (Don't call us, we'll call you).However, it is a little more advanced and requires more "wiring" without a framework. So, if dependency injection is too complicated for you, use a singleton registry instead of a bunch of global variables.I recently came to a similar answer/question on my own. This is what I did, in case anyone is interested:To call it you only need to modify this line:And the type-hinting if you are using it to (\Library\PDO $DB).It's really similar to both the accepted answer and yours; however it has a notably advantage. Consider this code:While it might look like normal PDO (it changes by that \Library\ only), it actually doesn't initialize the object until you call the first method, whichever it is. That makes it more optimized, since the PDO object creation is slightly expensive. It's a transparent class, or what it's called a Ghost, a form of Lazy Loading. You can treat the $DB as a normal PDO instance, passing it around, doing the same operations, etc.or read on http://ask.hcig.co.za/?p=179

Getting the name of a child class in the parent class (static context)

saalaa

[Getting the name of a child class in the parent class (static context)](https://stackoverflow.com/questions/283004/getting-the-name-of-a-child-class-in-the-parent-class-static-context)

I'm building an ORM library with reuse and simplicity in mind; everything goes fine except that I got stuck by a stupid inheritance limitation. Please consider the code below:Obviously, this is not the behavior I was expecting (although the actual behavior also makes sense).. So my question is if you guys know of a mean to get, in the parent class, the name of child class.

2008-11-12 04:10:09Z

I'm building an ORM library with reuse and simplicity in mind; everything goes fine except that I got stuck by a stupid inheritance limitation. Please consider the code below:Obviously, this is not the behavior I was expecting (although the actual behavior also makes sense).. So my question is if you guys know of a mean to get, in the parent class, the name of child class.in short. this is not possible. in php4 you could implement a terrible hack (examine the debug_backtrace()) but that method does not work in PHP5. references:edit: an example of late static binding in PHP 5.3 (mentioned in comments). note there are potential problems in it's current implementation (src).You don't need to wait for PHP 5.3 if you're able to conceive of a way to do this outside of a static context.  In php 5.2.9, in a non-static method of the parent class, you can do:and it will return the name of the child class as a string.i.e.this will output:sweet huh?I know this question is really old, but for those looking for a more practical solution than defining a property in every class containing the class name: You can use the static keyword for this.As explained in this contributor note in the php documentation Example:I know its old post but want to share the solution I have found.Tested with PHP 7+

Use the function get_class()linkThe above example will output:In case you don't want to use get_called_class() you can use other tricks of late static binding (PHP 5.3+). But the downside in this case you need to have getClass() method in every model. Which is not a big deal IMO.It appears you might be trying to use a singleton pattern as a factory pattern. I would recommend evaluating your design decisions. If a singleton really is appropriate, I would also recommend only using static methods where inheritance is not desired.Maybe this isn't actually answering the question, but you could add a parameter to get() specifing the type. then you can callinstead of calling User::get(). You could add logic in BaseModel::get() to check whether a get method exists in the subclass and then call that if you want to allow the subclass to override it.Otherwise the only way I can think of obviously is by adding stuff to each subclass, which is stupid:This would probably break if you then subclassed User, but I suppose you could replace get_parent_class(__CLASS__) with 'BaseModel' in that caseThe problem is not a language limitation, it is your design.  Never mind that you have classes; the static methods belie a procedural rather than object-oriented design.  You're also using global state in some form.  (How does get_row_from_db_as_array() know where to find the database?)  And finally it looks very difficult to unit test.Try something along these lines.Two variations on Preston's answer:1) 2)Note: starting a property name with _ is a convention that basically means "i know i made this public, but it really should have been protected, but i couldn't do that and achieve my goal"

how to enable sqlite3 for php?

Moon

[how to enable sqlite3 for php?](https://stackoverflow.com/questions/948899/how-to-enable-sqlite3-for-php)

I am trying to install sqlite3 for PHP in Ubuntu.I install apt-get php5-sqlite3 and edited php.ini to include sqlite3 extension.When I run phpinfo(); I getas shown above, sqlite3 is enabled. However, I get "Class SQLite3 not found" when I use

2009-06-04 06:35:12Z

I am trying to install sqlite3 for PHP in Ubuntu.I install apt-get php5-sqlite3 and edited php.ini to include sqlite3 extension.When I run phpinfo(); I getas shown above, sqlite3 is enabled. However, I get "Class SQLite3 not found" when I useEdit: This answer is outdated, but can't be removed because it's accepted. Please see the solution from Stacey Richards for the correct answer.Ripped from the ubuntu form. Try:That worked for me.For PHP7, use and restart ApacheThe accepted answer is not complete without the remainder of instructions (paraphrased below) from the forum thread linked to:For Ubuntu 18.04 and PHP 7.2:sudo apt install php-sqlite3The SQLite3 PDO driver is named SQLite, not SQLite3, so you can do:For a SQLite2 database:one thing I want to add , before you try to  install or search the given package is available or not :- After that you get :-Here you get an idea about whether your version support or not ..

in my system I get php5-sqlite - SQLite module for php5

so I prefer to install That worked for me.try this:In Centos 6.7, in my case the library file /usr/lib64/php/modules/sqlite3.so was missing.Only use:and laterDepends on the version of PHP. For php7.0 the following commands work:

sudo apt-get install php7.0-sqlite3

then restart the Apache server:

sudo service apache2 restartFor Debian distributions. Nothing worked for until I added the debian main repositories on the apt sources (I don't know how were they removed):

sudo vi /etc/apt/sources.listand addedafter that sudo apt-get update (you can upgrade too) and finally sudo apt-get install php-sqlite3This will drown here, but I fixed my problems with this:As far as I have found out, there is a faulty file in /usr/local/lib called libsqlite3.so.0 which points to libsqlite3.so.0.8.6. It's been installed through the php7.3-* packages as far as I can tell.I renamed the file in case it was needed for something. With the command:cd /usr/local/lib

sudo mv libsqlite3.so.0 ./libsqlite3.so.0.backBut you can also just delete it:

rm libsqlite3.so.0The thread that lead me to the answer: linkThis solved my problems, and I hope they solve yours as well :)The Debian/Ubuntu way for php-7.2, php-7.3 & php-7.4 (e.g. the [234] part)Be sure to note that on Windows Subsystem for Linux version 1 (WSL1) the (file-)locking system for SQlite is broken.

How do I find all YouTube video ids in a string using a regex?

n00b

[How do I find all YouTube video ids in a string using a regex?](https://stackoverflow.com/questions/5830387/how-do-i-find-all-youtube-video-ids-in-a-string-using-a-regex)

I have a textfield where users can write anything.For example:Now I would like to parse it and find all YouTube video URLs and their ids.Any idea how that works?

2011-04-29 09:32:41Z

I have a textfield where users can write anything.For example:Now I would like to parse it and find all YouTube video URLs and their ids.Any idea how that works?A YouTube video URL may be encountered in a variety of formats:Here is a PHP function with a commented regex that matches each of these URL forms and converts them to links (if they are not links already):;  // End $YouTubeId.And here is a JavaScript version with the exact same regex (with comments removed):Notes:Edit 2011-07-05: Added - hyphen to ID char classEdit 2011-07-17: Fixed regex to consume any remaining part (e.g. query) of URL following YouTube ID. Added 'i' ignore-case modifier. Renamed function to camelCase. Improved pre-linked lookahead test.Edit 2011-07-27: Added new "user" and "ytscreeningroom" formats of YouTube URLs.Edit 2011-08-02: Simplified/generalized to handle new "any/thing/goes" YouTube URLs.Edit 2011-08-25: Several modifications:Edit 2011-10-12: YouTube URL host part may now have any subdomain (not just www.).Edit 2012-05-01: The consume URL section may now allow for '-'.Edit 2013-08-23: Added additional format provided by @Mei. (The query part may have a . dot.Edit 2013-11-30: Added additional format provided by @CRONUS: youtube-nocookie.com.Edit 2016-01-25: Fixed regex to handle error case provided by CRONUS.Here's a method I once wrote for a project that extracts YouTube and Vimeo video keys:While ridgerunner's answer is the basis for my answer, his does NOT solve for all urls and I don't believe it is capable of it, due to multiple possible matches of VIDEO_ID in a YouTube URL. My regex includes his aggressive approach as a last resort, but attempts all common matchings first, vastly reducing the possibility of a wrong match later in the URL.This regex: Handles all of the cases originally referenced in ridgerunners examples, plus any url that might happen to have an 11 character sequence later in the url.  ie: http://www.youtube.com/watch?v=GUEZCxBcM78&feature=pyv&feature=pyv&ad=10059374899&kw=%2BwingsuitHere is a working sample that tests all of the sample YouTube urls:http://jsfiddle.net/DJSwc/5/TryYou will find the video IDs' in the first capturing group. What I don't know is what is a valid Video ID? At the moment I check for v= and capture all -A-Za-z0-9_.I checked it online here on rubular with your sample string.Use:Okay, I made a function of my own. But I believe it's pretty inefficient.

Any improvements are welcome:I tried a simple expression to get only the videoid:Check it working online here at phpliveregex.The original poster asked "I would like to parse it and find all YouTube video URLs and their ids." I switched the most popular answer above to a preg_match  and returned the video id and URL.Get YouTube URL and ID from post:Find a YouTube link easily from a string:This code in java works absolutely fine for all youtube urls at present.

PHP split alternative?

igorgue

[PHP split alternative?](https://stackoverflow.com/questions/2813241/php-split-alternative)

PHP is telling me that split is deprecated, what's the alternative method I should use?

2010-05-11 18:07:04Z

PHP is telling me that split is deprecated, what's the alternative method I should use?explode is an alternative. However, if you meant to split through a regular expression, the alternative is preg_split instead.split is deprecated since it is part of the family of functions which make use of POSIX regular expressions; that entire family is deprecated in favour of the PCRE (preg_*) functions. If you do not need the regular expression functionality, then explode is a very good choice (and would have been recommended over split even if that were not deprecated), if on the other hand you do need to use regular expressions then the PCRE alternate is simply preg_split.Also for the future, if you ever want to know what PHP wants you to use if something is deprecated you can always check out the function in the manual and it will tell you alternatives.I want to clear here that preg_split(); is far away from it but explode(); can be used in similar way as split();following is the comparison between split(); and explode(); usageURL: http://php.net/manual/en/function.split.phpURL: http://php.net/manual/en/function.explode.phpHere is how we can use it :)You can use the easier function preg_match instead, It's better and faster than all of the other ones.Output: Get this varYes, I would use explode or you could use:preg_splitWhich is the advised method with PHP 6.

preg_split DocumentationIf you want to split a string into words, you can use explode() or str_word_count().Had the same issue, but my code must work on both PHP 5 & PHP 7.. Here is my piece of code, which solved this.. Input a date in dmY format with one of delimiters "/ . -"

php: determine where function was called from

pol_b

[php: determine where function was called from](https://stackoverflow.com/questions/2960805/php-determine-where-function-was-called-from)

is there a way to find out, where a function in PHP was called from?

example:

2010-06-02 19:09:34Z

is there a way to find out, where a function in PHP was called from?

example:You can use debug_backtrace().Example:Output:Use debug_backtrace():Fastest and simplest solution as I foundI test the speed on Lenovo laptop: Intel Pentiom CPU N3530 2.16GHz, RAM 8GBResults:So if you still REALLY don't know how, than here is solution:Use the debug_backtrace function: http://php.net/manual/en/function.debug-backtrace.phpIf you want to trace the exact origin of the call at the top of the stack you can use the following code:This will ignore chained functions and get only the most relevant call info (relevant is used loosely as it depends what your are trying to accomplish).Try below code.Hope it helps somebody. If the actual function is outside httpdocs then it can not be found because the server will be setup to not allow it. Only tested it one folder deep too but the recursive methodology should work in theory.This is like version 0.1 but I don't intend on continuing development on it so if someone updates it feel free to repost it.

How to get form input array into PHP array

thom

[How to get form input array into PHP array](https://stackoverflow.com/questions/3314567/how-to-get-form-input-array-into-php-array)

I have a form like the one below which is posted to contacts.php, and the user can dynamically add more with jquery.If i echo them out in php with the code belowI will get something like this:how can I get those arrays into something like the code belowso my output is like this:thank you for any help or advice

2010-07-23 00:35:59Z

I have a form like the one below which is posted to contacts.php, and the user can dynamically add more with jquery.If i echo them out in php with the code belowI will get something like this:how can I get those arrays into something like the code belowso my output is like this:thank you for any help or adviceThey are already in arrays: $name is an array, as is $emailSo all you need to do is add a bit of processing to attack both arrays:To handle more inputs, just extend the pattern:E.g. by naming the fields like(which is also possible when adding elements via javascript)The corresponding php script might look likeI know its a bit late now, but you could do something such as this:The test with:This for me produced:What if you've got array of fieldsets?I added a hidden field to count the number of the fieldsets.

The user can add or delete the fields and then save it.I came across this problem as well. Given 3 inputs: field[], field2[], field3[]You can access each of these fields dynamically. Since each field will be an array, the related fields will all share the same array key. For example, given input data:Bob and his email and sex will share the same key. With this in mind, you can access the data in a for loop like this:This scales as well. All you need to do is add your respective array vars whenever you need new fields to be added.However, VolkerK's solution is the best to avoid miss couple between email and username. So you have to generate HTML code with PHP like this:Change $total_data to suit your needs. To show it, just like this:Assuming the data was sent using POST method.Nonetheless, you can use below code as,This is easy one:Using this method should work:

How to properly URL encode a string in PHP?

Click Upvote

[How to properly URL encode a string in PHP?](https://stackoverflow.com/questions/4744888/how-to-properly-url-encode-a-string-in-php)

I'm making a search page, where you type a search query and the form is submitted to search.php?query=your query. What PHP function is the best and that I should use for encoding/decoding the search query?

2011-01-20 08:31:45Z

I'm making a search page, where you type a search query and the form is submitted to search.php?query=your query. What PHP function is the best and that I should use for encoding/decoding the search query?For the URI query use urlencode/urldecode; for anything else use rawurlencode/rawurldecode.The difference between urlencode and rawurlencode is thatThe cunningly-named urlencode() and urldecode().However, you shouldn't need to use urldecode() on variables that appear in $_POST and $_GET.Here is my use case, which requires an exceptional amount of encoding. Maybe you think it contrived, but we run this on production. Coincidently, this covers every type of encoding, so I'm posting as a tutorial.Somebody just bought a prepaid gift card ("token") on our website. Tokens have corresponding URLs to redeem them. This customer wants to email the URL to someone else. Our web page includes a mailto link that lets them do that.Note: the above assumes you are outputting to a text/html document. If your output media type is text/json then simply use $retval['url'] = $mailToUri; because output encoding is handled by json_encode().You should see:And of course this is the JSON representation of $token above.You can use URL Encoding Functions PHP has thefunctionASP has thefunctionIn JavaScript you can use thefunction.

How to do error logging in CodeIgniter (PHP)

udaya

[How to do error logging in CodeIgniter (PHP)](https://stackoverflow.com/questions/3209807/how-to-do-error-logging-in-codeigniter-php)

I want error logging in PHP CodeIgniter. How do I enable error logging?  I have some questions:

2010-07-09 04:21:46Z

I want error logging in PHP CodeIgniter. How do I enable error logging?  I have some questions:CodeIgniter has some error logging functions built in.See http://www.codeigniter.com/user_guide/general/errors.htmlTo simply put a line in the server's error log, use PHP's error_log() function. However, that method will not send an e-mail.First, to trigger an error:By default, this will go in the server's error log file. See the ErrorLog directive for Apache. To set your own log file:Note that the log file you choose must already exist and be writable by the server process. The simplest way to make the file writable is to make the server user the owner of the file. (The server user may be nobody, _www, apache, or something else, depending on your OS distribution.)To e-mail the error, you need to set up a custom error handler:Please see the relevant PHP documentation for more info.Also make sure that you have allowed codeigniter to log the type of messages you want in a config file.i.e $config['log_threshold'] = [log_level ranges 0-4];More oin regards to question part 4 How do you e-mail that error to an email address?

The error_log function has email destination too.

http://php.net/manual/en/function.error-log.phpAgha, here I found an example that shows a usage.

Send errors message via email using error_log()

How can I implode an array while skipping empty array items?

Tom Auger

[How can I implode an array while skipping empty array items?](https://stackoverflow.com/questions/5985401/how-can-i-implode-an-array-while-skipping-empty-array-items)

Perl's join() ignores (skips) empty array values; PHP's implode() does not appear to.Suppose I have an array:yields:instead of (IMHO the preferable):Any other built-ins with the behaviour I'm looking for? Or is it going to be a custom jobbie?

2011-05-12 22:49:45Z

Perl's join() ignores (skips) empty array values; PHP's implode() does not appear to.Suppose I have an array:yields:instead of (IMHO the preferable):Any other built-ins with the behaviour I'm looking for? Or is it going to be a custom jobbie?You can use array_filter():Obviously this will not work if you have 0 (or any other value that evaluates to false) in your array and you want to keep it. But then you can provide your own callback function.I suppose you can't consider it built in (because the function is running with a user defined function), but you could always use array_filter.

Something like:How you should implement you filter only depends on what you see as "empty".To remove null, false, empty string but preserve 0, etc. use func. 'strlen'will output:Based on what I can find, I'd say chances are, there isn't really any way to use a PHP built in for that. But you could probably do something along the lines of this:Try this:array_fileter() seems to be the accepted way here, and is probably still the most robust answer tbh.However, the following will also work if you can guarantee that the "glue" character doesn't already exist in the strings of each array element (which would be a given under most practical circumstances -- otherwise you wouldn't be able to distinguish the glue from the actual data in the array):Try this:

Test PHP headers with PHPUnit

titel

[Test PHP headers with PHPUnit](https://stackoverflow.com/questions/9745080/test-php-headers-with-phpunit)

I'm trying to use PHPunit to test a class that outputs some custom headers.The problem is that on my machine this:or even this:return this error:This looks as if there is something else outputting to the terminal before the test runs even though there is no other file included and there is no other character before the beginning of the PHP tag. Could it be something inside PHPunit that is causing this?What could the issue be?

2012-03-16 22:04:20Z

I'm trying to use PHPunit to test a class that outputs some custom headers.The problem is that on my machine this:or even this:return this error:This looks as if there is something else outputting to the terminal before the test runs even though there is no other file included and there is no other character before the beginning of the PHP tag. Could it be something inside PHPunit that is causing this?What could the issue be?The issue is that PHPUnit will print a header to the screen and at that point you can't add more headers.The work around is to run the test in an isolated process. Here is an exampleThis will result in:The key is the @runInSeparateProcess annotation. If you are using PHPUnit ~4.1 or something and get the error:Try add this to your bootstrap file to fix it:Although running the test in a separate process does fix the problem, there's a noticeable overhead when running a large suite of tests.My fix was to direct phpunit's output to stderr, like so:That should fix the problem, and it also means that you don't have to create a wrapper function and replace all occurrences in your code.As an aside: For me headers_list() kept returning 0 elements. I noticed @titel's comment on the question and figured it deserves special mention here:HTHI had a more radical solution, in order to use $_SESSION inside my tested/included files.

I edited one of the PHPUnit files at ../PHPUnit/Utils/Printer.php to have a "session_start();" before the command "print $buffer". It worked for me like a charm. But I think "joonty" user's solution is the best of all up to now.As already mentioned in a comment, I think it's a better solution to define processIsolation in the XML config file like Like this, you don't have to pass the --stderr option, which might irritate your co-workers. An alternative solution to @runInSeparateProcess is to specify the --process-isolation option when running PHPUnit:That is analogous to set the processIsolation="true" option in phpunit.xml.This solution has similar advantages/disadvantages to specifying the --stderr option, which however did not work in my case. Basically no code changes are necessary, even though there may be a performance hit due to running each test in a separate PHP process.Use --stderr parameter for getting headers from PHPUnit after your tests.

how to delete all cookies of my website in php

Mac Taylor

[how to delete all cookies of my website in php](https://stackoverflow.com/questions/2310558/how-to-delete-all-cookies-of-my-website-in-php)

I'm wondering if I can delete all my website's cookies when a user click on logout, because I used this as function to delete cookies but it isn't work properly:Is there a way to delete one domain's cookies in PHP?

2010-02-22 11:34:00Z

I'm wondering if I can delete all my website's cookies when a user click on logout, because I used this as function to delete cookies but it isn't work properly:Is there a way to delete one domain's cookies in PHP?PHP setcookie()Taken from that page, this will unset all of the cookies for your domain:http://www.php.net/manual/en/function.setcookie.php#73484Even better is however to remember (or store it somewhere) which cookies are set with your application on a domain and delete all those directly.

That way you can be sure to delete all values correctly.I agree with some of the above answers. I would just recommend replacing "time()-1000" with "1". A value of "1" means January 1st, 1970, which ensures expiration 100%. Therefore:make sure you call your setcookie function before any output happens on your site.also, if your users are logging out, you should also delete/invalidate their session variables.When you change the name of your Cookies, you may also want to delete all Cookies but preserve one:Also based on this PHP-AnswerThe provided Answers did not solve my problem,It did not:My script does, see.It is not the most pretty/safe/optimal solution, so use this only if you do not known the cookie-path and/or cookie-domain's. Or use the idea in order to create your version.You should be aware of various tracking tools like Google Analytics also use cookies on your domain and you don't want to delete them, if you want to have correct data in GA.The only solution I could get working was to set the existing cookies to null. I couldn't delete the cookies from the client.So for logging a user out I use the following:Of course this doesn't delete ALL cookies.All previous answers have overlooked that the setcookie could have been used with an explicit domain. Furthermore, the cookie might have been set on a higher subdomain, e.g. if you were on a foo.bar.tar.com domain, there might be a cookie set on tar.com. Therefore, you want to unset cookies for all domains that might have dropped the cookie:I know this question is old, but this is a much easier alternative:But be careful! It will erase ALL headers, including Cookies, Session, etc., as explained in the docs.Use the function to clear cookies:If you pass true then it clears session data, otherwise session data is preserved.

How can I access an object property named as a variable in php?

Flavio Copes

[How can I access an object property named as a variable in php?](https://stackoverflow.com/questions/3515861/how-can-i-access-an-object-property-named-as-a-variable-in-php)

A Google APIs encoded in JSON returned an object such as thisAnyone knows how can I access the $t value?$object->$t obviously returns

2010-08-18 19:25:59Z

A Google APIs encoded in JSON returned an object such as thisAnyone knows how can I access the $t value?$object->$t obviously returnsSince the name of your property is the string '$t', you can access it like this:Alternatively, you can put the name of the property in a variable and use it like this:You can see both of these in action on repl.it: https://repl.it/@jrunning/SpiritedTroubledWorkspaceHave you tried:Correct answer (also for PHP7) is:I'm using php7 and the following works fine for me:this works on php 5 and 7

How do I get the last inserted ID of a MySQL table in PHP?

gweg

[How do I get the last inserted ID of a MySQL table in PHP?](https://stackoverflow.com/questions/1685860/how-do-i-get-the-last-inserted-id-of-a-mysql-table-in-php)

I have a table into which new data is frequently inserted. I need to get the very last ID of the table. How can I do this?Is it similar to SELECT MAX(id) FROM table?

2009-11-06 06:49:21Z

I have a table into which new data is frequently inserted. I need to get the very last ID of the table. How can I do this?Is it similar to SELECT MAX(id) FROM table?If you're using PDO, use PDO::lastInsertId.If you're using Mysqli, use mysqli::$insert_id.If you're still using Mysql:But if you have to, use mysql_insert_id.there is a function to know what was the last id inserted in the current connectionplus using max is a bad idea because it could lead to problems if your code is used at same time in two different sessions.That function is called mysql_insert_idIt's ok. Also you can use LAST_INSERT_ID()With PDO:With Mysqli:Please, don't use mysql_* functions in new code. They are no longer maintained and are officially deprecated. See the red box? Learn about prepared statements instead, and use PDO or MySQLi - this article will help you decide which. If you choose PDO, here is a good tutorial.What you wrote would get you the greatest id assuming they were unique and auto-incremented that would be fine assuming you are okay with inviting concurrency issues.

Since you're using MySQL as your database, there is the specific function LAST_INSERT_ID() which only works on the current connection that did the insert.

PHP offers a specific function for that too called mysql_insert_id.Try this should work fine:You can get the latest inserted id by the in built php function mysql_insert_id();you an also get the latest id byTo get last inserted id in codeigniter 

After executing insert query just use one function called insert_id() on database, it will return  last inserted idEx:in one lineIt's ok to use mysql_insert_id(),

but there is one specific note about using it, you must call it after executed INSERT query, means in the same script session. 

If you use it otherwise it wouldn't work correctly.Clean and Simple -NOTE: if you do multiple inserts with one statement mysqli::insert_id will not be correct. The table:create table xyz (id int(11) auto_increment, name varchar(255), primary key(id));Now if you do:insert into xyz (name) values('one'),('two'),('three'); The mysqli::insert_id will be 1 not 3. To get the correct value do: mysqli::insert_id + mysqli::affected_rows) - 1This has been document but it is a bit obscure.I prefer use a pure MySQL syntax to get last auto_increment id of the table I want.php mysql_insert_id() and mysql last_insert_id() give only last transaction ID.If you want last auto_incremented ID of any table in your schema (not only last transaction one), you can use this queryThat's it.It's sad not to see any answers with an example.Using Mysqli::$insert_id:Using PDO::lastInsertId:Using MySQLi transaction I sometimes wasn't able to get mysqli::$insert_id, because it returned 0. Especially if I was using stored procedures, that executing INSERTs. So there is another way within transaction:Use mysqli as mysql is depricating I tried mysqli_insert_id($dbConnectionObj)This returns the current connection's last inserted id so if you are managing your connections properly this should work. Worked for me at least. Please use PDP and then try this $lastid = mysql_insert_id();By all this discussion I assume that the reason to check max id is to know what id should be next.. (if my max id is 5 then next will be 5+1=6). >>If this is not the reason, my best apologiesCase if someone else INSERTs information between your CHECK and INSERT would give you wrong ID.So It can be solved if you would create hash that could include timestamp or other unique value. Then in the same function you can insert your information with empty values and your hash. That would create ID if you have AUTO_INCRECEMENT selected.Then in the same function you would still have your hash and you could look for id with the same hash.

And then you could complete populating empty values with mysql UPDATE.This includes a bit more connections, but it is still a way to do it...Good luck solving it.If your table  have  AUTO INCREMENT column like UserID,Emp_ID,.. then you can use this query to get last inserted record

SELECT * FROM table_name where UserID=(select MAX(UserID)from table_name)

In PHP code:Then you can use fetched data as your requirement

How do you set up use HttpOnly cookies in PHP

Scott Warren

[How do you set up use HttpOnly cookies in PHP](https://stackoverflow.com/questions/36877/how-do-you-set-up-use-httponly-cookies-in-php)

How can I set the cookies in my PHP apps as HttpOnly cookies?

2008-08-31 14:27:50Z

How can I set the cookies in my PHP apps as HttpOnly cookies?The setcookie() and setrawcookie() functions, introduced the httponly parameter, back in the dark ages of PHP 5.2.0, making this nice and easy. Simply set the 7th parameter to true, as per the syntaxFunction syntax simplified for brevityEnter NULL for parameters you wish to remain as default.

You may also want to consider if you should be setting the secure parameter.It is also possible using the older, lower-level header() function:For PHP's own session cookies on Apache:

add this to your Apache configuration or .htaccessThis can also be set within a script, as long as it is called before session_start().Be aware that HttpOnly doesn't stop cross-site scripting; instead, it neutralizes one possible attack, and currently does that only on IE (FireFox exposes HttpOnly cookies in XmlHttpRequest, and Safari doesn't honor it at all). By all means, turn HttpOnly on, but don't drop even an hour of output filtering and fuzz testing in trade for it.Note that PHP session cookies don't use httponly by default.To do that:A couple of items of note here:SourceExplanation here from Ilia... 5.2 only thoughhttpOnly cookie flag support in PHP 5.2As stated in that article, you can set the header yourself in previous versions of PHPYou can specify it in the set cookie function see the php manualYou can use this in a header file.This way all future session cookies will use httponly.The right syntax of the php_flag command isAnd be aware, just first answer from server set the cookie and here (for example You can see the "HttpOnly" directive. So for testing delete cookies from browser after every testing request.

How can I send JSON response in symfony2 controller

Mirage

[How can I send JSON response in symfony2 controller](https://stackoverflow.com/questions/11714941/how-can-i-send-json-response-in-symfony2-controller)

I am using jQuery to edit my form which is built in Symfony.I am showing the form in jQuery dialog and then submitting it.Data is entering correctly in database.But I don't know whether I need to send some JSON back to jQuery. Actually I am bit confused with JSON thing.Suppose I have added a row in my table with ``jQuery and when I submit the form then after data is submitted I want to send back those row data so that I can dynamically add the table row to show the data added.I am confused how can get that data back.This is my current code:This is just the template with success message.

2012-07-30 03:03:19Z

I am using jQuery to edit my form which is built in Symfony.I am showing the form in jQuery dialog and then submitting it.Data is entering correctly in database.But I don't know whether I need to send some JSON back to jQuery. Actually I am bit confused with JSON thing.Suppose I have added a row in my table with ``jQuery and when I submit the form then after data is submitted I want to send back those row data so that I can dynamically add the table row to show the data added.I am confused how can get that data back.This is my current code:This is just the template with success message.Symfony 2.1Symfony 2.2 and higherYou have special JsonResponse class, which serialises array to JSON:But if your problem is How to serialize entity then you should have a look at JMSSerializerBundleAssuming that you have it installed, you'll have simply to doYou should also check for similar problems on StackOverflow:  Symfony 2.1 has a JsonResponse class.The passed in array will be JSON encoded the status code will default to 200 and the content type will be set to application/json.There is also a handy setCallback function for JSONP.Since Symfony 3.1 you can use JSON Helper

http://symfony.com/doc/current/book/controller.html#json-helperTo complete @thecatontheflat answer I would recommend to also wrap your action inside of a try … catch block. This will prevent your JSON endpoint from breaking on exceptions. Here's the skeleton I use:This way your endpoint will behave consistently even in case of errors and you will be able to treat them right on a client side.If your data is already serialized:a) send a JSON responseb) send a JSONP response (with callback)If your data needs be serialized:c) send a JSON responsed) send a JSONP response (with callback)e) use groups in Symfony 3.x.xCreate groups inside your EntitiesNormalize your Doctrine Object inside the logic of your application

Date minus 1 year?

ajsie

[Date minus 1 year?](https://stackoverflow.com/questions/1990321/date-minus-1-year)

I've got a date in this format:How do I return the same date but 1 year earlier?

2010-01-02 01:43:59Z

I've got a date in this format:How do I return the same date but 1 year earlier?You can use strtotime:The strtotime function returns a unix timestamp, to get a formatted string you can use date:Use strtotime() function:Using the DateTime object...Or using now for todayan easiest way which i used and worked wellthis worked perfect.. hope this will help someone else too.. :) On my website, to check if registering people is 18 years old, I simply used the following :After, only compare the the two dates.Hope it could help someone.Although there are many acceptable answers in response to this question, I don't see any examples of the sub method using the \Datetime object: https://www.php.net/manual/en/datetime.sub.phpSo, for reference, you can also use a \DateInterval to modify a \Datetime object:Which returns:For more information about \DateInterval, refer to the documentation: https://www.php.net/manual/en/class.dateinterval.phpYou can use the following function to subtract 1 or any years from a date.  And looking at above examples you can also use the following

Convert seconds into days, hours, minutes and seconds

Florian

[Convert seconds into days, hours, minutes and seconds](https://stackoverflow.com/questions/8273804/convert-seconds-into-days-hours-minutes-and-seconds)

