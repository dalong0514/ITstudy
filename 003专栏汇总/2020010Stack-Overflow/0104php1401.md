    321If k=5, return 312. 

In other words, it gives the kth lexicographical permutation.It is calculable. This is a C# code that does it for you.If you store all the permutations in memory, for example in an array, you should be able to bring them back out one at a time in O(1) time.This does mean you have to store all the permutations, so if computing all permutations takes a prohibitively long time, or storing them takes a prohibitively large space then this may not be a solution.My suggestion would be to try it anyway, and come back if it is too big/slow - there's no point looking for a "clever" solution if a naive one will do the job.

Why is「Expires」1981?

footy

[Why is「Expires」1981?](https://stackoverflow.com/questions/8194481/why-is-expires-1981)

My CRON Job returned an error that CRON job did not work. In that this was there:I am wondering why is Expires set to "1981". What is the significance?

2011-11-19 13:52:37Z

My CRON Job returned an error that CRON job did not work. In that this was there:I am wondering why is Expires set to "1981". What is the significance?It's an attempt to disable caching.The date is the birthday of the developer Sascha Schumann who added the code.From session.c:HTTP Expires headerhttp://www.w3.org/Protocols/rfc2616/rfc2616-sec13.htmlIt is set to negative or past value, to prevent caching of response.Quite common usage of this header.I think you are using session_cache_limiter before calling session_start. If argument is private or no-cache the result is setting the Expires header to the time you have mentioned. Refer to this document for more information.Somebody just put expires = date('-30 years') (paraphrased) in his code to make really sure the content is set as expired and not cached.

Checking if your code is running on 64-bit PHP

binarycleric

[Checking if your code is running on 64-bit PHP](https://stackoverflow.com/questions/5423848/checking-if-your-code-is-running-on-64-bit-php)

Does anyone know of a way of checking within PHP if the script is running as either 32-bit or 64-bit?  Currently I'm using PHP 5.3.5.Ideally I'd like to write a function so my code can look like this:Anyone have any thoughts?

2011-03-24 18:37:36Z

Does anyone know of a way of checking within PHP if the script is running as either 32-bit or 64-bit?  Currently I'm using PHP 5.3.5.Ideally I'd like to write a function so my code can look like this:Anyone have any thoughts?Check the PHP_INT_SIZE constant. It'll vary based on the size of the register (i.e. 32-bit vs 64-bit).In 32-bit systems PHP_INT_SIZE should be 4, for 64-bit it should be 8.See http://php.net/manual/language.types.integer.php for more details.   You could write a function like this:Then you could use the sample code you posted:A short way to get the number of bits.How this works:The bitwise complement operator, the tilde, ~, flips every bit.@see http://php.net/manual/en/language.operators.bitwise.phpUsing this on 0 switches on every bit for an integer. This gives you the largest number that your PHP install can handle.Then using decbin() will give you a string representation of this number in its binary form@see http://php.net/manual/en/function.decbin.phpand strlen will give you the count of bits.Here is it in a usable functionHere is an example that can be used from consoleFor Windows:For LinuxOutput example:I just looked around and didn't find anything too promising. There's a good chance that you can use $_SERVER['SERVER_SOFTWARE'] to tell (check out what it prints on your system), but making this portable and always accurate is probably not doable.

How can I see how many MySQL connections are open?

Sahal

[How can I see how many MySQL connections are open?](https://stackoverflow.com/questions/6502036/how-can-i-see-how-many-mysql-connections-are-open)

How can I see how many connections have been opened during the current request via mysql_connect in PHP running on Apache?I know that if I call mysql_connect function 100 times with the same parameters, it will always return the same connection link. It will not start new connection once the connection already exists.But I just want to make sure mysql_connect is not starting a new one.I am working with a legacy system which contains many mysql_connect function calls.Is there any setting in Apache or is there any way I can log this number of connections in Apache or MySQL log file?

2011-06-28 05:38:24Z

How can I see how many connections have been opened during the current request via mysql_connect in PHP running on Apache?I know that if I call mysql_connect function 100 times with the same parameters, it will always return the same connection link. It will not start new connection once the connection already exists.But I just want to make sure mysql_connect is not starting a new one.I am working with a legacy system which contains many mysql_connect function calls.Is there any setting in Apache or is there any way I can log this number of connections in Apache or MySQL log file?I think there are a couple of ways:or you can do a SHOW PROCESSLIST and find out unique values in the Id column. In old PHP API mysql, there is mysql_list_processes function that does the same as SHOW PROCESSLIST, too.But first one should work for you. And perhaps you might like to check on other STATUS variablesThere are other useful variables regarding connections and in your particular case variable Connections might help find out if your code is making too many connections. Just check it value before and after running code.Current connections status:Look at Threads: count. More detailed information about current connections can be obtained with the commands:FYI mysqladmin -v -uroot -ppass processlist is analog of show full processlist.Commands can be shortened to any unique prefix, and called simultaneously:You could use the MySQL command show processlist to get the number of connections.I dont think you can see the number of connection, but can limit the connections to the mysql server.

How to format an UTC date to use the Z (Zulu) zone designator in php?

sallaigy

[How to format an UTC date to use the Z (Zulu) zone designator in php?](https://stackoverflow.com/questions/17390784/how-to-format-an-utc-date-to-use-the-z-zulu-zone-designator-in-php)

I need to display and handle UTC dates in the following format:As this format is part of the ISO8601 standard I have no trouble creating DateTime objects from strings like the one above. However I can't find a clean way (meaning no string manipulations like substr and replace, etc.) to present my DateTime object in the desired format. I tried to tweak the server and php datetime settings, with little success. I always get:Is there any date format or configuration setting that will give me the desired string? Or I'll have to append the 'Z' manually to a custom time format?

2013-06-30 13:22:05Z

I need to display and handle UTC dates in the following format:As this format is part of the ISO8601 standard I have no trouble creating DateTime objects from strings like the one above. However I can't find a clean way (meaning no string manipulations like substr and replace, etc.) to present my DateTime object in the desired format. I tried to tweak the server and php datetime settings, with little success. I always get:Is there any date format or configuration setting that will give me the desired string? Or I'll have to append the 'Z' manually to a custom time format?No, there is no special constant for the desired format. I would use:But you will have to make sure that the times you are using are really UTC to avoid interpretation errors in your application.In order to get the UTC date in the desired format, you can use something like this:To do this with the object-oriented style date object you need to first set the timezone to UTC, and then output the date:If you are using Carbon then the method is:

Where to find composer's global packages?

Peter

[Where to find composer's global packages?](https://stackoverflow.com/questions/30664220/where-to-find-composers-global-packages)

For a plugin for Sublime Text I was required to install a composer package globally.In order to do this I had to run the following command:The installation started running and a few seconds later the package was installed. Voila! Well, not really.Step two was to add some lines to my Sublime Text configuration file:However, the plugin is not working. So I decided to check the path. And it appears there is no .composer directory in my profile directory. It isn't in my php directory either. And I can't find it anywhere.I would like to know if there's a way to locate this directory and would appreciate any suggestions that can help me get this plugin to work.

2015-06-05 10:26:21Z

For a plugin for Sublime Text I was required to install a composer package globally.In order to do this I had to run the following command:The installation started running and a few seconds later the package was installed. Voila! Well, not really.Step two was to add some lines to my Sublime Text configuration file:However, the plugin is not working. So I decided to check the path. And it appears there is no .composer directory in my profile directory. It isn't in my php directory either. And I can't find it anywhere.I would like to know if there's a way to locate this directory and would appreciate any suggestions that can help me get this plugin to work.You can query Composer to find where it has set the user $COMPOSER_HOME directory.The '[home]' line refers to the default value of $COMPOSER_HOME.Just as a final confirmation - the 'yourname' part in the configuration, would very likely need to be updated with your own Windows username - composer config will say where it put the files.You may find in ~/.config/composer/vendor/binOn Windows, mine was /Users/taylor/AppData/Roaming/Composer/binRun the commandYou can find the find the [home] with composer path, similar to this one.

How to access URL segment(s) in blade in Laravel 5?

cyber8200

[How to access URL segment(s) in blade in Laravel 5?](https://stackoverflow.com/questions/31832819/how-to-access-url-segments-in-blade-in-laravel-5)

I have a url : http://localhost:8888/projects/oop/2I want to access the first segment --> projectsI've tried <?php echo $segment1 =  Request::segment(1);  ?>I see nothing print out in my view when I refresh my page.Any helps / suggestions will be much appreciated 

2015-08-05 12:39:33Z

I have a url : http://localhost:8888/projects/oop/2I want to access the first segment --> projectsI've tried <?php echo $segment1 =  Request::segment(1);  ?>I see nothing print out in my view when I refresh my page.Any helps / suggestions will be much appreciated Try thisThe double curly brackets are processed via Blade -- not just plain PHP. This syntax basically echos the calculated value.BASED ON LARAVEL 5.7 & ABOVETo get all segments of current URL:$current_uri = request()->segments();To get segment posts from http://example.com/users/posts/latest/NOTE: Segments are an array that starts at index 0. The first element of array starts after the TLD part of the url. So in the above url, segment(0) will be users and segment(1) will be posts.You may have noted that the segment method only works with the current URL ( url()->current() ). So I designed a method to work with previous URL too by cloning the segment() method:Here is how one can do it via the global request helper function.{{ request()->segment(1) }}Note: request() returns the object of the Request class.Here is code you can get  url segment.If you don't want the data to be escaped then use {!! !!} else use {{ }}.https://laravel.com/docs/4.2/requests

Convert boolean to integer value php

user2990361

[Convert boolean to integer value php](https://stackoverflow.com/questions/20074332/convert-boolean-to-integer-value-php)

Is there any builtin function for PHP that will take a boolean value and return its integer equivalent? 0 for FALSE, 1 for TRUE?

Of course you can easily create a function to do so, I'm just asking if there is a builtin function inside of PHP. I already tried intval() and casting it to (int) but they didnt work, they return 0 in both cases of TRUE and FALSE.Edit : the problem was that it wasnt really a boolean, it was a string "false", "true", php didnt detect the jquery post that it passed a boolean. problem solved, thanks !

2013-11-19 14:35:37Z

Is there any builtin function for PHP that will take a boolean value and return its integer equivalent? 0 for FALSE, 1 for TRUE?

Of course you can easily create a function to do so, I'm just asking if there is a builtin function inside of PHP. I already tried intval() and casting it to (int) but they didnt work, they return 0 in both cases of TRUE and FALSE.Edit : the problem was that it wasnt really a boolean, it was a string "false", "true", php didnt detect the jquery post that it passed a boolean. problem solved, thanks !http://www.php.net/manual/en/language.types.integer.phpNormally, simply $myInt = (int)$myBoolean should work, can you show us your code otherwise ?Just add a "+" before your variable like this :If you are unsure of the data type see the example below, it works on strings, integers and booleans.filter_var( $var, FILTER_VALIDATE_BOOLEAN ) will return bool(true) or bool(false) then simply cast as integer.filter_var()(PHP 5 >= 5.2.0, PHP 7)filter_var — Filters a variable with a specified filterIf you are getting your value in from JSON I.E. Via an AJAX POST, the value will come in as a string (As you have found). A way around this is to compare the true/false string and then cast the bool to an int You can do multiple castings in a single go:Use type casting (bool):

Why can I not use $this as a lexical variable in PHP 5.5.4?

tjbp

[Why can I not use $this as a lexical variable in PHP 5.5.4?](https://stackoverflow.com/questions/19431440/why-can-i-not-use-this-as-a-lexical-variable-in-php-5-5-4)

The following code (similar to example at https://bugs.php.net/bug.php?id=49543):fails with:Yet according to the PHP docs and a comment on that bug report from Rasmus Lerdorf, using $this in anonymous functions was added as of PHP 5.4. What am I doing wrong?

2013-10-17 15:50:25Z

The following code (similar to example at https://bugs.php.net/bug.php?id=49543):fails with:Yet according to the PHP docs and a comment on that bug report from Rasmus Lerdorf, using $this in anonymous functions was added as of PHP 5.4. What am I doing wrong?So it seems $this can be used simply if it isn't specified via the "use" keyword.The following echoes 'bar':This was reported in the php-internals mailing list and is apparently overhang from 5.3's lack of support for this functionality:http://marc.info/?l=php-internals&m=132592886711725In PHP 5.3 if you are using a Closure inside of a class, the Closure will not have access to $this.In PHP 5.4, support has been added for the usage of $this in Closures.I don't know the answer to your actual question (ie Why can't you do it), but I can give you a work around: Use a temporary copy of $this and use() that instead:I've just tested it, and this does work.The issue is that including $this in the use() statement is not allowed.However if you don't include it then it will work fine. So the issue isn't whether the use statement is present, it's whether $this is present in the use statement.This should work (@see https://3v4l.org/smvPt):This shouldn't:I suppose essentially $this is implicitly captured.It may be a bug, but there is no sense in explicit binding $this to a function anyway as it is automatically bound: PHP documentation saysThus, fatal error is thrown in today's version of PHP:I know, this is an old question, but maybe someone from google find this:The reason why you get the error is, because you can't use an already defined variable name as lexical variable in the same closure. Since in PHP 5.5 and above you can access $this inside the closure, a variable with the name $this already exists.Here is another example, where you would get the same error:As you can see, the $item is already used as closure parameter, so you can't us it lexical variable.You can use this: I'm using PHP 5.4.25 and actually I am able to use class variables in a closure also with the use keyword as shown below:Output:

PHP setcookie「SameSite=Strict」?

Lauro Moraes

[PHP setcookie「SameSite=Strict」?](https://stackoverflow.com/questions/39750906/php-setcookie-samesite-strict)

I recently read "RFC 6265" on the attribute "Same Site", I looked at some articles that talked about that in April 2016, "same-site" attribute has been implemented for Chrome 51 and Opera 39 ...I wonder if current PHP supports creating cookies with this attribute?Reference: 

2016-09-28 14:48:15Z

I recently read "RFC 6265" on the attribute "Same Site", I looked at some articles that talked about that in April 2016, "same-site" attribute has been implemented for Chrome 51 and Opera 39 ...I wonder if current PHP supports creating cookies with this attribute?Reference: [Important update: As @caw pointed out below, this hack WILL BREAK in PHP 7.3. Stop using it now to save yourself from unpleasant surprises! Or at least wrap it in a PHP version check like if (PHP_VERSION_ID < 70300) { ... } else { ... }.]It seems like you can abuse the "path" or "domain" parameter of PHP's "setcookie" function to sneak in the SameSite attribute because PHP does not escape semicolons:Then PHP sends the following HTTP header:I've just discovered this a few minutes ago, so please do your own testing! I'm using PHP 7.1.11.You will have $samesite parameter in setcookie functionSee more here - PHP RFC: Same Site CookieYou can use one of the following solutions/workarounds depending on your codebase/needsYou can add the following line to your Apache configurationand this will update all your cookies with SameSite=Lax flagSee more here: https://blog.giantgeek.com/?p=1872Same here, this also will update all your cookies with SameSite=Lax flagSee more here: https://serverfault.com/questions/849888/add-samesite-to-cookies-using-nginx-as-reverse-proxyAs we know cookies are just a header in HTTP request with the following structureso we can just set the cookies with header methodIn fact, Symfony is not waiting for PHP 7.3 and already doing it under the hood, see here 📝You can use same in Laravel too because Laravel under the hood using Symfony's Symfony\Component\HttpFoundation\Cookie classBe careful with this one, it's a known bug in PHP setcookie method and already resolved in PHP7.3 version, see here - https://github.com/php/php-src/commit/5cb825df7251aeb28b297f071c35b227a3949f01Based on Steffen's answer above, this is the method I am using to support both php <= 7.2 and php >= 7.3: According to this site, it seems it is a matter of PHP 7.3. As of the voting results, a more general extension to cookie-related functions is being implemented + there might be also a new key in php.ini file.But as Marc B already wrote, you can use header() function call instead, I would do it in some file with used for inclusion of other initial stuff.

Generating SSH keys for 'apache' user

Kit

[Generating SSH keys for 'apache' user](https://stackoverflow.com/questions/7306990/generating-ssh-keys-for-apache-user)

How do I add SSH keys for 'apache' user in Linux? BACKGROUND I am trying to add a service hook to github to notify a URL once I push to my repo. I have the following php page set up:However I get the following output:This is because the keys I generated for github access were generated by my 'root' user. However when I exectue a command from php it is the 'apache' user that runs it.The keys therefore do not correspond and permission is denied to pull.As I cannot switch user from the terminal to generate keys as 'apache', I am not too sure what to do. Can anyone suggest a solution?

2011-09-05 10:52:04Z

How do I add SSH keys for 'apache' user in Linux? BACKGROUND I am trying to add a service hook to github to notify a URL once I push to my repo. I have the following php page set up:However I get the following output:This is because the keys I generated for github access were generated by my 'root' user. However when I exectue a command from php it is the 'apache' user that runs it.The keys therefore do not correspond and permission is denied to pull.As I cannot switch user from the terminal to generate keys as 'apache', I am not too sure what to do. Can anyone suggest a solution?As you are root, you can try it sudo -u apache ssh-keygen -t rsaYou may have to copy the root generated keys in the .ssh directory of your apache user.Assuming the homedir of apache is /var/www (check /etc/passwd) and the named key is id_rsa-git :No need to copy the public key.Note : by default the key used are id_rsa or id_dsa. You may change the name of the copied key to match this.You may also change ownership of the id_rsa key and .ssh directory: Just posting the comment of @KitCarrau, under yvan's answer, that worked for mesudo -u apache ssh-keygen -t rsafor debian sudo -u www-data ssh-keygen -t rsaafter this click Enter twice, to skip passphrasealso, it suggests to create the public/private keys in /var/www/.ssh directory, even if I had my www direcotry in /home/my_user/www, that is fine.The existing answers are either incomplete or insecure. If you put your .ssh directory into the home directory of the apache user (/var/www) then this will also most likely serve the contents of that directory and thus expose your ssh private key to the public web. To prevent this you'd have to configure apache not to serve the .ssh directory but none of the existing answers explains how to do this.I'd also argue that it is still dangerous to have your .ssh directory be a subdirectory of your publicly served www-root because even if you add a rule to your apache config, upgrading the server or doing unrelated other configurations might override this rule without you noticing.So here is an answer that puts the key elsewhere, where it is not served by apache by default. There is not even the need to ever become the www-data user as others are struggling with.First, find out the home directory of our apache user, for example by looking into /etc/passwd and looking for the www-data user or however the apache user of your distribution is called. The home directory is likely /var/www.Then run (replacing /var/www with the home directory of the apache user on your setup):Now your www-data user will use the ssh key in $HOME/www-data.ssh/id_rsa for all its ssh connections and since your $HOME is probably different from /var/www, that directory will not be served. So even without adding any custom rules to apache, users will be able to see your .ssh/config but they will not be able to access the private key it points to. Nevertheless, your www-data user will know how to do it.I ran into a similar issue and there is one extra snag.  In order to ssh using the apache user you also need to edit the /etc/passwd file so that the directive for apache has a shell defined.In my case I needed to changeto To add to @Vincent, if you have SELinux enabled, you'll have to set the context for the new .ssh folder.On RHEL, add the following to this file: /etc/selinux/targeted/contexts/files/file_contexts.homedirs And then run the commandI don't know if this will work on redhat (I assume that is what you're running) however, I was able to su to www-data (the apache user for debian) by executing the following:it actually worked shrugs go figure

PHP PDO prepared statement — MySQL LIKE query

TIm

[PHP PDO prepared statement — MySQL LIKE query](https://stackoverflow.com/questions/1786436/php-pdo-prepared-statement-mysql-like-query)

I am trying to do a search through php's PDO class (mysql driver). I have the following query working with the MySQL client (table names changed to protect the innocent):This works like a charm regardless of the search term that I use.  However, when I move to php, I can't get it to return anything.  I have tried several different syntaxes that seem logical to work, but nothing I have tried works.  here's my existing code:I've tried the following as well (SQL WHERE clause & prep->execute lines are all that change):etc...

2009-11-23 22:15:33Z

I am trying to do a search through php's PDO class (mysql driver). I have the following query working with the MySQL client (table names changed to protect the innocent):This works like a charm regardless of the search term that I use.  However, when I move to php, I can't get it to return anything.  I have tried several different syntaxes that seem logical to work, but nothing I have tried works.  here's my existing code:I've tried the following as well (SQL WHERE clause & prep->execute lines are all that change):etc...This is wrong. You don't need the double quotes.This is also wrong.

Try with:Explanation: Prepared statements don't simply do a string-replace. They transport the data completely separate from the query. Quotes are only needed when embedding values into a query.Well, I solved this one.  And quite frankly, I'm an idiot...  Thank you all for seeing this and giving good feedback.  The problem was a typo in a table name (which I changed, so nobody here would be able to see my issue to begin with...).  The suggestions did lead me to find the issue, though, so thank you adam, jkndrkn and troelskn.For the record, the following combination works well:

What is the PDO equivalent of function mysql_real_escape_string?

REJOLA

[What is the PDO equivalent of function mysql_real_escape_string?](https://stackoverflow.com/questions/14012642/what-is-the-pdo-equivalent-of-function-mysql-real-escape-string)

I am modifying my code from using mysql_* to PDO. In my code I had mysql_real_escape_string(). What is the equivalent of this in PDO?

2012-12-23 16:32:03Z

I am modifying my code from using mysql_* to PDO. In my code I had mysql_real_escape_string(). What is the equivalent of this in PDO?Well No, there is none!Technically there is PDO::quote() but it is rarely ever used and is not the equivalent of mysql_real_escape_string()That's right! If you are already using PDO the proper way as documented using prepared statements, then it will protect you from MySQL injection. Below is an example of a safe database query using prepared statements (pdo)   And, now assuming the connection is established, you can execute your query like this. Now, as you can probably tell, I haven't used anything to escape/sanitize the value of $_POST["color"]. And this code is secure from myql-injection thanks to  PDO and the power of prepared statements.  It is worth noting that you should pass a charset=utf8 as attribute, in your DSN as seen above, for security reasons, and always enable 

PDO to show errors in the form of exceptions.so errors from you database queries won't reveal sensitive data like your directory structure, database username etc. Last but not least, there are moments when you should not trust PDO 100%, and will be bound to take some extra measures to prevent sql injection, one of those cases is, if you are using an outdated versions of mysql [ mysql =< 5.3.6 ] as described in this answerBut, using prepared statements as shown above will always be safer, than using any of the functions that start with mysql_Good readsThere is none*! The object of PDO is that you don’t have to escape anything; you just send it as data. For example:As opposed to:* Well, there is one, as Michael Berkowski said! But there are better ways.is the equivalent of $v = $this->db->quote($v);

be sure you have a PDO instance in $this->db so you can call the pdo method quote()There is no need of mysql_real_escape_string in PDO. PDO itself adjust special character in mysql query ,you only need to pass anonymous parameter and bind it run time.like this

Suppose you have user table with attribute name,email and password and you have to insert into this use prepare statement like this 

you can pass name as => $name="Rajes'h ";it should execute there is no need of equivalent of mysql_real_escape_stringIn response to a lot of people's comments on here, but I can't comment directly yet (not reached 50 points), there ARE ACTUALLY needs to use the $dbh->quote($value) EVEN when using PDO and they are perfectly justifiable reasons...So yes, there is a need for $dbh->quote($value) when using PDO and is probably WHY the command is available in the first place.PS, you still don't need to put quotes around the command, the $dbh->quote($value) command also does that for you.Out.If to answer the original question, then this is the PDO equivalent for mysql_real_escape_string:btw, the mysqli equivalent is:

Logging full stack trace with Monolog

Wild One

[Logging full stack trace with Monolog](https://stackoverflow.com/questions/20657309/logging-full-stack-trace-with-monolog)

I use Monolog as a stand-alone library in my application and recently I ran into an issue. Let's say, at some point in my application I catch an exception and I want to log it:This works perfectly except one tiny thing - it doesn't log whole stack trace. Is it possible to log exception's full stack trace using monolog build-in formatters?

2013-12-18 11:46:13Z

I use Monolog as a stand-alone library in my application and recently I ran into an issue. Let's say, at some point in my application I catch an exception and I want to log it:This works perfectly except one tiny thing - it doesn't log whole stack trace. Is it possible to log exception's full stack trace using monolog build-in formatters?Actually since version 1.12.0 it is possible to include stacktrace at your log file: there is new method of LineFormatter called includeStacktraces.To use this, you need to overwrite default behaviour of monolog formatter:config.ymlservices.ymlCheck github for more info:

Pull requestI have a very simple solution!!!No, You cannot log the stack trace using the built-in formatters.  See my question here.If you take a look at LineFormatter.php you see that the normalizeException method is responsible for grabbing the exception data. So, I had to create a new formatter that extended LineFormatter.  Here's the code:And I initialized my logger like so:This will will print out your stack trace.Adding to Tomasz Madeyski's answer, this is how you can use it via code only:You can simply use the config file (Symfony Bundle) with the "include_stacktraces" parameter:@see this commit@see the full schema (configuration)This is how I do it, yes years later...$mylogger->error('Exception caught', $exception->getTrace());since getTrace() returns an array, which is what Monolog wants.If you want to log stacktrace only when Exception is thrown, you can do this, in the AppServiceProvider:This will add the stacktrace to extra column, which then can be used per LineFormattergetTraceAsString will give you the Stack Trace array as a 'End of Line' delimited string.  Explode on PHP_EOL and then foreach through the array logging each element.  Hope this helps.Should produce something like this:The Upvoted answer works, but you are not forced to create a custom service for that.The monolog.formatter.line already exists on Symfony 3.4 full stack. You can simply add a method call on it thanks to the CompilerPassInterface:The monolog handler does not seems to receive the service by default, so you still have to specify it. Example:

Laravel Error: Method Illuminate\View\View::__toString() must not throw an exception

cbloss793

[Laravel Error: Method Illuminate\View\View::__toString() must not throw an exception](https://stackoverflow.com/questions/26534016/laravel-error-method-illuminate-view-view-tostring-must-not-throw-an-excep)

Have you seen this lovely error while working in Laravel? I have seen it and it's incredibly annoying. I have found out two reasons why this error gets thrown. I just want to help people not take hours and hours of time. View answers & situations below. :)

2014-10-23 17:37:29Z

Have you seen this lovely error while working in Laravel? I have seen it and it's incredibly annoying. I have found out two reasons why this error gets thrown. I just want to help people not take hours and hours of time. View answers & situations below. :)There is a very simple solution: don't cast View object to a string.Don't: echo View::make('..'); or echo view('..');Do: echo View::make('..')->render(); or echo view('..')->render();For PHP version <7.4 By casting view, it uses __toString() method automatically, which cannot throw an exception. If you call render() manually, exceptions are handled normally. This is the case if there is an error in the view - laravel throws an exception.It's fixed in PHP >=7.4 you should not encounter this issue: https://wiki.php.net/rfc/tostring_exceptions.For PHP version <7.4: This actually is a PHP limitation, not Laravels. Read more about this "feature" here: https://bugs.php.net/bug.php?id=53648Situation 1: 

Trying to print out a value in an array. Answer 1: 

Try printing out the array. Are you sure it's an array? I've gotten this error when it was an object instead of an array. Try doing a print_r and seeing what you get. Situation 2:

You have this associated array like this: When you try to access post_images array directly within a View, it throws an error. No. Matter. What. You. Do. Answer 2: 

Check in all the places where you are calling the View. What happened here is that I was trying to access the same view somewhere else in an area where I wasn't giving the post_images array. Took FOREVER to figure out. I hope this helps someone else. :) I just know the error I kept getting didn't help me anywhere. I encountered error like this when an object in my case $expression = new Expression(); is the same as the parameter variable submitExpression($intent, $bot_id, **$expression**){ check below code for more details.so I changed the above code to something likeand everything was working fine, hope you find this helpful.a similar error is:FatalErrorException in FooController.php line 0: Method App\Models\Foo::__toString() must not throw an exceptionand it was just a bad assignment: $foo.= new Foo;instead of: $foo = new Foo;

How to unit test PHP traits

Ali

[How to unit test PHP traits](https://stackoverflow.com/questions/31083192/how-to-unit-test-php-traits)

I want to know if there is a solution on how to unit-test a PHP trait.I know we can test a class which is using the trait, but I was wondering if there are better approaches.Thanks for any advice in advance :) EDITOne alternative is to use the Trait in the test class itself as I'm going to demonstrate bellow.But I'm not that keen on this approach since there is no guaranty there are no similar method names between the trait, the class and also the PHPUnit_Framework_TestCase (in this example):Here is an example trait:and its test:

2015-06-26 22:43:45Z

I want to know if there is a solution on how to unit-test a PHP trait.I know we can test a class which is using the trait, but I was wondering if there are better approaches.Thanks for any advice in advance :) EDITOne alternative is to use the Trait in the test class itself as I'm going to demonstrate bellow.But I'm not that keen on this approach since there is no guaranty there are no similar method names between the trait, the class and also the PHPUnit_Framework_TestCase (in this example):Here is an example trait:and its test:You can test a Trait using a similar to testing an Abstract Class' concrete methods.PHPUnit has a method getMockForTrait which will return an object that uses the trait.  Then you can test the traits functions.Here is the example from the documentation:

Truncate text containing HTML, ignoring tags

SamWM

[Truncate text containing HTML, ignoring tags](https://stackoverflow.com/questions/1193500/truncate-text-containing-html-ignoring-tags)

I want to truncate some text (loaded from a database or text file), but it contains HTML so as a result the tags are included and less text will be returned. This can then result in tags not being closed, or being partially closed (so Tidy may not work properly and there is still less content). How can I truncate based on the text (and probably stopping when you get to a table as that could cause more complex issues).Would result in:What I would want is:How can I do this?While my question is for how to do it in PHP, it would be good to know how to do it in C#... either should be OK as I think I would be able to port the method over (unless it is a built in method).Also note that I have included an HTML entity &acute; - which would have to be considered as a single character (rather than 7 characters as in this example).strip_tags is a fallback, but I would lose formatting and links and it would still have the problem with HTML entities.

2009-07-28 11:30:28Z

I want to truncate some text (loaded from a database or text file), but it contains HTML so as a result the tags are included and less text will be returned. This can then result in tags not being closed, or being partially closed (so Tidy may not work properly and there is still less content). How can I truncate based on the text (and probably stopping when you get to a table as that could cause more complex issues).Would result in:What I would want is:How can I do this?While my question is for how to do it in PHP, it would be good to know how to do it in C#... either should be OK as I think I would be able to port the method over (unless it is a built in method).Also note that I have included an HTML entity &acute; - which would have to be considered as a single character (rather than 7 characters as in this example).strip_tags is a fallback, but I would lose formatting and links and it would still have the problem with HTML entities.Assuming you are using valid XHTML, it's simple to parse the HTML and make sure tags are handled properly. You simply need to track which tags have been opened so far, and make sure to close them again "on your way out".Encoding note: The above code assumes the XHTML is UTF-8 encoded. ASCII-compatible single-byte encodings (such as Latin-1) are also supported, just pass false as the third argument. Other multibyte encodings are not supported, though you may hack in support by using mb_convert_encoding to convert to UTF-8 before calling the function, then converting back again in every print statement.(You should always be using UTF-8, though.)Edit: Updated to handle character entities and UTF-8. Fixed bug where the function would print one character too many, if that character was a character entity.I've written a function that truncates HTML just as yous suggest, but instead of printing it out it puts it just keeps it all in a string variable.  handles HTML Entities, as well.  100% accurate, but pretty difficult approach:Easy brute-force approach:The following is a simple state-machine parser which handles you test case successfully. I fails on nested tags though as it doesn't track the tags themselves. I also chokes on entities within HTML tags (e.g. in an href-attribute of an <a>-tag). So it cannot be considered a 100% solution to this problem but because it's easy to understand it could be the basis for a more advanced function.I used a nice function found at http://alanwhipple.com/2011/05/25/php-truncate-string-preserving-html-tags-words, apparently taken from CakePHPThe CakePHP framework has a HTML-aware truncate() function in the TextHelper that works for me.  See Core-Helpers/Text. MIT license.Could use DomDocument in this case with a nasty regex hack, worst that would happen is a warning, if there's a broken tag :Should give output : Hello, my <strong>**name**</strong>.I've made light changes to Søren Løvborg printTruncated function making it UTF-8 compatible:Bounce added multi-byte character support to Søren Løvborg's solution - I've added:All this at Pastie.Another light changes to Søren Løvborg printTruncated function making it UTF-8 (Needs mbstring) compatible and making it return string not print one. I think it's more useful.

And my code not use buffering like Bounce variant, just one more variable.UPD: to make it work properly with utf-8 chars in tag attributes you need mb_preg_match function, listed below.Great thanks to Søren Løvborg for that function, it's very good.you can use tidy as well:This is very difficult to do without using a validator and a parser, the reason being that imagine if you haveHow do you plan to truncate that and end up with valid HTML?After a brief search, I found this link which could help.Use the function truncateHTML() from: 

https://github.com/jlgrall/truncateHTMLExample: truncate after 9 characters including the ellipsis:Features: UTF-8, configurable ellipsis, include/exclude length of ellipsis, self-closing tags, collapsing spaces, invisible elements (<head>, <script>, <noscript>, <style>, <!-- comments -->), HTML $entities;, truncating at last whole word (with option to still truncate very long words), PHP 5.6 and 7.0+, 240+ unit tests, returns a string (doesn't use the output buffer), and well commented code.I wrote this function, because I really liked Søren Løvborg's function above (especially how he managed encodings), but I needed a bit more functionality and flexibility.

Check if {{ path() }} is current {{ path() }} in Symfony2

ed209

[Check if {{ path() }} is current {{ path() }} in Symfony2](https://stackoverflow.com/questions/8451740/check-if-path-is-current-path-in-symfony2)

How do I check if the current page is this path: I want to set a css class to the <a> element or possible remove it altogether, e.g.

2011-12-09 21:10:43Z

How do I check if the current page is this path: I want to set a css class to the <a> element or possible remove it altogether, e.g.app.request.get('_route') is probably what you are looking for:In case you want to use uri instead, you can use app.request.uri.

PHP: What does a & in front of a variable name mean?

funk-shun

[PHP: What does a & in front of a variable name mean?](https://stackoverflow.com/questions/3774130/php-what-does-a-in-front-of-a-variable-name-mean)

What does a & in front of a variable name mean?For example &$salary vs. $salary

2010-09-22 22:35:32Z

What does a & in front of a variable name mean?For example &$salary vs. $salaryIt passes a reference to the variable so when any variable assigned the reference is edited, the original variable is changed. They are really useful when making functions which update an existing variable. Instead of hard coding which variable is updated, you can simply pass a reference to the function instead.ExampleIt's a reference, much like in other languages such as C++.  There's a section in the documentation about it.It is used to pass an object by reference.See this entry in the PHP documentation.

Get currency symbol in PHP

umpirsky

[Get currency symbol in PHP](https://stackoverflow.com/questions/13897516/get-currency-symbol-in-php)

Let's start with simple piece of code to format money with NumberFormatter:This prints: ¥123,456,789.This is ok if you want to format money.But what I want to do is to get currency symbol (e.g. ¥) for given currency ISO 4217 code (e.g. JPY).My first guess was to try using:But that gives currency symbol for locale given in constructor (en_US), $ in my case.Is there a way to get currency symbol by currency ISO 4217 code in PHP?

2012-12-16 00:35:24Z

Let's start with simple piece of code to format money with NumberFormatter:This prints: ¥123,456,789.This is ok if you want to format money.But what I want to do is to get currency symbol (e.g. ¥) for given currency ISO 4217 code (e.g. JPY).My first guess was to try using:But that gives currency symbol for locale given in constructor (en_US), $ in my case.Is there a way to get currency symbol by currency ISO 4217 code in PHP?First of all, there is no international global currency symbol table, that anyone on the planet could read and understand.In each region/country the currency symbols will differ, that`s why you must determine them based on who is reading, using the browser / user locale.The correct way is as you guessed, using NumberFormatter::CURRENCY_SYMBOL, but you first have to set the appropriate locale like en-US@currency=JPY:This way the symbol will be understandable by the user.For example, $symbol will be:I achieved this using https://github.com/symfony/Intl:returnsIf you set the locale using this function setlocale("LC_ALL", "es_AR");

You can use localeconv()['currency_symbol'] or localeconv()['int_curr_symbol'] to get the locale currency symbol and the international variation of the currency symbol. Since the symbols can be multi-byte I used mb_*() functions to correctly grab the all non-punctuation and non-digit chars which would just leaves the symbol.Cryptic has a good answer, but there is a simpler way to do it:This is a nice simple inline solution that doesn't require declaring another function, however it also doesn't properly handle all cases - i.e. currencies where letters are part of the output. But for distinguishing between e.g. $ and £, it works fine.Will give you an associative array of 3 letter currency codes to their symbol.Can then use like this:Try this variant:

What's the difference between __construct() and init()

tom

[What's the difference between __construct() and init()](https://stackoverflow.com/questions/3747114/whats-the-difference-between-construct-and-init)

I was wondering what is the difference between __construct() and init() functions in a PHP application, more particularly in a Zend Framework application.

2010-09-19 19:19:30Z

I was wondering what is the difference between __construct() and init() functions in a PHP application, more particularly in a Zend Framework application.init() is called by the constructor.init() isn't defined in the specification of PHP, it's only a method available with the Zend Framework to help initialize without having to rewrite the constructor yourself.On the same topic :__construct is a php magic method. It always exists and is called on object creation. init() is just a reguar method usually used in ZF..

Why does WordPress still use addslashes(), register_globals() and magic_quotes?

Damien Pirsy

[Why does WordPress still use addslashes(), register_globals() and magic_quotes?](https://stackoverflow.com/questions/9404505/why-does-wordpress-still-use-addslashes-register-globals-and-magic-quotes)

In order to gain more experience in Wordpress I delved into its code base to study its inner working and its workflow, and I was quite astonished when I saw that:Now, from the year-long frequentation of SO I learned a lot of things, especially that the above three function are "deprecated" and show security issues, and are watched in horror by many.But WP must have a reason to use them. I'd like to know from more experienced programmers if there are really security issues, or if sometimes their usage is just too clouded in rumors and false convinctions. I know that magic_quotes is an heritage from the past, and the same could be said for addslashes (at least when used for databases), but while googling before asking this I found many websites talking about using addslashes() over mysql_real_escape_string(). I'm interested in knowing a clear, detailed reason on why those badly depicted functions are used; Wordpress had had many improvements over the years, addressing different aspects, and yet these functions are still used; I'm looking, therefore, to a concrete explanation over the positive aspects that somehow override the negative ones and justify the usage of those functions.I'm not looking for opinions (I perfectly know they're offtopic here), nor I am ranting about Wordpress, I hope this is clear. I'd just like to know why many php programmers consider these functions "bad", and yet a worldwide giant like Wordpress, who's at the 3rd version now, still uses them. Is this for compatibility with different servers and php versions? (they check very earl for those, though).Is there something I miss about this functions, how important they can be in an environment like wordpress (or in general)? I'm quite confused, to be honest.

2012-02-22 22:52:41Z

In order to gain more experience in Wordpress I delved into its code base to study its inner working and its workflow, and I was quite astonished when I saw that:Now, from the year-long frequentation of SO I learned a lot of things, especially that the above three function are "deprecated" and show security issues, and are watched in horror by many.But WP must have a reason to use them. I'd like to know from more experienced programmers if there are really security issues, or if sometimes their usage is just too clouded in rumors and false convinctions. I know that magic_quotes is an heritage from the past, and the same could be said for addslashes (at least when used for databases), but while googling before asking this I found many websites talking about using addslashes() over mysql_real_escape_string(). I'm interested in knowing a clear, detailed reason on why those badly depicted functions are used; Wordpress had had many improvements over the years, addressing different aspects, and yet these functions are still used; I'm looking, therefore, to a concrete explanation over the positive aspects that somehow override the negative ones and justify the usage of those functions.I'm not looking for opinions (I perfectly know they're offtopic here), nor I am ranting about Wordpress, I hope this is clear. I'd just like to know why many php programmers consider these functions "bad", and yet a worldwide giant like Wordpress, who's at the 3rd version now, still uses them. Is this for compatibility with different servers and php versions? (they check very earl for those, though).Is there something I miss about this functions, how important they can be in an environment like wordpress (or in general)? I'm quite confused, to be honest.

(Wordpress Open Tickets over Time)Don't rely on the Wordpress codebase to do assumptions about good practice or current standards in PHP coding. I'm saying this as someone who has fiddled with wordpress development over a longer period of time.Wordpress codebase is about 10 years old, it's full of legacy code[1]. The program can not evolve on the code-level much because of that, so you find a lot of workarounds for problems that are already solved nowadays much better.Just take this story: PHP had magic quotes. Wordpress developers thought it was useful. So for those hosts that did not have it configured, they added it. Ending up whith code that expects slashed input data often and at various places. The simple thing is, now they just can't change it to proper input processing and sanitization easily because of the usage of (super)globals introducing static global state nearly everywhere.You can not easily refactor such code.Same for the database class. It has a long history, originally based on an early version of ezSQL. At that time there was not mysql_real_escape_string and when it was introduced, the WP devs had the problem that not all installation bases support it.So don't wonder about the coding practice you find inside the Wordpress code. You'll learn how things could have been done years ago and with more or less outdated PHP versions. It's not that long ago that Wordpress switched to PHP 5 for example.This might not be your list of priorities (hopefully), projects differ here a lot. But having a legacy code-base alone is a burden regardless how project priorities are set. Wordpress is only one example.[1] see Milestones of WordPress: Early Project Timeline (ca. 2000 to 2005))In complement to @tom answer.Magic QuotesAutomatically parsing the whole entries and adding magic quotes is both creating bugs and useless. So Why?, why do we see such function in a CMS?register_globalsSeems that this is the way to implement a Registry pattern in wordpress... They wanted to make the code simple to understand, and to allow a simple way to access importants objects like the query or the post. And an object oriented Registry class was not in the simple PHP way, where the $_GLOBALS array is already an existing registry.Having a Registry is a perfectly valid thing in an application. a register_global thing is dangerous only if you allow some user input to override your valid secure input. And of course only if this secure input is taken from $_GLOBALS elsewhere (or with global keyword).The dangerous part in the function here is the part of the function you have extracted, the loop on $query->query_vars. You will have to track the calls to see if user injected keys could run throught wp_parse_args and end in that function. But the next part of this function is fixing $_GLOBALS content for several objects:So at least theses globals cannot be overwritten by user input and are safe.So, theses functions are bad. But you can use them if you understand what they do and what you need to do to prevent the bad effects. And when you want to implement a simple framework for developpers, available on a very wide environments you sometimes have to use them.But for sure it's a bad practice, you can certainly find bad wordpress plugins using $_GLOBALS in the wrong way or misusing the add_magic_quotes to data pulled from db wordpress concept. But there will be years before a Zend Framework CMS gained such a big number of contributions.Magic Quotesaddslashes() vs mysql_real_escape_string()The reason why you should use  mysql_real_escape_string() is because it's a "MySQL function" and is created especially for escaping user input before it's executed in a mysql query, while addslashes() is a "PHP function". That probably sounded a little weird, but there's one important difference between the two and it has to do with the use of single- and multi-byte characters. You can still inject databases protected by the addslashes function, but injecting databases protected by mysql_real_escape_string is far more difficult. You can read more about it HERERegister GlobalsThe reason why you should NOT use register_globals is because variables become accessible to everyone, which means that in the following example you would be able to set $access to true if it hasn't been initialized beforeThe above code would give you sh#! loads of problems, but if we initialize the variable first by adding the following to the top of the page...we should be fine even if we have register_globals ONSo, if the Wordpress team have initialized all variables (which they probably have) then you don't have to worry about the use of globals.ConclusionIt's definitely bad practice using any of those 3 functions/features and I would never do it myself. Are you sure you're working with the latest version of Wordpress? Like someone commented, if you are using the latest version it's because of laziness or worse it's still in there. I'ld never use Wordpress for anything other than blogs that doesn't require much security..Wordpress. I've spent a lot of sleepless nights trying to answer the only one question: "Why??" Since I've faced with its source code I hate it. It is awful. And let my post(and reputation as well) will be minused but it's true. It doesn't have core. There is a rubbish of code instead of core. It reminds php3. Huge heap of unrelated and unlogical functions are used in it. "Copy and Paste" - the only one design pattern is used in wordpress. Yes, the have emulated using of prepared statements. But why they don't use PDO, or mysqli? They have copypasted almost all PDO functions but haven't use it instead. Using of mysqli instead of mysql requires even less efforts.They use myql_real_escape_string. But there is still something like protect_string_strongly, protect_string_weakly. There is no only only one function - do_not_protect_string_i_believe_my_users.Global variables - is the philosophy of wordpress. "If we don't know how to change this var we'll mark it as global var and everybody will be happy." - here is what wordpress developers thought when they developed hellpress. Every new version contains a lot of new in design, they add new default themes, they change background color in admin area from #ccc to #cdcdcd, they use dropdown menu in admin area instead of accordeon. And it awesome. But they do not improve its code.Did you read comments in WP "core"? No? And I did. They are "awesome". Something like "What this function is called for? Let's it leave just in case." or "Do not hardcode this in new version." and so on.The only one answer to the question "Why?" I got is: "Because it works. And if it does work do not touch it!!!"wordpress.org is one most visited sites in the world. Why? Because nobody able to understand wordpress's logic. Everybody every time needs to ask something on the forum or read in the codex. I hope you understand my point of view.There is no better way to answer why they are bad than referring to the PHP documentation on magic_quotes:Also note:So why does Wordpress still use Magic Quotes? Wordpress minimum requirements uses PHP 4.3.  Yes, it is absolutely a backwards compatibility reason.  What about the other functions?I am honestly not sure.  Relying on super globals is a very bad idea.  This is simply laziness of the Wordpress development team.  Perhaps they have more important issues to work on. They did this for one reason:  To make sure Wordpress is compatible with most Web Hosting providers.This is wrong place to ask such a question.

It is always a bad idea to ask some third party person of the reasons someone else had somewhere else. It is obvious that you can't get an answer here unless you will lure some authorized wordpress developer here with such a bounty. Yet your question is too broad. However, it is possible to answer it's abstract part:Does hands washing really prevents a disease?

What if I won't wash my hands - will I surely sick?    Most of time - no.

As a general habit - yes.   These features (although indeed, as any other feature of our unlucky language,  too clouded in rumors) are merely a hygiene everyone have to follow as a basic instinct. Although most of time......any exception from these circumstances can make you sick with high probability.One of the main differences between mysql_real_escape_string() and addslashes is that mysql_real_escape_string() works in conjunction with the character set so it knows how to properly escape data based on the character set.Generally I think the best approach is to use a request class and do all your stuff there. 

That way there is only one place where you deal with GET,POST,COOKIE, SERVER etc which makes it far easier to manage in contrast to having a bunch of random functions doing different things. That's just a recipe for disaster.

Testing variable equality in twig

Sam

[Testing variable equality in twig](https://stackoverflow.com/questions/4303113/testing-variable-equality-in-twig)

In twig, is there an easy way to test the equality of 2 variables?{% if var1 = var2 %} isn't valid, {% if var1 is sameas(var2) %} only works if both are a strings...(from docs) "sameas checks if a variable points to the same memory address than another variable", like thats useful.So the only way I've found of comparing integers is to convert them both to strings:

{% if var1|lower is sameas(var2|lower) %}

2010-11-29 11:03:04Z

In twig, is there an easy way to test the equality of 2 variables?{% if var1 = var2 %} isn't valid, {% if var1 is sameas(var2) %} only works if both are a strings...(from docs) "sameas checks if a variable points to the same memory address than another variable", like thats useful.So the only way I've found of comparing integers is to convert them both to strings:

{% if var1|lower is sameas(var2|lower) %}As far as I'm aware Twig supports all of the standard logical operators ==, !=, <, >, >=, and <=. Also, your first example {% if var1 = var2 %} does not check for equality, it assigns var2 to var1, you might want to change it to the comparison operator ==.The Twig sameas built in test, is essentially a strict type comparison operator ===, hence why they both need to be strings in your example.If you are comparing value which have a numeric value you can use: 

Am I correctly supporting UTF-8 in my PHP apps?

Xeoncross

[Am I correctly supporting UTF-8 in my PHP apps?](https://stackoverflow.com/questions/1317152/am-i-correctly-supporting-utf-8-in-my-php-apps)

I would like to make sure that everything I know about UTF-8 is correct. I have been trying to use UTF-8 for a while now but I keep stumbling across more and more bugs and other weird things that make it seem almost impossible to have a 100% UTF-8 site. There is always a gotcha somewhere that I seem to miss. Perhaps someone here can correct my list or OK it so I don't miss anything important.Database Every site has to store there data somewhere. No matter what your PHP settings are you must also configure the DB. If you can't access the config files then make sure to "SET NAMES 'utf8'" as soon as you connect. Also, make sure to use utf8_ unicode_ ci on all of your tables. This assumes MySQL for a database, you will have to change for others.RegexI do a LOT of regex that is more complex than your average search-replace. I have to remember to use the "/u" modifier so that PCRE doesn't corrupt my strings. Yet, even then there are still problems apparently. String FunctionsAll of the default string functions (strlen(), strpos(), etc.) should be replaced with Multibyte String Functions that look at the character instead of the byte.Headers

You should make sure that your server is returning the correct header for the browser to know what charset you are trying to use (just like you must tell MySQL).It is also a good idea to put the correct < meta > tag in the page head. Though the actual header will override this should they differ.QuestionsDo I need to convert everything that I receive from the user agent (HTML form's & URI) to UTF-8 when the page loads or if I can just leave the strings/values as they are and still run them through these functions without a problem?If I do need to convert everything to UTF-8 - then what steps should I take? mb_detect_encoding seems to be built for this but I keep seeing people complain that it doesn't always work. mb_check_encoding also seems to have a problem telling a good UTF-8 string from a malformed one.Does PHP store strings in memory differently depending on what encoding it is using (like file types) or is it still stored like a regular sting with some of the chars being interpreted differently (like & amp; vs & in HTML). chazomaticus answers this question:If a give a non-UTF-8 string to a mb_* function will it ever cause a problem?If a UTF string is improperly encoded will something go wrong (like a parsing error in regex?) or will it just mark an entity as bad (html)? Is there ever a chance that improperly encoded strings will result in function returning FALSE because the string is bad?I have heard that you should mark you forms as UTF-8 also (accept-charset="UTF-8") but I am not sure what the benefit is..?Was UTF-16 written to address a limit in UTF-8? Like did UTF-8 run out of space for characters? (Y2(UTF)k?)FunctionsHere are are a couple of the custom PHP functions I have found but I haven't any way to verify that they actually work. Perhaps someone has an example which I can use. First is convertToUTF8() and then seems_utf8 from wordpress.If anyone is interested I found a great example page to use when testing UTf-8. 

2009-08-22 22:01:02Z

I would like to make sure that everything I know about UTF-8 is correct. I have been trying to use UTF-8 for a while now but I keep stumbling across more and more bugs and other weird things that make it seem almost impossible to have a 100% UTF-8 site. There is always a gotcha somewhere that I seem to miss. Perhaps someone here can correct my list or OK it so I don't miss anything important.Database Every site has to store there data somewhere. No matter what your PHP settings are you must also configure the DB. If you can't access the config files then make sure to "SET NAMES 'utf8'" as soon as you connect. Also, make sure to use utf8_ unicode_ ci on all of your tables. This assumes MySQL for a database, you will have to change for others.RegexI do a LOT of regex that is more complex than your average search-replace. I have to remember to use the "/u" modifier so that PCRE doesn't corrupt my strings. Yet, even then there are still problems apparently. String FunctionsAll of the default string functions (strlen(), strpos(), etc.) should be replaced with Multibyte String Functions that look at the character instead of the byte.Headers

You should make sure that your server is returning the correct header for the browser to know what charset you are trying to use (just like you must tell MySQL).It is also a good idea to put the correct < meta > tag in the page head. Though the actual header will override this should they differ.QuestionsDo I need to convert everything that I receive from the user agent (HTML form's & URI) to UTF-8 when the page loads or if I can just leave the strings/values as they are and still run them through these functions without a problem?If I do need to convert everything to UTF-8 - then what steps should I take? mb_detect_encoding seems to be built for this but I keep seeing people complain that it doesn't always work. mb_check_encoding also seems to have a problem telling a good UTF-8 string from a malformed one.Does PHP store strings in memory differently depending on what encoding it is using (like file types) or is it still stored like a regular sting with some of the chars being interpreted differently (like & amp; vs & in HTML). chazomaticus answers this question:If a give a non-UTF-8 string to a mb_* function will it ever cause a problem?If a UTF string is improperly encoded will something go wrong (like a parsing error in regex?) or will it just mark an entity as bad (html)? Is there ever a chance that improperly encoded strings will result in function returning FALSE because the string is bad?I have heard that you should mark you forms as UTF-8 also (accept-charset="UTF-8") but I am not sure what the benefit is..?Was UTF-16 written to address a limit in UTF-8? Like did UTF-8 run out of space for characters? (Y2(UTF)k?)FunctionsHere are are a couple of the custom PHP functions I have found but I haven't any way to verify that they actually work. Perhaps someone has an example which I can use. First is convertToUTF8() and then seems_utf8 from wordpress.If anyone is interested I found a great example page to use when testing UTf-8. No. The user agent should be submitting data in UTF-8 format; if not you are losing the benefit of Unicode.The way to ensure a user-agent submits in UTF-8 format is to serve the page containing the form it's submitting in UTF-8 encoding. Use the Content-Type header (and meta http-equiv too if you intend the form to be saved and work standalone).Don't. It was a nice idea in the HTML standard, but IE never got it right. It was supposed to state an exclusive list of allowable charsets, but IE treats it as a list of additional charsets to try, on a per-field basis. So if you have an ISO-8859-1 page and an「accept-charset="UTF-8"」form, IE will first try to encode a field as ISO-8859-1, and if there's a non-8859-1 character in there, then it'll resort to UTF-8.But since IE does not tell you whether it has used ISO-8859-1 or UTF-8, that's of absolutely no use to you. You would have to guess, for each field separately, which encoding was in use! Not useful. Omit the attribute and serve your pages as UTF-8; that's the best you can do at the moment.If you let such a sequence get through to the browser you could be in trouble. There are ‘overlong sequences’ which encode an low-numbered codepoint in a longer sequence of bytes than is necessary. This means if you are filtering ‘<’ by looking for that ASCII character in a sequence of bytes, you could miss one, and let a script element into what you thought was safe text.Overlong sequences were banned back in the early days of Unicode, but it took Microsoft a very long time to get their shit together: IE would interpret the byte sequence ‘\xC0\xBC’ as a ‘<’ up until IE6 Service Pack 1. Opera also got it wrong up to (about, I think) version 7. Luckily these older browsers are dying out, but it's still worth filtering overlong sequences in case those browsers are still about now (or new idiot browsers make the same mistake in future). You can do this, and fix other bad sequences, with a regex that allows only proper UTF-8 through, such as this one from W3.If you are using mb_ functions in PHP, you might be insulated from these issues. I can't say for sure as mb_* was unusable fragile when I was still writing PHP.In any case, this is also a good time to remove control characters, which are a large and generally unappreciated source of bugs. I would remove chars 9 and 13 from submitted string in addition to the others the W3 regex takes out; it is also worth removing plain newlines for strings you know aren't supposed to be multiline textboxes.No, UTF-16 is a two-byte-per-codepoint encoding that's used to make indexing Unicode strings easier in-memory (from the days when all of Unicode would fit in two bytes; systems like Windows and Java still do it that way). Unlike UTF-8 it is not compatible with ASCII, and is of little-to-no use on the Web. But you occasionally meet it in saved files, usually ones saved by Windows users who have been misled by Windows's description of UTF-16LE as「Unicode」in Save-As menus.This is very inefficient compared to the regex!You can actually sort of get away without this, treating MySQL as a store for nothing but bytes and only interpreting them as UTF-8 in your script. The advantage of using utf8_unicode_ci is that it will collate (sort and do case-insensitive compares) with knowledge about non-ASCII characters, so eg. ‘ŕ’ and ‘Ŕ’ are the same character. If you use a non-UTF8 collation you should stick to binary (case-sensitive) matching.Whichever you choose, do it consistently: use the same character set for your tables as you do for your connection. What you want to avoid is a lossy character set conversion between your scripts and the database.Most of what you are doing now should be correct.Some notes: any utf_* collation in MySQL would store your data correctly as UTF-8, the only difference between them is the collation (alphabetical order) applied when sorting.You can tell Apache and PHP to issue the correct charset headers setting AddDefaultCharset utf-8 in httpd.conf/.htaccess and default_charset = "utf-8" in php.ini respectively.You can tell the mbstring extension to take care of the string functions. This works for me:(this leaves the mail() function untouched - I found setting it to 7 played havoc with my mail headers)For charset conversion take a look at https://sourceforge.net/projects/phputf8/.PHP doesn't care at all about what's in the variable, it just stores and retrieves blindly its content.You'll have unexpected results if you declare one mbstring.internal_encoding and supply to a mb_* function strings in another encoding. You can anyway safely send ASCII to utf-8 functions.If you're worried about somebody posting incorrectly encoded stuff on purpose I believe you shoud consider HTML Purifier to filter GET/POST data before processing.Accept-charset has been in the specs since forever, but its real-world support in browsers is more or less zero. The browser will tipically use the encoding af the page containing the form.UTF-16 is not the big brother of UTF-8, it just serves a different purpose.database/mysql: If you're using SET NAMES and e.g. php/mysql you're leaving mysql_real_escape_string() in the dark about the change in character encoding. This may lead to wrong results. So, if you're relying on an escape function like mysql_real_escape_string (because you're not using prepared statements) SET NAMES is a suboptimal solution.

That's why mysql_set_charset() has been introduced or why gentoo applies a patch that adds the config parameter mysql.connect_charset for both php/mysql and php/mysqli.The client usually doesn't indicate the encoding of the parameters it sends. If you expect utf-8 encoded data and treat it as such there may be encoding errors (byte sequences that are invalid in utf-8). So the data may not display as expected or a parser may abort the parsing. But at least the user input cannot "escape" and do more harm e.g. in an inline sql statement or html output. E.g. take the script (saved as iso-8859-1 or utf-8, doesn't matter)printsE4F6FC is not a valid utf-8 byte sequence, therefore htmlspecialchars returns an empty string. Other functions may return ? or another "special" character. But at least they will not "mistake" a character as a malicious control character - as long as they all stick to the "proper" encoding (utf-8 in this case).  accept-charset doesn't guarantee that you will receive only data with that encoding. For all you know the client may not even has "used"/parsed your html document containing the form element. It may help and there's no reason why you shouldn't set that attribute. But it's not "dependable".UTF-8 is fine, and doesn't have any limits that UTF-16 solves. PHP doens't changes it's way to store strings in memory (unlike Python). If the entire data flow is using UTF-8 (web forms receive UTF-8 data, tables use utf8 encoding and you're using the SET NAMES utf8, and data is stored without being altered (no charset conversion), that should be fine.For user inputs from form I add this attribute to my forms tags : accept-charset="utf-8". This way data you receive should always be utf-8 encoded.

Trigger 500 Internal Server Error in PHP and display Apache error page

Vin

[Trigger 500 Internal Server Error in PHP and display Apache error page](https://stackoverflow.com/questions/8687390/trigger-500-internal-server-error-in-php-and-display-apache-error-page)

How can i trigger 500 Internal Server Error or 404 Page Not Found Apache errors in PHP?For 500 Internal Server Error i have tried following code :But it shows me a blank page.

How can i show the error in Apache's default format?Please guide..

2011-12-31 09:27:34Z

How can i trigger 500 Internal Server Error or 404 Page Not Found Apache errors in PHP?For 500 Internal Server Error i have tried following code :But it shows me a blank page.

How can i show the error in Apache's default format?Please guide..You could just copy the Apache error documents into your web root (or symlink them in) and use header() to set the error codes and with those documents as output. That's probably best unless you have a compelling reason not to. But in case that won't work for you, there are some alternatives (albeit, hacky alternatives).For 500, just put a bug in your code.The PHP script will raise an exception, resulting in a regular Apache 500 error page. (But be aware of the caveat that this will only result in an Apache error if the PHP init setting display_errors is set to 0. In most development configurations, this is not the case. In most production configurations, this is the case. If you don't know your production server's setting, you'll have to just test this to see if it works.)For 404, I think the best you can do is redirect to a non-existent page. It's not exactly the same thing, but might do for your purposes.In most browsers, the users won't actually see the redirect, they will just get silently and quickly redirected to a non-existent page, resulting in a regular Apache 404 error. Of course, the url will have changed and some users might notice that. If that's not acceptable, you can perhaps achieve similar results using Apache mod_rewrite to rewrite the url backend to a non-existent location.To respond to several comments: Setting the response code via header() (or some other way) will not result in the standard Apache error document. It will simply return that response code with your own output. This is intentional behavior, designed so that you can have custom error documents, or otherwise set response codes as the HTTP spec dictates on any request. If you want the Apache error documents, you have to either forge them (as per my initial suggestion of simply copying the error documents to your web root), or you'll have to trick Apache into returning them (as per my backup suggestion).After such a knowledge-full discussion, i think there is no php code can display the by default 500 Internal Server Error.

The solution is :

1. Create a folder named http500 next to the php file.

2. Create a .htaccess file in it and add following code :However, you will need output buffering ON to be able to use php header() function after you use any output function like echo.I'm probably quite late, but this solution should workThis will trigger a 500 ISE response, and show the default 500 error page, then stop the script. Obviously you will need to to modify the location  of the included fileyou simply cannot trigger apache error pages from php code without hackery redirection as proposed by ben lee because error document redirection is handled by another layer of your application's stack (specifically, apache's mod_core).

when your script runs, it's too late.the trickery of getting an error page by throwing an exception heavily depends on your php.ini's settings about error handling and verbosity.http_response_code()currently only exists in php's svn thus it's not available in most production environments which are supposed to run an official release version.my advice is to properly implement a custom error and exception handler via set_error_handler() and set_exception_handler(), respectively, use header() to send the client proper http status information and (if needed) generate error pages.I know this is an old thread however...You could render an iframe element into your view, and then set its height and width to 100% in the event of the error you are preparing to handle.  <?php

header("HTTP/1.0 500 Internal Server Error");

http_response_code(500);

?><iframe src="page_displaying_apache_screenshot_fullscreen.html"></iframe>THAT SAIDI truly think that the best modern solution for this would be something like: This would result in a proper error code for all users, and also a stack trace for dev if you set the $env variable to 'dev' on your dev stack.

No redirect, no hackery, secure unless you need to expose an error it won't. :)Apparently there is a function called http_response_code that will let you set the response code appropriately. If that doesn't work (there's a note in the documentation about it possibly being only in SVN) then the header function can take an optional response code argument:This should signal Apache correctly.On PHP 5.5 => "header("tester.php",true,500);" where tester.php does not exist. It works and takes me to my 500 page :)Unfortunately none of the other methods listed here worked for me for one reason or the other.I know this is an old thread, but when I searched on Google, it jumps out as the first answer. I was trying to figure out how to do it these days, so I think I should post my workaround from 2018.As you all have known, no, you cannot simply trigger Apache’s error pages from PHP. There’s no way doing it. So the best workaround I could find, after some research, is to use a PHP function to display the custom error pages, which is called from both what you specified in Apache, and the page that you want to trigger 500 Internal Server Error.Here is my conf of Apache:As you could see, all 4xx and 500 errors are redirected to a same php file. Why I’m not using separate files for each code is another question, which has nothing to do with your question here, so let’s forget it and focus on error.php for now.Here are some lines of error.php:In short, it receives HTTP status code from Apache via http_response_code(), and simply categorize the status code into two categories: Internal Server Error and Non-Internal Server Error. It then passes the category to ErrorPage::GenerateErrorPage() which actually generates contents of the error page.In ErrorPage::GenerateErrorPage(), I do something like this:at the beginning of the function, so that there won’t be any annoying「headers already sent」. This function will generate a fully functional error page with correct (or what we expected, at least) HTTP status code. After setting the HTTP status code, as you may guess, one of two prepared contents will be generated by following php codes, one for 500, another for 404.Now let’s go back to your question.You want to trigger exactly the same error page as Apache does, and now you can simply call the ErrorPage::GenerateErrorPage() from wherever you want, as long as you give it correct parameters (TRUE for 500, FALSE for 404 in my case).Obviously, because that the Apache error pages are generated by the same function ErrorPage::GenerateErrorPage(), we can guarantee that what you trigger wherever is exactly what you would expect from Apache error pages. Here is my example of a trigger page:The reason I use ob_start() and ob_clean() is that, in this way, I can clear anything output before the exception occurs, and send a pure 500 Internal Server Error page that looks exactly the same as Apache gives, without any content on the trigger page (phpInfo() in this case). ob_start() and ob_clean() also make sure that there won’t be「headers already sent」, because nothing will ever be sent unless you call ob_end_flush().The solution above is concluded from what I researched these days. It is so far so good for me, but I’m not sure if it is the correct way to do it. Any comments, questions, thoughts, suggestions and improvements are welcomed.

How to use Eloquent ORM without Laravel?

Andre Zimpel

[How to use Eloquent ORM without Laravel?](https://stackoverflow.com/questions/16633893/how-to-use-eloquent-orm-without-laravel)

Is it possible to use Eloquent without Laravel or does somebody knows a equally easy to use ORM?

2013-05-19 10:57:49Z

Is it possible to use Eloquent without Laravel or does somebody knows a equally easy to use ORM?Yes you can. A while ago Dan Horrigan released a package called Capsule for Laravel 4 which allowed Eloquent to be used independently and with minimal setup. The package itself has been merged with the L4 core so you no longer need to use the package.If you refer to the illuminate/database repository there is a nice little introduction on using Eloquent without the framework.Here is a small excerpt of getting it up and running.UpdateDan Horrigan has since removed his Capsule implementation as it is now built directly into Eloquent. Refer to the above illuminate/database link for more details on how to use Capsule.In Laravel 4.*, Eloquent is automatically independent because it's shipped with Dan Horrigan's Capsule. You don't need to download any extras. For a how to please visit: https://github.com/illuminate/database/blob/master/README.mdCheck out https://github.com/Luracast/Laravel-Database it provides full eloquent support including artisan migrations and more﻿ for the latest Laravel 5.2.* components.It uses capsule and lazy loads the components when they are used.Disclosure: I'm the author of this repository

What is /var/www/html? [closed]

Jason Sherman

[What is /var/www/html? [closed]](https://stackoverflow.com/questions/16197663/what-is-var-www-html)

I am starting to pick up PHP / MySQL, but in all the documentation I'm reading, it mentions /var/www/html as being the folder you want to install a framework such as CakePHP, or for example /var/www/html being the folder you want to install your website on, so that everything is in root.What exactly does /var/www/html mean?

2013-04-24 16:46:07Z

I am starting to pick up PHP / MySQL, but in all the documentation I'm reading, it mentions /var/www/html as being the folder you want to install a framework such as CakePHP, or for example /var/www/html being the folder you want to install your website on, so that everything is in root.What exactly does /var/www/html mean?In the most shared hosts you can't set it. On a VPS or dedicated server, you can set it, but everything has its price.On shared hosts, in general you receive a Linux account, something such as /home/(your username)/, and the equivalent of /var/www/html turns to /home/(your username)/public_html/ (or something similar, such as /home/(your username)/www)If you're accessing your account via FTP, you automatically has accessing the your */home/(your username)/ folder, just find the www or public_html and put your site in it.If you're using absolute path in the code, bad news, you need to refactor it to use relative paths in the code, at least in a shared host./var/www/html is just the default root folder of the web server. You can change that to be whatever folder you want by editing your apache.conf file (usually located in /etc/apache/conf) and changing the DocumentRoot attribute (see http://httpd.apache.org/docs/current/mod/core.html#documentroot for info on that)Many hosts don't let you change these things yourself, so your mileage may vary. Some let you change them, but only with the built in admin tools (cPanel, for example) instead of via a command line or editing the raw config files.

What is the difference between PEAR and Composer?

SohelAhmedM

[What is the difference between PEAR and Composer?](https://stackoverflow.com/questions/34199824/what-is-the-difference-between-pear-and-composer)

PEAR is used to install a PHP software package and Composer is used for the same thing. I believe Composer handles dependencies better but is that the only difference? Can anybody explain the difference between these two package managers and tell me when to use which?

2015-12-10 10:44:10Z

PEAR is used to install a PHP software package and Composer is used for the same thing. I believe Composer handles dependencies better but is that the only difference? Can anybody explain the difference between these two package managers and tell me when to use which?It might be a bit soon to regard PEAR as deprecated but I don't believe it will take long before it is. Composer is thriving and mature with a lot of packages and and active development. Therefore it might be better to use Composer as the standard for package management tool in PHP. Using PEAR is more cumbersome for package maintainers. Therefore a lot of the code on PEAR is outdated. A developer needs to get it packages 'PEAR-reviewed' before it might get published on PEAR, so few packages are available compared to the number of packages available in Composer. Also, there is no way to install a package in PEAR for one single project. All packages are installed globally. With Composer you can install packages one a per-project basis or globally. Well and then there is the lack of dependency management in PEAR, which frankly should be the one thing a package manager does well. One thing you can do with PEAR and not with Composer is installing PECL extensions. There is however pickle which uses Composer and lets you define native PHP extentions dependencies in your composer.json file. The pickle project is momentarily undergoing quite some development and should not yet be considered mature.This blog post by Fabien Potencier might be a bit opinionated, but I think it is quite right. If you have an option, choose Composer so PEAR can die in peace. Even when you ask the PEAR maintainers most will tell you that Composer is the way forward, although some might still have their hopes for Pyrus. (This was intended to be PEAR improved, but got kindof buried under the exploding popularity of Composer.)By the way, you can use Composer to install PEAR packages as well, see the Composer documentation.See also:

[1] Informative slide deck about PHP package management 

How secure is my PHP login system?

TK123

[How secure is my PHP login system?](https://stackoverflow.com/questions/8691076/how-secure-is-my-php-login-system)

I'm new to PHP and this is also my first log in system so it would be great if you guys could look over my code and see if you can spot any security holes:note: I am sanitizing all user input although it's not shown here.Step 1: I take the password the user chose and run it through this function:Step 2: I then store the hash and the salt ($password['hash'] and $password['salt']) in the users table in the database:Step 1: I take the username the user entered and do a look up on the database to see if any rows are returned. On my site no 2 users can share the same

username so the username field always has a unique value. If I get 1 row returned I grab the salt for that user.Step 2: Then I run the user entered password through the encrypt function (as previously posted above) but this time I also supply the salt retrieved from the database:Step 3: I now have the proper password to match against in this variable: $password['hash']. So I so a second lookup on the database to see if the

username entered and the hashed password together return a single row. If so then the user's credentials are correct.Step 4: In order to log the user in after their credentials passed I generate a random unique string and hash it:I then insert the $session_key into the active_sessions table in the database:Step 5:I take the unencrypted unique string generated in the last step ($random_string) and set that as the value of a cookie which I call active_session:Step 6:At the top of my header.php include there is this check:The get_userinfo() function does a lookup on the users table in the database and returns an associative array which is stored in a session called userinfo:// first this function takes the value of the active_session cookie and hashes it to get the session_key:// then it does a lookup on the active_sessions table to see if a record by this key exists, if so it will grab the user_id associated with that record and use this to do a second lookup on the users table to get the userinfo:If the userinfo session exists I know the user is authenticated. If it doesn't exist but the active_session cookie exists then that check

at the top of the header.php file will create that session.The reason why I am using a cookie and not sessions alone is to persist the login. So if the user closes the browser the session may be gone but the

cookie will still exist. And since there is that check at the top of header.php, the session will be recreated and the user can function as a logged

in user as normal.Step 1: Both the userinfo session and the active_session cookie are unset.Step 2: The associated record from the active_sessions table in the database is removed.Notes: The only issue I can see (and perhaps there are many others), is if the user fakes that active_session cookie by creating it themselves in their browser. Of course they must set as that cookie's value a string which after it is encrypted must match a record in the active_sessions table from where I will retrieve the user_id to create that session. I am not sure what the chances of this is realistically, for a user (perhaps using an automated program) to guess a string correctly which they don't know will then be sha512 encrypted and matched against the string in the active_sessions table in the database to get the user id to build that session.Sorry for the big essay but since this is such a critical part of my site and due to my inexperience I just wanted to run it by more experienced developers to make sure it's actually safe. So do you see any security holes in this route and how can it be improved?

2011-12-31 23:33:06Z

I'm new to PHP and this is also my first log in system so it would be great if you guys could look over my code and see if you can spot any security holes:note: I am sanitizing all user input although it's not shown here.Step 1: I take the password the user chose and run it through this function:Step 2: I then store the hash and the salt ($password['hash'] and $password['salt']) in the users table in the database:Step 1: I take the username the user entered and do a look up on the database to see if any rows are returned. On my site no 2 users can share the same

username so the username field always has a unique value. If I get 1 row returned I grab the salt for that user.Step 2: Then I run the user entered password through the encrypt function (as previously posted above) but this time I also supply the salt retrieved from the database:Step 3: I now have the proper password to match against in this variable: $password['hash']. So I so a second lookup on the database to see if the

username entered and the hashed password together return a single row. If so then the user's credentials are correct.Step 4: In order to log the user in after their credentials passed I generate a random unique string and hash it:I then insert the $session_key into the active_sessions table in the database:Step 5:I take the unencrypted unique string generated in the last step ($random_string) and set that as the value of a cookie which I call active_session:Step 6:At the top of my header.php include there is this check:The get_userinfo() function does a lookup on the users table in the database and returns an associative array which is stored in a session called userinfo:// first this function takes the value of the active_session cookie and hashes it to get the session_key:// then it does a lookup on the active_sessions table to see if a record by this key exists, if so it will grab the user_id associated with that record and use this to do a second lookup on the users table to get the userinfo:If the userinfo session exists I know the user is authenticated. If it doesn't exist but the active_session cookie exists then that check

at the top of the header.php file will create that session.The reason why I am using a cookie and not sessions alone is to persist the login. So if the user closes the browser the session may be gone but the

cookie will still exist. And since there is that check at the top of header.php, the session will be recreated and the user can function as a logged

in user as normal.Step 1: Both the userinfo session and the active_session cookie are unset.Step 2: The associated record from the active_sessions table in the database is removed.Notes: The only issue I can see (and perhaps there are many others), is if the user fakes that active_session cookie by creating it themselves in their browser. Of course they must set as that cookie's value a string which after it is encrypted must match a record in the active_sessions table from where I will retrieve the user_id to create that session. I am not sure what the chances of this is realistically, for a user (perhaps using an automated program) to guess a string correctly which they don't know will then be sha512 encrypted and matched against the string in the active_sessions table in the database to get the user id to build that session.Sorry for the big essay but since this is such a critical part of my site and due to my inexperience I just wanted to run it by more experienced developers to make sure it's actually safe. So do you see any security holes in this route and how can it be improved?You should include some kind of timeout or failover to prevent against brute-force attacks. There are a number of ways to do this, including IP-based blocking, incremental timeouts, etc. None of these will ever stop a hacker, but they can make it much more difficult.Another point (which you haven't mentioned, so I don't know your plan) is failure messages. Make failure messages as vague as possible. Providing an error message like 'That username exists, but the passwords did not match' might be helpful to the end-user, but it kills login functionality. You just converted a brute-force attack that should take O(n^2) time to O(n) + O(n). Instead of needed to try every permutation in a rainbow table (for example), the hacker just tries all values for username (with a set password) first, until the failure message changes. Then, it knows a valid user, and just has to brute force the password.Along those lines, you should also make sure that the same amount of time elapses when a username exists and doesn't exist. You are running additional processes when a username actually exists. As such the response time would be longer when a username exists vs when it doesn't. An incredibly skilled hacker could time page requests to find a valid username.Similarly, you should make sure that, in addition to expiring cookies, you also expire the sessions table.Lastly, in the get_user_info() call, you should terminate all open sessions if there are multiple concurrent, active logins. Make sure you timeout sessions after a set amount of inactivity (like 30 minutes).Along the lines of what @Greg Hewgill mentioned, you haven't included any of the following:You server is secure, but it doesn't matter how awesomely secure your algorithm is if someone can read the data that's exchanged (MITM). You should make sure you are only communicating over an encrypted protocol. So how does the password get from the browser to the server? You haven't mentioned protecting against man-in-the-middle attacks.This code......is bad. Use the new password API and be done with it. Unless you are an expert, you should not try to design your own authentication system. They are extremely difficult to get right.Just let PHP handle session management. rand() and mt_rand() are both very insecure random number generators.It looks like the code you created is not testable through automated unit and integration tests. This makes it hard to spot any errors that might be included in your implementation over time and while running in a production environment.This normally leads to security issues, because the security of a strict and correct execution and sane data handling is not tested/verified.(It's just another point on the list, see as well the answer about how to secure the transport layer, also you have not specified how you protect your session data from being tampered.)Regarding passwords in php, you shouldnt be encrypting them. You should hash them using the password_hash() then on login, use password_verify() to verify that the password via the html form matches the stored hash in the database You should use mt_rand() instead of rand()Here's why:

Passing multiple variables to another page in url

zadubz

[Passing multiple variables to another page in url](https://stackoverflow.com/questions/13102489/passing-multiple-variables-to-another-page-in-url)

I'm passing a variable to another page in a url using sessions like this but it seems that I can't concatenate another variable to the same url and retrieve it in the next page  successfully  Page 1Page 2echo $event_id shows an error Undefined variable on page 2 but if I use just the event_id in the $url like here That works fine, but I need to be able to use both variables in the url so that page 2 can retrieve get them.

2012-10-27 17:33:53Z

I'm passing a variable to another page in a url using sessions like this but it seems that I can't concatenate another variable to the same url and retrieve it in the next page  successfully  Page 1Page 2echo $event_id shows an error Undefined variable on page 2 but if I use just the event_id in the $url like here That works fine, but I need to be able to use both variables in the url so that page 2 can retrieve get them.Use the ampersand & to glue variables together:This is what you are trying to do but it poses some security and encoding problems so don't do it.All variables in querystrings need to be urlencoded to ensure proper transmission. You should never pass a user's personal information in a url because urls are very leaky. Urls end up in log files, browsing histories, referal headers, etc. The list goes on and on.As for proper url encoding, it can be achieved using either urlencode() or http_build_query(). Either one of these should work:orAdditionally, if $event_id is in your session, you don't actually need to pass it around in order to access it from different pages. Just call session_start() and it should be available.Your first variable declartion must start with a ? while any additional must be concatenated with a &Pretty simple but another said you dont pass session variables through the url bar

1.You dont need to because a session is passed throughout the whole website from header when you put in header file

2.security risks

Here is first page code$url = "http://localhost/main.php?email=" . urlencode($email_address) . "&eventid=" . urlencode($event_id);2nd page when getting the variables from the url bar is:if(isset($_GET['email']) && !empty($_GET['email']) AND isset($_GET['eventid']) && !empty($_GET['eventid'])){

////do whatever here

}Now if you want to do it the proper way of using the session you created then ignore my above code and call the session variables on the second page for instance create a session on the first page lets say for example:obvious that you would have already assigned values to the session variables in the code above, you can call the session name whatever you want to i just used the example web_ses , the second page all you need to do is start a session and see if the session is there and check the variables and do whatever with them, example:Like I said before the good thing about sessions are they can be carried throughout the entire website if this type of code in put in the header file that gets called upon on all pages that load, you can simple use the variable wherever and whenever. Hope this helps :)You are checking isset($_GET['event_id'] but you've not set that get variable in your hyperlink, you are just adding emailhttp://localhost/main.php?email=" . $email_address . $event_idAnd add another GET variable in your linkYou did not use to concatenate your string if you are using " quotesUse & for this. Using & you can put as many variables as you want!Pass multiple Variable one page to another pagefrom php.netWarning

The superglobals $_GET and $_REQUEST are already decoded. Using urldecode() on an element in $_GET or $_REQUEST could have unexpected and dangerous results.link: http://php.net/manual/en/function.urldecode.phpbe careful.

CodeIgniter PHP Model Access「Unable to locate the model you have specified」

Alexandre Bolduc

[CodeIgniter PHP Model Access「Unable to locate the model you have specified」](https://stackoverflow.com/questions/8074368/codeigniter-php-model-access-unable-to-locate-the-model-you-have-specified)

I have been trying to load some models for this website I am building. However, for an unknown reason, it will bring the following error :Now , I have done my research. The problem would be that IC processes file names in lowercase. However, both my file and the file calling is in lower case, as shown here :The execution does not reach "FOUND MODEL", thus stops on the model loading. I have tried to use:With no results. Need to mention the model file is correctly placed in the right model folder ?How can I fix this ?EDIT : Header for the model file :

2011-11-10 02:38:46Z

I have been trying to load some models for this website I am building. However, for an unknown reason, it will bring the following error :Now , I have done my research. The problem would be that IC processes file names in lowercase. However, both my file and the file calling is in lower case, as shown here :The execution does not reach "FOUND MODEL", thus stops on the model loading. I have tried to use:With no results. Need to mention the model file is correctly placed in the right model folder ?How can I fix this ?EDIT : Header for the model file :When creating models, you need to place the file in application/models/ and name the file in all lowercase - like logon_model.phpThe logon_model.php should contain the following:Now, what you can do, to test if your application model is reachable, is to try opening it in the browser - like so:

http://example.org/application/models/logon_model.phpIf you see the text No direct script access allowed it means you hit the right file (if you are in doubt, try writing something else in the exit() in the first line).Secondly, for loading the model in your controllers, you should be able to do like this:If everything above checks out as expected I would begin looking at file permissions and/or possibly symlinks if you are using any.I use codeigniter 3+. I had the same problem and in my case I changed model file name starting from uppser case.Logon_model.phpHere is what a model should look like: Make sure yours is like this.note the upper-case class name.To load it use:note all lower case.I resolve this with this way:Works fine.. I hope help.In CodeIgniter 3.0-dev (get it from github) this is not working because the CI is search as first letter uppercase.You can find the code on system/core/Loader.php line 282 or bellow:This mean that we need to create the file with the following name on application/models/Logon_mode.phpFirst letter of file name and class name must be in Uppercase. Your model class will be and the file name will be Logon_model.phpAccess it from your contoller likeAdding to @jakentus answer, below is what worked for me:Hope this helps. Happy coding. :)Models must be named and called with the first letter of the model name capitalized and the rest in lowercase. For example: $this->load->model('Logon_model');and:But you are correct about the file name.I experienced the same problem, but I fixed it by altering my application/config/routes.php file.I made some restructuring to my controller directories and forget to effect it on the routes file.Earlier:and now:$route['application/apply'] = 'application/account/create'; Changing the name of model name starting with Uppercase works. 

Example : Login_model.php instead of login_model.phpyou must change your model name first letter capital.

in localhost small letter work properly but online this not work. for exa: replaced it to Just adding my problem i had:and the .php shouldnt be there, so it should have been:hope this helps someoneChange your model file name,  start with upper case letter like this: Logon_model.phpThis happens when we migrate our project from windows server to LINUX server because linux is case sensitive while windows is not. So, on windows even if don't write file name with upper case then also it will work fine but not on linux.If you are on Linux then make sure your File name must match with the string passed in the load model methods the first argument.You can use the second argument using that you can call methods from your model and it will work on Linux and windows as wellMake sure:In my case I had 1 and 2 correct but forgot to name my file with .php extension. How I forgot, no idea but it sure gave me a hard time trying to figure out the problemYou can give whatever name you want.Styles guides are recommendations and not musts.But you have to care to use everywhere the same name.For example for Test_Model you have to:To avoid using hard coding strings you can load model like this:

CSV to Associative Array

ParoX

[CSV to Associative Array](https://stackoverflow.com/questions/4801895/csv-to-associative-array)

I've seen numerous examples on how to take a CSV file and then create an associative array with the headers as the keys.For example:Where it would create an Array such as     Array[$num][$key] where $key would be Brand, Model, Part, Test.So If I wanted to access the test value "434" I would have to loop every index in the array and then ignore any Brands that were not honda, and any models that were not CivicWhat I need to do is access the value most directly, instead of running through a for loop going through each $num index. I want to be able to access the value test "434" with:Array['Honda']['Civic']['135']or control a for statement with looping through every model Honda has... something likeforeach $model in Array['Honda']At the very least I need to be able to go through every model given a known Brand and access all the relative info for each.Edit:Just to confirm I was setting this up an example. My actually data has headers like:brand  model   part price  shipping    description footnoteOf which I need to access all the information tied to the part (price, shipping,desc, footnote)

2011-01-26 06:29:05Z

I've seen numerous examples on how to take a CSV file and then create an associative array with the headers as the keys.For example:Where it would create an Array such as     Array[$num][$key] where $key would be Brand, Model, Part, Test.So If I wanted to access the test value "434" I would have to loop every index in the array and then ignore any Brands that were not honda, and any models that were not CivicWhat I need to do is access the value most directly, instead of running through a for loop going through each $num index. I want to be able to access the value test "434" with:Array['Honda']['Civic']['135']or control a for statement with looping through every model Honda has... something likeforeach $model in Array['Honda']At the very least I need to be able to go through every model given a known Brand and access all the relative info for each.Edit:Just to confirm I was setting this up an example. My actually data has headers like:brand  model   part price  shipping    description footnoteOf which I need to access all the information tied to the part (price, shipping,desc, footnote)run over the csv file line by line, and insert to array like:Too many long solutions. I've always found this to be the simplest:To create an associative list array use something like:And to traverse and filter by specific attributes write a function like:Where you would invoke it with $find = array(Brand=>Honda, Model=>Civic, Part=>135) to filter out the searched models. The other positional array structure seems not very workable, unless you only want to access the "Test" attribute.Try this simple algorithm:Here is a solutions that will work by specifying a local file or URL. You can also switch the association on and off. Hopefully this helps.Try this usage:Using fgetcsv() seems the most direct and sensible tool for the job.csv.csv contents:Code:Output:Resource: http://php.net/manual/en/function.fgetcsv.php

Could not open input file: composer.phar

Sundar

[Could not open input file: composer.phar](https://stackoverflow.com/questions/20769980/could-not-open-input-file-composer-phar)

I am trying to install zendframework using composer tool in wamp server.The following steps are done towards installationThis line generates the error message: could not open file composer.pharhow to resolve this errorIf I try the 

2013-12-25 06:59:31Z

I am trying to install zendframework using composer tool in wamp server.The following steps are done towards installationThis line generates the error message: could not open file composer.pharhow to resolve this errorIf I try the Use this :This will install composer to the current directory so that you can use php composer.pharThe composer.phar install is not working but without .phar this is working.  We need to enable the openssl module in php before installing the zendframe work.We have to uncomment the line ;extension=php_openssl.dll from php.ini file.composer use different php.ini file which is located at the wamp\bin\php\php-<version number>\php.iniAfter enabling the openssl we need to restart the server.The execute the following comments.I can install successfully using these commands - I was trying to install YII 2.0 I got the same error:Could not open input file: composer.pharThen i gave the full path of .phar like this:and it worked.I am using Windows 7, and I got the same problem as yours while using Composer via cmd.The problem is solved when I useinstead ofHope this is useful for people who got the same problem.First try this: dont use the php composer.phar [parameters] simply use composer [parameters] if this doesn't work for you than try the rest. Hope it helps.Initially, I was running php composer.phar self-update and got the same error message.As a resolve, you should use composer command directly after install it.From the command prompt, just type composer and press enter. If composer is installed correctly then you should able to see a lot of suggestion and command list from composer.  If you are up to this point then you should able to run  composer self-update directly.Question already answered by the OP, but I am posting this answer for anyone having similar problem, retting to error message.Simply go to your project directory/folder and do aAssuming this is where you have your web application:change directory to it, and then run composer update.I have fixed the same issue with below stepsEverything is working fine now because the composer.phar file is available within the current project directory.thanks dont use php composer.phar self-update

First go to Your project directory

simply use composer.phar self-update

This works for meThis is how it worked for me: for example. Instead ofuseJust add https instead of http in the URL. Though it's not a permanent solution, it does work.Another solution could be.. find the location of composer.phar file in your computer. If composer is installed successfully then it can be found in the installed directory.Copy that location & instead of composer.phar in the command line, put the entire path there.It also worked for me!

In php when initializing a class how would one pass a variable to that class to be used in its functions?

Tomalak

[In php when initializing a class how would one pass a variable to that class to be used in its functions?](https://stackoverflow.com/questions/484537/in-php-when-initializing-a-class-how-would-one-pass-a-variable-to-that-class-to)

So here is the deal. I want to call a class and pass a value to it so it can be used inside that class in all the various functions ect. ect. How would I go about doing that?Thanks,

Sam

2009-01-27 18:10:17Z

So here is the deal. I want to call a class and pass a value to it so it can be used inside that class in all the various functions ect. ect. How would I go about doing that?Thanks,

SamThe concept is called "constructor".As the other answers point out, you should use the unified constructor syntax (__construct()) as of PHP 5. Here is an example of how this looks like:Notice - There are so-called old style constructors that you might run into in legacy code. They look like this:This form is officially deprecated as of PHP 7 and you should no longer use it for new code.In new versions of PHP (5 and up), the function __constuct is called whenever you use "new {Object}", so if you want to pass data into the object, add parameters to the construct function and then callNamed constructors are being phased out of PHP in favor of the __construct method.This means less maintenance in the long run.Order of passed variables is not important anymore, (no more writing defaults like 'null': someClass(null, null, true, false))Adding a new variable is less hassle (don't have to write the assignment in the constructor)When you look at the instantiation of the class you'll know immediately what the passed in variables relate to: vs This is how I do mineCreate an instance and then call the function add11 will be written to the page

not a very useful example because you would prefer to pass value to add when you called it but this illustrates the point.You can do this like that:or you can use __construct instead of SomeClass for constructor in php5.Think everyone's missing the obvious here. Yes, the PHP4 constructor is deprecated, but you can write your class to be backwards compatible like this: Wow I cannot believe the answers here! They will all work but are wrong, the right way of set the variables is by a getter and setter, this allows you to set your variable neatly and perform checks etc on them. e.g.What this allows you to do is call the object correctly e.g.This is the tidy way of doing it and on large projects and scripts you will be glad of this, I am having this problem right now with some-else's script which cannot be updated easily because it has been written in the other ways mentioned in this page.It also allows you to have an unlimited number of variables for the class with out a silly call to the object e.g.This is basically no clearer than using a function.

PHP - recursive Array to Object?

Peter

[PHP - recursive Array to Object?](https://stackoverflow.com/questions/4790453/php-recursive-array-to-object)

Is there a way to convert a multidimensional array to a stdClass object in PHP?Casting as (object) doesn't seem to work recursively.  json_decode(json_encode($array)) produces the result I'm looking for, but there has to be a better way...

2011-01-25 05:55:39Z

Is there a way to convert a multidimensional array to a stdClass object in PHP?Casting as (object) doesn't seem to work recursively.  json_decode(json_encode($array)) produces the result I'm looking for, but there has to be a better way...As far as I can tell, there is no prebuilt solution for this, so you can just roll your own:I know this answer is coming late but I'll post it for anyone who's looking for a solution.Instead of all this looping etc, you can use PHP's native json_* function. I've got a couple of handy functions that I use a lotHope this can be helpfulYou and many others have pointed to the JSON built-in functions, json_decode() and json_encode(). The method which you have mentioned works, but not completely: it won't convert indexed arrays to objects, and they will remain as indexed arrays. However, there is a trick to overcome this problem. You can use JSON_FORCE_OBJECT constant:Tip: Also, as mentioned here, you can convert an object to array recursively using JSON functions:You can use the array_map recursively:Works perfect for me since it doesn't cast for example Carbon objects to a basic stdClass (which the json encode/decode does)The simpliest way to convert an associative array to object is:First encode it in json, then decode it.like $objectArray = json_decode(json_encode($associtiveArray));Some of the other solutions posted here fail to tell apart sequential arrays (what would be [] in JS) from maps ({} in JS.) For many use cases it's important to tell apart PHP arrays that have all sequential numeric keys, which should be left as such, from PHP arrays that have no numeric keys, which should be converted to objects. (My solutions below are undefined for arrays that don't fall in the above two categories.)The json_decode(json_encode($x)) method does handle the two types correctly, but is not the fastest solution. It's still decent though, totaling 25µs per run on my sample data (averaged over 1M runs, minus the loop overhead.)I benchmarked a couple of variations of the recursive converter and ended up with the following. It rebuilds all arrays and objects (performing a deep copy) but seems to be faster than alternative solutions that modify the arrays in place. It clocks at 11µs per execution on my sample data:Here is an in-place version. It may be faster on some large input data where only small parts need to be converted, but on my sample data it took 15µs per execution:I did not try out solutions using array_walk_recursive()Here's a function to do an in-place deep array-to-object conversion that uses PHP internal (shallow) array-to-object type casting mechanism.

It creates new objects only when necessary, minimizing data duplication.Warning - do not use this code if there is a risk of having circular references.Here is a smooth way to do it that can handle an associative array with great depth and doesn't overwrite object properties that are not in the array.The shortest I could come up with:Late, but just wanted to mention that you can use the JSON encoding/decoding to convert fully from/to array:json_encode and json_decode functions are available starting from php 5.2EDIT: This function is conversion from object to array.From https://forrst.com/posts/PHP_Recursive_Object_to_Array_good_for_handling-0ka

Obtain first line of a string in PHP

kinokijuf

[Obtain first line of a string in PHP](https://stackoverflow.com/questions/9097682/obtain-first-line-of-a-string-in-php)

In PHP 5.3 there is a nice function that seems to do what I want:Unfortunately, the server runs PHP 5.2.17 and the optional third parameter of strstr is not available. Is there a way to achieve this in previous versions in one line?

2012-02-01 14:39:46Z

In PHP 5.3 there is a nice function that seems to do what I want:Unfortunately, the server runs PHP 5.2.17 and the optional third parameter of strstr is not available. Is there a way to achieve this in previous versions in one line?here you gostrtok() DocumentationIt's late but you could use explode.or something thereabouts would do the trick. Ugly, but workable.try echo str_replace(strstr($input, '\n'),'',$input);try this:Makes it easy to get the top line and the content left behind if you wanted to repeat the operation. Otherwise use substr as suggested.not dependent from type of linebreak symbol. $firstline now contain first line from text or empty string, if no break symbols found (or break symbol is a first symbol in text).You can use strpos combined with substr. First you find the position where the character is located and then you return that part of the string.Is this what you want ?l.e. 

Didn't notice the one line restriction, so this is not applicable the way it is. You can combine the two functions in just one line as others suggested or you can create a custom function that will be called in one line of code, as wanted. Your choice.Many times string manipulation will face vars that start with a blank line, so don't forget to evaluate if you really want consider white lines at first and end of string, or trim it. Also, to avoid OS mistakes, use PHP_EOL used to find the newline character in a cross-platform-compatible way (When do I use the PHP constant "PHP_EOL"?).A quick way to get first n lines of a string, as a string, while keeping the line breaks.Example 6 first lines of $multilinetxtCan be quickly adapted to catch a particular block of text, example from line 10 to 13:

Which is faster, python webpages or php webpages? [closed]

Echo says Reinstate Monica

[Which is faster, python webpages or php webpages? [closed]](https://stackoverflow.com/questions/77086/which-is-faster-python-webpages-or-php-webpages)

Which is faster, python webpages or php webpages?Does anyone know how the speed of pylons(or any of the other frameworks) compares to a  similar website made with php?  I know that serving a python base webpage via cgi is slower than php because of its long start up every time.I enjoy using pylons and I would still use it if it was slower than php. But if pylons was faster than php, I could maybe, hopefully, eventually convince my employer to allow me to convert the site over to pylons.

2008-09-16 21:05:26Z

Which is faster, python webpages or php webpages?Does anyone know how the speed of pylons(or any of the other frameworks) compares to a  similar website made with php?  I know that serving a python base webpage via cgi is slower than php because of its long start up every time.I enjoy using pylons and I would still use it if it was slower than php. But if pylons was faster than php, I could maybe, hopefully, eventually convince my employer to allow me to convert the site over to pylons.It sounds like you don't want to compare the two languages, but that you want to compare two web systems.This is tricky, because there are many variables involved.For example, Python web applications can take advantage of mod_wsgi to talk to web servers, which is faster than any of the typical ways that PHP talks to web servers (even mod_php ends up being slower if you're using Apache, because Apache can only use the Prefork MPM with mod_php rather than multi-threaded MPM like Worker).There is also the issue of code compilation. As you know, Python is compiled just-in-time to byte code (.pyc files) when a file is run each time the file changes. Therefore, after the first run of a Python file, the compilation step is skipped and the Python interpreter simply fetches the precompiled .pyc file. Because of this, one could argue that Python has a native advantage over PHP. However, optimizers and caching systems can be installed for PHP websites (my favorite is eAccelerator) to much the same effect.In general, enough tools exist such that one can pretty much do everything that the other can do. Of course, as others have mentioned, there's more than just speed involved in the business case to switch languages. We have an app written in oCaml at my current employer, which turned out to be a mistake because the original author left the company and nobody else wants to touch it. Similarly, the PHP-web community is much larger than the Python-web community; Website hosting services are more likely to offer PHP support than Python support; etc.But back to speed. You must recognize that the question of speed here involves many moving parts. Fortunately, many of these parts can be independently optimized, affording you various avenues to seek performance gains.There's no point in attempting to convince your employer to port from PHP to Python, especially not for an existing system, which is what I think you implied in your question.The reason for this is that you already have a (presumably) working system, with an existing investment of time and effort (and experience). To discard this in favour of a trivial performance gain (not that I'm claiming there would be one) would be foolish, and no manager worth his salt ought to endorse it.It may also create a problem with maintainability, depending on who else has to work with the system, and their experience with Python.I would assume that PHP (>5.5) is faster and more reliable for complex web applications because it is optimized for website scripting.Many of the benchmarks you will find at the net are only made to prove that the favoured language is better. But you can not compare 2 languages with a mathematical task running X-times. For a real benchmark you need two comparable frameworks with hundreds of classes/files an a web application running 100 clients at once.PHP and Python are similiar enough to not warrent any kind of switching.Any performance improvement you might get from switching from one language to another would be vastly outgunned by simply not spending the money on converting the code (you don't code for free right?) and just buy more hardware.It's about the same. The difference shouldn't be large enough to be the reason to pick one or the other. Don't try to compare them by writing your own tiny benchmarks ("hello world") because you will probably not have results that are representative of a real web site generating a more complex page.If it ain't broke don't fix it.Just write a quick test, but bear in mind that each language will be faster with certain functions then the other.You need to be able to make a business case for switching, not just that "it's faster".  If a site built on technology B costs 20% more in developer time for maintenance over a set period (say, 3 years), it would likely be cheaper to add another webserver to the system running technology A to bridge the performance gap.Just saying "we should switch to technology B because technology B is faster!" doesn't really work.Since Python is far less ubiquitous than PHP, I wouldn't be surprised if hosting, developer, and other maintenance costs for it (long term) would have it fit this scenario.an IS organization would not ponder this unless availability was becoming an issue.if so the case, look into replication, load balancing and lots of ram.The only right answer is "It depends". There's a lot of variables that can affect the performance, and you can optimize many things in either situation.I had to come back to web development at my new job, and, if not Pylons/Python, maybe I would have chosen to live in jungle instead :) In my subjective opinion, PHP is for kindergarten, I did it in my 3rd year of uni and, I believe, many self-respecting (or over-estimating) software engineers will not want to be bothered with PHP code. Why my employers agreed? We (the team) just switched to Python, and they did not have much to say. The website still is and will be PHP, but we are developing other applications, including web, in Python. Advantages of Pylons? You can integrate your python libraries into the web app, and that is, imho, a huge advantage.As for performance, we are still having troubles.

Remove quotes from start and end of string in PHP

newbie

[Remove quotes from start and end of string in PHP](https://stackoverflow.com/questions/9734758/remove-quotes-from-start-and-end-of-string-in-php)

I have strings like these:I need to get rid of " (double-quotes) in end and start, if these exist, but if there is this kind of character inside String then it should be left there. Example:How can I do this in PHP - is there function for this or do I have to code it myself?

2012-03-16 09:32:27Z

I have strings like these:I need to get rid of " (double-quotes) in end and start, if these exist, but if there is this kind of character inside String then it should be left there. Example:How can I do this in PHP - is there function for this or do I have to code it myself?here is the sourceI had a similar need and wrote a function that will remove leading and trailing single or double quotes from a string:This will produce the outputs listed below:trim will remove all instances of the char from the start and end if it matches the pattern you provide, so:Will become:Here's a way to only remove the first and last char if they match:As much as this thread should have been killed long ago, I couldn't help but respond with what I would call the simplest answer of all. I noticed this thread re-emerging on the 17th so I don't feel quite as bad about this. :)Using samples as provided by Steve Chambers;Output below;This only ever removes the first and last quote, it doesn't repeat to remove extra content and doesn't care about matching ends.You need to use regular expressions, look at:-http://php.net/manual/en/function.preg-replace.phpOr you could, in this instance, use substr to check if the first and then the last character of the string is a quote mark, if it is, truncate the string.http://php.net/manual/en/function.substr.phpHow about regexOutputThis is an old post, but just to cater for multibyte strings, there are at least two possible routes one can follow. I am assuming that the quote stripping is being done because the quote is being considered like a program / INI variable and thus is EITHER "something" or 'somethingelse' but NOT "mixed quotes'. Also, ANYTHING between the matched quotes is to be retained intact.

Route 1 - using a RegexThis uses \1 to match the same type quote that matched at the beginning. the u modifier, makes it UTF8 capable (okay, not fully multibyte supporting)Route 2 - using mb_* functionsIf you like performance over clarity this is the way:The comment helps with clarity... 

brackets in an array-like usage on strings is possible and demands less processing effort than equivalent methods, too bad there isnt a length variable or a last char index

DropzoneJS: How to get PHP response after upload success?

Patrick Falize

[DropzoneJS: How to get PHP response after upload success?](https://stackoverflow.com/questions/19390471/dropzonejs-how-to-get-php-response-after-upload-success)

I'm trying to implement Dropzone on my site. I want to listen for the "success" event and then take the server response and add some info from it to a form on the same page as the DropZone after the upload is completed.the info i want to get in the server response is a direct link to the file.the website of dropzone: http://www.dropzonejs.com/my project website:so i completed this in a older version of my project but i cant figure it out how to do it with dropzone.jsworking example:what i try to do is when a file has been uploaded i want to get the php response back on the same page with the download links as shown below.i can also send you my source codes so you can look for yourself.my php code i want to see in the response:Can anyone help me understand what I'm missing?

2013-10-15 20:31:21Z

I'm trying to implement Dropzone on my site. I want to listen for the "success" event and then take the server response and add some info from it to a form on the same page as the DropZone after the upload is completed.the info i want to get in the server response is a direct link to the file.the website of dropzone: http://www.dropzonejs.com/my project website:so i completed this in a older version of my project but i cant figure it out how to do it with dropzone.jsworking example:what i try to do is when a file has been uploaded i want to get the php response back on the same page with the download links as shown below.i can also send you my source codes so you can look for yourself.my php code i want to see in the response:Can anyone help me understand what I'm missing?Looking at your website, seems like you were able to fix the problem. Anyways this is for someone who might still be looking. You need to add the function success with two parameters. The first param returned is always file, second one is the response. Sample:I had have some problems with dropzone, but i found this solution:The valided answer not worked for me. This does :And in the php side:None of the above worked for me, but this ...Note that there is an issue with chunked uploads and never get back the response from the server on success. All the previous answers will not work in that case. Solution could be by manually parsing XHR response like so: Alse you could check the issue at Dropzone's repository in here https://gitlab.com/meno/dropzone/issues/51#note_47553173But if I am using this code then i have to remove the dropzone class from form. Otherwise it will throw this error.

Make array of all GET-variables

Emil

[Make array of all GET-variables](https://stackoverflow.com/questions/3289758/make-array-of-all-get-variables)

I'm trying to make an array from all the GET-variables passed to a PHP script. So far I haven't found any way to do this.Is this possible?

2010-07-20 12:14:16Z

I'm trying to make an array from all the GET-variables passed to a PHP script. So far I haven't found any way to do this.Is this possible?It's already there by default:PHP docs on all available superglobalsThere is a $_GET super global array to get all variables from query string.You can also use foreach loop to go through all of them like this:GET variables are allready passed as an arrayWill get every variable passed by post or get and make into a new variableThe $_REQUEST variable is:http://www.php.net/manual/en/reserved.variables.request.phpThat could helpGet all GET params by :

How to solve a timeout error in Laravel 5

Geordie Gadgie

[How to solve a timeout error in Laravel 5](https://stackoverflow.com/questions/30270316/how-to-solve-a-timeout-error-in-laravel-5)

I have the following set up:In routes I have:Route::get('articles', 'ArticlesController@index');The index method in the controller is simply:and in the view:I attempted to replace the: withsuch that I can actually show the articles latest first.

I got the error:and the call stack is:... etcI have restored the controller method to what it was, but the error persists.Can you please tell me how I can solve this problem?

2015-05-15 23:49:11Z

I have the following set up:In routes I have:Route::get('articles', 'ArticlesController@index');The index method in the controller is simply:and in the view:I attempted to replace the: withsuch that I can actually show the articles latest first.

I got the error:and the call stack is:... etcI have restored the controller method to what it was, but the error persists.Can you please tell me how I can solve this problem?The Maximum execution time of 30 seconds exceeded error is not related to Laravel but rather your PHP configuration.Here is how you can fix it. The setting you will need to change is max_execution_time. You can change the max_execution_time to 300 seconds like max_execution_time = 300You can find the path of your PHP configuration file in the output of the phpinfo function in the Loaded Configuration File section.it's a pure PHP setting.

The alternative is to increase the execution time limit only for specific php scripts, by inserting on top of that php file, the following:In Laravel:Add set_time_limit(0) line on top of query.It helps you in different large queries but you should need to improve query optimise. Sometimes you just need to optimize your code or query, Setting more max_execution_time is not a solution.A code should not be run more than 30s.set time limit in __construct method or you can set in your index controller also where you want to have large time limit.trywhere $time is in seconds, set it to 0 for no time. make sure to make it 60 back after your function finishIf using PHP7, I would suggest you changing the default value in the public/.htaccess Execution  is not related to laravel go to the php.ini file 

In php.ini file  set max_execution_time=360 (time may be variable depends on need)

if you want to increase execution of a specific page then write ini_set('max_execution_time',360) at top of page otherwise in htaccess 

php_value max_execution_time 360

Add above query ini_set("memory_limit", "10056M");If you are hosting your Laravel app on Heroku, you can create custom_php.ini in the root of your project and simply add max_execution_time = 60

    

        Options -MultiViews -Indexes

    You need to just press CTRL + F5. It will work after that. 

Laravel default orderBy

M K

[Laravel default orderBy](https://stackoverflow.com/questions/20701216/laravel-default-orderby)

Is there a clean way to enable certain models to be ordered by a property by default?

It could work by extending the laravel's QueryBuilder, but to do so, you'll have to rewire some of it's core features - bad practice.reasonThe main point of doing this is - one of my models get's heavily reused by many others and right now you have to resort the order over and over again. Even when using a closure for this - you still have to call it. It would be much better to be able to apply a default sorting, so everyone who uses this model, and does not provide custom sorting options, will receive records sorted by the default option. Using a repository is not an option here, because it get's eager loaded.SOLUTIONExtending the base model:In your model:In your controller:

2013-12-20 10:13:24Z

Is there a clean way to enable certain models to be ordered by a property by default?

It could work by extending the laravel's QueryBuilder, but to do so, you'll have to rewire some of it's core features - bad practice.reasonThe main point of doing this is - one of my models get's heavily reused by many others and right now you have to resort the order over and over again. Even when using a closure for this - you still have to call it. It would be much better to be able to apply a default sorting, so everyone who uses this model, and does not provide custom sorting options, will receive records sorted by the default option. Using a repository is not an option here, because it get's eager loaded.SOLUTIONExtending the base model:In your model:In your controller:Yes you would need to extend Eloquent to always do this as standard for any query. What's wrong with adding an order by statement to the query when you need it ordered? That is the cleanest way, ie, you dont need to 'unhack' Eloquent to get results by natural order.Other than that the closest thing to what you want would be to create query scopes in your models.You can then call ordered as a method instead of get to retrieve your ordered results.If you wanted this across different models you could create a base class and just extend it to the models you want to have access to this scoped method.Nowadays we can solve this problem also with global scopes, introduced in Laravel 4.2 (correct me if I'm wrong). We can define a scope class like this:Then, in your model, you can add the scope in the boot() method:Now the model is ordered by default. Note that if you define the order also manually in the query: MyModel::orderBy('some_column'), then it will only add it as a secondary ordering (used when values of the first ordering are the same), and it will not override. To make it possible to use another ordering manually, I added an (optional) macro (see above), and then you can do: MyModel::unordered()->orderBy('some_column')->get().Laravel 5.2 introduced a much cleaner way to work with global scopes. Now, the only thing we have to write is the following:Then, in your model, you can add the scope in the boot() method:To remove the global scope, simply use:Solution without extra scope classIf you don't like to have a whole class for the scope, you can (since Laravel 5.2) also define the global scope inline, in your model's boot() method:You can remove this global scope using this:Another way of doing this could be by overriding the newQuery method in your model class. This only works if you never, ever want results to be ordered by another field (since adding another ->orderBy() later won't remove this default one). So this is probably not what you'd normally want to do, but if you have a requirement to always sort a certain way, then this will work:In Laravel 5.7, you can now simply use addGlobalScope inside the model's boot function:In the above example, I order the model by created_at desc to get the most recent records first. You can change that to fit your needs.you should use eloquent global scope that can apply to all queries(also you can set parameter for it).And for relations you can use this useful trick:this will add order by to all posts when we get them from a category.

If you add an order by to your query, this default order by will cancel!An slightly improved answer given by Joshua Jabbouryou can use the code he offered in a Trait, and then add that trait to the models where you want them to be ordered.then in whichever model you want the data to be ordered you can use use :now everytime you request that model, data will be ordered, that's somehow more organized, but my answers is Jabbour's answer.A note from my experience, never to use orderBy and GroupBy such term on global scope. Otherwise you will easily face database errors while fetching related models in other places.Error may be something like:Thanks.

PHPUnit's returnValueMap not yielding expected results

Brad Koch

[PHPUnit's returnValueMap not yielding expected results](https://stackoverflow.com/questions/12748607/phpunits-returnvaluemap-not-yielding-expected-results)

I'm trying to use PHPUnit's returnValueMap() to stub out the results of a read.  It isn't yielding the expected results, but an equivalent returnCallback() does.  I've made my test case available if you'd like to inspect it yourself.returnValueMap()Results:returnCallback()Results:Enterprise::subscribeWhy doesn't returnValueMap() work as I expect it to?  What exactly am I missing?

2012-10-05 14:39:00Z

I'm trying to use PHPUnit's returnValueMap() to stub out the results of a read.  It isn't yielding the expected results, but an equivalent returnCallback() does.  I've made my test case available if you'd like to inspect it yourself.returnValueMap()Results:returnCallback()Results:Enterprise::subscribeWhy doesn't returnValueMap() work as I expect it to?  What exactly am I missing?I had the same problem and eventually found out that returnValueMap() has to map all parameters of your function, including optional ones, then the desired return value.Example function from Zend Framework:Has to mapped like this:Without the null in the middle, it won't work.I've been hunting down this same problem and eventually out of desperation xdebug-stepped through Framework/MockObject/Stub/ReturnValueMap.php and Framework/MockObject/InvocationMocker.php [in method InvocationMocker::invoke(PHPUnit_Framework_MockObject_Invocation $invocation) ], and I've observed the following points:The Problem seems to lie either somewhere else in the code or might be an issue with an old PHPUnit version.For me it works using this code:cat EnterpriseTest.phpOutput:So while I can't tell why it doesn't work I can at least tell you that you are doing it right and that you've understood returnValueMap correctly :)

Remove zero values from a PHP array

Elitmiar

[Remove zero values from a PHP array](https://stackoverflow.com/questions/2287404/remove-zero-values-from-a-php-array)

I have a normal array like thisI need to remove all 0's from this array, is this possible with a PHP array function

2010-02-18 09:10:15Z

I have a normal array like thisI need to remove all 0's from this array, is this possible with a PHP array functionarray_filter does that. If you don’t supply a callback function, it filters all values out that equal false (boolean conversion).You can just loop through the array and unset any items that are exactly equal to 0First Method:Second Method: Use array_diff functionbit late, but copy & paste:If you don't care about preserving key to data correlations, you can use this single line trick :You can use this:if you want to remove zero AND empty values, the right code is:This one is also an effective solution to remove unwanted value.    

PHP error. Why is「variable undefined」inside array_map?

Kanishka Panamaldeniya

[PHP error. Why is「variable undefined」inside array_map?](https://stackoverflow.com/questions/8891888/php-error-why-is-variable-undefined-inside-array-map)

I am using array_map function in my php application. 

I defined the array_map function like this.Php notice comes When i print the $ratingID . i prints the value correctly , so $ratingID is defined.

Why it is undfined in array_map function?

    My $rated_item_array is 

2012-01-17 08:57:27Z

I am using array_map function in my php application. 

I defined the array_map function like this.Php notice comes When i print the $ratingID . i prints the value correctly , so $ratingID is defined.

Why it is undfined in array_map function?

    My $rated_item_array is 

How to hide .php extension in .htaccess [duplicate]

adamhuxtable

[How to hide .php extension in .htaccess [duplicate]](https://stackoverflow.com/questions/8371634/how-to-hide-php-extension-in-htaccess)

I'm trying to hide the .php file extension but for some reason can't get it to work. My latest attempt was the following:I have tried many different variances of code I have found online but still no luck. The .htaccess file is placed within the root directory.

2011-12-03 22:40:28Z

I'm trying to hide the .php file extension but for some reason can't get it to work. My latest attempt was the following:I have tried many different variances of code I have found online but still no luck. The .htaccess file is placed within the root directory.I've used this:See also: this questionThe other option for using PHP scripts sans extension isOr even just following in the directories .htaccess:The latter allows having all filenames without extension script being treated as PHP scripts. While MultiViews makes the webserver look for alternatives, when just the basename is provided (there's a performance hit with that however).1) Are you sure mod_rewrite module is enabled? Check phpinfo()2) Your above rule assumes the URL starts with "folder". Is this correct? Did you acutally want to have folder in the URL? This would match a URL like:If you actually want You need to drop the folder from the match expression. I usually use this to route request to page without php (but yours should work which leads me to think that mod_rewrite may not be enabled):3) Assuming you are declaring your rules in an .htaccess file, does your installation allow for setting Options (AllowOverride) overrides in .htaccess files? Some shared hosts do not.

How to store repeating dates keeping in mind Daylight Savings Time

Dave

[How to store repeating dates keeping in mind Daylight Savings Time](https://stackoverflow.com/questions/19626177/how-to-store-repeating-dates-keeping-in-mind-daylight-savings-time)

I'm storing events in my database.  I have 'start' and 'end' date times, 'tickets_start' and 'tickets_end' (for when ticket sales actually start/end - as opposed to the start/end of the actual event).So far, I've built methods that do all the fun stuff like converting the date/times to GMT before saving, then back to their respective timezone for display.I'm storing the timezone in a varchar field with values like "America/New_York".But - now I need to start dealing with if the user wants to allow repeating events.  I've done it before, and it's not that big a deal, but never across multiple timezones.At first, I thought it'd be no big deal, but then realized that - if the initial start date was in July (as example), and it repeats every month for a year, at some point, Daylight Savings Time will make it so that the conversion from GMT will change a time differently.  One month, when converting 12:00, it would change it to -5, and the next, it would change it to -4 because of DST.My current thought is that I'll store a 'dst' tinyint(1) for whether the start/end dates were entered during DST, and then make a method to alter the time by an hour if/when necessary.But - figured I'd ask here in hopes maybe there's a "normal" for this or an easy something that I'm not thinking of.(cakephp 2.4.x)

2013-10-28 02:07:30Z

I'm storing events in my database.  I have 'start' and 'end' date times, 'tickets_start' and 'tickets_end' (for when ticket sales actually start/end - as opposed to the start/end of the actual event).So far, I've built methods that do all the fun stuff like converting the date/times to GMT before saving, then back to their respective timezone for display.I'm storing the timezone in a varchar field with values like "America/New_York".But - now I need to start dealing with if the user wants to allow repeating events.  I've done it before, and it's not that big a deal, but never across multiple timezones.At first, I thought it'd be no big deal, but then realized that - if the initial start date was in July (as example), and it repeats every month for a year, at some point, Daylight Savings Time will make it so that the conversion from GMT will change a time differently.  One month, when converting 12:00, it would change it to -5, and the next, it would change it to -4 because of DST.My current thought is that I'll store a 'dst' tinyint(1) for whether the start/end dates were entered during DST, and then make a method to alter the time by an hour if/when necessary.But - figured I'd ask here in hopes maybe there's a "normal" for this or an easy something that I'm not thinking of.(cakephp 2.4.x)First, please recognize that in modern terminology you should say UTC instead of GMT.  They are mostly equivalent, except that UTC is more precisely defined.  Reserve the term GMT to refer to the portion of the time zone in the United Kingdom that is in effect during the winter months having the offset UTC+0.Now to your question.  UTC is not necessarily the best way to store all date and time values.  It works particularly well for past events, or for future absolute events, but it doesn't work so great for future local events - especially future recurring events.I wrote about this on another answer recently, and is one of the few exception cases where local time makes more sense than UTC.  The main argument is the "alarm clock problem".  If you set your alarm clock by UTC, you'll be waking up an hour early or late on the day of the DST transitions.  This is why most folks set their alarm clocks by local time.Of course, you can't just store a local time if you are working with data from all over the world.  You should store a few different things:For the last two, understand that the UTC equivalent of any local date/time can change if the government responsible for that time zone decides to change anything.  Since there are multiple time zone database updates every year, you will want to have a plan to subscribe to announcements of updates and update your timezone database regularly.  Whenever you update your timezone data, you'll need to recalculate the UTC equivalent times of all future events.Having the UTC equivalents is important if you plan to show any kind of list of events spanning more than one time zone.  Those are the values you'll query to build that list.Another point to consider is that if an event is scheduled for a local time that occurs during a DST fall-back transition, you will have to decide whether the event occurs on the first instance (usually), or the second instance (sometimes), or both (rarely), and build into your application a mechanism to ensure the event doesn't fire twice unless you want it to.If you were looking for a simple answer - sorry, but there isn't one.  Scheduling future events across time zones is a complicated task.I've had a few people show me a technique where they do use UTC time for scheduling, which is that they pick a starting date in local time, convert that to UTC to be stored, and store the time zone ID as well.  Then at runtime, they apply the time zone to convert the original UTC time back to local time, then use that local time to compute the other recurrences, as if it were the one originally stored as above.While this technique will work, the drawbacks are:

Build a tree from a flat array in PHP

DSkinner

[Build a tree from a flat array in PHP](https://stackoverflow.com/questions/8840319/build-a-tree-from-a-flat-array-in-php)

I've looked around the internet and haven't quite found what I'm looking for. I have a flat array with each element containing an 'id' and a 'parent_id'. Each element will only have ONE parent, but may have multiple children. If the parent_id = 0, it is considered a root level item. I'm trying to get my flat array into a tree. The other samples I have found only only copy the element to the parent, but the original still exists.EDITEach element of the starting array is read from a separate XML file. The file itself will have '0' as the value for parent_id if it doesn't have a parent. The keys are actually strings.I'm sorry for the confusion earlier. Hopefully this is more clear:/EDITMy starting array:The resulting array after the tree is made:Any help / guidance is greatly appreciated!Some code I have so far:

2012-01-12 18:28:19Z

I've looked around the internet and haven't quite found what I'm looking for. I have a flat array with each element containing an 'id' and a 'parent_id'. Each element will only have ONE parent, but may have multiple children. If the parent_id = 0, it is considered a root level item. I'm trying to get my flat array into a tree. The other samples I have found only only copy the element to the parent, but the original still exists.EDITEach element of the starting array is read from a separate XML file. The file itself will have '0' as the value for parent_id if it doesn't have a parent. The keys are actually strings.I'm sorry for the confusion earlier. Hopefully this is more clear:/EDITMy starting array:The resulting array after the tree is made:Any help / guidance is greatly appreciated!Some code I have so far:You forgot the unset() in there bro.The solution by ImmortalFirefly is working, however, as mrded points out, it doesn't save first parents without children. I've edited the function to fix this issue:This works for me:I can see the logic, save for this in the result:IMHO, is parent_id = o, shouldn't [1] be a child of [0] here?Anyway, references to the rescue:Because you have abused 0 as both a 'magic' number as root, and an existing id, we now have recursion in the id=0 branch. Adding if($item['parent_id']!=$item['id']) before $tree[$item['parent_id']]['children'][] = &$tree[$item['id']]; could prevent that, but it isn't pretty.It's possible to construct the source array slightly different you can use this function(parent_id,id,title):Though this is an old question, I'm gonna post my answer here:array_column is PHP 5.5 but you can make your own easily.You want to be looking at storing and loading hierarchical data in MySQL as I this should solve a few problems. I'm assuming that the first array represents data taken directly from the database? It looks like you're trying to use the adjacency model to organize your data into the hierarchy structure. There are also other ways to achieve this using nesting. If you are not taking this data from a database then this may not be as useful.This link should help you out: http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/SteveEdson's code works fine, except in the case where the parent of an element does not exist in the original data structure. Here's my fix for that (however, it removes "parent_id" from elements, which may or may not be acceptable):Here is my solution, works ideally, if we assume that the top level parent_id=0:This is my solution, copy and optimize others solutions.Clean, short and free of ballast. Array of arrays to tree:I came up with a similar solution as @eugen-rieck and wanted to share it. I named $branches my array of indices, though.

Fatal error: Class 'Illuminate\Foundation\Application' not found

xenish

[Fatal error: Class 'Illuminate\Foundation\Application' not found](https://stackoverflow.com/questions/29764368/fatal-error-class-illuminate-foundation-application-not-found)

I am getting following error when I open my site which is made using laravel 5I have tried removing vendor folder and composer.lock file and running composer install it's not working I tried running PHP artisan optimize but it shows errorIs there any way to solve this problem?Edited:

This problem aroused as soon as I used the php artisan make:model Page command which did create the model but then the above error gets displayed when I access the site

Also If use the Larvel's Local Development Server no such problem arises only if I use wamp server

2015-04-21 06:19:41Z

I am getting following error when I open my site which is made using laravel 5I have tried removing vendor folder and composer.lock file and running composer install it's not working I tried running PHP artisan optimize but it shows errorIs there any way to solve this problem?Edited:

This problem aroused as soon as I used the php artisan make:model Page command which did create the model but then the above error gets displayed when I access the site

Also If use the Larvel's Local Development Server no such problem arises only if I use wamp serverIn my situation, I didn't have the full vendor dependencies in place (composer file was messed up during original install) - so running any artisan commands caused a failure.I was able to use the --no-scripts flag to prevent artisan from executing before it was included.  Once my dependencies were in place, everything worked as expected.Just in case I trip over this error in 2 weeks again...

My case: Checkout an existing project via git and pull in all dependencies via composer. Came down to the same error listed within the title of this post.Solution:make sure everything works now as expected (no errors!)Something is clearly corrupt in your Laravel setup and it is very hard to track without more info about your environment. Usually these 2 commands help you resolve such issuesIf nothing else helps then I recommend you to install fresh Laravel 5 app and copy your application logic over, it should take around 15 min or so.I had accidentally commented out:in

    /public/index.phpWhen pasting in some debugging statements.I just fixed this problem (Different Case with same error),

The answer above I tried may not work because My case were different but produced the same error.

I think my vendor libraries were jumbled,

I get this error by:

1. Pull from remote git, master branch is codeigniter then  I do composer update on master branch, I wanted to work on laravel branch then I checkout and do composer update so I get the error, Solution:

I delete the project on local and do a clone again, after that I checkout to my laravel file work's branch and do composer update then it is fixed.1.first open command prompt(cmd==>window+r) and go to the location where laravel

  installed.2.try==>'composer require laravel/laravel'For latest laravel version also check your version because I was also

facing this error but after update latest php version, I got rid from

this error.

array_flip():Can only flip STRING and INTEGER values! in DrupalDefaultEntityController->load()

Ajinkya Kulkarni

[array_flip():Can only flip STRING and INTEGER values! in DrupalDefaultEntityController->load()](https://stackoverflow.com/questions/4798047/array-flipcan-only-flip-string-and-integer-values-in-drupaldefaultentitycont)

I have recently migrated my module to Drupal7 (on PHP Version 5.3.1) and now I am getting following errors:I have also tried upgrading other modules and core to latest versions as mentioned here http://drupal.org/node/1022736entity 7.x-1.x-dev (2011-Jan-24),

views 7.x-3.x-dev (2011-Jan-22),

Drupal core 7.x-dev (2011-Jan-24),

profile2 7.x-1.0-beta1,

references 7.x-2.x-dev (2011-Jan-14),

ctools 7.x-1.0-alpha2I am not able to figure out what is exactly causing this error?Edit:According to http://php.net/manual/en/function.array-flip.php,   I have done the var_dump($ids); before line 178 in entity.inc ( $passed_ids = !empty($ids) ? array_flip($ids) : FALSE;)And it looks to me that key/value pair is always in correct format(?).

2011-01-25 19:40:27Z

I have recently migrated my module to Drupal7 (on PHP Version 5.3.1) and now I am getting following errors:I have also tried upgrading other modules and core to latest versions as mentioned here http://drupal.org/node/1022736entity 7.x-1.x-dev (2011-Jan-24),

views 7.x-3.x-dev (2011-Jan-22),

Drupal core 7.x-dev (2011-Jan-24),

profile2 7.x-1.0-beta1,

references 7.x-2.x-dev (2011-Jan-14),

ctools 7.x-1.0-alpha2I am not able to figure out what is exactly causing this error?Edit:According to http://php.net/manual/en/function.array-flip.php,   I have done the var_dump($ids); before line 178 in entity.inc ( $passed_ids = !empty($ids) ? array_flip($ids) : FALSE;)And it looks to me that key/value pair is always in correct format(?).The most common cause of this error is using a something_load() function with an array as argument. This is not supported anymore because the load_multiple() functions need to be used for this now.Example in D6:Drupal 7:So, the easiest way to catch these is to search for "_load(array".I ran into the same array_flip error over the weekend, trying to upgrade a custom module to Drupal 7. The problem is that a nested array is getting passed into DrupalDefaultEntityController, but it's expecting a simple array of integers or strings. In my case, I was passing in a nested array in to EntityFieldQuery, when it wants just an array of integers.To better track down the code that is calling DrupalDefaultEntityController, try inserting the following before line 178 in entity.inc:... or preferably, install the Devel module and try inserting the following instead:The problem comes up when you're using Organic groups field access (Organic Groups 7.x-1.3)You can usually disable that sub-module unless you do field level access control with OG.http://drupal.org/node/1102570#comment-5626946This can also happen when you call entity_load with an array that is not an array of entity id's as the second argument - see http://api.drupal.org/api/drupal/includes--common.inc/function/entity_load/7 and http://drupal.org/node/1160566 to understand why.Saw a similar issue in our usage of the latest page_title module.  For now, we just disabled the module and it cleaned up the error.See: http://www.newblood.com/blog/2011/04/26/drupal-7-error-in-page-title-module/Are you using Insert Module? See http://drupal.org/node/850946.When it comes to specific errors like this, I think you're better off searching the issue queue at drupal.org than asking on SO.Example of good use:This could be problem of the bad coding (e.g. loading invalid entities or running some old Drupal 6 code in Drupal 7): Troubleshooting:Alternatively you may debug your code by defining the following temporary hook:Clear the cache before testing it.It'll print the backtrace on every PHP warning or error with arguments, so you can find your invalid parameters which were passed into the Drupal core.I've also gotten this message when erroneously trying to load multiple nodes via node_load_multiple($nids) where $nids was not an array of node-ids.For example, using the result of an EntityFieldQuery, and calling node_load_multiple($result['node']) instead of node_load_multiple(array_keys($result['node'])).Thanks for the post it worked for me!, I was encountering with this problem in Drupal 7 since long time and could fighure out the problem. Bottom line "Do not pass array values to array_flip for any kind of entities,

eg: If you are trying to load and entity user_load() or field_collection_item_load() for loading field collection items, Pass only values in the string rather than array itself."Thanks!!Here is simple solution :)Edit settings.php file and add this line

Remove all the line breaks from the html source

mrN

[Remove all the line breaks from the html source](https://stackoverflow.com/questions/5258543/remove-all-the-line-breaks-from-the-html-source)

Well I know obfuscation is a bad idea. But I want all of my html code to come in one long single line. All the html tags are generated through PHP, so I think its possible. I knew replacing \n\r from regular expression, but have no idea how to do this one. In case I am unclear here is an exampleTo be view in the source viewer as <p><div class="title">Hello</div></p>

2011-03-10 10:44:45Z

Well I know obfuscation is a bad idea. But I want all of my html code to come in one long single line. All the html tags are generated through PHP, so I think its possible. I knew replacing \n\r from regular expression, but have no idea how to do this one. In case I am unclear here is an exampleTo be view in the source viewer as <p><div class="title">Hello</div></p>Maybe this?You can try this perhaps.This should, unless I messed up the regex, catch all output, and then replace all new line characters as well as all whitespace at the end and beginning of lines.If you already have all output collected in a variable, you can of course just use the last line directly and skip the output buffering stuff :)Worked for me:You can do :This way, $output won't contain any line jump.This should also work :This is already well answered, but you may be able to do more than just trim spaces at both ends of each line:This procedure can potentially compact the entire HTML file. This takes advantage of the fact that multiple white-space text inside HTML tags are intepreted as one single space.This is a (as far as I have tested) working implementation of Stephen Chung's instructions. I'm not entirely convinced by number five, but have included it anyway.Put the things you want to protect in the protected_parts array. Do it in order that you want them protected. If the starting and ending bits are different (as they would be in HTML tags), separate them by using a comma.Also, I've no idea if this is the most optimised way of doing this, but it works for me and seems reasonably fast. Feel free to improve, etc. (Let me know if you do too!)This is an improved function of the above. It adds text area protection and also anything that is a tag remains untouched.I also removed strlen in the loop (its static).This might run faster as a one pass filter to check for any of the protected parts. For such a small protected_parts array it's going to be more efficient than looping through the $str four times.Also this doesn't fix: class = " " (the extra spaces between = and ") as its stuff inside the tags.You can't have <div> inside <p> - it is not spec-valid.If you don't need to store it in a variable you can use this:

Cannot Initialize mbstring with PHP 7

NoahMCM

[Cannot Initialize mbstring with PHP 7](https://stackoverflow.com/questions/34471633/cannot-initialize-mbstring-with-php-7)

Whenever I try to access phpMyAdmin, I receive the following error:"The mbstring extension is missing. Please check your PHP configuration."I am running a LEMP stack on a CentOS 7 server. I have elected to use PHP 7 for this installation. I have not experienced this error on identical set-ups running earlier versions of PHP.extension_loaded('mbstring') returns false even though mbstring.ini (/etc/php.d/) contains:I am 100% sure that the mbstring module is installed on my server.I'm completely stumped so if anyone has any ideas whatsoever, please let me know. Thanks.

2015-12-26 13:10:39Z

Whenever I try to access phpMyAdmin, I receive the following error:"The mbstring extension is missing. Please check your PHP configuration."I am running a LEMP stack on a CentOS 7 server. I have elected to use PHP 7 for this installation. I have not experienced this error on identical set-ups running earlier versions of PHP.extension_loaded('mbstring') returns false even though mbstring.ini (/etc/php.d/) contains:I am 100% sure that the mbstring module is installed on my server.I'm completely stumped so if anyone has any ideas whatsoever, please let me know. Thanks.For those who have debian : Otherwise in centos (tested in centos 6.6)and as  @mpen said you can activate itA solution was reached with the following method:I put extension=mbstring.so inside php.ini even though that is no longer the method PHP uses by default to load modules.From php.ini itself:It seemed to fix my problem. I would still be interested to hear if anyone else has a different take on this matter.For PHP7 on centostry this yum install php70-mbstringI had this problem for a long time.

I found the correct way (for me) to correct it... and it's fairly simple :)Juste add "universe" on the xenial-updatesrun sudo apt-get update, sudo apt-get upgrade before installing with sudo apt-get install php-mbstring.I had the same problem today and found this way.

How can I call a static method on a variable class?

talentedmrjones

[How can I call a static method on a variable class?](https://stackoverflow.com/questions/642391/how-can-i-call-a-static-method-on-a-variable-class)

I'm trying to make some kind of function that loads and instantiates a class from a given variable. Something like this:If I use it like this:It should include and instantiate the session class.BTW: the static getInstance function comes from this code:The thing is that right now the way to use the functions in a class is this:But now I want to build that into a function so that I never again have to use that line of code.

I just say loadClass('session');

and than I can use $session->blablablafunction();

2009-03-13 12:13:43Z

I'm trying to make some kind of function that loads and instantiates a class from a given variable. Something like this:If I use it like this:It should include and instantiate the session class.BTW: the static getInstance function comes from this code:The thing is that right now the way to use the functions in a class is this:But now I want to build that into a function so that I never again have to use that line of code.

I just say loadClass('session');

and than I can use $session->blablablafunction();Calling static functions on a variable class name is apparently available in PHP 5.3:http://php.net/manual/en/language.oop5.static.phpCould definitely use that right now myself.Until then you can't really assume that every class you are loading is designed to be a singleton. So long as you are using < 5.3 you'll have to just load the class and instantiate via the constructor:}ORJust load the class without creating an object from it. Then call "::getInstance()" on those meant to be singletons, and "new" on those that are not, from outside of the loadClass() function.Although, as others have pointed out earlier, an __autoload() would probably work well for you.You can use call_user_func():The first argument is a callback type containing the classname and method name in this case.Why not use __autoload() function?http://www.php.net/autoloadthen you just instantiate object when needed.It looks like you are fighting PHP's current implementation static binding, which is why you are jumping through hoops with getCallingClass.  I can tell you from experience, you should probably abandon trying to put instantiation in a parent class through a static method.  It will cause you more problems in the end. PHP 5.3 will implement "late static binding" and should solve your problem, but that obviously doesn't help now. You are probably better off using the autoload functionality mentioned by kodisha combined with a solid Singleton implementation.  I'm not sure if your goal is syntactic sugar or not, but it think you will do better in the long run to steer clear of trying to save a few characters.Off the top of my head, needs testing, validation etc:Late static bindings will work for you I think. In the construct of each class do:Then...

Here is an autoloader I created. See if this solves your dilemma.Then all you have to do isbut you have to have a php file in the path with the name

    ClassName.php

where ClassName is the same as the name of the class you want to instantiate.

Complex WHERE clauses using the PHP Doctrine ORM

Wickethewok

[Complex WHERE clauses using the PHP Doctrine ORM](https://stackoverflow.com/questions/1049617/complex-where-clauses-using-the-php-doctrine-orm)

I'm using the PHP Doctrine ORM to build my queries.  However, I can't quite seem to figure how to write the following WHERE clause using DQL (Doctrine Query Language):How can I specify where the parentheses go?What I currently have in my PHP code is this:But this produces something likewhich, due to order of operations, doesn't return the intended results.Also, is there a difference between the "where", "andWhere", and "addWhere" methods?UPDATE

Ok, it seems like you can't do complex queries using DQL, so I've been trying to write the SQL manually and use the andWhere() method to add it.  However, I'm using WHERE..IN and Doctrine seems to be stripping out my enclosing parentheses:

2009-06-26 15:04:31Z

I'm using the PHP Doctrine ORM to build my queries.  However, I can't quite seem to figure how to write the following WHERE clause using DQL (Doctrine Query Language):How can I specify where the parentheses go?What I currently have in my PHP code is this:But this produces something likewhich, due to order of operations, doesn't return the intended results.Also, is there a difference between the "where", "andWhere", and "addWhere" methods?UPDATE

Ok, it seems like you can't do complex queries using DQL, so I've been trying to write the SQL manually and use the andWhere() method to add it.  However, I'm using WHERE..IN and Doctrine seems to be stripping out my enclosing parentheses:From my experience, each complex where function is grouped within parenthesis (I'm using Doctrine 1.2.1).produces the following SQL:The correct way of doing this can be found at doctrine 2 - query builder conditional queries... If statements? as noted by @Jekis. Here is how to use the expression builder to solve this like in @anushr's example.As it seems like you can't do complex queries using DQL, I wrote the following SQL to pass to the andWhere() method:Note the "AND TRUE", a hack so that the parser wouldn't ignore the outer parentheses.andWhere can be summarized as:

Previously Added Condition(s) Aware WHERE StatementYou can safely use andWhere inplace of where. (it introduces a very tiny overhead, which is stated below in the 2nd list item.)The implementation of andWhere is: (Doctrine 1.2.3)which can be read as,As for the difference between where, andwhere, and addwhere, i don't believe there is a significant difference from the last time i read the source.  I would encourage you to read the Doctrine source, however.  It's really simple, and helps fills in the holes in the documentation (there are many).  As for complex where statements, I've wondered this myself but haven't had a need for it yet.In my experience, I have sometimes seen a difference between :andThe first statement is written on 3 lines, the second, on only one. I didn't believe it but THERE IS A DIFFERENCE !would you be so kind to try this variant, not sure if it works, but worth a shot

Convert this string to datetime [duplicate]

emeraldhieu

[Convert this string to datetime [duplicate]](https://stackoverflow.com/questions/8063057/convert-this-string-to-datetime)

How to convert this string to datetime format?

06/Oct/2011:19:00:02I tried this but it doesn't work.

2011-11-09 09:45:13Z

How to convert this string to datetime format?

06/Oct/2011:19:00:02I tried this but it doesn't work.Use DateTime::createFromFormatThe Problem is with your code formatting,inorder to use strtotime() You should replace '06/Oct/2011:19:00:02' with 06/10/2011 19:00:02 and date('d/M/Y:H:i:s', $date); with date('d/M/Y H:i:s', $date);. Note the spaces in between.So the final code looks like this

PHP syntax highlighting [closed]

Konrad Rudolph

[PHP syntax highlighting [closed]](https://stackoverflow.com/questions/230270/php-syntax-highlighting)

I'm searching for a PHP syntax highlighting engine that can be customized (i.e. I can provide my own tokenizers for new languages) and that can handle several languages simultaneously (i.e. on the same output page). This engine has to work well together with CSS classes, i.e. it should format the output by inserting <span> elements that are adorned with class attributes. Bonus points for an extensible schema.I do not search for a client-side syntax highlighting script (JavaScript).So far, I'm stuck with GeSHi. Unfortunately, GeSHi fails abysmally for several reasons. The main reason is that the different language files define completely different, inconsistent styles. I've worked hours trying to refactor the different language definitions down to a common denominator but since most definition files are in themselves quite bad, I'd finally like to switch.Ideally, I'd like to have an API similar to CodeRay, Pygments or the JavaScript dp.SyntaxHighlighter.I'm looking for a code highlighting software written in PHP, not for PHP (since I need to use it from inside PHP).

2008-10-23 15:46:20Z

I'm searching for a PHP syntax highlighting engine that can be customized (i.e. I can provide my own tokenizers for new languages) and that can handle several languages simultaneously (i.e. on the same output page). This engine has to work well together with CSS classes, i.e. it should format the output by inserting <span> elements that are adorned with class attributes. Bonus points for an extensible schema.I do not search for a client-side syntax highlighting script (JavaScript).So far, I'm stuck with GeSHi. Unfortunately, GeSHi fails abysmally for several reasons. The main reason is that the different language files define completely different, inconsistent styles. I've worked hours trying to refactor the different language definitions down to a common denominator but since most definition files are in themselves quite bad, I'd finally like to switch.Ideally, I'd like to have an API similar to CodeRay, Pygments or the JavaScript dp.SyntaxHighlighter.I'm looking for a code highlighting software written in PHP, not for PHP (since I need to use it from inside PHP).Since no existing tool satisfied my needs, I wrote my own. Lo and behold:Usage is extremely easy: just useto highlight code. Writing new language definitions is relatively easy, too – using regular expressions and a powerful but simple state machine. By the way, I still need a lot of definitions so feel free to contribute.[I marked this answer as Community Wiki because you're specifically not looking for Javascript]http://softwaremaniacs.org/soft/highlight/ is a PHP (plus the following list of other languages supported) syntax highlighting library:It uses <span class="keyword"> style markup.It has also been integrated in the dojo toolkit (as a dojox project: dojox.lang.highlight)Though not the most popular way to run a webserver, strictly speaking, Javascript is not only implemented on the client-side, but there are also Server-Side Javascript engine/platform combinations too.I found this simple generic syntax highlighter written in PHP here and modified it a bit:Demo: http://phpfiddle.org/lite/code/1sf-htnI just created a PHP port of my own JavaScript generic syntax highlighter here → https://github.com/tovic/generic-syntax-highlighter/blob/master/generic-syntax-highlighter.phpHow to use:It might be worth looking at Pear_TextHighlighter (documentation)I think it won't by default output html exactly how you want it, but it does provide extensive capabilities for customisation (i.e. you can create different renderers/parsers)I had exactly the the same problem but as I was very short on time and needed really good code coverage I decided to write a PHP wrapper around Pygments library.It's called PHPygmentizator. It's really simple to use. I wrote a very basic manual. As PHP is Web Development language primarily, I subordinated the structure to that fact and made it very easy to implement in almost any kind of website.It supports configuration files and if that isn't enough and somebody needs to modify stuff in the process it also fires events.Demo of how it works can be found on basically any post of my blog which contains source code, this one for example.With default config you can just provide it a string in this format:So it highlights code between tags (tags can be customized in configuration file) and leaves the rest untouched.Additionally I already made a Syntax recognition library (it uses algorithm which would probably be classified as Bayesian probability) which automatically recognizes which language code block is written in and can easily be hooked to one of PHPygmentizator events to provide automatic language recognition. I will probably make it public some time this week since I need to beautify the structure a bit and write some basic documentation. If you supply it with enough "learning" data it recognizes languages amazingly well, I tested even minified javascripts and languages which have similar keywords and structures and it has never made a mistake.Another option is to use the GPL Highlight GUI program by Andre Simon which is available for most platforms. It converts PHP (and other languages) to HTML, RTF, XML, etc. which you can then cut and paste into the page you want. This way, the processing is only done once.The HTML is also CSS based, so you can change the style as you please.Personally, I use dp.SyntaxHighlighter, but that uses client side Javascript, so it doesn't meet your needs. It does have a nice Windows Live plugin though which I find useful.A little late to chime in here, but I've been working on my own PHP syntax highlighting library.  It is still in its early stages, but I am using it for all code samples on my blog.Just checked out Hyperlight.  It looks pretty cool, but it is doing some pretty crazy stuff.  Nested loops, processing line by line, etc.  The core class is over 1000 lines of code.  If you are interested in something simple and lightweight check out Nijikodo:

http://www.craigiam.com/nijikodoWhy not use PHP's build-in syntax highlighter?http://php.net/manual/en/function.highlight-string.phpPHP Prettify Works fine so far, And has more customization than highlight_string Krijn Hoetmer's PHP Highlighter provides a completely customizable PHP class to highlight PHP syntax. The HTML it generates, validates under a strict doctype, and is completely stylable with CSS.

Using XML node names with hyphens in PHP [duplicate]

williamsdb

[Using XML node names with hyphens in PHP [duplicate]](https://stackoverflow.com/questions/3634599/using-xml-node-names-with-hyphens-in-php)

I am trying to extract some data from XML but when I execute the following I get a Code Example:It works fine for node names that are single words so I am guessing that it doesn't like the hyphens. Do I need to escape them and if so how?

2010-09-03 09:48:13Z

I am trying to extract some data from XML but when I execute the following I get a Code Example:It works fine for node names that are single words so I am guessing that it doesn't like the hyphens. Do I need to escape them and if so how?From PHP manual:In your case you do:

Insert PHP code In WordPress Page and Post

Prince

[Insert PHP code In WordPress Page and Post](https://stackoverflow.com/questions/18896146/insert-php-code-in-wordpress-page-and-post)

I want to know Visitor country using PHP and display it in to a WordPress Page.But when I add PHP code in WordPress page or Post it give me error.

How can we add PHP code in  WordPress Page and Post.

2013-09-19 13:35:35Z

I want to know Visitor country using PHP and display it in to a WordPress Page.But when I add PHP code in WordPress page or Post it give me error.

How can we add PHP code in  WordPress Page and Post.WordPress does not execute PHP in post/page content by default unless it has a shortcode.The quickest and easiest way to do this is to use a plugin that allows you to run PHP embedded in post content.There are two other "quick and easy" ways to accomplish it without a plugin:You can't use PHP in the WordPress back-end Page editor. Maybe with a plugin you can, but not out of the box.The easiest solution for this is creating a shortcode. Then you can use something like thisSee the Shortcode_API.You can create separate page template for this or you can use this plugin http://wordpress.org/plugins/exec-php/creating page template is good option.When I was trying to accomplish something very similar, I ended up doing something along these lines:wp-content/themes/resources/functions.php

Does php execution stop after a user leaves the page?

Stephen Belanger

[Does php execution stop after a user leaves the page?](https://stackoverflow.com/questions/1280291/does-php-execution-stop-after-a-user-leaves-the-page)

I want to run a relatively time consuming script based on some form input, but I'd rather not resort to cron, so I'm wondering if a php page requested through ajax will continue to execute until completion or if it will halt if the user leaves the page.It doesn't actually output to the browser until a json_encode at the end of the file, so would everything before that still execute?

2009-08-14 21:22:34Z

I want to run a relatively time consuming script based on some form input, but I'd rather not resort to cron, so I'm wondering if a php page requested through ajax will continue to execute until completion or if it will halt if the user leaves the page.It doesn't actually output to the browser until a json_encode at the end of the file, so would everything before that still execute?It depends.From http://us3.php.net/manual/en/features.connection-handling.php:That would seem to say the answer to your question is "Yes, the script will terminate if the user leaves the page".However realize that depending on the backend SAPI being used (eg, mod_php), php cannot detect that the client has aborted the connection until an attempt is made to send information to the client. If your long running script does not issue a flush() the script may keep on running even though the user has closed the connection.Complicating things is even if you do issue periodic calls to flush(), having output buffering on will cause those calls to trap and won't send them down to the client until the script completes anyway!Further complicating things is if you have installed Apache handlers that buffer the response (for example mod_gzip) then once again php will not detect that the connection is closed and the script will keep on trucking.Phew.It depends on your settings - usually it will stop but you can use ignore_user_abort() to make it carry on.Depending on the configuration of the web server and/or PHP, the PHP process may, or may not, kill the thread when the user terminates the HTTP connection. If an AJAX request is pending when the user walks away from the page, it is dependent on the browser killing the request (not guaranteed) ontop of your server config (not guaranteed). Not the answer you want to hear!I would recommend creating a work queue in a flat file or database that a constantly-running PHP daemon can poll for jobs. It doesn't suffer from cron delay but keeps CPU/memory usage to a usable level. Once the job is complete, place the results in the flat file/database for AJAX fetch. Or promise to e-mail the user once the job is finished (my preferred method).Hope that helpsIf the client/user/downloader/viewer aborts or disconnects, the script will keep running until something tries do flush new data do the client. Unless you have used 

ignore_user_abort(), the script will die there.

In the same order, PHP is unable to determine if client is still there without trying to flush any data to the httpd.found the actual solution for my case of it not terminating the connection. The SESSION on my Apache/Php server needed to close before the next one could start.Browser waits for ajax call to complete after abort.

An example of an MVC controller

BDuelz

[An example of an MVC controller](https://stackoverflow.com/questions/1737868/an-example-of-an-mvc-controller)

I have been reading a lot about how and why to use an MVC approach in an application. I have seen and understand examples of a Model, I have seen and understand examples of the View.... but I am STILL kind of fuzzy on the controller. I would really love to see a thorough enough example of a controller(s). (in PHP if possible, but any language will help)Thank you.PS: It would also be great if I could see an example of an index.php page, which decides which controller to use and how.EDIT: I know what the job of the controller is, I just don't really understand how to accomplish this in OOP.

2009-11-15 15:40:35Z

I have been reading a lot about how and why to use an MVC approach in an application. I have seen and understand examples of a Model, I have seen and understand examples of the View.... but I am STILL kind of fuzzy on the controller. I would really love to see a thorough enough example of a controller(s). (in PHP if possible, but any language will help)Thank you.PS: It would also be great if I could see an example of an index.php page, which decides which controller to use and how.EDIT: I know what the job of the controller is, I just don't really understand how to accomplish this in OOP.Request examplePut something like this in your index.php:Really basic, but you get the idea... (I also didn't take care of loading the controller class, but I guess that can be done either via autoloading or you know how to do it.)Simple controller example (controllers/login.php):As you see, the controller takes care of the "flow" of the application - the so-called application logic. It does not take care about data storage and presentation. It rather gathers all the necessary data (depending on the current request) and assigns it to the view...Note that this would not work with any framework I know, but I'm sure you know what the functions are supposed to do.Imagine three screens in a UI, a screen where a user enters some search criteria, a screen where a list of summaries of matching records is displayed and a screen where, once a record is selected it is displayed for editing. There will be some logic relating to the initial search on the lines ofWhere should that logic go? Not in the view or model surely? Hence this is the job of the controller. The controller would also be responsible for taking the criteria and invoking the Model method for the search.Please check this:

Can I declare that a php function throws an exception?

shay

[Can I declare that a php function throws an exception?](https://stackoverflow.com/questions/3325294/can-i-declare-that-a-php-function-throws-an-exception)

Can I declare a function in php 

that throws an exception? 

For example: 

2010-07-24 13:34:21Z

Can I declare a function in php 

that throws an exception? 

For example: I misread the question, see the answer below from Gilad (which should be accepted).Previous answer:You could throw a new exception from the body of the function. It's all described hereExample:You can use @throws in the PHPDoc comment, and the IDE will recognize this function as throwing an exception, when viewing the doc, however unlike Java it will not force you to implement the Try{}catch block. Maybe future versions of the IDE (I am using InteliJ 11) will mark those places where try{}catch is expected, that same as it already do with the JavaScript types marked by doc (e.g. String}) when recognizing inconsistency. In short, using Doclet like when codding with scripting languages (PHP, JavaScript..), is turn to be complementary tool for safer programming in the case of non type-safe and non compiled languages.    like this:For a list of exceptions that come with the SPL: SPL Exceptions.If you want to create your own exception: From the PHP Exceptions page:So yes, it is possible to create your own exceptions. Just a bit of reading will help you achieve what you want.

Check if variable is a valid date with PHP

Alex

[Check if variable is a valid date with PHP](https://stackoverflow.com/questions/10691949/check-if-variable-is-a-valid-date-with-php)

I am working on a script that will import some data from a CSV file. As I am doing this I want to be able to check a variable to see if it is a valid date string. I have seen several ways to check if a sting is a date, but most of them require you to now the format. I will not know the format that the date will in. right now I am using strtotime(), but this fails to easily In this case, "May" was the persons first name, and not a date at all. Can any one recommend more reliable function? Edit based on questions from some of you. For a variable to pass as a "date" in my case, it would need to be specific to a day/month/year, so just "May" would be to vague to count. Based on that and Pauls good point below we can also test to see if the string contains a number, such as This seems to cover my immediate needs, but can any one spot any issues or suggest improvements? 

2012-05-21 20:13:29Z

I am working on a script that will import some data from a CSV file. As I am doing this I want to be able to check a variable to see if it is a valid date string. I have seen several ways to check if a sting is a date, but most of them require you to now the format. I will not know the format that the date will in. right now I am using strtotime(), but this fails to easily In this case, "May" was the persons first name, and not a date at all. Can any one recommend more reliable function? Edit based on questions from some of you. For a variable to pass as a "date" in my case, it would need to be specific to a day/month/year, so just "May" would be to vague to count. Based on that and Pauls good point below we can also test to see if the string contains a number, such as This seems to cover my immediate needs, but can any one spot any issues or suggest improvements? Use date_parse and check the values of the returned arrayYou can also pass those into checkdate.I don't think there is a all-in-one answer to this problem. You may have different strategy depending on your use case.Your strtotime() is a perfect solution, but as you say, you may end up with false positive. Why? Because may may be a word or a name. However, what is the result of strtotime('May')?So giving only the month will return a date of the current year and the current day starting at midnight with the given month. A possible solution would be to check if your string has the current day and/or the current year included, this way, you may check against to make sure your date is a fully qualified date and valid.A simple strpos() or even a regex should do the trick.However it is a bit odd and should be used only if you have no other way to do.I believe that a better solution would be to define a set of valid format and interpolate the result to make sure that the date is valid.You should try to cover most of the case and I'm sure you will be able to find regex that checks for most current date format.In any case, you may need to adapt your function from time to time because there is no easy way to make it bulletproof.I know this was asked a long time ago, but looking around for this and trying to avoid regex, I came up with this:This works because it takes away the issues posted above where only a month is passed into strtotime by making sure there are numbers in the string with strpbrk as well as verifying strtotime outputs a date. And learned about a function I didn't know existed.Hope this helps someone.

How to read the response effective URL in Guzzle ~6.0

joserobleda

[How to read the response effective URL in Guzzle ~6.0](https://stackoverflow.com/questions/30682307/how-to-read-the-response-effective-url-in-guzzle-6-0)

I've been searching for about 2 hours and I can't figure it out how to read the final response uri.In previous versions of PHP Guzzle you just call $response->getEffectiveUrl() and you get it.I expected to have something similar in the new version so the final code looks like this:But in the latest version $response is now a GuzzleHttp\Psr7\Response and there is no method which allow me to retrieve the uri.I read about the redirects here (http://guzzle.readthedocs.org/en/latest/quickstart.html#redirects) but it says nothing abouthttps://stackoverflow.com/a/35443523/1811887Thanks @YauheniPrakopchyk

2015-06-06 11:31:48Z

I've been searching for about 2 hours and I can't figure it out how to read the final response uri.In previous versions of PHP Guzzle you just call $response->getEffectiveUrl() and you get it.I expected to have something similar in the new version so the final code looks like this:But in the latest version $response is now a GuzzleHttp\Psr7\Response and there is no method which allow me to retrieve the uri.I read about the redirects here (http://guzzle.readthedocs.org/en/latest/quickstart.html#redirects) but it says nothing abouthttps://stackoverflow.com/a/35443523/1811887Thanks @YauheniPrakopchykGuzzle 6.1 solution right from the docs.You can check what redirects your request had byt setting track_redirects parameter:If there were any redirects last one should be your effective url otherewise your initial url.You can read more about allow_redirects here http://docs.guzzlephp.org/en/latest/request-options.html#allow-redirects.I am using middleware to track requests in the redirect chain and save the last one. The uri of the last request is what you want.Try this code:Result:Example with class:I think it's best to use response headers to store this information. I wrote a simple class that saves effective url in X-GUZZLE-EFFECTIVE-URL header:Usage:Accepted answer didn't work for me but led me on the way:You need to add track_redirects explicitly in your Guzzle client. The $redirects may contains...0 element, if no redirect.1..n elements, if one or more redirects.I'm not an expert in the subject but, from what I understand, the effective url is not something that is defined in a general HTTP message. I think is is something related to Curl and since Guzzle can use any HTTP handler to send requests (see here), the information is not necessarily present.

Can I mock an interface implementation with PHPUnit?

Dmitry Minkovsky

[Can I mock an interface implementation with PHPUnit?](https://stackoverflow.com/questions/18972901/can-i-mock-an-interface-implementation-with-phpunit)

I've got an interface I'd like to mock. I know I can mock an implementation of that interface, but is there a way to just mock the interface?What I get here is:Interestingly, PHPUnit, mocked interfaces, and instanceof would suggest this might work.

2013-09-24 04:19:43Z

I've got an interface I'd like to mock. I know I can mock an implementation of that interface, but is there a way to just mock the interface?What I get here is:Interestingly, PHPUnit, mocked interfaces, and instanceof would suggest this might work.Instead of useorTotally works!The following works for me:The setMockClassName() can be used to fix this in some circumstances.

What is a good setup for editing PHP in Emacs?

haxney

[What is a good setup for editing PHP in Emacs?](https://stackoverflow.com/questions/912671/what-is-a-good-setup-for-editing-php-in-emacs)

I'm going to be doing some PHP editing for my job this summer, and am looking for an effective Emacs setup for editing it. I'm already heavily invested in Emacs, so switching to another editor is not worthwhile.Right now, I have nXhtml-mode, which provides a PHP mode with syntax highlighting (there are at least three different ones in the wild) as well as MuMaMo for editing PHP embedded in HTML. I just started using Auto-Complete and Anything for programming and general Emacs stuff, respectively.What I'm really looking for is an effective way to get Emacs to really understand the project, beyond just highlighting. Etags looks like a good option, but it looks like the process for generating new tags is kind of arduous and manual (or at least not invisible). The nice thing about Etags is that they integrate well with Anything and Auto-Complete. Other potential options are gtags (though I'm hesitant to install non-elisp files, just for the complexity), vtags, or Semantic, which I've messed with before and seems complicated to set up, plus it doesn't look like it has support for PHP.Another option is Imenu, but it only works for the current buffer, and I would like to be able to jump to function definitions in other files (preferably using Anything for completion of the name).The projects I will be working on are not that big (about 30,000 lines total), so the overhead of Etags probably won't be that big of an issue, but I'd rather not use it if there is a better solution.So what is your preferred PHP editing system?

2009-05-26 20:46:40Z

I'm going to be doing some PHP editing for my job this summer, and am looking for an effective Emacs setup for editing it. I'm already heavily invested in Emacs, so switching to another editor is not worthwhile.Right now, I have nXhtml-mode, which provides a PHP mode with syntax highlighting (there are at least three different ones in the wild) as well as MuMaMo for editing PHP embedded in HTML. I just started using Auto-Complete and Anything for programming and general Emacs stuff, respectively.What I'm really looking for is an effective way to get Emacs to really understand the project, beyond just highlighting. Etags looks like a good option, but it looks like the process for generating new tags is kind of arduous and manual (or at least not invisible). The nice thing about Etags is that they integrate well with Anything and Auto-Complete. Other potential options are gtags (though I'm hesitant to install non-elisp files, just for the complexity), vtags, or Semantic, which I've messed with before and seems complicated to set up, plus it doesn't look like it has support for PHP.Another option is Imenu, but it only works for the current buffer, and I would like to be able to jump to function definitions in other files (preferably using Anything for completion of the name).The projects I will be working on are not that big (about 30,000 lines total), so the overhead of Etags probably won't be that big of an issue, but I'd rather not use it if there is a better solution.So what is your preferred PHP editing system?In addition to features you are already familiar with, I suggest you the followings.I do not use ETags, but there is a question already on SO How to programmatically create/update a TAGS file with emacs. No good answer was posted, though, but it may be a good entry point to get an idea.Flymake is a mode to get on the fly syntax checking. It has support for PHP as well. It hints at syntax errors immediately as you type. The Flymake version shipped with Emacs 23 contains PHP support. If you have previous version, check Sacha Chua's post on Emacs and PHP: On-the-fly syntax checking with Flymake.Another useful package is Geben that allows you to debug your scripts interactively. For PHP, you can use XDebug. There is a detailed tutorial on how to do that, see Debug php in emacs with geben.PHP Mode has a nice feature to lookup the function's definition in PHP's manual in your web browser (M-x php-search-documentation or C-c C-f). You can combine it with Emacs-W3M to get the relevant manual page without leaving Emacs.web-model.el (available on web-mode.org) handles pretty well php blocks embedded in an html document. This major mode will also highlight js and css parts.As an alternative to ETags, consider GNU Global, aka "GTags".  Global is a lot smarter about finding tags tables, and is fairly fast to update.  Emacs-fu has a nice post about doing this on-the-fly.BTW, if you're using the Windows port of GNU Global with a Windows Emacs build, use the DJGPP ("DOS") version.  The MinGW ("Win32") build seems to have a problem with path names.

Code Coverage tools for PHP [closed]

gagneet

[Code Coverage tools for PHP [closed]](https://stackoverflow.com/questions/348850/code-coverage-tools-for-php)

Is there any code coverage tool available for PHP?

I wish to check the code coverage of my code and API's written in PHP, but have not been able to lay my hands on any code coverage tool for PHP, as it is more of a server side language and dynamic in nature.Does anyone know of a method by which code coverage for PHP can be executed?

2008-12-08 07:30:23Z

Is there any code coverage tool available for PHP?

I wish to check the code coverage of my code and API's written in PHP, but have not been able to lay my hands on any code coverage tool for PHP, as it is more of a server side language and dynamic in nature.Does anyone know of a method by which code coverage for PHP can be executed?xdebug has Code Coverage Analysis.Check this chapter of the PHPUnit ManualSee our PHP Test Coverage tool from Semantic Designs:http://www.semanticdesigns.com/Products/TestCoverage/PHPTestCoverage.htmlVery low overhead, handles huge systems of files, intuitive GUI showing coverage on specific files, and generated report with coverage breakdown at method, class and package levels.Best of all, no requirement to install anything in the system being

tested.  No need for xdebug, etc., which means you don't have to argue

with the sysadmin to do your testing.You can use it with PHPUnit to get unit-test driven coverage.  Or you can use it on your website to collect coverage from any functional testing approach/tools you may have.Using Xdebug in combination with PHPUnit can give you code coverage analysis.Spike PHPCoverage. Both SimpleTest and PHPUnit can easily be integrated with it, although PHPUnits support is there out-of-the-box.Zend Studio ships with code coverage tools out the box. Xdebug can do code coverage reporting, and Phing, a build utility, can automate running coverage reports (http://devzone.zend.com/article/2955).

Is filter_var a good way to go?

mikelbring

[Is filter_var a good way to go?](https://stackoverflow.com/questions/659197/is-filter-var-a-good-way-to-go)

Is filter_var any good for filtering data? What kind of bad data will it filter? I do use mysql_real_escape_string but I wonder if adding filter_var will help?

2009-03-18 17:05:50Z

Is filter_var any good for filtering data? What kind of bad data will it filter? I do use mysql_real_escape_string but I wonder if adding filter_var will help?To defend from SQL injection use prepared statements if possible. If not, use mysql_real_escape_string for strings, (int) casting or intval() for integers, (float) or floatval() for floats and addcslashes($input, '%_') for strings to be used inside LIKE statements. Things get even more complicated when trying to escape strings to be used inside RLIKE statements.For filtering HTML content, the best would be strip_tags (without passing $allowable_tags), but... you may not like/want it, in which case the most affordable solution is:A more reliable solution would be to use a library like HTML PurifierFilter functions are OK, but some of them are more validators than filters. Depending on your needs you may find some of them useful.You adjust filter_var by using it with the FILTER_* constants. It sounds like you're looking for sanitisation of data (actually adjusting the data to make it safe*) rather than validation (checking the data is safe).Different filters can help with different tasks. While mysql_real_escape_string is ok for sanitising data to prevent SQL injection it's no good for outputting data that may contain HTML. Here's a couple of filter's I'd use for everyday tasks:It all depends on what you mean by a valid url or a valid email. For example a@b-.c - well, you could filter top level domains to exclude .c but the list of top level domains is not constant. Moreover all the characters are valid. Even though this looks weird and is almost certainly not valid, many regex filters will validate it too. With the email a@b-.c or url http://. if displayed or used in links they will do no harm, even if they go nowhere.I think part of the issue is the question of how loose do you want your filters. If the big concern is XSS or SQL injection or otherwise preventing dangerous input, whether or not the value is usable may be irrelevant, so this sort of filter may do the trick. If you want to make sure the value is not just safe but also usable, that's a trickier beast.It really depends what you're trying to do, I can't really answer without knowing specifics. The possible filters and their effects are listed here: Types of filtersJust based on some minor testing, I've come to the conclusion that filter_var's constants are not trustworthy.For example:These are clearly invalid values, but pass filter_var's constants. Do not trust filter_var.

Selenium 2 (WebDriver) and Phpunit?

Paul R Rogers

[Selenium 2 (WebDriver) and Phpunit?](https://stackoverflow.com/questions/4206547/selenium-2-webdriver-and-phpunit)

Any one know how to use Selenium 2 with Phpunit? Are there any Selenium 2 samples in PHP?

2010-11-17 16:19:14Z

Any one know how to use Selenium 2 with Phpunit? Are there any Selenium 2 samples in PHP?Quick update: phpunit does now support Selenium 2At the time of writing, PHPUnit does not support Selenium 2.php-webdriver from facebook allows the complete WebDriver API to be called from PHP in an elegant way. To quote:It is used by starting up the Selenium 2 server, which provides the interface at localhost:4444/wd/hub.then running the PHP test code, which calls that interface. For example:The WebDriver API is mapped to PHP methods, compare calling click on element in the example with the element/click API call in the documentation.The test code can then be wrapped in regular phpUnit tests.This is not native phpUnit support, but it's a quite robust approach.please look at the http://code.google.com/p/php-webdriver-bindings/ . This is PHP library that communicates with Selenium Webdriver server using JsonWireProtocol. This is early version but it works.Currently (2017) I recommend using php-webdriver, what is AFAIK the most feature complete PHP language binding to interact with Selenium WebDriver.This library was rewritten in 2014 to support Selenium 2, and its API is mostly based on the official Java WebDriver bindings. This means you can also take advantage of code examples written in Java, as they can be usually simply followed in PHP. Its also written in a modern OOP way and follows standard PSR-4 namespaces and also PSR-2 coding standards.I would recommend this library over phpunit-selenium - as it was originally designed for Selenium 1 (though it nowadays support Selenium 2) and its API is strongly tight to PHPUnit. It also does not support some of the WebDriver features and is not up-to-date with upcomin W3C WebDriver specification.Php-webdriver is on the other hand independent library, but its integration with PHPUnit is quite simple - or you can use existing tools like Steward, which includes all the PHPUnit integration and provide also nice convenience layer and eg. allow to simply run multiple tests in parallel (without a need of another tools like paratest).There are also other testing framework integration options mentioned on the project homepage.PHPUnit Selenium integration code lives as a separate project in github, as far as I can see it does not support Selenium 2, so the answer to your question would be - No, you can not use Selenium 2 with PHPUnit.But you can clone the source tree and make it work with Selenium 2.We created a library for that, I hope it helps. It also uses the JSON Wire protocol but we aimed to make it compatible with the examples from other languages, so the syntax would be very similar. Here's the link: https://github.com/Nearsoft/PHP-SeleniumClientIf you like it, share it, improve it or fork it :)Regards, Mark.phpunit webdriver bindings are hosted on google code.  There is something we need to understand beyond this.I wrote a tutorial about how to use Selenium 2, Facebook wrapper, find it here:http://testigniter.blogspot.co.uk/2012/01/running-selenium-2-webdriver-using.htmlI recommened the usage of Menta, a Selenium 2 Framework which requires WebDriver. Both packages are PSR-0 compatible, so you can use them with Composer. You can configure selenium with the phpunit.xml. Here an exampleThe bootstrap file reads the configuration variables from testing.selenium.*, so you can easily set new variables.Now you can easily implement you testcases. Here an exampleThe Menta Package also have two demo files, located hereToday a took a deep jump into Selenium and phpunit.

It is possible and you may find some examples and instructions over here:

http://phpunit.de/manual/current/en/selenium.htmlCreator of phpunit got some nice examples of the api.

With a little experimentation and reading the error message, you'll get along.

Havn't found a great library myself as well.https://github.com/sebastianbergmann/phpunit-selenium/blob/master/Tests/Selenium2TestCaseTest.phpAs last a tutorial with from nettuts which helps you along the basics:

http://net.tutsplus.com/tutorials/php/how-to-use-selenium-2-with-phpunit/Yes, Selenium 2 (WebDriver) and PHPUnit tests is simple. But May I want to gave you advice that the first you should be try Selenium IDE because you need to expect in selenium command. If you are expect in Selenium command if so selenium 2 (Webdriver) and PHPUnit test will be more simple for you.You can try selenium IDE tutorials on here  and you can learn selenium 2 (Webdriver) and PHPUnit at here.I work on selenium2php. I have too many tests for Selenium1 recorded with Selenium IDE. Now it converts html tests into Selenium2. Actually, for PHPUnit_Extensions_Selenium2TestCase. I am going to implement more commands.

Automate Deployment for Web Applications? [closed]

Sam Wessel

[Automate Deployment for Web Applications? [closed]](https://stackoverflow.com/questions/45783/automate-deployment-for-web-applications)

My team is currently trying to automate the deployment of our .Net and PHP web applications. We want to streamline deployments, and to avoid the hassle and many of the headaches caused by doing it manually.We require a solution that will enable us to:All our apps are source controlled using SVN and our .Net apps use CruiseControl.

We have been trying to use MSBuild and NAnt deployment scripts with limited success. We have also used Capistrano in the past, but wish to avoid using Ruby if possible.Are there any other deployment tools out there that would help us?

2008-09-05 13:18:23Z

My team is currently trying to automate the deployment of our .Net and PHP web applications. We want to streamline deployments, and to avoid the hassle and many of the headaches caused by doing it manually.We require a solution that will enable us to:All our apps are source controlled using SVN and our .Net apps use CruiseControl.

We have been trying to use MSBuild and NAnt deployment scripts with limited success. We have also used Capistrano in the past, but wish to avoid using Ruby if possible.Are there any other deployment tools out there that would help us?Thank you all for your kind suggestions. We checked them all out, but after careful consideration we decided to roll our own with a combination of CruiseControl, NAnt, MSBuild and MSDeploy.This article has some great information:

Integrating MSBuild with CruiseControl.NET Here's roughly how our solution works:Then when we have verified everything is ready to go up to live/staging we run another script to:It wasn't pretty getting to this stage, but it's mostly working like a charm now :DI'm going to try and keep this answer updated as we make changes to our process, as there seem to be several similar questions on SA now.I have used Visual Build Pro for years, It's quite slick and easy to use and has many standard operations (like the ones you mentioned) built in.I use Puppet, Makefiles to build RPMs and Bamboo to do this for me. My system doesn't directly apply, and I'm not to familiar with the Windows world, but there are some transferable patterns.My make setup allows me to build RPM's for everything (php libs, php websites, perl modules, C apps, etc) that make up my app. This can be called manually, or through Bamboo. I transfer these RPM's into a yum repo and puppet handles making sure the latest (or correct) versions of software are installed in the cluster.Could you automate building software packages into MSI's? I think Puppet can manage installation of software packages and versions in Windows.I use msdeploy for this. It works perfect. About Ant; for the .NET platform we have NAnt and you can use it in combination with MSDeploy; you have the possibility to call MSDeploy from your Nant-script. Edited:

Just to make things clear; you can do everything with msdeploy. Using Nant is not a requirement. Rather than using xcopy we managed to use the -source:dirpath command with UNC addresses to the servers with msdeploy. The key was the ignoreAcls=true and removing calls to username and password in the msdeploy string:The example deploys the site from our build server's E drive to the D drive on our live server. There are some security considerations with exposing shares or this level of disk access on a live server. We're currently looking into using a limited access shared folder.We then pipe this output to a log file which is then moved to the backup archive for reference. The log file records which files were moved and when.Continuing the example above with the output pipe command:No one mentioned Final Builder http://www.finalbuilder.com.  Its on par with Visual build Pro.   Good GUI for creating automated build deployment harnessesFabric. Seems small, simple, procedural. Written in Python, since Ruby is a no-no (why?).Check out Setup Factory (from indigo rose).  It's pretty robust in what it can do.  It uses the Windows installer API.  It can probably do what you need.  The only reason Nant should exist is so that you have a framework similar to Ant in which we can write Tasks using the .NET set of languages.  If you don't want to get a pure .NET developer to write custom Tasks, I can't see any reason you can't use Ant.  Just because you write your application in a .NET language, doesn't mean you have to use a .NET build tool.

Symfony2, How to make a form label class/attr different than its input?

PMoubed

[Symfony2, How to make a form label class/attr different than its input?](https://stackoverflow.com/questions/10919619/symfony2-how-to-make-a-form-label-class-attr-different-than-its-input)

I would like to build a form with label and inputs, but the class of them should be different. Code below creates the label for the input with same attr: In my code above the ui-spinner-box will be outputted for both label and input. It will even put placeholder for its label.So how to make it create attr for label separately so I can output something like below :

2012-06-06 18:02:12Z

I would like to build a form with label and inputs, but the class of them should be different. Code below creates the label for the input with same attr: In my code above the ui-spinner-box will be outputted for both label and input. It will even put placeholder for its label.So how to make it create attr for label separately so I can output something like below :As mentioned in the documentation:You can set those attributes in twig template or in form builder:Twig template:Form builderThis may be new, but there's an easy way to do this now: The option you're looking for is label_attr.This works for me in Symfony 2.3:The above is no longer correct, at least in the context I was using it. In Symfony 2.1 the solution is:

php switch case statement to handle ranges

nikhil

[php switch case statement to handle ranges](https://stackoverflow.com/questions/8876620/php-switch-case-statement-to-handle-ranges)

I'm parsing some text and calculating the weight based on some rules. All the characters have the same weight. This would make the switch statement really long can I use ranges in the case statement.I saw one of the answers advocating associative arrays.What is the best way to achieve something like this?

Is there something similar to the bash case statement in php?

Surely writing down each individual character in either the associative array or the switch statement can't be the most elegant solution or is it the only alternative?

2012-01-16 06:51:18Z

I'm parsing some text and calculating the weight based on some rules. All the characters have the same weight. This would make the switch statement really long can I use ranges in the case statement.I saw one of the answers advocating associative arrays.What is the best way to achieve something like this?

Is there something similar to the bash case statement in php?

Surely writing down each individual character in either the associative array or the switch statement can't be the most elegant solution or is it the only alternative?*UPDATE: with default value *Well, you can have ranges in switch statement like:You can specify the character range using regular expression. This saves from writing a really long switch case list. For example,Much different ways to do this.There no direct range X..Y compares because $var checks to true in each step, but this allows do some nice cheating like this...I think I would do it in a simple way.

Doctrine 2.1 - datetime column default value

Krzysztof Trzos

[Doctrine 2.1 - datetime column default value](https://stackoverflow.com/questions/7698625/doctrine-2-1-datetime-column-default-value)

Could someone tell me how to add default value on datetime column? I can't do this like this:So how?

2011-10-08 17:46:02Z

Could someone tell me how to add default value on datetime column? I can't do this like this:So how?You map your property as DateTime type then set the value in the constructor using a new DateTime instance:This works as the constructor of a persisted class is not called upon hydration.For default value CURRENT_TIMESTAMP:Or for older Symfony versions:Worked for me... However this works only with MySQL.You can also use lifecycle callbacks if you want to be very precise:There is an extension for this automating this...https://github.com/l3pp4rd/DoctrineExtensions/blob/master/doc/timestampable.mdI think, the best way to accomplish autofill for datetime is to make like that:Putting logic to constructor isn't right solution, because setting default values are SQL client responsibility. If you decide no longer use ORM - you will lost business logic. Plus, if using constructor you won't be able to add default timestamps to datetime attributes for existing rows.This will work. Just posting for future ref.Work for me with MySql and Symfony 3.4.

Check if a string contains nothing but an URL in PHP

yan

[Check if a string contains nothing but an URL in PHP](https://stackoverflow.com/questions/15011508/check-if-a-string-contains-nothing-but-an-url-in-php)

I am wondering if this is a proper way to check, if a string contains nothing but an URL:stripos() checks if the string starts with "http"

preg_match() checks if the string contains spacesIf not so, I assume that the string is nothing but an URL - but is that assumption valid? Are there better ways to achieve this?

2013-02-21 20:23:07Z

I am wondering if this is a proper way to check, if a string contains nothing but an URL:stripos() checks if the string starts with "http"

preg_match() checks if the string contains spacesIf not so, I assume that the string is nothing but an URL - but is that assumption valid? Are there better ways to achieve this?Use filter_var()The filters can be even more refined. See the manual for more on this.In PHP there is a better way to validate the URL http://www.php.net/manual/en/function.filter-var.phpTo more securely validate URLs (and those 'non-ascii' ones), you can $string = idn_to_ascii($URL);

 if(filter_var($string, FILTER_VALIDATE_URL) && checkdnsrr($string, "A")){

    // you have a valid URL

 }

How to get only images using scandir in PHP?

esafwan

[How to get only images using scandir in PHP?](https://stackoverflow.com/questions/3226519/how-to-get-only-images-using-scandir-in-php)

Is there any way to get only images with extensions jpeg, png, gif etc while using

2010-07-12 07:19:17Z

Is there any way to get only images with extensions jpeg, png, gif etc while usingYou can use globIf you need this to be case-insensitive, you could use a DirectoryIterator in combination with a RegexIterator or pass the result of scandir to array_map and use a callback that filters any unwanted extensions. Whether you use strpos, fnmatch or pathinfo to get the extension is up to you.The actual question was using scandir and the answers end up in glob. There is a huge difference in both where blob considerably heavy. The same filtering can be done with scandir using the following code:I hope this would help somebody.I would loop through the files and look at their extensions:Here is a simple way to get only images. Works with PHP >= 5.2 version. The collection of extensions are in lowercase, so making the file extension in loop to lowercase make it case insensitive.I hope this is useful if you want case insensitive and image only extensions.You can search the resulting array afterward and discard files not matching your criteria.scandir does not have the functionality you seek.If you would like to scan a directory and return filenames only you can use this:scandir() will return . and .. as well as the files, so the above code is cleaner if you just need filenames or you would like to do other things with the actual filepaths

How to generate random password with PHP?

user198729

[How to generate random password with PHP?](https://stackoverflow.com/questions/1837432/how-to-generate-random-password-with-php)

Or is there a software to auto generate random passwords?

2009-12-03 03:24:22Z

Or is there a software to auto generate random passwords?Just build a string of random a-z, A-Z, 0-9 (or whatever you want) up to the desired length.  Here's an example in PHP:To optimize, you can define $chars as a static variable or constant in the method (or parent class) if you'll be calling this function many times during a single execution.Here's a simple solution. It will contain lowercase letters and numbers.Here's A stronger solution randomly generates the character codes in the desired character range for a random length within a desired range.I want to play the game. The simplest way would be to do:This is pretty much just a modification of the first answer. Specify the characters you want in the second parameters and the length of the password in the first.This is how I do it.here is a function that generates a password with a minimum length, a minimum number of digits and a minimal number of letters.A good password should be a mixture of both uppercase, lowercase, has number, letters, has special characters and its more than 6 characters long. Here is function I use on my apps.Also you can try a function that I wrote and is available form my blog. Advantage of this function is that it gives equal importance to lowercase, uppercase, numbers and special characters. It can be found here

PHP random password generator functionI like to shuffle array of random charsIf you need the password to be longer, just concatenate charlist a few times :)Another, very simple (and secure!) way to do this is the following (I generate all my own passwords that way):This generates a 16 character password that uses quite a sane range of characters. However, depending on your requirements (for example if a user needs to type in their password), it may be desirable to remove characters that migth be confused (such as l, I, 1, 0, O, 5, S, and so on). In that case, the above solution is probably a bit too simple.You could just use PEAR's Text_Password package  - it supports quite a few algorithms for generating them; and frees up your time to go onto something else.Pwgen-php produces save, pronounceable (easier to remember) passwords:

http://code.google.com/p/pwgen-php/Might that be acceptable?This function will generate more stronger password than most woted solution:Each character of password will be [A-Z] or [a-z] or ^ or *This will help to create random password :Here is the working example (Demo)use hackzilla/password-generatorit has many options to create different kind of passwords:ComputerPasswordGeneratorRequirementPasswordGeneratorI use st_split and implode function:Memorable password generatorThe result:This function will include half digits and half numbers:Using the same login, it can be extended to also include special charactersI think better way to generate random password is below function, if someone want then you can use these for strong password

What is the difference between redirect and forward in Zend framework

user1400

[What is the difference between redirect and forward in Zend framework](https://stackoverflow.com/questions/2551238/what-is-the-difference-between-redirect-and-forward-in-zend-framework)

What is the difference between redirect and forward in Zend framework?When we should use redirect and when should we use forward?

2010-03-31 07:49:24Z

What is the difference between redirect and forward in Zend framework?When we should use redirect and when should we use forward?_forward() just forwards everything to another controller action, while _redirect() sends a header, meaning you create a new HTTP Request and go through the entire dispatch process with it.For instance, if you call up http://example.com/foo/bar you'd call the foo controller and bar action. If you forward inside the bar action to the baz action, e.g. within the very same request, the browser would still be on the same URL, while when doing a redirect, ZF would instruct the browser to load http://example.com/foo/baz.Essentially, _forward() doeswhile _redirect() doesI usually do redirects when I want to prevent reload a page resulting in reposting form data.See these:Imagine you get a phone call in the office. Someone wants to talk to sales. If you say "please call 123456" and hang up, this is redirect . If you say "wait a minute" and just transfer the call to them, this is forward. ;)You would use _forward() for cases where you want the URL to stay the same - though beware, it does mean whatever base controller class you're using is called twice.That may seem obvious or trivial, but if not kept in mind, can really screw up your application design, given that intuitive understanding of the flow is that one request calls one controller instance. E.g. it means request-scope singletons have to be declared as static, or _forward() will break them.I would guess that a redirect sends a 301/302 back to the browser with a new URL, while a forward simply "forwards" the request to a different controller action internally but keeps the URL the same so the browser doesn't know any different.1-redirect create a new response with header() information [302 Found  or 301 ==  Moved permanently] and its will get to the dispatch cycle once again 2-forward change the execution flow to that new request without re enter the dispatch process again The redirect action ends the current page process and redirects to another. All the context will change (new controller/action) as the browser receives a redirection. It connects to a new URLWhereas the forward will stay on the same page, but will leave the context unchanged. You can see this as a function call. Your views will be loaded as usual.

Error with PHP mail(): Multiple or malformed newlines found in additional_header

freestate

[Error with PHP mail(): Multiple or malformed newlines found in additional_header](https://stackoverflow.com/questions/30887610/error-with-php-mail-multiple-or-malformed-newlines-found-in-additional-header)

Suddenly have started receiving the above error without any changes having been made to the script.Host is 1and1 (I know...)The script still works fine on a different server, and so my suspicion is that there must have been some server config change that has lead to this, although the hosts plead ignorance.There's no information on the above error at all in Google that I can find - does anybody have any ideas?  Server is running Apache if that helps. 

2015-06-17 09:31:00Z

Suddenly have started receiving the above error without any changes having been made to the script.Host is 1and1 (I know...)The script still works fine on a different server, and so my suspicion is that there must have been some server config change that has lead to this, although the hosts plead ignorance.There's no information on the above error at all in Google that I can find - does anybody have any ideas?  Server is running Apache if that helps. Had just the similar problem.

It came out of the blue. No PHP Code was changed.  What was changed: PHP was upgraded 5.5.25-1 to 5.5.26.  A security risk in PHP mail() function has been fixed and extra newlines in additional_headers are allowed no more. Because extra newlines mean: now starts the email message (and we surely don't want somebody to inject some newlines through headers followed by an evil message).  What previously have worked fine, e.g. just having extra newlines after headers or even passing the whole message to additional_headers, will function no more.  Solution: PHP Security Bug report: https://bugs.php.net/bug.php?id=68776

C Code diff how its fixed: http://git.php.net/?p=php-src.git;a=blobdiff;f=ext/standard/mail.c;h=448013a472a3466245e64b1cb37a9d1b0f7c007e;hp=1ebc8fecb7ef4c266a341cdc701f0686d6482242;hb=9d168b863e007c4e15ebe4d2eecabdf8b0582e30;hpb=eee8b6c33fc968ef8c496db8fb54e8c9d9d5a8f9None of the above answers solved this problem for me.  So, I expanded my search to "mail with attachment and HTML message issues."  Piecing together info from a few different posts, I came up with this.  It allows for BOTH HTML email and an attachment.My original header code:My new code (complete):

Note that $body is the HTML that is being assembled by a different function.Two key changes here. (1) removed all the multi-part stuff from the headers into $message.  (2) removed all the "\r\n" stuff and added $eol = PHP_EOL; to the code.Together, these changes allowed me to once again send HTML email with attachments. Had the same problem:

Removed the mime boundary and message from the header and all worked.None of the above fixed it for me - main issue is you must not put anything other than header definitions in headers. Old scripts bunged anything in there. So move any text or attachments that were stuffed in to headers into the message body. Makes sense..This has an explanation

(I guess it's same solution as Frank's above plus Davisca's "no double new lines" - but you need doubled new lines for attachments)Another scenario that brings the same new error is if you are not sending any headers to the "mail" command. It used to just use a default, and now gives the misleading error: "Multiple or malformed newlines found in additional_header".Can be fixed by adding this:my PHP version - 5.4.43, 

probably contains Fixed bug #68776.googling to the same error showed [http://fossies.org/diffs/php/5.4.42_vs_5.4.43/ext/standard/mail.c-diff.html]=> I cannot use empty strings as mail() parameters.my old code:my new code:This will solve your problem. I have changed a little bit of Frank's code. This code will support attachment and html.You may be running into Bug #69874 Can't set empty additional_headers for mail() if you haven't done anything stupid (i.e. forgot to sanitize the headers).Test for the bugAlternately if you know your PHP version (hint: php -v) you can check the changelog for the bug number (69874) to see whether the fix has been applied for your version. A short-term fix is to replace calls to mail() like thisThis is quite possibly someone trying to take advantage of your code to inject email headers.http://resources.infosecinstitute.com/email-injection/I would suggest you examine access logs etc and look for unusual activity. The fact you are getting error messages hopefully means that your script has not been compromised and it is erroring out instead. You need to make sure though.

How to determine file age using PHP?

Marek Karbarz

[How to determine file age using PHP?](https://stackoverflow.com/questions/1757097/how-to-determine-file-age-using-php)

Any way to determine file age of an image in a folder using PHP?I want to delete older files than 2 hours, is this possible without adding timestamp-names to their filenames on upload to the folder?If so, please give me an example!thanks

2009-11-18 16:09:36Z

Any way to determine file age of an image in a folder using PHP?I want to delete older files than 2 hours, is this possible without adding timestamp-names to their filenames on upload to the folder?If so, please give me an example!thanksYou can use filemtime function to get the last modified date/time and use that to see how old the file is.You are looking for the filemtime functionBe aware that on NAS/SAN storages the file time of an up-to-date file might be different from the PHP time(), as those storages might have their own clock. I think such configurations are rare, but it cost me some headache.I digged a bit on the web and Stackoverflow (PHP How to find the time elapsed since a date time?) and here is my solution:It's a full answer giving a human readable representation of file age + a check to see if the file is 2 hours old or not.Here is the output on my side:You can use date/time of last file modification:I'd check out the filemtime() or the filectime() functions.  Those will give you the modified and creation times (respectively) of the file.Try with filemtime()

Laravel: validate an integer field that needs to be greater than another

Alexandre Thebaldi

[Laravel: validate an integer field that needs to be greater than another](https://stackoverflow.com/questions/32036882/laravel-validate-an-integer-field-that-needs-to-be-greater-than-another)

I have two fields that are optional only if both aren't present:Now, end_page needs to be greater than initial_page. How include this filter?

2015-08-16 15:35:50Z

I have two fields that are optional only if both aren't present:Now, end_page needs to be greater than initial_page. How include this filter?There is no built-in validation that would let you compare field values like that in Laravel, so you'll need to implement a custom validator, that will let you reuse validation where needed. Luckily, Laravel makes writing custom validator really easy.Start with defining new validator in yor AppServiceProvider:Now you can use your brand new validation rule in your $rules:You'll find more info about creating custom validators here: http://laravel.com/docs/5.1/validation#custom-validation-rules. They are easy to define and can then be used everywhere you validate your data.For Laravel 5.4 it will be:As of Laravel 5.6 gt, gte, lt and lte rules are added.I think you can try something like this,the question was asked in 2015 so most of the answers are also outdated now in 2019i want to give answer which uses features provided by laravel team which is included in it's new version,so as stated by @Sarpadoruk as of laravel 5.6 laravel added features in validation like 

gt,gte,lt and lte which means:so using gt you can check that your end_page should be greater than your initial_page and your task becomes very easy now:Why not just define $min_number = $min + 1 number and use validator min:$min_number, example:And you can then return custom error message to explain the error to user.

eloquent laravel: How to get a row count from a ->get()

JP Foster

[eloquent laravel: How to get a row count from a ->get()](https://stackoverflow.com/questions/33676576/eloquent-laravel-how-to-get-a-row-count-from-a-get)

I'm having a lot of trouble figuring out how to use this collection to count rows. I have tried adding->count() but didn't work. I have tried doing count($wordlist). I'm not really sure what to do without needing a second request as a->count() method. 

2015-11-12 16:34:57Z

I'm having a lot of trouble figuring out how to use this collection to count rows. I have tried adding->count() but didn't work. I have tried doing count($wordlist). I'm not really sure what to do without needing a second request as a->count() method. Answer has been updatedcount is a Collection method. The query builder returns an array. So in order to get the count, you would just count it like you normally would with an array:If you have a wordlist model, then you can use Eloquent to get a Collection and then use the Collection's count method. Example:There is/was a discussion on having the query builder return a collection here: https://github.com/laravel/framework/issues/10478However as of now, the query builder always returns an array.Edit: As linked above, the query builder now returns a collection (not an array). As a result, what JP Foster was trying to do initially will work:However, as indicated by Leon in the comments, if all you want is the count, then querying for it directly is much faster than fetching an entire collection and then getting the count. In other words, you can do this:Direct get a count of row Using EloquentUsing query builderIts better to access the count with the laravels count method orit's work me Step 1Add in headerStep 2use in div tag 

Hashing an entire PHP array into a unique value [duplicate]

loneboat

[Hashing an entire PHP array into a unique value [duplicate]](https://stackoverflow.com/questions/5097632/hashing-an-entire-php-array-into-a-unique-value)

Looking for a way to produce a filename-safe hash of a given PHP array.  I'm currently doing:... but it feels "hacky" using print_r() to generate a string unique to each array.Any bright ideas for a cleaner way to do this?EDIT

Well, seems everyone thinks serialize is better suited to the task.  Any reason why?  I'm not worried about ever retrieving information about the variable after it's hashed (which is good, since it's a one-way hash!). Thanks for the replies!

2011-02-23 21:52:15Z

Looking for a way to produce a filename-safe hash of a given PHP array.  I'm currently doing:... but it feels "hacky" using print_r() to generate a string unique to each array.Any bright ideas for a cleaner way to do this?EDIT

Well, seems everyone thinks serialize is better suited to the task.  Any reason why?  I'm not worried about ever retrieving information about the variable after it's hashed (which is good, since it's a one-way hash!). Thanks for the replies!Use md5(serialize()) instead of print_r().  print_r()'s purpose is primarily as a debugging function and is formatted for plain text display, whereas serialize() encodes an array or object representation as a compact text string for persistance in database or session storage (or any other persistance mechanism).Alternatively you could use json_encode serialize() should work fine. It has the additional advantage of invoking the __sleep magic method on objects, and being the cleanest serialization method available in PHP overall. What about serialize?$filename = md5(serialize($someArray));Using serialize() might be more conservative if you want to keep the type, etc...

constant already defined in php

JDesigns

[constant already defined in php](https://stackoverflow.com/questions/5887108/constant-already-defined-in-php)

I have a function that I am trying to run but it shows the message as 

CONSTANT already defined.I tried to put a condition saying "if defined" about the function but still nothing. Is there any method to ignore this and see the output?

2011-05-04 17:01:30Z

I have a function that I am trying to run but it shows the message as 

CONSTANT already defined.I tried to put a condition saying "if defined" about the function but still nothing. Is there any method to ignore this and see the output?Replace this:with this:define()Example:Is this how you check for constants:Maybe you're not doing the check properly OR the constant you are checking for isn't the cause of the error, some rogue include file might have a different constant and produces an overlap / re-definition.

Casting object to array - any magic method being called?

Majql

[Casting object to array - any magic method being called?](https://stackoverflow.com/questions/11121613/casting-object-to-array-any-magic-method-being-called)

I have an object of class Foo:What I want (and have) to do is cast this object to an array, like this:Is there any magic (or not magic :)) method that is being called at this moment? Or is there any other way to intercept it? I know I can write a simple method, eg. asArray() in Foo, but I'm looking for some more "native" PHP ways.

2012-06-20 14:16:52Z

I have an object of class Foo:What I want (and have) to do is cast this object to an array, like this:Is there any magic (or not magic :)) method that is being called at this moment? Or is there any other way to intercept it? I know I can write a simple method, eg. asArray() in Foo, but I'm looking for some more "native" PHP ways.You can have the class implement the ArrayAccess interface.  This will allow you to treat the object like an array without casting and you get total control over how the members are used.There is no __toArray magic method in PHP. An enhancement proposal has been rejected in 2006 with the following answer:It is thus very unlikely that it will be implemented in any future release (which is a pity, if you ask me).Sadly no, casting to array doesn't trigger any magic method like it is done with:which triggers __toString() method and which you can override.However, you may write a custom toArray() method.You may also be interested in the Serializable interface which allows you to write custom serializer strategy.Not sure if this question still relevant, but php has builtin ArrayObject class, that allows to treat object as array and can be handy when used as container for database record or collection.It might be not a best practice in regards to strict types, but it allows to treat object as array and both statements are valid.However you need to keep in mind behaviour of ArrayObjectArrayObject accepts two flags ArrayObject::STD_PROP_LIST as default and ArrayObject::ARRAY_AS_PROPS as alternative. This would change behaviour for reading values but does not support setting new properties in that way, here is example:To make this behaviour more consistent you would have to extend this class and implement magic methods __get(), __set(), __isset() and __unset().Another tricky part is serialization, default method serialize would return you a copy serialized $storage variable instead of object itself, as workaround to return serialized copy of instance you can implement default serialization in __toString method, this way it's behave correctly.Example of usageOne way to do this, without changing the original class definition is to use reflection. This allows to you examine the class's properties at runtime.Taken from the manual: http://www.php.net/manual/en/reflectionclass.getproperties.phpYou can use get_object_vars($yourObject) that will return an associative array of all property names/values accessible from the context.See http://php.net/manual/en/function.get-object-vars.phpA you want to access protected or private properties, my advice would be to extend ArrayObject, that implements the method getArrayCopy() 

required_if Laravel 5 validation

David

[required_if Laravel 5 validation](https://stackoverflow.com/questions/37777265/required-if-laravel-5-validation)

I have form that a user can fill-out for selling their home. And for one of the in puts, a user must select weather it will be "For Sale" or "For Rent". If it is For Sale, two price input fields will appear, and if it is For Rent, then some other price input field will appear based off of jQuery.My problem is I want the price fields to be required, BUT for example if I'am selecting "For Rent", and then I submit my form, it will give me an error saying the price fields for the "For Sale" input fields are required, even though it is under the "For Rent" section.I know there is a required_if in Laravel, but I just dont know how to utilize that. Here is my Requests for a Property./****************** EDIT ***************************/What I have now:But I get this error when I submit the Form:

2016-06-12 17:43:05Z

I have form that a user can fill-out for selling their home. And for one of the in puts, a user must select weather it will be "For Sale" or "For Rent". If it is For Sale, two price input fields will appear, and if it is For Rent, then some other price input field will appear based off of jQuery.My problem is I want the price fields to be required, BUT for example if I'am selecting "For Rent", and then I submit my form, it will give me an error saying the price fields for the "For Sale" input fields are required, even though it is under the "For Rent" section.I know there is a required_if in Laravel, but I just dont know how to utilize that. Here is my Requests for a Property./****************** EDIT ***************************/What I have now:But I get this error when I submit the Form:assuming that list_type is the name of the select box to choose from (values : selling or rent) use it this waywhat does this mean?

:the sale price is only required if the value of list_type is equal to sellingdo the same for rent_priceeditThere can be another situation when, the requirement will be required if another field is not present, if someone is in this situation, you can doYou can use Illuminate\Validation\Rule in Laravel as given below to build the validator.

Whats the easiest way to determine if a user is online? (PHP/MYSQL)

MichaelICE

[Whats the easiest way to determine if a user is online? (PHP/MYSQL)](https://stackoverflow.com/questions/1051895/whats-the-easiest-way-to-determine-if-a-user-is-online-php-mysql)

Is there a way I can piggy back sessions to know if the user is online?I.e: use logs on, I set a $_SESSION variable, user times out- cookie Garbage collector updates the database to update their status as offline.EDIT: I want a solution that does not involve times or dates.  I want something to ride on sessions or something similar.  Guessing if someone is online is not good enough for what I need.

2009-06-27 01:24:57Z

Is there a way I can piggy back sessions to know if the user is online?I.e: use logs on, I set a $_SESSION variable, user times out- cookie Garbage collector updates the database to update their status as offline.EDIT: I want a solution that does not involve times or dates.  I want something to ride on sessions or something similar.  Guessing if someone is online is not good enough for what I need.Don't bother with figuring out the differences between timezones. That's not necessary.Whenever the user accesses a page, update a field in their record of the Users table last-updated-time. Then do a query for all users having a last-updated-time within the last 5 minutes. Anything more than this, and they are considered "offline."If you use your server-time, via the NOW() function in MySQL, you'll side-step calculating differences between timezones.This is the standard way of tracking how many users are presently online (Meaning, active within the last couple of minutes).If you would like to know they are still active even when they're not jumping from page to page, include a bit of javascript to ping your server every 60 seconds or so to let you know they are still alive. It'll work the same way as my original suggestion, but it will update your records without requiring them to be frantically browsing your site at least once every five minutes.What you are asking for (after the clarification) is, by definition, impossible.  HTTP is a connectionless protocol, so as soon as a user has hit a page and all the content comes back from the server to the user's browser, there is no connection between the two.  Someone is "online" with your website for less than a second.  One thing you could do is to have JavaScript on your web page make AJAX requests back to your server on a regular basis which includes identifying information, and a different AJAX request when the user leaves the page, using window.onbeforeunload.My way may not be the best way but since my site and userbase is all in mysql DB, when a user logins into my site, Then on every page load I check for the online time session, if it exist, I check to see how old it is, if it is less then 5 minutes old, I do nothing, if it is older then 5 minutes, then I update the session time again with current time and also update the online users table with the timeThen I have a cron job that runs every 10 - 15 minutes that deletes any uses from online table and marks there user table as offline if there online time has updated within X amount of minutesIt sounds like your "is the person online" comparison logic isn't taking into account the timezones.  If you are dealing with timezones in this manner, I strongly recommend that you store all your times in GMT, and convert them to local time for your users right before you display them.  This will make any comparison operations very simple.There's a nice SO thread about timezones here.One thing I would advise is to store this kind of information in memory with for example memcached or mysql heap or redis. Because otherwise the database will be hit a lot.Store the time-zone in the table, and use it in a calculation to find that users local time in comparison to the local time of the user viewing the page.Edit:Better yet, store all times as the server time, and base all calculations relative only to the server time.Depends on your situation, it may be better for you to create a separate table "whose-online" with the columns: "ip" and "last-updated-time" and query/update this table every time a user loads a page.On page load queries may include:Benefits of using this technique:Note: If you use this you should want to take into consideration that any pageview will create a row in your table so based on useragent you can disregard bots or only count the popular ones (Firefox, IE, Safari, Opera, etc).The solution that I have implemented for this is to, on every page load by an authenticated user, set/reset a memcache var such as "user_{userid}isonline" => true and expire it in 5 minutes. Then check if the var is in the cache when I access the user's info.  Depending on the size of your user base, if you want to get a list of everyone online, you could use a memcache getmulti call with an array of "user{userid}_isonline" keys for all of your users.of course, this really depends on how often a user will change pages on your site... to get a more accurate representation of the users online, you could implement an ajax xmlhttprequest call on your page running at a small interval (30 seconds or so) that resets the memcache var, and have the memcache var expire in less time (1 minute to account for possible browser issues).  This is not COMPLETELY accurate, but as http does not have a persistent connection to the server, you are pretty limited on what you can do.IF you require an up to the second representation of who is online, you could maybe have a flash app loaded in your page that connects to a jabber server, then just check if that particular user is logged in on the server.Here's a way on how to get the difference between two dates from a database in minutes, then check for the difference and set the online/offline status. You can also use the onunload tag... On the body 

More information here (https://www.w3schools.com/jsref/event_onunload.asp)This way you don't have to wait 4 -5 minutes for the user to get offline.But you should still use the ajax update method incase the user's browser crashes... 

Capturing text between square brackets in PHP

Chuck Le Butt

[Capturing text between square brackets in PHP](https://stackoverflow.com/questions/10104473/capturing-text-between-square-brackets-in-php)

I need some way of capturing the text between square brackets. So for example, the following string:[This] is a [test] string, [eat] my [shorts].Could be used to create the following array:I have the following regex, /\[.*?\]/ but it only captures the first instance, so:How can I get the output I need? Note that the square brackets are NEVER nested, so that's not a concern.

2012-04-11 10:49:54Z

I need some way of capturing the text between square brackets. So for example, the following string:[This] is a [test] string, [eat] my [shorts].Could be used to create the following array:I have the following regex, /\[.*?\]/ but it only captures the first instance, so:How can I get the output I need? Note that the square brackets are NEVER nested, so that's not a concern.Matches all strings with brackets:If You want strings without brackets:Alternative, slower version of matching without brackets (using "*" instead of "[^]"):

How do you match one of two words in a regular expression?

Adrian Sarli

[How do you match one of two words in a regular expression?](https://stackoverflow.com/questions/1188529/how-do-you-match-one-of-two-words-in-a-regular-expression)

I want to match either @ or 'at' in a regex. Can someone help? I tried using the ? operator, giving me /@?(at)?/ but that didn't work

2009-07-27 14:34:00Z

I want to match either @ or 'at' in a regex. Can someone help? I tried using the ? operator, giving me /@?(at)?/ but that didn't workTry:This means either @ or at but not both. It's also captured in a group, so you can later access the exact match through a backreference if you want to.mmyers' answer will perform a paren capture; mine won't.  Which you should use depends on whether you want the paren capture.if that's only 2 things you want to capture, no need regexhave you tried that works for (in the .NET regex flavor) the following textjohnsmith@gmail.com

johnsmithatgmail.comWhat about:For:

Create a Laravel Request object on the fly

Ben Fransen

[Create a Laravel Request object on the fly](https://stackoverflow.com/questions/40262947/create-a-laravel-request-object-on-the-fly)

I'm handling data in one controller and want to pass it further into another controller to avoid duplicate code.Is there a way to set up a Request object that is needed in the other controller's store-method? I've traced down the Request inheritance and came to Symfony's Request object which has a request property that is in fact a ParameterBag that holds a method add to add parameters with values to it.I've tried the following but I'm getting null as result:I'm on Laravel 5.1 for this project.

2016-10-26 12:57:37Z

I'm handling data in one controller and want to pass it further into another controller to avoid duplicate code.Is there a way to set up a Request object that is needed in the other controller's store-method? I've traced down the Request inheritance and came to Symfony's Request object which has a request property that is in fact a ParameterBag that holds a method add to add parameters with values to it.I've tried the following but I'm getting null as result:I'm on Laravel 5.1 for this project.You can use replace():Alternatively, it would make more sense to create a Job for whatever is going on in your second controller and remove the ShouldQueue interface to make it run synchronously.Hope this helps!Creating a request object with $myRequest = new Request(); creates the object with method = 'GET'. You can check your request's method with $myRequest->getMethod().

As the request property holds data for POST requests you cannot use $myRequest->request->add() by default. First you have to set the request's method to POST:By the way using $myRequest->query->add() you can add data to a GET request.To "avoid duplicate code you" you need to abstract the common functionality into a dedicated class, give it a proper mnemonic name, write a set of unit tests around it, and then mock it in controllers when unittesting controllers.but if you still need to make requests:and if you need the full functionality of the Request, you need to add some extra linesYou can add the request parameter on the fly using these methods. replace function doc If you are in controller then, pass Request object in paramter of the function like merge function doc Note:: in all function we are extending the request, mean previous parameter will remain there. You will be adding your own. You can replace them all. You can clone the existing request and fill it with new data:

Determining what classes are defined in a PHP class file

Allain Lalonde

[Determining what classes are defined in a PHP class file](https://stackoverflow.com/questions/928928/determining-what-classes-are-defined-in-a-php-class-file)

Given that each PHP file in our project contains a single class definition, how can I determine what class or classes are defined within the file?I know I could just regex the file for class statements, but I'd prefer to do something that's more efficient.

2009-05-30 03:26:27Z

Given that each PHP file in our project contains a single class definition, how can I determine what class or classes are defined within the file?I know I could just regex the file for class statements, but I'd prefer to do something that's more efficient.I needed something like this for a project I am working on, and here are the functions I wrote:If you just want to check a file without loading it use token_get_all():Basically, this is a simple finite state machine. In PHP the sequence of tokens will be:So this code will handle any weird spacing or newlines you get just fine because it's using the same parser PHP uses to execute the file. If token_get_all() can't parse it, neither can PHP.By the way, you use token_name() to turn a token number into it's constant name.Here is my c2.php:Output:I needed parse classes from file with namespaces, so I modified code. If somebody need too, here is it: Or you could easily use AnnotationsParser from Nette\Reflection (installable using composer):Output will be then something like this:The parsePhp() method basically does something similar as examples in other answers, but you don't have to declare nor test the parsing yourselves.My snippet too. Can parse files with multiple classes, interfaces, arrays and namespaces.

Returns an array with classes+types (class, interface, abstract) divided by namespaces.Outputs something like this...Might help someone!Use PHP's function get_declared_classes(). This returns an array of classes defined in the current script.I've extended Venkat D's answer a bit to include returning the methods, and to search through a directory. (This specific example is built for CodeIgniter, which will return all the methods in the ./system/application/controller files - in other words, every public url that you can call through the system.)You can ignore abstract classes like this (note the T_ABSTRACT token):

How to make Apache serve index.php instead of index.html?

Adam Wojda

[How to make Apache serve index.php instead of index.html?](https://stackoverflow.com/questions/16192049/how-to-make-apache-serve-index-php-instead-of-index-html)

If I put the following line in a index.html file, to make Apache include the index.php file:visiting the index.html page shows me this:Why is that? Why doesn't it actually include the PHP file?

2013-04-24 12:27:20Z

If I put the following line in a index.html file, to make Apache include the index.php file:visiting the index.html page shows me this:Why is that? Why doesn't it actually include the PHP file?As others have noted, most likely you don't have .html set up to handle php code.Having said that, if all you're doing is using index.html to include index.php, your question should probably be 'how do I use index.php as index document?In which case, for Apache (httpd.conf), search for DirectoryIndex and replace the line with this (will only work if you have dir_module enabled, but that's default on most installs):If you use other directory indexes, list them in order of preference i.e.As of today (2015, Aug., 1st), Apache2 in Debian Jessie, you need to edit:And change the order of that line, bringing index.php to the first position:PHP will work only on the .php file extension.If you are on Apache you can also set, in your httpd.conf file, the extensions for PHP. You'll have to find the line:and add how many extensions, that should be read with the PHP interpreter, as you want.You can't include php code in file with html extension you must change the extension of index.html for index.php and the other index file must have another name like template.phpIf a file have html extension the web server think that your php script is plain text.

Is htmlentities() sufficient for creating xml-safe values?

John Himmelman

[Is htmlentities() sufficient for creating xml-safe values?](https://stackoverflow.com/questions/2822774/is-htmlentities-sufficient-for-creating-xml-safe-values)

I'm building an XML file from scratch and need to know if htmlentities() converts every character that could potentially break an XML file (and possibly UTF-8 data)? The values will be from a twitter/flickr feed, so I need to be sure-

2010-05-12 21:08:20Z

I'm building an XML file from scratch and need to know if htmlentities() converts every character that could potentially break an XML file (and possibly UTF-8 data)? The values will be from a twitter/flickr feed, so I need to be sure-htmlentities() is not a guaranteed way to build legal XML.Use htmlspecialchars() instead of htmlentities() if this is all you are worried about. If you have encoding mismatches between the representation of your data and the encoding of your XML document, htmlentities() may serve to work around/cover them up (it will bloat your XML size in doing so). I believe it's better to get your encodings consistent and just use htmlspecialchars().Also, be aware that if you pump the return value of htmlspecialchars() inside XML attributes delimited with single quotes, you will need to pass the ENT_QUOTES flag as well so that any single quotes in your source string are properly encoded as well. I suggest doing this anyway, as it makes your code immune to bugs resulting from someone using single quotes for XML attributes in the future.Edit: To clarify:htmlentities() will convert a number of non-ANSI characters (I assume this is what you mean by UTF-8 data) to entities (which are represented with just ANSI characters). However, it cannot do so for any characters which do not have a corresponding entity, and so cannot guarantee that its return value consists only of ANSI characters. That's why I 'm suggesting to not use it.If encoding is a possible issue, handle it explicitly (e.g. with iconv()).Edit 2: Improved answer taking into account Josh Davis's comment belowis .Dom::createTextNode() will automatically escape your content.  Example:Output:When you set the internal encoding to utf-8, e.g.you'll still getNote that the above is not the same as setting the second argument $value in Dom::createElement(). The method will only make sure your element names are valid. See the Notes on the manual page, e.g.will result in a Warningand the following output:The Gordon's answer is good and explain the XML encode problems, but not show a simple function (or what the blackbox do). Jon's answer starting well with the 'htmlspecialchars' function recomendation, but he and others do some mistake, then I will be emphatic.A good programmer MUST have control about use or not of UTF-8 in your strings and XML data: UTF-8 (or another non-ASCII encode) IS SAFE in a consistent algorithm.SAFE UTF-8 XML NOT NEED FULL-ENTITY ENCODE. The indiscriminate encode produce "second class, non-human-readble, encode/decode-demand, XML". And safe ASCII XML, also not need entity encode, when all your content are ASCII.Only 3 or 4 characters need to be escaped in a string of XML content: >, <, &, and optional ". 

Please read http://www.w3.org/TR/REC-xml/ "2.4 Character Data and Markup" and "4.6 Predefined Entities".  THEN YOU can use 'htmlentities'For illustration, the following PHP function will make a XML completely safe:In a CDATA block you not need use this function... But, please, avoid the indiscriminate use of CDATA.So your question is "is htmlentities()'s result guaranteed to be XML-compliant and UTF-8-compliant?" The answer is no, it's not.htmlspecialchars() should be enough to escape XML's special characters but you'll have to sanitize your UTF-8 strings either way. Even if you build your XML with, say, SimpleXML, you'll have to sanitize the strings. I don't know about other librairies such as XMLWriter or DOM, I think it's the same.Thought I'd add this for those who need to sanitize & not lose the XML attributes.Usage:Returns:

I have a base64 encoded png, how do I write the image to a file in PHP?

mmattax

[I have a base64 encoded png, how do I write the image to a file in PHP?](https://stackoverflow.com/questions/1532993/i-have-a-base64-encoded-png-how-do-i-write-the-image-to-a-file-in-php)

What's the proper way in PHP to create an image file (PNG), when I have the base64 encoding?I've been playing around with:do I need to decode? should I be using the gd library?

2009-10-07 17:14:28Z

What's the proper way in PHP to create an image file (PNG), when I have the base64 encoding?I've been playing around with:do I need to decode? should I be using the gd library?My best guess is that you simply need to call base64_decode() on $_REQUEST['data'] before writing it to the file. That should be plenty enough :).You need to use base64_decode(). AND. Sometimes it is not sufficient. Here is all code that you need:P.S. I used this code to get PNG image from html canvas.I would think you'd want to decode with base64_decode() unless you are only using it like they are here HERE.  The thing I am sure of is that you will want to sanitize $_REQUEST['id'] before using it.  

PHP: How to Pass child class __construct() arguments to parent::__construct()?

none

[PHP: How to Pass child class __construct() arguments to parent::__construct()?](https://stackoverflow.com/questions/1603469/php-how-to-pass-child-class-construct-arguments-to-parent-construct)

I have a class in PHP like so: It has a child class, as such: What if, for some reason, the ParentClass needs to change to take more than one optional argument, which I would like my Child class to provide "just in case"? Unless I re-code the ChildClass, it will only ever take the one argument to the constructor, and will only ever pass that one argument. Is this so rare or such a bad practice that the usual case is that a ChildClass wouldn't need to be inheriting from a ParentClass that takes different arguments? Essentially, I've seen in Python where you can pass a potentially unknown number of arguments to a function via somefunction(*args) where 'args' is an array/iterable of some kind. Does something like this exist in PHP? Or should I refactor these classes before proceeding? 

2009-10-21 20:38:30Z

I have a class in PHP like so: It has a child class, as such: What if, for some reason, the ParentClass needs to change to take more than one optional argument, which I would like my Child class to provide "just in case"? Unless I re-code the ChildClass, it will only ever take the one argument to the constructor, and will only ever pass that one argument. Is this so rare or such a bad practice that the usual case is that a ChildClass wouldn't need to be inheriting from a ParentClass that takes different arguments? Essentially, I've seen in Python where you can pass a potentially unknown number of arguments to a function via somefunction(*args) where 'args' is an array/iterable of some kind. Does something like this exist in PHP? Or should I refactor these classes before proceeding? There is something like this in php, though a bit verbose:This can be done in PHP >= 5.6 without call_user_func_array() by using the ... (splat) operator:if you get php nested limit error, try this:My way of doing it (tested in PHP 7.1):Test it https://3v4l.org/csJ68In this case, the parent and the child have the same constructor signature.

It also works if you want to unpack your arguments in the parent constructor:Test it https://3v4l.org/JGE1AIt is also worth noticing that in PHP >= 5.6 you can enforce types for variadic functions (scalar types in PHP >= 7):Check out these functions on php.net:Also, if you want to make an optional argument, you can do this:Yeah, it's pretty bad practice to make a child class that uses different constructor arguments from the parent.  Especially in a language like PHP where it's poorly supported.Of course, the generic way to pass a set of "whatever arguments we might ever want" in PHP is to pass a single argument consisting of an array of configuration values.PHPStorm Inspection suggests to use the argument unpacking feature instead of call_user_func_array(). Apart less magic, the feature is faster.

Source: https://wiki.php.net/rfc/argument_unpacking

PHP, display image with Header()

coffeemonitor

[PHP, display image with Header()](https://stackoverflow.com/questions/2633908/php-display-image-with-header)

I'm displaying images from outside my web root, like this:The content-type: image/png is what confuses me.Someone else helped me out with this code, but I noticed that not all images are PNG.  Many are jpg or gif.

And still they are displayed successfully.does anyone know why?

2010-04-13 23:29:56Z

I'm displaying images from outside my web root, like this:The content-type: image/png is what confuses me.Someone else helped me out with this code, but I noticed that not all images are PNG.  Many are jpg or gif.

And still they are displayed successfully.does anyone know why?The best solution would be to read in the file, then decide which kind of image it is and send out the appropriate header(Note: the correct content-type for JPG files is image/jpeg)There is a better why to determine type of an image. with exif_imagetypeIf you use this function, you can tell image's real extension.with this function filename's extension is completely irrelevant, which is good.You can add more types from the link.Hope it helps.Browsers make their best guess with the data they receive. This works for markup (which Websites often get wrong) and other media content. A program that receives a file can often figure out what its received regardless of the MIME content type it's been told.This isn't something you should rely on however. It's recommended you always use the correct MIME content.Browsers can often tell the image type by sniffing out the meta information of the image. Also, there should be a space in that header:Though weirdly named, you can use the getimagesize() function. This will also give you mime information:if you know the  file name, but don't know the file extention you can use this function:Note: the correct content-type for JPG files is image/jpeg.

How to generate a good salt - Is my function secure enough?

JDelage

[How to generate a good salt - Is my function secure enough?](https://stackoverflow.com/questions/4099333/how-to-generate-a-good-salt-is-my-function-secure-enough)

Here's the function I'm using to generate random salts:This is for a non commercial website.  It's only used to generate the salt (to be stored in the db and used along with the user submitted pw for hashing).Is this appropriate?  Should I use a larger subset of characters, and if so is there an easy way to do that in PHP?

2010-11-04 17:18:35Z

Here's the function I'm using to generate random salts:This is for a non commercial website.  It's only used to generate the salt (to be stored in the db and used along with the user submitted pw for hashing).Is this appropriate?  Should I use a larger subset of characters, and if so is there an easy way to do that in PHP?If you are hashing passwords, you should use a modern hashing algorithm that does not require you to generate your own salt. Using weak hashing algorithms presents a danger to both you and your users. My original answer was written eight years ago. Times have changed, and password hashing is a lot easier now. You should always use built in functions to hash/check passwords. Using your own algorithms at any point introduces a huge amount of unnecessary risk.For PHP, consider using password_hash(), with the PASSWORD_BCRYPT algorithm. There is no need to provide your own salt.Below is my original answer, for posterity:From the php sha1 page:This looks simpler, and more effective (since each is unique) than what you have proposed.If you're on Linux, /dev/urandom is probably your best source of randomness. It's supplied by the OS itself, so it's guaranteed to be much more reliable than any PHP built-in function.This will give you 32 bytes of random blob. You'll probably want to pass this through something like base64_encode() to make it legible. No need to juggle characters yourself.Edit 2014: In PHP 5.3 and above, openssl_random_pseudo_bytes() is the easiest way to get a bunch of random bytes. On *nix systems, it uses /dev/urandom behind the scenes. On Windows systems, it uses a different algorithm that is built into the OpenSSL library.Related: https://security.stackexchange.com/questions/26206Related: should i use urandom or openssl_random_pseudo_bytes?password_hash() is availble in PHP 5.5 and newer. I am surprised to learn it is not mentioned here.With password_hash() there is no need to generate a salt as the salt is automatically being generated using the bcrypt algorithm -- and therefore no need to make up a set of characters. Instead, the user-submitted password is compared to the unique password hash stored in the database using password_verify(). Just store Username and Password hash in the user database table, you will then be able to compare it to a user-submitted password using password_verify().How password hash()'ing works:The password_hash() function outputs a unique password hash, when storing the string in a database -- it is recommended that the column allows up to 255 characters.To verify a hashed password, you use password_verify():If you prefer, salt can be added manually as an option, like so:Replace rand(0,61) with mt_rand(0, 61) and you should be fine (Since mt_rand is better at producing random numbers)...  But more important than strength of the salt is the way you hash it.  If you have a great salt routine, but only do md5($pass.$salt), you're throwing away the salt.  I personally recommend stretching the hash... For example:For more information on hash stretching, check out this SO answer...I would take advice from another answer and use mt_rand(0, 61), because the Mersenne Twister produces better entropy.Additionally, your function is really two parts: generating random $nbLetters digits and encoding that in base62.  This will make things much clearer to a maintenance programmer (maybe you!) who stumbles across it a few years down the road:This is my method, It uses truly random numbers from atmospheric noise. It is all mixed in with pseudo-random values and strings. Shuffled and hashed. Here is my code: I call it overkill.The atmospheric noise is provided by random.org. I have also seen truly random generation from images of lava lamps that are interpreted via hue and location. (Hue is location)Here is a much better way if you have windows and cant do /dev/random.I think that a very good salt for example is the user name (if you are talking about pw hashing and the user name doesn't change.)You don't need to generate anything and don't need to store further data.A fairly simple technique:Unlike uniqid() it generates a random result.I use this: If you want ultimate unique salt you should use a unique value entered and required by the user such as the email or the username, then hashing it using sha1 and then merge it - concatenate -  with the salt value generated by your code.Another, you have to extend $charUniverse by the mean of some special characters such as @,!#- etc. 

Laravel Eloquent compare date from datetime field

almo

[Laravel Eloquent compare date from datetime field](https://stackoverflow.com/questions/25139948/laravel-eloquent-compare-date-from-datetime-field)

I want to get all the rows from a table through an expression:But if the column contains a datetime let's say:But if I do: it won't get the row.I guess this is because $date = 2014-07-10 which makes MySQL assume that it is 2014-07-10 00:00:00.In regular MySQL I would just doWhat would be the equivalent using Laravel's Eloquent?

2014-08-05 13:23:44Z

I want to get all the rows from a table through an expression:But if the column contains a datetime let's say:But if I do: it won't get the row.I guess this is because $date = 2014-07-10 which makes MySQL assume that it is 2014-07-10 00:00:00.In regular MySQL I would just doWhat would be the equivalent using Laravel's Eloquent?Laravel 4+ offers you these methods: whereDay(), whereMonth(), whereYear() (#3946) and whereDate() (#6879).They do the SQL DATE() work for you, and manage the differences of SQLite.Your result can be achieved as so:For more examples, see first message of #3946 and this Laravel Daily article.

Update: Though the above method is convenient, as noted by Arth it is inefficient on large datasets, because the DATE() SQL function has to be applied on each record, thus discarding the possible index.Here are some ways to make the comparison (but please read notes below):Notes:Have you considered using:You should avoid using the DATE() function on indexed columns in MySQL, as this prevents the engine from using the index.UPDATEAs there seems to be some disagreement about the importance of DATE() and indexes, I have created a fiddle that demonstrates the difference, see POSSIBLE KEYS.You can get the all record of the date '2016-07-14' by using itOr use the another code for dynamic dateYou can use thisIf you give whereDate then compare only date from datetime field.If you're still wondering how to solve it.I use $protected $dates = ['created_at','updated_at','aired'];In my model and in my where i do where('aired','>=',time())So just use the unix to compaire in where. In views on the otherhand you have to use the date object.Hope it helps someone!

