I would like to convert a variable $uptime which is seconds, into days, hours, minutes and seconds.Example:Result should be: 

2011-11-25 20:14:11Z

I would like to convert a variable $uptime which is seconds, into days, hours, minutes and seconds.Example:Result should be: This can be achieved with DateTime classUse:Function:demoThis is the function rewritten to include days.  I also changed the variable names to make the code easier to understand...Source: CodeAid() - http://codeaid.net/php/convert-seconds-to-hours-minutes-and-seconds-(php)Based on the answer by Julian Moreno, but changed to give the response as a string (not an array), only include the time intervals required and not assume the plural.The difference between this and the highest voted answer is:For 259264 seconds, this code would giveFor 259264 seconds, the highest voted answer (by Glavić) would give I hope this helps someone.Here it is a simple 8-lines PHP function that converts a number of seconds into a human readable string including number of months for large amounts of seconds:PHP function seconds2human()Result will be 19 23:41:07. When it is just one second more than normal day, it is increasing the day value for 1 day. This is why it show 19. You can explode the result for your needs and fix this.There are some very good answers here but none of them covered my needs. I built on Glavic's answer to add some extra features that I needed;You can see a running version of the code here.Short, simple, reliable :The simplest approach would be to create a method that returns a DateInterval from the DateTime::diff of the relative time in $seconds from the current time $now which you can then chain and format. For example:-Now chain your method call to DateInterval::formatResult:Although it is quite old question - one may find these useful (not written to be fast):result:Solution that should exclude 0 values and set correct singular/plural valuesan extended version of Glavić's excellent solution , having integer validation, solving the 1 s problem, and additional support for years and  months, at the expense of being less computer parsing friendly in favor of being more human friendly:var_dump(secondsToHumanReadable(1*60*60*2+1)); -> string(16) "2 hours 1 second"Interval class I have written can be used. It can be used in opposite way too.More info here https://github.com/LubosRemplik/CakePHP-IntervalWith DateInterval :Here's some code that I like to use for the purpose of getting the duration between two dates. It accepts two dates and gives you a nice sentence structured reply. This is a slightly modified version of the code found here.Source: https://gist.github.com/ozh/8169202All in one solution. Gives no units with zeroes. Will only produce number of units you specify (3 by default).

Quite long, perhaps not very elegant. Defines are optional, but might come in handy in a big project.Feel free to down-vote, but be sure to try it in your code. It might just be what you need.The solution for this one I used (back to the days while learning PHP) without any in-functions:Though this was an old question, new learners who come across this, may find this answer useful.I don't know why some of these answers are ridiculously long or complex. Here's one using the DateTime Class. Kind of similar to radzserg's answer. This will only display the units necessary, and negative times will have the 'ago' suffix...EDIT: If you want to condense the above example down to use less variables / space (at the expense of legibility), here is an alternate version that does the same thing:$value come from Database. This code is in Codeigniter. $SESSION is used for storing user subscriptions. it is mandatory. I used it in my case, you can use whatever you want.This is a function i used in the past for substracting a date from another one related with your question, my principe was to get how many days, hours minutes and seconds has left until a product has expired :

Real escape string and PDO [duplicate]

John

[Real escape string and PDO [duplicate]](https://stackoverflow.com/questions/3716373/real-escape-string-and-pdo)

I'm using PDO after migrating away from the mysql library. What do I use in place of the old real_escape_string function?I need to escape single quotes so they will go into my database and I think there may be a better way to handle this without add(ing) slashes to all my strings. What should I be using?

2010-09-15 09:34:01Z

I'm using PDO after migrating away from the mysql library. What do I use in place of the old real_escape_string function?I need to escape single quotes so they will go into my database and I think there may be a better way to handle this without add(ing) slashes to all my strings. What should I be using?You should use PDO PrepareFrom the link:PDO offers an alternative designed to replace mysql_escape_string() with the PDO::quote() method.Here is an excerpt from the PHP website:The above code will output:Use prepared statements. Those keep the data and syntax apart, which removes the need for escaping MySQL data. See e.g. this tutorial.

file_put_contents permission denied

Hailwood

[file_put_contents permission denied](https://stackoverflow.com/questions/4917811/file-put-contents-permission-denied)

I am trying to write a query to a file for debugging. The file is in database/execute.php. The file I want to write to is database/queries.php.I am trying to use file_put_contents('queries.txt', $query)But I am getting I have the queries.txt file chmod'd to 777, what could the issue be?

2011-02-07 03:14:35Z

I am trying to write a query to a file for debugging. The file is in database/execute.php. The file I want to write to is database/queries.php.I am trying to use file_put_contents('queries.txt', $query)But I am getting I have the queries.txt file chmod'd to 777, what could the issue be?Try adjusting the directory permissions.from a terminal, run chmod 777 database (from the directory that contains the database folder)apache and nobody will have access to this directory if it is chmodd'ed correctly.The other thing to do is echo "getcwd()". This will show you the current directory, and if this isn't '/something.../database/' then you'll need to change 'query.txt' to the full path for your server.is that you can make Apache (www-data), the owner of the folderthat should make file_put_contents work now. But for more security you better also set the permissions like below Realise this is pretty old now, but there's no need to manually write queries to a file like this. MySQL has logging support built in, you just need to enable it within your dev environment.Take a look at the documentation for the 'general query log':http://dev.mysql.com/doc/refman/5.1/en/query-log.htmlGuys I had this problem for 1 month and did everything but couldn't fix it, but now I know the solution. I use a shared linux hosting, when my admin changed the php to 5.3 I got many error for the "file_put_contents" code. try to test my plan:In your host create a file like mytest.php, and put this code in and save:Open the URL "www.your-domain.com/mytest.php" one time and then check your email. you should have an email from your host with the information you entered in mytest.php, check the sender name. if its from Nobody you have problem about "Permission Denied" because something not defined and if the sender name is like my id: iietj8qy@hostname5.netly.net you dont have prob.My admin changed the server and installed the host again I think and the problem got solved, tell your host administration what I told you and maybe they find the answer.hope it helps you!I know that it is a very old question, but I wanted to add the good solution with some in depth explanation. You will have to execute two statements on Ubuntu like systems and then it works like a charm. Permissions in Linux can be represented with three digits. The first digit defines the permission of the owner of the files. The second digit the permissions of a specific group of users. The third digit defines the permissions for all users who are not the owner nor member of the group.The webserver is supposed to execute with an id that is a member of the group. The webserver should never run with the same id as the owner of the files and directories. In Ubuntu runs apache under the id www-data. That id should be a member of the group for whom the permissions are specified.To give the directory in which you want to change the content of files the proper rights, execute the statement:.That would imply in the question of the OP that the permissions for the directory %ROOT%/database should be changed accordingly. It is therefor important not to have files within that directory that should never get changed, or removed. It is therefor best practice to create a separate directory for files whose content must be changed.Reading permissions (4) for a directory means being able to collect all files and directories with their metadata within a directory. Write permissions (2) gives the permission to change the content of the directory. Implying adding and removing files, changing permissions etc.. Execution permission (1) means that you have the right to go into that directory. Without the latter is it impossible to go deeper into the directory. The webserver needs read, write and execute permissions when the content of a file should be changed. Therefor needs the group the digit 7.The second statement is in the question of the OP:Being able to read and write a document is required, but it is not required to execute the file. The 7 is given to the owner of the files, the 6 to the group. The webserver does not need to have the permission to execute the file in order to change its content. Those write permissions should only be given to files in that directory.All other users should not be given any permission.For directories that do not require to change its files are group permissions of 5 sufficient.

Documentation about permissions and some examples:https://wiki.debian.org/Permissionshttps://www.linux.com/learn/tutorials/309527-understanding-linux-file-permissionshttp://www.linux.org/threads/file-permissions-chmod.4094/Gathering info from this link stackoverflow-image save doesn't work with chmod 777 and from user azerafati and Loek Bergmanif you were to look under /etc/apache/envvars file you will see something like:Apache is run under the username 'www-data''0755' means the file owner can read/write/execute but group and other users cannot write. so in ur terminal, cd to the folder containing your 'images' folder. then type:you must change persmissions first before changing owner.

enter your password when prompted. this will make 'www-data' owner of the images folder.your upload should now work.For anyone using Ubuntu and receiving this error when loading the page locally, but not on a web hosting service,I just fixed this by opening up nautilus (sudo nautilus) and right click on the file you're trying to open, click properties > Settings > and give read write to 'everyone else'had the same problem; my issue was selinux was set to enforcing. I kept getting the "failed to open stream: Permission denied" error even after chmoding to 777 and making sure all parent folders had execute permissions for the apache user. Turns out my issue was that selinux was set to enforcing (I'm on centos7), this is a devbox so I turned it off. This can be resolved in resolved with the following steps : Hope it helpsIf you are pulling from git from local to server, you will need to clear cache sometimes because of the view files it gets uploaded with it / or other cached files .Sometimes it might just to the trick if your application was working before the git pullThere 2 way to resolve this issues

1. use chmod 777 path-to-your-directory.

if it does not work then

2. simply provide the complete path of your file query.txt.Here the solution.

To copy an img from an URL.

this URL: http://url/img.jpgcreate the desired path finish the name with .jpgFurthermore, as said in file_put_contents man page in php.net, beware of naming issues.may not work (even though it is correct on syntax), butworks. I experienced this on different php installed servers.

Creating a config file in PHP

Ali Akbar Azizi

[Creating a config file in PHP](https://stackoverflow.com/questions/14752470/creating-a-config-file-in-php)

I want to create a config file for my PHP project, but I'm not sure what the best way to do this is.I have 3 ideas so far.1-Use Variable2-Use Const3-Use DatabaseI will be using the config in classes so I'm not sure which way would be the best or if there is a better way.

2013-02-07 13:37:52Z

I want to create a config file for my PHP project, but I'm not sure what the best way to do this is.I have 3 ideas so far.1-Use Variable2-Use Const3-Use DatabaseI will be using the config in classes so I'm not sure which way would be the best or if there is a better way.One simple but elegant way is to create a config.php file (or whatever you call it) that just returns an array:And then:Use an INI file is a flexible and powerful solution! PHP has a native function to handle it properly. For example, it is possible to create an INI file like this:app.iniSo the only thing you need to do is call:Then you can access the definitions easily using the $ini array.IMPORTANT: For security reasons the INI file must be in a non public folderI use a slight evolution of @hugo_leonardo 's solution: This allows you to use the object syntax when you include the php : $configs->host instead of $configs['host'].Also, if your app has configs you need on the client side (like for an Angular app), you can have this config.php file contain all your configs (centralized in one file instead of one for JavaScript and one for PHP). The trick would then be to have another PHP file that would echo only the client side info (to avoid showing info you don't want to show like database connection string). Call it say get_app_info.php :The above assuming your config.php contains an app_info parameter:So your database's info stays on the server side, but your app info is accessible from your JavaScript, with for example a $http.get('get_app_info.php').then(...); type of call.The options I see with relative merits / weaknesses are:File based mechanismsThese require that your code look in specific locations to find the ini file. This is a difficult problem to solve and one which always crops up in large PHP applications. However you will likely need to solve the problem in order to find the PHP code which gets incorporated / re-used at runtime.Common approaches to this are to always use relative directories, or to search from the current directory upwards to find a file exclusively named in the base directory of the application. Common file formats used for config files are PHP code, ini formatted files, JSON, XML, YAML and serialized PHPPHP codeThis provides a huge amount of flexibility for representing different data structures, and (assuming it is processed via include or require) the parsed code will be available from the opcode cache - giving a performance benefit.The include_path provides a means for abstracting the potential locations of the file without relying on additional code.On the other hand, one of the main reasons for separating configuration from code is to separate responsibilities. It provides a route for injecting additional code into the runtime.If the configuration is created from a tool, it may be possible to validate the data in the tool, but there is no standard function to escape data for embedding into PHP code as exists for HTML, URLs, MySQL statements, shell commands....Serialized data

This is relatively efficient for small amounts of configuration (up to around 200 items) and allows for use of any PHP data structure. It requires very little code to create/parse the data file (so you can instead expend your efforts on ensuring that the file is only written with appropriate authorization).Escaping of content written to the file is handled automatically.Since you can serialize objects, it does create an opportunity for invoking code simply by reading the configuration file (the __wakeup magic method).Structured fileStoring it as a INI file as suggested by Marcel or JSON or XML also provides a simple api to map the file into a PHP data structure (and with the exception of XML, to escape the data and create the file) while eliminating the code invocation vulnerability using serialized PHP data.It will have similar performance characteristics to the serialized data.Database storageThis is best considered where you have a huge amount of configuration but are selective in what is needed for the current task - I was surprised to find that at around 150 data items, it was quicker to retrieve the data from a local MySQL instance than to unserialize a datafile.OTOH its not a good place to store the credentials you use to connect to your database!The execution environmentYou can set values in the execution environment PHP is running in. This removes any requirement for the PHP code to look in a specific place for the config. OTOH it does not scale well to large amounts of data and is difficult to change universally at runtime.On the clientOne place I've not mentioned for storing configuration data is at the client. Again the network overhead means that this does not scale well to large amounts of configuration. And since the end user has control over the data it must be stored in a format where any tampering is detectable (i.e. with a cryptographic signature) and should not contain any information which is compromised by its disclosure (i.e. reversibly encrypted).Conversely, this has a lot of benefits for storing sensitive information which is owned by the end user - if you are not storing this on the server, it cannot be stolen from there.Network Directories

Another interesting place to store configuration information is in DNS / LDAP. This will work for a small number of small pieces of information - but you don't need to stick to 1st normal form - consider, for example SPF. The infrastucture supports caching, replication and distribution. Hence it works well for very large infrastructures.Version Control systemsConfiguration, like code should be managed and version controlled - hence getting the configuration directly from your VC system is a viable solution. But often this comes with a significant performance overhead hence caching may be advisable.Well - it would be sort of difficult to store your database configuration data in a database - don't ya think?But really, this is a pretty heavily opinionated question because any style works really and it's all a matter of preference. Personally, I'd go for a configuration variable rather than constants - generally because I don't like things in the global space unless necessary. None of the functions in my codebase should be able to easily access my database password (except my database connection logic) - so I'd use it there and then likely destroy it.Edit: to answer your comment - none of the parsing mechanisms would be the fastest (ini, json, etc) - but they're also not the parts of your application that you'd really need to focus on optimizing since the speed difference would be negligible on such small files.Define will make the constant available everywhere in your class without needing to use global, while the variable requires global in the class, I would use DEFINE. but again, if the db params should change during program execution you might want to stick with variable.If you think you'll be using more than 1 db for any reason, go with the variable because you'll be able to change one parameter to switch to an entirely different db. I.e. for testing , autobackup, etc.You can create a config class witch static propertiesthen you can simple use it:Sometimes in my projects I use a design pattern SINGLETON to access configuration data. It's very comfortable in use.Why?For example you have 2 data source in your project. And you can choose witch of them is enabled.Somewhere in config file you choose:When you change source whole app shoud switch to new data source, work fine and dont need change in code.Example:Config:Singleton class:... and somewhere in your code (eg. in some service class):We can obtain an AppConfig object from any place in the system and always get the same copy (thanks to static). The init () method of the class is called

In the constructor, which guarantees only one execution. Init() body checks

The value of the config $dataSource, and create new object of specific data source class. Now our script can get object and operate on it, not knowing

even which specific implementation actually exists.I normally end up creating a single conn.php file that has my database connections. 

Then i include that file in all files that require database queries. Here is my way.?>Any doubts please comment

MySQL Database won't start in XAMPP Manager-osx

nitrous

[MySQL Database won't start in XAMPP Manager-osx](https://stackoverflow.com/questions/21267064/mysql-database-wont-start-in-xampp-manager-osx)

I downloaded XAMPP about a month ago and it was working just fine. Today I installed a voice recognition software and then restarted my computer. Ever since, MySQL won't start in my manager-osx application. It doesn't throw me an in the application log. This is what it says:Both my ProFTPD and my Apache Web Server are running. MySQL isn't.

When I go to phpmyadmin, it throws me this error message.Please help me. I have no idea what to do.UPDATE: After looking around the internet a bit, I found a similar problem a user had with MAMP, another user recommended killing the mysql process, what ever that means. Could this be a fix to my problem?UPDATE 2: I found the answer to my problem but I can't answer it yet. So here's the answer:1) Open terminal and typeand then put in  your password2) Then type (just copy and paste this)3) You will need to get the process id of mysql. There should be number near the top, something like 739 or 88274) Kill the process usingthis should look something like this: kill -9 7395) Restart MySQL in manager-osx

2014-01-21 19:13:36Z

I downloaded XAMPP about a month ago and it was working just fine. Today I installed a voice recognition software and then restarted my computer. Ever since, MySQL won't start in my manager-osx application. It doesn't throw me an in the application log. This is what it says:Both my ProFTPD and my Apache Web Server are running. MySQL isn't.

When I go to phpmyadmin, it throws me this error message.Please help me. I have no idea what to do.UPDATE: After looking around the internet a bit, I found a similar problem a user had with MAMP, another user recommended killing the mysql process, what ever that means. Could this be a fix to my problem?UPDATE 2: I found the answer to my problem but I can't answer it yet. So here's the answer:1) Open terminal and typeand then put in  your password2) Then type (just copy and paste this)3) You will need to get the process id of mysql. There should be number near the top, something like 739 or 88274) Kill the process usingthis should look something like this: kill -9 7395) Restart MySQL in manager-osxThis should work:

sudo /Applications/XAMPP/xamppfiles/bin/mysql.server start1.

sudo killall mysqld2.

manager-osx > start mysqlsudo /Applications/XAMPP/xamppfiles/bin/mysql.server startGoogle the error...Error:ERROR! The server quit without updating PID file (/Applications/XAMPP/xamppfiles/var/mysql/<computername>.local.pid)My Solution:In /Applications/XAMPP/xamppfiles/etc/my.cnf change user = <uid> s that <uid> is uid from id command.If these commands don't work for you:     Try this: For XAMPP 7.1.1-0, I changed the port number from 3306 to 3307.You are now good to go. check the err log on your /Applications/XAMPP/xamppfiles/var/mysql/ with filename like your_machine_name.local.err, if you find something like:  "Attempted to open a previously opened tablespace. Previous tablespace ... uses space ID"the following works for me:edit file:/Applications/XAMPP/xamppfiles/etc/my.cnffind the [mysqld] section, add one line:innodb_force_recovery = 1then runsudo /Applications/XAMPP/bin/mysql.server starteverything is ok again.and then the last step: edit the my.cnf again and remove the line you just added : innodb_force_recovery = 1 and restart mysql again. Otherwise all your tables will be read onlyI've tried all these methods with no luck (including of course rebooting) but when II simply get:Not exactly the most helpful information!For me the following worked: Change permission into 'read only' for 'everyone' to the file /Applications/XAMPP/xamppfiles/etc/my.cnf. Then start MySQL from XAMPP manager.Try running these two commands in the terminal:I first couldn't manage to kill mysql daemon with the commands posted here. So I remembered my linux times and did the following:I monitored the running processes by running top in one terminal window. Then I killed mysqld via sudo killall mysqld (screw the PID ;-) ) in another and restarted via sudo /Applications/XAMPP/xamppfiles/bin/mysql.server start.it happened to me. and not work for me.attention:There's been a lot of answer, but I think I found what is causing it, at least for me. It looks like if you put your computer to sleep (or it falls asleep on its own), when it reopens, it tries to open the the mysql process again. At one point I looked at my activity monitor and I had 5 instances running - killing all of them and then starting mysql works.This worked for me.I had success with easy killing all active mysql processes in Monitor Activity tool:1) close XAMPP control2) open Monitor Activity3) select filter for All processes (default is My processes)4) search for: mysql5) force quit all the mysql 6) relaunch XAMPP control and launch apache againEnjoy try these two line from terminalIt can cause because of the software you installed or may be any other software which is using the same port 3306. This 3306 port is used by the Mysql in XAMPP. Similar kind of problem I faced for Apache. I was running skype and trying to run the XAMPP but the skype uses the same port as Apache so it was not working. Then I sign out from skype then the port was free and the apache started. So you should look for the software in you laptop which is blocking or making busy this port. Free that port by closing the software and then run XAMPP and It will work.What I did was the following: In XAMPP Control Panel I edited the my.ini file of configuration of MySql and changed the port from 3306 to 3307 and it worked, hope it helped!Edit: after you save this changes be sure that the service is off and then restart the service. I had this same problem when I installed MySQL, it's just the port.I encountered this problem just now. I checked log file and found it is caused by the server was not shutdown correctly. So I found this http://rivenlinux.info/how-to-recover-innodb-corruption-for-mysql/ and add a simple configuration "innodb_force_recovery = 1" in [mysqld] in my.cnf. Then the problem was solved.The log file is located /Applications/XAMPP/xamppfiles/var/mysql and it named accroding to your server name. Just link this XXX-MacBook-Pro.local.errAll the answers stated above in relation to changing the port number are in this situation the best way to solve this problem since you need your voice recognition software to coexist with MAMP. However, you must remember that changing this port number is going to affect all you subsequent connections to MySQL (i.e, terminal,php code,phpmyadmin,etc). Hence It would be advisable to change the port on which the voice recognition software runs. Hope this was helpful.:)if you are getting this errorTry this Go to /Applications/XAMPP/xamppfiles/var/mysql/if there is no file with the name Your_Username.local.pidYour_Username should replace with your Mac UsernameCreate a file with this nameThen tryits worked for meIt had the same problem, all I did was give read-only permissions for ALL users (system included) and all items included in the following folders:and relaunch XAMPP control and launch mysql server again

orThis could be due to the fact that another instance of mysqd is already running in your mac-book-pro (MacOs-10). It's next to impossible to kill/pkill mysqld or   ....I tried that route many times, with out any success. Finally the following worked for me :wait a few minutes and check with It should be gone!on if mysql is not getting started from manager- oxs and have tried direct command i.e sudo /Applications/XAMPP/bin/mysql.server start too than 

go to path edit find file : edit it under the [mysqld] section, add following line:after it save and  run or can be done from manager-osx it should start the mysql.once its run you need to again

edit the file and remove the line just addedstop and start mysql again. by command or 

by manager-osx it will be working fine. It might be the possibility that your voice recognition software has a installer of mysql internally and when u installed this software, it has installed mysql too and added it to the service and this mysql service starts once your system starts. So now u r having two mysql servers (one from voice recognition software and second is from XAMPP) that's why killing the previous process (mysql service)  solved your problem. But this is not a permanent solution, you have to repeat it every time when ever you start your machine. So better is to find out that mysql server (service) and change its port no. OR change settings so that mysql service should not start when your machine start (but might be your voice recognition software won't work properly)I hope it will help you.CheersYou seem to have found a work-around by killing the process, but make sure you check for free space on your MySQL partition. If your logs or db files are consuming all your drive space, mysqld will not start.Restarting the computer, or using the 'kill' commands listed above solve the problem. AS for preventing it from happening, I've found this occurring anytime my computer goes to sleep. The port is obviously kept reserved, and then on wake, mysql tries to reconnect to that port, but can't. This could be your problem also.I am running XAMPP 5.6.3-0 for OS X Yosemite 10.10.2 and ran into the same issue twice, the first time was with Mavericks. With a bunch of different solutions to the issue with MySQL Database not starting using Manager App I wanted to confirm what had worked for me. The workaround that always worked and forced MySQL to start was by opening Terminal and using: 

sudo /Applications/XAMPP/xamppfiles/bin/mysql.server start 

I had the Manager App open and started ProFTPD and Apache and then ran the sudo command.The other suggestion by wishap that worked was to locate /Applications/XAMPP/xamppfiles/etc/my.cnf file and change the permissions for "everyone" to Read only. The other problem I had that seems to be another issue with many solutions is the problem after everything is started then entering localhost which brings me to the xampp splash screen and then nothing. The only thing that worked for me, to at the very least, to access the phpMyAdmin page is by entering localhost/phpmyadminI hope this helps others reading through a bunch of threads for an answer. Regards, 

ErikTry this, sudo service mysql stop it will stop any other mysql services and then restart xamppJust Click on Managed Servers Tab in XAMPP MANAGER , Now select MySQL Database, Click on configure on right side.Change port from 3306 to 3307 and it will work.It had the same problem, all I did was give read-only permissions for all users and all items included in the following folders:Well, sometime there is just ERROR! message is shown in mysql comment on terminal. 

Then, just reinstall (overwrite) XAMPP, then it can be solved.

Commands out of sync; you can't run this command now

Joshxtothe4

[Commands out of sync; you can't run this command now](https://stackoverflow.com/questions/614671/commands-out-of-sync-you-cant-run-this-command-now)

I am trying to execute my PHP code, which calls two MySQL queries via mysqli, and get the error "Commands out of sync; you can't run this command now".Here is the code I am usingI have tried reading up on this, but I am unsure of what to do. I have read about store result and free result, however these have made no difference when using them. I am unsure at exactly which point this error is being caused, and would like to know why it is being caused, and how to fix it.Going by my debug statements, the first if loop for countQuery is not even being entered, because of an error in my sql syntax near near '% ? %'. However if I just select * instead of trying to limit based on a LIKE clause, I still get the command out of sync error.

2009-03-05 13:05:32Z

I am trying to execute my PHP code, which calls two MySQL queries via mysqli, and get the error "Commands out of sync; you can't run this command now".Here is the code I am usingI have tried reading up on this, but I am unsure of what to do. I have read about store result and free result, however these have made no difference when using them. I am unsure at exactly which point this error is being caused, and would like to know why it is being caused, and how to fix it.Going by my debug statements, the first if loop for countQuery is not even being entered, because of an error in my sql syntax near near '% ? %'. However if I just select * instead of trying to limit based on a LIKE clause, I still get the command out of sync error.You can't have two simultaneous queries because mysqli uses unbuffered queries by default (for prepared statements; it's the opposite for vanilla mysql_query). You can either fetch the first one into an array and loop through that, or tell mysqli to buffer the queries (using $stmt->store_result()).See here for details.I solved this problem in my C application - here's how I did it:I don't know PHP but I'm sure it has something similar.I had today the same problem, but only when working with a stored procedure. This make the query behave like a multi query, so you need to "consume" other results available before make another query.I call this function every time before using $mysqli->query

Works with stored procedures as well.Once you used You MAY close it to use another query. This problem was hunting me for hours. Hopefully, it will fix yours.I use CodeIgniter. 

One server OK ... this one probably older ... 

Anyway using Fixed it.The problem is the MySQL client C library, which most MySQL APIs are built on. The problem is that the C library doesn't support simultaneous execution of queries, so all APIs built on top of that also do not. Even if you use unbuffered queries. This is one reason why the asynchronous MySQL API was written. It communicates directly with the MySQL server using TCP and the wire-protocol does support simultaneous queries.Your solution is to either modify the algorithm so you don't need to have both in progress at once, or change them to use buffered queries, which is probably one of the original reasons for their existence in the C library (the other is to provide a kind of cursor).to solve this problem you have to store result data before use it that's allFor those that the previous answers didn't help... here is what was MY PROBLEM!!!the param binding was "dynamic" so I had a variable that sets the params of the data in order to use bind_param. So that variable was wrong but instead of throwing an error like "wrong param data" it says "out of sync bla bla bla" so I was confused...I hope it helped someone!Another cause:  store_result() cannot be called twice.For instance, in the following code, Error 5 is printed.(This may not be relevant to the original sample code, but it can be relevant to people seeking answers to this error.)I think the problem is that you're making a new connection in the function, and then not closing it at the end.  Why don't you try passing in the existing connection and re-using it?Another possibility is that you're returning out of the middle of a while loop fetching.  You never complete that outer fetch.Check to see if you are typing all the parameters correctly. It throws the same error if the amount of parameters defined and then passed to the function are different.This is not related to the original question, but i had the same error-message and this thread is the first hit in Google and it took me a while to figure out what the Problem was, so it May be of use for others:i'm NOT using mysqli, still using mysql_connect

i had some simple querys, but ONE query caused all other querys to fail within the same Connection.I use mysql 5.7 and php 5.6

i had a table with the data-Type "JSON". obviously, my php-version did not recognize the return value from mysql (php just did not know what to do with the JSON-Format because the built-in mysql-module was too old (at least i think))for now i changed the JSON-Field-Type to Text (as for now i don't need the native mysql JSON-functionality) and everything works fineIf you either use Buffered or Unbuffered result set for fetching data, first you must simply clear the fetched data from the memory, once you have fetched all the data. As you can't execute another MYSQL procedure on the same connection till you clear the fetched memory. Add this below function right end of your script, so it will solve the problemReference from the PHP documentationI ran into this error using Doctrine DBAL QueryBuilder.I created a query with QueryBuilder that uses column subselects, also created with QueryBuilder. The subselects were only created via $queryBuilder->getSQL() and not executed. The error happened on creating the second subselect. By provisionally executing each subselect with $queryBuilder->execute() before using $queryBuilder->getSQL(), everything worked. It is as if the connection $queryBuilder->connection remains in an invalid state for creating a new SQL before executing the currently prepared SQL, despite the new QueryBuilder instance on each subselect.My solution was to write the subselects without QueryBuilder.My problem was that I was using first prepare statement and then I was using mysqli query on the same page and was getting the error "Commands out of sync; you can't run this command now". The error  was only then when I was using the code that had prepare statement. What I did was to close the question. and it worked.mysqli_stmt_close($stmt);My code get_category.php (here using prepare statement )admin_get_category_body.php (here mysqli)Something that just crossed my mind, I am also again adding connection variable via global $connection;. So I think basically a whole new set of query system is being started after ending of prepare statement with mysqli_stmt_close($stmt); and also I am adding these files and other stuff via includeCreate  two  connections, use both separately

Execute PHP function with onclick

Mike

[Execute PHP function with onclick](https://stackoverflow.com/questions/19323010/execute-php-function-with-onclick)

I am searching for a simple solution to call a PHP function only when a-tag is clicked.PHP:HTML:UPDATE: the html and PHP code are in the same PHP file

2013-10-11 16:31:01Z

I am searching for a simple solution to call a PHP function only when a-tag is clicked.PHP:HTML:UPDATE: the html and PHP code are in the same PHP fileFirst, understand that you have three languages working together:I'm assuming your file looks something like:Because PHP only responds to requests (GET, POST, PUT, PATCH, and DELETE via $_REQUEST), this is how you have to run a PHP function even though they're in the same file.  This gives you a level of security, "Should I run this script for this user or not?".If you don't want to refresh the page, you can make a request to PHP without refreshing via a method called Asynchronous JavaScript and XML (AJAX).That is something you can look up on YouTube though.  Just search "jquery ajax"I recommend Laravel to anyone new to start off right: http://laravel.com/In javascript, make an ajax function,Then call from html,And in your ajax.php,You will have to do this via AJAX. I HEAVILY reccommend you use jQuery to make this easier for you....http://api.jquery.com/jQuery.ajax/It can be done and with rather simple php

if this is your buttonand this is your php codethe code get's called when submit get's posted which happens when the button is clicked.Try to do something like this:Solution without page reloadThis is the easiest possible way. If form is posted via post, do php function. Note that if you want to perform function asynchronously (without the need to reload the page), then you'll need AJAX.Try this it will work fine.

Accessing an associative array by integer index in PHP

Marty

[Accessing an associative array by integer index in PHP](https://stackoverflow.com/questions/4769148/accessing-an-associative-array-by-integer-index-in-php)

I want to set the value of an associative array using the array index of the key/value pair.  For example:How can this be accomplish this without using the key string?

2011-01-22 16:52:05Z

I want to set the value of an associative array using the array index of the key/value pair.  For example:How can this be accomplish this without using the key string?Use array_keys.Hope this helps.  There is no correlation between numeric and associative index keys.When you say you want to set the value of an associative array using the array index of the key/value, then you have to use the given key, setting $array[1] is not the same as setting $array['foo'].Consider this arrayThis will giveThe foo is the second element in the array. That's the offset, but it has nothing to do with the index 1. As you can see, in that array above, index 1 is associated with baz. It is wrong to assume that just because foo is the first associative key it has anything to do with the actual numeric key 1. Just like some does not correlate to 2.Likewise, for a mixed array like shown above, the solution with array_keys suggested elsewhere on this site will not work, becausewill giveSo when you do $array[$keys[1]] you are really doing $array['foo']. But if you wanted to access the second associative value in that array ('some'), you cannot do $array[$keys[2]] because that would evaluate to $array[1] and that's baz.The Offset of an element is completely unrelated to it's key or valuereally meanswhich means the element at offset 0 is foo although it's key is 100. If you want to extract elements from an array by offset, you have to useThis would create an array holding only the element at the third position.Or you could use an ArrayIterator. The ArrayIterator implements a Seekable interface that lets you seek to a specific position/offset in the array and then fetch that:Whilst array_keys() allows access to the nth key, array_values will give you the nth value.will output 'Two'.Is there an advantage of one over the other? Well, the only minor one I can see is the number of array accesses.With array_keys() you need to 3.With array_values(), you only need 2.But, on the other hand, keys are normally smaller and the data could be hugely nested, so, on balance, using the array_keys() is probably safer.If the array is large, both array_keys and array_values will be wasteful since they will allocate a new array the same size as the original, just to get the nth key (or value).array_slice accepts an integer offset and works on associative arrays. You can use it to get (and set) the nth key in constant time.Try this. It works for you.Another possibility is to convert it to a normal array:Where "~~~" is a delimiter that wont occur in your data.Now you can access the array using numerical indexes equal to the offsets.If you still need to retain your associative array, just assign it to a different variable.

Alternative to mysql_real_escape_string without connecting to DB

Viet

[Alternative to mysql_real_escape_string without connecting to DB](https://stackoverflow.com/questions/1162491/alternative-to-mysql-real-escape-string-without-connecting-to-db)

I'd like to have a function behaving as mysql_real_escape_string without connecting to database as at times I need to do dry testing without DB connection. mysql_escape_string is deprecated and therefore is undesirable. Some of my findings:http://www.gamedev.net/community/forums/topic.asp?topic_id=448909http://w3schools.invisionzone.com/index.php?showtopic=20064

2009-07-22 00:38:48Z

I'd like to have a function behaving as mysql_real_escape_string without connecting to database as at times I need to do dry testing without DB connection. mysql_escape_string is deprecated and therefore is undesirable. Some of my findings:http://www.gamedev.net/community/forums/topic.asp?topic_id=448909http://w3schools.invisionzone.com/index.php?showtopic=20064It is impossible to safely escape a string without a DB connection. mysql_real_escape_string() and prepared statements need a connection to the database so that they can escape the string using the appropriate character set - otherwise SQL injection attacks are still possible using multi-byte characters.If you are only testing, then you may as well use mysql_escape_string(), it's not 100% guaranteed against SQL injection attacks, but it's impossible to build anything safer without a DB connection.Well, according to the mysql_real_escape_string function reference page:  "mysql_real_escape_string() calls MySQL's library function mysql_real_escape_string, which escapes the following characters: \x00, \n, \r, \, ', " and \x1a."With that in mind, then the function given in the second link you posted should do exactly what you need:In direct opposition to my other answer, this following function is probably safe, even with multi-byte characters.I'm hoping someone more knowledgeable than myself can tell me why the code above won't work ...From further research, I've found:http://dev.mysql.com/doc/refman/5.1/en/news-5-1-11.htmlAn SQL-injection security hole has been found in multi-byte encoding processing. The bug was in the server, incorrectly parsing the string escaped with the mysql_real_escape_string() C API function.This vulnerability was discovered and reported by Josh Berkus  and Tom Lane  as part of the inter-project security collaboration of the OSDB consortium. For more information about SQL injection, please see the following text.Discussion.  An SQL injection security hole has been found in multi-byte encoding processing. An SQL injection security hole can include a situation whereby when a user supplied data to be inserted into a database, the user might inject SQL statements into the data that the server will execute. With regards to this vulnerability, when character set-unaware escaping is used (for example, addslashes() in PHP), it is possible to bypass the escaping in some multi-byte character sets (for example, SJIS, BIG5 and GBK). As a result, a function such as addslashes() is not able to prevent SQL-injection attacks. It is impossible to fix this on the server side. The best solution is for applications to use character set-aware escaping offered by a function such mysql_real_escape_string().However, a bug was detected in how the MySQL server parses the output of mysql_real_escape_string(). As a result, even when the character set-aware function mysql_real_escape_string() was used, SQL injection was possible. This bug has been fixed.Workarounds.  If you are unable to upgrade MySQL to a version that includes the fix for the bug in mysql_real_escape_string() parsing, but run MySQL 5.0.1 or higher, you can use the NO_BACKSLASH_ESCAPES SQL mode as a workaround. (This mode was introduced in MySQL 5.0.1.) NO_BACKSLASH_ESCAPES enables an SQL standard compatibility mode, where backslash is not considered a special character. The result will be that queries will fail.To set this mode for the current connection, enter the following SQL statement:You can also set the mode globally for all clients:This SQL mode also can be enabled automatically when the server starts by using the command-line option --sql-mode=NO_BACKSLASH_ESCAPES or by setting sql-mode=NO_BACKSLASH_ESCAPES in the server option file (for example, my.cnf or my.ini, depending on your system). (Bug#8378, CVE-2006-2753)See also Bug#8303.

How do I declare a two dimensional array?

Mask

[How do I declare a two dimensional array?](https://stackoverflow.com/questions/1811100/how-do-i-declare-a-two-dimensional-array)

What's the easiest way to create a 2d array. I was hoping to be able to do something similar to this:

2009-11-28 00:20:23Z

What's the easiest way to create a 2d array. I was hoping to be able to do something similar to this:You can also create an associative array, or a "hash-table" like array, by specifying the index of the array.Which is equivalent toThe following are equivalent and result in a two dimensional array:orJust declare? You don't have to. Just make sure variable exists:Arrays are resized dynamically, and attempt to write anything to non-exsistant element creates it (and creates entire array if needed)This is valid for any number of dimensions without prior declarations.Firstly, PHP doesn't have multi-dimensional arrays, it has arrays of arrays.Secondly, you can write a function that will do it:For a simple, "fill as you go" kind of solution:$foo = array(array());This will get you a flexible pseudo two dimensional array that can hold $foo[n][n] where n <= ∞ (of course your limited by the usual constraints of memory size, but you get the idea I hope). This could, in theory, be extended to create as many sub arrays as you need.Or for larger arrays, all with the same value:will create an $m by $n array with everything set to $value.As far as I'm aware there is no built in php function to do this, you need to do it via a  loop or via a custom method that recursively calls to something like array_fill inidcated in the answer by @Amber;I'm assuming you mean created an empty but intialized array of arrays.  For example, you want a final results like the below of a array of 3 arrays:This is simple to just hand code, but for an arbitrary sized array like a an array of 3 arrays of 3 arrays it starts getting complex to initialize prior to use:...etc...I get the frustration. It would be nice to have an easy way to declare an initialized array of arrays any depth to use without checking or throwing errors.And for me the argument about whether an array should be sparse or not depends on the context.For example, if $a[6][9] is not populated is the equivalent to $a[6][9] being populated with for example with "" or 0.to echo a single array element you should write:output would be: arr1 arr2And I like this way:atli's answer really helped me understand this.  Here is an example of how to iterate through a two-dimensional array.   This sample shows how to find values for known names of an array and also a foreach where you just go through all of the fields you find there.   I hope it helps someone.Outputs:If you want to quickly create multidimensional array for simple value using one liner I would recommend using this array library to do it like this:which will produce

Using an array as needles in strpos

MacMac

[Using an array as needles in strpos](https://stackoverflow.com/questions/6284553/using-an-array-as-needles-in-strpos)

How do you use the strpos for an array of needles when searching a string? For example:Because when using this, it wouldn't work, it would be good if there was something like this

2011-06-08 20:04:28Z

How do you use the strpos for an array of needles when searching a string? For example:Because when using this, it wouldn't work, it would be good if there was something like this@Dave an updated snippet from http://www.php.net/manual/en/function.strpos.php#107351How to use:will return true, because of array "cheese".Update: Improved code with stop when the first of the needles is found:str_replace is considerably faster.The below code not only shows how to do it, but also puts it in an easy to use function moving forward. It was written by "jesda". (I found it online)PHP Code:Usage:You can iterate through the array and set a "flag" value if strpos returns false.Then check the value of $flag.If you just want to check if certain characters are actually in the string or not, use strtok:This expression searches for all letters:The question, is the provided example just an "example" or exact what you looking for? There are many mixed answers here, and I dont understand the complexibility of the accepted one.To find out if ANY content of the array of needles exists in the string, and quickly return true or false:If, so, please give @Leon credit for that.To find out if ALL values of the array of needles exists in the string, as in this case, all three 'a', 'b' and 'c' MUST be present, like you mention as your "for example"Many answers here is out of that context, but I doubt that the intension of the question as you marked as resolved. E.g. The accepted answer is a needle ofWhat if all those words MUST be found in the string?Then you try out some "not accepted answers" on this page.You can try this:  You can also try using strpbrk() for the negation (none of the letters have been found):This is my approach.  Iterate over characters in the string until a match is found.  On a larger array of needles this will outperform the accepted answer because it doesn't need to check every needle to determine that a match has been found.I benchmarked this against the accepted answer and with an array of more than 7 $needles this was dramatically faster.With the following code:Then check the value of $flag. If it is true, all letters have been found. If not, it's false.I'm writing a new answer which hopefully helps anyone looking for similar to what I am.This works in the case of "I have multiple needles and I'm trying to use them to find a singled-out string". and this is the question I came across to find that.The array $found will contain a list of all the matching needles, the item of the array with the highest count value will be the string(s) you're looking for, you can get this with:Reply to @binyamin and @Timo..  (not enough points to add a comment..) but the result doesn't contain the position..

The code below will return the actual position of the first element which is what strpos is intended to do.  This is useful if you're expecting to find exactly 1 match..  If you're expecting to find multiple matches, then position of first found may be meaningless.Just an upgrade from above answers

Best way to create an empty object in JSON with PHP?

pna

[Best way to create an empty object in JSON with PHP?](https://stackoverflow.com/questions/8595627/best-way-to-create-an-empty-object-in-json-with-php)

To create an empty JSON object I do usually use:casting null to an object works, but is there any other preferable way and/or any problem with this solution?

2011-12-21 20:05:00Z

To create an empty JSON object I do usually use:casting null to an object works, but is there any other preferable way and/or any problem with this solution?The documentation specifies that (object) null will result in an empty object, some might therefor say that your code is valid and that it's the method to use.Though you never know when/if the above will change, so if you'd like to be 100% certain that you will always will end up with a {} in your encoded data you could use a hack such as:Even though it's tedious and ugly I do assume/hope that json_encode/json_decode is compatible with one and other and always will evalute the following to true:json_decode ("{}") will return a stdClass per default, using the below should therefor be considered safe. Though, as mentioned, it's pretty much the same thing as doing (object) null.If you use objects as dynamic dictionaries (and I guess you do), then I think you want to use an ArrayObject.It maps into JSON dictionary even when it's empty. It is great if you need to distinguish between lists (arrays) and dictionaries (associative arrays):You can also manipulate it seamlessly (as you would do with an associative array), and it will keep rendering properly into a dictionary:If you need this to be 100% compatible both ways, you can also wrap json_decode so that it returns ArrayObjects instead of stdClass objects (you'll need to walk the result tree and recursively replace all the objects, which is a fairly easy task).Gotchas. Only one I've found so far: is_array(new ArrayObject()) evaluates to false. You might need to find and replace is_array occurrences with is_iterable (alternatively, (($foo instanceof ArrayObject) || is_array($foo)), if you need).Well, json_encode() simply returns a string from a PHP array/object/etc. You can achieve the same effect much more efficiently by doing:There's really no point in using a function to accomplish this.UPDATE

As per your comment updates, you could try:Though I'm not sure that's any better than what you've been doing.To create an empty object in JSON with PHP I used which producedwhich is necessary, because later I have to do thisI always do (Object)[];, like:... play around with it in PHP ...... now it's real JSON ...you can also use 

How to output (to a log) a multi-level array in a format that is human-readable?

Mark Shiraldi

[How to output (to a log) a multi-level array in a format that is human-readable?](https://stackoverflow.com/questions/11884891/how-to-output-to-a-log-a-multi-level-array-in-a-format-that-is-human-readable)

I'm working on a drupal site and when debugging, I am always having to read through long, nested arrays. As a result, a large portion of my life is spent using the arrow, return, and tab keys, to split up 1000+ character strings into a nested, readable format.For drupal devs, I can't use devel's dsm(), as I'm working with multi-step #ahah/#ajax forms, and I can only output the arrays to the error log, not to the screen.Visual example:Evil:Good:Edit: Sorry, by "not output to screen", I meant via drupal's system messages where it's possible to output arrays in a clickable, nested format (using devel.module).

2012-08-09 13:46:40Z

I'm working on a drupal site and when debugging, I am always having to read through long, nested arrays. As a result, a large portion of my life is spent using the arrow, return, and tab keys, to split up 1000+ character strings into a nested, readable format.For drupal devs, I can't use devel's dsm(), as I'm working with multi-step #ahah/#ajax forms, and I can only output the arrays to the error log, not to the screen.Visual example:Evil:Good:Edit: Sorry, by "not output to screen", I meant via drupal's system messages where it's possible to output arrays in a clickable, nested format (using devel.module).If you need to log an error to Apache error log you can try this:http://php.net/manual/en/function.print-r.php 

This function can be used to format output, $output is a string variable, it can be logged like every other string. In pure php you can use trigger_errorEx. trigger_error($output);http://php.net/manual/en/function.trigger-error.phpif you need to format it also in html, you can use <pre> tagUsing print_r, var_dump or var_export should do it pretty nicely if you look at the result in view-source mode not in HTML mode or as @Joel Larson said if you wrap everything in a <pre> tag.print_r is best for readability but it doesn't print null/false values.var_dump is best for checking types of values and lengths and null/false values.var_export is simmilar to var_dump but it can be used to get the dumped string.The format returned by any of these is indented correctly in the source code and var_export can be used for logging since it can be used to return the dumped string.Use the xdebug plug-in for PHP this prints var_dumps as HTML formatted strings not as raw dump format and also allows you to supply a custom function you want to use for formatting.Drupal's Devel module has other useful functions including ones that can print formatted arrays and objects to log files. See the guide at http://ratatosk.net/drupal/tutorials/debugging-drupal.htmlThis will help youecho '<pre>';echo '</pre>';EDITusing echo '<pre>'; is useless, but var_export($var); will do the thing which you are expecting.You should be able to use a var_dump() within a pre tag. Otherwise you could look into using  a library like dump_r.php: https://github.com/leeoniya/dump_r.phpMy solution is incorrect. OP was looking for a solution formatted with spaces to store in a log file.A solution might be to use output buffering with var_dump, then str_replace() all the tabs with spaces to format it in the log file.I just wonder why nobody uses or recommends the way I prefer to debug an array:Next to my browser I tail my server log in the console eg.

Composer - the requested PHP extension mbstring is missing from your system [closed]

Jozef Cipa

[Composer - the requested PHP extension mbstring is missing from your system [closed]](https://stackoverflow.com/questions/32488917/composer-the-requested-php-extension-mbstring-is-missing-from-your-system)

I've recently tried to install package through Composer, but I have got an error the requested PHP extension mbstring is missing from your system.

I removed semicolon from php.ini, but it still doesn't work. What should I do?

2015-09-09 20:48:58Z

I've recently tried to install package through Composer, but I have got an error the requested PHP extension mbstring is missing from your system.

I removed semicolon from php.ini, but it still doesn't work. What should I do?If this doesn't work and the php_mbstring.dll file is missing, then the PHP installation of this stack is simply broken. For php 7.1Cheers!I set the PHPRC variable and uncommented zend_extension=php_opcache.dll in php.ini and all works well. 

PHP simpleXML how to save the file in a formatted way?

user61734

[PHP simpleXML how to save the file in a formatted way?](https://stackoverflow.com/questions/798967/php-simplexml-how-to-save-the-file-in-a-formatted-way)

I'm trying add some data to an existing XML file using PHP's SimpleXML. The problem is it adds all the data in a single line:And so on. All in a single line. How to introduce line breaks?How do I make it like this?I am using asXML() function.Thanks.

2009-04-28 17:11:11Z

I'm trying add some data to an existing XML file using PHP's SimpleXML. The problem is it adds all the data in a single line:And so on. All in a single line. How to introduce line breaks?How do I make it like this?I am using asXML() function.Thanks.You could use the DOMDocument class to reformat your code:Gumbo's solution does the trick. You can do work with simpleXml above and then add this at the end to echo and/or save it with formatting.Code below echos it and saves it to a file (see comments in code and remove whatever you don't want):Use dom_import_simplexml to convert to a DomElement. Then use its capacity to format output.As Gumbo and Witman answered; loading and saving an XML document from an existing file (we're a lot of newbies around here) with DOMDocument::load and DOMDocument::save.

Package php5 have no installation candidate (Ubuntu 16.04)

Srijan Karki

[Package php5 have no installation candidate (Ubuntu 16.04)](https://stackoverflow.com/questions/36788873/package-php5-have-no-installation-candidate-ubuntu-16-04)

When i try to install php5 in Ubuntu 16.04 by using following code:I get following error:I have tried reinstalling but it does not help. All this error was encountered after I updated my 15.10 Ubuntu to 16.04

2016-04-22 08:34:38Z

When i try to install php5 in Ubuntu 16.04 by using following code:I get following error:I have tried reinstalling but it does not help. All this error was encountered after I updated my 15.10 Ubuntu to 16.04Ubuntu 16.04 comes with PHP7 as the standard, so there are no PHP5 packagesHowever if you like you can add a PPA to get those packages anyways:Remove all the stock php packagesList installed php packages with dpkg -l | grep php| awk '{print $2}' |tr "\n" " " then remove unneeded packages with sudo aptitude purge your_packages_here or if you want to directly remove them all use :Add the PPAInstall your PHP VersionYou can install php5.6 modules too ..Verify your versionBased on https://askubuntu.com/a/756186/532957 (thanks @AhmedJerbi)You must use prefix "php5.6-" instead of "php5-" as in ubuntu 14.04 and olders:If you just want to install PHP no matter what version it is, try PHP7for php7.0 works well for meThis worked for me.;)Currently, I am using Ubuntu 16.04 LTS.

Me too was facing same problem while Fetching the Postgress Database values using Php so i resolved it by using the below commands.Mine PHP version is 7.0, so i tried the below command.apt-get install php-pgsql 

Remember to restart Apache.I recently had this issue as well and solved it using the following command:php is now installed. I'm using Ubuntu 18.04.

In PHP how can you clear a WSDL cache?

jW.

[In PHP how can you clear a WSDL cache?](https://stackoverflow.com/questions/303488/in-php-how-can-you-clear-a-wsdl-cache)

In through php_info() where the WSDL cache is held (/tmp), but I don't necessarily know if it is safe to delete all files starting with WSDL. Yes, I should be able to just delete everything from /tmp, but I don't know what else this could effect if I delete any all WSDL files.

2008-11-19 21:46:57Z

In through php_info() where the WSDL cache is held (/tmp), but I don't necessarily know if it is safe to delete all files starting with WSDL. Yes, I should be able to just delete everything from /tmp, but I don't know what else this could effect if I delete any all WSDL files.You can safely delete the WSDL cache files. If you wish to prevent future caching, use:or dynamically:Remove all wsdl* files in your /tmp folder on the server.WSDL files are cached in your default location for all cache files defined in php.ini. Same location as your session files. I recommend using a cache-buster in the wsdl url.In our apps we use a SVN Revision id in the wsdl url so the client immediately knows of changing structures. This works on our app because, everytime we change the server-side, we also need to adjust the client accordingly.This requires svn to be configured properly. Not on all repositories this is enabled by default.In case you are not responsible for both components (server,client) or you don't use SVN you may find another indicator which can be utilised as a cache-buster in your wsdl url.if you already deployed the code or can't change any configuration, you could remove all temp files from wsdl: Just for the reason of documentation:I have now (2014) observed that from all these valuable and correct approaches only one was successful. I've added a function to the WSDL on the server, and the client wasn't recognizing the new function. I am now unsure if it is the combination of all three, or if some features are terribly implemented so they may remain useless randomly, or if there is some hierarchy of features not understood. So finally, expect that you have to check all three to solve problems like these.Edit your php.ini file, search for soap.wsdl_cache_enabled and set the value to 0

Date Difference in php on days? [duplicate]

mysqllearner

[Date Difference in php on days? [duplicate]](https://stackoverflow.com/questions/1940338/date-difference-in-php-on-days)

Is there a quick way to calculate date difference in php? For example:And then do a calculation, $date2 minus $date1I read php.net documentation, but no luck. Is there a quick way to do it?

2009-12-21 14:15:12Z

Is there a quick way to calculate date difference in php? For example:And then do a calculation, $date2 minus $date1I read php.net documentation, but no luck. Is there a quick way to do it?strtotime will convert your date string to a unix time stamp. (seconds since the unix epoch.I would recommend to use date->diff function, as in example below:see http://www.php.net/manual/en/datetime.diff.phpBelow code will give the output for number of days, by taking out the difference

between two dates..

Downloading a large file using curl

kusanagi

[Downloading a large file using curl](https://stackoverflow.com/questions/6409462/downloading-a-large-file-using-curl)

I need to download remote file using curl.Here's the sample code I have:But it can't handle big files, because it reads to memory first.Is it possible to stream the file directly to disk?

2011-06-20 09:50:55Z

I need to download remote file using curl.Here's the sample code I have:But it can't handle big files, because it reads to memory first.Is it possible to stream the file directly to disk?I use this handy function:By downloading it with a 4094 byte step it will not full your memoryUsage:You can then check if everything is ok with:Find below code if you want to download the contents of the specified URL also want to saves it to a file.If you want to downloads file from the FTP server you can use php FTP extension. Please find below code:when curl is used to download a large file then CURLOPT_TIMEOUT is the main option you have to set for.CURLOPT_RETURNTRANSFER has to be true in case you are getting file like pdf/csv/image etc.You may find the further detail over here(correct url) Curl DocFrom that page:You can use this function, which creates a tempfile in the filesystem and returns the path to the downloaded file if everything worked fine:

How can I properly use a PDO object for a parameterized SELECT query

Joe Phillips

[How can I properly use a PDO object for a parameterized SELECT query](https://stackoverflow.com/questions/767026/how-can-i-properly-use-a-pdo-object-for-a-parameterized-select-query)

I've tried following the PHP.net instructions for doing SELECT queries but I am not sure the best way to go about doing this.I would like to use a parameterized SELECT query, if possible, to return the ID in a table where the name field matches the parameter. This should return one ID because it will be unique.I would then like to use that ID for an INSERT into another table, so I will need to determine if it was successful or not.I also read that you can prepare the queries for reuse but I wasn't sure how this helps.

2009-04-20 05:36:43Z

I've tried following the PHP.net instructions for doing SELECT queries but I am not sure the best way to go about doing this.I would like to use a parameterized SELECT query, if possible, to return the ID in a table where the name field matches the parameter. This should return one ID because it will be unique.I would then like to use that ID for an INSERT into another table, so I will need to determine if it was successful or not.I also read that you can prepare the queries for reuse but I wasn't sure how this helps.You select data like this:You insert in the same way:I recommend that you configure PDO to throw exceptions upon error. You would then get a PDOException if any of the queries fail - No need to check explicitly. To turn on exceptions, call this just after you've created the $db object:I've been working with PDO lately and the answer above is completely right, but I just wanted to document that the following works as well.You can use the bindParam or bindValue methods to help prepare your statement. 

It makes things more clear on first sight instead of doing $check->execute(array(':name' => $name)); Especially if you are binding multiple values/variables.Check the clear, easy to read example below:If you are expecting multiple rows remove the LIMIT 1 and change the fetch method into fetchAll:A litle bit complete answer is here with all ready for use:Here $dbh is PDO db connecter, and based on id from table users we've get the username using fetch();I hope this help someone, Enjoy!Method 1:USE PDO query methodGetting Row CountMethod 2: Statements With ParametersMethod 3:Bind parameters    Want to know more look at this linkif you are using inline coding in single page and not using oops than go with this full example, it will sure help

What is a Factory Design Pattern in PHP?

JasonDavis

[What is a Factory Design Pattern in PHP?](https://stackoverflow.com/questions/2083424/what-is-a-factory-design-pattern-in-php)

This confuses me, in the most simplest terms what does it do?  Pretend you are explaining to your mother or someone almost please.

2010-01-18 01:28:04Z

This confuses me, in the most simplest terms what does it do?  Pretend you are explaining to your mother or someone almost please.A factory creates an object. So, if you wanted to buildYou wouldn't want to rely on having to do the following code everytime you create the objectThat is where the factory would come in. We define a factory to take care of that for us:Now all we have to do isThe real advantage is when you want to change the class. Lets say we wanted to pass in a different ClassC:or a new ClassB:Now we can use inheritance to easily modify how the class is created, to put in a different set of classes. A good example might be this user class:In this class $data is the class we use to store our data. Now for this class, lets say we use a Session to store our data. The factory would look like this:Now, lets say instead we want to store all of our data in the database, it is really simple to change it:Factories are a design pattern we use to control how we put objects together, and using correct factory patterns allows us to create the customized objects we need.Like a real life factory, it creates something and returns it.Imagine something like thisor a factory methodThe implementation of the factory method will create a new instance and return it.Factory design pattern is very good when you are dealing with multiple resources and want to implement high level abstraction.Let's break this into different section.Suppose you have to implement abstraction and the user of your class doesn't need to care about what you've implemented in class definition. He/She just need to worry about the use of your class methods.e.g. You have two databases for your project Your Factory class would take care of the creation of object for database connection.User just need to pass the name of the database typeOutput:In future you may have different database then you don't need to change the entire code only need to pass the new database type and other code will run without making any changes.Output:Hope this will help.In general a "factory" produces something: in the case of Object-Orientated-Programming, a "factory design pattern" produces objects.It doesn't matter if it's in PHP, C# or any other Object-Orientated language.Factory Design Pattern (Factory Pattern) is for loose coupling. Like the meaning of factory, data to a factory (produce data) to final user. By this way, the factory break the tight coupling between source of data and process of data.A factory just generates an object or objects.You may have a factory that builds a MySQL connection.http://en.wikipedia.org/wiki/Factory_method_patternThis answer is in relation to other post in which Daniel White said to use factory for creating MySQL connection using factory pattern.For MySQL connection I would rather use singleton pattern as you want to use same connection 

for accessing the database not create another one.The classic approach to instantiate an object is:PHP has the ability to dynamically create an object from variable name using the following syntax:where variable $classname contains the name of class one wants to instantiate.So classic object factoring would look like:and if you call getInstance('Product') function this factory will create and return Product object. Otherwise if you call getInstance('Customer') function this factory will create and return Customer type object (created from Customer() class).There's no need for that any more, one can send 'Product' or 'Customer' (exact names of existing classes) as a value of variable for dynamic instantiation:For the record, in easy words, a factory like @Pindatjuh said, returns a object.So, what's the difference with a constructor? (that does the same)Using constructor:Using factory:

How to set upload_max_filesize in .htaccess?

T1000

[How to set upload_max_filesize in .htaccess?](https://stackoverflow.com/questions/2992376/how-to-set-upload-max-filesize-in-htaccess)

I have try to put theese 2 lines  in my root .htaccess file but that brings me "internal server error" message ...

php5 is running on the server

I don't have access to php.ini so i think htaccess is my only chance.

Can you tell me where is the mistake?

Thanks in advance

2010-06-07 19:14:54Z

I have try to put theese 2 lines  in my root .htaccess file but that brings me "internal server error" message ...

php5 is running on the server

I don't have access to php.ini so i think htaccess is my only chance.

Can you tell me where is the mistake?

Thanks in advancephp_value upload_max_filesize 30M is correct.You will have to contact your hosters -- some don't allow you to change values in php.iniIf you are getting 500 - Internal server error that means you don't have permission to set these values by .htaccess. You have to contact your web server providers and ask to set AllowOverride Options for your host or to put these lines in their virtual host configuration file.Use all 3 in .htaccess after everything at last line. php_value post_max_size must be more than than the remaining two. What to do to correct this is create a file called php.ini and save it in the same location as your .htaccess file and enter the following code instead:If your web server is running php5, I believe you must use php5_value.  This resolved the same error I received when using php_value.Both commands are correctBUT to use the .htaccess you have to enable rewrite_module in Apache config file. In httpd.conf find this line:and remove the #.

Return index of highest value in an array

Jeff

[Return index of highest value in an array](https://stackoverflow.com/questions/1461348/return-index-of-highest-value-in-an-array)

From an array that looks something like the following, how can I get the index of the highest value in the array. For the array below, the desired result would be '11'.

2009-09-22 17:08:41Z

From an array that looks something like the following, how can I get the index of the highest value in the array. For the array below, the desired result would be '11'.My solution is:Note:

 this way you can retrieve every key related to a given max value.  If you are interested only in one key among all simply use $maxs[0]array_search() return values:Returns the key for needle if it is found in the array, FALSE otherwise.If needle is found in haystack more than once, the first matching key is returned. To return the keys for all matching values, use array_keys() with the optional search_value parameter instead. I know it's already answered but here is a solution I find more elegant:and voila!Other answers may have shorter code but this one should be the most efficient and is easy to understand.Something like this should do the trickMy solution to get the higher key is as follows: Function taken from http://www.php.net/manual/en/function.max.phpWorks like a charm

Show Curl POST Request Headers? Is there a way to do this?

Rick

[Show Curl POST Request Headers? Is there a way to do this?](https://stackoverflow.com/questions/3164405/show-curl-post-request-headers-is-there-a-way-to-do-this)

I'm building a Curl web automation app and am having some issue with not getting the desired outcome of my POST action, I am having some trouble figuring out how I can show the full POST request I am sending over (with headers), I have been searching on this but everything that comes up is the response headers, actually I want these too but also the request, which none of the posts I find on google seem to mention..I know I can display the result of a curl request using something like this (forgive me if my syntax is off, I already shut down my virtual machine with my ide and code to refer toAnyways, I would greatly appreciate any advice on how to view the full headers, thanks

2010-07-02 09:07:00Z

I'm building a Curl web automation app and am having some issue with not getting the desired outcome of my POST action, I am having some trouble figuring out how I can show the full POST request I am sending over (with headers), I have been searching on this but everything that comes up is the response headers, actually I want these too but also the request, which none of the posts I find on google seem to mention..I know I can display the result of a curl request using something like this (forgive me if my syntax is off, I already shut down my virtual machine with my ide and code to refer toAnyways, I would greatly appreciate any advice on how to view the full headers, thanksYou can see the information regarding the transfer by doing:before the request, and after the requestYou can also use the CURLOPT_HEADER in your curl_setoptThese are just some methods of using the headers.Here is all you need:You can save all headers sent by curl to a file using :You can make you request headers by yourself using:Like writen on how make requestI had exactly the same problem lately, and I installed Wireshark (it is a network monitoring tool). You can see everything with this, except encrypted traffic (HTTPS).

How to gracefully handle files that exceed PHP's `post_max_size`?

Nathan Long

[How to gracefully handle files that exceed PHP's `post_max_size`?](https://stackoverflow.com/questions/2133652/how-to-gracefully-handle-files-that-exceed-phps-post-max-size)

I'm working on a PHP form that attaches a file to an email, and trying to gracefully handle cases where the uploaded file is too large.I've learned that there are two settings in php.ini that affect the maxiumum size of a file upload: upload_max_filesize and post_max_size. If a file's size exceeds upload_max_filesize, PHP returns the file's size as 0. That's fine; I can check for that.But if it exceeds post_max_size, my script fails silently and goes back to the blank form.Is there any way to catch this error?

2010-01-25 16:15:24Z

I'm working on a PHP form that attaches a file to an email, and trying to gracefully handle cases where the uploaded file is too large.I've learned that there are two settings in php.ini that affect the maxiumum size of a file upload: upload_max_filesize and post_max_size. If a file's size exceeds upload_max_filesize, PHP returns the file's size as 0. That's fine; I can check for that.But if it exceeds post_max_size, my script fails silently and goes back to the blank form.Is there any way to catch this error?From the documentation :So unfortunately, it doesn't look like PHP sends an error. And since it sends am empty $_POST array, that is why your script is going back to the blank form - it doesn't think it is a POST. (Quite a poor design decision IMHO)This commenter also has an interesting idea. there is a way to catch / handle files exceeding max post size, this is my preferred on, as it tells the end user what has happened and who is at fault ;)We got the problem for SOAP requests where a check for emptiness of $_POST and $_FILES doesn't work, because they are also empty on valid requests.Therefore we implemented a check, comparing CONTENT_LENGTH and post_max_size. The thrown Exception is later on transformed into a XML-SOAP-FAULT by our registered exception handler.Building on @Matt McCormick's and @AbdullahAJM's answers, here is a PHP test case that checks the variables used in the test are set and then checks if the $_SERVER['CONTENT_LENGTH'] exceeds the php_max_filesize setting:That is a simple way to fix this problem:Just call "checkPostSizeExceeded" on begin of your codeRemember copy this auxiliar function:

Check if value isset and null

Tatu Ulmanen

[Check if value isset and null](https://stackoverflow.com/questions/3803282/check-if-value-isset-and-null)

I need to check if value is defined as anything, including null. isset treats null values as undefined and returns false. Take the following as an example:Note that $bar is undefined.I need to find a condition that satisfies the following:Any ideas?

2010-09-27 11:18:27Z

I need to check if value is defined as anything, including null. isset treats null values as undefined and returns false. Take the following as an example:Note that $bar is undefined.I need to find a condition that satisfies the following:Any ideas?IIRC, you can use get_defined_vars() for this:If you are dealing with object properties whcih might have a value of NULL you can use: property_exists() instead of isset()See Best way to test for a variable's existence in PHP; isset() is clearly brokenI have found that compact is a function that ignores unset variables but does act on ones set to null, so when you have a large local symbol table I would imagine you can get a more efficient solution over checking  array_key_exists('foo', get_defined_vars()) by using array_key_exists('foo', compact('foo')):UpdateAs of PHP 7.3 compact() will give a notice for unset values, so unfortunately this alternative is no longer valid. The following code written as PHP extension is equivalent to array_key_exists($name, get_defined_vars()) (thanks to Henrik and Hannes).You could use is_null and empty instead of isset(). Empty doesn't print an error message if the variable doesn't exist.Here some silly workaround using xdebug. ;-)is_null($bar) returns true, since it has no values at all. Alternatively, you can use:to check if $bar is defined and will only return true if:

definitive way to get user ip address php [duplicate]

user62617

[definitive way to get user ip address php [duplicate]](https://stackoverflow.com/questions/6794782/definitive-way-to-get-user-ip-address-php)

I was told this way of getting ip address has issues such as being able to fool.  Is there a better way to gather ip address? looking for tutorials of better way to get ip address?

2011-07-22 18:59:00Z

I was told this way of getting ip address has issues such as being able to fool.  Is there a better way to gather ip address? looking for tutorials of better way to get ip address?$_SERVER['REMOTE_ADDR'] is the only reliable IP address you'll get - it's extracted directly from the TCP stack and is where the current connection was established from. This means if the user is connecting via a proxy, you'll get the proxy's address, not the user's.Any of the other header-based ones are unreliable, as HTTP headers are trivial to forge. You can use the information from them, if you'd like, as long as you don't TRUST it.

Passing data to buildForm() in Symfony 2.8, 3.0 and above

Jonathan

[Passing data to buildForm() in Symfony 2.8, 3.0 and above](https://stackoverflow.com/questions/34027711/passing-data-to-buildform-in-symfony-2-8-3-0-and-above)

My application currently passes data to my form type using the constructor, as recommended in this answer. However the Symfony 2.8 upgrade guide advises that passing a type instance to the createForm function is deprecated:Seeing as I can't pass data through with the fully-qualified class name, is there an alternative?

2015-12-01 18:41:56Z

My application currently passes data to my form type using the constructor, as recommended in this answer. However the Symfony 2.8 upgrade guide advises that passing a type instance to the createForm function is deprecated:Seeing as I can't pass data through with the fully-qualified class name, is there an alternative?This broke some of our forms as well. I fixed it by passing the custom data through the options resolver.In your form type:Then when you create the form in your controller, pass it in as an option instead of in the constructor:Here can be used another approach - inject service for retrieve data.Example:In case anyone is using a 'createNamedBuilder' or 'createNamed' functions from form.factory service here's the snippet on how to set and save the data using it. You cannot use the 'data' field (leave that null) and you have to set the passed data/entities as $options value.I also incorporated @sarahg instructions about using setAllowedTypes() and setRequired() options and it seems to work fine but you first need to define field with setDefined()Also inside the form if you need the data to be set remember to add it to 'data' field.In Controller I am using getBlockPrefix as getName was deprecated in 2.8/3.0Controller:Form:Here's how to pass the data to an embedded form for anyone using Symfony 3. First do exactly what @sekl outlined above and then do the following:In your primary FormTypePass the var to the embedded form using 'entry_options'In your Embedded FormTypeAdd the option to the optionsResolverAccess the variable in your buildForm function. Remember to set this variable before the builder function. In my case I needed to filter options based on a specific ID.

Are global variables in PHP considered bad practice? If so, why?

KRTac

[Are global variables in PHP considered bad practice? If so, why?](https://stackoverflow.com/questions/1557787/are-global-variables-in-php-considered-bad-practice-if-so-why)

In my small PHP projects I usually go the procedural way. I generally have a variable that contains the system configuration, and when I nead to access this variable in a function, I do global $var;.Is this bad practice?

2009-10-13 01:19:29Z

In my small PHP projects I usually go the procedural way. I generally have a variable that contains the system configuration, and when I nead to access this variable in a function, I do global $var;.Is this bad practice?When people talk about global variables in other languages it means something different to what it does in PHP. That's because variables aren't really global in PHP. The scope of a typical PHP program is one HTTP request. Session variables actually have a wider scope than PHP "global" variables because they typically encompass many HTTP requests.Often (always?) you can call member functions in methods like preg_replace_callback() like this:See callbacks for more.The point is that objects have been bolted onto PHP and in some ways lead to some awkwardness.Don't concern yourself overly with applying standards or constructs from different languages to PHP. Another common pitfall is trying to turn PHP into a pure OOP language by sticking object models on top of everything.Like anything else, use "global" variables, procedural code, a particular framework and OOP because it makes sense, solves a problem, reduces the amount of code you need to write or makes it more maintainable and easier to understand, not because you think you should.Global variables if not used carefully can make problems harder to find. Let's say you request a php script and you get a warning saying you're trying to access an index of an array that does not exist in some function. If the array you're trying to access is local to the function, you check the function to see if you have made a mistake there. It might be a problem with an input to the function so you check the places where the function is called. But if that array is global, you need to check all the places where you use that global variable, and not only that, you have to figure out in what order those references to the global variable are accessed.If you have a global variable in a piece of code it makes it difficult to isolate the functionality of that code. Why would you want to isolate functionality? So you can test it and reuse it elsewhere. If you have some code you don't need to test and won't need to reuse then using global variables is fine.i agree with cletus. i would add two things:best regards,

donWho can argue against experience, college degrees, and software engineering? Not me. I would only say that in developing object-oriented single page PHP applicatons, I have more fun when I know I can build the entire thing from scratch without worrying about namespace collisions. Building from scratch is something many people do not do anymore. They have a job, a deadline, a bonus, or a reputation to care about. These types tend to use so much pre-built code with high stakes, that they cannot risk using global variables at all.It may be bad to use global variables, even if they are only used in the global area of a program, but let's not forget about those who just want to have fun and make something work.If that means using a few variables (< 10) in the global namespace, that only get used in the global area of a program, so be it. Yes, yes, MVC, dependency injection, external code, blah, blah, blah, blah. But, if you have contained 99.99% of your code into namespaces and classes, and external code is sandboxed, the world will not end (I repeat, the world will not end) if you use a global variable.Generally, I would not say using global variables is bad practice. I would say that using global variables (flags and such) outside of the global area of a program is asking for trouble and (in the long run) ill-advised because you can lose track of their states rather easily. Also, I would say that the more you learn, the less reliant you will be on global variables because you will have experienced the "joy" of tracking down bugs associated with their use. This alone will incentivize you to find another way to solve the same problem. Coincidentally, this tends to push PHP people in the direction of learning how to use namespaces and classes (static members, etc ...). The field of computer science is vast. If we scare everyone away from doing something because we label it bad, then they lose out on the fun of truly understanding the reasoning behind the label.Use global variables if you must, but then see if you can solve the problem without them. Collisions, testing, and debugging mean more when you intimately understand the true nature of the problem, not just a description of the problem.We can illustrate this problem with the following pseudo-codeYour first question here is an obvious oneAre you confused? Good. You've just learned why globals are confusing and considered a bad practice. If this were a real program, your next bit of fun is to go track down all instances of $bob and hope you find the right one (this gets worse if $bob is used everywhere). Worse, if someone else goes and defines $bob (or you forgot and reused that variable) your code can break (in the above code example, having the wrong object, or no object at all, would cause a fatal error). Since virtually all PHP programs make use of code like include('file.php'); your job maintaining code like this becomes exponentially harder the more files you add.How do we avoid Globals?The best way to avoid globals is a philosophy called Dependency Injection. This is where we pass the tools we need into the function or class.This is much easier to understand and maintain. There's no guessing where $bob was set up because the caller is responsible for knowing that (it's passing us what we need to know). Better still, we can use type declarations to restrict what's being passed. So we know that $bob is either an instance of the Bar class, or an instance of a child of Bar, meaning we know we can use the methods of that class. Combined with a standard autoloader (available since PHP 5.3), we can now go track down where Bar is defined. PHP 7.0 or later includes expanded type declarations, where you can also use scalar types (like int or string).As:is bad practice (Like Wordpress $pagenow)... hmmmConcider this:is PHP error But:is NOT error, hypens will not clash with "common" user declared variables, like $pagenow. And Using UPPERCASE indicates a superglobal in use, easy to spot in code, or track with find in filesI use hyphens, if Im lazy to build classes of everything for a single solution, like:But In cases of a more wider use, I use ONE globals as array:The latter is for me, good practice on "cola light" objectives or use, instead of clutter with singleton classes each time to "cache" some data. Please make a comment if Im wrong or missing something stupid here...

How do I fix「Add myBundle to the asseticBundle config」symfony2 exception?

Vimal Basdeo

[How do I fix「Add myBundle to the asseticBundle config」symfony2 exception?](https://stackoverflow.com/questions/12222900/how-do-i-fix-add-mybundle-to-the-asseticbundle-config-symfony2-exception)

When I am trying to use the TWIG {% javascript %} tag to link to my .js file it return me with the following exception :My index.html.twig looks like :My Bundle is already present in the config file when I do :How can I fix this ?

2012-08-31 21:50:39Z

When I am trying to use the TWIG {% javascript %} tag to link to my .js file it return me with the following exception :My index.html.twig looks like :My Bundle is already present in the config file when I do :How can I fix this ?Yes I tried and it solved the issue for me. For someone (like me) who doesn't know initially how to add then just:for instance if your bundle is Acme\DemoBundle, then do the followingNo quotes around AcmeDemoBundle. That's it. (Symfony2)If you want assetic to include your bundles by default, you can comment (with #) the line bundles: []ex:Sometimes you need to make decisions on the fly, then you can use use DependencyInjection.For example to loads and manages configuration:You can use more complex logic to manipulate the configuration(in reasonable limits)You need to add your bundle to bundle: [] row of assetic: section in app/config/config.yml file (symfony 2.1)

Generating (pseudo)random alpha-numeric strings

UnkwnTech

[Generating (pseudo)random alpha-numeric strings](https://stackoverflow.com/questions/48124/generating-pseudorandom-alpha-numeric-strings)

How can I generate a (pseudo)random alpha-numeric string, something like: 'd79jd8c' in PHP?

2008-09-07 04:02:29Z

How can I generate a (pseudo)random alpha-numeric string, something like: 'd79jd8c' in PHP?First make a string with all your possible characters:You could also use range() to do this more quickly.Then, in a loop, choose a random number and use it as the index to the $characters string to get a random character, and append it to your string:$random_string_length is the length of the random string.I like this function for the jobGenerate cryptographically strong, random (potentially) 8-character string using the openssl_random_pseudo_bytes function:Procedural way:Update:PHP7 introduced the random_x() functions which should be even better. If you come from PHP 5.X, use excellent paragonie/random_compat library which is a polyfill for random_bytes() and random_int() from PHP 7.One line solution:You can change the substr parameter in order to set a different length for your string.Use the ASCII table to pick a range of letters, where the: $range_start , $range_end is a value from the decimal column in the ASCII table.I find that this method is nicer compared to the method described where the range of characters is specifically defined within another string.See More:I know it's an old post but I'd like to contribute with a class I've created based on Jeremy Ruten's answer and improved with suggestions in comments:Simple guys .... but remember each byte is random between 0 and 255 which for a random string will be fine.  Also remember you'll have two characters to represent each byte.Maybe I missed something here, but here's a way using the uniqid() function.I have made the following quick function just to play around with the range() function. It just might help someone sometime.You can use the following code, copied from this article. It is similar to existing functions except that you can force special character count:If you want a very easy way to do this, you can lean on existing PHP functions. This is the code I use:substr( sha1( time() ), 0, 15 )time() gives you the current time in seconds since epoch, sha1() encrypts it to a string of 0-9a-f, and substr() lets you choose a length. You don't have to start at character 0, and whatever the difference is between the two numbers will be the length of the string.This is something I use:You can see the Docs for openssl_random_pseudo_bytes here, and the Docs for bin2hex hereJeremy's answer is great. If, like me, you're unsure of how to implement range(), you can see my version using range().This does the exact same thing as Jeremy's but uses merged arrays where he uses a string, and uses count() where he uses strlen().1 line:The modern way to do that with type hint / rand_int for real randomeness First list the desired charactersUse the str_shuffle($string) function. This function will provide you a randomly shuffled string.50 is the Length of string.

PHP __get and __set magic methods

airbear

[PHP __get and __set magic methods](https://stackoverflow.com/questions/4713680/php-get-and-set-magic-methods)

Unless I'm completely mistaken, the __get and __set methods are supposed to allow overloading of the → get and set.For example, the following statements should invoke the __get method:And the following should use the __set method:This was not working in my code, and is reproducible with this simple example:This only results in:Putting some die() calls in there shows that it is not hitting it at all.For now, I just said screw it, and am manually using __get where it's needed for now, but that's not very dynamic and requires knowledge that the 'overloaded' code is in fact not being called unless specifically called. I'd like to know if this is either not supposed to function the way I've understood that it should or why this is not working.This is running on php 5.3.3.

2011-01-17 13:30:43Z

Unless I'm completely mistaken, the __get and __set methods are supposed to allow overloading of the → get and set.For example, the following statements should invoke the __get method:And the following should use the __set method:This was not working in my code, and is reproducible with this simple example:This only results in:Putting some die() calls in there shows that it is not hitting it at all.For now, I just said screw it, and am manually using __get where it's needed for now, but that's not very dynamic and requires knowledge that the 'overloaded' code is in fact not being called unless specifically called. I'd like to know if this is either not supposed to function the way I've understood that it should or why this is not working.This is running on php 5.3.3.__get, __set, __call and __callStatic are invoked when the method or property is inaccessible. Your $bar is public and therefor not inaccessible.See the section on Property Overloading in the manual:The magic methods are not substitutes for getters and setters. They just allow you to handle method calls or property access that would otherwise result in an error. As such, there are much more related to error handling. Also note that they are considerably slower than using proper getter and setter or direct method calls.I'd recommend to use an array for storing all values via __set().This way you make sure, that you can't access the variables in another way (note that $values is protected), to avoid collisions.From the PHP manual:This is only called on reading/writing inaccessible properties. Your property however is public, which means it is accessible. Changing the access modifier to protected solves the issue.To expand on Berry's answer, that setting the access level to protected allows __get and __set to be used with explicitly declared properties (when accessed outside the class, at least) and the speed being considerably slower, I'll quote a comment from another question on this topic and make a case for using it anyway:I agree that __get is more slow to a custom get function (doing the same things), this is 0.0124455 the time for __get() and this 0.0024445 is for custom get() after 10000 loops. –  Melsi Nov 23 '12 at 22:32 Best practice: PHP Magic Methods __set and __getAccording to Melsi's tests, considerably slower is about 5 times slower. That is definitely considerably slower, but also note that the tests show that you can still access a property with this method 10,000 times, counting time for loop iteration, in roughly 1/100 of a second. It is considerably slower in comparison with actual get and set methods defined, and that is an understatement, but in the grand scheme of things, even 5 times slower is never actually slow.The computing time of the operation is still negligible and not worth considering in 99% of real world applications. The only time it should really be avoided is when you're actually going to be accessing the properties over 10,000 times in a single request. High traffic sites are doing something really wrong if they can't afford throwing a few more servers up to keep their applications running. A single line text ad on the footer of a high traffic site where the access rate becomes an issue could probably pay for a farm of 1,000 servers with that line of text. The end user is never going to be tapping their fingers wondering what is taking the page so long to load because your application's property access takes a millionth of a second.I say this speaking as a developer coming from a background in .NET, but invisible get and set methods to the consumer is not .NET's invention. They simply aren't properties without them, and these magic methods are PHP's developer's saving grace for even calling their version of properties "properties" at all. Also, the Visual Studio extension for PHP does support intellisense with protected properties, with that trick in mind, I'd think. I would think with enough developers using the magic __get and __set methods in this way, the PHP developers would tune up the execution time to cater to the developer community.Edit: In theory, protected properties seemed like it'd work in most situation. In practice, it turns out that there's a lot of times you're going to want to use your getters and setters when accessing properties within the class definition and extended classes. A better solution is a base class and interface for when extending other classes, so you can just copy the few lines of code from the base class into the implementing class. I'm doing a bit more with my project's base class, so I don't have an interface to provide right now, but here is the untested stripped down class definition with magic property getting and setting using reflection to remove and move the properties to a protected array:My apologies if there are any bugs in the code.It's because $bar is a public property. There is no need to call the magic method when running the above.Deleting public $bar; from your class should correct this.Best use magic set/get methods with predefined custom  set/get Methods as in example below. This way you can combine best of two worlds. In terms of speed I agree that they are a bit slower but can you even feel the difference. Example below also validate the data array against predefined setters.    This is why we should use both. CLASS ITEM EXAMPLE 

   

INDEX.PHPOUTPUTDrop the public $bar; declaration and it should work as expected.Intenta con: 

How to create and download a csv file from php script?

user2302780

[How to create and download a csv file from php script?](https://stackoverflow.com/questions/16251625/how-to-create-and-download-a-csv-file-from-php-script)

I am a novice programmer and I searched a lot about my question but couldn't find a helpful solution or tutorial about this.My goal is I have a PHP array and the array elements are showing in a list on the page.I want to add an option, so that if a user wants, he/she can create a CSV file with array elements and download it.I don't know how to do this. I have searched a lot too. But yet to find any helpful resource.Please provide me some tutorial or solution or advice to implement it by myself. As I'm a novice please provide easy to implement solutions.My array looks like: 

2013-04-27 11:35:50Z

I am a novice programmer and I searched a lot about my question but couldn't find a helpful solution or tutorial about this.My goal is I have a PHP array and the array elements are showing in a list on the page.I want to add an option, so that if a user wants, he/she can create a CSV file with array elements and download it.I don't know how to do this. I have searched a lot too. But yet to find any helpful resource.Please provide me some tutorial or solution or advice to implement it by myself. As I'm a novice please provide easy to implement solutions.My array looks like: You can use the built in fputcsv() for your arrays to generate correct csv lines from your array, so you will have to loop over and collect the lines. like:To make the browsers offer the "Save as" dialog you will have to send HTTP headers like this (see more about this header in the rfc):Putting it all together:And you can use it like this:Update:

Instead of the php://memory you can also use the php://output for the file descriptor and do away with the seeking and such:I don't have enough reputation to reply to @complex857 solution. It works great, but I had to add ; at the end of the Content-Disposition header. Without it the browser adds two dashes at the end of the filename (e.g. instead of "export.csv" the file gets saved as "export.csv--"). Probably it tries to sanitize \r\n at the end of the header line.Correct line should look like this:In case when CSV has UTF-8 chars in it, you have to change the encoding to UTF-8 by changing the Content-Type line:Also, I find it more elegant to use rewind() instead of fseek():Thanks for your solution!Try...

csv download.That is the function i used for my project and it works as expected.Use the below code to convert a php array to CSVIf you're array structure will always be multi-dimensional in that exact fashion, then we can iterate through the elements like such:That's one way to do it ... you could do it manually but this way is quicker and easier to understand and read.Then you would manage your headers something what complex857 is doing to spit out the file.  You could then delete the file using unlink() if you no longer needed it, or you could leave it on the server if you wished.

How do I remove accents from characters in a PHP string?

georgebrock

[How do I remove accents from characters in a PHP string?](https://stackoverflow.com/questions/1017599/how-do-i-remove-accents-from-characters-in-a-php-string)

I'm attempting to remove accents from characters in PHP string as the first step to making the string usable in a URL.I'm using the following code:The output I would expect would be something like this:However, instead of the accented characters being transliterated they are replaced with question marks:Everything I can find online indicates that setting the locale will fix this problem, however I'm already doing this.  I've already checked the following details:The server is using the wrong implementation of iconv.  It has the glibc version instead of the required libiconv version.Details about the iconv implementation that is used by PHP are included in the output of the phpinfo function.(I'm not able to re-compile PHP with the correct iconv library on the server I'm working with for this project so the answer I've accepted below is the one that was most useful for removing accents without iconv support.)

2009-06-19 12:06:48Z

I'm attempting to remove accents from characters in PHP string as the first step to making the string usable in a URL.I'm using the following code:The output I would expect would be something like this:However, instead of the accented characters being transliterated they are replaced with question marks:Everything I can find online indicates that setting the locale will fix this problem, however I'm already doing this.  I've already checked the following details:The server is using the wrong implementation of iconv.  It has the glibc version instead of the required libiconv version.Details about the iconv implementation that is used by PHP are included in the output of the phpinfo function.(I'm not able to re-compile PHP with the correct iconv library on the server I'm working with for this project so the answer I've accepted below is the one that was most useful for removing accents without iconv support.)I think the problem here is that your encodings consider ä and å different symbols to 'a'. In fact, the PHP documentation for strtr offers a sample for removing accents the ugly way :(http://ie2.php.net/strtrWhat about WordPress implementation?To better understand what this function does, check this corresponding conversion table here:You can generate this convesion table yourself by simply iterarting over the $chars array of the function:This is a piece of code I found and use often:UTF-8 friendly version of the simple function posted above by Gino:Had to come to this because my php document was UTF-8 encoded.Hope it helps.if you have http://php.net/manual/en/book.intl.php available, this solved your problemWhen using iconv, the parameter locale must be set:Yields into:Another locales then cs_CZ and en_US I haven't installed and I can't test it.In C# I see solution using translation to unicode normalized form - accents are splitted out and then filtered via nonspacing unicode category.The easiest way is to use iconv() PHP native function.You could use urlencode.  Does not quite do what you want (remove accents), but will give you a url usable stringIn Perl I could use a translate regex, but I cannot think of the PHP equivalentetc...you could do this using preg_replace(Please note this was typed from a foggy beer ridden Friday after noon memory, so may not be 100% correct)or you could make a hash table and do a replacement based off of that.Indeed is a matter of taste. There are many flavors for converting such letters.here is a simple function that i use usually to remove accents :I agree with georgebrock's comment.If you find a way to get //TRANSLIT to work, you can build friendly URLs:If you can't get it to work, replace setp 1 with strtr/character-based replacement, like Xetius' solution.I can't reproduce your problem. I get the expected result.How exactly are you using mb_detect_encoding() to verify your string is in fact UTF-8?If I simply call mb_detect_encoding($input) on both a UTF-8 and ISO-8859-1 encoded version of your string, both of them return "UTF-8", so that function isn't particularly reliable.iconv() gives me a PHP "notice" when it gets the wrongly encoded string and only echoes "F", but that might just be because of different PHP/iconv settings/versions (?).I suggest to you try calling mb_check_encoding($input, "utf-8") first to verify that your string really is UTF-8. I think it probably isn't.Merged Cazuma Nii Cavalcanti's implementation with Junior Mayhé's char list, hoping to save some time for some of you.In laravel you can simply use str_slug($accentedPhrase)

and if you care about dash (-) that this method substitute with space you can use str_replace('-', ' ', str_slug($accentedPhrase))I just created a removeAccents method based on the reading of this thread and this other one too (How to remove accents and turn letters into "plain" ASCII characters?).The method is here: https://github.com/lingtalfi/Bat/blob/master/StringTool.md#removeaccentsTests are here: https://github.com/lingtalfi/Bat/blob/master/btests/StringTool/removeAccents/stringTool.removeAccents.test.php,and here is what was tested so far:and it converts only accentuated things (letters/ligatures/cédilles/some letters with a line through/...?).Here is the content of the method: (https://github.com/lingtalfi/Bat/blob/master/StringTool.php#L83)You can use an array key => value style to use with strtr() safely for UTF-8 characters even if they are multi-bytes.Plus, you save decode/encode in UTF-8 part.An improved version of remove_accents() function according to last version Wordpress 4.3 formatting is:My answer is an update of @dynamic solution since Romanian or perhaps other language diacritics weren't converted. I wrote the minimum functions and works like a charm.Based on @Mimouni answer I made this function to transliterate Accented strings to Non Accented strings.Something like this?If the main task is just to use the string in a URL, why not to use slugyfier?thenIt also has many bridges for popular frameworks. E.g. you can use Doctrine Extensions Sluggable behaviour to generate automatically unique slug for each entity in DB and use it in URL.If you want just to wipe out all accents you can play around with rulesets to satisfy the requirements.One of the tricks I stumbled upon on the web was using htmlentities then stripping the encoded character :Not perfect but it does work well in some case.But, you're writing about creating an URL string, so urlencode and its counterpart urldecode may be better. Or, if you are creating a query string, use this last function : http_build_query.WordPress' implementation is definitly the safest for UTF8 strings. For Latin1 strings, a simple strtr does the job, but ensure you're saving your script in LATIN1 format, not UTF-8. 

explain $CI =& get_instance();

Hailwood

[explain $CI =& get_instance();](https://stackoverflow.com/questions/4740430/explain-ci-get-instance)

Looking through codeigniter's source code,in its helper functions I keep seeing code

$CI =& get_instance();

can anyone please explain to me how this code works?I get that it is returning a reference to the $CI super object, but where does get_instance() come from?

2011-01-19 20:38:54Z

Looking through codeigniter's source code,in its helper functions I keep seeing code

$CI =& get_instance();

can anyone please explain to me how this code works?I get that it is returning a reference to the $CI super object, but where does get_instance() come from?It's basically a Singleton Design Pattern that uses a function instead of a static method.To look deeper, check out the source codeSo basically, it doesn't enforce the singleton, but it's a shortcut to a public function...Edit: Actually, now I understand.  For PHP4 compatibility they had to do a double-global-variable-hack to get it to return the references properly.  Otherwise the references would get all screwed up.  And since PHP4 didn't have support for static methods (well, properly anyway), using the function was the better way.  So it still exists for legacy reasons...So if your app is PHP5 only, there should be nothing wrong with doing CI_Base::get_instance(); instead, it's identical...get_instance() is a function defined in the core files of CodeIgniter.  You use it to get the singleton reference to the CodeIgniter super object when you are in a scope outside of the super object.I'm pretty sure it's defined in base.php or something similar.Only the class that extends CI_Controller,Model,View can use Your Custom Class cannot use the above code.

To use the above features in your custom class, your must usefor example,in your custom classthis is a singleton structure to understand how the codeigniter loads the libraries and classes$CI = get_instance(); is to replace $this to $CI on helper,

Is closing the mysql connection important?

outis

[Is closing the mysql connection important?](https://stackoverflow.com/questions/880885/is-closing-the-mysql-connection-important)

Is it crucial to close mysql connections efficiency wise, or does it automatically close after php file has run?

2009-05-19 03:48:22Z

Is it crucial to close mysql connections efficiency wise, or does it automatically close after php file has run?From the documentation:If your script has a fair amount of processing to perform after fetching the result and has retrieved the full result set, you definitely should close the connection.  If you don't, there's a chance the MySQL server will reach it's connection limit when the web server is under heavy usage.  If you can't close the MySQL connection until near the end of the script, it's cleaner though unnecessary to do so explicitly.I'm not certain how fastcgi affects things.  One page claims that a build of PHP that supports fastcgi will create persistent connections, even for mysql_connect.  This contradicts the documentation in that the connection is closed when the process, rather than the script, ends.  Rather than testing it, I'm going to recommend using mysql_close().  Actually, I recommend using PDO, if it's available.Is it crucial?  Not so muchIs it considered to be a good practice to follow?  Yes.I don't see why you wouldn't want to close it.  When using something like cgi, it's completely unnecessary to close your mysql connections since they close automatically at the end of script execution. When using persistent technologies like mod_perl and others, which maintain your connections between requests, then it's important to keep track of connections, global variables, etc.. Basically, for persistent data, clean up after yourself. For trivial, non-persistent data, it'll all go away when the request finishes anyway. Either way, best practice is to always close your connections.Gets closed as soon as the script completes execution. Unless you've opened a persistent connection. 

Ideally you should release a resource (a connection here) as soon as you are done with it. Unless there is a good chance that you will be needing it again very soon in the execution.Connection pooling or using persistent connections (if that's what you meant) is a good idea if you are behind a single database server. 

However if there are more servers and you are load balancing, it might hurt the distribution of work. Typically some clients run heavy queries while others run lighter ones. So if the same connection is used over n over, some servers would hit heavy load while others would be under utilized.

Consider using smaller ttls and variable connection pool size.Most CMSs close the MySQL connection at the end of the request, which is really meaningless, because PHP will do it anyway.However, if you have a script where the connection is no longer needed say towards the middle of the script, and then other heavy activities take place, then it's a good idea to explicitly close the connection. This will free some resources.Now, much has been said about the benefits of closing a connection, but nearly nothing has been said about the benefits of not closing it. Essentially, if you do not close the connection at the end of a script, then you really are saving some resources. Imagine a web application (or any application) receiving 100 pageviews/second. So, every second, you will need to invoke mysqli_close 100 times - which means that in every second, you have 100 unnecessary roundtrips to the database server to close the open connections. From a performance perspective, this is pure overhead, since PHP will check for open connections when the script is finished anyway and will close those connections, and it might be that, because everything happens so quickly, that PHP doesn't see that you have closed those connections and will try to close them again.Note: the answer above assumes that you are not using persistent connections (persistent connections are not used in any of the major CMSs).

Best way to code Achievements system

Gary Green

[Best way to code Achievements system](https://stackoverflow.com/questions/4192653/best-way-to-code-achievements-system)

I'm thinking of the best way to design an achievements system for use on my site. The database structure can be found at Best way to tell 3 or more consecutive records missing and this thread is really an extension to get the ideas from developers.The problem I have with lots of talk about badges/achievement systems on this website is just that -- it's all talk and no code. Where's the actual code implemention examples?I propose here a design that I hope people could contribute to and hopefully create a good design for coding extensible achievement systems. I'm not saying this is the best, far from it, but it's a possible starting block.Please feel free to contribute your ideas.my system design ideaIt seems the general consensus is to create an "event based system" -- whenever a known event occurs like a post is created, deleted, etc it calls the event class like so..The event class then finds out what badges are "listening" for this event, then it requires that file, and creates an instance of that class, like so:It then calls the default event passing the data received when trigger was called;the badgesThis is then where the real magic happens. each badge has its own query/logic to determine if a badge should be awarded. Each badge is set out in e.g. this format:award function comes from an extended class Badge which basically checks to see if the user has already be awarded that badge, if not, will update the badge db table. The badge class also takes care of retrieving all badges for a user and returning it in an array, etc (so badges can be e.g. displayed on the user profile)what about when the system is very first implemented on an already live site?There is also a "cron" job query that can be added to each badge. The reason for this is because when the badge system is very first implemented and initilaised, the badges that should have already been earned have not yet be awarded because this is an event based system. So a CRON job is run on demand for each badge to award anything that needs to be. For example the CRON job for the above would look like:As the above cron class extends the main badge class, it can re-use the logic function try_awardThe reason why I create a specialised query for this is although we could "simulate" previous events, i.e. go through every user post and trigger the event class like $event->trigger() it would be very slow, especially for many badges. So we instead create an optimized query.what user gets the award? all about awarding other users based on eventThe Badge class award function acts on user_id -- they will always be given the award. By default the badge is awarded to the person who CAUSED the event to happen i.e. the session user id (this is true for the default_event function, although the CRON job obviously loops through all users and awards seperate users)So let's take an example, on a coding challenge website users submit their coding entry. The admin then judges the entries and when complete, posts the results to the challenge page for all to see. When this happens, a POSTED_RESULTS event is called.If you want to award badges for users for all the entries posted, lets say, if they were ranked within the top 5, you should use the cron job (although bare in mind this will update for all users, not just for that challenge the results were posted for)If you want to target a more specific area to update with the cron job, let's see if there is a way to add filtering parameters into the cron job object, and get the cron_job function to use them. For example:The cron function will still work even if the parameter is not supplied.

2010-11-16 09:26:10Z

I'm thinking of the best way to design an achievements system for use on my site. The database structure can be found at Best way to tell 3 or more consecutive records missing and this thread is really an extension to get the ideas from developers.The problem I have with lots of talk about badges/achievement systems on this website is just that -- it's all talk and no code. Where's the actual code implemention examples?I propose here a design that I hope people could contribute to and hopefully create a good design for coding extensible achievement systems. I'm not saying this is the best, far from it, but it's a possible starting block.Please feel free to contribute your ideas.my system design ideaIt seems the general consensus is to create an "event based system" -- whenever a known event occurs like a post is created, deleted, etc it calls the event class like so..The event class then finds out what badges are "listening" for this event, then it requires that file, and creates an instance of that class, like so:It then calls the default event passing the data received when trigger was called;the badgesThis is then where the real magic happens. each badge has its own query/logic to determine if a badge should be awarded. Each badge is set out in e.g. this format:award function comes from an extended class Badge which basically checks to see if the user has already be awarded that badge, if not, will update the badge db table. The badge class also takes care of retrieving all badges for a user and returning it in an array, etc (so badges can be e.g. displayed on the user profile)what about when the system is very first implemented on an already live site?There is also a "cron" job query that can be added to each badge. The reason for this is because when the badge system is very first implemented and initilaised, the badges that should have already been earned have not yet be awarded because this is an event based system. So a CRON job is run on demand for each badge to award anything that needs to be. For example the CRON job for the above would look like:As the above cron class extends the main badge class, it can re-use the logic function try_awardThe reason why I create a specialised query for this is although we could "simulate" previous events, i.e. go through every user post and trigger the event class like $event->trigger() it would be very slow, especially for many badges. So we instead create an optimized query.what user gets the award? all about awarding other users based on eventThe Badge class award function acts on user_id -- they will always be given the award. By default the badge is awarded to the person who CAUSED the event to happen i.e. the session user id (this is true for the default_event function, although the CRON job obviously loops through all users and awards seperate users)So let's take an example, on a coding challenge website users submit their coding entry. The admin then judges the entries and when complete, posts the results to the challenge page for all to see. When this happens, a POSTED_RESULTS event is called.If you want to award badges for users for all the entries posted, lets say, if they were ranked within the top 5, you should use the cron job (although bare in mind this will update for all users, not just for that challenge the results were posted for)If you want to target a more specific area to update with the cron job, let's see if there is a way to add filtering parameters into the cron job object, and get the cron_job function to use them. For example:The cron function will still work even if the parameter is not supplied.I've implemented a reward system once in what you would call a document oriented database (this was a mud for players). Some highlights from my implementation, translated to PHP and MySQL:UserInfuser is an open source gamification platform which implements a badging/points service. You can check out its API here:

http://code.google.com/p/userinfuser/wiki/API_DocumentationI implemented it and tried to keep the number of functions minimal. Here is the API for a php client:The end result is to show the data in a meaningful way through the use of widgets. These widgets include: trophy case, leaderboard, milestones, live notifications, rank and points. The implementation of the API can be found here: http://code.google.com/p/userinfuser/source/browse/trunk/serverside/api/api.pyAchievements can be burdensome and even more so if you have to add them in later, unless you have a well-formed Event class.This segues into my technique of implementing achievements.I like to split them first into 'categories' and within those have tiers of accomplishment.  i.e. a kills category in a game may have an award at 1 for first kill, 10 ten kills, 1000 thousand kills etc.Then to the spine of any good application, the class handling your events.  Again imagining a game with kills; when a player kills something, stuff happens.  The kill is noted, etc and that is best handled in a centralized location, like and Events class that can dispatch info to other places involved.  It falls perfectly into place there, that in the proper method, instantiate your Achievements class and check it the player is due one.As building the Achievements class it is trivial, just something that checks the database to see if the player has as many kills as are required for the next achievement.I like to store user's achievements in a BitField using Redis but the same technique can be used in MySQL.  That is, you can store the player's achievements as an int and then and that int with the bit you have defined as that achievement to see if they have already gained it.  That way it uses only a single int column in the database.The downside to this is you have to have them organized well and you will likely need to make some comments in your code so you will remember what 2^14 corresponds to later.  If your achievements are enumerated in their own table then you can just do 2^pk where pk is the primary key of the achievements table.  That makes the check something like This way you can add achievements later and it will dovetail fine, just NEVER change the primary key of the achievements already awarded.

Why return object instead of array?

Dennis

[Why return object instead of array?](https://stackoverflow.com/questions/6710967/why-return-object-instead-of-array)

I do a lot of work in WordPress, and I've noticed that far more functions return objects than arrays. Database results are returned as objects unless you specifically ask for an array. Errors are returned as objects. Outside of WordPress, most APIs give you an object instead of an array.My question is, why do they use objects instead of arrays? For the most part it doesn't matter too much, but in some cases I find objects harder to not only process but to wrap my head around. Is there a performance reason for using an object?I'm a self-taught PHP programmer. I've got a liberal arts degree. So forgive me if I'm missing a fundamental aspect of computer science. ;)

2011-07-15 17:32:51Z

I do a lot of work in WordPress, and I've noticed that far more functions return objects than arrays. Database results are returned as objects unless you specifically ask for an array. Errors are returned as objects. Outside of WordPress, most APIs give you an object instead of an array.My question is, why do they use objects instead of arrays? For the most part it doesn't matter too much, but in some cases I find objects harder to not only process but to wrap my head around. Is there a performance reason for using an object?I'm a self-taught PHP programmer. I've got a liberal arts degree. So forgive me if I'm missing a fundamental aspect of computer science. ;)These are the reasons why I prefer objects in general:Here is something to read:This probably isn't something you are going to deeply understand until you have worked on a large software project for several years.  Many fresh computer science majors will give you an answer with all the right words (encapsulation, functionality with data, and maintainability) but few will really understand why all that stuff is good to have.Let's run through a few examples.Think about an API method that returns a list of WordPress posts.  These posts all have authors, authors have names, e-mail address, maybe even profiles with their biographies. If you are returning all of the posts in an array, you'll either have to limit yourself to returning an array of post IDs:[233, 41, 204, 111]or returning a massive array that looks something like:The first case of returning a list of IDs isn't very helpful to you because then you need to make an API call for each ID in order to get some information about that post.The second case will pull way more information than you need 90% of the time and be doing way more work (especially if any of those fields is very complicated to build).An object on the other hand can provide you with access to all the information you need, but not have actually pulled that information yet. Determining the values of fields can be done lazily (that is, when the value is needed and not beforehand) when using an object.Go back to the example of the massive array being returned. Now someone may likely build an application that iterates over each value inside the post array and prints it. If the API is updated to add just one extra element to that post array then the application code is going to break since it will be printing some new field that it probably shouldn't. If the order of items in the post array returned by the API changes, that will break the application code as well. So returning an array creates all sorts of possible dependencies that an object would not create.An object can hold information inside of it that will allow it to provide useful functionality to you. A post object, for instance, could be smart enough to return the previous or next posts. An array couldn't ever do that for you.All of the benefits of objects mentioned above help to create a more flexible system.Probably two reasons:No. But a lot of good other reasons, for example:OOP != AOP :)(For example, in Ruby, everything is an object. PHP was procedural/scripting language previously.)WordPress (and a fair amount of other PHP applications) use objects rather than arrays, for conceptual, rather than technical reasons.An object (even if just an instance of stdClass) is a representation of one thing. In WordPress that might be a post, a comment, or a user. An array on the other hand is a collection of things. (For example, a list of posts.)Historically, PHP hasn't had great object support so arrays became quite powerful early on. (For example, the ability to have arbitrary keys rather than just being zero-indexed.) With the object support available in PHP 5, developers now have a choice between using arrays or objects as key-value stores. Personally, I prefer the WordPress approach as I like the syntactic difference between 'entities' and 'collections' that objects and arrays provide.That's really a good question and not easy to answer. I can only assume that it's common in Wordpress to use stdClass objects because they're using a database class that by default returns records as a stdClass object. They got used to it (8 years and more) and that's it. I don't think there is much more thought behind the simple fact.However, if you're used to arrays, just cast:And you can access the data previously being an object, as an array. Or you like it the other way round:Which will only drop invalid member names, like numbers. So take a little care. But I think you get the big picture: There is not much difference as long as it is about arrays and objects of stdClass.Related:Probably some more reason I have thought about Objects are much more powerful than arrays can be. 

Each object as an instance of a class can have functions attached.

If you have data that need processing then you need a function that does the processing.

With an array you would have to call that function on that array and therefore associate the logic yourself to the data.

With an object this association is already done and you don't have to care about it any more.Also you should consider the OO principle of information hiding. Not everything that comes back from or goes to the database should be directly accessible.There are several reasons to return objects:In terms of performance, arrays are often faster than objects. In addition to performance, there are several reasons to use arrays:It's usually not going to be because of performance reasons. Typically, objects cost more than arrays.For a lot of APIs, it probably has to do with the objects providing other functionality besides being a storage mechanism. Otherwise, it's a matter of preference and there is really no benefit to returning an object vs an array.An array is just an index of values. Whereas an object contains methods which can generate the result for you. Sure, sometimes you can access an objects values directly, but the "right way to do it" is to access an objects methods (a function operating on the values of that object).Sometimes you are accessing an objects variables directly, this is usually frowned upon, but it happens quite often still.However, consider that the MyObject class doesn't have a variable called 'name', but instead has a first_name and last_name variable.This is a very simple example, but you can see where this is going. A class provides a collection of variables and the functions which can operate on those variables all within a self-contained logical entity. An instance of that entity is called an object, and it introduces logic and dynamic results, which an array simply doesn't have.Most of the time objects are just as fast, if not faster than arrays, in PHP there isn't a noticeable difference. the main reason is that objects are more powerful than arrays. Object orientated programming allows you to create objects and store not only data, but functionality in them, for example in PHP the MySQLi Class allows you to have a database object that you can manipulate using a host of inbuilt functions, rather than the procedural approach.So the main reason is that OOP is an excellent paradigm. I wrote an article about why using OOP is a good idea, and explaining the concept, you can take a look here: http://tomsbigbox.com/an-introduction-to-oop/As a minor plus you also type less to get data from an object - $test->data is better than $test['data'].I'm unfamiliar with word press. A lot of answers here suggest that a strength of objects is there ability to contain functional code. When returning an object from a function/API call it shouldn't contain utility functions. Just properties.The strength in returning objects is that whatever lies behind the API can change without breaking your code.Example: You get an array of data with key/value pairs, key representing the DB column. If the DB column gets renamed your code will break.Im running the next test in php 5.3.10 (windows) :andCopied from http://atomized.org/2009/02/really-damn-slow-a-look-at-php-objects/comment-page-1/#comment-186961Calling the function for 10 concurrent users and 10 times (for to obtain an average) thenAKA, Object it is still painful slow.   OOP keeps the things tidy however it should be used carefully.What Wordpress is applying?. Well, both solutions, is using objects, arrays and object & arrays, Class wpdb uses the later (and it is the heart of Wordpress).It follows the boxing and unboxing principle of OOP. While languages such as Java and C# support this natively, PHP does not. However it can be accomplished, to some degree in PHP, just not eloquently as the language itself does not have constructs to support it.  Having box types in PHP could help with chaining, keeping everything object oriented and allows for type hinting in method signatures.  The downside is overhead and the fact that you now have extra checking to do using the â€œinstanceofâ€ construct.  Having a type system is also a plus when using development tools that have intellisense or code assist like PDT. Rather than having to google/bing/yahoo for the method, it exists on the object, and you can use the tool to provide a drop down.Although the points made about objects being more than just data are valid since they are usually data and behaviour there is at least one pattern mentioned in Martin Fowler's "Patterns of Enterprise Application Architecture"  that applies to this type of cenario in which you're transfering data from one system (the application behind the API) and another (your application).Its the Data Transfer Object - An object that carries data between processes in order to reduce the number of method calls.So if the question is whether APIs should return a DTO or an array I would say that if the performance cost is negligible then you should choose the option that is more maintainable which I would argue is the DTO option... but of course you also have to consider the skills and culture of the team that is developing your system and the language or IDE support for each of the options.

How to make a drop down list in yii2?

Dency G B

[How to make a drop down list in yii2?](https://stackoverflow.com/questions/21569053/how-to-make-a-drop-down-list-in-yii2)

How to make a dropdown in yii2 using an activeform and a model? Since all the methods has changed in yii2,how it is done in the new one?

2014-02-05 05:07:06Z

How to make a dropdown in yii2 using an activeform and a model? Since all the methods has changed in yii2,how it is done in the new one?It is likeArrayHelper in Yii2 replaces the CHtml list data in Yii 1.1.[Please load array data from your controller] EDIT Load data from your controller.ControllerIn ViewIt seems you've found your answer already but since you mentioned the active form I'll contribute with one more, even if it differs only ever so slightly. There are some good solutions above, and mine is just a combination of two (I came here looking for a solution).@Sarvar Nishonboyev's solution is good because it maintains the creation of the form input label and help-block for error messages.I went with:Again, full credit to: @Sarvar Nishonboyev's and @ippiIt Seems there are many good answers for this question .So i will try to give a detailed answer active form and hardcoded data or active form and data from a db table we are going to use ArrayHelper so first add it to the name space by ArrayHelper has many use full functions which could be used to process arrays 

map () is the one we are going to use here 

this function help to make a map ( of key-value pairs) from a multidimensional array or an array of objects.not part of a active formornot an active form but data from a db table Have a look this:Maybe I'm wrong but I think that SQL query from view is a bad ideaThis is my wayIn controller And in View Or using ActiveForm This will help you...Don't forget to use the class file in header.In ActiveForm just use:This is about generating data, and so is more properly done from the model. Imagine if you ever wanted to change the way data is displayed in the drop-down box, say add a surname or something. You'd have to find every drop-down box and change the arrayHelper. I use a function in my models to return the data for a dropdown, so I don't have to repeat code in views. It also has the advantage that I can specify filter here and have them apply to every dropdown created from this model;You can use this in your view file like this;If you made it to the bottom of the list. Save some php code and just bring everything back from the DB as you need like this:Following can also be done. If you want to append prepend icon. This will be helpful.         

json_decode to custom class

Tom

[json_decode to custom class](https://stackoverflow.com/questions/5397758/json-decode-to-custom-class)

Is it possible to decode a json string to an object other than stdClass?

2011-03-22 20:59:07Z

Is it possible to decode a json string to an object other than stdClass?Not automatically. But you can do it the old fashioned route.Or alternatively, you could make that more automatic:Edit: getting a little fancier:We built JsonMapper to map JSON objects onto our own model classes automatically. It works fine with nested/child objects.It only relies on docblock type information for mapping, which most class properties have anyway:You can do it - it's a kludge but totally possible. We had to do when we started storing things in couchbase.In our benchmarks this was way faster than trying to iterate through all the class variables.Caveat: Won't work for nested objects other than stdClassEdit: keep in mind the data source, it's strongly recommended that you don't do this withe untrusted data from users without a very carful analysis of the risks.You could use Johannes Schmitt's Serializer library.In the latest version of the JMS serializer the syntax is:You can make a wrapper for your object and make the wrapper look like it is the object itself. And it will work with multilevel objects.No, this is not possible as of PHP 5.5.1.The only thing possible is to have json_decode return associate arrays instead of the StdClass objects.You can do it in below way .. ?>For more details visit 

create-custom-class-in-php-from-json-or-arrayAs Gordon says is not possible. But if you are looking for a way to obtain a string that can be decoded as an instance of a give class you can use serialize and unserialize instead.I once created an abstract base class for this purpose. Let's call it JsonConvertible. It should serialize and deserialize the public members. This is possible using Reflection and late static binding.Just from memory, so probably not flawless. You will also have to exclude static properties and may give derived classes the chance to make some properties ignored when serialized to/from json. I hope you get the idea, nonetheless.JSON is a simple protocol to transfer data between various programming languages (and it's also a subset of JavaScript) which supports just certain types: numbers, strings, arrays/lists, objects/dicts. Objects are just key=value maps and Arrays are ordered lists.So there is no way to express custom objects in a generic way. The solution is defining a structure where your program(s) will know that it's a custom object.Here's an example:This could be used to create an instance of MyClass and set the fields a and foo to 123 and "bar".I went ahead and implemented John Petit's answer, as a function(gist):This worked perfectly for my use case. However Yevgeniy Afanasyev's response seems equally promising to me. It could be possible to have your class have an extra "constructor", like so:This is also inspired by this answer.I think the simplest way is :

Install php-zip on php 5.6 on Ubuntu [duplicate]

Anthony

[Install php-zip on php 5.6 on Ubuntu [duplicate]](https://stackoverflow.com/questions/38104348/install-php-zip-on-php-5-6-on-ubuntu)

I can't install php-zip on my Ubuntu VM with the last php5.6.Can't find find anything clear on it.I still get that Apache error : Thanks

2016-06-29 15:43:36Z

I can't install php-zip on my Ubuntu VM with the last php5.6.Can't find find anything clear on it.I still get that Apache error : ThanksTry either Then, you might have to restart your web server.If you are installing on centos or fedora OS then use yum in place of apt-get. example:-sudo yum install php-zip or

sudo yum install php5.6-zip and 

sudo service httpd restart

Converting a POSTMAN request to Curl

Coder

[Converting a POSTMAN request to Curl](https://stackoverflow.com/questions/49432735/converting-a-postman-request-to-curl)

I am calling my java webservice (POST request) via POSTMAN in the following manner which works perfectly fine (i.e. I can see my records getting inserted into the database):And, here's how the contents inside the Headers(1) tab looks like:Instead of calling it via POSTMAN, I have to call the same request in PHP using CURL. I am wondering if there's a way to export this command to curl command so that I could use it in my PHP code? I have found opposite approach at many places online where someone is asking to convert Curl based request to POSTMAN but couldn't figure out how to do the opposite.Some articles I found for curl to postman

2018-03-22 15:36:35Z

I am calling my java webservice (POST request) via POSTMAN in the following manner which works perfectly fine (i.e. I can see my records getting inserted into the database):And, here's how the contents inside the Headers(1) tab looks like:Instead of calling it via POSTMAN, I have to call the same request in PHP using CURL. I am wondering if there's a way to export this command to curl command so that I could use it in my PHP code? I have found opposite approach at many places online where someone is asking to convert Curl based request to POSTMAN but couldn't figure out how to do the opposite.Some articles I found for curl to postmanYou can see the button "Code" in the attached screenshot, press it and you can get your code in many different languages including PHP cURL

Add error to Symfony 2 form element

Alex Pliutau

[Add error to Symfony 2 form element](https://stackoverflow.com/questions/12419551/add-error-to-symfony-2-form-element)

I check some validation in my controller. And I want to add error to specific element of my form on failure. My form:addError() method adds error to form, not to element. How can I add an error to locationRadius element?

2012-09-14 06:56:35Z

I check some validation in my controller. And I want to add error to specific element of my form on failure. My form:addError() method adds error to form, not to element. How can I add an error to locationRadius element?You can doAs form elements are also of FormInterface type. OK guys, I have another way. It is more complex and only for specific cases.My case:I have a form and after submit I post data to the API server. And errors I got from the API server as well.API server error format is:My goal is to get flexible solution. Lets set the error for the corresponding field. That's it!NOTE! addError() method bypasses error_mapping option.My form (Address form embedded in the Company form):CompanyAddress

phpunit avoid constructor arguments for mock

dave1010

[phpunit avoid constructor arguments for mock](https://stackoverflow.com/questions/279493/phpunit-avoid-constructor-arguments-for-mock)

What is the way to avoid phpunit having to call the constructor for a mock object? Otherwise I would need a mock object as constructor argument, another one for that etc. The api seems to be like this:I don't get it to work. It still complains about the constructor argument, even with $callOriginalConstructor set to false.I only have one object in the constructor and it is a dependency injection. So I don't think I have a design problem there.

2008-11-10 23:00:46Z

What is the way to avoid phpunit having to call the constructor for a mock object? Otherwise I would need a mock object as constructor argument, another one for that etc. The api seems to be like this:I don't get it to work. It still complains about the constructor argument, even with $callOriginalConstructor set to false.I only have one object in the constructor and it is a dependency injection. So I don't think I have a design problem there.You can use getMockBuilder instead of just getMock:See the section on "Test Doubles" in PHPUnit's documentation for details.Although you can do this, it's much better to not need to. You can refactor your code so instead of a concrete class (with a constructor) needing to be injected, you only depend upon an interface. This means you can mock or stub the interface without having to tell PHPUnit to modify the constructor behaviour.Here you go:As an addendum, I wanted to attach expects() calls to my mocked object and then call the constructor.  In PHPUnit 3.7.14, the object that is returned when you call disableOriginalConstructor() is literally an object.  Unfortunately, in PHP 5.4 there is a new option which they aren't using:ReflectionClass::newInstanceWithoutConstructorSince this wasn't available, I had to manually reflect the class and then invoke the constructor.Note, if functionCallFromConstruct is protected, you specifically have to use setMethods() so that the protected method is mocked.  Example:setMethods() must be called before the expect() call.  Personally, I chain this after disableOriginalConstructor() but before getMock().Perhaps you need to create a stub to pass in as the constructor argument. Then you can break that chain of mock objects.Alternatively you could add a parameter to getMock to prevent the calling of the default constructor.Still, I think the answer of dave1010 looks nicer, this is just for the sake of completeness.PHPUnit is designed to call the constructor on mocked objects; to prevent this you should either:

Combine two arrays

Awan

[Combine two arrays](https://stackoverflow.com/questions/6535444/combine-two-arrays)

I have two arrays like this:I want to combine these two array such that it does not contains duplicate and as well as keep their original keys. For example output should be:I have tried this but it is changing their original keys:Any solution?

2011-06-30 13:24:57Z

I have two arrays like this:I want to combine these two array such that it does not contains duplicate and as well as keep their original keys. For example output should be:I have tried this but it is changing their original keys:Any solution?Just use:That should solve it. Because you use string keys if one key occurs more than one time (like '44' in your example) one key will overwrite proceding ones with the same name. Because in your case they both have the same value anyway it doesn't matter and it will also remove duplicates.Update: I just realised, that PHP treats the numeric string-keys as numbers (integers) and so will behave like this, what means, that it renumbers the keys too...A workaround is to recreate the keys. Update 2: I always forget, that there is also an operator (in bold, because this is really what you are looking for! :D)All of this can be seen in:

http://php.net/manual/en/function.array-merge.phpYou should take to consideration that $array1 + $array2 != $array2 + $array1with $array1 + $array2and with $array2 + $array1This works:To do this, you can loop through one and append to the other:UPDATE: KingCrunch came up with the best solution: print_r($array1+$array2);If you are using PHP 7.4 or above, you can use the spread operator ... as the following examples from the PHP Docs:It works like in JavaScript ES6.See more on https://wiki.php.net/rfc/spread_operator_for_array.This works:Warning! $array1 + $array2 overwrites keys, so my solution (for multidimensional arrays) is to use array_unique()Notice:It perfectly works. Hope it helps same.The new way of doing it with php7.4 is Spread operator [...]Spread operator should have better performance than array_mergeA significant advantage of Spread operator is that it supports any traversable objects, while the array_merge function only supports arrays.https://www.php.net/manual/en/function.array-merge.php

Shorthand for arrays: is there a literal syntax like {} or []?

James

[Shorthand for arrays: is there a literal syntax like {} or []?](https://stackoverflow.com/questions/4271874/shorthand-for-arrays-is-there-a-literal-syntax-like-or)

What is the shorthand for array notation in PHP?I tried to use (doesn't work):It will be perfect, if you give links on some information about other shorthands for PHP.

2010-11-24 21:53:56Z

What is the shorthand for array notation in PHP?I tried to use (doesn't work):It will be perfect, if you give links on some information about other shorthands for PHP.Update:

As of PHP 5.4.0 a shortened syntax for declaring arrays has been introduced:Previous Answer:There isn't. Only $list = array(); But you can just start adding elements. It's perfectly OK as far as PHP is concerned. You won't even get a E_NOTICE for undefined variables.As for shorthand methods, there are lots scattered all over. If you want to find them just read The Manual.Some examples, just for your amusement:YES, it exists!!Extracted from another Stack Overflow question:Usage:Reference: PHP 5.4 Short Hand for ArraysIt is also possible to define content inside [ ] like so:This will only work in php5.4 and above.There are none as of PHP 5.3.http://us.php.net/manual/en/language.types.array.phpNope, it was proposed and rejected by the community, so for now only syntax for arrays is array().The only way to define an array in php is by the array() language construct. PHP doesn't have a shorthand for array literals like some other languages do.I just explode strings into an array like so:You can declare your array as follows:You can have as many embedded arrays as you need.

Check if var exist before unsetting in PHP?

JasonDavis

[Check if var exist before unsetting in PHP?](https://stackoverflow.com/questions/1374705/check-if-var-exist-before-unsetting-in-php)

With error reporting on, or even for best practice, when unsetting a variable in PHP, should you check to see if it exist first (in this case it does not always exist) and the unset it, or just unset it?

2009-09-03 17:03:42Z

With error reporting on, or even for best practice, when unsetting a variable in PHP, should you check to see if it exist first (in this case it does not always exist) and the unset it, or just unset it?Just unset it, if it doesn't exist, nothing will be done.From the PHP Manual:Using unset on an undefined variable will not cause any errors (unless the variable is the index of an array (or object) that doesn't exist).Therefore the only thing you need to consider, is what is most efficient. It is more efficient to not test with 'isset', as my test will show.Test:Results:Conclusion:It is always less efficient to use isset, not to mention the small amount of extra time it takes to write. It's quicker to attempt to unset an undefined variable than to check if it can be unset.If you would like to unset a variable then you can just use unsetChecking for its existence has no benefit when trying to unset a variable. If the variable is an array and you wish to unset an element you must make sure the parent exists first, this goes for object properties too. This is easily solved by wrapping the unset in an if(isset($var)){ ... } block.The reason we only check the variable(parent) is simply because we don't need to check the property/element and doing so would be a lot slower to write and compute as it would add an extra check..vs This goes without saying but it is also crucial that you know the type of the variable when getting, setting and unsetting an element or property; using the wrong syntax will throw an error. Its the same when trying to unset the value of a multidimensional array or object. You must make sure the parent key/name exists. When dealing with objects there is another thing to think about, and thats visibility. Just because it exists doesn't mean you have permission to modify it. Check this link

https://3v4l.org/hPAtoThe online tool shows code compatibility for different versions of PHPAccording to this tool the codewould work for PHP >=5.4.0 without giving you any notices/warnings/errors.

Laravel Request::all() Should Not Be Called Statically

Moose

[Laravel Request::all() Should Not Be Called Statically](https://stackoverflow.com/questions/28573860/laravel-requestall-should-not-be-called-statically)

In Laravel, I'm trying to call $input = Request::all(); on a store() method in my controller, but I'm getting the following error:Any help figuring out the best way to correct this? (I'm following a Laracast)

2015-02-18 00:31:44Z

In Laravel, I'm trying to call $input = Request::all(); on a store() method in my controller, but I'm getting the following error:Any help figuring out the best way to correct this? (I'm following a Laracast)The error message is due to the call not going through the Request facade.ChangeToand it should start working.In the config/app.php file, you can find a list of the class aliases.  There, you will see that the base class Request has been aliased to the Illuminate\Support\Facades\Request class.  Because of this, to use the Request facade in a namespaced file, you need to specify to use the base class: use Request;.Since this question seems to get some traffic, I wanted to update the answer a little bit since Laravel 5 was officially released.While the above is still technically correct and will work, the use Illuminate\Http\Request; statement is included in the new Controller template to help push developers in the direction of using dependency injection versus relying on the Facade.When injecting the Request object into the constructor (or methods, as available in Laravel 5), it is the Illuminate\Http\Request object that should be injected, and not the Request facade.So, instead of changing the Controller template to work with the Request facade, it is better recommended to work with the given Controller template and move towards using dependency injection (via constructor or methods).Example via methodExample via constructorInject the request object into the controller using Laravel's magic injection and then access the function non-statically. Laravel will automatically inject concrete dependencies into autoloaded classesuse the request() helper instead. You don't have to worry about use statements and thus this sort of problem wont happen again.simpleThe facade is another Request class, access it with the full path:From laravel 5 you can also access it through the request() function:I thought it would be useful for future visitors to provide a bit of an explanation on what is happening here.Laravel's Illuminate\Http\Request class has a method named all (in fact the all method is defined in a trait that the Request class uses, called Illuminate\Http\Concerns\InteractsWithInput). The signature of the all method at the time of writing looks like this:This method is not defined as static and so when you try to call the method in a static context, i.e. Illuminate\Http\Request::all() you will get the error displayed in OP's question. The all method is an instance method and deals with information that is present in an instance of the Request class, so calling it in this way makes no sense.A facade in Laravel provides developers with a convenient way of accessing objects in the IoC container, and calling methods on those objects. A developer can call a method "statically" on a facade like Request::all(), but the actual method call on the real Illuminate\Http\Request object is not static.A facade works like a proxy - it refers to an object in the IoC container and passes the static method call onto that object (non-statically). For instance, take the Illuminate\Support\Facades\Request facade, this is what it looks like:Under the hood, the base Illuminate\Support\Facades\Facade class uses some PHP magic, namely the __callStatic method to:This is why, as @patricus pointed out in his answer above, by changing the use/import statement to refer to the facade, the error is no longer there, because as far as PHP is concerned, all has been correctly called on an instance of Illuminate\Http\Request.Aliasing is another feature that Laravel provides for convenience. It works by effectively creating alias classes that point to facades in the root namespace. If you take a look at your config/app.php file, under the aliases key, you will find a long list of mappings of strings to facade classes. For example:Laravel creates these alias classes for you, based on your configuration and this allows you to utilise classes available in the root namespace (as referred to by the string keys of the aliases config) as if you're using the facade itself:While facades and aliasing are still provided in Laravel, it is possible and usually encouraged to go down the dependency injection route. For example, using constructor injection to achieve the same result:There are a number of benefits to this approach but in my personal opinion the greatest pro for dependency injection is that it makes your code way easier to test. By declaring the dependencies of your classes as constructor or method arguments, it becomes very easy to mock out those dependencies and unit test your class in isolation.is same in context sayingalso it happens when you import following library to api.php file.

this happens by some IDE's suggestion to import it for not finding the Route Class.just remove it and everything going to work fine.update:seems if you add this library it wont lead to errorI was facing this problem even with use Illuminate\Http\Request; line at the top of my controller. Kept pulling my hair till I realized that I was doing $request::ip() instead of $request->ip(). Can happen to you if you didn't sleep all night and are looking at the code at 6am with half-opened eyes.Hope this helps someone down the road.i make it work with a scope definitionpublic function pagar(\Illuminate\Http\Request $request)

    {

        //

PHP mailer multiple address [duplicate]

Jorge

[PHP mailer multiple address [duplicate]](https://stackoverflow.com/questions/3149452/php-mailer-multiple-address)

Here is my code.The Problem

if $email value is only 1. It will send. But multiple don't send. What should I do for this. I know that in mail function you have to separate multiple emails by comma. But not working in phpmailer.

2010-06-30 13:02:09Z

Here is my code.The Problem

if $email value is only 1. It will send. But multiple don't send. What should I do for this. I know that in mail function you have to separate multiple emails by comma. But not working in phpmailer.You need to call the AddAddress method once for every recipient. Like so:Better yet, add them as Carbon Copy recipients.To make things easy, you should loop through an array to do this.

How to write a REST API?

Erik B

[How to write a REST API?](https://stackoverflow.com/questions/4973156/how-to-write-a-rest-api)

I'm writing an iPhone app as a hobby project and it will need a web service to provide it with data. It's not very different from what I do at work, but at work I only write views and controllers. Someone else is responsible for writing the model and usually the clients provide the web service.I have done some web programming before, back when everyone were using MySQL and PHP, so my skills are a bit outdated, but I'm confident that I would be able to pull it of using the techniques I already know. However, I don't want to waste my time using obsolete tools. I've figured out that the state of the art would be to write a REST API. I was thinking that there should be some pretty good frameworks out there that pretty much just gives you a REST API with CRUD functionality as soon as you've defined a model.I guess my question is: What would be the fastest way to get a REST API up and running? I really just want to focus on writing the iPhone app and not spend too much time on this API. It would be great if I could get web administration and revision history too. I should also add that the API isn't supposed to be public, so support for authentication would be great as well.Just to be clear. I wouldn't mind a PHP framework. In fact it could possibly be better since I know that my current hosting supports it.

2011-02-11 19:26:27Z

I'm writing an iPhone app as a hobby project and it will need a web service to provide it with data. It's not very different from what I do at work, but at work I only write views and controllers. Someone else is responsible for writing the model and usually the clients provide the web service.I have done some web programming before, back when everyone were using MySQL and PHP, so my skills are a bit outdated, but I'm confident that I would be able to pull it of using the techniques I already know. However, I don't want to waste my time using obsolete tools. I've figured out that the state of the art would be to write a REST API. I was thinking that there should be some pretty good frameworks out there that pretty much just gives you a REST API with CRUD functionality as soon as you've defined a model.I guess my question is: What would be the fastest way to get a REST API up and running? I really just want to focus on writing the iPhone app and not spend too much time on this API. It would be great if I could get web administration and revision history too. I should also add that the API isn't supposed to be public, so support for authentication would be great as well.Just to be clear. I wouldn't mind a PHP framework. In fact it could possibly be better since I know that my current hosting supports it.EDIT:The links below which apparently were good for 3 years are no longer working so I went and found a couple of new tutorials that I think are going to stick around for a while. These are on the Ray Wenderlich site, a very well respected ios dev tutorial site. The first article actually references the broken links below but it is complete within itself:How To Write A Simple PHP/MySQL Web Service for an iOS Appand the second one has a little twist to it. It used parse.com on the backend and AFNetworking. Both of which are quite excellent.How To Synchronize Core Data with a Web Service – Part 1I have fixed the broken links below by finding the articles in the way back machine. People seem to like the links so I will keep them. The links above should provide more food for thought.I am doing exactly the same thing with my iphone app. I found this article on building a RESTful API in PHP:https://web.archive.org/web/20130910164802/http://www.gen-x-design.com/archives/create-a-rest-api-with-php/and there is also a followup article here:https://web.archive.org/web/20130323001500/http://www.gen-x-design.com/archives/making-restful-requests-in-php/with a link to source code at the bottom of the article.I have programmed a REST API in ZEND Framework using the Zend_Rest_Controller, on the iPhone I used ASIHTTPRequest. My experience with both where good. At the beginning I had some trouble setting up ZEND and connecting it to mySQL, but once I figured out how to do it I was able to write the API very quickly. I can share more information with you if you have any further questions.EDIT: There seems to be no official documentation on Zend_Rest_Controller. This link describes how to use it to create your API. You simply have to disable rendering in the init() of your subclass and implement the methods for each REST call.Just to let you know:I ended up using Ruby on Rails.EDIT: Since this answer has been downvoted for not providing the reason behind choosing Ruby on Rails and also no instructions on how to write a REST API with it, I thought I would give you my motivation and some simple instructions.I started reading a book about Ruby on Rails and realized that all I needed to do was to use scaffolding and I got a JSON REST API for free.Here's a good guide to get you started: http://guides.rubyonrails.org/getting_started.htmlWhen you have your Ruby on Rails environment up and running, creating your REST API isn't harder than running:(Example from the above link.) I also found that Rails is very easy and free to deploy to heroku, which meant that I didn't have to pay for hosting for my very basic, low traffic, REST API. There are many other reasons why I am very happy to work with Ruby on Rails, but that's beyond the context of this question.I followed a quite simple tutorial for creating RESTful APIs with PHP:Corey Maynard - Creating a RESTful API with PHPThe main concept includes:What about Python?I'd use Python, Django and Piston.With no experience with Python or Django probably it'll take you a day to develop this solution and all code is unit tested and proved to work.If you want to use PHP I recommend using the CodeIgniter framework with Phil Sturgeon's REST server:http://net.tutsplus.com/tutorials/php/working-with-restful-services-in-codeigniter-2https://github.com/philsturgeon/codeigniter-restserverCheckout the following PHP class that follows MVC.

http://www.phpclasses.org/package/5080-PHP-Implement-REST-Web-services-servers.htmlHope this helps.If you already know PHP, there's nothing wrong with a PHP/MySQL backend.   You can send all responses in iPhone-compatible plist xml format, and instantly turn the response into a NSDictionary/NSArray/NSNumber data structure with this short snippet of code:I also use the ASIHTTP package for forming URLs, sending asynchronous requets, and receiving the responses, I highly recommend it:http://allseeing-i.com/ASIHTTPRequest/You should use whatever languages you are comfortable with for the web service. Any language that can formulate REST responses to requests is fine.That said, if you want to get something running quickly, I suggest using Python on Google App Engine. It's free and you can use Java instead of Python if you so desire. App Engine supports authentication using OpenID and/or Google Accounts (not sure if they're mutually exclusive) so that should make things easier to code.As far as making the requests on the iOS device, I suggest using ASIHTTPRequest.Another option is restSQL, an ultra-lightweight persistence framework. See http://restsql.org. It supports MySQL and PostgreSQL and runs in a standard Java EE container, e.g. Apache Tomcat.restSQL is a very unconventional data access layer. restSQL is not an object-oriented view of the database. It presents flat or hierarchical "views" of relational database tables. These views are query-able and updatable through a simple REST-based HTTP or Java API. The HTTP interface is based on REST principles, which use HTTP’s built-in features, rather than abstracting away from them.You want a 'REST API with CRUD functionality' and that's exactly restSQL's sweet spot. You could do this with no code. Simply define your SQL Resources via XML files and start doing HTTP calls against them with full CRUD capability.

Using comet with PHP?

ryeguy

[Using comet with PHP?](https://stackoverflow.com/questions/603201/using-comet-with-php)

I was thinking of implementing real time chat using a PHP backend, but I ran across this comment on a site discussing comet:Is this true? Or is it something that can be configured around?

2009-03-02 17:30:18Z

I was thinking of implementing real time chat using a PHP backend, but I ran across this comment on a site discussing comet:Is this true? Or is it something that can be configured around?Agreeing/expanding what has already been said, I don't think FastCGI will solve the problem.Each request into Apache will use one worker thread until the request completes, which may be a long time for COMET requests.This article on Ajaxian mentions using COMET on Apache, and that it is difficult. The problem isn't specific to PHP, and applies to any back-end CGI module you may want to use on Apache.The suggested solution was to use the 'event' MPM module which changes the way requests are dispatched to worker threads.Unfortunately, that doesn't work either, because it will only 'snooze' after a request is complete, waiting for a new request from the client.Now, considering the other side of the problem, even if you resolve the issue with holding up one thread per comet request, you will still need one PHP thread per request - this is why FastCGI won't help.You need something like Continuations which allow the comet requests to be resumed when the event they are triggered by is observed. AFAIK, this isn't something that's possible in PHP. I've only seen it in Java - see the Apache Tomcat server.Edit:There's an article here about using a load balancer (HAProxy) to allow you to run both an apache server and a comet-enabled server (e.g. jetty, tomcat for Java) on port 80 of the same server.You could use Nginx and JavaScript to implement a Comet based chat system that is very scalable with little memory or CPU utilization.I have a very simple example here that can get you started. It covers compiling Nginx with the NHPM module and includes code for simple publisher/subscriber roles in jQuery, PHP, and Bash.http://blog.jamieisaacs.com/2010/08/27/comet-with-nginx-and-jquery/I found this funny little screencasts explaining simple comet. As a side note I really think this is going to kill your server on any real load. When just having a couple of users, I would say to just go for this solution. This solution is really simple to implement(screencasts only takes 5 minutes of your time :)). But as I was telling previously I don't think it is good for a lot of concurrent users(Guess you should benchmark it ;)) because:I really think you should try the alternatives if you want to do any comet/long polling. You could use many languages like for example:Just performing a simple google search, will show you a lot alternatives also PHP(which I think on any big load will kill your server).mod_php is not the only way to use PHP. You can use fastcgi. PHP must be compiled with --enable-fastcgi.PHP as FastCGI: http://www.fastcgi.com/drupal/node/5?q=node/10You may also try https://github.com/reactphp/reactThe introductory example shows a simple HTTP server listening on port 1337:I'm having a similar issue. One option I'm finding interesting is to use an existing Comet server, like cometd-java or cometd-python, as the core message hub. Your PHP code is then just a client to the Comet server -- it can post or read messages from channels, just like other clients.There's an interesting code snippet linked here: http://morglog.org/?p=22=1 that implements part of this method (although there are bits of debug code spread around, too). I'm current implementing a scalable PHP Comet server using socket functions. It is called 'phet' ( [ph]p com[et] )Project page: http://github.com/Tim-Smart/phetFree free to join in on development. I have currently managed to get most of the server logic done, just need to finish off the client side stuff.EDIT: Recently added 'Multi-threading' capabilities using the pcntl_fork method :)You'll have a hard time implementing comet in PHP, just because of it's inherent single-threaded-ness.Check out Websync On-Demand - the service lets you integrate PHP via server-side publishing, offloading the heavy concurrent connection stuff, and will let you create a real-time chat app in no time.A new module just came out for the nginx web server that'll allow Comet with any language, including PHP.http://www.igvita.com/2009/10/21/nginx-comet-low-latency-server-push/You will have to create your own server in PHP. Using Apache/mod_php or even fastcgi will not scale at all. A few years old, but can get you started:PHP-Comet-Server:

http://sourceforge.net/projects/comet/I think this is more an issue that having a lot of apache threads running all the time is a problem. That will existing with any language if it works via apache in the same way as PHP (usually) does.

PHP: How to use a class function as a callback [duplicate]

SmxCde

[PHP: How to use a class function as a callback [duplicate]](https://stackoverflow.com/questions/28954168/php-how-to-use-a-class-function-as-a-callback)

I have a class with methods which I want to use as callbacks. How to pass them as arguments?UPD: How to do the same but from static method (when $this is not available)

2015-03-10 00:25:43Z

I have a class with methods which I want to use as callbacks. How to pass them as arguments?UPD: How to do the same but from static method (when $this is not available)Check the callable manual to see all the different ways to pass a function as a callback. I copied that manual here and added some examples of each approach based on your scenario.Since 5.3 there is a more elegant way you can write it, I'm still trying to find out if it can be reduced moreYou can also to use call_user_func() to specify a callback: 

Resize image in PHP

Alex Ryans

[Resize image in PHP](https://stackoverflow.com/questions/14649645/resize-image-in-php)

I'm wanting to write some PHP code which automatically resizes any image uploaded via a form to 147x147px, but I have no idea how to go about it (I'm a relative PHP novice). So far, I've got images uploading successfully, filetypes being recognised and names cleaned up, but I'd like to add the resize functionality into the code. For example, I've got a test image which is 2.3MB, and 1331x1331 in dimension, and I'd like the code to size it down, which I'm guessing will dramatically compress the filesize of the image, too.So far, I've got the following:

2013-02-01 15:31:12Z

I'm wanting to write some PHP code which automatically resizes any image uploaded via a form to 147x147px, but I have no idea how to go about it (I'm a relative PHP novice). So far, I've got images uploading successfully, filetypes being recognised and names cleaned up, but I'd like to add the resize functionality into the code. For example, I've got a test image which is 2.3MB, and 1331x1331 in dimension, and I'd like the code to size it down, which I'm guessing will dramatically compress the filesize of the image, too.So far, I've got the following:You need to use either PHP's ImageMagick or GD functions to work with images.With GD, for example, it's as simple as...And you could call this function, like so...From personal experience, GD's image resampling does dramatically reduce file size too, especially when resampling raw digital camera images.This resource is also worth considering - some very tidy code that uses GD. However, I modified their final code snippet to create this function which meets the OPs requirements...You will also need to include this PHP file...If you dont care about the aspect ration (i.e you want to force the image to a particular dimension), here is a simplified answerNow let's handle the upload part. 

First step, upload the file to your desired directory. Then called one of the above functions based on file type (jpg, png or gif) and pass the absolute path of your uploaded file as below:The return value $img is a resource object. We can save to a new location or override the original as below:Hope this helps someone. Check these links for more on resizing  Imagick::resizeImage and 

imagejpeg()Just simply use php function: given asI hope is will work for you.(IMPORTANT: In the case of animation (animated webp or gif) resizing, the result will be a not animated, but resized image from the first frame! (The original animation remains intact...)I created this to my php 7.2 project (example imagebmp sure (PHP 7 >= 7.2.0) :php/manual/function.imagebmp) about techfry.com/php-tutorial, with GD2, (so nothing 3rd party library) and very similar to the answer of Nico Bistolfi, but works with the all five basic image mimetype (png, jpeg, webp, bmp and gif), creating a new resized file, without modifying the original one, and the all stuff in one function and ready to use (copy and paste to your project). (You can set the extension of the new file with the fifth parameter, or just leave it, if you want keep the orignal):I created an easy-to-use library for image resizing. It can be found here on Github.An example of how to use the library:Other features, should you need them, are:ZF cake:I found a mathematical way to get this job doneGithub repo - https://github.com/gayanSandamal/easy-php-image-resizerLive example - https://plugins.nayague.com/easy-php-image-resizer/You can give a try to TinyPNG PHP library. Using this library your image gets optimized automatically during resizing process. All you need to install the library and get an API key from https://tinypng.com/developers. To install a library, run the below command.After that, your code is as follows.I have a written a blog on the same topic http://artisansweb.net/resize-image-php-using-tinypngI would suggest an easy way:Here is an extended version of the answer @Ian Atkin' gave. I found it worked extremely well. For larger images that is :). You can actually make smaller images larger if you're not careful. 

Changes: 

- Supports jpg,jpeg,png,gif,bmp files

- Preserves transparency for .png and .gif

- Double checks if the the size of the original isnt already smaller

- Overrides the image given directly (Its what I needed)So here it is. The default values of the function are the "golden rule"

Regex plus vs star difference?

David19801

[Regex plus vs star difference?](https://stackoverflow.com/questions/8575281/regex-plus-vs-star-difference)

What is the difference between:andwhen I use it in my php preg_match regex?

2011-12-20 12:14:02Z

What is the difference between:andwhen I use it in my php preg_match regex?They are called quantifiers.* 0 or more of the preceding expression+ 1 or more of the preceding expressionPer default a quantifier is greedy, that means it matches as many characters as possible.The ? after a quantifier changes the behaviour to make this quantifier "ungreedy", means it will match as little as possible.Example greedy/ungreedyFor example on the string "abab"a.*b will match "abab" (preg_match_all will return one match, the "abab")while a.*?b will match only the starting "ab" (preg_match_all will return two matches, "ab")You can test your regexes online e.g. on Regexr, see the greedy example hereThe first (+) is one or more characters. The second (*) is zero or more characters. Both are non-greedy (?) and match anything (.).A + matches one or more instances of the preceding pattern. A * matches zero or more instances of the preceding pattern.So basically, if you use a + there must be at least one instance of the pattern, if you use * it will still match if there are no instances of it.+ matches at least one character* matches any number (including 0) of charactersThe ? indicates a lazy expression, so it will match as few characters as possible.+ is minimal one, * can be zero as well.Consider below is the string to match.The pattern (ab.*) will return a match for capture group with result of abWhile the pattern (ab.+) will not match and not returning anything.But if you change the string to following, it will return aba for pattern (ab.+)A star is very similar to a plus, the only difference is that while the plus matches 1 or more of the preceeding character/group, the start matches 0 or more.In RegEx, {i,f} means "between i to f matches". Let's take a look at the following examples:Most good languages contain abbreviations, so does RegEx:This means + requires at least 1 match while * accepts any number of matches or no matches at all and ? accepts no more than 1 match or zero matches.Credit: Codecademy.comI think the previous answers fail to highlight a simple example:for example we have an array:The following regex expression ^[0-9]+ matches: 15 only.

However, ^[0-9]* matches both 5 and 15. The difference is that the + operator requires at least one duplicate of the preceding regex expression

How to enable DDoS protection?

coderama

[How to enable DDoS protection?](https://stackoverflow.com/questions/14477942/how-to-enable-ddos-protection)

DDoS (Distributed Denial of Service Attacks) are generally blocked on a server level right?Is there a way to block it on a PHP level, or at least reduce it?If not, what is the fastest and most common way to stop DDoS attacks?

2013-01-23 10:54:36Z

DDoS (Distributed Denial of Service Attacks) are generally blocked on a server level right?Is there a way to block it on a PHP level, or at least reduce it?If not, what is the fastest and most common way to stop DDoS attacks?DDOS is a family of attacks which overwhelm key systems in the datacenter including:Before you start on building your DDOS defence, consider what the worst-case value-at-risk is. For a non-critical, free-to-use service for a small community, the total value at risk might be peanuts. For a paid-for, public-facing, mission-critical system for an established multi-billion dollar business, the value might be the worth of the company. In this latter case, you shouldn't be using StackExchange :) Anyway, to defend against DDOS, you need a defence in-depth approach:So, preamble aside, here are some specific answers:Not really - most of the worst DDOS attacks are low-level (at the IP packet level) and are handled by routing rules, firewalls, and security devices developed to handle DDOS attacks.Some DDOS attacks are aimed at the application itself, sending valid URIs and HTTP requests. When the rate of requests goes up, your server(s) begin to struggle and you will have an SLA outage. In this case, there are things you can do at the PHP level:The fastest is probably to give in to the blackmail, although this might not be desirable. Otherwise, the first thing you to do is contact your hosting and/or CDN provider and work with them (if they haven't contacted you already asking what the hell is going on...). When a DDOS occurs, it will likely collaterally affect other customers of the hosting provider, and the provider may be under considerable pressure to shut down your site simply to protect their resources. Be prepared to share your logs (any and all information) with the provider; these logs, combined with their network monitors, may together provide enough information to block/mitigate the attack.If you are expecting a DDOS, it's a very good idea to qualify your hosting provider on the level of protection they can provide. They should have DDOS experience and tools to mitigate it - understand their tools, processes and escalation procedures. Also ask about what support the hosting provider has from their upstream providers. These services might mean more up-front or monthly cost, but treat this as an insurance policy.While under attack, you will need to grab your logs and mine them - try and work out the pattern of the attack. You should consider switching off anonymous access and throttling the services under attack (i.e. decrease the application's rate limit for the service). If lucky and you have a small, fixed customer-base, you might be able to determine your valid customers IP addresses. If this is the case, you might switch to a white-list approach for a short while. Make sure all your customers know this is going on so they can call if they need to access from a new IP :)Doug McClean has some great advice at: https://stackoverflow.com/a/1029613/1395668According the PHP part of the question;Although I don't rely on PHP for this, it could be implemented but needs to consider all these possiblities or more;Simple pseudo;The php level is too late in the request chain. Putting your apache server behind an open source appliance may be a good option for you. http://tengine.taobao.org/ has some documentation and source code more modules aimed at DDOS prevention. It is a expansion of nginx, so you can easily set it up as a reverse proxy for your apache instance.See: http://blog.zhuzhaoyuan.com/2012/01/a-mechanism-to-help-write-web-application-firewalls-for-nginx/ for how to fight collision has DoS attacks.Totally forgot too, http://www.cloudflare.com is one the top free web application firewall, they have free and paid plans and will save your ass from DDOS we use it for alot of our high traffic sites just for its caching capabilities. It is awsome!You can not do this in PHP level. DDOS is a kind of attack that send too many requests to your webserver. Your webserver will reject request before it call your PHP script.If you are using Apache, here is some tips from Apache:

http://httpd.apache.org/docs/trunk/misc/security_tips.htmlDDoS is best handled by very expensive, purpose-built network appliances. Hosts are generally not good at doing DDoS protection because they are subject to relatively low performance, state exhaustion, limited bandwidth, etc. Use of iptables, apache mods, and similar services can help in some situations if you have no access to DDoS mitigation hardware or a DDoS mitigation service, but it is far from ideal and still leaves you at risk of attack.How about something like this on PHP side:There are plugins you can use in apache for ddos/dos. 

Good start here

http://www.debianadmin.com/how-to-protect-apache-against-dosddos-or-brute-force-attacks.htmlIf you're on LEMP, you can check here. 

http://nginx.org/en/docs/http/ngx_http_limit_conn_module.htmlThese are good inexpensive starting points.Do NOT use PHP-based protection, it's horrible and will hardly have an impact at all! Configure your webserver to rate-limit requests, for example in Nginx using the limit_req module (http://nginx.org/en/docs/http/ngx_http_limit_req_module.html)Although, I would recommend using CloudFlare to combat layer-4 - however not layer-7 based attacks unless you're willing to pay.DDOS are generally blocked on a server level, Please enable DDOS protection in your Server Level. Please check the below notes for DDOS protections. Apache HTTP Server configuration settings that can help prevent DDOS problems:The RequestReadTimeout directive allows to limit the time a client may take to send the request.Allow 10 seconds to receive the request including the headers and 30 seconds for receiving the request body:Allow at least 10 seconds to receive the request body. If the client sends data, increase the timeout by 1 second for every 1000 bytes received, with no upper limit for the timeout (except for the limit given indirectly by LimitRequestBody):The KeepAliveTimeout directive may be also lowered on sites that are subject to DoS attacks. Some sites even turn off the keepalives completely via KeepAlive, which has of course other drawbacks on performance.

The values of various timeout-related directives provided by other modules should be checked.The directives LimitRequestBody, LimitRequestFields, LimitRequestFieldSize, LimitRequestLine, and LimitXMLRequestBody should be carefully configured to limit resource consumption triggered by client input.

Tune the MaxRequestWorkers directive to allow the server to handle the maximum number of simultaneous connections without running out of resources.Anti DDOS steps:

Convert Dashes to CamelCase in PHP

Kirk Ouimet

[Convert Dashes to CamelCase in PHP](https://stackoverflow.com/questions/2791998/convert-dashes-to-camelcase-in-php)

Can someone help me complete this PHP function? I want to take a string like this: 'this-is-a-string' and convert it to this: 'thisIsAString':

2010-05-07 22:15:16Z

Can someone help me complete this PHP function? I want to take a string like this: 'this-is-a-string' and convert it to this: 'thisIsAString':No regex or callbacks necessary. Almost all the work can be done with ucwords:If you're using PHP >= 5.3, you can use lcfirst instead of strtolower.A second parameter was added to ucwords in PHP 5.4.32/5.5.16 which means we don't need to first change the dashes to spaces (thanks to Lars Ebert and PeterM for pointing this out). Here is the updated code:This can be done very simply, by using ucwords which accepts delimiter as param:NOTE: Need php at least 5.4.32, 5.5.16this is my variation on how to deal with it. Here I have two functions, first one camelCase turns anything into a camelCase and it wont mess if variable already contains cameCase. Second uncamelCase turns camelCase into underscore (great feature when dealing with database keys).lets test both:Overloaded one-liner, with doc block...I would probably use preg_replace_callback(), like this:You're looking for preg_replace_callback, you can use it like this :Untested code. Check the PHP docs for the functions im-/explode and ucfirst.One liner, PHP >= 5.3:Alternatively, if you prefer not to deal with regex, and want to avoid explicit loops:Another simple approach:here is very very easy solution in one line code output                ThisIsAString The TurboCommons library contains a general purpose formatCase() method inside the StringUtils class, which lets you convert a string to lots of common case formats, like CamelCase, UpperCamelCase, LowerCamelCase, snake_case, Title Case, and many more.https://github.com/edertone/TurboCommonsTo use it, import the phar file to your project and:Here's the link to the method source code:https://github.com/edertone/TurboCommons/blob/b2e015cf89c8dbe372a5f5515e7d9763f45eba76/TurboCommons-Php/src/main/php/utils/StringUtils.php#L653Try this:Output:Obviously, if another delimiter than '-', e.g. '_', is to be matched too, then this won't work, then a preg_replace could convert all (consecutive) delimiters to '-'  in $text first...This function is similar to @Svens's functionBut clearer, (i think :D) and with the optional parameter to capitalize the first letter or not.Usage:If you use Laravel framework, you can use just camel_case() method.Here is another option:$stringWithDash = 'Pending-Seller-Confirmation'; 

$camelize = str_replace('-', '', ucwords($stringWithDash, '-'));

echo $camelize;

output: PendingSellerConfirmationucwords second(optional) parameter helps in identify a separator to camelize the string.

str_replace is used to finalize the output by removing the separator.In Laravel use Str::camel()Here is a small helper function using a functional array_reduce approach. 

Requires at least PHP 7.0Try this:This is simpler :

Fatal error: Maximum execution time of 300 seconds exceeded

dez

[Fatal error: Maximum execution time of 300 seconds exceeded](https://stackoverflow.com/questions/7680572/fatal-error-maximum-execution-time-of-300-seconds-exceeded)

I keep getting this PHP error:I have tried setting my max_execution_time and my max_input_time settings in php.ini (both apache and cli) to 0, -1 and 4000 seconds each.And i still get the error saying:As well my script runs over 300 seconds before i get this messageI am running the script through command line.I also checked my phpinfo() so see which php.ini I am using.Even more interesting I have tried setting  max_execution_time and max_input_time settings to 5 second and my script will run way beyond 5 seconds before I get the: 

2011-10-06 21:19:10Z

I keep getting this PHP error:I have tried setting my max_execution_time and my max_input_time settings in php.ini (both apache and cli) to 0, -1 and 4000 seconds each.And i still get the error saying:As well my script runs over 300 seconds before i get this messageI am running the script through command line.I also checked my phpinfo() so see which php.ini I am using.Even more interesting I have tried setting  max_execution_time and max_input_time settings to 5 second and my script will run way beyond 5 seconds before I get the: At the beginning of your script you can add.If you are using WAMP Go to :Increase the max_execution_time in php.ini then go toC:\wamp\apps\phpmyadmin3.4.10.1\libraries (change path according to your installation)open config.default.php and change value for $cfg['ExecTimeLimit'] to 0:This will resolve the issue for PhpMyAdmin imports.Xampp UsersI encountered a similar situation, and it turns out that Codeigniter (the PHP framework I was using) actually sets its own time limit:In system/core/Codeigniter.php, line 106 in version 2.1.3 the following appears:As there was no other way to avoid changing the core file, I removed it so as to allow configuration through php.ini, as well as give the infinite maximum execution time for a CLI request.I recommend recording this change somewhere in the case of future CI version upgrades however.Try something like the following in your script:This is the the right answer:go tofind and setrestart all services

and done.go to the xampp/phpmyadmin/libraries/config.default.phpand make the following changesFor Xampp UsersPHP's CLI's default execution time is infinite.http://gr.php.net/manual/en/info.configuration.php#ini.max-execution-timeCheck if you're running PHP in safe mode, because it ignores all time exec settings when on that.For Local AppServGo to C:\AppServ\www\phpMyAdmin\libraries\config.default.phpFind $cfg['ExecTimeLimit'] and set value to 0.So it'll look likeWAMP USERS:1) Go to C:\wamp\apps\phpmyadmin2) Open config.inc3) Add $cfg['ExecTimeLimit'] = ’3600′; to the file.4) Save the file and restart the server.This file overwrites the php.ini and will work for you!In my case, when I faced that error in Phpmyadmin, I tried MySQL-Front and import my DB successfully.Note: You can still use the provided solutions under this question to solve your problem in Phpmyadmin.If above answers will not work, try to check your code,,In my experience,having an infinite loop will also cause that problem.Check your else if statement.In Codeignitor version 3.0.x the system/core/Codeigniter.php do not contain the time constraint as well as inserting will not work since codeignitor will override that with its own function set_time_limit() . 

So either you have to delete that function from codeignitor or simply you can insertin the beginning of the php file if you wanna change that to 1000 seconds.

Set the time to 0 (zero) if you want to run it as long as it want. On Xampp, in php.ini you must check mysql.connect_timeout either. So, for example, change it to:That time will be always counted in seconds (so 1 hour in my example)MAMP USERS

editing php.ini solves this - there is a line:max_execution_time = 30     ; Maximum execution time of each script, in secondssetting this to a higher value worked.the file is in php/php5.6.25/conf/php.ini (obviousl you need to wet the file for the php version you are using - you can find this out from the MAMP preferences.  If you are on xampp and using phpMyadmin to import large sql files and you have increased max_execution time, max file upload limit and everything needed And If none of the above answers work for you come hereGo to your xampp folder, in my case here is the relative path to the file that I need to modify: C:\xampp\phpMyAdmin\libraries\config.default.php/**

  * maximum execution time in seconds (0 for no limit)

  * 

  * @global integer $cfg['ExecTimeLimit']

  * by defautlt 300 is the value

  * change it to 0 for unlimited 

  * time is seconds

  * Line 709 for me

*/

 $cfg['ExecTimeLimit'] = 0;You can set time limit:

How do you pull first 100 characters of a string in PHP

JoshFinnie

[How do you pull first 100 characters of a string in PHP](https://stackoverflow.com/questions/317336/how-do-you-pull-first-100-characters-of-a-string-in-php)

I am looking for a way to pull the first 100 characters from a string variable to put in another variable for printing.  Is there a function that can do this easily?For example:To get:

2008-11-25 13:36:23Z

I am looking for a way to pull the first 100 characters from a string variable to put in another variable for printing.  Is there a function that can do this easily?For example:To get:For String Manipulation here is a page with a lot of function that might help you in your future work.You could use substr, I guess:or mb_substr for multi-byte strings:You could create a function wich uses this function and appends for instance '...' to indicate that it was shortened. (I guess there's allready a hundred similar replies when this is posted...)A late but useful answer, 

PHP has a function specifically for this purpose.mb_strimwidthtry this function Without php internal functions:

PHPUnit - 'No tests executed' when using configuration file

Muyiwa Olu

[PHPUnit - 'No tests executed' when using configuration file](https://stackoverflow.com/questions/29299206/phpunit-no-tests-executed-when-using-configuration-file)

To improve my quality of code, I've decided to try to learn how to test my code using Unit Testing instead of my mediocre-at-best testing solutions.I decided to install PHPUnit using composer for a personal library that allows me to achieve common database functions. At first I didn't have a configuration file for PHPUnit and when I ran commands like:Please note that this is a terminal command, so I didn't include the .php extension. The GeneralStringFunctionsTest referred to above is actually a GeneralStringFunctionsTest.php file.The output is what I expected:I then tried to use a configuration file to automatically load the test suite instead of having to manually type in the file every time. I created a file called phpunit.xml in my root directory, and entered the following into the file: http://pastebin.com/0j0L4WBD:Now, when I run the command:I get the following output:In case it's helpful, my directory structure is as follows:

src - Top level directory (with all my source code)

tests - Top level directory (with all my tests, structured the same as my src folder)

vendor - Composer third party files  I also have the composer json and lock file, as well as the phpunit xml file in the top level as files.

2015-03-27 11:03:49Z

To improve my quality of code, I've decided to try to learn how to test my code using Unit Testing instead of my mediocre-at-best testing solutions.I decided to install PHPUnit using composer for a personal library that allows me to achieve common database functions. At first I didn't have a configuration file for PHPUnit and when I ran commands like:Please note that this is a terminal command, so I didn't include the .php extension. The GeneralStringFunctionsTest referred to above is actually a GeneralStringFunctionsTest.php file.The output is what I expected:I then tried to use a configuration file to automatically load the test suite instead of having to manually type in the file every time. I created a file called phpunit.xml in my root directory, and entered the following into the file: http://pastebin.com/0j0L4WBD:Now, when I run the command:I get the following output:In case it's helpful, my directory structure is as follows:

src - Top level directory (with all my source code)

tests - Top level directory (with all my tests, structured the same as my src folder)

vendor - Composer third party files  I also have the composer json and lock file, as well as the phpunit xml file in the top level as files.For what it's worth (being late), I ran into this recently while I was making a new Laravel 5.1 project for a simple website. I tried to debug it and was confused when I tried:(which has a default test that just asserts true is true)and saw the outputWhat the problem ended up being for me was related to my PHP installation -- "phpunit" was globally registered and configured differently, whereas the phpunit that came with the Laravel installation was configured just right and ran perfectly.So the fix is running the vendor's configured phpunit (from the same root directory as app/ and tests/):Hope that helps someone else!Your XML file is fine as it is. However, you have to make sure that the PHP files in your tests/ folder are named as follows:tests/Test.php <--- Note the uppercase "T"

tests/userTest.php

tests/fooBarTest.php

etc.The filenames must end with "Test.php". This is what PHPUnit is looking for within directories.Furthermore, every test method must have a name that starts with "test":Hope that helps!On windows use the following command on terminalthat's if the command returns "No tests executed!"while on MacHope it helps.I had the same problem after PHPUnit on our virtual machines updated to version 6. Even --debug and --verbose said nothing useful, just "No tests executed". In the end it turned out that classes and namespaces were changed in the new version and it just didn't want to execute the files that contained references to old classes. The fix for me was just to replace in every test case this:with:You Need Just To Call It From Vendor File vendor\bin\phpunit Notice \  Not  / I pulled my hair for 10 minutes before i decided to use --debug (good way to go by the way) to discover the simple fact that file name didn't respect the naming convention, i had an extra "s" at the end.wrongrighthope this note could help for someoneI realize this is super old, but it just happened to me too. Hopefully this will help someone. My problem was that I forgot the '@' symbol in /** @test */WRONG:RIGHT:if you are using PHPSTORM go to Settings then goto Check phpunit.xml file, look inside testsuites.My version of phpunit (2019) is looking for files ending (suffix) *Test.php .

So, make sure all the test files are named properly (ex.: BookTest.php is correct, BookTests.php is not, BookTestCase.php is not).Instead of run 

phpunitusevendor\bin\phpunitHave you added a test suite to you phpunit.xml file?You can add multiple directories in there.For me, using phpunit --debug showed me which test it was not executing, 

inside, I hadand I think because the directory was protected with .htaccess authentication, it could not get through to visit the pageThe solution for me was to take out this test (or most likely take out .htaccess authentication)This is very late but I hope it helps someone.I got my tests to run by using an absolute reference.

 folder structure [ project/tests/test.php]my directory line looked like this ./tests/test.phpA little bit on the side maybe, but if you are (like me) using Laravel in Vagrant, make sure you are running phpunit inside of the vagrant box and not on the "windows side". :)I had the issue of no tests being executed, even when things were set up fine.The cause was the namespace was not the first command of the file, it was after some doc-block comments.reverting caused phpunit to see the tests and run correctly.Mine was a bit funny.When I used php artisan make:test I accidentally put .php like ProductRewardPointController.php which created ProductRewardPointController.php.php and phpunit simply ignored it.I just delete the extra .php and things back to normalI had the same issue of No tests executed!, solved by keeping the same name of file and class name.If you are using IDEs like JetBrains PHPStorm, please also notice that: in the Run/Debug Configurations window, the Test scope needs to be set to directory and point that directory to where your tests folder located.It just took me half an hour to figure out I forgot to set the directory. You can use global phpunit.phar as long as you set test scope and the directory correctly, the IDE will handle other stuff for you.using de cmd console resolved this problem passing the enterely path 

Test realizedI did't find another way to do it

It does not work from this wayI hope this was helpful for someone

Warning: DOMDocument::loadHTML(): htmlParseEntityRef: expecting ';' in Entity,

gweg

[Warning: DOMDocument::loadHTML(): htmlParseEntityRef: expecting ';' in Entity,](https://stackoverflow.com/questions/1685277/warning-domdocumentloadhtml-htmlparseentityref-expecting-in-entity)

throws

2009-11-06 03:40:26Z

throwsTo evaporate the warning, you can use libxml_use_internal_errors(true)I would bet that if you looked at the source of http://www.somesite.com/ you would find special characters that haven't been converted to HTML. Maybe something like this:Should beThis is incorrect, use this instead:The reason for your fatal error is DOMDocument does not have a __toString() method and thus can not be echo'ed. You're probably looking forThere are 2 errors: the second is because $dom is no string but an object and thus cannot be "echoed". The first error is a warning from loadHTML, caused by invalid syntax of the html document to load (probably an & (ampersand) used as parameter separator and not masked as entity with &).You ignore and supress this error message (not the error, just the message!) by calling the function with the error control operator "@" (http://www.php.net/manual/en/language.operators.errorcontrol.php )Regardless of the echo (which would need to be replaced with print_r or var_dump), if an exception is thrown the object should stay empty:Solutionreplace the simplewith the more robust ...try thisAnother possibile solution isI know this is an old question, but if you ever want ot fix the malformed '&' signs in your HTML. You can use code similar to this:Another possibile solution is,maybe your file is ASCII type file,just change the type of your files.

Strict Standards: Only variables should be passed by reference

user198729

[Strict Standards: Only variables should be passed by reference](https://stackoverflow.com/questions/2354609/strict-standards-only-variables-should-be-passed-by-reference)

The above code somehow reports the strict standars warning,but this will not:So when will it report the warning anyway?

2010-03-01 08:35:54Z

The above code somehow reports the strict standars warning,but this will not:So when will it report the warning anyway?Consider the following code:This will generate the following output:The reason? The test::get_arr() method is not a variable and under strict mode this will generate a warning. This behavior is extremely non-intuitive as the get_arr() method returns an array value.To get around this error in strict mode either change the signature of the method so it doesn't use a reference:Since you can't change the signature of array_shift you can also use an intermediate variable:$instance->find() returns reference to variable.You get the report when you are trying to use this reference as an argument to function,without storing it at variable first.This helps preventing memory leaks, and will probably become error in next PHP versions.Your 2nd code would throw error if it wrote like (note the & in function signature):So a quick (and not so nice) fix would be:Basically you do an assignment to temporary variable first, and send the variable as an argument.The cause of the error is the use of the internal PHP Programming Data Structures function, array_shift() [ php.net/end ]. The function takes an array as a parameter. Although an ampersand is indicated in the prototype of array_shift() in The Manual", there is no cautionary documentation following in the extended definition of that function, nor is there any apparent explanation that the parameter is in fact passed by reference.Perhaps this is /understood/. I did not understand, however, so it was difficult for me to detect the cause of the error.Reproduce code:The second snippet doesn't work either and that's why. array_shift is a modifier function, that changes its argument, therefore it expects its parameter to be a reference, and you cannot reference something that is not a variable. See Rasmus' explanations here: Strict standards: Only variables should be passed by referenceThis code:Need to be changed into:Well, in obvious cases like that, you can always tell PHP to suppress messages by using "@" in front of the function.$monthly_index = @array_shift(unpack('H*', date('m/Y')));It may not be one of the best programming practices to suppress all errors this way, but in certain cases (like this one) it comes handy and is acceptable. As result, I am sure your friend SysAdmin will be pleased with a less polluted error.log

Characters allowed in php array keys?

cgwebprojects

[Characters allowed in php array keys?](https://stackoverflow.com/questions/10696067/characters-allowed-in-php-array-keys)

I have some php array keys that are populated with a lot of weird characters.Is this allowed? Are there any constraints to what I cannot use?

2012-05-22 05:17:48Z

I have some php array keys that are populated with a lot of weird characters.Is this allowed? Are there any constraints to what I cannot use?According to the manual:The manual again:So in short, any string can be a key.  And a string can contain any binary data (up to 2GB).  Therefore, a key can be any binary data (since a string can be any binary data).Some random (valid) abuse of array keys:The key must be a string or an integer. There are some casts that take place, but I think the manual does a good job of explaining:I found this answer looking for more information on a problem I had.  I was using strings with UTF-8 characters in them, which would not work as keys to an array I had.Something likeThe (not big or clever) solution for me was to do this..Anything you can stuff into a PHP string can be used as an array key. There's no limit on the characters allowed.PHP array keys can be integers or strings. PHP strings are byte arrays, meaning sequences of bytes. There are no other types of strings and PHP doesn't otherwise impose any special restrictions on array key strings. In other words: as long as it's a string, anything goes.I've personally not had any problems with unusual characters in array keys.  What is and isn't legal isn't well documented, other than to say that the key must be a scalar.  Your best bet is to just try it and see. In addition to all the answers as they are true: You can use PSRs that they are some kind of rules between best programmers for having a nice and standard coding style.If complex keys are causing an "undefined index" error, you may simply have a "trim" problem.I was going nuts because a complex key was spitting out the "undefined index" error and I thought maybe it was a syntax violation. The array key causing the error was built from a field from a MySQL database query that I was converting into a key and using in a new array. The key looked like this: pl_1DNKoiJKwotCqAycickBVhTy and here's how the code was constructed.when, in fact, the $keyval and $dbquery['fieldname'] appeared to be a perfect match (visually verified by echoing both to the browser). The mystery was solved by simply using trim in the second statement like this: $keyval = trim($array_two['fieldname']); Once 'trimmed', php no longer complained.Hoping this saves some others from some frustrating moments...Encode the php page in ANSI "é" will be able for use (Cinéma wont show up as CinÃ©ma).

In Notepad++ just use the menu Encode=>Convert ANSI and save

How to install Laravel's Artisan?

totymedli

[How to install Laravel's Artisan?](https://stackoverflow.com/questions/21175570/how-to-install-laravels-artisan)

I want to create migrations in Laravel but according to the tutorials I need the Artisan CLI. The php command works fine and I'm on Windows. I type in php artisan or php artisan list and I get the following error:I wasn't able to find any guide in the documentation nor in Google. How can I install Artisan?

2014-01-17 00:16:51Z

I want to create migrations in Laravel but according to the tutorials I need the Artisan CLI. The php command works fine and I'm on Windows. I type in php artisan or php artisan list and I get the following error:I wasn't able to find any guide in the documentation nor in Google. How can I install Artisan?Artisan comes with Laravel by default, if your php command works fine, then the only thing you need to do is to navigate to the project's root folder. The root folder is the parent folder of the app folder. For example:Now the php artisan list command should work fine, because PHP runs the file called artisan in the project's folder.Keep in mind that Artisan runs scripts stored in the vendor folder, so if you installed Laravel without Composer, like downloading and extracting the Laravel GitHub repo, then you don't have the framework itself and you may get the following error when you try to use Artisan:To solve this you have to install the framework itself by running composer install in your project's root folder.You just have to read the laravel installation page:Inside your htdocs or www directory, use either:(this can lead to an error on windows computers while using latest Laravel (1.3.2))

or:(this works also on windows)

to create a project called "appName".To use "php artisan xyz" you have to be inside your project root! as artisan is a file php is going to use... Simple as that ;)While you are working with Laravel you must be in root of laravel directory structure. There are App, route, public etc folders is root directory. 

Just follow below step to fix issue.

check composer status using : composer -vFirst, download the Laravel installer using Composer:Please check with below command:still not work then create new project with existing code. using LINKExplanation: When you install a new laravel project on your folder(for example myfolder) using the composer, it installs the complete laravel project inside your folder(myfolder/laravel) than artisan is inside laravel.that's, why you see an error, Solution: You have to go inside by command prompt to that location or move laravel files inside your folder. in laravel, artisan is a file under root/protected pagefor example, you can view the content of "artisan" file with any text editor, it's a php command syntaxso when we typewe tell php to run php script in "artisan" filefor example:will show the change of current laravel versionto see the other option, just type REMEMBER THIS!!: when you have installed Composer successfully, you already have Artisan with it...hope it helps all the noobs !!

Why PHP Trait can't implement interfaces?

Leto

[Why PHP Trait can't implement interfaces?](https://stackoverflow.com/questions/14665978/why-php-trait-cant-implement-interfaces)

I'm wondering why PHP Trait (PHP 5.4) cannot implement interfaces.Update from user1460043's answer => ...cannot require class which uses it to implement a specific interface I understand that it could be obvious, because people could think that if a Class A is using a Trait T which is implementing an interface I, than the Class A should be implementing the interface I undirectly (and this is not true because Class A could rename trait methods).In my case, my trait is calling methods from the interface that the class using the trait implements. The trait is in fact an implementation of some methods of the interface.

So, i want to "design" in the code that every class that want to use my trait have to implement the interface. That would allow the Trait to use class methods defined by the interface and be sure they are existing in the class.

2013-02-02 20:08:29Z

I'm wondering why PHP Trait (PHP 5.4) cannot implement interfaces.Update from user1460043's answer => ...cannot require class which uses it to implement a specific interface I understand that it could be obvious, because people could think that if a Class A is using a Trait T which is implementing an interface I, than the Class A should be implementing the interface I undirectly (and this is not true because Class A could rename trait methods).In my case, my trait is calling methods from the interface that the class using the trait implements. The trait is in fact an implementation of some methods of the interface.

So, i want to "design" in the code that every class that want to use my trait have to implement the interface. That would allow the Trait to use class methods defined by the interface and be sure they are existing in the class.The really short version is simpler because you can't. That's not how Traits work.When you write use SomeTrait; in PHP you are (effectively) telling the compiler to copy and paste the code from the Trait into the class where it's being used.Because the use SomeTrait; is inside the class, it can't add implements SomeInterface to the class, because that has to be outside the class.Because they can't be instantiated. Traits are really just a language construct (telling the compiler to copy and paste the trait code into this class) as opposed to an object or type that can be referenced by your code.That can be enforced using an abstract class to use the trait and then extending classes from it.However - if you do need to enforce that any class that uses a Trait has a particular method, I think you may be using traits where you should have been abstract classes in the first place. Or that you have your logic the wrong way round. You're meant to require classes that implement interfaces have certain functions, not that if they have certain functions that they must declare themselves as implementing an interface.EditActually you can define abstract functions inside Traits to force a class to implement the method. e.g.However this still doesn't allow you to implement the interface in the trait, and still smells like a bad design, as interfaces are much better than traits at defining a contract that a class needs to fulfill.There's a RFC: Traits with interfaces suggests following to be added to the language:Methods required by the interface can either be implemented by the trait, or declared as abstract, in which case it is expected that class that uses the trait implements it.This feature is currently not supported by the language, but it is under consideration (current status of the RFC is: Under Discussion).This sounds very reasonable and I would not say that there has to be anything wrong with your design. Traits have been suggested with this idea in mind, see the second point here:Schärli et al, Traits: Composable Units of Behaviour, ECOOP’2003, LNCS 2743, pp. 248–274, Springer Verlag, 2003, Page 2So it would be maybe more appropriate to say that you want a trait to require an interface, not to "implement" it.I do not see a reason why it should be impossible to have this "trait requires (its consumer classes to implement) an interface" feature in PHP, but currently it seems to be missing.As @Danack notes in his answer, you can use abstract functions in the trait to "require" them from classes that use the trait. Unfortunately you can not do this with private functions.I agree with the response of @Danack, however I will complement it a little.I can only think of few cases in which what you request is necessary and is more evident as a design problem than as a language failure. Just imagine that there is an interface like this:A trait has been created that implements one of the functions defined in the interface but in the process uses other functions also defined by the interface, prone to the error that if the class that uses the feature does not implement the interface everything fails to pull the triggerAn easy solution is simply to force the class that uses the trait to implement those functions as well:So the trait isn't completely dependent on the interface, but a proposal to implement one of its functions, since when using the trait the class will demand the implementation of the abstract methods.Please excuse my English

open_basedir restriction in effect. File(/) is not within the allowed path(s):

Webnet

[open_basedir restriction in effect. File(/) is not within the allowed path(s):](https://stackoverflow.com/questions/1846882/open-basedir-restriction-in-effect-file-is-not-within-the-allowed-paths)

I'm getting this error on an avatar upload on my site.  I've never gotten it before and nothing was changed recently for me to begin getting this error...

2009-12-04 13:17:27Z

I'm getting this error on an avatar upload on my site.  I've never gotten it before and nothing was changed recently for me to begin getting this error...Modify the open_basedir settings in your PHP configuration (See Runtime Configuration).The open_basedir setting is primarily used to prevent PHP scripts for a particular user from accessing files in another user's account. So usually, any files in your own account should be readable by your own scripts.Example settings via .htaccess if PHP runs as Apache module on a Linux system:Modify the open_basedir settings in your hosting account and set them to none. Find the open_basedir setting given under 'PHP Settings' area of your Plesk/cPanel. Set it to 'none' from the dropdown given there.

I have shown them in the Plesk panel picture.

To resolve this error, you must edit the file httpd.conf. 

Way before it can be seen in phpinfo in apache2handler section directive Server Root.

For example, in my case this way - / etc / httpd / httpd.conf.

Open the file httpd.conf, find the mention of the parameter open_basedir. And set it to none. (php_admin_value open_basedir none)For me the problem was bad/missing config values for the Plesk server running the whole thing.

I just followed the directions here:

http://davidseah.com/blog/2007/04/separate-php-error-logs-for-multiple-domains-with-plesk/You can configure PHP to have a separate error log file for each VirtualHost definition. The trick is knowing exactly how to set it up, because you can’t touch the configuration directly without breaking Plesk.

Every domain name on your (dv) has its own directory in /var/www/vhosts. A typical directory has the following top level directories:You’ll want to create a vhost.conf file in the domain directory’s conf/ folder with the following lines:Change the first value to match your actual installation (I used /tmp/phperrors.log). After you’re done editing the vhost.conf file, test the configuration from the console with:And finally tell Plesk that you’ve made this change.If you're running this with php file.php. You need to edit php.ini

Find this file:And append file's path to open_basedir property:open_basedir = /srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/:/etc/webapps/:/run/media/andrew/ext4/protected

The path you're refering to is incorect, and not withing the directoryRoot of your workspace. Try building an absolute path the the file you want to access, where you are now probably using a relative path...if you have this kind of problem with ispconfig3 and got an error like thisTo solve it (in my case) , just set PHP to SuPHP in the Website's panel of ispconfig3 Hope it helps someone :)I had this problem @ one of my wordpress sites after updating and/or moving :)Check in database table 'wp_options' the 'upload_path' and edit it properly...If you are running a PHP IIS stack and have this error, it is usually a quick permission fix.If you administer the windows server yourself and have access, try this FIRST: Navigate to the folder that is giving you grief on writing to and right click it > open properties > security.  See what users have access to the folder, which ones have read only and which have full. Do you have a group that is blocking write? The fix will be specific to your IIS setup, are you using Anonymous Authentication with specific user IUSR or with the Application Pool identity? At any rate, you are going to end up adding a new full write permission for one of IUSR, IIS_IUSRS, or your application pool identity - like I said, this is going to vary depending on your setup and how you want to do it, you can go down the google rabbit hole on this one (one such post - IIS_IUSRS and IUSR permissions in IIS8) For me, i use anon with my app pool identity so i can get away with MACHINE_NAME\IIS_IUSRS with full read/write on any temp or upload folders. I do not need to add anything extra to my open_basedir = in the php.ini.In addition to @yogihosting's answer, if you are using DirectAdmin, then follow these steps:There is another way of editing the configuration file, however:Caution: Be careful, and use the following steps at your own risk, as you may run into errors, or it may lead to downtime. The recommended way is the previous one, as it prevents you from modifying configuration file improperly and show you the error.Again, the first solution is the preferred one, and you should not try the second method at the first time. As it is noted in the caution, the advantage of the first way is that it prevents saving your bad-configured stuff.Hope it helps!I am using an Apache vhost-File to run PHP with application-specific ini-options on my windows-server. Therefore I use the -d option of the php-command.I am setting the open_basedir for every application as one of these options.I needed to set multiple urls as open_basedir, including an UNC-Path, and the syntax for this case was a bit hard to find. You have to seperate the paths with semicolons and if your first path starts with a driveletter you might have to start the list with a semicolon too. At least that's what works for me.Example:If used ispconfig3:Just search in php.ini and disable it. That's the simplest solution to solve this issue. Before Changes  open_basedir =After Changes  ;open_basedir =P.s - After changes don't forget to restart your server.Enjoy ;)

Issues with PHP 5.3 and sessions folder

Itay Moav -Malimovka

[Issues with PHP 5.3 and sessions folder](https://stackoverflow.com/questions/2904862/issues-with-php-5-3-and-sessions-folder)

I recently upgraded to PHP 5.3 and since then I get (sporadic) error messages which indicate Apache (or may be the cleaner of the session files) has no permissions to the folder where the sessions are stored.

This happens randomly and can't be reproduced with exact steps, which led me to guess it is the session cleaner.

Any one has any experience with such errors?The error message (which is fired on the session_start() line) is:ls -ltr on the session directory gives:Inside this directory I do see session files owned by www-data which is my Apache, and the app does work fine. 

Which makes me wonder, under which user does the session GC runs?

2010-05-25 13:06:35Z

I recently upgraded to PHP 5.3 and since then I get (sporadic) error messages which indicate Apache (or may be the cleaner of the session files) has no permissions to the folder where the sessions are stored.

This happens randomly and can't be reproduced with exact steps, which led me to guess it is the session cleaner.

Any one has any experience with such errors?The error message (which is fired on the session_start() line) is:ls -ltr on the session directory gives:Inside this directory I do see session files owned by www-data which is my Apache, and the app does work fine. 

Which makes me wonder, under which user does the session GC runs?The fix: In your php.ini set session.gc_probability to 0The cause

I believe I found the answer here http://somethingemporium.com/2007/06/obscure-error-with-php5-on-debian-ubuntu-session-phpini-garbageEssentially, the garbage collection is set up to be done by cron jobs on some systems (i.e. Ubuntu/Debian).  Some php ini executables like php-cli also try to do garbage collection and that results in the error you got. This seems to be a typical error on Ubuntu servers (I'm using Lucid LTS). The default permissions of the /var/lib/php5 directory there are so it can be written but not read by the web server, I guess that explains the errors.As Ubuntu has it's own garbage cleaning via cron (/etc/cron.d/php5), it's probably best to disable php's garbage collection as suggested above by Diwant Vaidya.There's actually a reason the session folder should not be world readable - as the PHP Manual says:The solution I currently use (which I am not sure is the correct one) is to give ownership on the session folder to the Apache user (www-data in my case).This issue has been bugging me for a while.  I changed the value as suggested in php.ini and the issue kept occurring.  I found the same config value in my index.php and also private/Zend/session.php.  So it's worth looking a bit deeper if the issue keeps occurring.  I hope this is useful for someone.

Adding three months to a date in PHP

user979331

[Adding three months to a date in PHP](https://stackoverflow.com/questions/9875076/adding-three-months-to-a-date-in-php)

I have a variable called $effectiveDate containing the date 2012-03-26.I am trying to add three months to this date and have been unsuccessful at it.Here is what I have tried:and What am I doing wrong? Neither piece of code worked.

2012-03-26 15:33:48Z

I have a variable called $effectiveDate containing the date 2012-03-26.I am trying to add three months to this date and have been unsuccessful at it.Here is what I have tried:and What am I doing wrong? Neither piece of code worked.Change it to this will give you the expected format:This answer is not exactly to this question. But I will add this since this question still searchable for how to add/deduct period from date.I assume by "didn't work" you mean that it's giving you a timestamp instead of the formatted date, because you were doing it correctly:Tchoupi's answer can be made a tad less verbose by concatenating the argument for strtotime() as follows:(This relies on magic implementation details, but you can always go have a look at them if you're rightly mistrustful.)You need to convert the date into a readable value. You may use strftime() or date().Try this:This should work. I like using strftime better as it can be used for localization you might want to try it.The following should work,Please Try this:Following should workAdd nth Days, months and yearsThe following should work, but you may need to change the format:You can use simpleDate class from PHP Simple Libraries:Check the library tutorials here.

Random number in range [min - max] using PHP

Val

[Random number in range [min - max] using PHP](https://stackoverflow.com/questions/4173867/random-number-in-range-min-max-using-php)

Is there a way to generate a random number based on a min and max?For example, if min was 1 and max 20 it should generate any number between 1 and 20, including 1 and 20?

2010-11-13 17:46:39Z

Is there a way to generate a random number based on a min and max?For example, if min was 1 and max 20 it should generate any number between 1 and 20, including 1 and 20?In a new PHP7 there is a finally a support for a cryptographically secure pseudo-random integers.which basically makes previous answers obsolete.A quicker faster version would use mt_rand:Source: http://www.php.net/manual/en/function.mt-rand.php. NOTE: Your server needs to have the Math PHP module enabled for this to work. If it doesn't, bug your host to enable it, or you have to use the normal (and slower) rand().orhttp://php.net/manual/en/function.rand.phpI have bundled the answers here and made it version independent;Docs for PHP's rand function are here:http://php.net/manual/en/function.rand.phpUse the srand() function to set the random number generator's seed value.Try This one. It will generate id according to your wish.

Laravel validation attributes「nice names」

Hak

[Laravel validation attributes「nice names」](https://stackoverflow.com/questions/17047116/laravel-validation-attributes-nice-names)

I'm trying to use the validation attributes in "language > {language} > validation.php", to replace the :attribute name (input name) for a proper to read name (example: first_name > First name) . It seems very simple to use, but the validator doesn't show the "nice names".I have this:For showing the errors:And the validation in the controller:The $messages array:Can someone tell me what i'm doing wrong. I want the :attribute name to be replaced by the "nice name" in the attributes array (language).Thanks!EDIT:I noticed that the problem is I never set a default language for my Laravel projects. When I set the language to 'NL' the code above works. But, when I set my language, the language will appear in the url. And I prefer it doesn't. So my next question: Is it possible to remove the language from the url, or set the default language so it just doesn't appear there?

2013-06-11 14:50:00Z

I'm trying to use the validation attributes in "language > {language} > validation.php", to replace the :attribute name (input name) for a proper to read name (example: first_name > First name) . It seems very simple to use, but the validator doesn't show the "nice names".I have this:For showing the errors:And the validation in the controller:The $messages array:Can someone tell me what i'm doing wrong. I want the :attribute name to be replaced by the "nice name" in the attributes array (language).Thanks!EDIT:I noticed that the problem is I never set a default language for my Laravel projects. When I set the language to 'NL' the code above works. But, when I set my language, the language will appear in the url. And I prefer it doesn't. So my next question: Is it possible to remove the language from the url, or set the default language so it just doesn't appear there?Yeahh, the "nice name" attributes as you called it was a real "issue" a few month ago.

Hopefully this feature is now implemented and is very simply to use.For simplicity i will split the two options to tackle this problem:ResourcesThere is a really awesome repo on Github that have a lot of languages packages ready to go. Definitely you should check it out.Hope this helps.The correct answer to this particular problem would be to go to your app/lang folder and edit the validation.php file at the bottom of the file there is an array called attributes:So I believe this array was built to customise specifically these attribute names.Since Laravel 5.2 you could... In the "attributes" array the key is the input name and the value is the string you want to show in the message. An example if you have an input like thisThe array (in the validation.php file)  should be I tried the same thing and it works great. Hope this helps.EDITAlso I am noticing you don't pass a parameter to $errors->has() so maybe that's the problem.To fix this check out in the controller if you have a code like thisthen you have to pass to the has() method the "register" key (or whatever you are using) like thisAnother way to display error messages is the following one which I prefer (I use Twitter Bootstrap for the design but of course you can change those with your own design) I use my custom language files as Input for the "nice names" like this:In Laravel 4.1 the easy way to do this is go to the lang folder -> your language(default en) -> validation.php.When you have this in your model, for example:And you do not want the error to be "please enter a group id", you can create "nice" validation messages by adding a custom array in validation.php.

So in our example, the custom array would look like this:This also works with multi-language apps, you just need to edit (create) the correct language validation file.The default language is stored in the app/config/app.php configuration file, and is English by default.

This can be changed at any time using the App::setLocale method.More info to both errors and languages can be found here validation and localization.The :attribute can only use the attribute name (first_name in your case), not nice names.But you can define custom messages for each attribute+validation by definine messages like this:Well, it's quite an old question but I few I should point that problem of having the language appearing at the URL can be solved by:If needed to persist it through session, I currently use the "AppServiceProvider" to do this, but, I think a middleware might be a better approach if changing the language by URL is needed, so, I do like this at my provider:This way I handle the session and it don't stick at my url.To clarify I'm currently using Laravel 5.1+ but shouldn't be a different behavior from 4.x;

Why does 1234 == '1234 test' evaluate to true? [duplicate]

Cjueden

[Why does 1234 == '1234 test' evaluate to true? [duplicate]](https://stackoverflow.com/questions/12151997/why-does-1234-1234-test-evaluate-to-true)

An easy answer for someone I'm sure. Can someone explain why this expression evaluates to true?

2012-08-28 02:24:09Z

An easy answer for someone I'm sure. Can someone explain why this expression evaluates to true?Because you are using the == (similarity) operator and PHP is coercing the string to an int.To resolve it use the === (equality) operator, which checks not only if the value is the same, but also if the data type is the same, so "123" string and 123 int won't  be considered equal.In PHP (and JavaScript -- which has slightly different behavior), the comparison operator == works differently than it does in strongly-typed languages like C or Java. The === operator has the behavior that you most likely expect. Below is a breakdown of the two comparison operators as they apply to PHP. This operator is officially known as the "equality" operator, though that doesn't really fit the normal definition of the word "equality". It does what is known as a type-juggling comparison. If the types of both operands don't match (in your example, 1234 was an integer and 1234 test was a string), PHP will implicitly cast the operands to each others' types and test the equality of the newly-typed values as shown below:It has a counterpart (type-juggling) inequality operator, !=.The === operator, known as the "identical" operator, performs a strict check of the value and type of both operands and does not perform any implicit casts. Therefore, "0" does not === 0 and "1234 test"does not === 1234. It has a counterpart (strict) inequality operator, !==.Note that the === operator has behavior on objects that is considered strange by some. Say we have class A and variables $a and $b as defined below:You might expect var_dump($a === $b); to output bool(true). It will actually return false. When used upon objects, the operator actually checks if both operands are references to the same object. The == operator, in this instance, works by checking the properties of the objects, so $a == $b.When casting a string to an integer, any numeric characters up to the first non-numeric character becomes the number. Thus '1234 test' becomes 1234 because space is not a numeric character.Thus 1234 == '1234 test'If you want to force a string comparison, you should cast to string:You are loosely comparing two different types of data (an integer and a string).  PHP has a very detailed chart of how comparisons work in their system when using the loose comparison binary operator (==):http://php.net/manual/en/types.comparisons.phpIf you want to ensure that the types are also in sync, that is that they are both integers or both strings, use the strong type comparison operator (===).Note that, when using this operator, this will also return false:If you are unsure of your types when comparing, you can couple the strong-type comparison with PHP typecasting:The double equals will tell php to parse an int from the string.  The string will evaluate to the integer 1234.  Use triple equals '===' to get exact comparison.If you compare a number with a string or the comparison involves numerical strings, then each string is converted to a number and the comparison performed numerically

Optimizing Kohana-based Websites for Speed and Scalability

Sampson

[Optimizing Kohana-based Websites for Speed and Scalability](https://stackoverflow.com/questions/1260134/optimizing-kohana-based-websites-for-speed-and-scalability)

A site I built with Kohana was slammed with an enormous amount of traffic yesterday, causing me to take a step back and evaluate some of the design. I'm curious what are some standard techniques for optimizing Kohana-based applications?I'm interested in benchmarking as well. Do I need to setup Benchmark::start() and Benchmark::stop() for each controller-method in order to see execution times for all pages, or am I able to apply benchmarking globally and quickly?I will be using the Cache-library more in time to come, but I am open to more suggestions as I'm sure there's a lot I can do that I'm simply not aware of at the moment.

2009-08-11 12:48:08Z

A site I built with Kohana was slammed with an enormous amount of traffic yesterday, causing me to take a step back and evaluate some of the design. I'm curious what are some standard techniques for optimizing Kohana-based applications?I'm interested in benchmarking as well. Do I need to setup Benchmark::start() and Benchmark::stop() for each controller-method in order to see execution times for all pages, or am I able to apply benchmarking globally and quickly?I will be using the Cache-library more in time to come, but I am open to more suggestions as I'm sure there's a lot I can do that I'm simply not aware of at the moment.What I will say in this answer is not specific to Kohana, and can probably apply to lots of PHP projects.Here are some points that come to my mind when talking about performance, scalability, PHP, ...

I've used many of those ideas while working on several projects -- and they helped; so they could probably help here too.

First of all, when it comes to performances, there are many aspects/questions that are to consider:The first thing that could be really useful is using a reverse proxy, like varnish, in front of your webserver: let it cache as many things as possible, so only requests that really need PHP/MySQL calculations (and, of course, some other requests, when they are not in the cache of the proxy) make it to Apache/PHP/MySQL.About using a reverse-proxy as cache, for a PHP application, you can, for instance, take a look at Benchmark Results Show 400%-700% Increase In Server Capabilities with APC and Squid Cache.

(Yep, they are using Squid, and I was talking about varnish -- that's just another possibility ^^ Varnish being more recent, but more dedicated to caching)If you do that well enough, and manage to stop re-generating too many pages again and again, maybe you won't even have to optimize any of your code ;-)

At least, maybe not in any kind of rush... And it's always better to perform optimizations when you are not under too much presure...

As a sidenote: you are saying in the OP: This is the kind of sudden situation where a reverse-proxy can literally save the day, if your website can deal with not being up to date by the second:About that, How can I detect and survive being「Slashdotted」? might be an interesting read.First of all: are you using a recent version of PHP? There are regularly improvements in speed, with new versions ;-)

For instance, take a look at Benchmark of PHP Branches 3.0 through 5.3-CVS.Note that performances is quite a good reason to use PHP 5.3 (I've made some benchmarks (in French), and results are great)...

Another pretty good reason being, of course, that PHP 5.2 has reached its end of life, and is not maintained anymore!As much as possible, it is better to avoid doing the same thing over and over again.The main thing I'm thinking about is, of course, SQL Queries: many of your pages probably do the same queries, and the results of some of those is probably almost always the same... Which means lots of "useless" queries made to the database, which has to spend time serving the same data over and over again.

Of course, this is true for other stuff, like Web Services calls, fetching information from other websites, heavy calculations, ...It might be very interesting for you to identify:And store these data/results in some kind of cache, so they are easier to get -- faster -- and you don't have to go to your SQL server for "nothing".Great caching mechanisms are, for instance:I'm pretty sure your framework comes with some cache-related stuff; you probably already know that, as you said "I will be using the Cache-library more in time to come" in the OP ;-)Now, a nice thing to do would be to use the Xdebug extension to profile your application: it often allows to find a couple of weak-spots quite easily -- at least, if there is any function that takes lots of time.Configured properly, it will generate profiling files that can be analysed with some graphic tools, such as:For instance, here are a couple screenshots of KCacheGrind:

(source: pascal-martin.fr)

(source: pascal-martin.fr)  (BTW, the callgraph presented on the second screenshot is typically something neither WinCacheGrind nor Webgrind can do, if I remember correctly ^^ )

(Thanks @Mikushi for the comment) Another possibility that I haven't used much is the the xhprof extension : it also helps with profiling, can generate callgraphs -- but is lighter than Xdebug, which mean you should be able to install it on a production server.You should be able to use it alonside XHGui, which will help for the visualisation of data.Now that we've spoken a bit about PHP, note that it is more than possible that your bottleneck isn't the PHP-side of things, but the database one...At least two or three things, here:Still, the two most important things are:If you are still reading, what else could be optimized? Well, there is still room for improvements... A couple of architecture-oriented ideas might be:Well, maybe some of those ideas are a bit overkill in your situation ^^

But, still... Why not study them a bit, just in case ? ;-)Your initial question was about optimizing an application that uses Kohana... Well, I've posted some ideas that are true for any PHP application... Which means they are true for Kohana too ;-)

(Even if not specific to it ^^)I said: use cache; Kohana seems to support some caching stuff (You talked about it yourself, so nothing new here...)

If there is anything that can be done quickly, try it ;-)I also said you shouldn't do anything that's not necessary; is there anything enabled by default in Kohana that you don't need? 

Browsing the net, it seems there is at least something about XSS filtering; do you need that?Still, here's a couple of links that might be useful:And, to conclude, a simple thought: I'm not saying you shouldn't optimize: you definitely should!

But go for "quick" optimizations that will get you big rewards first: using some opcode cache might help you get between 10 and 50 percent off your server's CPU-load... And it takes only a couple of minutes to set up ;-) On the other side, spending 3 days for 2 percent... Oh, and, btw: before doing anything: put some monitoring stuff in place, so you know what improvements have been made, and how!

Without monitoring, you will have no idea of the effect of what you did... Not even if it's a real optimization or not!For instance, you could use something like RRDtool + cacti.

And showing your boss some nice graphics with a 40% CPU-load drop is always great ;-)

Anyway, and to really conclude: have fun!

(Yes, optimizing is fun!)

(Ergh, I didn't think I would write that much... Hope at least some parts of this are useful... And I should remember this answer: might be useful some other times...)Use XDebug and WinCacheGrind or WebCacheGrind to profile and analyze slow code execution.

(source: jokke.dk)

Profile code with XDebug.Use a lot of caching. If your pages are relatively static, then reverse proxy might be the best way to do it. Kohana is out of the box very very fast, except for the use of database objects. To quote Zombor "You can reduce memory usage by ensuring you are using the database result object instead of result arrays." This makes a HUGEE performance difference on a site that is being slammed. Not only does it use more memory, it slows down execution of scripts.Also - you must use caching. I prefer memcache and use it in my models like this:This will also dramatically increase performance. The above two techniques improved a sites performance by 80%.If you gave some more information about where you think the bottleneck is, I'm sure we could give some better ideas. Also check out yslow (google it) for some other performance tips.Strictly related to Kohana (you probably already have done this, or not):In production mode:Just my 2 cents :)I totally agree with the XDebug and caching answers. Don't look into the Kohana layer for optimization until you've identified your biggest speed and scale bottlenecks.XDebug will tell you were you spend the most of your time and identify 'hotspots' in your code. Keep this profiling information so you can baseline and measure performance improvements.Example problem and solution:

If you find that you're building up expensive objects from the database each time, that don't really change often, then you can look at caching them with memcached or another mechanism. All of these performance fixes take time and add complexity to your system, so be sure of your bottlenecks before you start fixing them.

PHP get domain name [duplicate]

Francisc

[PHP get domain name [duplicate]](https://stackoverflow.com/questions/5404811/php-get-domain-name)

I want to get the domain name for where the script is running. How can that be done with PHP?

I see that $_SERVER['HTTP_HOST'] as well as $_SERVER['SERVER_NAME'] contain this information.

Will that variable always work and should I use one over the other?Thank you.

2011-03-23 11:53:46Z

I want to get the domain name for where the script is running. How can that be done with PHP?

I see that $_SERVER['HTTP_HOST'] as well as $_SERVER['SERVER_NAME'] contain this information.

Will that variable always work and should I use one over the other?Thank you.Similar question has been asked in stackoverflow before. See here: PHP $_SERVER['HTTP_HOST'] vs. $_SERVER['SERVER_NAME'], am I understanding the man pages correctly?Also see this article: http://shiflett.org/blog/2006/mar/server-name-versus-http-host To answer your question, these should work as long as:But, if I remember correctly, these values can be faked to an extent, so it's best not to rely on them.My personal preference is to set the domain name as an environment variable in the apache2 virtual host:And read it in PHP:This, however, isn't applicable in all circumstances.

multiple ways of calling parent method in php

jerry

[multiple ways of calling parent method in php](https://stackoverflow.com/questions/11237511/multiple-ways-of-calling-parent-method-in-php)

At first I was confused why both of the method calls in the constructor work, but now I think I understand. The extending classes inherit the parent's methods as if they were declared in the class itself, AND the methods exist in the parent, so both should work.Now I'm wondering if there is a preferred way (i.e. best practice) of calling the method (via parent or this), and whether or not these are truly identical ways of executing the same code, or if there are any caveats when using one over the other.Sorry, I'm probably over thinking this.

2012-06-28 03:00:40Z

At first I was confused why both of the method calls in the constructor work, but now I think I understand. The extending classes inherit the parent's methods as if they were declared in the class itself, AND the methods exist in the parent, so both should work.Now I'm wondering if there is a preferred way (i.e. best practice) of calling the method (via parent or this), and whether or not these are truly identical ways of executing the same code, or if there are any caveats when using one over the other.Sorry, I'm probably over thinking this.There are three scenarios (that I can think of) where you would call a method in a subclass where the method exits in the parent class:The only scenario I can imagine where you would need to call the parent method directly outside of the overriding method would be if they did two different things and you knew you needed the parent's version of the method, not the local.  This shouldn't be the case, but if it did present itself, the clean way to approach this would be to create a new method with a name like get_parentSpecies() where all it does is call the parent method: Again, this keeps everything nice and consistent, allowing for changes/modifications to the local method rather than relying on the parent method.Unless I am misunderstanding the question, I would almost always use $this->get_species because the subclass (in this case dog) could overwrite that method since it does extend it.  If the class dog doesn't redefine the method then both ways are functionally equivalent but if  at some point in the future you decide you want the get_species method in dog should print "dog" then you would have to go back through all the code and change it.  When you use $this it is actually part of the object which you created and so will always be the most up-to-date as well (if the property being used has changed somehow in the lifetime of the object) whereas using the parent class is calling the static class method.

Upload Progress Bar in PHP

Josh Curren

[Upload Progress Bar in PHP](https://stackoverflow.com/questions/849237/upload-progress-bar-in-php)

Does anyone know how to get a progress bar for an upload in php? I am trying writing code for a photo album uploader. I would like a progress bar to display while the photos are uploading. I am fairly new to php so I dont know everything about it. 

2009-05-11 17:51:24Z

Does anyone know how to get a progress bar for an upload in php? I am trying writing code for a photo album uploader. I would like a progress bar to display while the photos are uploading. I am fairly new to php so I dont know everything about it. This is by far (after hours of googling and trying scripts) the simplest to set up and nicest uploader I've foundhttps://github.com/FineUploader/fine-uploaderIt doesn't require APC or any other external PHP libraries, I can get file progress feedback on a shared host, and it claims to support html5 drag and drop (personally untested) and multiple file uploads.If you have APC installed, it has a callback hook for upload progress.Rasmus Lerdorf (PHP's creator) has a sample of this using YUI (oh, and here's the PHP source).See the documentation here.I'm sorry to say that to the best of my knowledge a pure PHP upload progress bar, or even a PHP/Javascript upload progress bar is not possible because of how PHP works. Your best bet is to use some form of Flash uploader.AFAIK This is because your script is not executed until all the superglobals are populated, which includes $_FILES. By the time your PHP script gets called, the file is fully uploaded.EDIT: This is no longer true. It was in 2010.One PHP-ish (5.2+) & no-Flash way that worked nicely for me:First, see this post explaining how to get "uploadprogress" extension up and running.Then, in the page containing the form that you are uploading file(s) from, create the following iframe:Next, add this code to your "Submit" button:Now you have a hidden iframe in your form that will come visible and show contents of uploadprogress.php when you click "Submit" to start uploading files. $upload_id must be the same that you are using as the value of hidden field "UPLOAD_IDENTIFIER" in your form.The uploadprogress.php itself looks about like this (fix and adjust to your needs):Note that is self-refreshes every second. You can surely add some nice visual progress bar here (like 2 nested <div>s with different colors) if you like. The iframe with upload progress naturally only works while the upload is in progress, and ends its visible life once the form is submitted and browser reloads to the next page.Implementation of the upload progress bar is easy and doesn't require any additional PHP extension, JavaScript or Flash. But you need PHP 5.4 and newer.You have to enable collecting of the upload progress information by setting the directive session.upload_progress.enabled to On in php.ini.Then add a hidden input to the HTML upload form just before any other file inputs. HTML attribute name of that hidden input should be the same as the value of the directive session.upload_progress.name from php.ini (eventually preceded by session.upload_progress.prefix). The value attribute is up to you, it will be used as part of the session key.HTML form could looks like this:When you send this form, PHP should create a new key in the $_SESSION superglobal structure which will be populated with the upload status information. The key is concatenated name and value of the hidden input.In PHP you can take a look at populated upload information:The output will look similarly to the following:There is all the information needed to create a progress bar — you have the information if the upload is still in progress, the information how many bytes is going to be transferred in total and how many bytes has been transferred already.To present the upload progress to the user, write an another PHP script than the uploading one, which will only look at the upload information in the session and return it in the JSON format, for example. This script can be called periodically, for example every second, using AJAX and information presented to the user.You are even able to cancel the upload by setting the $_SESSION[$key]['cancel_upload'] to true.For detailed information, additional settings and user's comments see PHP manual.Another uploader full JS : http://developers.sirika.com/mfu/have funHTML5 introduced a file upload api that allows you to monitor the progress of file uploads but for older browsers there's plupload a framework that specifically made to monitor file uploads and give information about them. plus it has plenty of callbacks so it can work across all browsersGears and HTML5 have a progress event in the HttpRequest object for submitting a file upload via AJAX.http://developer.mozilla.org/en/Using_files_from_web_applicationsYour other options as already answered by others are:Technically there is a forth option, similar to YouTube upload, with Gears or HTML5 you can use blobs to split a file into small chunks and individually upload each chunk.  On completion of each chunk you can update the progress status.You would need to use Javascript to create a progress bar. A simple Google search led me to this article: WebAppers Simple Javascript Progress Bar with CSS.Dojo File Upload Progress Bar Widget is another option using the Dojo Javascript framework.EDIT: Assuming your uploading a large number of images (such as a photo album), and POSTing them to your PHP script, you could use javascript to read the results back from the post and update the progress bar based on the number of images uploaded / total number of images. This has the side effect of only updating after each post has completed. Check out here for some info on how to post with JS.A php/ajax progress bar can be done. (Checkout the Html_Ajax library in pear).

However this requires installing a custom module into php.Other methods require using an iframe, through which php looks to see how much of the file has been uploaded. However this hidden iframe, may be blocked by some browsers addons because hidden iframes are often used to send malicious data to a users computer.Your best bet is to use some form of flash progress bar if you do not have control over your server.

PHP + PDO + MySQL: how do I return integer and numeric columns from MySQL as integers and numerics in PHP?

stephenfrank

[PHP + PDO + MySQL: how do I return integer and numeric columns from MySQL as integers and numerics in PHP?](https://stackoverflow.com/questions/20079320/php-pdo-mysql-how-do-i-return-integer-and-numeric-columns-from-mysql-as-int)

I've seen this question repeated a few times on Stack Overflow but none sufficiently explore the problem (or at least in a way that is helpful to me)The problem is that a DB query should return integer data types in PHP for integer columns. Instead the query returns every column as a string type.I've ensured that "PDO::ATTR_STRINGIFY_FETCHES" if false just to make sure results aren't being cast to string.Answers that I've seen:From my research I understand that this is a driver implementation issue.Many sources claim that the MySQL native driver does not support returning numeric types. This doesn't seem true since it works on Mac OS X. Unless they mean to say that "the MySQL native driver on Linux doesn't support the feature".This implies that there is something special about the driver/environment I have installed on Mac OS X. I've been trying to identify the differences in order to apply a fix but I'm limited by my knowledge of how to check these things.Any help and expertise would be appreciated :) I'll definitely be posting back here if I find the answer.

2013-11-19 18:33:34Z

I've seen this question repeated a few times on Stack Overflow but none sufficiently explore the problem (or at least in a way that is helpful to me)The problem is that a DB query should return integer data types in PHP for integer columns. Instead the query returns every column as a string type.I've ensured that "PDO::ATTR_STRINGIFY_FETCHES" if false just to make sure results aren't being cast to string.Answers that I've seen:From my research I understand that this is a driver implementation issue.Many sources claim that the MySQL native driver does not support returning numeric types. This doesn't seem true since it works on Mac OS X. Unless they mean to say that "the MySQL native driver on Linux doesn't support the feature".This implies that there is something special about the driver/environment I have installed on Mac OS X. I've been trying to identify the differences in order to apply a fix but I'm limited by my knowledge of how to check these things.Any help and expertise would be appreciated :) I'll definitely be posting back here if I find the answer.The solution is to ensure that you are using the mysqlnd driver for php.When viewing php -i, there will be no mention of "mysqlnd". The pdo_mysql section will have something like this:Most installation guides for L/A/M/P suggest apt-get install php5-mysql but the native driver for MySQL is installed by a different package: php5-mysqlnd. I found that this was available with the ppa:ondrej/php5-oldstable.To switch to the new driver (on Ubuntu):Now php -i will mention "mysqlnd" explicitly in the pdo_mysql section:Ensure that PDO::ATTR_EMULATE_PREPARES is false (check your defaults or set it):

$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);Ensure that PDO::ATTR_STRINGIFY_FETCHES is false (check your defaults or set it):

$pdo->setAttribute(PDO::ATTR_STRINGIFY_FETCHES, false);† BIGINTs with a value greater than a 64 bit signed int (9223372036854775807) will return as a string (or 32 bits on a 32 bit system)This accepted answer works, and seems to be the most popular answer on Google for this question. My issue is that I need to deploy an application to multiple environments and I don't always have the ability to get the right driver installed, plus I need decimals to be numeric, not strings.  So I created a routine to type case before JSON encoding, which is easily modified to suit.  It's kinda like nuking it from orbit.First, use "show columns from" to get the columns from the table. mysql query "SHOW COLUMNS FROM table like 'colmunname'":questionsThen get the types into an array indexed by the column name to make it easy to iterate over.  Assumes results set from show columns is in a variable named $columns_from_table. http://php.net/manual/en/function.array-column.phpNext we want to remove the parenthetical from the type, which is going to be something like varchar(32) or decimal(14,6)Now we have an associated array with the column name as the index and the formatted type as the value, for example:Now, when you do your select from your table you can iterate over the results and cast the value to the appropriate type:The switch statement can be easily modified to suit, and could include date functions, etc.  For example, in my case a 3rd party is pushing currency values into the database as a decimal, but when I grab that data and need to return it as JSON, I need those to be numbers, not strings.Tested with PHP 7, 7.2 and JQuery 2, 3.

Difference between NULL and null in PHP

cmcculloh

[Difference between NULL and null in PHP](https://stackoverflow.com/questions/8864/difference-between-null-and-null-in-php)

Is there a difference between NULL and null in PHP? Sometimes they seem to be interchangeable and sometimes not.edit: for some reason when I read the documentation linked to in the answer (before posting this question) I read it as "case sensitive" instead of "case insensitive" which was the whole reason I posted this question in the first place...

2008-08-12 14:08:23Z

Is there a difference between NULL and null in PHP? Sometimes they seem to be interchangeable and sometimes not.edit: for some reason when I read the documentation linked to in the answer (before posting this question) I read it as "case sensitive" instead of "case insensitive" which was the whole reason I posted this question in the first place...Null is case insensitive.From the documentation:There is no difference. Same type just its a case insensitive keyword. Same as True/False etc...well there is a technical difference, just not what you're thinking (think: where does it appear in the dictionary): the ASCII value for lowercase null appears after the upper case.  Try: ** actually there is no ASCII value for lower case null while upper case NULL is 0.  lowercase null would be evaluated as a string value which would be greater than 0. The difference between all upper and lower case ASCII values is 32, except here where an entire string value is considered.

PHP max_input_vars

user39653

[PHP max_input_vars](https://stackoverflow.com/questions/10303714/php-max-input-vars)

I'm getting a max_input_vars error message. I understand there's a php.ini setting that can change this starting with version 5.3.9 however, I'm running version 5.1.6. When I view the configuration information for my 5.1.6 server it shows max_input_vars value is 1000. My question is: Even though I'm running 5.1.6, I see this setting from phpinfo() but it's not in the php.ini file. Does this mean that the value is hard coded in this version of PHP and can't be changed?

2012-04-24 18:18:14Z

I'm getting a max_input_vars error message. I understand there's a php.ini setting that can change this starting with version 5.3.9 however, I'm running version 5.1.6. When I view the configuration information for my 5.1.6 server it shows max_input_vars value is 1000. My question is: Even though I'm running 5.1.6, I see this setting from phpinfo() but it's not in the php.ini file. Does this mean that the value is hard coded in this version of PHP and can't be changed?You can add it to php.ini and it should work - just tested it on PHP 5.3.6.Reference on PHP net:http://php.net/manual/en/info.configuration.php#ini.max-input-varsPlease note, you cannot set this directive in run-time with function ini_set(name, newValue), e.g.It will not work.As explained in documentation, this directive may only be set per directory scope, which means via .htaccess file, httpd.conf or .user.ini (since PHP 5.3).See http://php.net/manual/en/configuration.changes.modes.phpAdding the directive into php.ini or placing following lines into .htaccess will work:Have just attempted this fix with 5.3.3 and there's no change. Googling around I found this web page http://anothersysadmin.wordpress.com/2012/02/16/php-5-3-max_input_vars-and-big-forms/ detailing other settings which need changing if your server uses the Suhosin patch which Apache under Debian does.The site explains:I tested it (added settings to php.ini both in /etc/php5/apache2 and /etc/php5/cli, and restarted Apache successfully) but still no max_input_vars variable in phpinfo.A few sites point to PHP 5.3.9 as the first PHP version in which this change will take, so my fault for not RTM properly in the first place, although I'm interested to see people reporting it working in version above 5.3.3 but below 5.3.9.You need to uncomment max_input_vars value in php.ini file and increase it (exp. 2000), also dont forget to restart your server this will help for 99,99%.It's 2018 now.And I just got stuck on this problem when I must send a request that exceeds the max_input_vars. And I came up with a solution that newie like me forgot to restart php fpm service after changing the max_input_vars param. because I only tried to restart apache2 service, but not php fpmHope it helps

Tested on Debian Stretch, php7.0Use of this directive mitigates the possibility of denial of service attacks which use hash collisions. If there are more input variables than specified by this directive, an E_WARNING is issued, and further input variables are truncated from the request.I can suggest not to extend the default value which is 1000 and extend the application functionality by serialising the request or send the request by blocks. Otherwise, you can extend this to configuration needed.It definitely needs to set up in the php.iniNote that you must put this in the file ".user.ini" in Centos7 rather than "php.ini" which used to work in Centos6.  You can put ".user.ini" in any subdirectory in order to affect only that directory..user.ini :Tested on Centos7 and PHP 5.6.33.php_value max_input_vars 6000 "Put this line on .htaccess file of your site. "New Cpanels block to see the .htaccess file or if you add a .user.ini you wont be able to see it. but with a little hack you can make it work. Edit for example wp-config.php and in the URL bar replace wp-config.php by .htaccess 

now you can paste the values and save it. 

enter image description hereJust had the same problem adding menu items to Wordpress. I am using Wordpress 4.9.9 on Ubuntu 18.04, PHP 7.0. I simply uncommented the following line and increased it to 1500 in /etc/php/7.0/apache2/php.iniThen used the following to effect the change:Hope that helps. "PHP message: PHP Warning:  Unknown: Input variables exceeded 1000. To increase the limit change max_input_vars in php.ini.This php configuration parameter max_input_vars will affect not only your GET / POST / COOKIES parameters it also controls your any Form Input.To set or change its value follow the below steps.1) check the existing setting / value by viewing it in your php.ini file

Locate php.ini file by using<?php echo getinfo(); ?>find below key: Loaded Configuration File : /etc/php/5.6/fpm/php.ini 2) Open the php.ini file in editable mode and do search for max_input_vars

    This line may be commented in your existing default setting with default value of 1000 , So remove ; to uncomment it and Edit it with your suitable value e.g. 2500.3) Save the file and Restart the Services of PHP by using below

sudo service php5.6-fpm restartSimilarly you can update any other similar PHP Configuration to your ease.Just to complement. On a shared server using mod_suphp I was having the same issue.Declaring 4 max_input_vars (suhosin included), didn't solved it, it just kept truncating on 1000 vars (default), and declaring "php_value max_input_vars 6000" on .htaccess threw error 500.What solved it was to add the following on .htaccess, which applies the php.ini file recursively to that pathYes, add it to the php.ini, restart apache and it should work.You can test it on the fly if you want to with ini_set("max_input_vars",100)

How to use PHP's password_hash to hash and verify passwords

Josh Potter

[How to use PHP's password_hash to hash and verify passwords](https://stackoverflow.com/questions/30279321/how-to-use-phps-password-hash-to-hash-and-verify-passwords)

Recently I have been trying to implement my own security on a log in script I stumbled upon on the internet. After struggling of trying to learn how to make my own script to generate a salt for each user, I stumbled upon password_hash. From what I understand (based off of the reading on this page), salt is already generated in the row when you use password_hash. Is this true? Another question I had was, wouldn't it be smart to have 2 salts? One directly in the file and one in the DB? That way, if someone compromises your salt in the DB, you still have the one directly in the file? I read on here that storing salts is never a smart idea, but it always confused me what people meant by that. 

2015-05-16 18:32:46Z

Recently I have been trying to implement my own security on a log in script I stumbled upon on the internet. After struggling of trying to learn how to make my own script to generate a salt for each user, I stumbled upon password_hash. From what I understand (based off of the reading on this page), salt is already generated in the row when you use password_hash. Is this true? Another question I had was, wouldn't it be smart to have 2 salts? One directly in the file and one in the DB? That way, if someone compromises your salt in the DB, you still have the one directly in the file? I read on here that storing salts is never a smart idea, but it always confused me what people meant by that. Using password_hash is the recommended way to store passwords. Don't  separate them to DB and files.Let's say we have the following input: I don't validate the input just for the sake of understanding the concept.You first hash the password by doing this:Then see the output:As you can see it's hashed. (I assume you did those steps).Now you store this hashed_password in your database, ensuring your password column is large enough to hold the hashed value. When a user asks to log them in, you check the password input with this hash value in the database, by doing this:Official ReferenceYes you understood it correctly, the function password_hash() will generate a salt on its own, and includes it in the resulting hash-value. Storing the salt in the database is absolutely correct, it does its job even if known.The second salt you mentioned (the one stored in a file), is actually a pepper or a server side key. If you add it before hashing (like the salt), then you add a pepper. There is a better way though, you could first calculate the hash, and afterwards encrypt (two-way) the hash with a server-side key. This gives you the possibility to change the key when necessary.In contrast to the salt, this key should be kept secret. People often mix it up and try to hide the salt, but it is better to let the salt do its job and add the secret with a key.Yes, it's true. Why do you doubt the php faq on the function? :)The result of running password_hash() has has four parts:So as you can see, the hash is a part of it.Sure, you could have an additional salt for an added layer of security, but I honestly think that's overkill in a regular php application. The default bcrypt algorithm is good, and the optional blowfish one is arguably even better.Never use md5() for securing your password, even with salt, it is always dangerous!!Make your password secured with latest hashing algorithms as below.For matching with database's encrypted password and user inputted password use the below function.If you want to use your own salt, use your custom generated function for the same, just follow below, but I not recommend this as It is found deprecated in latest versions of PHP.read this http://php.net/manual/en/function.password-hash.php before use below code.Hope these all helps!!There is a distinct lack of discussion on backwards and forwards compatibility that is built in to PHP's password functions. Notably:Eg:Output:As a final note, given that you can only re-hash a user's password on login you should consider "sunsetting" insecure legacy hashes to protect your users. By this I mean that after a certain grace period you remove all insecure [eg: bare MD5/SHA/otherwise weak] hashes and have your users rely on your application's password reset mechanisms.Class Password full code:I’ve built a function I use all the time for password validation and to create passwords, e.g. to store them in a MySQL database. It uses a randomly generated salt which is way more secure than using a static salt.

phpunit require_once() error

user185305

[phpunit require_once() error](https://stackoverflow.com/questions/1528717/phpunit-require-once-error)

I recently installed phpunit on my server via the pear installer.When I go to run a test I get the following error:After doing some searching, I tried making some modifications to the include_path in my php.ini file on the server. But that hasn't done a thing.Any idea what might be causing this?

2009-10-06 23:43:29Z

I recently installed phpunit on my server via the pear installer.When I go to run a test I get the following error:After doing some searching, I tried making some modifications to the include_path in my php.ini file on the server. But that hasn't done a thing.Any idea what might be causing this?UPDATE: As of 2013 November and Ubuntu 12.04 these 2 commands should suffice:The following is an older answer.

It's a known problem , although almost a year and a half had passed. Read about it here The code coverage must be installed in order for phpunit to work properlyWhat you need to do is covered here:code coverage installation through PEARBasically you have to type (with sudo if you don't have permissions, taken that phpunit is already installed):I had this problem on OS X.  Fixed it with the following commands which force all the php dependencies to be reinstalled, which included a couple of packages from other channels that were not already configured:https://bugs.launchpad.net/ubuntu/+source/phpunit/+bug/701544and specially this comment for ubuntu 11.04 and may be for some others tooeven though i did ths steps as recommended above, i didn't get it to work but after i upgraded pear from 1.9.1 to 1.9.2 it's working perfectly just do thisspeshu@speshu-laptop:~$ sudo pear upgrade pearIf it is the first time you are using PEAR, perhaps you have not configured the include path right. Take a look at the appropriate section in the PEAR manual.https://github.com/sebastianbergmann/php-code-coverageAre you sure you added it to the include_path?It might also help if we saw your ini file, and the include_path snippet in it...I found it!Looks like PEAR installed PHPUnit in /usr/share/pear. Not sure why but that's where it is. Must be a (mt) thing.Anyway, I'm all set. Thanks for the help.This is also what happens if you have an out-of-date or incomplete PHPUnit install. Please be aware that after you set up PEAR, you must add the PHPUnit.de channel in order to get an up-to-date package.In my case, I solved it by adding /usr/share/php/PEAR to the include_path.I'm using Ubuntu 10.04.2.If you have problems with accessing components try another way.I was having the same problem. Netbeans was reporting that the phpunit version was too old (which it wasn't). Running the phpunit script directly showed the above messages.I solved it adding:To /etc/php5/cli/php.iniPlease NOTE that the php.ini file is the one for php CLI (command) not the php.ini used for apache! My original problem was I could not get the command line version of php (yum install php or yum install php-cli) to upgrade to => php5.2.7 I was stuck on 5.1 versionI had already compiled php 5.3.3 for use with apache. So I setup a symbolic link from /usr/bin/php (the command line default) to my compiled version in /var/php5/bin/php to get the command line php reporting 5.3.3Then I refollowed the pear install steps for phpunitBut it still needed the code coverage stuff when I ran phpunit.So I hunted code coverage down under /var/php5/lib/php/PHP/CodeCoverage and added that to the include path in php.ini 

include_path=".:/var/php5/lib/php/"Make sure to add it to the include path without /PHP because phpunit starts at PHP/ (notice caps) looking for Code Coverage

Failed opening required 'PHP/CodeCoverage/Filter.php'I had this problem . I was developing a zend framework site. Finally I manage to solve it by removing the zend installation and removing/commenting the include path in bath php.ini files in apache and cli. To develop site with zend we don't need to have zend installed. Insted we can copy the library to our site folderFor me dividing test's in multiple batches helped.You can solve this issue by redefining the environment variables in PEAR.

This is how I solved the problem and I used Ubuntu 12.10http://rkrants.blogspot.in/2013/01/installing-phpunitpear-in-ubuntu-1210.htmlIn short it defines the paths and then reinstalls phpunitUbuntu 12.04:I had the same issue with Windows 8

Similar to the top answer, I needed to start the command line, however make sure to run  cmd.exe as administrator. Then the two commands

Copy Image from Remote Server Over HTTP

GiladG

[Copy Image from Remote Server Over HTTP](https://stackoverflow.com/questions/909374/copy-image-from-remote-server-over-http)

I am looking for a simple way to import/copy images from remote server to a local folder using PHP.  I have no FTP access to the server, but all remote images can be accessed via HTTP (i.e. http://www.mydomain.com/myimage.jpg).Example use: A user wishes to add an image to his profile.  The image already exists on the web and the user provides with a direct URL.  I do not wish to hotlink the image but to import and serve from my domain.

2009-05-26 07:27:15Z

I am looking for a simple way to import/copy images from remote server to a local folder using PHP.  I have no FTP access to the server, but all remote images can be accessed via HTTP (i.e. http://www.mydomain.com/myimage.jpg).Example use: A user wishes to add an image to his profile.  The image already exists on the web and the user provides with a direct URL.  I do not wish to hotlink the image but to import and serve from my domain.If you have PHP5 and the HTTP stream wrapper enabled on your server, it's incredibly simple to copy it to a local file:This will take care of any pipelining etc. that's needed.  If you need to provide some HTTP parameters there is a third 'stream context' parameter you can provide.usePHP has a built-in function file_get_contents(), which reads the content of a file into a string.

<?php

//Get the file

$content = file_get_contents("http://example.com/image.jpg");//Store in the filesystem.

$fp = fopen("/location/to/save/image.jpg", "w");

fwrite($fp, $content);

fclose($fp);

?>

If you wish to store the file in a database, simply use the $content variable and don't save the file to disk.You've got about these four possibilities:Here's the most basic way:But if you're doing lots and lots of this (or your host blocks file access to remote systems), consider using CURL, which is more efficient, mildly faster and available on more shared hosts. You can also spoof the user agent to look like a desktop rather than a bot!With both instances, you might want to pass it through GD to make sure it really is an image.It's extremely simple using file_get_contents. Just provide the url as the first parameter.make folder and name it foe example download

open note pad and insert this codeonly change http://www.google.com/aa.zip to your file and save it to m.php for examplechamod the php file to 666 and the folder download to 777 finally from your browser enter to these URL

http://www.example.com/download/m.phpyou will see in download folder the file download from other serverthanksUse a GET request to download the image and save it to a web accessible directory on your server.As you are using PHP, you can use curl to download files from the other server.Since you've tagged your question 'php', I'll assume your running php on your server.  Your best bet is if you control your own web server, then compile cURL into php.  This will allow your web server to make requests to other web servers. This can be quite dangerous from a security point of view, so most basic web hosting providers won't have this option enabled. Here's the php man page on using cURL.  In the comments you can find an example which downloads and image file.  If you don't want to use libcurl, you could code something up using fsockopen.  This is built into php (but may be disabled on your host), and can directly read and write to sockets.  See Examples on the fsockopen man page.For those who need to preserve the original filename and extensionThis answer helped to me download image from server to client side.

PHP - Floating Number Precision [duplicate]

dcmoody

[PHP - Floating Number Precision [duplicate]](https://stackoverflow.com/questions/3726721/php-floating-number-precision)

Results in 0.009999999999998What is up with that? I wondered why my program kept reporting odd results.Why doesn't PHP return the expected 0.01?

2010-09-16 12:39:59Z

Results in 0.009999999999998What is up with that? I wondered why my program kept reporting odd results.Why doesn't PHP return the expected 0.01?Because floating point arithmetic != real number arithmetic. An illustration of the difference due to imprecision is, for some floats a and b, (a+b)-b != a. This applies to any language using floats. Since floating point are binary numbers with finite precision, there's a finite amount of representable numbers, which leads accuracy problems and surprises like this. Here's another interesting read: What Every Computer Scientist Should Know About Floating-Point Arithmetic. Back to your problem, basically there is no way to accurately represent 34.99 or 0.01 in binary (just like in decimal, 1/3 = 0.3333...), so approximations are used instead. To get around the problem, you can:It's a pity that PHP doesn't have a decimal datatype like other languages do.Floating point numbers, like all numbers, must be stored in memory as a string of 0's and 1's. It's all bits to the computer. How floating point differs from integer is in how we interpret the 0's and 1's when we want to look at them.One bit is the "sign" (0 = positive, 1 = negative), 8 bits are the exponent (ranging from -128 to +127), 23 bits are the number known as the "mantissa" (fraction). So the binary representation of (S1)(P8)(M23) has the value (-1^S)M*2^PThe "mantissa" takes on a special form. In normal scientific notation we display the "one's place" along with the fraction. For instance:4.39 x 10^2 = 439In binary the "one's place" is a single bit. Since we ignore all the left-most 0's in scientific notation (we ignore any insignificant figures) the first bit is guaranteed to be a 11.101 x 2^3 = 1101 = 13Since we are guaranteed that the first bit will be a 1, we remove this bit when storing the number to save space. So the above number is stored as just 101 (for the mantissa). The leading 1 is assumedAs an example, let's take the binary stringBreaking it into it's components:Applying our simple formula:In other words, 00000010010110000000000000000000 is 27 in floating point (according to IEEE-754 standards).For many numbers there is no exact binary representation, however. Much like how 1/3 = 0.333.... repeating forever, 1/100 is 0.00000010100011110101110000..... with a repeating "10100011110101110000". A 32-bit computer can't store the entire number in floating point, however. So it makes its best guess.(note that negative 7 is produced using 2's complement)It should be immediately clear that 01111100101000111101011100001010 looks nothing like 0.01More importantly, however, this contains a truncated version of a repeating decimal. The original decimal contained a repeating "10100011110101110000". We've simplified this to 01000111101011100001010Translating this floating point number back into decimal via our formula we get 0.0099999979 (note that this is for a 32-bit computer. A 64-bit computer would have much more accuracy)If it helps to understand the problem better, let's look decimal scientific notation when dealing with repeating decimals.Let's assume that we have 10 "boxes" to store digits. Therefore if we wanted to store a number like 1/16 we would write:Which is clearly just 6.25 e -2, where e is shorthand for *10^(. We've allocated 4 boxes for the decimal even though we only needed 2 (padding with zeroes), and we've allocated 2 boxes for signs (one for the sign of the number, one of the sign of the exponent)Using 10 boxes like this we can display numbers ranging from -9.9999 e -9 to +9.9999 e +9This works fine for anything with 4 or fewer decimal places, but what happens when we try to store a number like 2/3?This new number 0.66667 does not exactly equal 2/3. In fact, it's off by 0.000003333.... If we were to try and write 0.66667 in base 3, we would get 0.2000000000012... instead of 0.2This problem may become more apparent if we take something with a larger repeating decimal, like 1/7. This has 6 repeating digits: 0.142857142857...Storing this into our decimal computer we can only show 5 of these digits:This number, 0.14286, is off by .000002857...It's "close to correct", but it's not exactly correct, and so if we tried to write this number in base 7 we would get some hideous number instead of 0.1. In fact, plugging this into Wolfram Alpha we get: .10000022320335...These minor fractional differences should look familiar to your 0.0099999979 (as opposed to 0.01)There's plenty of answers here about why floating point numbers work the way they do...  But there's little talk of arbitrary precision (Pickle mentioned it).  If you want (or need) exact precision, the only way to do it (for rational numbers at least) is to use the BC Math extension (which is really just a BigNum, Arbitrary Precision implementation...To add two numbers:will result in 12345678901235.1234567890...This is called arbitrary precision math.  Basically all numbers are strings which are parsed for every operation and operations are performed on a digit by digit basis (think long division, but done by the library).  So that means it's quite slow (in comparison to regular math constructs).  But it's very powerful.  You can multiply, add, subtract, divide, find modulo and exponentiate any number that has an exact string representation.So you can't do 1/3 with 100% accuracy, since it has a repeating decimal (and hence isn't rational).  But, if you want to know what 1500.0015 squared is:Using 32 bit floats (double precision) gives the estimated result of:But bcmath gives the exact answer of:It all depends on the precision you need.Also, something else to note here.  PHP can only represent either 32 bit or 64 bit integers (depending on your install).  So if an integer exceeds the size of the native int type (2.1 billion for 32bit, 9.2 x10^18, or 9.2 billion billion for signed ints), PHP will convert the int into a float.  While that's not immediately a problem (Since all ints smaller than the precision of the system's float are by definition directly representable as floats), if you try multiplying two together, it'll lose significant precision.For example, given $n = '40000000002':As a number, $n will be float(40000000002), which is fine since it's exactly represented.  But if we square it, we get: float(1.60000000016E+21)As a string (using BC math), $n will be exactly '40000000002'.  And if we square it, we get: string(22) "1600000000160000000004"...So if you need the precision with large numbers, or rational decimal points, you might want to look into bcmath...Use PHP's round() function: http://php.net/manual/en/function.round.phpThis answer solves problem, but not explains why. I thought that it is obvious [I am also programming in C++, so it IS obvious for me ;]], but if not, let's say that PHP has it's own calculating precision and in that particular situation it returned most complying information regarding that calculation.bcadd() might be useful here.(inefficient output for clarity)First line gives me 0.009999999999998.

Second gives me 0.01Because 0.01 can't be represented exactly as sum of series of binary fractions. And that is how floats are stored in memory.I guess it is not what you want to hear, but it is answer to question. For how to fix see other answers.Every number will be save in computer by binary value such as 0, 1. In Single-precision numbers occupy 32 bits.The floating point number can be presented by: 1 bit for sign, 8 bit for exponent and 23 bit called mantissa (fraction).Look the example below: 0.15625  = 0.00101  = 1.01*2^(-3)Another example show always remove the first zero: 0.1 will be presented 1*2^(-1). So the first alwasy be 1.

The present number of 1*2^(-1) will be:Finally: The raw binary is: 

0 01111110 00000000000000000000000Check it here: http://www.binaryconvert.com/result_float.html?decimal=048046053Now if you already understand how a floating point number are saved. What happen if the number cannot save in 32 bit (simple precision). For example: in decimal. 1/3 = 0.3333333333333333333333 and because it is infinite I suppose we have 5 bit to save data. Repeat again this is not real. just suppose. So the data saved in computer will be:Now when the number loaded the computer calculate again: About this:The result is 0.01 ( decimal). Now let show this number in binary.Check here: http://www.binaryconvert.com/result_double.html?decimal=048046048049Because (01011100001010001111) is repeat just like 1/3. So computer cannot save this number in their memory. It must sacrifice. This lead not accuracy in computer.Advanced

( You must have knowledge about mathematics )

So why we can easily show 0.01 in decimal but not in binary. Suppose the fraction in binary of 0.01 (decimal) is finite. wouldn't it be easier to use number_format(0.009999999999998, 2) or $res = $a+$b; -> number_format($res, 2);?

Asynchronous Function Call in PHP

Hardeep Singh

[Asynchronous Function Call in PHP](https://stackoverflow.com/questions/14236296/asynchronous-function-call-in-php)

I am working on an a PHP web application and i need to perform some network operations in the request like fetching someone from remote server based on user's request.Is it possible to simulate asynchronous behavior in PHP given that i have to pass some data to a function and also need output from it.My code is like:Each network operation takes around 5 seconds to complete adding a total of 15 seconds to the response time of my application given i make 3 requests.The  makeNetworkCall() function just do a HTTP POST request.The remote server is an 3rd party API so i don't have any control over there.PS: Please do not answer giving suggestions about AJAX or Other things. I am currently looking if i can do this through PHP may be with an C++ extension or something like that.

2013-01-09 13:27:43Z

I am working on an a PHP web application and i need to perform some network operations in the request like fetching someone from remote server based on user's request.Is it possible to simulate asynchronous behavior in PHP given that i have to pass some data to a function and also need output from it.My code is like:Each network operation takes around 5 seconds to complete adding a total of 15 seconds to the response time of my application given i make 3 requests.The  makeNetworkCall() function just do a HTTP POST request.The remote server is an 3rd party API so i don't have any control over there.PS: Please do not answer giving suggestions about AJAX or Other things. I am currently looking if i can do this through PHP may be with an C++ extension or something like that.Nowadays, it's better to use queues than threads (for those who don't use Laravel there are tons of other implementations out there like this).The basic idea is, your original PHP script puts tasks or jobs into a queue. Then you have queue job workers running elsewhere, taking jobs out of the queue and starts processing them independently of the original PHP.The advantages are:I dont have a direct answer, but you might want to look into these things:cURL is going to be your only real choice here (either that, or using non-blocking sockets and some custom logic).This link should send you in the right direction. There is no asynchronous processing in PHP, but if you're trying to make multiple simultaneous web requests, cURL multi will take care of that for you.I think if the HTML and other UI stuff needs the data returned then there is not going to be a way to async it. I believe the only way to do this in PHP would be to log a request in a database and have a cron check every minute, or use something like Gearman queue processing, or maybe exec() a command line processIn the meantime you php page would have to generate some html or js that makes it reload every few seconds to check on progress, not ideal.To sidestep the issue, how many different requests are you expecting? Could you download them all automatically every hour or so and save to a database?There is also http v2 which is a wrapper for curl. Can be installed via pecl. http://devel-m6w6.rhcloud.com/mdref/http/I think some code about the cURL solution is needed here, so I will share mine (it was written mixing several sources as the PHP Manual and comments).It does some parallel HTTP requests (domains in $aURLs) and print the responses once each one is completed (and stored them in $done for other possible uses).The code is longer than needed because the realtime print part and the excess of comments, but feel free to edit the answer to improve it:

PHP 7 interfaces, return type hinting and self

GordonM

[PHP 7 interfaces, return type hinting and self](https://stackoverflow.com/questions/39068983/php-7-interfaces-return-type-hinting-and-self)

UPDATE: PHP 7.4 now does support covariance and contravariance which addresses the major issue raised in this question.  I have run into something of an issue with using return type hinting in PHP 7.  My understanding is that hinting : self means that you intend for an implementing class to return itself.  Therefore I used : self in my interfaces to indicate that, but when I tried to actually implement the interface I got compatibility errors.  The following is a simple demonstration of the issue I've run into: The expected output was: What I actually get is: The thing is Foo is an implementation of iFoo, so as far as I can tell the implementation should be perfectly compatible with the given interface.  I could presumably fix this issue by changing either the interface or the implementing class (or both) to return hint the interface by name instead of using self, but my understanding is that semantically self means "return the instance of the class you just called the method on".  Therefore changing it to the interface would mean in theory that I could return any instance of something that implements the interface when my intent is for the invoked instance is what will be returned.  Is this an oversight in PHP or is this a deliberate design decision?  If it's the former is there any chance of seeing it fixed in PHP 7.1?  If not then what is the correct way of return hinting that your interface expects you to return the instance you just called the method on for chaining?  

2016-08-21 21:21:01Z

UPDATE: PHP 7.4 now does support covariance and contravariance which addresses the major issue raised in this question.  I have run into something of an issue with using return type hinting in PHP 7.  My understanding is that hinting : self means that you intend for an implementing class to return itself.  Therefore I used : self in my interfaces to indicate that, but when I tried to actually implement the interface I got compatibility errors.  The following is a simple demonstration of the issue I've run into: The expected output was: What I actually get is: The thing is Foo is an implementation of iFoo, so as far as I can tell the implementation should be perfectly compatible with the given interface.  I could presumably fix this issue by changing either the interface or the implementing class (or both) to return hint the interface by name instead of using self, but my understanding is that semantically self means "return the instance of the class you just called the method on".  Therefore changing it to the interface would mean in theory that I could return any instance of something that implements the interface when my intent is for the invoked instance is what will be returned.  Is this an oversight in PHP or is this a deliberate design decision?  If it's the former is there any chance of seeing it fixed in PHP 7.1?  If not then what is the correct way of return hinting that your interface expects you to return the instance you just called the method on for chaining?  self does not refer to the instance, it refers to the current class. There is no way for an interface to specify that the same instance must be returned - using self in the manner you're attempting would only enforce that the returned instance be of the same class.That said, return type declarations in PHP must be invariant while what you're attempting is covariant.Your use of self is equivalent to:which is not allowed.The Return Type Declarations RFC has this to say:For the time being at least the best you can do is:It also can be a solution, that you don't define explicitly the return type in the Interface, only in the PHPDoc and then you can define the certain return type in the implementations:This looks like the expected behavior to me.Just change your Foo::bar method to return iFoo instead of self and be done with it.Explanation:self as used in the interface means "an object of type iFoo."

self as used in the implementation means "an object of type Foo."Therefore, the return types in the interface and the implementation are clearly not the same.One of the comments mentions Java and whether you would have this issue.  The answer is yes, you would have the same issue if Java allowed you to write code like that -- which it doesn't. Since Java requires you to use the name of the type instead of PHP's self shortcut, you are never going to actually see this. (See here for a discussion of a similar issue in Java.)In case, when You want to force from interface, that method will return object, but type of object won't be the type of interface, but the class itself, then You can write it this way:It's working since PHP 7.4.

CloudFlare and logging visitor IP addresses via in PHP

tfont

[CloudFlare and logging visitor IP addresses via in PHP](https://stackoverflow.com/questions/14985518/cloudflare-and-logging-visitor-ip-addresses-via-in-php)

I'm trying to track and log users/visitors that are accessing my website using PHP's $_SERVER['REMOTE_ADDR'] to do so. A typical method for IP address tracking in PHP.However, I am using CloudFlare for caching and such and receiving their IP addresses as CloudFlare's:What would be a correct method of retrieving the actual users/visitors IP address while still using CloudFlare?

2013-02-20 16:56:52Z

I'm trying to track and log users/visitors that are accessing my website using PHP's $_SERVER['REMOTE_ADDR'] to do so. A typical method for IP address tracking in PHP.However, I am using CloudFlare for caching and such and receiving their IP addresses as CloudFlare's:What would be a correct method of retrieving the actual users/visitors IP address while still using CloudFlare?Extra server variables that are available to cloud flare are:$_SERVER["HTTP_CF_CONNECTING_IP"] real visitor ip address, this is what you want$_SERVER["HTTP_CF_IPCOUNTRY"] country of visitor$_SERVER["HTTP_CF_RAY"]$_SERVER["HTTP_CF_VISITOR"] this can help you know if its http or httpsyou can use it like this:If you do this, and the validity of the visiting IP address is important, you might need to verify that the $_SERVER["REMOTE_ADDR"] contains an actual valid cloudflare IP address, because anyone can fake the header if he was able to connect directly to the server IP.Update: CloudFlare has released a module mod_cloudflare for apache, the module will log and display the actual visitor IP Addresses rather than those accessed by cloudflare! https://www.cloudflare.com/resources-downloads#mod_cloudflare (Answer by: olimortimer)If you dont have access to the apache runtime you can use the script below, this will allow you to check if the connection was through cloudflare and get the users ip.I am rewriting my answer i used for another question "CloudFlare DNS / direct IP identifier"Cloudflare's ips are stored in public so you can go view them here then check if the ip is from cloudflare (this will allow us to get the real ip from the http header HTTP_CF_CONNECTING_IP).If you are using this to disable all non cf connections or vice versa, i recommend you to have a single php script file that gets called before every other script such as a common.php or pagestart.php etc.To use the script it's quite simple:This script will show you the real ip address and if the request is CF or not!Since this question was asked and answered, CloudFlare has released mod_cloudflare for Apache, which logs & displays the actual visitor IP address rather than the CloudFlare address:https://www.cloudflare.com/resources-downloads#mod_cloudflareCloudflare sends some additional request headers to your server including CF-Connecting-IP which we can store into $user_ip, if defined, using this simple one-liner:It would be hard to convert HTTP_CF_CONNECTING_IP to REMOTE_ADDR. So you can use apache (.htaccess) auto prepending to do that. So that you do not need to think about whether the $_SERVER['REMOTE_ADDR'] has the correct value in all the PHP scripts..htaccess codephp code (file.php)Learn More hereHTTP_CF_CONNECTING_IP is only working if you are using cloudflare maybe you transfer your site or remove cloudflare you will forget the value so use this code .For magento 1.x users (I haven't try magento 2.0 yet), check https://tall-paul.co.uk/2012/03/13/magento-show-remote-ip-in-cloudflare-the-right-way/ which needs to change app/etc/local.xml and add:

           HTTP_CF_CONNECTING_IP

When you are using CloudFlare all your requests between your server and users are routed through CloudFlare servers.In this case there are two methods to get User's Real IP Address:You can use the following code to get user's IP Address:$user_ip = (isset($_SERVER["HTTP_CF_CONNECTING_IP"]) $_SERVER["HTTP_CF_CONNECTING_IP"]:$_SERVER['REMOTE_ADDR']);CloudFlare adds some extra server variables in the request as follows:$_SERVER["HTTP_CF_CONNECTING_IP"] - Real IP Address of user$_SERVER["HTTP_CF_IPCOUNTRY"] - ISO2 Country of the User$_SERVER["HTTP_CF_RAY"] A Special string for loggin purposeIn the above code, we are checking if $_SERVER["HTTP_CF_CONNECTING_IP"] is set or not. If it is there we will consider that as user's IP Address else we will use the default code as $_SERVER['REMOTE_ADDR']

Installing PHPUnit via PEAR

Ondrej Slinták

[Installing PHPUnit via PEAR](https://stackoverflow.com/questions/2006626/installing-phpunit-via-pear)

I have problems installing PHPUnit 3.4.6 via PEAR 1.9.0. After I discover channel pear.phpunit.de and try to use one of following commands:it fails, giving me following error:I found several threads from people with the same problem, but upgrading PEAR to the newest version usually worked for them. Also there seems to be close to no tutorials for installing PHPUnit for Windows.EDIT:I've also tried to change prefered_state to beta; didn't help.I've also tried to get list of all available packages:It gives me another error:

2010-01-05 14:31:07Z

I have problems installing PHPUnit 3.4.6 via PEAR 1.9.0. After I discover channel pear.phpunit.de and try to use one of following commands:it fails, giving me following error:I found several threads from people with the same problem, but upgrading PEAR to the newest version usually worked for them. Also there seems to be close to no tutorials for installing PHPUnit for Windows.EDIT:I've also tried to change prefered_state to beta; didn't help.I've also tried to get list of all available packages:It gives me another error:I had the same problem yesterday, and solved it by updating the channelsbefore trying to install phpUnit.Hope this helps.I had the same problem, try:It simply installs me when I type:Maybe there is a problem with the versions, you may set the preferred_state of the pear packages to different than stable:Please follow these steps:I had the same problem. this worked for me:What is the full error message output?  It failed for me until I installed using the --alldeps option and ran pear channel-discover pear.symfony-project.comSince 2014-12-31 PEAR Installer was no longer the only installation method for PHPUnit

See here : https://github.com/sebastianbergmann/phpunit/wiki/End-of-Life-for-PEAR-Installation-MethodI triedas suggested by Davide above, but that gave me the error For some reason, it worked when I ranYou need to also discover the ezcomponents channel using pear channel-discover components.ez.noIn total:You can have a quick sanity check is to run phpunit from the CLI and see if the command is recognized.UPDATESeems they've moved symfony, I just did a fresh install today, here's the new channelI have same problem with phpunit instalation. Try using Synaptic package manager for PHPUnit instalation.I had struggled for ages with getting ZEND etc to work on XAMPP on Windows Vista. For reference, this is how I solved it: -Couldn't update PEAR then I realised it's default path setting were wrong, I correct this guide...http://david-franklin.net/programming/installing-pear-phpunit-on-windows/Then I managed to get PHPUNIT installed with the pear clear_cache command thanks to this thread then ran "pear install phpunit/PHPunit".I hope what I wrote above will serve as a quick code for those in a similar predicament (it took me 2 whole days to get it working!!!)I had an issue with not having a required dependency YAML, so got a warning each time. Try

 pear channel-discover pear.symfony.com

   pear install pear.symfony.com/Yamlthen run the download againFirst off all xampp should be installed to C:\xamppOpen a command prompt and go to C:\xampp\phpType the following commands in to the cmdpear update-channels" (updates channel definitions)pear upgrade (upgrades all existing packages and pear)pear channel-discover components.ez.no (this is needed for PHPUnit)pear channel-discover pear.symfony-project.com (also needed by PHPUnit)pear channel-discover pear.phpunit.de (This IS phpunit)pear install --alldeps phpunit/PHPUnit (installs PHPUnit and all dependencies)

How to document magic (_call and _callStatic) methods for IDEs

Rob Forrest

[How to document magic (_call and _callStatic) methods for IDEs](https://stackoverflow.com/questions/15634021/how-to-document-magic-call-and-callstatic-methods-for-ides)

After many happy years coding in notepad++ and sublime, I've been advised to give a PHP IDE a go. I'm trying out phpStorm and it seems nice.  The code completion and documentation is a great feature but isn't working out for me when magic methods are used. Is there a work around to get phpStorm to understand what's going on in magic methods?Our situation is something like this:The magic callStatic method allows us to get a collection of objects via 1 or more arguments that make up the function call.I see that there is an @method statement for use in these cases but phpStorm is only picking up the first of these statements. Furthermore I can only set the return type to mixed where as I'd prefer to be able to set it as whatever class this was called on (b in my example).Any ideas or suggestions would be very gratefully received, thanks.

2013-03-26 09:54:59Z

After many happy years coding in notepad++ and sublime, I've been advised to give a PHP IDE a go. I'm trying out phpStorm and it seems nice.  The code completion and documentation is a great feature but isn't working out for me when magic methods are used. Is there a work around to get phpStorm to understand what's going on in magic methods?Our situation is something like this:The magic callStatic method allows us to get a collection of objects via 1 or more arguments that make up the function call.I see that there is an @method statement for use in these cases but phpStorm is only picking up the first of these statements. Furthermore I can only set the return type to mixed where as I'd prefer to be able to set it as whatever class this was called on (b in my example).Any ideas or suggestions would be very gratefully received, thanks.Use class-level PHPDoc comment -- specifically @method tag -- works fine in PhpStorm:In the above:More about @method:  P.S.

While @method static works fine in PhpStorm (tells IDE that method is static) it may not be (yet?) supported by actual phpDocumentor tool (sorry, have not used it for a while).Alternatively: (in PhpStorm, of course) Settings | Inspections | PHP | Undefined | Undefined method --> Downgrade severity if __magic methods are present in class -- it will not help with code completion for such methods in any way, but will not mark those magic methods as "undefined method" errors.phpDocumentor's ticket regarding using RegEx/partial names for @property/@method tags (how it can be useful for documentation and how little help it may bring to the actual IDE when dealing with code completion): Somewhat related to original question:You can also define this in phpstorm meta file. Here's an example for factory method (v2016.3):This way you don't have to docblock every possibility when magic happens.Have some docs for details.

Best way to manage long-running php script?

kbanman

[Best way to manage long-running php script?](https://stackoverflow.com/questions/2212635/best-way-to-manage-long-running-php-script)

I have a PHP script that takes a long time (5-30 minutes) to complete. Just in case it matters, the script is using curl to scrape data from another server. This is the reason it's taking so long; it has to wait for each page to load before processing it and moving to the next.I want to be able to initiate the script and let it be until it's done, which will set a flag in a database table.What I need to know is how to be able to end the http request before the script is finished running. Also, is a php script the best way to do this?

2010-02-06 09:16:59Z

I have a PHP script that takes a long time (5-30 minutes) to complete. Just in case it matters, the script is using curl to scrape data from another server. This is the reason it's taking so long; it has to wait for each page to load before processing it and moving to the next.I want to be able to initiate the script and let it be until it's done, which will set a flag in a database table.What I need to know is how to be able to end the http request before the script is finished running. Also, is a php script the best way to do this?Certainly it can be done with PHP, however you should NOT do this as a background task - the new process has to be dissocated from the process group where it is initiated.Since people keep giving the same wrong answer to this FAQ, I've written a fuller answer here:http://symcbean.blogspot.com/2010/02/php-and-long-running-processes.htmlFrom the comments: The quick and dirty way would be to use the ignore_user_abort function in php. This basically says: Don't care what the user does, run this script until it is finished. This is somewhat dangerous if it is a public facing site (because it is possible, that you end up having 20++ versions of the script running at the same time if it is initiated 20 times).The "clean" way (at least IMHO) is to set a flag (in the db for example) when you want to initiate the process and run a cronjob every hour (or so) to check if that flag is set. If it IS set, the long running script starts, if it is NOT set, nothin happens.You could use exec or system to start a background job, and then do the work in that. Also, there are better approaches to scraping the web that the one you're using. You could use a threaded approach (multiple threads doing one page at a time), or one using an eventloop (one thread doing multiple pages at at time). My personal approach using Perl would be using AnyEvent::HTTP.ETA: symcbean explained how to detach the background process properly here.No, PHP is not the best solution.I'm not sure about Ruby or Perl, but with Python you could rewrite your page scraper to be multi-threaded and it would probably run at least 20x faster.  Writing multi-threaded apps can be somewhat of a challenge, but the very first Python app I wrote was mutlti-threaded page scraper. And you could simply call the Python script from within your PHP page by using one of the shell execution functions.Yes, you can do it in PHP. But in addition to PHP it would be wise to use a Queue Manager. Here's the strategy:Using this strategy has the following advantages:You have a variety of options (this is just a few):PHP may or may not be the best tool, but you know how to use it, and the rest of your application is written using it.  These two qualities, combined with the fact that PHP is "good enough" make a pretty strong case for using it, instead of Perl, Ruby, or Python.If your goal is to learn another language, then pick one and use it.  Any language you mentioned will do the job, no problem.  I happen to like Perl, but what you like may be different.Symcbean has some good advice about how to manage background processes at his link.In short, write a CLI PHP script to handle the long bits.  Make sure that it reports status in some way.  Make a php page to handle status updates, either using AJAX or traditional methods.  Your kickoff script will the start the process running in its own session, and return confirmation that the process is going. Good luck.I agree with the answers that say this should be run in a background process.  But it's also important that you report on the status so the user knows that the work is being done.  When receiving the PHP request to kick off the process, you could store in a database a representation of the task with a unique identifier.  Then, start the screen-scraping process, passing it the unique identifier.  Report back to the iPhone app that the task has been started and that it should check a specified URL, containing the new task ID, to get the latest status.  The iPhone application can now poll (or even "long poll") this URL.  In the meantime, the background process would update the database representation of the task as it worked with a completion percentage, current step, or whatever other status indicators you'd like.  And when it has finished, it would set a completed flag.You can send it as an XHR (Ajax) request. Clients don't usually have any timeout for XHRs, unlike normal HTTP requests.I realize this is a quite old question but would like to give it a shot. This script tries to address both the initial kick off call to finish quickly and chop down the heavy load into smaller chunks. I haven't tested this solution.I would like to propose a solution that is a little different from symcbean's, mainly because I have additional requirement that the long running process need to be run as another user, and not as apache / www-data user.First solution using cron to poll a background task table:Second solution using Linux inotify facility:Some additional info could be found in my post : http://inventorsparadox.blogspot.co.id/2016/01/long-running-process-in-linux-using-php.htmlI have done similar things with Perl, double fork() and detaching from parent process. All http fetching work should be done in forked process.Use a proxy to delegate the request. what I ALWAYS use is one of these variants (because different flavors of Linux have different rules about handling output/some programs output differently):Variant I

    @exec('./myscript.php \1>/dev/null \2>/dev/null &');Variant II

    @exec('php -f myscript.php \1>/dev/null \2>/dev/null &');Variant III

    @exec('nohup myscript.php \1>/dev/null \2>/dev/null &');You might havet install "nohup".  But for example, when I was automating FFMPEG video converstions, the output interface somehow wasn't 100% handled by redirecting output streams 1 & 2, so I used nohup AND redirected the output.if you have long script then divide page work with the help of input parameter for each task.(then each page act like thread)

i.e if page has 1 lac product_keywords long process loop then instead of loop make logic for one keyword and pass this keyword from magic or cornjobpage.php(in following example)and for background worker i think you should try this technique it will help to call as many as pages you like all pages will run at once independently without waiting for each page response as asynchronous.cornjobpage.php //mainpagetestpage.phpPS:if you want to send url parameters as loop then follow this answer :https://stackoverflow.com/a/41225209/6295712Not the best approach, as many stated here, but this might help:If the desired output of your script is some processing, not a webpage, then I believe the desired solution is to run your script from shell, simply as php my_script.php

PHP buffer ob_flush() vs. flush()

