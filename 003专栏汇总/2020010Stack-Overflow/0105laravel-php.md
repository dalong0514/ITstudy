How Do I Get the Query Builder to Output Its Raw SQL Query as a String?

meiryo

[How Do I Get the Query Builder to Output Its Raw SQL Query as a String?](https://stackoverflow.com/questions/18236294/how-do-i-get-the-query-builder-to-output-its-raw-sql-query-as-a-string)

Given the following code:I want to get the raw SQL query string that the database query builder above will generate. In this example, it would be SELECT * FROM users.How do I do this?

2013-08-14 15:43:54Z

Given the following code:I want to get the raw SQL query string that the database query builder above will generate. In this example, it would be SELECT * FROM users.How do I do this?To output to the screen the last queries ran you can use this:I believe the most recent queries will be at the bottom of the array.You will have something like that:(Thanks to Joshua's comment below.)Use the toSql() method on a QueryBuilder instance.DB::table('users')->toSql() would return:This is easier than wiring up an event listener, and also lets you check what the query will actually look like at any point while you're building it.DB::QueryLog() only work after you execute the query $builder->get(). if you want to get the query before execute the query you can use $builder->toSql() method. this is the example how to get the sql and bind it:OR just make your query error like calling for unexist table or column, u will see the generated query in exception XDYou can listen to the 'illuminate.query' event. Before the query add the following event listener:This will print out something like:If you are trying to get the Log using Illuminate without Laravel use:You could also nock up a quick function like so:EDITupdated versions seem to have query logging disabled by default (the above returns an empty array). To turn back on, when initialising the Capsule Manager, grab an instance of the connection and call the enableQueryLog methodEDIT AGAINTaking the actual question into consideration, you could actually do the following to convert the current single query instead of all previous queries:There is a method in eloquent for getting query string. toSql()in our case,returnis the exact solution that return the SQL query string..Hope this helpful...If you use laravel 5.1 and MySQL you can use this function made by me:As an input parameter you can use either of theseFirst You will need to enable the query log by calling:after queries using the DB facade you can write:the output will like below:This is the far best solution I can suggest to any one for debug-ing eloquent last query or final query  although this has been discussed as well:Simply you can do following stuff using toSql() method,If it's not working you can set-up the thing from laravel documentation.Another way to do it isDB::getQueryLog()but if it's returns an empty array then by default it's disabled visit this,just enable with DB::enableQueryLog() and it will work :)for more info visit Github Issue to know more about it.Hope it helps :)A 'macroable' replacement to get the SQL query with the bindings.E.g. Eloquent Builder (Laravel 5.1 - 5.3)use debugbar package From laravel 5.2 and onward. you can use DB::listen to get executed queries.Or if you want to debug a single Builder instance then you can use toSql method.The most easiest way is to make deliberate mistake. For example, I want to see the full SQL query of the following relation:I just to make a column to be not found, here I choose created_at and I changed it to created_ats by adding trailing s to be:So, the debuger will return the following error:The above error message returns the full SQL query with the mistakeNow, just remove the extra s from created_at and test this SQL as you like in any SQL editor such as phpMyAdmin SQL editor!This is the function, I placed in my base model class. Simply pass the query builder object into it and the SQL string will be returned.For laravel 5.5.XIf you would like to receive each SQL query executed by your application, you may use the listen method. This method is useful for logging queries or debugging. You may register your query listener in a service provider:SourceAs of Laravel 5.8.15 the query builder now has dd and dump methods so you can doAdd this function to your application and simply call.Output: "select * from user where lang = 'en' and status = '1' order by updated_at desc limit 25 offset 0"Print last queryIn my opinion, this will be the best approach as a beginner:This is also depicted here.

https://stackoverflow.com/a/59207557/9573341You can use this package for get all the queries which are executing when you load your pageIf you are not using Laravel but using Eloquent package then:

you can use clockworkbut works also in firefoxI've created some simple functions to get the SQL and bindings from some queries.Usage:As much as I love this framework, I hate when it acts like crap.DB::enableQueryLog() is totally useless. DB::listen is equally useless. It showed part of the query when I said $query->count(), but if I do $query->get(), it has nothing to say.The only solution that appears to work consistently is to intentionally put some syntax or other error in the ORM parameters, like an nonexistent column/table name, run your code on the command line while in debug mode, and it will spit out the SQL error with the full frickin' query finally. Otherwise, hopefully the error appears in the log file if ran from the web server.Try this:Note: get() has been replaced with toSql() to display the raw SQL query.If you are using tinker and want to log the SQL query formed you can doMy way of doing this, based on the log view, only needs to modify the file app/Providers/AppServiceProvider.php:

No Application Encryption Key Has Been Specified

Carlos F

[No Application Encryption Key Has Been Specified](https://stackoverflow.com/questions/44839648/no-application-encryption-key-has-been-specified)

I'm new to Laravel and I'm trying to use the Artisan command...It displays...However, it won't automatically launch and when I manually enter http://127.0.0.1:8000 it shows this error:Any ideas? I'm using Laravel framework 5.5-dev.

2017-06-30 06:06:47Z

I'm new to Laravel and I'm trying to use the Artisan command...It displays...However, it won't automatically launch and when I manually enter http://127.0.0.1:8000 it shows this error:Any ideas? I'm using Laravel framework 5.5-dev.From Encryption - Laravel - The PHP Framework For Web Artisans:I found that using this complex internet query in google.com: "laravel add encrption key" (Yes, it worked even with the typo!)In my case, I also needed to reset the cached config files:Open command prompt in the root folder of your project and run below command:It will generate Application Key for your application.You can find the generated application key(APP_KEY) in .env file.Simply run this command: cp .env.example .env if there is no .env file present.

php artisan key:generate command works for me. It generates the encryption keyI actually had to add a .env file to my project and then copy the contents of .env.example so that the key:generate would work. Not sure why a .env file was not created when I started the project.worked for me, but it had to be done in a command prompt on Windows.Doing it inside the terminal in PHPStorm didn't worked.A common issue you might experience when working on a Laravel application is the exception:You'll often run into this when you pull down an existing Laravel application, where you copy the .env.example file to .env but don't set a value for the APP_KEY variable.At the command line, issue the following Artisan command to generate a key:This will generate a random key for APP_KEY, After completion of .env edit please enter this command in your terminal for clear cache:php artisan config:cacheAlso, If you are using the PHP's default web server (eg. php artisan serve) you need to restart the server changing your .env file values. now you will not get to see this error message.Follow this steps:Okay, I'll write another instruction, because didn't find the clear answer here. So if you faced such problems, follow this:That's it.You can generate Application Encryption Key using this command:Then, create a cache file for faster configuration loading using this command:Or, serve the application on the PHP development server using this command:That's it!If you git clone some project then this kind of issue may usually occur.Open command prompt in the root folder of your project and run Then and ThenIf you're getting the same error after having key-value, then just copy the APP_KEY value from .env file and paste it to config/app.php with 'key' => 'YOUR KEY',and then again runI ran into this issue when I manually copied the contents of my Laravel project (say sites/oldname) into a new directory on my Mac (say, sites/newname).  Since I was manually dragging and droppping, it didn't grab the hidden files, namely, '.env'.

When I looked more closely at sites/oldname I saw .editorconfig, .env, .env.example, .gitatrributes, .styleci.yml, etc.The error went away once I copied the hidden files to the new directory.So, "No Application Encryption Key Has Been Specified" is Laravel speak for "your .env file is missing."I had to restart my queue worker using php artisan queue:restart after running php artisan key:generate to get jobs working.simply runits worked for meIn my case, while cloning the project from git there was no .envfile. So I copy the .env file from the source project and paste in my current project and change its configuration of database and it run successfully. 

Laravel Checking If a Record Exists

Ben

[Laravel Checking If a Record Exists](https://stackoverflow.com/questions/27095090/laravel-checking-if-a-record-exists)

I am new to Laravel. Please excuse the newbie question but how do I find if a record exists?What can I do here to see if $user has a record?

2014-11-23 22:24:42Z

I am new to Laravel. Please excuse the newbie question but how do I find if a record exists?What can I do here to see if $user has a record?It depends if you want to work with the user afterwards or only check if one exists.If you want to use the user object if it exists:And if you only want to checkOr even nicerOne of the best solution is to use the firstOrNew or firstOrCreate method. The documentation has more details on both.Eloquent uses collections. 

See the following link: https://laravel.com/docs/5.4/eloquent-collectionsUse first(), not count() if you only need to check for existence.first() is faster because it checks for a single match whereas count() counts all matches.Laravel 5.6.26v to find the existing record through primary key ( email or id ) then include " use DB " and table name user become plural using the above query like user to usersThis will check if requested email exist in the user table:In your Controller In your View - Display Already Exist Message would work with try/catch ->get() would still return an empty arrayIn laravel eloquent, has default exists() method, refer followed example.if(User::where('id', $user_id )->exists()){

 // your code...

}It's simple to get to know if there are any records or not you can use laravel validation .But this code is also good:This will check if particular email address exist in the table:Checking for null within if statement prevents Laravel from returning 404 immediately after the query is over.It seems like it runs double query if the user is found, but I can't seem to find any other reliable solution.can be written as This will return true or false without assigning a temporary variable if that is all you are using $user for in the original statement.I think below way is the simplest way to achieving same :Created below method (for myself) to check if the given record id exists on Db table or not.Home It helps!The Easiest Way to do Laravel 6 or on the top: Write the table name, then give where clause condition for instance where('id', $request->id)The efficient way to check if the record exists you must use is_null method to check against the query.The code below might be helpful:Shortest working options:here is a link to something l think can assist

https://laraveldaily.com/dont-check-record-exists-methods-orcreate-ornew/this is simple code to check email is exist or not in database

How to Set Variables in a Laravel Blade Template

duality_

[How to Set Variables in a Laravel Blade Template](https://stackoverflow.com/questions/13002626/how-to-set-variables-in-a-laravel-blade-template)

I'm reading the Laravel Blade documentation and I can't figure out how to assign variables inside a template for use later. I can't do {{ $old_section = "whatever" }} because that will echo "whatever" and I don't want that.I understand that I can do <?php $old_section = "whatever"; ?>, but that's not elegant.Is there a better, elegant way to do that in a Blade template?

2012-10-21 22:02:08Z

I'm reading the Laravel Blade documentation and I can't figure out how to assign variables inside a template for use later. I can't do {{ $old_section = "whatever" }} because that will echo "whatever" and I don't want that.I understand that I can do <?php $old_section = "whatever"; ?>, but that's not elegant.Is there a better, elegant way to do that in a Blade template?It is discouraged to do in a view so there is no blade tag for it.

If you do want to do this in your blade view, you can either just open a php tag as you wrote it or register a new blade tag. Just an example:LARAVEL 5.5 AND UPThe @php blade directive no longer accepts inline tags. Instead, use the full form of the directive:LARAVEL 5.2 AND UPYou can just use:Or you can use it in a block statement:LARAVEL 5Extend Blade like this:Then do one of the following:Quick solution: If you are lazy, just put the code in the boot() function of the AppServiceProvider.php.Nicer solution:

Create an own service provider. See https://stackoverflow.com/a/28641054/2169147 on how to extend blade in Laravel 5. It's a bit more work this way, but a good exercise on how to use Providers :)LARAVEL 4You can just put the above code on the bottom of app/start/global.php (or any other place if you feel that is better).After the above changes, you can use:to define a variable.In laravel-4, you can use the template comment syntax to define/set variables.Comment syntax is  {{-- anything here is comment --}} and it is rendered by blade engine as<?php /* anything here is comment */ ?>so with little trick we can use it to define variables, for examplewill be rendered by bladeas 

    <?php /* */$i=0;/* */ ?> which sets the variable for us. 

Without changing any line of code.There is a simple workaround that doesn't require you to change any code, and it works in Laravel 4 just as well.You just use an assignment operator (=) in the expression passed to an @if statement, instead of (for instance) an operator such as ==.Then you can use it anywhere you can use any other variableThe only downside is your assignment will look like a mistake to someone not aware that you're doing this as a workaround.Ya'll are making it too complicated. Just use plain php donesies.(or https://github.com/alexdover/blade-set looks pretty straighforward too)We're all kinda "hacking" the system by setting variables in views, so why make the "hack" more complicated then it needs to be?Tested in Laravel 4.Another benefit is that syntax highlighting works properly (I was using comment hack before and it was awful to read)You Can Set Variables In The Blade Templating Engine The Following Ways:

1. General PHP Block

Setting Variable: <?php $hello = "Hello World!"; ?>

Output: {{$hello}}

2. Blade PHP Block

Setting Variable: @php $hello = "Hello World!"; @endphp

Output: {{$hello}}Since Laravel 5.2.23, you have the @php Blade directive, which you can use inline or as block statement:orYou can set a variable in the view file, but it will be printed just as you set it. Anyway, there is a workaround. You can set the variable inside an unused section. Example:Then {{ $yourVar }} will print Your value anywhere you want it to, but you don't get the output when you save the variable.EDIT: naming the section is required otherwise an exception will be thrown.In Laravel 4:If you wanted the variable accessible in all your views, not just your template, View::share is a great method (more info on this blog).Just add the following in app/controllers/BaseController.phpand now $myvar will be available to all your views -- including your template. I used this to set environment specific asset URLs for my images.And suddenly nothing will appear.

From my experience, if you have to do something like this prepare the html in a model's method or do some reorganizing of your code in to arrays or something.  There is never just 1 way.I'm going to extend the answer given by @Pim.Add this to the boot method of your AppServiceProviderThis way you don't expose the ability to write any php expression.You can use this directive like:In Laravel 5.1, 5.2:https://laravel.com/docs/5.2/views#sharing-data-with-all-viewsEdit file: /app/Providers/AppServiceProvider.phpYou may use the package I have published: https://github.com/sineld/bladesetThen you easily set your variable:As for my elegant way is like the followingAnd just echo your $old_section variable.I don't think that you can - but then again, this kind of logic should probably be handled in your controller and passed into the view already set.If you have PHP 7.0:The simple and most effective way is with assignment inside brackets.The rule is simple: Do you use your variable more than once? Then declare it the first time it's used within brackets, keep calm and carry on.And yes, I know about @forelse, this is just a demo.Since your variables are now declared as and when they are used, there is no need for any blade workarounds.Assign variable to the blade template, Here are the solutionsWe can use <?php ?> tag in blade pageORWe can use the blade comment with special syntax Hacking comments is not a very readable way to do it. Also editors will color it as a comment and someone may miss it when looking through the code.Try something like this:It will compile into:...and do the assignment and not echo anything.It's better to practice to define variable in Controller and then pass to view using compact() or ->with() method.Otherwise #TLGreg gave best answer.There is a very good extention for Blade radic/blade-extensions. After you add it you can use @set(variable_name, variable_value)laravel 5 you can easily do this . see below I was looking for a way to assign a value to a key and use it many times in my view. For this case, you can use @section{"key", "value"} in the first place and then call @yield{"key"} to output the value in other places in your view or its child.In my opinion it would be better to keep the logic in the controller and pass it to the view to use. This can be done one of two ways using the 'View::make' method. I am currently using Laravel 3 but I am pretty sure that it is the same way in Laravel 4.orThe 'with' method is chainable. You would then use the above like so:More information here:http://three.laravel.com/docs/viewshttp://codehappy.daylerees.com/using-controllersI had a similar question and found what I think to be the correct solution with View ComposersView Composers allow you to set variables every time a certain view is called, and they can be specific views, or entire view templates. Anyway, I know it's not a direct answer to the question (and 2 years too late) but it seems like a more graceful solution than setting variables within a view with blade.works in all versions of blade.You can extend blade by using the extend method as shown below..after that initialize variables as follows.In laravel document https://laravel.com/docs/5.8/blade#php

You can do this way:

Laravel - Eloquent or Fluent random row

DigitalWM

[Laravel - Eloquent or Fluent random row](https://stackoverflow.com/questions/13917558/laravel-eloquent-or-fluent-random-row)

How can I select a random row using Eloquent or Fluent in Laravel framework?I know that by using SQL, you can do order by RAND(). However, I would like to get the random row without doing a count on the number of records prior to the initial query.Any ideas?

2012-12-17 15:59:25Z

How can I select a random row using Eloquent or Fluent in Laravel framework?I know that by using SQL, you can do order by RAND(). However, I would like to get the random row without doing a count on the number of records prior to the initial query.Any ideas?Laravel >= 5.2:oror to get the Specific number of recordsLaravel 4.2.7 - 5.1:Laravel 4.0 - 4.2.6:Laravel 3:Check this article on MySQL random rows. Laravel 5.2 supports this, for older version, there is no better solution then using RAW Queries.edit 1: As mentioned by Double Gras, orderBy() doesn't allow anything else then ASC or DESC since this change. I updated my answer accordingly.edit 2: Laravel 5.2 finally implements a wrapper function for this. It's called inRandomOrder().This works just fine,you can also change argument in random function to get more than one record.Note: not recommended if you have huge data as this will fetch all rows first and then returns random value.tl;dr: It's nowadays implemented into Laravel, see "edit 3" below.Sadly, as of today there are some caveats with the ->orderBy(DB::raw('RAND()')) proposed solution:

edit: Now you can use the orderByRaw() method: ->orderByRaw('RAND()'). However this is still not DB-agnostic.FWIW, CodeIgniter implements a special RANDOM sorting direction, which is replaced with the correct grammar when building query. Also it seems to be fairly easy to implement. Looks like we have a candidate for improving Laravel :)update: here is the issue about this on GitHub, and my pending pull request.

edit 2: Let's cut the chase. Since Laravel 5.1.18 you can add macros to the query builder:Usage:

edit 3: Finally! Since Laravel 5.2.33 (changelog, PR #13642) you can use the native method inRandomOrder():In Laravel 4 and 5 the order_by is replaced by orderBySo, it should be:You can use:You can also use order_by method with fluent and eloquent like as:This is a little bit weird usage, but works.Edit: As @Alex said, this usage is cleaner and also works:For Laravel 5.2 >=use the Eloquent method:     The inRandomOrder method may be used to sort the query results randomly. For example, you may use this method to fetch a random user:from docs: https://laravel.com/docs/5.2/queries#ordering-grouping-limit-and-offsetUse Laravel function  At your model add this:then at route/controllerThere is also whereRaw('RAND()') which does the same, you can then chain ->get() or ->first() or even go crazy and add ->paginate(int).You can easily Use this command:// Question : name of Model

// take 10 rows from DB In shuffle records...I prefer to specify first or fail:Laravel has a built-in method to shuffle the order of the results.Here is a quote from the documentation:The shuffle method randomly shuffles the items in the collection:You can see the documentation here.I have table with thousands of records, so I need something fast. This is my code for pseudo random row:

Laravel 5 – Remove Public from URL

user1537360

[Laravel 5 – Remove Public from URL](https://stackoverflow.com/questions/28364496/laravel-5-remove-public-from-url)

I know this is a very popular question but I haven't been able to find a working solution for Laravel 5. I've been trying to migrate from Codeigniter for a long time, but this convoluted installation process keeps putting me off.I don't want to run a VM, this just seems awkward when switching between projects.I don't want to set my document root to the public folder, this is also awkward when switching between projects.I've tried the .htaccess mod_rewrite methodThis just gives me a Laravel NotFoundHttpException in compiled.php line 7610.When I tried L4 a while ago, I used the method of moving the contents of the public folder into the root. The structure of L5 is quite different and following the same steps completely broke Laravel (the server would only return a blank page).Is there a decent method of removing 'public' in a development environment that:Thanks** I'm using MAMP and PHP 5.6.2

2015-02-06 11:13:39Z

I know this is a very popular question but I haven't been able to find a working solution for Laravel 5. I've been trying to migrate from Codeigniter for a long time, but this convoluted installation process keeps putting me off.I don't want to run a VM, this just seems awkward when switching between projects.I don't want to set my document root to the public folder, this is also awkward when switching between projects.I've tried the .htaccess mod_rewrite methodThis just gives me a Laravel NotFoundHttpException in compiled.php line 7610.When I tried L4 a while ago, I used the method of moving the contents of the public folder into the root. The structure of L5 is quite different and following the same steps completely broke Laravel (the server would only return a blank page).Is there a decent method of removing 'public' in a development environment that:Thanks** I'm using MAMP and PHP 5.6.2That's it!I have solved the issue using 2 answers:In Laravel 5.5 create .htacess file in your root directory and placed the following code:- Reference LinkYOU REALLY SHOULD NOT rename server.php in your Laravel root folder to index.php

and copy the .htaccess file from the /public directory to your Laravel root folder!!!This way everyone can access some of your files (.env for example). Try it yourself. You don't want that!Instead, you should create an .htaccess file in your root like this:This will silently rewrite all your base URIs to the /public folder. Even all Headers, for example the HTTP Authorization Header, and all optional URI parameters will silently be passed on to the /public folder as well.That's allEasy way to remove public from laravel 5 url.

You just need to cut index.php and .htaccess from public directory and paste it in the root directory,thats all

and replace two lines in index.php asNote: The above method is just for the beginners as they might be facing problem in setting up virtual host and The best solution is to setup virtual host on local machine and point it to the public directory of the project.@rimon.ekjon said:That's working for me.

But all resource files in /public directory couldn't find and request urls didn't work, because I used asset() helper.I changed /Illuminate/Foundation/helpers.php/asset() function as follows:Now everything works :)Thank you @rimon.ekjon and all of you.Just create .htaccess file at root and add these lines to itThat's it!The above code works on the root public_html folder. Having said that your core laravel file should be inside the public_html folder, if your directory looks like public_html/laravelapp/public and if you put the above code inside laravelapp it won't work. Therefore you must copy all your core files into public_html and put the .htaccess file there .If you want to keep the code in a subdirectory then you can create a subdomain then this code will work for that also.Create .htaccess file in root directory and place code something like below.1) I haven't found a working method for moving the public directory in L5.  While you can modify some things in the bootstrap index.php, it appears several helper functions are based on the assumption of that public directory being there.  In all honestly you really shouldn't be moving the public directory.2) If your using MAMP then you should be creating new vhosts for each project, each serving that projects public directory.  Once created you access each project by your defined server name like this :It's possible to remove public url in laravel5. Follow these steps:step 1.copy all file from public and paste on root directorystep 2.open index.php file

   replace withto and to And remove all cache and cookies.Let's say you placed all the other files and directories in a folder named 'locale'.Just go to index.php and find these two lines:and change them to this:BEST Approach:

I will not recommend removing public, instead on local computer create a virtual host point to public directory and on remote hosting change public to public_html and point your domain to this directory. Reason, your whole laravel code will be secure because its one level down to your public directory :) I just rename server.php to index.php and it worksThis work well for all laravel version...Here is my Directory Structure,Follow these easy stepsto  andtotoand that's it, now try http:// localhost/laravel/Here is the Best and shortest solution that works for me as of may, 2018

for Laravel 5.5I would like to add to @Humble Learner and note that the proper location to "fix" the url path for assets is /Illuminate/Routing/UrlGenerator.php/asset().Update the method to match:This will fix scripts, styles and image paths. Anything for asset paths. 4 best ways to remove public from the URL.If you used any other trick to remove the public from the URL like changes the name of server.php to index.php and changing into the core file path. Clearly, don't do that. Then why Laravel not giving the solution like this because it's not a proper way to do that.By adding a .htaccess file into the root, You can access the website without publicI am giving demo here for the Window operating system. But I will try to define a step so that anyone can easily follow the step. You can also research on google for the same for the particular operating system.Step 1: Go to C:\Windows\system32\drivers\etc\ open the "hosts" file in Administrator mode.Step 2: Add the following code to it. Here, I am giving you a demo of projectname.local domain name demo, you can specify any as you like. Just make it constant at every place.Step 3: Now go to, C:\xampp\apache\conf\extra for xampp users and for the wamp user "C:\wamp\bin\apache\Apache2.4.4\conf\extra" and open "httpd-vhosts.conf" file. Now add the following code into it.Notes: Change the Document root as per your project also add domain name as you define into the "hosts" file.Step 4: Last but the important step is to restart your Xampp or Wamp and access the url like http://projectname.local and your Laravel will respond without public URL.If you are working in local then you don't need to do anything just need to run the following command from your terminal or command line tool. After that, you can access your website by provided URL by the command line.If you are willing to run your project on particular IP then you need to run following command. If you are working on LAN then if you want to allow other people to access your website from local then you just need to check your IP address using command line by running "ipconfig" after getting your IP address run following the command.If you are willing to run your project on a particular IP with particular port then you need to the following command.After completion of the project you need to host the project on the server, then you just need to set the document root on your domain to the public folder. Check the below screenshot.As per screenshot if you don't have any project folder into the public_html then you just need to set your document root like "public_html/public".For XAMPP user to remove public from url without touching laravel default filesystem is to set a Virtual Host for your application to do this jsut follow these steps127.0.0.1       localhostThe original article can be found hereThere is always a reason to have a public folder in the Laravel setup, all public related stuffs should be present inside the public folder, Just write rewrite condition in the .htaccess file and install rewrite module and enable the rewrite module, the problem which adds public in the route will get solved.After having installed Laravel for the first time, I faced the renowned "public folder problem" and I came up with this solution that, in my personal opinion, is "cleaner" then the others I found on the Web.Everything can be done just editing the .htaccess using mod_rewrite and four simple rules.I commented everything, so it should be clear (I hope) also to those who have never used mod_rewrite (not that I'm an expert, all the opposite). Also, to understand the rules, it must be clear that, in Laravel, if Bill connects to https://example.com, https://example.com/index.php is loaded. This file just contains the command header("refresh: 5; https://example.com/public/"), which sends the request to https://example.com/public/index.php. This second index.php is responsible to load the controller and other stuff.The following rule (originally in public/.htaccess) can be deleted. The same rule, in fact, is explicited in a more detailed way in the last two rules.EDIT: I missed Abhinav Saraswat's solution and his answer should be the accepted one. Just one, simple and clear rule that redirects all the traffic to the public folder without modifying any file.Firstly you can use this stepssource: https://stackoverflow.com/a/28735930after you follow these steps then you need to change all css and script path, but this will be tiring.Solution Proposal :simply you can make minor change the helpers::asset function.For this:Activate the mod_rewrite module withand restart the apacheTo use mod_rewrite from within .htaccess files (which is a very common use case), edit the default VirtualHost withBelow "DocumentRoot /var/www/html" add the following lines:Restart the server again:I know that are are a lot of solution for this issue. The best and the easiest solution is to add .htaccess file in the root directory.I tried the answers that we provided for this issue however I faced some issues with auth:api guard in Laravel.Here's the updated solution:Create the .htaccess file in your root directory and add this code. And everything goes rightI have read some article before and it's working fine but really don't know is safe or notEdit the index.phptoEven if i do not recommend putting Laravel on the root folder there are some cases when it could not be avoided;

for those cases the above methods do not work for assets so i made a quick fix changing the htaccess:

after copying server.php to index.php edit the .htaccess file like so:This was a quick fix i had to make so anyone is welcome to upgrade it.Problem is if you type /public and it will still be available in the url, therefor i created a fix which should be placed in the public/index.phpthis peace of code will remove public from the url and will give a 404 and then redirects to the url without the publicAnother method that I use is to create a symbolic link (in Linux, don't know about Win) using the ln command in htdocs or www i.e. ln projectname/public project

The site is thus accessible via localhost/projectYou can remove public keyword from url using various methods.1) If you are using dedicated hosting and you have root access then You can remove public keyword from url using Virtual Host. You should give DocumentRoot path with public. So this will start index from public directory and remove it from url.2) If you dont have root access of your hosting then you should genarate a new .htaccess file in your root directory and put the code as belowYou can get more reference here.I found the most working solution to this problem. Just edit your .htaccess in the root folder and write the following code. Nothing else requiredi have try some solution here and found htaccess that work for laravel 5.2, like this :when you have another file or folder to forbidden just add You don't need to do much, just create a .htaccess file on the root directory and paste/save the below;Please add these line into your root htaccess folder, which does the job

Differences and Similarities Between Lumen and Laravel

Ranjit Karki

[Differences and Similarities Between Lumen and Laravel](https://stackoverflow.com/questions/29647960/differences-and-similarities-between-lumen-and-laravel)

I read the documentation and it seems Lumen is Laravel with less features. I must be missing something.

I am looking for a comparison table of the components and features of both Laravel and Lumen. Does anyone know the differences?

2015-04-15 10:35:56Z

I read the documentation and it seems Lumen is Laravel with less features. I must be missing something.

I am looking for a comparison table of the components and features of both Laravel and Lumen. Does anyone know the differences?With the latest version of Lumen (5.2) the Microframework focuses on Stateless APIs.

The documentation states:Lumen is all about speed. It's faster and can handle more requests per second than Laravel.Laravel is a framework that glues together a lot of components (3rd party and Laravels own components). Now Lumen makes use of a lot of the same components, but strips down the bootstrapping process to a minimum. You could say it is a "different glue", the components (and therefore a lot of the features) are mostly the same.The performance improvement is achieved by taking away some of the flexibility of the framework in terms of configuration and altering the default boot process.  Besides that, more features are disabled by default and have to be activated before they can be used. As an example: Facades (like DB::table())

You first need to uncomment this line in bootstrap/app.php to enable them:The same goes for Dotenv environment files and Eloquent.For routing Lumen uses nikic/FastRoute instead of symfonys router because it performs a lot better and gives the micro-framework another big boost.Other than that pretty much everything is the same as in Laravel.Good reads on LumenLumen is not designed to replace Laravel, rather, it is a more specialized (and stripped-down) framework designed for micro-services and APIs. It took away unneeded features for an API such as HTTP sessions and cookies, and also limited the number of configuration options. Out-of-the-box, Lumen sacrified the flexibility of Laravel for speed.However, you can add Laravel components to Lumen to extend it, so it can be used for more than just micro-services and API. However, if your goal is to extend Lumen to become a website, you might as well use Laravel instead.They also have different use cases. Lumen and Laravel are meant to work together. For APIs and services are frequently get called, use Lumen. For user-facing applications, use Laravel.This answer is taken from a blog post I wrote that explains the difference between Lumen and Laravel.Quote from Matt Stauffer You can read more hereLumen microframework is a lightweight version of Laravel full-stack framework. Lumen use the Laravel syntax and components, and can be 'upgrade' easily to Laravel.Lumen is a more specialized (and stripped-down) framework designed for Microservices development and API development. So, some of the features in Laravel such as HTTP sessions, cookies, and templating are not needed and Lumen takes them away, keeping what's essential - routing, logging, caching, queues, validation, error handling and a couple of others.Why Lumen ? Lumen is a framework to build APIs, which will essentially serve JSON responses for your requests. That's it.These kinds of applications are known as web services in general. As of Lumen 5.2 update, it doesn't support laravel views, sessions etc... for that you will have to upgrade to full laravel framework.Some components of the Laravel framework is swapped with other packages in favour of performance. check them here Example scenarios where we can consider LumenThe main difference between laravel and lumen is, Laravel can have artisan commands, which lumen doesn't have.

Disable Laravel's Eloquent timestamps

projectxmatt

[Disable Laravel's Eloquent timestamps](https://stackoverflow.com/questions/19937565/disable-laravels-eloquent-timestamps)

I'm in the process of converting one of our web applications from CodeIgniter to Laravel. However at this moment we don't want to add the updated_at / created_at fields to all of our tables as we have a logging class that does all this in more depth for us already. I'm aware I can set $timestamps = false; in:However I'd rather not change a core file for Laravel, or have everyone of my models have that at the top. Is there any way to disable this elsewhere for all models?

2013-11-12 18:54:09Z

I'm in the process of converting one of our web applications from CodeIgniter to Laravel. However at this moment we don't want to add the updated_at / created_at fields to all of our tables as we have a logging class that does all this in more depth for us already. I'm aware I can set $timestamps = false; in:However I'd rather not change a core file for Laravel, or have everyone of my models have that at the top. Is there any way to disable this elsewhere for all models?You either have to declare public $timestamps = false; in every model, or create a BaseModel, define it there, and have all your models extend it instead of eloquent.  Just bare in mind pivot tables MUST have timestamps if you're using Eloquent.Update: Note that timestamps are no longer REQUIRED in pivot tables after Laravel v3.Update: You can also disable timestamps by removing $table->timestamps() from your migration.Simply add this line to your Model:public $timestamps = false;Example:If you only need to only to disable updating updated_at just add this method to your model.This will override the parent setUpdatedAtAttribute() method. created_at will work as usual.

Same way you can write a method to disable updating created_at only.If you are using 5.5.x:And for 'created_at' field, you can use:Make sure you are on the newest version.

(This was broken in Laravel 5.5.0 and fixed again in 5.5.5).Eloquent Model:Or Simply try thisIn case you want to remove timestamps from existing model, as mentioned before, place this in your Model:Also create a migration with following code in the up() method and run it:You can use $table->timestamps() in your down() method to allow rolling back.just declare the public timestamps variable in your Model to false and everything will work great.public $timestamps = false;

 Add this line into your model:Override the functions setUpdatedAt() and getUpdatedAtColumn() in your modelYou can temporarily disable timestamps

Laravel: Get base url

Inigo

[Laravel: Get base url](https://stackoverflow.com/questions/23059918/laravel-get-base-url)

Simple question, but the answer seems quite hard to come by. In Codeigniter, I could load the url helper and then simply doto get my site's URL. Is there an equivalent in Laravel?

2014-04-14 12:19:23Z

Simple question, but the answer seems quite hard to come by. In Codeigniter, I could load the url helper and then simply doto get my site's URL. Is there an equivalent in Laravel?You can use the URL facade which lets you do calls to the URL generatorSo you can do:You can also use the application container:Or inject the UrlGenerator:Laravel < 5.2Laravel >= 5.2Hope this helps youFor Laravel 5 I normally use:I'm of the understanding that using the url() function is calling the same Facade as URL::to() Updates from 2018 Laravel release(5.7) documentation with some more url() functions and it's usage.1. Accessing The Base URL2. Accessing The Current URL3. URLs For Named Routes4. URLs To Assets(Public)5. File URLsEach of these methods may also be accessed via the URL facade:How to  call these Helper functions from blade Template(Views) with usage.To get it to work with non-pretty URLs I had to do:Laravel provides bunch of helper functions and for your requirement you can simply use url() function of Laravel Helpers but in case of Laravel 5.2 you will have to use url('/')here is the list of all other helper functions of LaravelThis:And this:both displayed the home url in my case :)Another possibility: {{ URL::route('index') }}You can also use URL::to('/') to display image in Laravel. Please see below:Assume that, your image is stored under "public/images".I used this and it worked for me in Laravel 5.3.18:IMPORTANT NOTE: This will only work when you have already removed "public" from your URL. To do this, you may check out this helpful tutorial.By the way, if your route has a name like:You can use the route() function like this:Other useful functions:https://github.com/laravel/framework/blob/5.4/src/Illuminate/Foundation/helpers.phpTo just get the app url, that you configured you can use :You can use facades or helper function as per following.Check this -This is working for me and I hope it will work for you.I found an other way to just get the base url to to display the value of environment variable APP_URLwhich will display the base url like http://domains_your//yours_website. beware it assumes that you had set the environment variable in .env file (that is present in the root folder).you can get it from Request, at laravel 5

What are the Differences Between「php artisan dump-autoload」and「composer dump-autoload」?

Naing Lin Aung

[What are the Differences Between「php artisan dump-autoload」and「composer dump-autoload」?](https://stackoverflow.com/questions/20274082/what-are-the-differences-between-php-artisan-dump-autoload-and-composer-dump)

I am pretty new to Laravel 4 and Composer. While I do Laravel 4 tutorials, I couldn't understand the difference between those two commands; php artisan dump-autoload and composer dump-autoload What's the difference between them? 

2013-11-28 20:10:21Z

I am pretty new to Laravel 4 and Composer. While I do Laravel 4 tutorials, I couldn't understand the difference between those two commands; php artisan dump-autoload and composer dump-autoload What's the difference between them? Laravel's Autoload is a bit different:1) It will in fact use Composer for some stuff2) It will call Composer with the optimize flag3) It will 'recompile' loads of files creating the huge bootstrap/compiled.php4) And also will find all of your Workbench packages and composer dump-autoload them, one by one.php artisan dump-autoload was deprecated on Laravel 5, so you need to use composer dump-autoload

How to Get the Query Executed in Laravel 5? DB::getQueryLog() Returning Empty Array

Arsen

[How to Get the Query Executed in Laravel 5? DB::getQueryLog() Returning Empty Array](https://stackoverflow.com/questions/27753868/how-to-get-the-query-executed-in-laravel-5-dbgetquerylog-returning-empty-ar)

I'm trying to view the log for a query, but DB::getQueryLog() is just returning an empty array:ResultHow can I view the log for this query?

2015-01-03 10:30:06Z

I'm trying to view the log for a query, but DB::getQueryLog() is just returning an empty array:ResultHow can I view the log for this query?By default, the query log is disabled in Laravel 5:

https://github.com/laravel/framework/commit/e0abfe5c49d225567cb4dfd56df9ef05cc297448You will need to enable the query log by calling:or register an event listener:If you have more than one DB connection you must specify which connection to logTo enables query log for my_connection:To get query log for my_connection:For an HTTP request lifecycle, you can enable query log in the handle method of some BeforeAnyDbQueryMiddleware middleware and then retrieve the executed queries in the terminate method of the same middleware.A middleware's chain will not run for artisan commands, so for CLI execution you can enable query log in the artisan.start event listener.For example you can put it in the bootstrap/app.php fileLaravel keeps all queries in memory. So in some cases, such as when inserting a large number of rows, or having a long running job with a lot of queries, this can cause the application to use excess memory. In most cases you will need the query log only for debugging, and if that is the case I would recommend you enable it only for development.ReferencesIf all you really care about is the actual query (the last one run) for quick debugging purposes:do a print_r() on $laQuery[0] to get the full query, including the bindings. (the $lcWhatYouWant variable above will have the variables replaced with ??)If you're using something other than the main mysql connection, you'll need to use these instead:(with your connection name where "mysql2" is)Put this on routes.php file:Submitted by msurguy, source code in this page. You will find this fix-code for laravel 5.2 in comments.You need to first enable query loggingThen you can get query logs by simply:It would be better if you enable query logging before application starts, which you can do in a BeforeMiddleware and then retrieve the executed queries in AfterMiddleware. Apparently with Laravel 5.2, the closure in DB::listen only receives a single parameter.So, if you want to use DB::listen in Laravel 5.2, you should do something like:For laravel 5.8 you just add dd or dump.Ex:orreference:

https://laravel.com/docs/5.8/queries#debuggingUse toSql() instead of get() like so:(Laravel 5.2) I find the simplest way is just to add one code line to monitor the sql queries:In continuing of the Apparently with Laravel 5.2, the closure in DB::listen only receives a single parameter... response above : you can put this code into the Middleware script and use it in the routes.Additionally:This code is for:Here is the code, which is based on @milz 's answer:The core is the if(stripos... line, which prevents the recursion of inserting the insert into log sql statement into database.I think the answer located in this article:

https://arjunphp.com/laravel-5-5-log-eloquent-queries/is fast and simple to achieve query logging. You just have to add to the AppServiceProvider in the boot method a callback to listen to DB queries:Suppose you want to print the SQL query of the following statements.You just need to do as follows:This will print the last executed query in Laravel.For laravel 5 and onwards using only DB::getQueryLog() , will not do.

BY default in this the value of change it to in the below file for logging query.And then we can use the DB::getQueryLog() where you want to print the query.

Doing HTTP requests FROM Laravel to an external API

Chilion

[Doing HTTP requests FROM Laravel to an external API](https://stackoverflow.com/questions/22355828/doing-http-requests-from-laravel-to-an-external-api)

What I want is get an object from an API with a HTTP (eg, jQuery's AJAX) request to an external api. How do I start? I did research on Mr Google but I can't find anything helping.Im starting to wonder is this is even possible?

In this post Laravel 4 make post request from controller to external url with data it looks like it can be done. But there's no example nor any source where to find some documentation.Please help me out?

2014-03-12 15:14:20Z

What I want is get an object from an API with a HTTP (eg, jQuery's AJAX) request to an external api. How do I start? I did research on Mr Google but I can't find anything helping.Im starting to wonder is this is even possible?

In this post Laravel 4 make post request from controller to external url with data it looks like it can be done. But there's no example nor any source where to find some documentation.Please help me out?Based upon an answer of a similar question here:

https://stackoverflow.com/a/22695523/1412268Take a look at GuzzleWe can use package Guzzle in Laravel, it is a PHP HTTP client to send HTTP requests.You can install Guzzle through composerOr you can specify Guzzle as a dependency in your project's existing composer.jsonExample code in laravel 5 using Guzzle as shown below,You just want to call an external URL and use the results? PHP does this out of the box, if we're talking about a simple GET request to something serving JSON:If you want to do a post request, it's a little harder but there's loads of examples how to do this with curl. So I guess the question is; what exactly do you want?Updated on March 21 2019Add GuzzleHttp package using composer require guzzlehttp/guzzle:~6.3.3Or you can specify Guzzle as a dependency in your project's composer.jsonInclude below line in the top of the class where you are calling the APIAdd below code for making the request Definitively, for any PHP project, you may want to use GuzzleHTTP for sending requests.

Guzzle has very nice documentation you can check here.

I just want to say that, you probably want to centralize the usage of the Client class of Guzzle in any component of your Laravel project (for example a trait) instead of being creating Client instances on several controllers and components of Laravel (as many articles and replies suggest).I created a trait you can try to use, which allows you to send requests from any component of your Laravel project, just using it and calling to makeRequest.Notice this trait can even handle files sending.If you want more details about this trait and some other stuff to integrate this trait to Laravel, check this article. Additionally, if interested in this topic or need major assistance, you can take my course which guides you in the whole process.I hope it helps all of you.Best wishes :)You can use Httpful :Website : http://phphttpclient.com/Github : https://github.com/nategood/httpful

What does「Mass Assignment」mean in Laravel?

Chen-Tsu Lin

[What does「Mass Assignment」mean in Laravel?](https://stackoverflow.com/questions/22279435/what-does-mass-assignment-mean-in-laravel)

When I went through Laravel Document about Eloquent ORM topic part, I got a new term Mass Assignment.Document show How to do Mass Assignment and the fillable or guarded properties settings. But after went through that, I didn't have a clearly understand about Mass Assignment and how it works.In my past experience in CodeIgniter, I also didn't hear about this term.Does anyone have a simple explanation about that?

2014-03-09 07:14:28Z

When I went through Laravel Document about Eloquent ORM topic part, I got a new term Mass Assignment.Document show How to do Mass Assignment and the fillable or guarded properties settings. But after went through that, I didn't have a clearly understand about Mass Assignment and how it works.In my past experience in CodeIgniter, I also didn't hear about this term.Does anyone have a simple explanation about that?Mass assignment is when you send an array to the model creation, basically setting a bunch of fields on the model in a single go, rather than one by one, something like:(This is instead of explicitly setting each value on the model separately.) You can use fillable to protect which fields you want this to actually allow for updating.You can also block all fields from being mass-assignable by doing this:Let's say in your user table you have a field that is user_type and that can have values of user / adminObviously, you don't want users to be able to update this value. In theory, if you used the above code, someone could inject into a form a new field for user_type and send 'admin' along with the other form data, and easily switch their account to an admin account... bad news.By adding:You are ensuring that only those values can be updated using mass assignmentTo be able to update the user_type value, you need to explicitly set it on the model and save it, like this:Mass assignment is a process of sending an array of data that will be saved to the specified model at once. In general, you don’t need to save data on your model on one by one basis, but rather in a single process.Mass assignment is good, but there are certain security problems behind it. What if someone passes a value to the model and without protection they can definitely modify all fields including the ID. That’s not good.Let's say you have 'students' table, with fields "student_type, first_name, last_name」. You may want to mass assign "first_name, last_name" but you want to protect student_type from being directly changed. That’s where fillable and guarded take place.Fillable lets you specify which fields are mass-assignable in your model, you can do it by adding the special variable $fillable to the model. So in the model:the 'student_type' are not included, which means they are exempted.Guarded is the reverse of fillable. If fillable specifies which fields to be mass assigned, guarded specifies which fields are not mass assignable. So in the model:you should use either $fillable or $guarded - not both.For more details open link:- Mass AssignmentMass assignment means you are filling a row with more than one column using an array of data. (somewhat of a shortcut instead of manually building the array) using Input::all(). Technically just from the top of my head. Fillable means what columns in the table are allowed to be inserted, guarded means the model can't insert to that particular column.Notice that when you try to do a mass assignment with like, insert to a column named "secret", and you have specified that it is guarded, you can try to insert to it via the model, but it will never really get inserted into the database. This is for security, and protection on your table when using the model. Mass assignment seems to be just a notice or warning that you didn't tell the model which are fillable and guarded and makes it vulnerable to some kind of attacks.UPDATEFor Laravel 5.x+ you can refer to the latest doc mass assignmentORA well detailed explanation on when to use fillable or guardedThis is when an array of data received is saved at once in a model.Because of the security issues with this method in laravel, it's recommended you define the fields you wish the requested data to populate on the Model.You can use the $fillable variable to define the fields you want to populate on the database table.E.gWhen laravel detects you are mass assigning data, it forces you to define the fields you want to mass assign in the model class.Someone can easily pass unwanted data into an html form to your database.

Bulk Insertion in Laravel using eloquent ORM

phoenixwizard

[Bulk Insertion in Laravel using eloquent ORM](https://stackoverflow.com/questions/12702812/bulk-insertion-in-laravel-using-eloquent-orm)

How can we perform bulk database insertions in Laravel using Eloquent ORM?I want to accomplish this in Laravel: https://stackoverflow.com/a/10615821/600516

but I am getting the following error.

2012-10-03 06:16:16Z

How can we perform bulk database insertions in Laravel using Eloquent ORM?I want to accomplish this in Laravel: https://stackoverflow.com/a/10615821/600516

but I am getting the following error.You can just use Eloquent::insert().For example:We can update GTF answer to update timestamps easilyUpdate:

to simplify the date we can use carbon as @Pedro Moreira suggested UPDATE2: for laravel 5 , use updated_at instead of modified_atTo whoever is reading this, check out createMany() method.This is how you do it in more Eloquent way, I searched many times for it, finally used custom timestamps like below:Eloquent::insert is the proper solution but it wont update the timestamps, so you can do something like belowThe idea is to add created_at and updated_at on whole array before doing insertFrom Laravel 5.7 with Illuminate\Database\Query\Builder you can use insertUsing method.UserSubscription is my model name.

This will return "true" if insert successfully else "false".Maybe a more Laravel way to solve this problem is to use a collection and loop it inserting with the model taking advantage of the timestamps.EDIT:Sorry for my misunderstanding. For bulk inserting this could help and maybe with this you can make good seeders and optimize them a bit.For category relations insertion I came across the same problem and had no idea, except that in my eloquent model I used Self() to have an instance of the same class in foreach to record multiple saves and grabing ids.without "$obj = new Self()" it only saves single record (when $obj was $this)Problem solved... Alter table for migrateSolution:

PHP Composer update「cannot allocate memory」error (using Laravel 4)

ericbae

[PHP Composer update「cannot allocate memory」error (using Laravel 4)](https://stackoverflow.com/questions/18116261/php-composer-update-cannot-allocate-memory-error-using-laravel-4)

I just can't solve this one.I'm on Linode 1G RAM basic plan. Trying to install a package via Composer and it's not letting me. My memory limit is set to "-1" on PHP.iniIs there anything else I can do to get this installed?

2013-08-08 00:58:48Z

I just can't solve this one.I'm on Linode 1G RAM basic plan. Trying to install a package via Composer and it's not letting me. My memory limit is set to "-1" on PHP.iniIs there anything else I can do to get this installed?A bit old but just in case someone new is looking for a solution, updating your PHP version can fix the issue.Also you should be committing your composer.lock file and doing a composer install on a production environment which is less resource intensive.More details here:

https://github.com/composer/composer/issues/1898#issuecomment-23453850Looks like you runs out of swap memory,

try thisas mentioned by @BlackBurn027 on comments below, this solution was described in hereAs composer troubleshooting guide here

This could be happening because the VPS runs out of memory and has no Swap space enabled.To enable the swap you can use for example:I have faced the same issue. I am on a AWS Free Microinstance which has less memory. I always try one of the below options and it always works (Before all this please check if you have the latest version of composer installed)or remove the contents of the vendor folder and try composer update.The second option tries to update all the components, if there is no update, it picks up the package from the cache else picks up from the distNote: Please change the memory limit as per your choice.or Create a swap partition and try. Swap partition is the portion of the hard drive that linux uses as virtual memory when it runs out of physical memory. It's similar to the windows swap file only instead of using an actual file, linux uses a partition on the hard drive instead.Hope this helpsEasy, type this commands:rm -rf vendor/rm -rf composer.lockphp composer install --prefer-distShould work for low memory machinesI had a same issue on vagrant. I fixed it by allcate more memory.Here are the steps to fix the problem:

(instant fast SWAP file allocation method used)Server SWAP Setup (Ubuntu 16.04 SWAP to Fix Out of Memory Errors)Check if you have swap already, memory and disk size:Make swap file: (change 1G to 4G if you want 4GB SWAP memory)Check swap file:Assign Swap File:Check if swap OK, memory and disk size:Attach Swap File on System Restart:Adjust Swap File Settings:      SWAP File Priority: (0-100% => 0: Don't put to swap,  100: Put on SWAP and free the RAM)Remove inode from cache: (100: system removes inode information from the cache too quickly)Try that:Here is the workaround that I found that works for me every time:I tried by just deleting the vendor folder and composer.lock file and then i run the command composer clear-cache and then composer install. So it working without any error.you can use the following to check your free (swap) memoryTo enable the swap you can use for example:Try it's basically raising the swap memorysudo /bin/dd if=/dev/zero of=/var/swap.1 bs=1M count=1024 && sudo /sbin/mkswap /var/swap.1 && sudo /sbin/swapon /var/swap.1This seems to be a recurring issue with 1GB and smaller server instances. Apart from trying to shutdown processes and tweak swap settings, you could install on a local machine and upload.Try this:This work for me on Centos 6Sometimes by self-updating composer it solves the problemCheersI get into this situation most of the times so normally i used to follow the step of setting the swap memory.But now i found a simple alternate trick which worked for me.Run

    composer update --no-dev Other than composer updateI solved the same problem in Vagrant.

I increased the value of memory_limit

and delete composer cache: sudo rm -R ~/.composer

and finally vagrant reload.I increased the PHP memory_limit from the default 128M to 512M and restart the server. That solved the problem.have same problem with php composer.phar update on my 512mb hosting.solved with php composer.phar installMake a swap and run composer command again. I hope it'll work for you.I had a similar issue on the cheapest server (512MB RAM) hosted with DigitalOcean, and I was also running Jenkins CI on the same server. After I stopped the Jenkins instance the composer install command worked (well, to a point, it failed with the mcrypt extension missing besides already being installed!).Maybe if you have another app running on the server, maybe its worth trying to stop it and re-running the command.Please disable js bundling and increase memory. That should fix it. I fixed mine by disabling js bundling.ThanksIn my case I tried everything that was listed above. I was using Laravel and Vagrant with 4GB of memory and a swap, with memory limit set to -1. I deleted the vendor/ and tried other PHP-versions. Finally, I managed it to work by runningAnd then composer install worked again as usual.edit php.ini file and increase memory_limit value. will solve this issue.Update memory on Server and require '4G' Change 4GB Ram [try to change server type or add more ram]2 Files We need to editon command and edit "memory_limit 756M」to 4GPhp ini on php 7.0memory_limit = 128M to 4G#AWS #AMAZONLINUX #MAGENTO2 #PHP7.0

Automatically deleting related rows in Laravel (Eloquent ORM)

Martti Laine

[Automatically deleting related rows in Laravel (Eloquent ORM)](https://stackoverflow.com/questions/14174070/automatically-deleting-related-rows-in-laravel-eloquent-orm)

When I delete a row using this syntax:Is there a way to attach a callback of sorts, so that it would e.g. do this automatically:Preferably inside the model-class.

2013-01-05 16:55:28Z

When I delete a row using this syntax:Is there a way to attach a callback of sorts, so that it would e.g. do this automatically:Preferably inside the model-class.I believe this is a perfect use-case for Eloquent events (http://laravel.com/docs/eloquent#model-events). You can use the "deleting" event to do the cleanup:

You should probably also put the whole thing inside a transaction, to ensure the referential integrity..You can actually set this up in your migrations:$table->foreign('user_id')->references('id')->on('users')->onDelete('cascade');Source: http://laravel.com/docs/5.1/migrations#foreign-key-constraintsYou can delete all related photos before actually deleting the user.Hope it helps.Relation in User model:Delete record and related:There are 3 approaches to solving this:1. Using Eloquent Events On Model Boot (ref: https://laravel.com/docs/5.7/eloquent#events)2. Using Eloquent Event Observers (ref: https://laravel.com/docs/5.7/eloquent#observers)In your AppServiceProvider, register the observer like so:Next, add an Observer class like so:3. Using Foreign Key Constraints (ref: https://laravel.com/docs/5.7/migrations#foreign-key-constraints)As of Laravel 5.2, the documentation states that these kinds of event handlers should be registered in the AppServiceProvider:I even suppose to move them to separate classes instead of closures for better application structure.It is better if you override the delete method for this. That way, you can incorporate DB transactions within the delete method itself. If you use the event way, you will have to cover your call of delete method with a DB transaction every time you call it.In your User model.In my case it was pretty simple because my database tables are InnoDB with foreign keys with Cascade on Delete. So in this case if your photos table contains a foreign key reference for the user than all you have to do is to delete the hotel and the cleanup will be done by the Data Base, the data base will delete all the photos records from the data base.I would iterate through the collection detaching everything before deleting the object itself.here's an example:I know it is not automatic but it is very simple.Another simple approach would be to provide the model with a method. Like this:Then you can simply call this where you need:Or you can do this if you wanted, just another option:Note if you are not using the default laravel db connection then you need to do the following:To elaborate on the selected answer, if your relationships also have child relationships that must be deleted, you have to retrieve all child relationship records first, then call the delete() method so their delete events are fired properly as well.You can do this easily with higher order messages.You can also improve performance by querying only the relationships ID column:yeah, but as @supersan stated upper in a comment, if you delete() on a QueryBuilder, the model event will not be fired, because we are not loading the model itself, then calling delete() on that model.The events are fired only if we use the delete function on a Model Instance.So, this beeing said:in order to delete the post tags when deleting the user, we would have to iterate over $user->posts and calling $post->delete()foreach($user->posts as $post) { $post->delete(); } -> this will fire the deleting event on PostVS$user->posts()->delete() -> this will not fire the deleting event on post because we do not actually load the Post Model (we only run a SQL like: DELETE * from posts where user_id = $user->id and thus, the Post model is not even loaded)You can use this method as an alternative.What will happen is that we take all the tables associated with the users table and delete the related data using looping

laravel 5.3 new Auth::routes()

g1eny0ung

[laravel 5.3 new Auth::routes()](https://stackoverflow.com/questions/39196968/laravel-5-3-new-authroutes)

Recently I start to use laravel 5.3 to write a blog, but I have a question after run php artisan make:authwhen I run this, it will generate routes in my web.phpthis is the code in it:Then I run php artisan route:list, I find lots of actions, like LoginController@login...But I didn't find these actions in my App\Http\Controllers\Auth, where are these?And also what is the Auth::routes() stand for, I can't find the routes about Auth.I need someone help, thank you to answer my question

2016-08-29 00:13:57Z

Recently I start to use laravel 5.3 to write a blog, but I have a question after run php artisan make:authwhen I run this, it will generate routes in my web.phpthis is the code in it:Then I run php artisan route:list, I find lots of actions, like LoginController@login...But I didn't find these actions in my App\Http\Controllers\Auth, where are these?And also what is the Auth::routes() stand for, I can't find the routes about Auth.I need someone help, thank you to answer my questionAuth::routes() is just a helper class that helps you generate all the routes required for user authentication. You can browse the code here https://github.com/laravel/framework/blob/5.3/src/Illuminate/Routing/Router.php instead.Here are the routesAuth routes for Laravel 5.3 instead Auth::routes().

I hope it helps...So if you change some names of these routes, remember to also change in views the actions of the posts!Here's Laravel 5.7, Laravel 5.8, and Laravel 6.0 (one minor bc change in 6.0 to the email verification route) including verification routes, if you want to include those as well.You can verify these routes here:For Laravel 5.5.xfunction call order:it's route like this:This worked for me with Laravel 5.6.In the file web.php, just replace:By:And remove the Register link in the two files below:I'm surprised nobody mentioned the command php artisan route:list, which gives a list of all registered app routes (including Auth::routes() and Passport::routes() if registered)the loginuser class uses a trait called AuthenticatesUsersif you open that trait you will see the functions (this applies for other controllers)

Illuminate\Foundation\Auth\AuthenticatesUsers;here is the trait code https://github.com/laravel/framework/blob/5.1/src/Illuminate/Foundation/Auth/AuthenticatesUsers.phpsorry for the bad format, im using my phonealso Auth::routes() it just calls a function that returns the auth routes thats it (i think)If you are searching these same routes for laravel 7 version you'll find it here Vendor/laravel/ui/src/AuthRouteMethods.php

Cannot create cache directory .. or directory is not writable. Proceeding without cache in Laravel

Karthik

[Cannot create cache directory .. or directory is not writable. Proceeding without cache in Laravel](https://stackoverflow.com/questions/35874482/cannot-create-cache-directory-or-directory-is-not-writable-proceeding-withou)

I Created one New Laravel Project. When I go to Terminal to install Composer Display Following Error. Cannot create cache directory /home/w3cert/.composer/cache/repo/https---packagist.org/, or directory is not writable. Proceeding without cache.I am using Ubuntu Os

2016-03-08 17:52:40Z

I Created one New Laravel Project. When I go to Terminal to install Composer Display Following Error. Cannot create cache directory /home/w3cert/.composer/cache/repo/https---packagist.org/, or directory is not writable. Proceeding without cache.I am using Ubuntu OsChange the group permission for the folderand the Files folder tooI'm assuming w3cert is your username, if not change the 4th parameter to your username.If the problem still persists tryNow, there is a chance that you won't be able to create your app directory, if that happens do the same for your html folder or the folder you are trying to create your laravel project in.Hope this helps.When you installed composer pretty sure you used $ sudo command because of that the ~/.composer folder was created by the root.Run this to fix the issue:I had the same problem today. Try it!Give full access of .composer to user.or user-name is your system user-name.to get user-name type "whoami" in terminal:

Laravel 5 - redirect to HTTPS

NightMICU

[Laravel 5 - redirect to HTTPS](https://stackoverflow.com/questions/28402726/laravel-5-redirect-to-https)

Working on my first Laravel 5 project and not sure where or how to place logic to force HTTPS on my app. The clincher here is that there are many domains pointing to the app and only two out of three use SSL (the third is a fallback domain, long story). So I'd like to handle this in my app's logic rather than .htaccess.In Laravel 4.2 I accomplished the redirect with this code, located in filters.php:I'm thinking Middleware is where something like this should be implemented but I cannot quite figure this out using it.Thanks!UPDATEIf you are using Cloudflare like I am, this is accomplished by adding a new Page Rule in your control panel. 

2015-02-09 04:14:43Z

Working on my first Laravel 5 project and not sure where or how to place logic to force HTTPS on my app. The clincher here is that there are many domains pointing to the app and only two out of three use SSL (the third is a fallback domain, long story). So I'd like to handle this in my app's logic rather than .htaccess.In Laravel 4.2 I accomplished the redirect with this code, located in filters.php:I'm thinking Middleware is where something like this should be implemented but I cannot quite figure this out using it.Thanks!UPDATEIf you are using Cloudflare like I am, this is accomplished by adding a new Page Rule in your control panel. You can make it works with a Middleware class. Let me give you an idea.Then, apply this middleware to every request adding setting the rule at Kernel.php file, like so:At sample above, the middleware will redirect every request to https if:I am using this code in production environment with a WildCard SSL and the code works correctly. If  I remove && App::environment() === 'production' and test it in localhost, the redirection also works. So, having or not a installed SSL is not the problem. Looks like you need to keep a very hard attention to your Cloudflare layer in order to get redirected to Https protocol.Thanks to @Adam Link's suggestion: it is likely caused by the headers that Cloudflare is passing. CloudFlare likely hits your server via HTTP and passes a X-Forwarded-Proto header that declares it is forwarding a HTTPS request. You need add another line in your Middleware that say......to trust the headers CloudFlare is sending. This will stop the redirect loopJust need to add the middleware class into web group in kernel.php file:An other option that worked for me, in AppServiceProvider place this code in the boot method:The function written before forceScheme('https') was wrong, its forceSchemeAlternatively, If you are using Apache then you can use .htaccess file to enforce your URLs to use https prefix. On Laravel 5.4, I added the following lines to my .htaccess file and it worked for me.for laravel 5.4 use this format to get https redirect instead of .htaccessSimilar to manix's answer but in one place. Middleware to force HTTPS

This is for Larave 5.2.x and greater. If you want to have an option to serve some content over HTTPS and others over HTTP here is a solution that worked for me. You may wonder, why would someone want to serve only some content over HTTPS? Why not serve everything over HTTPS? Although, it's totally fine to serve the whole site over HTTPS, severing everything over HTTPS has an additional overhead on your server. Remember encryption doesn't come cheap. The slight overhead also has an impact on your app response time. You could argue that commodity hardware is cheap and the impact is negligible but I digress :) I don't like the idea of serving marketing content big pages with images etc over https. So here it goes. It's similar to what others have suggest above using middleware but it's a full solution that allows you to toggle back and forth between HTTP/HTTPS.First create a middleware. This is what your middleware should look like. Note that I'm not filtering based on environment because I have HTTPS setup for both local dev and production so there is not need to. Add the following to your routeMiddleware \App\Http\Kernel.php so that you can pick and choose which route group should force SSL.Next, I'd like to secure two basic groups login/signup etc and everything else behind Auth middleware.Confirm that your middlewares are applied to your routes properly from console.Now you have secured all the forms or sensitive areas of your application, the key now is to use your view template to define your secure and public (non https) links. Based on the example above you would render your secure links as follows - Non secure links can be rendered as What this does is renders a fully qualified URL such as https://yourhost/login  and http://yourhost/aboutusIf you were not render fully qualified URL with http and use a relative link url('/aboutus') then https would persists after a user visits a secure site.Hope this helps!What about just using .htaccess file to achieve https redirect? This should be placed in project root (not in public folder). Your server needs to be configured to point at project root directory. I use this for laravel 5.4 (latest version as of writing this answer) but it should continue to work for feature versions even if laravel change or removes some functionality.You can use RewriteRule to force ssl in .htaccess same folder with your index.php

Please add as picture attach, add it before all rule others

in IndexController.php putin AppServiceProvider.php put}In AppServiceProvider.php every redirect will be go to url https and for http request we need once redirect

so in IndexController.php Just we need do once redirect The answers above didn't work for me, but it appears that Deniz Turan rewrote the .htaccess in a way that works with Heroku's load balancer here:

https://www.jcore.com/2017/01/29/force-https-on-heroku-using-htaccess/If you're using CloudFlare, you can just create a Page Rule to always use HTTPS:

This will redirect every http:// request to https://In addition to that, you would also have to add something like this to your \app\Providers\AppServiceProvider.php boot() function:This would ensure that every link / path in your app is using https:// instead of http://.I'm adding this alternative as I suffered a lot with this issue. I tried all different ways and nothing worked. So, I came up with a workaround for it. It might not be the best solution but it does work -production <- It should be replaced with the APP_ENV value in your .env fileA little different approach, tested in Laravel 5.7PS. Code updated based on @matthias-lill's comments.Here's how to do it on HerokuTo force SSL on your dynos but not locally, add to end of your .htaccess in public/:You can test this out on your local machine with:That sets the header X-forwarded to the form it will take on heroku.i.e. it simulates how a heroku dyno will see a request.You'll get this response on your local machine:That is a redirect. That is what heroku is going to give back to a client if you set the .htaccess as above.  But it doesn't happen on your local machine because X-forwarded won't be set (we faked it with curl above to see what was happening).For Laravel 5.6, I had to change condition a little to make it work.from:To: This worked out for me.

I made a custom php code to force redirect it to https.

Just include this code on the header.phpI am using in Laravel 5.6.28 next middleware:The easiest way would be at the application level. In the file add the following:and in the boot() method add the following:This should redirect all request to https at the application level.( Note: this has been tested with laravel 5.5 LTS ) 

Laravel blank white screen

Mico

[Laravel blank white screen](https://stackoverflow.com/questions/20678360/laravel-blank-white-screen)

My laravel site was working before,  I recently upgraded to Apache 2.4 and PHP 5.5.7.Now I'm getting a white blank screen when I go to laravel.mydomain.com, nothing in apache error logs, routes and etc. should be fine as it worked before..htaccess is loading as I get a 500 when I insert an invalid line to /var/sites/laravel/public/.htaccess.Heres my .htaccess:Heres my virtual host directive:And apachectl -S

2013-12-19 09:54:38Z

My laravel site was working before,  I recently upgraded to Apache 2.4 and PHP 5.5.7.Now I'm getting a white blank screen when I go to laravel.mydomain.com, nothing in apache error logs, routes and etc. should be fine as it worked before..htaccess is loading as I get a 500 when I insert an invalid line to /var/sites/laravel/public/.htaccess.Heres my .htaccess:Heres my virtual host directive:And apachectl -SDoes this answer describe or help your situation? Upgrading to Apache 2.4 come with some changes in Apache configuration. Are you checking Laravel's logs or Apache's logs?Since upgrading to Laravel 4.1, I've had white screen "errors" (WSOD) when the application could not write to the log location. I've always solved this by making the app/storage directory writable by Apache (either group writable to "www-data", "apache" or world-writable - that depends on your server setup.On Ubuntu/Debian servers, your PHP may be running as user "www-data". On CentOS/RedHat/Fedora servers, you PHP may be running as user "apache".Make sure your files are owned by the user that is running PHP:An update to fideloper's answer for Laravel 5 and its new file structure is:Try this, in the public/index.php pageThe following steps solved blank white screen problem on my Laravel 5.This will generate the encryption key and update the value of APP_KEY in .env fileThis should solve the problem. If the problem still exists, then update config/app.php with the new key generated from the above artisan key generate command:for anyone who get blank page even after making storage accessible for displaying errors put these two lines at first lines of public/index.php to see what is happening at least. for me this error was there :Class 'PDO' not found in /var/www/***/config/database.php on line 16 When I was new to Linux.I usually found this error with my Laravel Project.

White errors means error, It may have some permission issue or error.You just have to follow two steps, and will work like champ :)(1) Give the permission. Run these command from root directory of your project(2) If you cloned the project or pulled from github then run(3) Configure your .env file properly, and your project will work.I was struggling with a similar issue on a CentOS server. Using php artisan serv and accessing it through port 8000 on the local machine worked fine but could not get my remote machines to load a particular view. I could return strings fine, and some views were loading. Chased my tail on permissions for a while before I finally realized it was an SELinux issue. I just set it from enforce to permissive and it worked. Hope that helps someone else out there that may be encountering the same issue. In my case , I have installed laravel many times, and I am sure that the folder write permission has been correctly given.Like most of the answers above :The mistake is that my nginx configuration comes from the official documentation.I only modified the domain name after copying ，then I got a blank page.

I tried restarting nginx and php-fpm,but not work for me.Finally, I added this line configuration to solve the problem.I hope I can help others.I have also one more option why blank page issue may occur. If you are on production mode and if you cached your config files by php artisan (config:cache), try to delete cache file executing:or delete it manualy (bootstrap/cache/config.php)Running this command solved it for me:I guess a blank error page was some how cached. Had to clear the caches.I have some issues to setup it in a Vagrant machine. Whats really works for me was execute a:chmod -R o+w app/storage/ from inside the Vagrant machine.Reference: https://laracasts.com/lessons/vagrant-and-laravelAnother thing that may cause the WSOD is missing the 'return' keyword, as in:return View::make('yourview');as opposed to View::make('yourview');Sometimes it's because laravel 5.1 require PHP >= 5.5.9. Update php will solve the problem.Strange for me, but in my case I had to clear the laravel's cache to solve the issue.I also faced same issue after doing composer updateI tried installing composer required monolog/monolog too but didn't work.Then I removed the /vendor directory and ran composer install and worked as per normal. basically it must have reverted my monolog and other stable packages version back to previous. so better not to composer updatewhat I noticed comparing both the /vendor folders and found those classes files under /vendor/monolog/monolog/src/Handler were missing after composer updated.There might be a lot of reasons behind the blank screen without errors.

I have faced this problem many times whenever I want to upload laravel project in shared hosting.Reason: Incorrect PHP VersionIn my case, issue was because of incorrect php version. I had php 7.1 version in local computer where as in shared hosting cpanel, there was php 5.6 version. Switching up the version from 5.6 to 7.1 worked for me.You can change php version in cpanel from multiphp manager available in cpanel home page.Other problem with the same behavior is use Laravel 3 with PHP 5.5.x. You have to change some laravel function's name "yield() because is a reserved word in php 5.5 Reason can be Middleware if you forget to put following code to the end of handle functionI was also getting same error when I start first time on laravel + Ubuntu 14.04

I just right click on bootstrap and storage folder >>> properties >>>permission>> Others Access >>> change it to "Create and delete files" Change permission for enclosed files Thank you Got this from the Laravel forums, but if you recently upgraded Laravel versions AND PHP versions AND are running nginx, make sure you have changed your nginx configuration file to reflect the new PHP version. For instance:In your nginx site config file (here: /etc/nginx/sites-available), changefastcgi_pass unix:/var/run/php5-fpm.sock;tofastcgi_pass unix:/var/run/php/php5.6-fpm.sock;I have same issue. I already change chmod folder for Storage folder. fill database settings in .env, but didn't fix the problem.

I used Laravel 5.5 and I used PHP 5.6, to fix it I went to (cpanel->PHP Selector) and I changed to PHP 7.1 And the issue is done.On normal cases errors should be logged UnlessScript can't write to log fileOr error occurred on higher level check app server logs like Appache || NginxOr it's resources limits 

Like PHP ini settingsOr OS limit's and so on In addition to Permission problems in storage and cache folder and php version issues, there could be another reasons to display blank page without any error message.For example, I had a redeclare error message without any log and with blank white page.

There was a conflict between my own helper function and a vendor function.I suggest as a starting point, run artisan commands. for example:If there was a problem, it will prompted in terminal and you've got a Clue and you can google for the solution.Blank screen also happens when your Laravel app tries to display too much information and PHP limits kick in (for example displaying tens of thousands of database records on a single page). The worst part is, you won't see any errors in the Laravel logs. You probably won't see any errors in the PHP FPM logs as well. You might find errors in your http server logs, for example nginx throws something like FastCGI sent in stderr: "PHP message: PHP Fatal error:  Allowed memory size of XXX bytes exhausted.Short tip: add ->limit(1000) where 1000 is your limit, on your query object.I hit this problem when I tried to run a Laravel 5.8 app on my server, uploading from local development using Vagrant Homestead. After a while I figured out that the dev subdomain on the live server I was running was somehow set to PHP 5.6.cPanel > MultiPHP Manager > Set to PHP 7.2fixed this for me. Hope this might help someone.use this .htaccess to solveFacing the blank screen in Laravel 5.8. Every thing seems fine with both storage and bootstrap folder given 777 rights. On It shows the problem it was the White spaces in App Name of .env filein my case, the BLANK WHITE SCREEN issue was as simple as a typo or wrong character on the env file.

I was implementing socialite, so when I was setting up the .env credentials for Google+ like this:But, the .env file can't use the '+' sign, so I have to make this correction:I hope this help you find a dumb error...Sometimes in route.php you may havewritten beforeIt can be empty method Controller::show() when you begin to develop your controller from scratch. In this case you will get empty blank page when requesting /add url. It happens because the request was handled by /{id} route, and its method returns nothing.Just try to place /add route before /{id}In my case, restarting apache fixed the problem.

for Ubuntu / Debian:

How to disable registration new users in Laravel 5

Milad Rahimi

[How to disable registration new users in Laravel 5](https://stackoverflow.com/questions/29183348/how-to-disable-registration-new-users-in-laravel-5)

I'm using Laravel v5. I'm trying to make a single-user admin panel. It needs only one user. I have already registered that user manually and now I want to disable registration for new users. Of course, I need the login form to work. How can I do that?

2015-03-21 13:37:49Z

I'm using Laravel v5. I'm trying to make a single-user admin panel. It needs only one user. I have already registered that user manually and now I want to disable registration for new users. Of course, I need the login form to work. How can I do that?Laravel 5.7 introduced the following functionality:The currently possible options here are:For older Laravel versions just override showRegistrationForm() and register() methods inIf you're using Laravel 5.2 and you installed the auth related functionality with php artisan make:auth then your app/Http/routes.php file will include all auth-related routes by simply calling Route::auth(). The auth() method can be found in vendor/laravel/framework/src/Illuminate/Routing/Router.php. So if you want to do as some people suggest here and disable registration by removing unwanted routes (probably a good idea) then you have to copy the routes you still want from the auth() method and put them in app/Http/routes.php (replacing the call to Route::auth()). So for instance:If you're using lower version than 5.2 then it's probably different, I remember things changed quite a bit since 5.0, at some point artisan make:auth was even removed IIRC.This might be new in 5.7, but there is now an options array to the auth method. Simply changingtoin your routes file after running php artisan make:auth will disable user registration.For Laravel 5.3 and 5.4, here is the proper way to do it:You have to change:toin app/Http/Controller/Auth/RegisterController.phpAs of Laravel 5.7 you can pass an array of options to Auth::routes(). You can then disable the register routes with:You can see how this works from the source code: src/Illuminate/Routing/Router.php.In laravel 5.3 don't have AuthController.

to disable register route you should change in constructor of RegisterController like this:You can change form:to:Note: for use Redirect  don't forget to  user Redirect; 

So user access to https://host_name/register it's redirect to "/".When we use php artisan make:auth it's added Auth::route(); 

automatically.

Please Override Route in /routes/web.php.

You can change it's like this:

* you need to comment this line: Auth::routes();Thanks! I hope it's can solve your problems.Overwriting the getRegister and postRegister is tricky - if you are using git there is a high possibility that .gitignore is set to ignore framework files which will lead to the outcome that registration will still be possible in your production environment (if laravel is installed via composer for example)Another possibility is using routes.php and adding this line:This way the framework files are left alone and any request will still be redirected away from the Frameworks register module.The AuthController.php @limonte has overridden is in App\Http\Controllers\Auth, not in the vendor directory, so Git doesn't ignore this change.I have added this functions: and it works correctly.LAravel 5.6Heres my solution as of 5.4:Notice I've commented out Auth::routes() and the two registration routes.Important: you must also make sure you remove all instances of route('register') in your app.blade layout, or Laravel will throw an error.The following method works great:Copy all the routes from /vendor/laravel/framework/src/Illuminate/Routing/Router.php and paste it into web.php and comment out or delete Auth::routes().Then setup a conditional to enable and disable registration from .env.

Duplicate the 503.blade.php file in views/errors and create a 403 forbidden or whatever you like.Add ALLOW_USER_REGISTRATION= to .env and control user registration by setting its value to true or false.Now you have full control of routes and Vendor files remain untouched.web.phpThis is a combination of some previous answers notably Rafal G. and Daniel Centore. On laravel 5.6 and above you can edit in web.php file and you can make it true if you change your mind, i see it easy this way In routes.php, just add the following:Then you can selectively control whether registration is allowed or not in you .env file.I had to use:Using Redirect::to() gave me an error:You can find all routes which are registered through Auth::routes() in the class \Illuminate\Routing\Router in the method auth()it looks like this:Just copy the routes that you want/need and you are fine!In laravel 5.3, you should override the default showRegistrationForm() by including the code below into the RegisterController.php file in app\Http\Controllers\Authsince you don't want to allow registration, it's better to just throw 404 error so the intruder knows he is lost. And when you are ready for registraation in your app, uncomment //return view('auth.register'); then comment abort(404);\\\\\\\\\\\\\\\\\\\\JUST AN FYI///////////////////////////////If you need to use multiple authentication like create auth for users, members, students, admin, etc. then i advise you checkout this hesto/multi-auth its an awesome package for unlimited auths in L5 apps.You can read more abouth the Auth methodology and its associated file in this writeup.In Laravel 5.5I was trying to accomplish the same problem in Laravel 5.5. Instead of using Auth::routes() in the web.php routes file, I only included the login/logout routes:This has been mentioned in earlier comments but I would like to clarify that there are multiple ways to access the auth routes in your web.php file in Laravel ^5.7. depending on your version it might look a little different but they achieve the same result.First optionSecond optionIn order not too change the code as it is, just create a middleware to detect if the request url is url('register'), then redirect to 404 or do wherever.In Laravel 5.5Working on a similar issue and setting the middleware argument from guest to 'auth' seemed like a more elegant solution. Edit File: app->http->Controllers->Auth->RegisterController.phpI could be wrong though...but it seems more slick than editing the routing with more lines and less shity than simply redirecting the page...at least in this instance, wanting to lock down the registration for guests.I guess this would rather be a better solution.Override the following methods as below mentioned in App\Http\Controller\Auth\RegisterController.phpIn Laravel 5.5 is very simple, if you are using CRUD route system.Go to app/http/controllers/RegisterController  there is namespace: Illuminate\Foundation\Auth\RegistersUserYou need to go to the RegistersUser: Illuminate\Foundation\Auth\RegistersUserThere is the method call showRegistrationForm change this: return view('auth.login'); for this: return redirect()->route('auth.login'); and remove from you blade page route call register. It may look like that:I found this to be the easiest solution in laravel 5.6! It redirects anyone who tries to go to yoursite.com/register to yoursite.comroutes/web.phpAll I did was replace register blade code with login blade code. That way register still goes to login.resources/views/auth/register.blade.php is replaced with resources/views/auth/login.blade.phpFor Laravel 5.6+, paste the below methods in app\Http\Controller\Auth\RegisterControllerNow you're overriding those methods in RegistersUser trait, whenever you change your mind remove these methods. You may also comment the register links in welcome.blade.php and login.blade.php views.addat the top of the file

Laravel Eloquent Sum of relation's column

theAdmiral

[Laravel Eloquent Sum of relation's column](https://stackoverflow.com/questions/21679678/laravel-eloquent-sum-of-relations-column)

I've been working on a shoppingcart application and now I've come to the following issue..There is a User, a Product and a Cart object.

 - The Cart table only contains the following columns: "id", "user_id", "product_id" and timestamps.

 - The UserModel "hasMany" Carts (because a user can store multiple products).

 - The CartModel "belongsTo" a User and CartModel "hasMany" Products.  Now to calculate the total products I can just call: Auth::user()->cart()->count().  My question is: How can I get the SUM() of prices (a column of product) of the products in cart by this User?

I would like to accomplish this with Eloquent and not by using a query (mainly because I believe it is a lot cleaner).

2014-02-10 14:20:58Z

I've been working on a shoppingcart application and now I've come to the following issue..There is a User, a Product and a Cart object.

 - The Cart table only contains the following columns: "id", "user_id", "product_id" and timestamps.

 - The UserModel "hasMany" Carts (because a user can store multiple products).

 - The CartModel "belongsTo" a User and CartModel "hasMany" Products.  Now to calculate the total products I can just call: Auth::user()->cart()->count().  My question is: How can I get the SUM() of prices (a column of product) of the products in cart by this User?

I would like to accomplish this with Eloquent and not by using a query (mainly because I believe it is a lot cleaner).The documentation is a little light for some of the Collection methods but all the query builder aggregates are seemingly available besides avg() that can be found at http://laravel.com/docs/queries#aggregates.this is not your answer but is for those come here searching solution for another problem. 

I wanted to get sum of a column of related table conditionally. 

In my database Deals has many Activities 

I wanted to get the sum of the "amount_total" from Activities table where activities.deal_id = deal.id and activities.status = paid

so i did this. it returnsin Deals attribute.This it now the sum  which i wanted to get not the count. I tried doing something similar, which took me a lot of time before I could figure out the collect() function. So you can have something this way:collect($items)->sum('amount'); This will give you the sum total of all the items.Also using query builderTo get summation of all rate value inside table rates.To get summation of user products.

Laravel Schema onDelete set null

M K

[Laravel Schema onDelete set null](https://stackoverflow.com/questions/20869072/laravel-schema-ondelete-set-null)

Can't figure out how to set proper onDelete constraint on a table in Laravel. (I'm working with SqLite)I have 3 migrations, creating the gallery table:Creating the pictures table:Linking gallery table to a picture:I do not receive any errors. Also, even the "cascade" option doesn't work (only on the gallery table). Deleting a gallery deletes all pictures. But deleting the cover picture, wont delete the gallery (for test purposes).Since even the "cascade" is not triggered, I "set null" is not the problem.EDIT (workaround):After reading this article I've changed my schema a bit. Now, the pictures table contains an "is_cover" cell, that indicates whether this picture is a cover on its album or not. A solution to the original problem is still highly appreciated! 

2014-01-01 13:23:42Z

Can't figure out how to set proper onDelete constraint on a table in Laravel. (I'm working with SqLite)I have 3 migrations, creating the gallery table:Creating the pictures table:Linking gallery table to a picture:I do not receive any errors. Also, even the "cascade" option doesn't work (only on the gallery table). Deleting a gallery deletes all pictures. But deleting the cover picture, wont delete the gallery (for test purposes).Since even the "cascade" is not triggered, I "set null" is not the problem.EDIT (workaround):After reading this article I've changed my schema a bit. Now, the pictures table contains an "is_cover" cell, that indicates whether this picture is a cover on its album or not. A solution to the original problem is still highly appreciated! If you want to set null on delete: First make sure you set the foreign key field as nullable:According tohttp://dev.mysql.com/doc/refman/5.6/en/innodb-foreign-key-constraints.html$table->onDelete('set null') should work prehaps tryIf there are any errors, would also be helpfulUsing Laravel 4.2 on MySQL 5.5 with InnoDB, onDelete('set null') works.

Can I Install Laravel without using Composer?

ryanwinchester

[Can I Install Laravel without using Composer?](https://stackoverflow.com/questions/15940140/can-i-install-laravel-without-using-composer)

I'd like to know if I can install or use the Laravel PHP framework on any web server without using Composer (PHP package/dependency manager) every time?I would like to be able to drop my app on to any web server (like a shared server without access to the command line).If I run composer install the first time (locally), then all the dependencies should be present, correct?Then, I should be able to drop it onto any server with all of the files (including the vendor directory)?

2013-04-11 03:18:56Z

I'd like to know if I can install or use the Laravel PHP framework on any web server without using Composer (PHP package/dependency manager) every time?I would like to be able to drop my app on to any web server (like a shared server without access to the command line).If I run composer install the first time (locally), then all the dependencies should be present, correct?Then, I should be able to drop it onto any server with all of the files (including the vendor directory)?If you really wanted to, you could do all the work that Composer does manually, but you definitely should not. Installing Composer is easy, it's just a matter of getting the composer.phar file and running commands on it.You do not need to run Composer on your server as well as locally, once you run composer install or composer update your project will have all its dependencies available and you can just upload it straight to your server.You cannot install laravel local without composer in your project.On this site you can download everything what you can download also with the composer build tool. But you do not need a composer installation. Of course laravel is also present there: https://php-download.com/package/laravel/laravelIf you have shared server and you are not able to install composer and run cmd to install a new package or update an existing package. You can one thing by installing composer on your local machine and install(ex composer require package/name) or update(ex composer update package/name) all the packages, then upload your vendor directory on the server with your code. it will work for you same as in your local environment.NOTE: I strongly recommend that you should use the Laravel with the composer, it is an important part of laravel and you can try to convince your client to provide a server that supports laravel. Please check the link below and you can find the server requirements. https://laravel.com/docs/5.5#installationIf you don't want to use composer on server then you will have to run composer install/update and download all the libraries locally and then manually upload all those files on the server i.e. Vendor Directory.In-Case of shared hosting where you can't connect to server with shh there you might have to do that but it will take lot of time to upload all the files on server so I would recommend that you should composer and then download the libraries through composer install/update.Yes, you can install all project dependencies via composer in your localhost first, and then transfer all the files via FTP to your actual website.Just download the zip file from github and upload to your htdoc and voilà it will work for you

How to query between two dates using Laravel and Eloquent?

wobsoriano

[How to query between two dates using Laravel and Eloquent?](https://stackoverflow.com/questions/33361628/how-to-query-between-two-dates-using-laravel-and-eloquent)

I'm trying to create a report page that shows reports from a specific date to a specific date. Here's my current code:What this does in plain SQL is select * from table where reservation_from = $now. I have this query here but I don't know how to convert it to eloquent query.How can I convert the code above to eloquent query? Thank you in advance.

2015-10-27 06:56:04Z

I'm trying to create a report page that shows reports from a specific date to a specific date. Here's my current code:What this does in plain SQL is select * from table where reservation_from = $now. I have this query here but I don't know how to convert it to eloquent query.How can I convert the code above to eloquent query? Thank you in advance.The whereBetween method verifies that a column's value is between

two values.In some cases you need to add date range dynamically. Based on @Anovative's comment you can do this:If you would like to add more condition then you can use orWhereBetween. If you would like to exclude a date interval then you can use whereNotBetween.Other useful where clauses: whereIn, whereNotIn, whereNull, whereNotNull, whereDate, whereMonth, whereDay, whereYear, whereTime, whereColumn, whereExists, whereRaw.Laravel docs about Where Clauses.Another option if your field is datetime instead of date (although it works for both cases):The following should work:If you want to check if current date exist in between two dates in db:

=>here the query will get the application list if employe's application from and to date is exist in todays date.Try this:    Since you are fetching based on a single column value you can simplify your query likewise:Retrieve based on condition: laravel docsHope this helped.If you need to have in when a datetime field should be like this.I know this might be an old question but I just found myself in a situation where I had to implement this feature in a Laravel 5.7 app. Below is what worked from me.You will also need to use CarbonAnd I have created the model scopeMore about scopes:Code:And in the controller, add the Carbon Library to top ORTo get the last 10 days record from nowTo get the last 30 days record from now

Laravel - Session store not set on request

mattrick

[Laravel - Session store not set on request](https://stackoverflow.com/questions/34449770/laravel-session-store-not-set-on-request)

I recently created a new Laravel project and was following along the guide on Authentication. When I visit either my login or register route, I get the following error:I haven't edited any core Laravel files, I've only created the views and added the routes to my routes.php fileI don't have much experience with Laravel, so please excuse my ignorance. I'm aware that there is another question asking this same thing, but neither of the answers seem to work for me. Thanks for reading!Edit:Here's my register.blade.php as requested.

2015-12-24 08:42:04Z

I recently created a new Laravel project and was following along the guide on Authentication. When I visit either my login or register route, I get the following error:I haven't edited any core Laravel files, I've only created the views and added the routes to my routes.php fileI don't have much experience with Laravel, so please excuse my ignorance. I'm aware that there is another question asking this same thing, but neither of the answers seem to work for me. Thanks for reading!Edit:Here's my register.blade.php as requested.You'll need to use the web middleware if you need session state, CSRF protection, and more.If adding your routes inside the web middleware doesn't work for any reason then try adding this to $middleware into Kernel.phpIn my case (using Laravel 5.3) adding only the following 2 middleware allowed me to access session data in my API routes:Whole declaration ($middlewareGroups in Kernel.php):If Cas Bloem's answer does not apply (i.e. you've definitely got the web middleware on the applicable route), you might want to check the order of middlewares in your HTTP Kernel.The default order in Kernel.php is this:Note that VerifyCsrfToken comes after StartSession. If you've got these in a different order, the dependency between them can also lead to the Session store not set on request. exception. A problem can be that you try to access you session inside of your controller's  __constructor() function.From Laravel 5.3+ this is not possible anymore because it is not intended to work anyway, as stated in the upgrade guide.For more background information also read Taylor his response.WorkaroundIf you still want to use this, you can dynamically create a middleware and run it in the constructor, as described in the upgrade guide:Laravel [5.4]My solution was to use global session helper:

session()Its functionality is a little bit harder than $request->session().writing:pushing:retrieving:In my case I added the following 4 lines to $middlewareGroups (in app/Http/Kernel.php):IMPORTANT: The 4 new lines must be added BEFORE 'throttle' and 'bindings'!Otherwise a "CSRF token not match" error will rise. I've struggled in this for several hours just to find the order is important.This allowed me to access session in my API. I also added VerifyCsrfToken as when cookies/sessions are involved, CSRF needs to be taken care of.in my case it was just to put 

return ; 

at the end of function where  i have set session If you are using CSRF enter 'before'=>'csrf'In your case

Route::get('auth/login', ['before'=>'csrf','uses' => 'Auth\AuthController@getLogin', 'as' => 'login']);For more details view Laravel 5 Documentation Security Protecting RoutesDo you can use ->stateless() before the ->redirect().

Then you dont need the session anymore.It's not on the laravel documentation, I have been an hour to achieve this:My session didn't persist until i used the "save" method...Laravel 5.3+  web middleware group is automatically applied to your routes/web.php file by the RouteServiceProvider. Unless you modify kernel $middlewareGroups array in an unsupported order, probably you are trying to inject requests as a regular dependency from the constructor.Use request asinstead of 

How to validate array in Laravel?

Darama

[How to validate array in Laravel?](https://stackoverflow.com/questions/42258185/how-to-validate-array-in-laravel)

I try to validate array POST in Laravel:I send empty POST and get this if ($validator->fails()) {} as False. It means that validation is true, but it is not.How to validate array in Laravel? When I submit form with input name="name[]"

2017-02-15 19:15:03Z

I try to validate array POST in Laravel:I send empty POST and get this if ($validator->fails()) {} as False. It means that validation is true, but it is not.How to validate array in Laravel? When I submit form with input name="name[]"Asterisk symbol (*) means that you want to check VALUES in the array, not the actual array.In the example above:EDIT: Since Laravel 5.5 you can call validate() method directly on Request object like so:I have this array as my request data from a HTML+Vue.js data grid/table:And use this to validate which works properly:The recommended way to write validation and authorization logic is to put that logic in separate request classes. This way your controller code will remain clean.You can create a request class by executing php artisan make:request SomeRequest.In each request class's rules() method define your validation rules:In your controller write your route function like this:Each request class comes with pre- and post-validation hooks/methods which can be customized based on business logic and special cases in order to modify the normal behavior of request class.You may create parent request classes for similar types of requests (e.g. web and api) requests and then encapsulate some common request logic in these parent classes.You have to loop over the input array and add rules for each input as described here: Loop Over RulesHere is a some code for ya:Little bit more complex data, mix of @Laran's and @Nisal Gunawardana's answersThe validation rule will be

How Can I Remove「public/index.php」in the URL Generated Laravel?

TuGordoBello

[How Can I Remove「public/index.php」in the URL Generated Laravel?](https://stackoverflow.com/questions/23837933/how-can-i-remove-public-index-php-in-the-url-generated-laravel)

I need to remove  index.php or public/index.php from the generated URL in Laravel; commonly path is localhost/public/index.php/someWordForRoute, It should be something like localhost/someWordForRoute..htaccessapp/config/app.phpHow can I change that?

2014-05-23 20:33:00Z

I need to remove  index.php or public/index.php from the generated URL in Laravel; commonly path is localhost/public/index.php/someWordForRoute, It should be something like localhost/someWordForRoute..htaccessapp/config/app.phpHow can I change that?If it isn't already there, create an .htaccess file in the Laravel root directory.

Create a .htaccess file your Laravel root directory if it does not exists already. (Normally it is under your public_html folder)Edit the .htaccess file so that it contains the following code:Now you should be able to access the website without the "/public/index.php/" part.Make a new folder in your root directory and move all the files and folder except public folder. You can call it anything you want. I'll use "laravel_code".Next, move everything out of the public directory and into the root folder. It should result in something somewhat similar to this:

After that, all we have to do is edit the locations in the laravel_code/bootstrap/paths.php file and the index.php file.In laravel_code/bootstrap/paths.php find the following line of code:And change them to:In index.php, find these lines:And change them to:Source: How to remove /public/ from URL in LaravelI tried this on Laravel 4.2Rename the server.php in the your Laravel root folder to index.php and copy the .htaccess file from /public directory to your Laravel root folder.I hope it worksDon't get confused with other option the snippet below I am using and will be useful for you too.

Put the below htacces in your root.Go to your public directory and put another htaccess file with the code snippet belowIts working... !!!Laravel Uses below .htaccessHERE ARE SIMPLE STEPS TO REMOVE PUBLIC IN URL (Laravel 5)1: Copy all files form public folder and past them in laravel root folder2: Open index.php and  change FromToAnd ToIn laravel 4  path 2 is $app = require_once __DIR__.'/bootstrap/start.php'; instead of $app = require_once __DIR__.'/bootstrap/app.php';/app.phpThat is it.1) Check whether mod_rewrite is enabled. Go to /etc/apache2/mods-enabled directory and see whether the rewrite.load is available. If not, enable it using the command sudo a2enmod rewrite.It will enable the rewrite module. If its already enabled, it will show the message Module rewrite already enabled.

2)Create a virtual host for public directory so that instead of giving http://localhost/public/index.php we will be able to use like that http://example.com/index.php. [hence public folder name will be hidded]

3)Then create a .htaccess which will hide the index.php from your url which shoul be inside the root directory (public folder)This likely has very little to do with Laravel and everything to do with your Apache configs.Do you have access to your Apache server config? If so, check this out, from the docs:The reason why I mention this first is because it is best to get rid of .htaccess completely if you can,and use a Directory tag inside a VirtualHost tag. That being said, the rest of this is going to assume you are sticking with the .htaccess route for whatever reason.To break this down, a couple things could be happening:Hope this helps. I've named some of the most common issues but there are several others that could be more mundane or unique. Another suggestion on a dev server? Re-install Apache. If possible, do so from a different source with a good tutorial.For Laravel 4 & 5:   That's it !! :)Laravel ships with a pretty URL .htaccess already... you should be good to go out of the box...

http://laravel.com/docs/installation#pretty-urlsMake sure mod_rewrite is enabled and that your home path is set to the public directory of your application.You have to perform following steps to do this, which are as followsAlso make sure the Rewrite Engline is turned on after editing the .htaccess fileuse this in .htaccess and restart the serverHope this helps like it did for me.I just installed Laravel 5 for a project and there is a file in the root called server.php. Change it to index.php and it works or type in terminal:Rename the server.php in the your Laravel root folder to index.php and copy the .htaccess file from /public directory to your Laravel root folder.It Works and Its 100%  SECUREhttps://medium.com/@matteovirgilio/laravel-5-how-to-change-the-public-folder-and-secure-private-files-on-shared-hosting-a8e2e5b9b25fIf you use IIS Windows Server add web.config file in root folder and put the below code  : and if you use .htaccess  use this one : As per Laravel 5.3 the above things will not work properly, but please be calm and follow below steps:Step 1. Go to inside of laravel project

Step 2. Make one random directory/folder eg. laravelcode

Step 3. Move all the folder and files(Except public folder)

Step 4. Move all the folder and files which are inside the public folder to the laravel project

Step 5. Now inside the laravel project there is index.php file, please open that and change the folder paths for bootstrap as per new path like previously it was "require DIR.'/../bootstrap/autoload.php';" now it will become to "require DIR.'/laravelcode/bootstrap/autoload.php';"That's it just run your url without public and index.php like below

http://localhost/blog/

Laravel csrf token mismatch for ajax POST Request

Ashish Singh

[Laravel csrf token mismatch for ajax POST Request](https://stackoverflow.com/questions/32738763/laravel-csrf-token-mismatch-for-ajax-post-request)

I am trying to delete data from database via ajax.HTML:My ajax code:This is my query to fetch data from database...But when i click on Delete link data not deleted and show csrf_token mismatch...

2015-09-23 11:47:59Z

I am trying to delete data from database via ajax.HTML:My ajax code:This is my query to fetch data from database...But when i click on Delete link data not deleted and show csrf_token mismatch...You have to add data in your ajax request. I hope so it will be work.The best way to solve this problem "X-CSRF-TOKEN" is to add the following code to your main layout, and continue making your ajax calls normally:In headerIn scriptI think is better put the token in the form, and get this token by idAnd the JQUery : this way, your JS don't need to be in your blade files.I just added headers: in ajax call:in view:ajax function: in controller:in routes.phpIf you are using template files, than you can put your meta tag in the head section (or whatever you name it) which contain your meta tags.Next thing, you need to put the headers attribute to your ajax(in my example, I am using datatable with server-side processing:Here is the full datatable ajax example:After doing this, you should get 200 status for your ajax request.Know that there is an X-XSRF-TOKEN cookie that is set for convenience. Framework like Angular and others set it by default. Check this in the doc https://laravel.com/docs/5.7/csrf#csrf-x-xsrf-token

You may like to use it.The best way is to use the meta, case the cookies are deactivated.Here the recommended meta way (you can put the field any way, but meta is quiet nice):Note the use of decodeURIComponent(), it's decode from uri format which is used to store the cookie. [otherwise you will get an invalid payload exception in laravel].Here the section about the csrf cookie in the doc to check :

https://laravel.com/docs/5.7/csrf#csrf-x-csrf-tokenAlso here how laravel (bootstrap.js) is setting it for axios by default:you can go check resources/js/bootstrap.js.And here read cookie function:if you are using jQuery to send AJAX Posts, add this code to all views:Laravel adds a XSRF cookie to all requests, and we automatically append it to all AJAX requests just before submit.You may replace getCookie function if there is another function or jQuery plugin to do the same thing.Add an id to the meta element that holds the tokenAnd then you can get it in your JavascriptFor Laravel 5.8, setting the csrf meta tag for your layout and setting the request header for csrf in ajax settings won't work if you are using ajax to submit a form that already includes a _token input field generated by the Laravel blade templating engine. You must include the already generated csrf token from the form with your ajax request because the server would be expecting it and not the one in your meta tag. For instance, this is how the _token input field generated by Blade looks like:You then submit your form with ajax like this:The csrf token in the meta header is only useful when you are submitting a form without a Blade generated _token input field.I actually had this error and could not find a solution. I actually ended up not doing an ajax request. I don't know if this issue was due to this being  sub domain on my server or what. Here's my jquery.So I actually set up an anchor to go to my API rather than doing a post request, which is what I figure most applications do.You should include a hidden CSRF (cross site request forgery) token field in the form so that the CSRF protection middleware can validate the request.Laravel automatically generates a CSRF "token" for each active user session managed by the application. This token is used to verify that the authenticated user is the one actually makin gthe requests to the application.So when doing ajax requests, you'll need to pass the csrf token via data parameter. Here's the sample code.

Laravel Request::all() Should Not Be Called Statically

Moose

[Laravel Request::all() Should Not Be Called Statically](https://stackoverflow.com/questions/28573860/laravel-requestall-should-not-be-called-statically)

In Laravel, I'm trying to call $input = Request::all(); on a store() method in my controller, but I'm getting the following error:Any help figuring out the best way to correct this? (I'm following a Laracast)

2015-02-18 00:31:44Z

In Laravel, I'm trying to call $input = Request::all(); on a store() method in my controller, but I'm getting the following error:Any help figuring out the best way to correct this? (I'm following a Laracast)The error message is due to the call not going through the Request facade.ChangeToand it should start working.In the config/app.php file, you can find a list of the class aliases.  There, you will see that the base class Request has been aliased to the Illuminate\Support\Facades\Request class.  Because of this, to use the Request facade in a namespaced file, you need to specify to use the base class: use Request;.Since this question seems to get some traffic, I wanted to update the answer a little bit since Laravel 5 was officially released.While the above is still technically correct and will work, the use Illuminate\Http\Request; statement is included in the new Controller template to help push developers in the direction of using dependency injection versus relying on the Facade.When injecting the Request object into the constructor (or methods, as available in Laravel 5), it is the Illuminate\Http\Request object that should be injected, and not the Request facade.So, instead of changing the Controller template to work with the Request facade, it is better recommended to work with the given Controller template and move towards using dependency injection (via constructor or methods).Example via methodExample via constructorInject the request object into the controller using Laravel's magic injection and then access the function non-statically. Laravel will automatically inject concrete dependencies into autoloaded classesuse the request() helper instead. You don't have to worry about use statements and thus this sort of problem wont happen again.simpleThe facade is another Request class, access it with the full path:From laravel 5 you can also access it through the request() function:I thought it would be useful for future visitors to provide a bit of an explanation on what is happening here.Laravel's Illuminate\Http\Request class has a method named all (in fact the all method is defined in a trait that the Request class uses, called Illuminate\Http\Concerns\InteractsWithInput). The signature of the all method at the time of writing looks like this:This method is not defined as static and so when you try to call the method in a static context, i.e. Illuminate\Http\Request::all() you will get the error displayed in OP's question. The all method is an instance method and deals with information that is present in an instance of the Request class, so calling it in this way makes no sense.A facade in Laravel provides developers with a convenient way of accessing objects in the IoC container, and calling methods on those objects. A developer can call a method "statically" on a facade like Request::all(), but the actual method call on the real Illuminate\Http\Request object is not static.A facade works like a proxy - it refers to an object in the IoC container and passes the static method call onto that object (non-statically). For instance, take the Illuminate\Support\Facades\Request facade, this is what it looks like:Under the hood, the base Illuminate\Support\Facades\Facade class uses some PHP magic, namely the __callStatic method to:This is why, as @patricus pointed out in his answer above, by changing the use/import statement to refer to the facade, the error is no longer there, because as far as PHP is concerned, all has been correctly called on an instance of Illuminate\Http\Request.Aliasing is another feature that Laravel provides for convenience. It works by effectively creating alias classes that point to facades in the root namespace. If you take a look at your config/app.php file, under the aliases key, you will find a long list of mappings of strings to facade classes. For example:Laravel creates these alias classes for you, based on your configuration and this allows you to utilise classes available in the root namespace (as referred to by the string keys of the aliases config) as if you're using the facade itself:While facades and aliasing are still provided in Laravel, it is possible and usually encouraged to go down the dependency injection route. For example, using constructor injection to achieve the same result:There are a number of benefits to this approach but in my personal opinion the greatest pro for dependency injection is that it makes your code way easier to test. By declaring the dependencies of your classes as constructor or method arguments, it becomes very easy to mock out those dependencies and unit test your class in isolation.is same in context sayingalso it happens when you import following library to api.php file.

this happens by some IDE's suggestion to import it for not finding the Route Class.just remove it and everything going to work fine.update:seems if you add this library it wont lead to errorI was facing this problem even with use Illuminate\Http\Request; line at the top of my controller. Kept pulling my hair till I realized that I was doing $request::ip() instead of $request->ip(). Can happen to you if you didn't sleep all night and are looking at the code at 6am with half-opened eyes.Hope this helps someone down the road.i make it work with a scope definitionpublic function pagar(\Illuminate\Http\Request $request)

    {

        //

Installing specific laravel version with composer create-project

user1995781

[Installing specific laravel version with composer create-project](https://stackoverflow.com/questions/23754260/installing-specific-laravel-version-with-composer-create-project)

The fastest and simplest way of installing Laravel is via composer command. From the laravel docs (http://laravel.com/docs/quick), it shows that we can install it with this:But, when you run the above command, it will grab the latest version of Laravel. How can I control it if I want to install latest version of 4.0.x? Or, 4.1.x when 4.2 is out?

2014-05-20 08:08:30Z

The fastest and simplest way of installing Laravel is via composer command. From the laravel docs (http://laravel.com/docs/quick), it shows that we can install it with this:But, when you run the above command, it will grab the latest version of Laravel. How can I control it if I want to install latest version of 4.0.x? Or, 4.1.x when 4.2 is out?From the composer help create-project commandThis command works:This works with the * notation.Have a look:Laravel 4.2 DocumentationSyntax (Via Composer):Example:Where 4.2 is your version of laravel.Note: It will take the latest version of Laravel automatically If you will not provide any version.Try via Composer Create-ProjectYou may also install Laravel by issuing the Composer create-project command in your terminal:And then you probably need to install all of vendor packages, soTo install specific version of laravel try this & simply command on terminal If you want to use a stable version of your preferred Laravel version of choice, use:That will pick out the most recent or best update of version 5.5.* (5.5.28)

Laravel: Where to store global arrays data and constants?

Marco Madueño Mejía

[Laravel: Where to store global arrays data and constants?](https://stackoverflow.com/questions/26854030/laravel-where-to-store-global-arrays-data-and-constants)

I just started working with Laravel. I need to rewrite a whole system I made some years ago, using Laravel 4 as base framework. In my old system, I used to have a constant.php file with some constants declared, and a globals.php file which contained lots of array sets (for example, categories statuses, type of events, langs, etc.). By doing so, I could use something likeanywhere in my app.My question is, how can I store that info in the so called "laravel way". I tried using some sort of object to store this info, setting this as a service and creating for it a facade:app/libraries/Project/Constants.phpapp/libraries/Project/ConstantsServiceProvider.phpapp/libraries/Project/ConstantsFacade.phpcomposer.jsonand so I access that property as PJ\Constants::$langs.This works, but I doubt it is the most efficient or correct way of doing it. I mean, is it the right way to "propagate" a variable by creating a whole Service Provider and facades and all such stuff? Or where should I put this data?Thanks for any advice.EDIT # 01Data I want to pass to all controllers and views can be directly set in script, like in the example at the beginning of my post, but it can also be generated dynamically, from a database for example. This data could be a list of categories. I need them in all views to generate a navigation bar, but I also need them to define some routing patterns (like /category/subcategory/product), and also to parse some info in several controllers (Like get info from the category that holds X product). My array is something  like:Just as an example. Index is the id of the category, and the Value is info associated with the category.I need this array, also, available in all Controllers and Views. So, should I save it as a Config variable? How else could I store these data; what would be the best and semantically correct way?

2014-11-10 22:16:05Z

I just started working with Laravel. I need to rewrite a whole system I made some years ago, using Laravel 4 as base framework. In my old system, I used to have a constant.php file with some constants declared, and a globals.php file which contained lots of array sets (for example, categories statuses, type of events, langs, etc.). By doing so, I could use something likeanywhere in my app.My question is, how can I store that info in the so called "laravel way". I tried using some sort of object to store this info, setting this as a service and creating for it a facade:app/libraries/Project/Constants.phpapp/libraries/Project/ConstantsServiceProvider.phpapp/libraries/Project/ConstantsFacade.phpcomposer.jsonand so I access that property as PJ\Constants::$langs.This works, but I doubt it is the most efficient or correct way of doing it. I mean, is it the right way to "propagate" a variable by creating a whole Service Provider and facades and all such stuff? Or where should I put this data?Thanks for any advice.EDIT # 01Data I want to pass to all controllers and views can be directly set in script, like in the example at the beginning of my post, but it can also be generated dynamically, from a database for example. This data could be a list of categories. I need them in all views to generate a navigation bar, but I also need them to define some routing patterns (like /category/subcategory/product), and also to parse some info in several controllers (Like get info from the category that holds X product). My array is something  like:Just as an example. Index is the id of the category, and the Value is info associated with the category.I need this array, also, available in all Controllers and Views. So, should I save it as a Config variable? How else could I store these data; what would be the best and semantically correct way?For most constants used globally across the application, storing them in config files is sufficient. It is also pretty simpleCreate a new file in the app/config directory. Let's call it constants.phpIn there you have to return an array of config values.And you can access them as followsAnd you can set them as wellNote that the values you set will not persist. They are only available for the current request.The config is probably not the right place to store information generated from the database. You could just use an Eloquent Model like:And query all categoriesIf the whole Model thing for some reason isn't working out you can start thinking about creating your own class and a facade. Or you could just create a class with all static variables and methods and then use it without the facade stuff.For ConstantsCreate constants.php file in the config directory:-You can use them like:-For Static ArraysCreate static_arrays.php file in the config directory:-You can use it like:-Note: Laravel includes all config files automatically, so no need of manual include :)app/constants.phpcomposer.json

add file location at autoload in composer.json Before this change can take effect, you must run the following command in Terminal to regenerate Laravel’s autoload files:For global constants in Laravel 5, I don't like calling Config for them. I define them in Route group like this:Just to add to the above answer you will have to include the config class before you could start using it in Laravel 5.3I think the best way is to use localization.Create a new file messages.php in resources/lang/en (en because that is what is set in my config/app 'locale'=>'en') 

return an array of all your values  to retrieve for laravel 5.3 and beloworfor 5.4 uselaravel 5.0 localizationorlaravel 5.4 localizationAtleast in Laravel 5.4, in your constructor you can create them;Then you can call them like this in your methods;Especially useful for static methods in the Model, etc... Reference on Laracasts.com https://laracasts.com/discuss/channels/general-discussion/class-apphttpcontrollersconfig-not-found

Switch in Laravel 5 - Blade

ventaquil

[Switch in Laravel 5 - Blade](https://stackoverflow.com/questions/29897508/switch-in-laravel-5-blade)

How can I use switch in blade templates? When I used:in result I see this text as plaintext. I prefer to use switch in few piece of code because it's more clean for me than when I using if.But if it's not possible just write it.

2015-04-27 13:42:58Z

How can I use switch in blade templates? When I used:in result I see this text as plaintext. I prefer to use switch in few piece of code because it's more clean for me than when I using if.But if it's not possible just write it.Updated 2020 AnswerSince Laravel 5.5 the @switch is built into the Blade. Use it as shown below.Older AnswerUnfortunately Laravel Blade does not have switch statement. You can use Laravel if else approach or use use plain PHP switch. You can use plain PHP in blade templates like in any other PHP application. Starting from Laravel 5.2 and up use @php statement.Option 1:You can just add these code in AppServiceProvider class boot method.then you can use as:Enjoy It~IN LARAVEL 5.2 AND UP:Write your usual code between the opening and closing PHP statements.In Laravel 5.1, this works in a Blade:This is now built in Laravel 5.5 

https://laravel.com/docs/5.5/blade#switch-statementsYou can extend blade like so:You can then use the following:However do note the warnings in : http://php.net/manual/en/control-structures.alternative-syntax.phpIf there is any whitespace between the switch(): and the first case then the whole code block will fail. That is a PHP limitation rather than a blade limitation. You may be able to bypass it by forcing the normal syntax e.g.:But this feels a bit wrong. To overcome the space in 'switch ()', you can use code :When you start using switch statements within your views, that usually indicate that you can further re-factor your code. Business logic is not meant for views, I would rather suggest you to do the switch statement within your controller and then pass the switch statements outcome to the view. 

Dropping column with foreign key Laravel error: General error: 1025 Error on rename

Latheesan

[Dropping column with foreign key Laravel error: General error: 1025 Error on rename](https://stackoverflow.com/questions/27175808/dropping-column-with-foreign-key-laravel-error-general-error-1025-error-on-ren)

I've created a table using migration like this:I need to change this table and drop the foreign key reference & column pick_detail_id and add a new varchar column called sku after pick_id column.So, I've created another migration, which looks like this:When I run this migration, I get the following error:When I try to reverse this migration by running php artisan migrate:rollback command, I get a Rolled back message, but it's not actually doing anything in the database.Any idea what might be wrong? How do you drop a column that has a foreign key reference?

2014-11-27 17:03:42Z

I've created a table using migration like this:I need to change this table and drop the foreign key reference & column pick_detail_id and add a new varchar column called sku after pick_id column.So, I've created another migration, which looks like this:When I run this migration, I get the following error:When I try to reverse this migration by running php artisan migrate:rollback command, I get a Rolled back message, but it's not actually doing anything in the database.Any idea what might be wrong? How do you drop a column that has a foreign key reference?You can use this:If you take a peak at dropForeign source, it will build the foreign key index name for you if you pass the column name as an array.It turns out; when you create a foreign key like this:Laravel uniquely names the foreign key reference like this:Therefore, when you want to drop a column with foreign key reference, you have to do it like this:Laravel 4.2+ introduces a new naming convention:I had multiple foreign keys in my table and then I had to remove foreign key constraints one by one by passing column name as index of the array in down method:Using below statement does not workBecause dropForeign does not consider them seperate columns that we want to remove. So we have to drop them one by one.Pass an array with col nameThe key (for me) to solving this was to make sure that the $table->dropForeign() command was being passed the right relationship name, not necessarily the column name. You do not want to pass the column name, as would be much more intuitive IMHO.What worked for me was:So the string I passed to dropForeign() that worked for me was in the format of:[local table]_[foreign key field]_foreignIf you have access to a tool like Sequel Pro or Navicat, being able to visualize those will be very helpful.Something that occurred to me was that I didn't know where to put the Schema::table block. Later I discovered that the key is on the SQL error: So the Schema::table block needs to go in the down() function of the lu_benefits_categories migration and before the Schema::dropIfExists line:After that, the php artisan migrate:refresh or php artisan migrate:reset will do the trick.

Laravel back button

cosapostolo

[Laravel back button](https://stackoverflow.com/questions/12333739/laravel-back-button)

I am trying to create a simple back button on a page. The user can arrive to this page from two different pages so I would like to know from which page he arrived. Is that possible?

2012-09-08 19:21:20Z

I am trying to create a simple back button on a page. The user can arrive to this page from two different pages so I would like to know from which page he arrived. Is that possible?In Laravel, you can do something like this: <a href="{{Request::referrer()}}">Back</a> (assuming you're using blade).  In Laravel 4Laravel documentationI know this is an oldish question but I found it whilst looking for the same solution. The solution above doesn't appear to work in Laravel 4, you can however use this now:Hope this helps people who look for this feature in L4(Source: https://github.com/laravel/framework/pull/501/commits)Laravel 5.2+, back buttonThe following is a complete Blade (the templating engine Laravel uses) solution:The options array with the class is optional, in this case it specifies the styling for a Bootstrap 3 button.Indeed using {{ URL:previous() }} do work, but if you're using a same named route to display multiple views, it will take you back to the first endpoint of this route.In my case, I have a named route, which based on a parameter selected by the user, can render 3 different views. Of course, I have a default case for the first enter in this route, when the user doesn't selected any option yet.When I use URL:previous(), Laravel take me back to the default view, even if the user has selected some other option. Only using javascript inside the button I accomplished to be returned to the correct view:I'm tested this on Laravel 5.3, just for clarification.On 5.1 I could only get this to work.One of the below solve your problemotherYou can use javascript for this provblem. 

It's retrieve link from browser history.

Accessing Laravel .env variables in blade

Anna Jeanine

[Accessing Laravel .env variables in blade](https://stackoverflow.com/questions/43040967/accessing-laravel-env-variables-in-blade)

I am trying to get some API keys which I have stored in my .env file to use in the blade javascript. I have added two keys like:   In blade I need to use the Google Maps API and OverheidIO API key. I have tried getting one of the default .env variables just in case I have formatted the custom .env variables wrong.:Could someone help me call the google maps api and overheidio api key in the blade? 

2017-03-27 08:05:07Z

I am trying to get some API keys which I have stored in my .env file to use in the blade javascript. I have added two keys like:   In blade I need to use the Google Maps API and OverheidIO API key. I have tried getting one of the default .env variables just in case I have formatted the custom .env variables wrong.:Could someone help me call the google maps api and overheidio api key in the blade? Five most important commands if your Laravel is not working as expected after some modifications in .env or database folder or because of any other modifications.

Here is full explanation:

https://www.youtube.com/watch?v=Q1ynDMC8UGgI have it implemented in the following way:My recommendation is to execute the following command: composer self-updateIf you want to get the environment of the app then try this:I have not tried other variables.VERY IMPORTANTAll env() like: env('APP_ENV') calls WON'T WORK in production (when you use php artisan config:cache)What to use?

 - use env() only in config files

 - use App::environment() for checking the environment (APP_ENV in .env).

 - use config('app.var') for all other env variables, ex. config('app.debug')

 - create own config files for your own ENV variables. Example:

In your .env:example config app/myconfig.phpAccess in your code:More details see HEREIt causes problems to use env() anywhere else than in the config/ folder. Use env in there and then config () in the other parts of the appshould fix itThis command should be written after you edit .env file to access variables in easy way get values here: config/app.php

in blade:in class/controller:i was also having trouble getting value from .env file, then i did this and it helped :Here's a link to the documentation: https://laravel.com/docs/6.x/configuration#retrieving-environment-configurationIn the sample below, I spit out the actual error when I'm in my development environment but give a generic message if in any other environment.

Laravel: Error [PDOException]: Could not Find Driver in PostgreSQL

Hyperion

[Laravel: Error [PDOException]: Could not Find Driver in PostgreSQL](https://stackoverflow.com/questions/25329302/laravel-error-pdoexception-could-not-find-driver-in-postgresql)

I'm trying to connect with PostgreSQL database through Laravel in order to do a php artisan migrate but doesn't seem to be directed since it's reading the database name of MySQL. Here are the commands from database.php:If I remove the MySQL paths I'll get:The extension=pdo_pgsql.dll and extension=pgsql.dll are uncommented.Done the PATH trick in the 'System Variables' and rebooted. No chance. Thanks for the help so far.These are my drivers php_pdo_driver.h & php_pdo.h from C:\Program Files (x86)\PostgreSQL\EnterpriseDB-ApachePHP\php\SDK\include\ext\pdoInformation from phpinfo:

2014-08-15 15:28:37Z

I'm trying to connect with PostgreSQL database through Laravel in order to do a php artisan migrate but doesn't seem to be directed since it's reading the database name of MySQL. Here are the commands from database.php:If I remove the MySQL paths I'll get:The extension=pdo_pgsql.dll and extension=pgsql.dll are uncommented.Done the PATH trick in the 'System Variables' and rebooted. No chance. Thanks for the help so far.These are my drivers php_pdo_driver.h & php_pdo.h from C:\Program Files (x86)\PostgreSQL\EnterpriseDB-ApachePHP\php\SDK\include\ext\pdoInformation from phpinfo:Be sure to configure the 'default' key in app/config/database.phpFor postgres, this would be 'default' => 'postgres',If you are receiving a [PDOException] could not find driver error, check to see if you have the correct PHP extensions installed.  You need pdo_pgsql.so and pgsql.so installed and enabled.  Instructions on how to do this vary between operating systems.  For Windows, the pgsql extensions should come pre-downloaded with the official PHP distribution.  Just edit your php.ini and uncomment the lines extension=pdo_pgsql.so and extension=pgsql.soAlso, in php.ini, make sure extension_dir is set to the proper directory.  It should be a folder called extensions or ext or similar inside your PHP install directory.Finally, copy libpq.dll from C:\wamp\bin\php\php5.*\ into C:\wamp\bin\apache*\bin and restart all services through the WampServer interface.If you still get the exception, you may need to add the postgres \bin directory to your PATH:This should hopefully resolve any problems.  For more information see:For PDOException: could not find driver for MySQL, and if it is Debian based OS,For PHP 7 in Ubuntu you can also do:So, now you can do not uncomment lines in php.iniUPD:

I have a same error, so problem was not in driver.

I changed my database.ini, but every time I saw an error.

And I change database config in .env and errors gone.This worked for me:$ sudo apt-get install php-gd php-mysql

I realize this is an old question but I found it in a Google search so I'm going to go ahead and answer just in case someone else runs across this. I'm on a Mac and had the same issue, but solved it by using HomeBrew. Once you've got it installed, you can just run this command:And replace the 56 with whatever version of PHP you're using without the decimal point.I had the same issue. This is what worked for me.There are 2 php.ini files:NOTE: This is using my version of PHP and Apache, change to what yours are.The php.ini file located in the both folders is what you need to update, the extentions:These are what you need to uncomment (remove the ; symbol).Restart both Wamp and the Command Prompt.Hopefully it will work for you :).For those wanting to use Postgresql on OpenSuse (and co), try the following:Solved after 3 hours... 

I am using WAMP (PHP 7.2.4), PostgreSQL 10, Laravel 5.6.29. 

Loaded PHP extensions (pgsql, pdo_pgsql) from Wampserver 3.3, then I was able to connect to the PostgreSQL server with a simple php testcode from the www directory. But $ php artisan migrate still returned I checked the shell (git bash for windows) with $ php --ini, that returned C:\wamp64\bin\php\php7.2.4\php.ini instead of c:\wamp64\bin\apache\apache2.4.33\bin\php.ini, loaded by WAMP

So you have to uncomment pgsql and pdo_pgsql extensions also in C:\wamp64\bin\php\php7.2.4\php.ini, and then migrate will work ...In Windows 8 PC with Laragon 3.4.0 180809, I faced the same issue. It happened in my case because I updated Laragon and it added a new version of PHP. So in laragon/bin/php/ I actually had two directories:I added 7.1.20 into my PATH variable. But in my Command Console, running php --ini was showing that the path actually was fetching from the older one: php-7.1.7-Win32-VC14-x64. So I deleted the old one (for safety, I put it in Recycle Bin). But Laragon failed to start after that.So, in laragaon/etc/apache2/mod_php.conf, I changed the path to the latest PHP version. Then restarted Laragon and the issue is resolved. 😊Reference: How to add another PHP version - Laragon ForumI got this problem too. I have solved this issue already. If u are using Wamp then perform the following steps.If it does not work, please check your .env and config/database again.I had the same error on PHP 7.3.7 docker with laravel:This works for meThis will install the pgsql and pdo_pgsql drivers.Now run this command to uncomment the lines extension=pdo_pgsql.so and extension=pgsql.so from php.iniOld thread I know,  but I lost a couple of hours of my life with this.  You also need to set the DB info in the .env file.  You don't have to specify the driver here because the default specified in database.php is used (I think).  I was struggling because it had DB_CONNECTION=mysql in the .env file and I was using pgsql.In my case, I had two versions of PHP installed. So all I had to do was use$ /opt/lampp/bin/php artisan serve  instead of $ php artisan serve sudo apt-get -y install php*-mysql ( just run this command ) This worked for me:I am working with 32bit Ubuntu 14I see you are using Windows. I was not able to fix this with enabling any of the extensions that come with my Windows WAMP Server. I tried PDO_ODBC and others and even found the Microsoft Official PDO_SQLSRV. The solution for me was to install the PDO_SQLSRV drivers from a 3rd party website. I found the drivers through 

http://robsphp.blogspot.nl/2012/06/unofficial-microsoft-sql-server-driver.html I usually don't use DLLs from random websites, but I was desperate and this worked for me. Hoping it might save others numerous hours of frustration.Using Laravel V 5.5.39 with Php 7.1.12 is working fine, but later (newer) php versions cause the problem. So, change Php version and you will get the solution 100% .

Laravel: Using try…catch with DB::transaction()

enchance

[Laravel: Using try…catch with DB::transaction()](https://stackoverflow.com/questions/22906844/laravel-using-try-catch-with-dbtransaction)

We all use DB::transaction() for multiple insert queries. In doing so, should a try...catch be placed inside it or wrapping it? Is it even necessary to include a try...catch when a transaction will automatically fail if something goes wrong?Sample try...catch wrapping a transaction:The opposite, a DB::transaction() wrapping a try...catch:Or simply a transaction w/o a try...catch

2014-04-07 08:09:13Z

We all use DB::transaction() for multiple insert queries. In doing so, should a try...catch be placed inside it or wrapping it? Is it even necessary to include a try...catch when a transaction will automatically fail if something goes wrong?Sample try...catch wrapping a transaction:The opposite, a DB::transaction() wrapping a try...catch:Or simply a transaction w/o a try...catchIn the case you need to manually 'exit' a transaction through code (be it through an exception or simply checking an error state) you shouldn't use DB::transaction() but instead wrap your code in DB::beginTransaction and DB::commit/DB::rollback():See the transaction docs.If you use PHP7, use Throwable in catch for catching user exceptions and fatal errors.For example:If your code must be compartable with PHP5, use Exception and Throwable:You could wrapping the transaction over try..catch or even reverse them,

here my example code I used to in laravel 5,, if you look deep inside DB:transaction() in Illuminate\Database\Connection that the same like you write manual transaction.Laravel Transactionso you could write your code like this, and handle your exception like throw message back into your form via flash or redirect to another page. REMEMBER return inside closure is returned in transaction() so if you return redirect()->back() it won't redirect immediately, because the it returned at variable which handle the transaction.Wrap Transactionthen the alternative is throw boolean variable and handle redirect outside transaction function or if your need to retrieve why transaction failed you can get it from $e->getMessage() inside catch(Exception $e){...} I've decided to give an answer to this question because I think it can be solved using a simpler syntax than the convoluted try-catch block. The Laravel documentation is pretty brief on this subject.Instead of using try-catch, you can just use the DB::transaction(){...} wrapper like this:You should then see that the User and the Log record cannot exist without eachother.Some notes on the implementation above:Tested on Laravel 5.8

Laravel 5.2 - Use a String as a Custom Primary Key for Eloquent Table becomes 0

Abrar Jahin

[Laravel 5.2 - Use a String as a Custom Primary Key for Eloquent Table becomes 0](https://stackoverflow.com/questions/34582535/laravel-5-2-use-a-string-as-a-custom-primary-key-for-eloquent-table-becomes-0)

I am trying to use email as my table's primary key, so my eloquent code is-And my DB is like this-but if I do this-I am getting this-So, the verification token/primary key becomes 0.Can anyone please help?

2016-01-03 22:48:33Z

I am trying to use email as my table's primary key, so my eloquent code is-And my DB is like this-but if I do this-I am getting this-So, the verification token/primary key becomes 0.Can anyone please help?This was added to the upgrade documentation on Dec 29, 2015, so if you upgraded before then you probably missed it.When fetching any attribute from the model it checks if that column should be cast as an integer, string, etc.By default, for auto-incrementing tables, the ID is assumed to be an integer in this method:https://github.com/laravel/framework/blob/5.2/src/Illuminate/Database/Eloquent/Model.php#L2790So the solution is:On the model set $incrementing to falseThis will stop it from thinking it is an auto increment field.Laravel Docs - Eloquent - Defining ModelsTheres two properties on the model you need to set. The first $primaryKey to tell the model what column to expect the primary key on. The second $incrementing so it knows the primary key isn't a linear auto incrementing value.For more info see the Primary Keys section in the documentation on Eloquent.I was using Postman to test my Laravel API. I received an error that stated I had to enter public $timestamps = false; to my model. Then, I tested again with Postman and saw that an "id" = 0 variable was being created in my database. I finally had to add public $incrementing false; to fix my API.keep using the id and get the email :

Download files in laravel using Response::download

star18bit

[Download files in laravel using Response::download](https://stackoverflow.com/questions/20415444/download-files-in-laravel-using-responsedownload)

In Laravel application I'm trying to achieve a button inside view that can allow user to download file without navigating to any other view or route

Now I have two issues: 

(1) below function throwing (2) Download button should not navigate user to anywhere and rather just download files on a same view, My current settings, routing a view to '/download'Here is how Im trying to achieve: Button:Route :Controller :

2013-12-06 03:33:22Z

In Laravel application I'm trying to achieve a button inside view that can allow user to download file without navigating to any other view or route

Now I have two issues: 

(1) below function throwing (2) Download button should not navigate user to anywhere and rather just download files on a same view, My current settings, routing a view to '/download'Here is how Im trying to achieve: Button:Route :Controller :Try this."./download/info.pdf"will not work as you have to give full physical path.Update 20/05/2016Laravel 5, 5.1, 5.2 or 5.* users can use the following method instead of Response facade. However, my previous answer will work for both Laravel 4 or 5. (the $header array structure change to associative array =>- the colon after 'Content-Type' was deleted - if we don't do those changes then headers will be added in wrong way: the name of header wil be number started from 0,1,...)File downloads are super simple in Laravel 5.As @Ashwani mentioned Laravel 5 allows file downloads with response()->download() to return file for download. We no longer need to mess with any headers. To return a file we simply:from within the controller.Reusable Download Route/ControllerNow let's make a reusable file download route and controller so we can server up any file in our public/files directory.Create the controller:Create the route in app/Http/routes.php:Make download method in app/Http/Controllers/DownloadsController:Now simply drops some files in the public/files directory and you can server them up by linking to /download/filename.ext:If you pulled in Laravel Collective's Html package you can use the Html facade:In the accepted answer, for Laravel 4 the headers array is constructed incorrectly. Use:Quite a few of these solutions suggest referencing the public_path() of the Laravel application in order to locate the file. Sometimes you'll want to control access to the file or offer real-time monitoring of the file. In this case, you'll want to keep the directory private and limit access by a method in a controller class. The following method should help with this:There are other paths that you could use as well, described on

Laravel's helper functions documentationWhile using laravel 5 use this code as you don`t need headers.return response()->download($pathToFile); .If you are using Fileentry you can use below function for downloading.// Try this to download any file. laravel 5.*// you need to use facade "use Illuminate\Http\Response;" I think that you can use With this you be sure that is a pdf.This is html part  This is Route :This is function : If you want to use the JavaScript download functionality then you can also doAlso remember to paste the info.pdf file in your public directory of your projectyou can use simply inside your controller:

return response()->download($filePath);

Happy coding :)

Laravel - Pass more than one variable to view

pjmil

[Laravel - Pass more than one variable to view](https://stackoverflow.com/questions/20110757/laravel-pass-more-than-one-variable-to-view)

I have this site and one of its pages creates a simple list of people from the database. I need to add one specific person to a variable I can access.How do I modify the return $view->with('persons', $persons); line to also pass the $ms variable to the view? 

2013-11-21 01:31:00Z

I have this site and one of its pages creates a simple list of people from the database. I need to add one specific person to a variable I can access.How do I modify the return $view->with('persons', $persons); line to also pass the $ms variable to the view? Just pass it as an array:Or chain them, like @Antonio mentioned.This is how you do it:You can also use compact():Or do it in one line:Or even send it as an array:But, in this case, you would have to access them this way:Passing multiple variables to a Laravel viewRead here about Passing Data to Views in LaravelCame across a similar problem, but if you do not necessarily want to return a view with view file, you can do this:This Answer seems to be bit helpful while declaring the large numbe of variable in the function Laravel 5.7.*For Example When you see the last line of the returns it not looking goodSo As You see all the variables as declared as array of $viewShareVars and Accessed in Viewthe native php function get_defined_vars() get all the defined variables from the function and array_keys will grab the variable namesso in your view you can access all the declared variable inside the functionas {{$todayPostActive}}Please try this,For passing multiple array data from controller to view, try it. It is working. In this example, I am passing subject details from a table and subject details contain category id, the details like name if category id is fetched from another table category.Its simple :)

change the date format in laravel view page

user3386779

[change the date format in laravel view page](https://stackoverflow.com/questions/40038521/change-the-date-format-in-laravel-view-page)

I want to change the date format which is fetched from database.

now I got  2016-10-01{{$user->from_date}} .I want to change the format 'd-m-y' in laravel 5.3

2016-10-14 08:29:28Z

I want to change the date format which is fetched from database.

now I got  2016-10-01{{$user->from_date}} .I want to change the format 'd-m-y' in laravel 5.3Try this:It will convert date into d-m-Y format.Note: This solution is a general solution that works for php and any of its frameworks. For a Laravel specific method, try the solution provided by Hamelraj.In Laravel use Carbon its good In your Model set:after in your view :worksYou can check Date Mutators: https://laravel.com/docs/5.3/eloquent-mutators#date-mutatorsYou need set in your User model column from_date in $dates array and then you can change format in $dateFormatThe another option is also put this method to your User model:and then in view if you run {{ $user->from_date }} you will be see format that you want.Easy to use date in blade template use Carbon that wayMethod One:Using the strtotime() to time is the best format to change the date to the given format.strtotime() - Parse about any English textual datetime description into a Unix timestampThe function expects to be given a string containing an English date format and will try to parse that format into a Unix timestamp (the number of seconds since January 1 1970 00:00:00 UTC), relative to the timestamp given in now, or the current time if now is not supplied. Example:Output:Method Two:date_format() - Return a new DateTime object, and then format the date:Output:There are 3 ways that you can do:1) Using Laravel Model2) Using PHP strtotime3) Using CarbonI had a similar problem, I wanted to change the format, but I also wanted the flexibility of being able to change the format in the blade template engine too.I, therefore, set my model up as the following:The setToStringFormat will set all the dates to use this format for this model.

The advantage of this for me is that I could have the format that I wanted without the mutator, because with the mutator, the attribute is returned as a string meaning that in the blade template I would have to write something like this if I wanted to change the format in the template:Which isn't very clean.Instead, the attribute is still returned as a Carbon instance, however it is first returned in the desired format.

That means that in the template I could write the following, cleaner, code:In addition to being able to reformat the Carbon instance, I can also call various Carbon methods on the attribute in the template.There is probably an oversight to this approach; I'm going to wager it is not a good idea to specify the string format at the top of the model in case it affects other scripts. From what I have seen so far, that has not happened. It has only changed the default Carbon for that model only.In this instance, it might be a good set the Carbon format back to what it was originally at the bottom of the model script. This is a bodged idea, but it would work for each model to have its own format.

Contrary, if you are having the same format for each model then in your AppServiceProvider instead. That would just keep the code neater and easier to maintain.You can use Carbon::createFromTimestampBLADESometimes changing the date format doesn't work properly, especially in Laravel. So in that case, it's better to use:Then you can avoid error like "1970-01-01"!In Laravel you can add a function inside app/Helper/helper.php likeAnd call this function on any controller like thisHope it helps!

Laravel Escaping All HTML in Blade Template

Dr.Neo

[Laravel Escaping All HTML in Blade Template](https://stackoverflow.com/questions/26023823/laravel-escaping-all-html-in-blade-template)

I'm building a small CMS in Laravel and I tried to show the content (which is stored in the DB). It is showing the HTML tags instead of executing them. Its like there is an auto html_entity_decode for all printed data.I tried to print the content using the curly brace.and triple curly brace.And they give the same result. I need to execute those HTML tags instead of escaping them.

2014-09-24 18:21:02Z

I'm building a small CMS in Laravel and I tried to show the content (which is stored in the DB). It is showing the HTML tags instead of executing them. Its like there is an auto html_entity_decode for all printed data.I tried to print the content using the curly brace.and triple curly brace.And they give the same result. I need to execute those HTML tags instead of escaping them.Change your syntax from {{ }} to {!! !!}.As The Alpha said in a comment above (not an answer so I thought I'd post), in Laravel 5, the {{ }} (previously non-escaped output syntax) has changed to {!! !!}. Replace {{ }}  with {!! !!} and it should work.use this tag {!! description text !!}Include the content in {!  !} .I had the same issue. Thanks for the answers above, I solved my issue. If there are people facing the same problem, here is two way to solve it:I hope it helps.There is no problem with displaying HTML code in blade templates.For test, you can add to routes.php only one route:and in hello.blade.php file:For the following code you will get output as on imageSo probably page_desc in your case is not what you expect. But as you see it can be potential dangerous if someone uses for example '` tag so you should probably in your route before assigning to blade template filter some tagsEDITI've also tested it with putting the same code into database:Output is exactly the same in this caseEdit2I also don't know if Pages is your model or it's a vendor model. For example it can have accessor inside:and then when you get page_desc attribute you will get modified page_desc with htmlspecialchars. So if you are sure that data in database is with raw html (not escaped) you should look at this Pages class{{html_entity_decode ($post->content())}} saved the issue for me with Laravel 4.0. Now My HTML content is interpreted as it should. 

Laravel 5 Class 'form' not found

Dan Hastings

[Laravel 5 Class 'form' not found](https://stackoverflow.com/questions/28753767/laravel-5-class-form-not-found)

I have added "illuminate/html": "5.*" to composer.json and ran "composer update".I ran this command in the root of the website. I modified the composer.json file in /root/.composer... and in the root of the project and neither have made a difference.This downloaded the class and it seemed to install. I have added the following to file config/app.php.I think I have an idea what is wrong, but I don’t know how to fix it. My install is in '/var/www/website'. I have checked the file path and the Html folder does not exist.I was able to find the class files, but in a different directory.I manually copied the files over to the main Laravel illuminate/html folder, but this hasn't worked either.

2015-02-26 22:12:44Z

I have added "illuminate/html": "5.*" to composer.json and ran "composer update".I ran this command in the root of the website. I modified the composer.json file in /root/.composer... and in the root of the project and neither have made a difference.This downloaded the class and it seemed to install. I have added the following to file config/app.php.I think I have an idea what is wrong, but I don’t know how to fix it. My install is in '/var/www/website'. I have checked the file path and the Html folder does not exist.I was able to find the class files, but in a different directory.I manually copied the files over to the main Laravel illuminate/html folder, but this hasn't worked either.This may not be the answer you're looking for, but I'd recommend using the now community maintained repository Laravel Collective Forms & HTML as the main repositories have been deprecated.Laravel Collective is in the process of updating their website.  You may view the documentation on GitHub if needed.Form isn't included in laravel 5.0 as it was on 4.0, steps to include it:Begin by installing laravelcollective/html package through Composer. Edit your project's composer.json file to require:  Next, update composer from the Terminal:Next, add your new provider to the providers array of config/app.php:Finally, add two class aliases to the aliases array of config/app.php:At this point, Form should be working  SourceUpdate Laravel 5.8 (2019-04-05):   In Laravel 5.8, the providers in the config/app.php can be declared as:instead of: This notation is the same for the aliases.You can also try running the following commands in Terminal or Command:The above worked for me.Just type the following command in terminal at the project directory and installation is done according the Laravel version:Then add these lines in config/app.phpThere is an update to this for Laravel 5.2.  Notice this is a slightly different format from what is indicated above.Begin by installing this package through Composer. Edit your project's composer.json file to require laravelcollective/html.Next, update Composer from the Terminal:Next, add your new provider to the providers array of config/app.php:Finally, add two class aliases to the aliases array of config/app.php:After making this update this code worked for me on a new installation of Laravel 5.2:I got this information here: https://laravelcollective.com/docs/5.2/htmlBegin by installing this package through Composer. Run the following from the terminal:Next, add your new provider to the providers array of config/app.php:Finally, add two class aliases to the aliases array of config/app.php:SRC:https://laravelcollective.com/docs/5.3/htmlIn Laravel Version - 4, HTML and Form existed, but not now.Why:The only reason is they have collected some user requirements and they want it more lightweight and so they removed it as in the sense that a user can add it manually.What to do to add HTML & Forms in Laravel 5.2 or 5.3:For 5.2:Go to the Laravel Collective site and installation processes have demonstrated their.Like for 5.2: on the command line, run the commandThen, in the provider array which is in config/app.php. Add this line at last using a comma(,):For using HTML and FORM text we need to alias them in the aliases array of config/app.php. Add the two lines at the lastAnd for 5.3:Just run the commandAnd the rest of the procedure is like 5.2.Then you can use Laravel Form and other HTML links in your projects. For this, follow this documentation:5.2: https://laravelcollective.com/docs/5.2/html5.3:  https://laravelcollective.com/docs/5.3/htmlDemo Code:To open a form, open and close a tag:And for creating label and input text with a Bootstrap form-control class and other use:And for more, use the documentation, https://laravelcollective.com/.Use Form, not form. The capitalization counts.I have tried everything, but only this helped:

Laravel 5.2 - pluck() method returns array

Limon Monte

[Laravel 5.2 - pluck() method returns array](https://stackoverflow.com/questions/34405138/laravel-5-2-pluck-method-returns-array)

I'm trying to upgrade my project L5.1 -> L5.2. In upgrade guide there's one thing which isn't clear for me:That's ok, rename refactoting from lists() to pluck() isn't a problem. But what with useful pluck() method which was in L5.0 and L5.1?From the 5.0 documentation:What is the alternative for old pluck() method in L5.2?UPDATE:Example: L5.1:L5.2:

2015-12-21 22:07:54Z

I'm trying to upgrade my project L5.1 -> L5.2. In upgrade guide there's one thing which isn't clear for me:That's ok, rename refactoting from lists() to pluck() isn't a problem. But what with useful pluck() method which was in L5.0 and L5.1?From the 5.0 documentation:What is the alternative for old pluck() method in L5.2?UPDATE:Example: L5.1:L5.2:The current alternative for pluck() is value().laravel pluck returns an arrayif your query is:then the array is like this (key is the index of the item. auto incremented value):but if you do like this:then the key is actual index in the database. you can set any value as key.To get first occurence, You can either useor use,In the original example, why not use the select() method in your database query?This will be faster than using a PHP framework, for it'll utilize the SQL query to do the row selection for you. For ordinary collections, I don't believe this applies, but since you're using a database...Larvel 5.3: Specifying a Select Clause

Laravel Blade passing variable with string through @include causes error

joeyfb

[Laravel Blade passing variable with string through @include causes error](https://stackoverflow.com/questions/29739745/laravel-blade-passing-variable-with-string-through-include-causes-error)

In Laravel 5.0.27 I am including a view with with a variable and the following code:and I get the following error...I've narrowed down that the error is solely from the "(" in the "mainContent" variable string, and when I remove the "(" the error disappears and everything runs fine. I can't find anything in documentation on this or any similar errors listed online. Does anyone know if this is expected behavior or if this is a bug that should be reported?Thanks so much for your time!

2015-04-20 05:12:20Z

In Laravel 5.0.27 I am including a view with with a variable and the following code:and I get the following error...I've narrowed down that the error is solely from the "(" in the "mainContent" variable string, and when I remove the "(" the error disappears and everything runs fine. I can't find anything in documentation on this or any similar errors listed online. Does anyone know if this is expected behavior or if this is a bug that should be reported?Thanks so much for your time!It's not a bug but a limitation of blade syntax due to regex. Solution came from github:In 5.8v, included views inherit all variables from the parent as per in documentation:

Calling other function in the same controller?

Himmators

[Calling other function in the same controller?](https://stackoverflow.com/questions/17861412/calling-other-function-in-the-same-controller)

I've this controller, and the function read($q) return error Call to undefined function sendRequest()I'm assuming it's because I'm referencing the function in the wrong manner, but I can't find any explanations for how to do it.

2013-07-25 14:49:56Z

I've this controller, and the function read($q) return error Call to undefined function sendRequest()I'm assuming it's because I'm referencing the function in the wrong manner, but I can't find any explanations for how to do it.Try:Since PHP is not a pure Object-Orieneted language, it interprets sendRequest() as an attempt to invoke a globally defined function (just like nl2br() for example), but since your function is part of a class ('InstagramController'), you need to use $this to point the interpreter in the right direction.Yes. Problem is in wrong notation. Use:Instead. Or for static methods. Also read this for getting idea of OOP - http://www.php.net/manual/en/language.oop5.basic.php

Laravel Migration table already exists but i want to add new not the older

MD. Atiqur Rahman

[Laravel Migration table already exists but i want to add new not the older](https://stackoverflow.com/questions/26077458/laravel-migration-table-already-exists-but-i-want-to-add-new-not-the-older)

I previously created users table. Now I have created a new migration to create a new books table inside my schema. When I try to run the commandIt shows: Here is my new migration table:How can I get rid of the error?

2014-09-27 17:45:31Z

I previously created users table. Now I have created a new migration to create a new books table inside my schema. When I try to run the commandIt shows: Here is my new migration table:How can I get rid of the error?You need to runif that also fails just go in and drop all the tables which you may have to do as it seems your migration table is messed up or your user table when you ran a previous rollback did not drop the table.EDIT:The reason this happens is that you ran a rollback previously and it had some error in the code or did not drop the table. This still however messes up the laravel migration table and as far as it's concerned you now have no record of pushing the user table up. The user table does already exist however and this error is throw.In v5.x, you might still face the problem. So, try to delete related table manually first usingphp artisan tinkerThenSchema::drop('books')(and exit with q)Now, you can successfully php artisan migrate:rollback and php artisan migrate.If this happens repeatedly you should check that the down() method in your migration is showing the right table name. (Can be a gotcha if you've changed your table names.)I had the same trouble. The reason is that your file name in migrations folder does not match with name of migration in your database (see migrations table). They should be the same.You can use

    php artisan migrate:fresh 

to drop all tables and migrate then.

Hope it helpsAlso u may insert befor

Schema::create('books', function(Blueprint $table) the following code Schema::drop('books');EDIT: (for laravel)Just Came across this issue while working on a project in laravel. My tables were messed up, needed to frequent changes on columns. Once the tables were there I wasn't able to run php artisan migrate anymore.I've done following to get rid of the issue-Previous Comment, regarding lumen[Well, pretty late to the party (and possibly a different party than what I was looking for). I banged my head, screamed out loud and by the grace of gray skull just found a solution.]I'm developing an restful app using lumen and I'm new to it. This is my first project/experiment using laraval and lumen. My dependencies-Anyway, everything was fine until yesterday night but suddenly phpunit started complaining about an already existed table.Duh! Items table should exist in the database, or else how am i supposed to save items! Anyway the problem only persisted in the test classes, but strangely not in the browser (I checked with chrome, firefox and postman altering headers). I was getting JSON responses with data as expected.I dropped the database and recreated it with lots of migrate, refresh, rollback. Everything was fine but in phpunit.Out of desperation I removed my migration files (of course I took a backup first ) then hit phpunit in the terminal. Same thing all over again.Suddenly I remembered that I put a different database name in the phpunit.xml file for testing purpose only. I checked that database and guess what! There was a table named items. I removed this table manually, run phpunit, everything started working just fine.I'm documenting my experience for future references only and with hope this might help someone in future.I inherited some real bad code from someone who wasn't using migrations!?, so manually pasted the filenames into the migrations, forgetting to remove the trailing .phpSo that caused the 'table exists' error despite the filename and migration matching.2018_05_07_142737_create_users_table.php - WRONG

2018_05_07_142737_create_users_table - CORRECTYou can delete all the tables but it will be not a good practice, instead try this commandMake sure to use the naming convention correctly. I have tested this in version laravel 5.7

It is important to not try this command when your site is on server because it drops all information.I had a similar problem after messing with foreign key constraints. One of my tables (notes) was gone and one kept coming back (tasks) even after dropping it in MySQL, preventing me from running: php artisan migrate/refresh/reset, which produced the above 42s01 exception.What I did to solve it was ssh into vagrant then go into MySQL (vagrant ssh, mysql -u homestead -p secret), then: DROP DATABASE homestead; Then CREATE DATABASE homestead; Then exit mysql and run:php artisan migrate`.Obviously this solution will not work for people not using vagrant/homestead.

Not claiming in any way this is a proper workflow but it solved my problem which looks a lot like the above one. I think my answer will help more. I faced this error also. Then I deleted specific migration file and tried to recreate by php artisan. But before get this point 1 or 2 days ago while I was watching laracast videos about migation, I was thinking rollback and migrate specific table. For some reason I deleted specific migration file and tried recreate but doing so I got:When I check that file I saw the line below at top of array in the autoload_classmap.php file:Altough rollback or delete a migration file, the record related with the migration file remains in the composer autoload_classmap.php file. To solve this problem, I have found composer command below from somewhere I can't remember.When I rand this code, the line related with the migration file that I deleted is gone. Then I ran:Finally I recreated my migration file with same nameyou drop all tabel in your database, then edit your migration file php artisan migrate again ^_^done your table !!After rollback check your tables , be sure of deletion.If there is a problem delete tables manually from database application like phpmyadmin ( I'm using sequel pro for mac ).Correct your down methods in the migration .Note : Do rollback then migrate .. Don't use migrate:refresh to notice where is the error been .After that you may test with new db for testing. to detect where is the problem.Also try reading this questiongo to phpmyadmin  and drop the database that you created for laravel then create it again then go to cmd(if use windows) root project and type php artisan migrateYou can always check for a table existence before creating it.Check solution: Laravel Official Solution As outlined in the Migrations guide to fix this all you have to do is edit your app\Providers\AppServiceProvider.php file and inside the boot method set a default string length:After above command you need to delete all remaining tables manually and then run the command:First drop the users table in the database.Then go to command propmt and type php artisan migrateall sets.I think this answer helps.Add this to AppServiceProvider.php2014_10_12_100000_create_password_resets_table.php2014_10_12_000000_create_users_table.phpI solved your problem by deleting the "user" table in sequel-pro (there is no data in my user table) and then you can run php artisan migrateHere are before and after screen shotsbefore I delete the user table userafter I delete the table user

I think this happens because the latest laravel class (at 12th February 2018) has removed the function of ->index() and ->unique()In laravel 5.4, If you are having this issue.  Check this link-or-Go to this page in app/Providers/AppServiceProvider.php

and add code down belowEdit AppServiceProvider.php will be found at app/Providers/AppServiceProvider.php and addThen run On your terminal.

It helped me, may be it will work for you as well.Drop all database table and run this line in your project path via CMDI also had this issue, just came across this answer on a Youtube Video. Not sure if it's ideal, but it's the best I've seen.Seems the AppServiceProvider.php file of the providers directory by giving the Schema a length. In this case 191. Works like magic.Screenshot. He then ran: php artisan migrate:fresh. Hope this works.I had the same issue, the problem is in the name saved in the table migrations inside database, because in my database exists 2017_10_18_200000_name and in files 2016_10_18_200000_name, after change the name of file that work.First check the migrations table in your DB and sure that your migration files in database folder in your project is equal to this table data. Sometimes if you create migration files by manual appear this error when run migrate command in composer.DANGER - most of these answers will wipe your database and is not recommended for production use.It's clear there are a lot of "solutions" for this problem, but all these solutions I read through are very destructive solutions and none of them work for a production database. Based on the number of solutions, it also seems that there could be several causes to this error. My error was being caused by a missing entry in my migrations table. I'm not sure exactly how it happened but by adding it back in I no longer received the error.Solution :Laravel Migration table already exists... ||

It Works in Laravel 5.8 alsoand inside the boot method set a default string length:and openand change it to save all the files and go to command promptAnswer is very straight forward : First take a backup of folder bootstrap/cache.Then delete all the files from bootstrap/cache folder .Now run:Creating a database literally takes seconds.Export your current database in case it has sensitive data.Check your migrations and eliminate all wrong methods in it.Drop database and Re-create database.Then you can return the data previously in the database.

Laravel 5.1 Unknown database type enum requested

karthick

[Laravel 5.1 Unknown database type enum requested](https://stackoverflow.com/questions/33140860/laravel-5-1-unknown-database-type-enum-requested)

While running php artisan migrate, I got the following errorHow to resolve this issue.Code:

2015-10-15 05:52:54Z

While running php artisan migrate, I got the following errorHow to resolve this issue.Code:The official Laravel 5.1 documentation states:It doesn't matter if you're trying to change another column, if the table contains a enum anywhere it won't work. It's a Doctrine DBAL issue.As a workaround you could either drop the column and add a new one (column data will be lost):or use a DB statement:Source: https://github.com/laravel/framework/issues/1186It is a known issue as stated in Laravel 5.1 documentation.It happens when you have a enum column in your database table. Whether you are trying to rename another column, or change another column to nullable, this bug will appear. It's an issue with Doctrine\DBAL. An easy fix for this is to just add this constructor method in your database migration file.This will map all the ENUM columns to VARCHAR(), and the column will accept any string.Credit to @Gmatkowski's answer at https://stackoverflow.com/a/32860409/1193201A real dirty solution, that gets the job done none the less would be toby ading these lines just above line 113Beware that updating vendor files directly is not advisable because in the event the vonder chooses to update the plugin, you changes could be overwrittenYou should not use enum at all. Even with laravel 5.8, problem is not resolved.Thank's to everyone who reminded thatThe official Laravel 5.1 documentation states:Plus you will have the same problem when adding available options into enum column declaration.It brings me to a conclusion that You should use enum with care. or even You should not use enum at all.I cannot vote up any answer that offer to replace enum with string. NO, you need to create a lookup table and replace enum with unsignedInteger as a foreign key.It is a lot of work and you'll be upset doing it without previous unit-test coverage, but this is a right solution.You may be even fired for doing this correctly, because it is taking too long, but, don't worry, you'll find a better job. :)Here is an example of how difficult would it be adding available options into enum column declarationsay you have this:and you need to make more types availableI get rid of this problem by creating a new Migration Class and making my migrations extending from it. Maybe there are multiple ways to make it more "standard" but this is just a very simple case which works perfectly for our team.Then as explained before just extend your migration from itI think the easiest way to fix this issue is adding a mapping type to doctrine.yaml if applicable so that enum will be treated as string.

Consuming my own Laravel API

robjmills

[Consuming my own Laravel API](https://stackoverflow.com/questions/16520691/consuming-my-own-laravel-api)

I'm developing a Laravel 4 app that will make the same CRUD operations on my dataset available through a JSON REST API and a Web UI. It seems that to prevent breaking the DRY principle that my UI should consume my own API by routing all requests from the UI back to the API. I'm unsure though about the best approach to making this work. Presumably I would have separate UI and API controllers and somehow route the requests through. Or should I be looking at a different approach altogether?Thanks.

2013-05-13 11:12:27Z

I'm developing a Laravel 4 app that will make the same CRUD operations on my dataset available through a JSON REST API and a Web UI. It seems that to prevent breaking the DRY principle that my UI should consume my own API by routing all requests from the UI back to the API. I'm unsure though about the best approach to making this work. Presumably I would have separate UI and API controllers and somehow route the requests through. Or should I be looking at a different approach altogether?Thanks.I'm actually tinkering with the same idea and it's pretty neat. With Laravel you do have the ability to make internal requests (some might refer to this as HMVC, but I won't). Here's the basics of an internal request.$response will now contain the returned response of the API. Typically this will be returned a JSON encoded string which is great for clients, but not that great for an internal API request. You'll have to extend a few things here but basically the idea is to return the actual object back through for the internal call, and for external requests return the formatted JSON response. You can make use of things like $response->getOriginalContent() here for this kind of thing.What you should look at doing is constructing some sort of internal Dispatcher that allows you to dispatch API requests and return the original object. The dispatcher should also handle malformed requests or bad responses and throw exceptions to match.The idea itself is solid. But planning an API is hard work. I'd recommend you write up a good list of all your expected endpoints and draft a couple of API versions then select the best one.NOTE: As vcardillo pointed out below, route filters are not called with these methods.I am currently doing the same thing, and Jason's answer got me going in a great direction. Looking at the Symfony\Component\HttpFoundation\Request documentation, I figured out how to POST, as well as everything else I'd need to do. Assuming you're using a form, here is some code that could help you:GET:POST:POST w/ cookiesPOST w/ filesI hope this helps someone else. If you aren't using a form, or you are but not using Laravel's Input / Cookie facade, replace the Input / Cookie facades with your own content.Taylor Otwell suggested using app()->handle() rather than Route::dispatch() to achieve a clean request.For Route::dispatch($request) I noticed if the endpoint of your non-GET request (parameters on the HTTP request body) uses a dependency injected \Illuminate\Http\Request or \Illuminate\Foundation\Http\FormRequest extending instance, state of the parameters, cookies, files, etc. are from the original HTTP request. i.e., for your application's controller action method.If parameter names and post method type for your app controller and API controller are the same, you won't notice the difference since the original parameter values are passed on. But when you're manually assembling the 3rd parameter of Request::create(), Route::dispatch() will result in it being ignored.app()->handle() fixes that context problem in the Laravel request lifecycle.Caveat: app()->handle() affects  Illuminate\Support\Facades\Request, refreshing it with this new request instance. As a knock-on effect, calls like Request::isXmlHttpRequest() or redirect()->back() invoked after app()->handle() will cause unpredictable behaviour. I'd suggest tracking the context of your original request and instead use redirect()->to(route('...')) so you strictly control flow and state of your app.Given all these corner cases, it may be best to just do a manual curl using a Guzzle HTTP client.If you're consuming your own API, use app()->handle() instead of Route::dispatch() as Derek MacDonald has suggested.app()->handle() creates a fresh request, while Route::dispatch() runs the route within the stack, effectively ignoring parameters that are part of the request that you're sending.Edit: Just a heads-up. Taylor Otwell advises against using sub-requests to make internal API calls, as they mess the current route. You can an HTTP API client like Guzzle instead to make the API calls.If you are looking for using passport login api internally, then you need to add the parameters to original request:You can use Optimus API consumer, the API is clean and simple, example making an internal request:In it's core, it uses Illuminate\Routing\Router and Illuminate\Http\Request to make the callIf you are looking for using passport login api internally, then you need to add the parameters to original request:

Laravel Mail::send() sending to multiple to or bcc addresses

haakym

[Laravel Mail::send() sending to multiple to or bcc addresses](https://stackoverflow.com/questions/26584904/laravel-mailsend-sending-to-multiple-to-or-bcc-addresses)

I can't seem to successfully send to multiple addresses when using Laravel's Mail::send() callback, the code does however work when I only specify one recipient.I've tried chaining:and passing an array:but neither seem to work and I get failure messages when returning Mail::failures(), a var_dump() of Mail::failures() shows the email addresses that I tried to send to, for example:Clearly doing something wrong, would appreciate any help as I'm not understanding the API either: http://laravel.com/api/4.2/Illuminate/Mail/Message.html#method_toI realise I could put the Mail::send() method in a for/foreach loop and Mail::send() for each email address, but this doesn't appear to me to be the optimal solution, I was hoping I would also be able to ->bcc() to all addresses once everything was working so the recipients wouldn't see who else the mail is being sent to.

2014-10-27 09:55:40Z

I can't seem to successfully send to multiple addresses when using Laravel's Mail::send() callback, the code does however work when I only specify one recipient.I've tried chaining:and passing an array:but neither seem to work and I get failure messages when returning Mail::failures(), a var_dump() of Mail::failures() shows the email addresses that I tried to send to, for example:Clearly doing something wrong, would appreciate any help as I'm not understanding the API either: http://laravel.com/api/4.2/Illuminate/Mail/Message.html#method_toI realise I could put the Mail::send() method in a for/foreach loop and Mail::send() for each email address, but this doesn't appear to me to be the optimal solution, I was hoping I would also be able to ->bcc() to all addresses once everything was working so the recipients wouldn't see who else the mail is being sent to.I've tested it using the following code:Result - empty array for failures.But of course you need to configure your app/config/mail.php properly. So first make sure you can send e-mail just to one user and then test your code with many users. Moreover using this simple code none of my e-mails were delivered to free mail accounts, I got only emails to inboxes that I have on my paid hosting accounts, so probably they were caught by some filters (it's maybe simple topic/content issue but I mentioned it just in case you haven't received some of e-mails) .If you want to send emails simultaneously to all the admins, you can do something like this:In your .env file add all the emails as comma separated values:so when you going to send the email just do this (yes! the 'to' method of message builder instance accepts an array):So,and...will now send the mail to all the admins.the accepted answer does not work any longer with laravel 5.3 because mailable tries to access ->email and results in a working code for laravel 5.3 is this:   With Laravel 5.6, if you want pass multiple emails with names, you need to pass array of associative arrays. Example pushing multiple recipients into the $to array:Fixed two recipients:The 'name' key is not mandatory. You can set it to 'name' => NULL or do not add to the associative array, then only 'email' will be used.In a scenario where you intend to push a single email to different recipients at one instance (i.e CC multiple email addresses), the solution below works fine with Laravel 5.4 and above.where document is any class that further customizes your email.This works great - i have access to the request object and the email arrayI am using Laravel 5.6 and the Notifications Facade.If I set a variable with comma separating the e-mails and try to send it, I get the error:

"Address in mail given does not comply with RFC 2822, 3.6.2"So, to solve the problem, I got the solution idea from @Toskan, coding the following.It worked for me to send to one or many recipients. 😉it works for me fine,

if you a have string, then simply explode it first. $emails = array();

Laravel Socialite: InvalidStateException

rap-2-h

[Laravel Socialite: InvalidStateException](https://stackoverflow.com/questions/30660847/laravel-socialite-invalidstateexception)

I'm using Laravel Socialite to add a Facebook connect button on a website. Sometimes, I've got this error on callback:I don't know what it mean and did not found anything yet about this error. The real problem is it seems to be a random exception (don't understood why it happens). So what this error means and how to avoid it?It seems it's not the same problem as Laravel 5 geting InvalidStateException in AbstractProvider.php, cause in my case it's random.

2015-06-05 07:32:50Z

I'm using Laravel Socialite to add a Facebook connect button on a website. Sometimes, I've got this error on callback:I don't know what it mean and did not found anything yet about this error. The real problem is it seems to be a random exception (don't understood why it happens). So what this error means and how to avoid it?It seems it's not the same problem as Laravel 5 geting InvalidStateException in AbstractProvider.php, cause in my case it's random.I ran into this issue last night and solve it with the following solution.More information on my issue, I've got in the function handleProviderCallback() when it re-direct back from Facebook login. It seems to be the same as your issue.Furthermore I found my issue occurs when I open my site without www. When I open my site with www.mysite.com - no problem. At first I think my issue is random until I've got the clue by Chris Townsend's reply to the question - Thank you very much.The SolutionBe sure to delete your cookies from browser when testing it after these modifications are done. Old cookies can still produce problems.Resolved :tl;drIf you need to read a given parameter state returned by a thirdparty service, you can set Socialite to avoid this checking with the stateless method:I think Socialite is already prepared to avoid this issue.https://github.com/laravel/socialite/blob/2.0/src/Two/AbstractProvider.php#L77https://github.com/laravel/socialite/blob/2.0/src/Two/AbstractProvider.php#L374https://github.com/laravel/socialite/blob/2.0/src/Two/AbstractProvider.php#L222For instance, state is very useful to pass data throught google:ref: https://developers.google.com/identity/protocols/OAuth2UserAgent#overviewAlso check access right on your storage/framework/sessions folder. In my case, since this folder is empty in new Laravel project, it has been left out during initially commit to the GIT repository. Afterwards I created it manually on production server, but obviously with the wrong access rights, hence it was not writable for the session driver (when set to 'file').I was only experiencing this error when logging in via mobile web with the facebook app instead of facebook in browser. The facebook app uses the facebook browser after login instead of your current browser, so is unaware of previous state.In my case it was caused by missing parameters in $fillable array in User class. When i added all missing parameters, it started to work properly..I've got same happen only when I open my web on mobile and open the dialog by facebook application on my phone.I think:

This happen because open facebook app to get response from Facebook API make we lost some cookie. it's become stateless.

Then I just use the option that socialite are already made to avoid stateless request.It's worked to me. hope it help you I had the same problem and I just cleared the cache to solve this problem. I just ran this command and started the process again.I hope this answer may help someone.this solved it for me 

$request->session()->put('state',Str::random(40));

$user = Socialite::driver('github')->stateless()->user();If you still need help you can use my code, it works for me. You just need to create two routes and update the users table. Don't forget to make password nullable, since you won't get one from the facebook users

The code in my controller:I fixed this just disabling the SESSION DRIVER as database... file driver worked fine for me after hours trying to fix this s...I had a similar issue, I've gotin the function handleProviderCallback() when it re-directs back from Facebook login. It seems to be the same as your issue.Furthermore I found my issue occurs when I open my site without www. When I open my site with www.mysite.com - no problem. At first I think my issue is random until I've got the clue by Chris Townsend's reply to the question.The SolutionGo to your www root, check the laravel file config/session.php. Check session Session Cookie Domain. The default configuration is I made a change to After php artisan cache:clear and composer dump-autoload, I can login with no issue from both www.mysite.com and mysite.comBe sure to delete your cookies from browser when testing it after these modifications are done. Old cookies can still produce problems.Got the Solution - Update November 2018On your Controller within the callback() method$user = $service->createOrGetUser(Socialite::driver('facebook')->user());$user = $service->createOrGetUser(Socialite::driver('facebook')->stateless()->user());Laravel 6.16.0

php 7.4.2I came across this exact issue. Turns out I recently changed same_site to strict and socialite was throwing InvalidStateException exception. Then I changed it to back to null and all worked fine.This issue has nothing to do with a lot of the solutions above, is rather as simple as changing your callback URL from 'http://localhost:8000/callback/twitter to http://127.0.0.1:8000/callback/twitter in your config/services.php and on your twitter app set up on your twitter application.the http://localhost in the URL is the issue, replace with http://127.0.0.1I want to share you my solution . I go to my AbstractProvider.php file and in the line of problem I stop the throw new InvalidStateException and call the redirect function like that:

Laravel 5 Querying with relations causes「Call to a member function addEagerConstraints() on null」error

Tomkarho

[Laravel 5 Querying with relations causes「Call to a member function addEagerConstraints() on null」error](https://stackoverflow.com/questions/31546081/laravel-5-querying-with-relations-causes-call-to-a-member-function-addeagercons)

I have been trying to create a simple user management system but keep on hitting road blocks when it comes to querying relations.  For example I have users and roles and whenever I try to make a query for all users and their roles I get an error.  The one in the title is only the latest one I've encountered.My User and Role Models look like this:My migration table for many-to-many relationship between the two looks like this:And then I try to get all records with their relation in a controller:So I need another pair of eyes to tell me what is it I am missing here?

2015-07-21 17:44:50Z

I have been trying to create a simple user management system but keep on hitting road blocks when it comes to querying relations.  For example I have users and roles and whenever I try to make a query for all users and their roles I get an error.  The one in the title is only the latest one I've encountered.My User and Role Models look like this:My migration table for many-to-many relationship between the two looks like this:And then I try to get all records with their relation in a controller:So I need another pair of eyes to tell me what is it I am missing here?You are missing return statements in the methods that define relations. They need to return relation definition.ReplaceWith

Laravel - Using (:any?) wildcard for ALL routes?

qwerty

[Laravel - Using (:any?) wildcard for ALL routes?](https://stackoverflow.com/questions/13297278/laravel-using-any-wildcard-for-all-routes)

I am having a bit of trouble with the routing.I'm working on a CMS, and i need two primary routes. /admin and /(:any). The admin controller is used for the route /admin, and the view controller should be used for anything else than /admin. From the view controller, i will then parse the url and show the correct content.This is what i have:The first route works, but the second one doesn't. I played around with it a little bit, and it seems if i use (:any) without the question mark, it only works if i put something after /. If i do put the question mark there, it doesn't work at all.I want all of the following routes to go to view@index:Is this possible without hardcoding a bunch of (:any?)/(:any?)/(:any?)/(:any?) (which i don't even know works)?What's the best way to go about this?

2012-11-08 20:29:31Z

I am having a bit of trouble with the routing.I'm working on a CMS, and i need two primary routes. /admin and /(:any). The admin controller is used for the route /admin, and the view controller should be used for anything else than /admin. From the view controller, i will then parse the url and show the correct content.This is what i have:The first route works, but the second one doesn't. I played around with it a little bit, and it seems if i use (:any) without the question mark, it only works if i put something after /. If i do put the question mark there, it doesn't work at all.I want all of the following routes to go to view@index:Is this possible without hardcoding a bunch of (:any?)/(:any?)/(:any?)/(:any?) (which i don't even know works)?What's the best way to go about this?Edit: There has been some confusion since the release of Laravel 4 regarding this topic, this answer was targeting Laravel 3.There are a few ways to approach this.The first method is matching (:any)/(:all?):Not the best solution because it gets broken into multiple parameters, and for some reason (:all) doesn't work by itself (bug?)The second solution is to use a regular expression, this is a better way then above in my opinion.There is one more method, which would let you check if there are cms pages even when the route may have matched other patterns, provided those routes returned a 404. This method modifies the event listener defined in routes.php:However, my preferred method is #2. I hope this helps. Whatever you do, make sure you define all your other routes above these catch all routes, any routes defined after will never trigger.This solution works fine on Laravel 5:This is for Lumen instead:Hitting a 404 status seems a bit wrong to me. This can get you in all kind of problems when logging the 404's. I recently bumped into the same wildcard routing problem in Laravel 4 and solved it with the following snippet:This should solve your problem in a controlled way. The regular expression can be simplified to:But you should use this at your own risk.Edit (addition):As this overwrites a lot of routes, you should consider wrapping it in an "App::before" statement:This way, it will not overwrite custom routes you define later on.The above code will capture the recursive sub urls you mentioned:Any other special cases, such as admin/*, you can capture before this one.Add this in the end of routes filefrom http://scotch.io/tutorials/simple-and-easy-laravel-routingJust spelling-out my experience in case it helps someone piece something together.I built a self-API-consuming React app on Laravel.

It has a single view served by Laravel/Lumen.

It uses the React router.

Clicking links in the app always worked, but typing-in URLs needed the following consideration:In Laravel I used the following in my web.php routes file:And everything worked.Then I switched the project to Lumen.

Thanks to this post, I used the following in my web.php routes file:This worked for first level URLS such as:However,did not.I looked in the network tab in Google Developer tools and noticed that the URL for app.js was appending /something in front of app.js on second and higher tier URLS, such as:All I had to do was add a leading slash to my app.js source  in my single view page such as:Instead of:so:This worked in Laravel (It was a Blade file that may have automatically resolved the js/app.js URL)withBut, I had to do this in Lumen (Not a Blade file):withThanks for the solution William. However methods 1 & 2 aren't working anymore Laravel 4, and in order to use solution #3 in Laravel 4 you will have to fire the 404 event in your start/global.php file.Now we can handle this in our routes.php file:Having basic lumen scaffolding. In my case, I have 2 frontend apps and api routes

Laravel Eloquent - Attach vs Sync

Kousha

[Laravel Eloquent - Attach vs Sync](https://stackoverflow.com/questions/23968415/laravel-eloquent-attach-vs-sync)

What is the difference between attach() and sync() in Laravel 4's Eloquent ORM? I've tried to look around but couldn't find anything!

2014-05-31 09:25:16Z

What is the difference between attach() and sync() in Laravel 4's Eloquent ORM? I've tried to look around but couldn't find anything!attach(): Example:sync():Similar to the attach() method, the sync() method is used to attach related models. However, the main differences are:Example:user_roleThe above operation will delete:And insert role_id 3 to the table.user_role tableTo make it even simpler:The attach function only adds records to the Pivot table.The sync function replaces the current records with the new records. This is very useful for updating a model.Example: Assuming you have a created Post that has many Tags attached on it where the Tags ID's are [1,2,3].And the user has the ability to update the Post and its Tags.The user will send you the new Tags ID's [3,4,5]. If you use the sync function, the new Tags of the Post will be [3,4,5] only.If you use the attach function, the new Tags of the Post will be [1,2,3,4,5].

Laravel migration table field's type change

naing linhtut

[Laravel migration table field's type change](https://stackoverflow.com/questions/32940495/laravel-migration-table-fields-type-change)

Following is my file 2015_09_14_051851_create_orders_table.php.

And I want to change $table->integer('category_id'); as a string with new migration.

2015-10-05 02:33:32Z

Following is my file 2015_09_14_051851_create_orders_table.php.

And I want to change $table->integer('category_id'); as a string with new migration.update: 31 Oct 2018, Still usable on laravel 5.7 https://laravel.com/docs/5.7/migrations#modifying-columnsTo make some change to existing db, you can modify column type by using  change() in migration.This is what you could doplease note you need to add doctrine/dbal dependency to composer.json

for more information you can find it here http://laravel.com/docs/5.1/migrations#modifying-columnsThe standard solution didn't work for me, when changing the type from TEXT to LONGTEXT.I had to it like this:This could be a Doctrine issue. More information here.Another way to do it is to use the string() method, and set the value to the text type max length:2018 Solution, still other answers are valid but you dont need to use any dependency:First you have to create a new migration:Then in that migration file up(), try:If you donot change the size default will be varchar(191) but If you want to change size of the field:Then migrate the file by:more info from doc.all other answers are Correct But  Before you runmake sure you run this code first to avoid this error First composer requires doctrine/dbal, then:For me the solution was just replace unsigned with indexThis is the full code:Not really an answer, but just a note about ->change():https://laravel.com/docs/5.8/migrations#modifying-columnsIf your column isn't one of these you will need to either drop the column or use the alter statement as mentioned in other answers.

Get previous attribute value in Eloquent model event

coatesap

[Get previous attribute value in Eloquent model event](https://stackoverflow.com/questions/17367383/get-previous-attribute-value-in-eloquent-model-event)

Is there a way to see the old/previous value of a model's attribute in its saving or updating event?eg. Is something like the following possible:

2013-06-28 14:42:38Z

Is there a way to see the old/previous value of a model's attribute in its saving or updating event?eg. Is something like the following possible:Ok, I found this quite by chance, as it's not in the documentation at present...There is a getOriginal() method available which returns an array of the original attribute values:In Laravel 4.0 and 4.1, you can check with isDirty() method:You could overload the methods, then call the parent method.

Laravel where on relationship object

Lic

[Laravel where on relationship object](https://stackoverflow.com/questions/29989908/laravel-where-on-relationship-object)

I'm developing a web API with Laravel 5.0 but I'm not sure about a specific query I'm trying to build.My classes are as follows:andNow, I want to get all the events with a specific participant.

I tried with:but the where condition is applied on the Event and not on its Participants. The following gives me an exception:I know that I can write this:but it doesn't seem very efficient to send so many queries to the server.What is the best way to perform a where through a model relationship using Laravel 5 and Eloquent?

2015-05-01 15:31:43Z

I'm developing a web API with Laravel 5.0 but I'm not sure about a specific query I'm trying to build.My classes are as follows:andNow, I want to get all the events with a specific participant.

I tried with:but the where condition is applied on the Event and not on its Participants. The following gives me an exception:I know that I can write this:but it doesn't seem very efficient to send so many queries to the server.What is the best way to perform a where through a model relationship using Laravel 5 and Eloquent?The correct syntax to do this on your relations is:Read more at https://laravel.com/docs/5.8/eloquent-relationships#eager-loading@Cermbo's answer is not related to this question. in this answer, Laravel will give you all Events if per Event has 'participants' with IdUser is 1.But if you want to get all Events with all 'participants' provided that per 'partecipants' with IdUser is 1, then you should do something like this :attention to:in where use your table name, no Model name.this worked for me

Laravel use same form for create and edit

Kevin Joymungol

[Laravel use same form for create and edit](https://stackoverflow.com/questions/22844022/laravel-use-same-form-for-create-and-edit)

Am quite new to Laravel and I have to create a form for create and a form for edit. In my form I have quite some jquery ajax posts. Am wondering whether Laravel does provide for an easy way for me to use the same form for my edit and create without having to add tons of logic in my code. I don't want to check if am in edit or create mode every time when assigning values to fields when the form loads. Any ideas on how I can accomplish this with minimum coding?

2014-04-03 16:47:28Z

Am quite new to Laravel and I have to create a form for create and a form for edit. In my form I have quite some jquery ajax posts. Am wondering whether Laravel does provide for an easy way for me to use the same form for my edit and create without having to add tons of logic in my code. I don't want to check if am in edit or create mode every time when assigning values to fields when the form loads. Any ideas on how I can accomplish this with minimum coding?I like to use form model binding so I can easily populate a form's fields with corresponding value, so I follow this approach (using a user model for example):So, for example, from a controller, I basically use the same form for creating and updating, like:Pretty easy in your controller you do:And you just have to use this way:Another clean method with a small controller, two views and a partial view :UsersController.phpcreate.blade.phpedit.blade.php_fields.blade.phpFor the creation add an empty object to the view.Old function has a second parameter, default value, if you pass there the object's field, the input can be reused.For the form action, you can use the correct endpoint.And for the update you have to use PATCH method.Simple and clean :)UserController.phpedit.blade.phpInstead of creating two methods - one for creating new row and one for updating, you should use findOrNew() method. So:In Rails, it has form_for helper, so we could make a function like form_for.We can make a Form macro, for example in resource/macro/html.php:(if you don't know how to setup a macro, you can google "laravel 5 Macro")The Controller:Then in the view _form.blade.php:Then view create.blade.php:Then view edit.blade.php:You can use form binding and 3 methods in your Controller. Here's what I doAnd in my views I have UserController.phpuser.blade.phpFor example, your controller, retrive data and put the viewAdd default value in the same form, create and edit, is very simpleAnd, you remember add csrf_field, in case a POST method requesting. Therefore, repeat input, and select element, compare each option I hope this will help you!!form.blade.phpcreate.blade.phpedit.blade.phpUsersController.php

How to bind parameters to a raw DB query in Laravel that's used on a model?

MarkL

[How to bind parameters to a raw DB query in Laravel that's used on a model?](https://stackoverflow.com/questions/20864872/how-to-bind-parameters-to-a-raw-db-query-in-laravel-thats-used-on-a-model)

Re,I have the following query:It doesn't work: Invalid parameter number: mixed named and positional parameters.Does anyone know a trick or a workaround (I can obviously write the full query but prefer to use fluent builder).

2014-01-01 01:43:55Z

Re,I have the following query:It doesn't work: Invalid parameter number: mixed named and positional parameters.Does anyone know a trick or a workaround (I can obviously write the full query but prefer to use fluent builder).OK, after some experimenting, here's the solution that I came up with:Basically, setBindings has to be called on the query. Wish this was documented!Old question, but if we have to repeat a variable, we have to change its key value in the bindings array.That's enough.why not?I encountered same issue just recently and the answer is in that error message mixed named and positional parameters. In your case, the :lat and :lng are named parameters while you have $radius as positional. So one possible fix to your issue is make use of havingRaw() and apply named parameters. 

--havingRaw('distance < :radius', ['radius' => $radius])

I ported the nearby search from Doctrine v1 to Laravel, check it out here.Just add the Geographical trait to the model then you can do:It works by using selectRaw with bindings like this:

ReflectionException: Class ClassName does not exist - Laravel

Nana Partykar

[ReflectionException: Class ClassName does not exist - Laravel](https://stackoverflow.com/questions/32475892/reflectionexception-class-classname-does-not-exist-laravel)

As soon, I am typing php artisan db:seed command. I'm getting Error Like:root@dd-desktop:/opt/lampp/htdocs/dd/laravel# php artisan db:seedHere, Is my UserTableSeeder.php & DatabaseSeeder.php PageUserTableSeeder.phpDatabaseSeeder.phpI'm Referring This Link To Design & Develop Login Page.

Please Help me to resolve this issue. Thanks.

2015-09-09 09:30:00Z

As soon, I am typing php artisan db:seed command. I'm getting Error Like:root@dd-desktop:/opt/lampp/htdocs/dd/laravel# php artisan db:seedHere, Is my UserTableSeeder.php & DatabaseSeeder.php PageUserTableSeeder.phpDatabaseSeeder.phpI'm Referring This Link To Design & Develop Login Page.

Please Help me to resolve this issue. Thanks.Perform a composer update, then composer dump-autoload.If the above doesn't solve the problem, change the classmap in your composer.json file such that it contains the project-relative path to your php files:and soon after, perform a composer dump-autoload, and it should work now like a breeze!If composer dump-autoload is not found, just enable this option composer config -g -- disable-tls true.From my experience, this will show up most of the time when the class you are trying to call has some bugs and cannot be compiled.  Check if the class that is not being reflected can be executed at its own.A composer dump-autoload should fix it.I had this problem and I could solve it by doing php artisan config:cache.  The problem was that I had already run that command previously and later included some new seeder classes.  The cached configurations didn't recognize the new classes.  So running that command again worked.If you see yourself making frequent changes to include new seeder classes then consider running php artisan config:clear.  This will enable you to make as many changes as you'd like and then after testing you can run config:cache again to make things run optimally again.For some reason I had to run composer dumpautoload -o. Notice flag -o which mean with optimization. I don't have any idea why it works only with it but give it a try. Perhaps it helps someone.I have the same problem with a class. I tried composer dump-autoload and php artisan config:clear but it did not solve my problem.Then I decided to read my code to find the problem and I found the problem. The problem in my case was a missing comma in my class. See my Model code:Check your capitalization!Your host system (Windows or Mac) is case insensitive by default, and Homestead inherits this behavior. Your production server on the other hand is case sensitive.Whenever you get a ClassNotFound Exception check the following:try to use following commandYou need to assign it to a name space for it to be found.I am not writing as the answer for this question. But I want to help others if they faced the same bug but the answers mentioned here not works. I also tried all the solutions mentioned here. But my problem was with the namespace I used. The path was wrong.The namespace I used is:But actually the controller reside inside a folder named 'FrontEnd'so the solution is change the namespace to:This will surely work. 

If not then, you need to do and then, the aforementioned commands. If the issue is not resolved by composer dump-autoload or is not a newly created class.Check for syntax errors in your class and its traits as well.

In my case, there was a syntax error in a Trait, but ReflectionException was shown for the actual Class using that Trait instead.When it is looking for the seeder class file, you can run composer dump-autoload. When you run it again and it's looking for the Model, you can reference it on the seeder file itself. Like so,Not strictly related to the question but received the error ReflectionException: Class config does not existI had added a new .env variable with spaces in it. Running php artisan config:clear told me that any .env variable with spaces in it should be surrounded by "s.Did this and  my application stated working again, no need for config clear as still in development on Laravel Homestead (5.4)I've recreated class, and it worked. Copy all file content, delete file, and run php artisan make:seeder ModelTableSeeder. Because composer dump-autoload didn't worked for me. You may try to write app in use uppercase, so App. Worked for me.this will fix itUsually error message ReflectionException: Class app does not exist appears in larval test when you forget to close connection.if you're using setUp or tearDown function in your test do not forget to close connection by calling parent::setUp and parent::tearDownIn case of using psr-0 , check the class name does not contain underscore .Above command worked for me.Whenever you make new migration in la-ravel you need to refresh classmap in composer.json file .I had this error when trying to reach an endpoint in a custom route file, that had a namespace prepended in RouteServiceProviderUpdating the namespace in the RouteServiceProvider solved the issue, as the relative controller path specified in the routes file was now resolving correctly.

Laravel-5 how to populate select box from database with id value and name value

borracciaBlu

[Laravel-5 how to populate select box from database with id value and name value](https://stackoverflow.com/questions/29508297/laravel-5-how-to-populate-select-box-from-database-with-id-value-and-name-value)

I want to create a select box like the one below using illuminate\html :In my controller I tried this:And in my view this:The issue is that instead of $item->name is displaying all the info of the entity. 

2015-04-08 07:17:38Z

I want to create a select box like the one below using illuminate\html :In my controller I tried this:And in my view this:The issue is that instead of $item->name is displaying all the info of the entity. Laravel provides a Query Builder with lists() functionIn your case, you can replace your codewithAlso, you can chain it with other Query Builder as well.source: http://laravel.com/docs/5.0/queries#selectsUpdate for Laravel 5.2 Thank you very much @jarry. As you mentioned, the function for Laravel 5.2 should beorref: https://laravel.com/docs/5.2/upgrade#upgrade-5.2.0  -- look at Deprecations listsLaravel >= 5.3 method lists() is deprecated use pluck()This will give you a select box with same select options as id numbers in DBfor example if you have this in your DB table: in select box it will be like thisI found out that pluck now returns a collection, and you need to add ->toArray() at the end of pluck...so like this: pluck('name', 'id')->toArray();Just change your controller to the following:And your view to:Hope this will solve your problemControllercompact('campaignStatus') will result in  [id=>status]; //example [1 => 'pending']ViewIn your controller, add,And in your view, useIn select box, it will be like this,Laravel use array for Form::select. So I passed array like below:In your view:Laravel 5.3  use pluck($value, $key )$value is displayed in your drop list and $key is idcontrollerviewLaravel 5.*In your controller:In your view:I have added toArray() after pluckSorry for the late reply Obviously lists method has been deprecated in Laravel, but you can use the pluck method. For Eg:Laravel 5.7and in the view if you are FORM components just pass asif will generate the dropdownbut i have a situation to show that select country as the first option and as null valueso I have referred to and fixed this, but in later times if I want to change this I hate being changing it in the viewSo have created the helper function  based on https://stackoverflow.com/a/51324218/8487424  and placed in the  Country Modeland in controllerand finally in the viewand the result is as expected, but I strongly recommend to use pluck() methodFor Laravel 5 :Push an item onto the beginning of the collection.Many has been said already but keep in mind that there are a times where u don't want to output all the records from the database into your select input field ..... Key example I have been working on this school management site where I have to output all the noticeboard categories in a select statement. From my controller this is the code I wrote Noticeboard:: groupBy()->pluck('category')->get(); This way u get distinct record as they have been grouped so no repetition of recordsTo populate the drop-down select box in laravel we have to follow the below steps.From controller we have to get the value like this:And the same we can display in view:This key value in drop down you can use as per your requirement.

Hope it may help someone.I was trying to do the same thing in Laravel 5.8 and got an error about calling pluck statically. For my solution I used the following. The collection clearly was called todoStatuses.Try this one. Without using controller

Php artisan make:auth command is not defined

naan

[Php artisan make:auth command is not defined](https://stackoverflow.com/questions/34545641/php-artisan-makeauth-command-is-not-defined)

I am trying to run this command in laravel 5.2 but it's not working.and prompts with these statements.

2015-12-31 11:16:08Z

I am trying to run this command in laravel 5.2 but it's not working.and prompts with these statements.For Laravel >=6Reference : Laravel Documentation for authenticationit looks you are not using Laravel 5.2, these are the available make commands in L5.2 and you are missing more than just the make:auth commandBe sure you have this dependency in your composer.json fileThen runUpdate for Laravel 6Now that Laravel 6 is released you need to install laravel/ui.You can change vue with react if you use React in your project (see Using React).And then you need to perform the migrations and compile the frontendSource : Laravel Documentation for authenticationNote: That's only if you want to use scaffolding, you can use the default User model and the Eloquent authentication driver.Update Nov 18th:

Taylor just released Laravel Installer 2.3.0 added a new "--auth" flag to create a new project with the authentication scaffolding installed!To update laravel installer read hereIt means we can do:Which is a shorthand of commands in the Section B. Also read more hereStep 1 - First do this:Note: 

Laravel UI Composer package is a new first-party package that extracts the UI portion of a Laravel project ( frontend scaffolding typically provided with previous releases of Laravel ) into a separate laravel/ui package. The separate package enables the Laravel team to update, develop and version UI scaffolding package separately from the primary framework and the main Laravel codebase.Step 2 - Then do this:or instead ofMore Options hereThe above command will generate only the auth routes, a HomeController, auth views, and a app.blade.php layout file.You can also generate the views only with:The console command will prompt you to confirm overwriting auth files if you've already run the command before.and also:To see differences read this articleStep 3 - Then you need to do:In short and precise, all you need to do is php artisan ui vue --auth and then the migrate php artisan migrate.Just for an overview of Laravel AuthenticationLaravel Authentication facilities comes with Guard and Providers, Guards define how users are authenticated for each request whereas Providers define how users are retrieved from you persistent storage.Database Consideration - By default Laravel includes an App\User Eloquent Model in your app directory.Auth Namespace - App\Http\Controllers\AuthControllers - RegisterController, LoginController, ForgotPasswordController and ResetPasswordController, all names are meaningful and easy to understand!Routing - Laravel/ui package provides a quick way to scaffold all the routes and views you need for authentication using a few simple commands (as mentioned in the start instead of make:auth).You can disable any newly created controller, e. g. RegisterController and modify your route declaration like, Auth::routes(['register' => false]);

For further detail please look into the Laravel Documentation.In the Laravel 6 application the make:auth command no longer exists.Laravel UI is a new first-party package that extracts the UI portion of a Laravel project into a separate laravel/ui  package. The separate package enables the Laravel team to iterate on the UI package separately from the main Laravel codebase.You can install the laravel/ui package via composer:Besides the new ui command, the laravel/ui package comes with another command for generating the auth scaffolding:If you run the ui:auth command, it will generate the auth routes, a HomeController, auth views, and a app.blade.php layout file.If you want to generate the views alone, type the following command instead:If you want to generate the auth scaffolding at the same time:php artisan ui vue --auth command will create all of the views you need for authentication and place them in the resources/views/auth directoryThe ui command will also create a resources/views/layouts directory containing a base layout for your application. All of these views use the Bootstrap CSS framework, but you are free to customize them however you wish.More detail follow. laravel-news & documentation

How do I write to the console from a Laravel Controller?

Jrop

[How do I write to the console from a Laravel Controller?](https://stackoverflow.com/questions/25148662/how-do-i-write-to-the-console-from-a-laravel-controller)

So I have a Laravel controller:Currently, I'm running the application using artisan (which runs PHP's built-in development web server under the hood):I would like to log console messages to the STDOUT pipe for the artisan process.

2014-08-05 21:29:34Z

So I have a Laravel controller:Currently, I'm running the application using artisan (which runs PHP's built-in development web server under the hood):I would like to log console messages to the STDOUT pipe for the artisan process.Aha!This can be done with the following PHP function:Found the answer here: Print something in PHP built-in web serverThe question relates to serving via artisan and so Jrop's answer is ideal in that case. I.e, error_log logging to the apache log.However, if your serving via a standard web server then simply use the Laravel specific logging functions:With current versions of laravel like this for info:This logs to Laravel's log file located at /laravel/storage/logs/laravel-<date>.log (laravel 5.0). Monitor the log - linux/osx: tail -f /laravel/storage/logs/laravel-<date>.logI haven't tried this myself, but a quick dig through the library suggests you can do this:I couldn't find a shortcut for this, so you would probably want to create a facade to avoid duplication.It's very simple.You can call it from anywhere in APP.For better explain Dave Morrissey's answer I have made these steps for wrap  with Console Output class in a laravel facade.1) Create a Facade in your prefer folder (in my case app\Facades):2) Register a new Service Provider in app\Providers as follow:}3) Add all this stuffs in config\app.php file, registering the provider and alias. That's it, now in any place of your Laravel application, just call your method in this way:Hope this help you.If you want to log to STDOUT you can use any of the ways Laravel provides; for example (from wired00's answer):The STDOUT magic can be done with the following (you are setting the file where info messages go):Word of caution: this is strictly for debugging. Do no use anything in production you don't fully understand.I wanted my logging information to be sent to stdout because it's easy to tell Amazon's Container service (ECS) to collect stdout and send it to CloudWatch Logs. So to get this working, I added a new stdout entry to my config/logging.php file like so:Then I simply added 'stdout' as one of the channels in the stack log channel:This way, I still get logs in a file for local development (or even on the instance if you can access it), but more importantly they get sent to the stdout which is saved in CloudWatch Logs.If you want the fancy command IO from Laravel (like styling, asking and table) then I created this class belowI have not fully verified everywhere that it is THE cleanest solution etc, but it works nice (but I only tested it from within a unit test case, under Laravel 5.5).So most probably you can use it however you like:Or course you can also wrap in your own facade, or some static singleton etc, or anyway you wish.In Laravel 6 there is a channel called 'stderr'. See config/logging.php:In your controller:Bit late to this...I'm surprised that no one mentioned Symfony's VarDumper component that Laravel includes, in part, for its dd() (and lesser-known, dump()) utility functions. There's a bit more code needed, but, in return, we get nice formatted, readable output in the console—especially useful for debugging complex objects or arrays: To take this a step further, we can even colorize the output! Add this helper function to the project to save some typing: If we're running the app behind a full webserver (like Apache or Nginx—not artisan serve), we can modify this function slightly to send the dumper's prettified output to the log (typically storage/logs/laravel.log):...and, of course, watch the log using: PHP's error_log() works fine for quick, one-off inspection of simple values, but the functions shown above take the hard work out of debugging some of Laravel's more complicated classes.You can use echo and prefix "\033", simple:And change color text:I use this for Lumen, pretty sure it will work with Laravel too

Laravel 5 - Interface is not instantiable

Andrew Kulakov

[Laravel 5 - Interface is not instantiable](https://stackoverflow.com/questions/29690056/laravel-5-interface-is-not-instantiable)

I know that this question was asked so many times, but none of answers helped me.I'm getting exception in Laravel 5What I've done without success:Structure:App\Contracts\CustomModelInterface.phpApp\Repositories\CustomModelRepository.phpApp\Services\MyService.php (Keep business logic / layer between controller and repositories)App\Providers\AppRepositoryProvider.phpMy controller looks like:composer.json

2015-04-17 04:04:03Z

I know that this question was asked so many times, but none of answers helped me.I'm getting exception in Laravel 5What I've done without success:Structure:App\Contracts\CustomModelInterface.phpApp\Repositories\CustomModelRepository.phpApp\Services\MyService.php (Keep business logic / layer between controller and repositories)App\Providers\AppRepositoryProvider.phpMy controller looks like:composer.jsonThank you everyone, but problem was in my AppRepositoryProvider. As it's binding exception, then obviously the problem was with binding :)Correct file is:Note, that I'm using "App\Contracts\\{$model}Interface" (not escaping "{" symbol) and it generate correct string App\Contracts\CustomModelInterface instead of App\Contracts\{$model}Interface (with unexpected escaping).Every time I create a new repository/contract pair I make sure I do the following: Many hours of useless debugging led me to this short checklist.For me, I forgot to bind in app->providers->RepositoryServiceProvider

the repository like this in the register methodMake sure your RepositoryServiceProvider is registered in AppServiceProvider.I got past this error running:Related to:Target is not instantiable. Laravel 5 - App binding service providerOn App\Services\MyService.php you are passing that interface with dependency injection which tries to instantiate that - which is wrong.Try implement that in that class - class MyService implements CustomModelInterface { and use the function of that interface like - Or you are using it - class CustomModelRepository implements CustomModelInterface {So if you do - then also you can access the interface methods.I've just experienced an issue similar to this and the cause of my error was that I had set $defer to true in the service provider class but I had not implemented the required provides() method.If you have deferred the creation of your class until it is need rather than it being loaded eagerly, then you need to also implement the provides method which should simply return an array of the classes that the provider provides. In the case of an interface, I believe it should be the name of the interface rather than the concrete class.E.g.Current documentation: https://laravel.com/docs/5.5/providers#deferred-providersI hope this helps somebody else.Don't worry guys. I have a solution to your problem.I have an example for you.Step1: php artisan make:repository Repository/Post    //By adding this command you can create a repository and eloquent filesStep2: After adding that file you have to add/use this repository in the controller in which you want to use.for eg: use App\Repositories\Contracts\PostRepository;Step3: After adding that repo in your controller if you will run the app you will get an error like " Interface is not instantiable". It comes because you have created a repo and used in a controller, but laravel don't know where this repository is register and bind with which eloquent. So that it throws an error.Step4: To solve this error you have to bind your repo with your eloquent in AppServiceProvider. 

    E.g: AppServiceProvider.php fileStep5: After binding repo and eloquent you can use all method of repo in your controller. Enjoy.....Please let me know if you have any query.I think the problem here is that you don't bind App\Contracts\CustomModelInterface to anything so Laravel tries to create instance of interface.In App\Providers\AppRepositoryProvider.php you have only:but you should have in this array CustomModel also, so it should look like this:Note that this can also be caused by the _constructor on the class being declared private, or otherwise being blocked...

If it cant call the constructor, the binding will failThe last thing you do is to use the interface you bound to the repository. Set it up and try running your laravel app to make sure you get no errors. In my case I had a mismatch between my repository and interface.As you can see the interface get method does not include a type hint but the UserRepository class' get method has a type hint.You won't get this error if you immediately start to use your Interface Binding.The problem is solved by adding your repository in app/providers/AppServiceProvider

like the example below.Dont forget the name spaceIt worked for me

Laravel firstOrNew how to check if it's first or new?

raphadko

[Laravel firstOrNew how to check if it's first or new?](https://stackoverflow.com/questions/30686880/laravel-firstornew-how-to-check-if-its-first-or-new)

I'm using Laravel's function firstOrNew() to create a new user or find and update an existing one.How can I know, after the object is created, if it existed before or if it's a new object?The idea is something like this:

2015-06-06 19:45:51Z

I'm using Laravel's function firstOrNew() to create a new user or find and update an existing one.How can I know, after the object is created, if it existed before or if it's a new object?The idea is something like this:You can check the exists property on the Model.You can check if your user was recently created.(Source: Thomas Kim from this answer)If you created the model in the current lifecycle, then the model's wasRecentlyCreated attribute will be set to true. Otherwise, that attribute will be set to false.In other words, lets say you have a user with the email, test@yopmail.com// the above will dump out false because this entry already existed otherwise true.You can always check for an ID (or any other unique primary key) in the model. It is important to keep in mind that after you persist the model using $user->save(), you will NOT be able to use $user->id to check if it was found in the database or not. This is because Eloquent populates all the attributes of the new model after it is saved.

How to set laravel 5.3 logout redirect path?

Tim van Uum

[How to set laravel 5.3 logout redirect path?](https://stackoverflow.com/questions/39327970/how-to-set-laravel-5-3-logout-redirect-path)

Is there no elegant solution to redirect to a specific page after logging out in Laravel 5.3? The function being called is from the trait AuthenticatesUsers: This is a default function from the core of laravel. So I have to override the whole function I cannot edit the core.

But isn't there a more simpler solution, cause it feel like overkill to manually logout, flush and regenerate again.Worked the answers out in an article:

https://codeneverlied.com/how-to-set-logout-redirect-path-in-laravel-5-8-and-before/

2016-09-05 09:51:24Z

Is there no elegant solution to redirect to a specific page after logging out in Laravel 5.3? The function being called is from the trait AuthenticatesUsers: This is a default function from the core of laravel. So I have to override the whole function I cannot edit the core.

But isn't there a more simpler solution, cause it feel like overkill to manually logout, flush and regenerate again.Worked the answers out in an article:

https://codeneverlied.com/how-to-set-logout-redirect-path-in-laravel-5-8-and-before/This is how I did it. In Auth\LoginController you have:Change it to:Then, define a new logout() method in your LoginController:Sure, regular logout() method in that trait has only 3 lines (used to log users out of the system) so you can copy them to your method, but you should always follow the DRY principle (don't repeat yourself) and re-use as much code as you can.The accepted answer is fine, but you can completely bypass touching any of the logout logic by simply overwriting the loggedOut method:I would inherit LoginController and override the logout function coming from the trait in there:LoginController.php -> leave that as it is.MyLoginController.php:Of course, you should remember to update your Auth routes accordingly.I'm using Laravel-5.2, what I used was:Make sure you have imported:In your controller.The Auth::routes method in laravel 5.3 registers a POST route for /logout instead of a GET route. This prevents other web applications from logging your users out of your application. To upgrade, you should either convert your logout requests to use the POST verb or just register your own GET route for the /logout URI by adding this route to the file Routes/web.php:-and it should work fine and redirect you to the '/' directory as it's defined in the LoginController.phpQuoted from:-https://laravel.com/docs/5.3/upgradeAssuming someone is viewing it now a days and the version of the laravel they are using is 5.7Add this line in LoginController.phpThis assumes you are using the out of the box authentication module provided by laravelEvery logout action fires an event Events\Logout. You can create a listener that listens to this event and add some logic to there. See more about listeners here https://laravel.com/docs/5.3/eventsThe simplest way is to override logout trait at LoginController in App\Http\Controllers\Auth\LoginController like thisIf you're using the out of the box AuthController add this variable to the top and then change the string to redirect wherever you want.The AuthenticatesUsers class has a logout function that checks for this variable.Just use this in routes/web.phpIn Laravel 5.8 find the below path :App\Http\Controllers\Auth\LoginController.phpwrite this function To avoid repeating logout code and to follow DRY, you may The accepted answer is fine, but you can completely bypass touching any of the logout logic by simply overwriting the loggedOut method:Illuminate Support package: override logout method in LoginController.phpyou can go to vendor\laravel\framework\src\Illuminate\Foundation\Auth\AuthenticatesUsers.php

in function logout change  return redirect('/'); to your route address.

How to set a default attribute value for a Laravel / Eloquent model?

J. Bruni

[How to set a default attribute value for a Laravel / Eloquent model?](https://stackoverflow.com/questions/18747500/how-to-set-a-default-attribute-value-for-a-laravel-eloquent-model)

If I try declaring a property, like this:...it doesn't work, because it is not considered an "attribute", but merely a property of the model class. Not only this, but also I am blocking access to the actually real and existent "quantity" attribute.What should I do, then?

2013-09-11 17:22:11Z

If I try declaring a property, like this:...it doesn't work, because it is not considered an "attribute", but merely a property of the model class. Not only this, but also I am blocking access to the actually real and existent "quantity" attribute.What should I do, then?An update to this...@j-bruni submitted a proposal and Laravel 4.0.x is now supporting using the following:Which will automatically set your attribute subject to A Post when you construct. You do not need to use the custom constructor he has mentioned in his answer.However, if you do end up using the constructor like he has (which I needed to do in order to use Carbon::now()) be careful that $this->setRawAttributes() will override whatever you have set using the $attributes array above. For example:See the Github thread for more info.This is what I'm doing now:I will suggest this as a PR so we don't need to declare this constructor at every Model, and can easily apply by simply declaring the $defaults array in our models...UPDATE:As pointed by cmfolio, the actual ANSWER is quite simple: Just override the $attributes property! Like this:The issue was discussed here.I know this is really old, but I just had this issue and was able to resolve this using this site.Add this code to your modelUpdate/DisclaimerThis code works, but it will override the regular Eloquent Model creating Event

Disable rate limiter in Laravel?

SimpleJ

[Disable rate limiter in Laravel?](https://stackoverflow.com/questions/43058219/disable-rate-limiter-in-laravel)

Is there a way to disable rate limiting on every/individual routes in Laravel?I'm trying to test an endpoint that receives a lot of requests, but randomly Laravel will start responding with { status: 429, responseText: 'Too Many Attempts.' } for a few hundred requests which makes testing a huge pain.

2017-03-27 23:40:06Z

Is there a way to disable rate limiting on every/individual routes in Laravel?I'm trying to test an endpoint that receives a lot of requests, but randomly Laravel will start responding with { status: 429, responseText: 'Too Many Attempts.' } for a few hundred requests which makes testing a huge pain.In app/Http/Kernel.php Laravel has a default throttle limit for all api routes.Comment or increase it. You can actually disable only a certain middleware in tests.   Assuming you are using the API routes then you can change the throttle in app/Http/Kernel.php or take it off entirely.  If you need to throttle for the other routes you can register the middleware for them separately.(example below: throttle - 60 attempts then locked out for 1 minute)In Laravel 5.7Dynamic Rate Limiting

You may specify a dynamic request maximum based on an attribute of the authenticated User model. For example, if your User model contains a rate_limit attribute, you may pass the name of the attribute to the throttle middleware so that it is used to calculate the maximum request count:https://laravel.com/docs/5.7/routing#rate-limitingIf you want to disable just for automated tests, you can use the WithoutMiddleware trait on your tests.Otherwise, just remove the 'throttle:60,1', line from your Kernel file (app/Http/Kernel.php), and your problem will be solved.A non-hacky way to increase the throttle in unit tests to avoid the dreaded 429:You can add the following lines in your app/Http/Kernel.phpIf the problem persists try the artisan command php artisan cache:clear

How can I manually return or throw a validation error/exception in Laravel?

Svish

[How can I manually return or throw a validation error/exception in Laravel?](https://stackoverflow.com/questions/47219542/how-can-i-manually-return-or-throw-a-validation-error-exception-in-laravel)

Have a method that's importing CSV-data into a Database. I do some basic validation using But after that things can go wrong for more complex reasons, further down the rabbit hole, that throws exceptions of some sort. I can't write proper validation stuff to use with the validate method here, but, I really like how Laravel works when the validation fails and how easy it is to embed the error(s) into the blade view etc, so...Is there a (preferably clean) way to manually tell Laravel that "I know I didn't use your validate method right now, but I'd really like you to expose this error here as if I did"? Is there something I can return, an exception I can wrap things with, or something?

2017-11-10 09:30:13Z

Have a method that's importing CSV-data into a Database. I do some basic validation using But after that things can go wrong for more complex reasons, further down the rabbit hole, that throws exceptions of some sort. I can't write proper validation stuff to use with the validate method here, but, I really like how Laravel works when the validation fails and how easy it is to embed the error(s) into the blade view etc, so...Is there a (preferably clean) way to manually tell Laravel that "I know I didn't use your validate method right now, but I'd really like you to expose this error here as if I did"? Is there something I can return, an exception I can wrap things with, or something?As of laravel 5.5, the ValidationException class has a static method withMessages that you can use:I haven't tested this, but it should work.UpdateThe message does not have to be wrapped in an array. You can also do:Laravel <= 6.2 this solution worked for me:Simply return from controller:    you can try a custom message bagi just add /**

     * @throws \Illuminate\Validation\ValidationException

     */and fix For Laravel 5.8:.The easiest way to throw an exception is like this:

What is the concept of Service Container in Laravel?

Nello

[What is the concept of Service Container in Laravel?](https://stackoverflow.com/questions/37038830/what-is-the-concept-of-service-container-in-laravel)

I am starting to look into Laravel but I don't understand the concept of Service Container.How does it work and what do developers need to know to fully utilize this concept in Laravel?

2016-05-04 22:01:02Z

I am starting to look into Laravel but I don't understand the concept of Service Container.How does it work and what do developers need to know to fully utilize this concept in Laravel?The Service Container in Laravel is a Dependency Injection Container and a Registry for the applicationThe advantages of using a Service Container over creating manually your objects are:Capacity to manage class dependencies on object creationYou define how a object should be created in one point of the application (the binding) and every time you need to create a new instance, you just ask it to the service container, and it will create it for you, along with the required dependenciesFor example, instead of creating objects manually with the new keyword:you can register a binding on the Service Container:and create an instance through the service container with:Binding of interfaces to concrete classes  With Laravel automatic dependency injection, when an interface is required in some part of the app (i.e. in a controller's constructor), a concrete class is instantiated automatically by the Service Container. Changing the concrete class on the binding, will change the concrete objects instantiated through all your app:Using the Service Container as a Registry    You can create and store unique object instances on the container and get them back later: using the App::instance method to make the binding, and thus using the container as a Registry.As a final note, essentially the Service Container -is- the Application object: it extends the Container class, getting all the container's funtionalities  Laravel container create instance for full application from services(class)

We don't need to create instance for our application likeFirst, We are going look bind static method of App class. bind is just binding your class instance(object) with an application, nothing more.Now, we can use this object for our application by using make a static method of App class.In above example when we are going to call make method then its generate every time new instance of class, So Laravel have pretty solution for Singleton

We can bind an object to our application by singleton method.We can be resolved by make method. Now, we have always received the exact same instance from this method.App::instance

We can bind an instance to the container and we will always return the exact same instance using instance method.We can be resolved byWe can bind interface byYaa, We have a question, How can we implement binding in our application? We can implement binding in our AppServiceProvider

Laravel : How to Log INFO to separate file

Rohit Jindal

[Laravel : How to Log INFO to separate file](https://stackoverflow.com/questions/32552450/laravel-how-to-log-info-to-separate-file)

How to specify a separate file for logging INFO in Laravel 5.1?Any immediate help will be highly appreciable. Thanks

2015-09-13 17:21:17Z

How to specify a separate file for logging INFO in Laravel 5.1?Any immediate help will be highly appreciable. ThanksDo you want to specifically log info to one log file and another log type to another location? My solution might not help in that case, but could still be useful.To write a log file to another location, use the method useDailyFiles or useFiles, and then info to log to the log file at the path you just specified. Like so:The first parameter for both methods is the path of the log file (which is created if it doesn't already exist) and for useDailyFiles the second argument is the number of days Laravel will log for before erasing old logs. The default value is unlimited, so in my example I haven't entered a value.In Laravel 5.6 you can create your own channel in config\logging.php. If you have upgraded from an older Laravel version you need to create this file (https://laravel.com/docs/5.6/upgrade).Add this to you channel array in config\logging.phpYou can then call  any of the 8 logging levels like that:The logs will be stored in logs/your_file_name.logIf you would like add another monolog handler, you may use the application's configureMonologUsing method. Place a call to this method in bootstrap/app.php file right before the $app variable is returned:A simple logger helper that allows you to log to multiple custom files on the fly. You can also add your custom handler and set the file path.App\Helper\LogToChannels.phpApp\Providers\LogToChannelsServiceProvider.phpconfig\app.php (add the service provider)Then anywhere in your app you can call using dependency injection (add the class in your constructor and bind it to a log class attribute)You can even customize your logger output by callingAnd it will be accessible when you will call its name anywhere in your app.Since Laravel >= 5.6 we can use Log Channels to make it work in a easy way. This allows you to create log channels which can be handled as own log files with own drivers, paths or levels. You just need this few lines to make it work. config/logging.php: Log where ever you want by parse the channel name:To activate logging to file in Laravel 5.8 or 6:Message will be logged to storage/logs/laravel.log. This is a default path for single channel at config/logging.php.

What is the best practice for adding constants in laravel? (Long List)

Faran Khan

[What is the best practice for adding constants in laravel? (Long List)](https://stackoverflow.com/questions/42155536/what-is-the-best-practice-for-adding-constants-in-laravel-long-list)

I am rather new to laravel. I have a basic question, What is the best way to add constants in laravel. 

I know the .env method that we use to add the constants. 

Also I have made one constants file to use them for my project. 

For example:And so on. It can reach upto 100 or more records. So What should be the best approach to write the constants. The .env method. Or adding the constant.php file?Thanks 

2017-02-10 09:13:26Z

I am rather new to laravel. I have a basic question, What is the best way to add constants in laravel. 

I know the .env method that we use to add the constants. 

Also I have made one constants file to use them for my project. 

For example:And so on. It can reach upto 100 or more records. So What should be the best approach to write the constants. The .env method. Or adding the constant.php file?Thanks For most constants used globally across the application, storing them in config files is sufficient. It is also pretty simpleCreate a new file in the config directory. Let's call it constants.phpIn there you have to return an array of config values.And you can access them as followsI use aliased class constants : First, create your class that contain your constants : App/MyApp.php for exempleThen add it to the aliased classes in the config/app.phpFinally use them wherever you like (controllers or even blades) : Your question was about the 'best practices' and you asked about the '.env method'..env is only for variables that change because the environment changes. Examples of different environments: test, acceptance, production. So the .env contains database credentials, API keys, etc.The .env should (imho) never contain constants which are the same over all environments. Just use the suggested config files for that.First you make Constants folder inside your app directory.And then you make Constants.php. Define your constants in this fileFor Example : And you modify the composer.jsonAlternatively, you can use composer.json to load the bootstrap/constants.php file by adding the following code to the「autoload」section, like so:And update your composer !You can create a file named paths.php in root directory/config/paths.phpInsert this data into paths.phpNote : make sure to run command : php artisan config:clearIn addition to Arun Singh's answer I would recommend you to use helpers.Inside your helper.php you may defineThus instead of you may callAnother way as following:You can define constants at the top of the web.php file located in routes and can be access the constants anywhere in project  with just constant nameor  -And use it like before:You can simply do this:

Setting up Laravel on a Mac php artisan migrate error: No such file or directory [duplicate]

Mwirabua Tim

[Setting up Laravel on a Mac php artisan migrate error: No such file or directory [duplicate]](https://stackoverflow.com/questions/19475762/setting-up-laravel-on-a-mac-php-artisan-migrate-error-no-such-file-or-directory)

NB:

php -v is 5.5 and mysql -v is 5.5 from the terminal

Here is part of my config/database.phpI tried replacing localhost with 127.0.0.1 with no avail. Kindly help..Edit:

I added these three lines in my php.ini I also added this symlink:But that didnt solve. I also pulled a fresh new laravel project from git and ran into the same error after composer install then php artisan migrateThe mac version is 10.7.4

2013-10-20 09:17:27Z

NB:

php -v is 5.5 and mysql -v is 5.5 from the terminal

Here is part of my config/database.phpI tried replacing localhost with 127.0.0.1 with no avail. Kindly help..Edit:

I added these three lines in my php.ini I also added this symlink:But that didnt solve. I also pulled a fresh new laravel project from git and ran into the same error after composer install then php artisan migrateThe mac version is 10.7.4If you are using MAMP be sure to add the unix_socket key with a value of the path that the mysql.sock resides in MAMP.First of all, get your unix_socket location.Enter your mysql password and login your mysql server from command line.Your unix_soket could be diffrent.Then you got 2 solution to solve your issue:(1) Change your config/database.php(2) Change your php.ini, find your php.ini file fromYou maybe install many php with different version, so please don't assume your php.ini file location, get it from your 'phpinfo';Change your php.ini:Then restart your apache or php-fpm.Had the same problem, but it's working for me now.If anybody is still having problems, try this:If you are using XAMPP, the solution is:This works for me in Laravel 5.0, change the DB_HOST=127.0.0.1:33060 in .env file.Others answers don't work... For Laravel 5.0+ change localhost to 127.0.0.1 in your .env file as well before you go playing around with Unix Sockets etc - this worked for me.Noobs beware: For anyone using Laravel 5 and using older learning material be aware that there was quite a marked shift in folder structure from previous versions though this seems to be for the better- check out this article https://mattstauffer.co/blog/laravel-5.0-directory-structure-and-namespaceIf you are using Laravle 5.1.11 version + MAC + MAMPP you  have to add  "Unix_socket " in  file "yourapp"/app/config/database.php  Unix_socket param was added to above  mysql config drive.Another solution is to add the port number in the host key. In this case MAMP uses the 8889 by default:

Laravel Eloquent: Return Array key as the fields ID

Broshi

[Laravel Eloquent: Return Array key as the fields ID](https://stackoverflow.com/questions/26865877/laravel-eloquent-return-array-key-as-the-fields-id)

When I execute a query via Laravel's Eloquent ORM, I want to get the row ID as the Array result key, this will make things easier when I want to check something based on an ID (using array_key_exists) or do some look ups (if I need a specific entry from the result array)Is there any way I can tell Eloquent to set the key to the fields ID?

2014-11-11 13:19:13Z

When I execute a query via Laravel's Eloquent ORM, I want to get the row ID as the Array result key, this will make things easier when I want to check something based on an ID (using array_key_exists) or do some look ups (if I need a specific entry from the result array)Is there any way I can tell Eloquent to set the key to the fields ID?

You can simply do Cheers :)Since you have an Eloquent Collection (a child class of the generic Collection class) you can use the getDictionary method. $collection->getDictionary() will give you an array of your Category objects keyed by their primary keys.If you wanted another Collection rather than a native PHP array, you could instead use $collection->keyBy($property). It looks like your primary key is category_id, so $collection->keyBy('category_id'). You can use that method to key by any arbitrary property, including any get mutators you may have written.While getDictionary is unique to the Eloquent Collection extension, keyBy is available to all Laravel Collection objects. See the Laravel 4.2 API docs or Laravel 5.0 API docs.You have a Support\Collection/Database\Eloquent\Collection you can use the method lists('id') to return an array of the id of each of the models within the collection. Then use array_combine to map the keys to the models. The result of which will be an array with the id mapped to their corresponding model. If you need id as the key, then rely on the Collection:Otherwise, nice or not, you can do this:pluck('label','id') on the get() output is what you're looking for in Laravel 5.8+, which gives you a collection, ready to be toArray()edeg:I had a similar challenge - I wanted to a PHP array to allow me  to create a  with an  for each choice, with the 's value being the id auto increment column, and the displayed text being the value.

Environment driven database settings in Laravel?

Hailwood

[Environment driven database settings in Laravel?](https://stackoverflow.com/questions/13860283/environment-driven-database-settings-in-laravel)

I am moving over the the Laravel framework, but I am having trouble with the database settings,Specifically, I have my environments setup, and they are working fine for the application.php config file, however the database.php config file seems to have no effect.Even if I have a database.php config file in my environments folder it is never loaded, I put a bunch of invalid characters (keyboard mash) into the file to get php to throw an error, but it is never hit.Does Laravel not support environment based database settings? or am I doing this wrong?

2012-12-13 12:53:49Z

I am moving over the the Laravel framework, but I am having trouble with the database settings,Specifically, I have my environments setup, and they are working fine for the application.php config file, however the database.php config file seems to have no effect.Even if I have a database.php config file in my environments folder it is never loaded, I put a bunch of invalid characters (keyboard mash) into the file to get php to throw an error, but it is never hit.Does Laravel not support environment based database settings? or am I doing this wrong?You can definitely set database settings (and any other config setting) by environment.For Laravel 3 (for Laravel 4 and Laravel 5 see below):Firstly - you need to define $environments in your paths.php and set it to something like this:Laravel will automatically look for this variable, and if set, will use the associated configuration.Normally you have a config folder, with settings such as database.php and auth.phpNow just create a new folder for each Laravel_Env you plan to use (such as Development). You'll end up with a folder structure like this;You'll note I've only included database.php in each subfolder. Laravel will always load the default config settings first, then override them with any custom configs from the environments setting.Finally, in your development/database file, you would have something like this;p.s. I just tested this on the current 3.2.12 build of Laravel - and it definitely works.Bonus Tip: You can also automatically set an environment for Artisan, so you do not have to include the environment manually on each command line! To do this:You should end up with something like this:Artisan will now run using your development environment. If you deploy to a live server - re-run these steps to get the hostname() for the server, and you can configure a specific artisan config just for the server!For Laravel 4:The default environment is always production. But in your start.php file you can define additional environments.On Linux and Mac, you may determine your hostname by type hostname in your terminal - it will output the name of your computer. On Windows put dd(gethostname()); at the beginning of your routes.php file - and run the website once - it will show you the current hostname of your computer.To get the current environment as a variable in your application - read this SO answer here. Laravel 4: how can I get the environment value?For Laravel 5:There is single configuration file, called .env in your root directory.

Watch this laracast, config explained fully.if you are using the artisan ( command line for laravel ) every command you need to add orHeres how I have it setup for my needs. I personally need 4 different configurations:Since all 4 of my environments have distinctive directory structure, I can use php's magic constant __DIR__ to fetch the app directory and then use the strpos() function to do a simple check and return the appropriate environment. It will take care of Artisan environment as well, no need to manually type the environment, or add any machine names.Inside the Add a callback functionWe can also set and grab all the values at once into an array, and run a foreach loop.Tip: Since we using the strpos() function, which checks position of the first occurrence of the given value against the $haystack, and returns the position number. We don't really have to supply the entire path, we can simply add a distinctive value from each path to get the job done. Whether we work on one machine or multiple, the chances of having the same path to different environments is very slim. Or so I think. :)How to setup environment specific configuration is now in the official Laravel docs. I would recommend using their method instead of the accepted answer:Use the DotEnv approach detailed in the Laravel docs here.We are using the method Jeffrey Way recommended in this Laracasts lesson.I've been working away on this today, struggling to work out how best to do environmental settings for a database. In the end, after trying several methods, I fully agree with @troy-harvey that Jeffrey Way's recommendation of doing this is the best (for me at least). One thing I will add to this, and its what held me up so much today is (and correct me if I'm wrong) that you need to access the settings you are trying to over-ride in your environmental settings file by their corresponding array keys. I started out returning a simple array:within an app/config/staging/database.php. This had no effect and after much head scratching realised that you need to access the array as it is presented in app/config/database.php, like so:At least this is how I finally managed to get my settings being picked up. Adding this here in case anyone else is struggling to work this out. Upon realisation I understood how obvious a mistake I was making. Edited 01 July 2014An additional comment to this is that since 4.1 Laravel ships with an append_config() helper function for appending environmental configurations to the main config array. This would look like this for the example given above:In Laravel 3 to detect the environment it was:Which would return whatever was identified in the environments array found in the paths.php file.As mentioned before in Laravel 4 it is now:My way of doing it!If you're trying to use Laravel in a Windows environment, check out the settings in file .env in the top level folder for your Laravel project - these will override whatever database settings you have in config/database.phpIf you are on Laravel 4 here is a gist that will take you through the process step by step. Credits to @"The Shift Exchange"'s answer for guiding me to create it.

Laravel 5.2 redirect back with success message

Stefan

[Laravel 5.2 redirect back with success message](https://stackoverflow.com/questions/37376168/laravel-5-2-redirect-back-with-success-message)

I'm trying to get a success message back to my home page on laravel.For some reason the variable $success doesn't get any value after running this code.The code I'm using to display the succes message:I have added the home and newsletter page to the web middleware group in routes.php like this:Does anyone have any idea why this doesn't seem to work?

2016-05-22 15:26:50Z

I'm trying to get a success message back to my home page on laravel.For some reason the variable $success doesn't get any value after running this code.The code I'm using to display the succes message:I have added the home and newsletter page to the web middleware group in routes.php like this:Does anyone have any idea why this doesn't seem to work?You should remove web middleware from routes.php. Adding web middleware manually causes session and request related problems in Laravel 5.2.27 and higher.If it didn't help (still, keep routes.php without web middleware), you can try little bit different approach:Displaying message if it exists:you can use this :and use this in your view :Controller:BladeYou can always save this part as separate blade file and include it easily.

fore example:All of the above are correct, but try this straight one-liner:{{session()->has('message') ? session()->get('message') : ''}}One way to do that is sending the message in the session like this:Controller:View:And other way to do that is just creating the session and put the text in the view directly:Controller:View:You can check the full documentation here: Redirecting With Flashed Session DataI hope it is very helpful, regards.You can simply use back() function to redirect no need to use redirect()->back() make sure you are using 5.2 or greater than 5.2 version.You can replace your code to below code.In the view file replace below code.For more detail, you can read here back() is just a helper function. It's doing the same thing as redirect()->back()In ControllerIn viewYou can use laravel MessageBag to add our own messages to existing messages.To use MessageBag you need to use:In the controller:Hope it will help some one.

Install dependency (doctrine/dbal) on composer laravel

elvainch

[Install dependency (doctrine/dbal) on composer laravel](https://stackoverflow.com/questions/22413408/install-dependency-doctrine-dbal-on-composer-laravel)

I am trying to execute a migration to rename some columns and I got an exception. As I read on the documentation I have to add the doctrine/dbal dependency to my composer.json file. How do I do that? Which is the correct composer.json file. I have many in my application. Is the one that is on the same level as the folders app,bootstrap, public and vendor.If so how do I add that dependency. Do I have to download anything?By the way im using easyphp, not wamp!After doing that the console throws this error

2014-03-14 18:51:33Z

I am trying to execute a migration to rename some columns and I got an exception. As I read on the documentation I have to add the doctrine/dbal dependency to my composer.json file. How do I do that? Which is the correct composer.json file. I have many in my application. Is the one that is on the same level as the folders app,bootstrap, public and vendor.If so how do I add that dependency. Do I have to download anything?By the way im using easyphp, not wamp!After doing that the console throws this errorTo add this dependency open the composer.json at the root of your project (in the same level as app, public etc.) and in the require section add the doctrine/dbal package like:Save the file and run composer updateEdit You probably installed git with the default settings and it's not in your PATH env.Open Git Bash (it was installed with git - you will find it in your programs) and do composer update. By the way it's far better that windows command prompt.1) To install dependency , run this command2) For 'git' is not recognized error, either you don't have git installed or the PATH is not added in the environment variables.Install git for windows. 

Get environment value in controller

nielsv

[Get environment value in controller](https://stackoverflow.com/questions/34263107/get-environment-value-in-controller)

In my .env file I have the following:Now I would like to use them in my controller. I've tried this but with no result:The $hostname variable is equal to null. How can I use these config variables in my controller?

2015-12-14 09:08:27Z

In my .env file I have the following:Now I would like to use them in my controller. I've tried this but with no result:The $hostname variable is equal to null. How can I use these config variables in my controller?try it with Doesn't work in Laravel 5.3+ if you want to try to access the value from the controller like below, it returns always nullSOLUTION: Rather you need to create a file in config folder ..say values.php and then 

write the codes like belowvalues.phpThen access the value in your controller with the following codeWhere "values" is the filename followed by the key "myvalue"

Hope it helpsI thought I'd add an answer, to simplify what has been said in the past. Only config files can access env variables - and then pass them on.Step 1.) Add your variable to your .env file, ie.Step 2.) Create a new file inside of the config folder, any name, ie.Step 3.) Inside of this new file, I add an array being returned, containing that env variable.Step 4.) Because I named it "example" my configuration 'namespace' is now example. So now, in my controller I can access this variable with:Tip - if you add use Config; at the top of your controller, you don't need the backslash (which designates the root namespace). Ie.--- IMPORTANT --- Remember to enter into the console php artisan config:cache once you have created your example.php file. Config files and variables are cached, so if you make changes you need to flush that cache - the same applies to the .env file being changed / added to.All of the variables listed in  .env file will be loaded into the $_ENV PHP super-global when your application receives a request.

    Checkout laravel configuration pageInControllerIn blade.viewin Laravel Controlllerin Laravel Blade filesExample : Accessing Laravel .env variables in bladeGet environment value in controllerYou can use with this format, (Tested on Laravel 5.5) in my case i used for get the data of database connections and use on Controller:The second parameter can be null, or set any default in case of DB_USERNAMEchild is null.you .env file can be the same:It's a better idea to put your config variables in a config file.In your case, I would suggest putting your variables in config/mail.php like 'imap_hostname' => env('IMAP_HOSTNAME_TEST', 'imap.gmail.com')and refer to them byIt first tries to get config variable value in the .env file and if it couldn't find the variable value in the .env file it will get variable value from config/mail.phpyou can not access the env variable like this. inside .env file you write next inside config folder there is a mail.php you may use this file to code. As you are working with mail functionality. You might use another file as well. you can call the variable from a controller using 'config( 

Whatever file you are using inside config folder. you need to use that file name (without extension) + '.' + 'variable name' + ')' . Current case you can call the variable as follows.    since you declare the variable inside mail.php and variable name is imap_hostname_test. you need to call like this. If you declare this variable inside app.php then you should call May be not related, but it might help someone.... in Laravel just dd(config('app.env'));

and you'll see 'local' or 'production'

Blade: escaping text and allowing new lines

lesssugar

[Blade: escaping text and allowing new lines](https://stackoverflow.com/questions/28027236/blade-escaping-text-and-allowing-new-lines)

I have a user-input text displayed on one of the pages. I want to allow new lines, though. How do I display the text, so it is escaped AND allows new lines?I used nl2br() and Blade's tripple brackets {{{$text}}}, however, obviously, the tripple brackets escape <br/> tags as well.Is there a way to combine escaping and HTML's new lines using Blade?Thanks.

2015-01-19 14:47:13Z

I have a user-input text displayed on one of the pages. I want to allow new lines, though. How do I display the text, so it is escaped AND allows new lines?I used nl2br() and Blade's tripple brackets {{{$text}}}, however, obviously, the tripple brackets escape <br/> tags as well.Is there a way to combine escaping and HTML's new lines using Blade?Thanks.You can do the escaping first, using e() and then apply nl2br():e() is the function Blade uses when compiling triple bracketsYou can use thisin simple approach  you can use it in blade File

Laravel $q->where() between dates

Jono20201

[Laravel $q->where() between dates](https://stackoverflow.com/questions/24824624/laravel-q-where-between-dates)

I am trying to get my cron to only get Projects that are due to recur/renew in the next 7 days to send out reminder emails. I've just found out my logic doesn't quite work.I currently have the query:However, I realized what I need to do is something like:Psudo SQL:How would I do this in Laravel 4, and using the DATETIME datatype, I've only done this sort of thing using timestamps. Update:Managed to solve this after using the following code, Stackoverflow also helps when you can pull bits of code and look at them out of context.Updated Question: Is there better way to do this in Laravel/Eloquent?Update 2:The first resolution ended up not been right after further testing, I have now resolved and tested the following solution:

2014-07-18 12:05:51Z

I am trying to get my cron to only get Projects that are due to recur/renew in the next 7 days to send out reminder emails. I've just found out my logic doesn't quite work.I currently have the query:However, I realized what I need to do is something like:Psudo SQL:How would I do this in Laravel 4, and using the DATETIME datatype, I've only done this sort of thing using timestamps. Update:Managed to solve this after using the following code, Stackoverflow also helps when you can pull bits of code and look at them out of context.Updated Question: Is there better way to do this in Laravel/Eloquent?Update 2:The first resolution ended up not been right after further testing, I have now resolved and tested the following solution:You can chain your wheres directly, without function(q). There's also a nice date handling package in laravel, called Carbon. So you could do something like:Just make sure you require Carbon in composer and you're using Carbon namespace (use Carbon\Carbon;) and it should work.EDIT:

As Joel said, you could do:Didn't wan to mess with carbon. So here's my solution@Tom : Instead of using 'now' or 'addWeek' if we provide date in following format, it does not give correct recordsit gives records having date form 2015-10-16 to less than 2015-10-23.

If value of recur_at is 2015-10-23 00:00:00 then only it shows that record 

else if it is 2015-10-23 12:00:45 then it is not shown.Edited: Kindly note that whereBetween('date',$start_date,$end_date) is inclusive of the first date. 

How to get All input of POST in Laravel

Abrar Jahin

[How to get All input of POST in Laravel](https://stackoverflow.com/questions/32718870/how-to-get-all-input-of-post-in-laravel)

I am using Laravel 5 and trying to get all input of POST variable in controller like this-So, I am getting this errors-What I am doing wrong?

2015-09-22 13:56:51Z

I am using Laravel 5 and trying to get all input of POST variable in controller like this-So, I am getting this errors-What I am doing wrong?Try this :There seems to be a major mistake in almost all the current answers in that they show BOTH GET and POST data. Not ONLY POST data. The issue with your code as the accepted answer mentioned is that you did not import the facade. This can imported by adding the following at the top:You can also use the global request method like so (mentioned by @Canaan Etai), with no import required:However, a better approach to importing Request in a controller method is by dependency injection as mentioned in @shuvrow answer:More information about DI can be found here:In either case, you should use:For those who came here looking for "how to get All input of POST" onlyclass Illuminate\Http\Request extends from Symfony\Component\HttpFoundation\Request which has two class variables that store request parameters.public $query - for GET parameterspublic $request - for POST parametersUsage: To get a post data onlySource hereEDITFor Laravel >= 5.5, you can simply call $request->post() or $request->post('my_param') which internally calls $request->request->all() or $request->request->get('my_param') respectively.You should use the facade rather than Illuminate\Http\Request. Import it at the top:And make sure it doesn't conflict with the other class.Edit: This answer was written a few years ago. I now favour the approach suggested by shuvrow below.You can get all post data into this function :-and if you want specific filed then use it :-It should be at least this:You can use it withoutimport Illuminate\Http\Request   OR use Illuminate\Support\Facades\Request OR other.its better to use the Dependency than to attache it to the class.or if you prefer using input variable use you can now use the global request method provided by laravelfor example to get the first_name of a form input.

Setting Bootstrap navbar active class in Laravel 5

Ikong

[Setting Bootstrap navbar active class in Laravel 5](https://stackoverflow.com/questions/29837555/setting-bootstrap-navbar-active-class-in-laravel-5)

I've been wondering around looking for solutions, but can't really understand especially when creating helpers. I'm new in Laravel and I want a simple or if not a detailed instruction on how to set the active class for my bootstrap navbar.Here's what I've done so far, but can't get it done:EDITSetting class="active" will make all nav-pills active. The intended effect is that only the li of the current page have the active class.EDITFor those who are visiting this post. I have managed to get a solution, but I'm not sure if it is neat. Well it's working and fine for me.

2015-04-24 02:12:24Z

I've been wondering around looking for solutions, but can't really understand especially when creating helpers. I'm new in Laravel and I want a simple or if not a detailed instruction on how to set the active class for my bootstrap navbar.Here's what I've done so far, but can't get it done:EDITSetting class="active" will make all nav-pills active. The intended effect is that only the li of the current page have the active class.EDITFor those who are visiting this post. I have managed to get a solution, but I'm not sure if it is neat. Well it's working and fine for me.Your code is working fine, but you have to use it for every link that can be active. It is better to return only class name, not class="..." so you can add other classes.Be careful when using * at the end (about*). If you use /* for home page then it will always be marked as active (because every other page starts with /).You can also move {{ Request::is('/') ? 'active' : '' }} to helper function/method.If you are working with named routes. You can use this approach in your views:orThe Illuminate\Routing\Router#is(...) is an alias of the Illuminate\Routing\Router#currentRouteNamed(...).Throw this in your helper.phpUse it like soYou can pass a single string to a route or multiple and wildcards.See more detail on Laravel TrickRequest::path() returns the request uri, for example: http://localhost/programs , will return programs, so you can do this:The solution given by @Daniel Antos is best answer, as I have found. Mr. Danial Antos also warned about  using * at the end (about*). Because while using /* for home page then it is always marked as active (because every other page starts with /). So, I have used as follows and it worked fine for me:Set a section on your blade file (let home.blade.php) likeAnd set a section on your another blade file (let about.blade.php) likeand yield this section on app.blade.php (Suppose you are extending from app.blade.php)I think this would be simple, and it works for me.I found the solution:More details : https://github.com/DevMarketer/LaravelEasyNavuse

Request::is('[level]') ? 'active' : '' 

In case of multilevel, use:Request::is('[level]', '[level]/*') ? 'active' : ''This is simple: to get your links to be active when using bootstrap, all you need is an if statement inside the class link, for instance: i have my current url as http://example.com/homeand you are good to go.         

How to get Current Timestamp from Carbon in Laravel 5

Abrar Jahin

[How to get Current Timestamp from Carbon in Laravel 5](https://stackoverflow.com/questions/32719972/how-to-get-current-timestamp-from-carbon-in-laravel-5)

I want to get current timestamp in laravel 5 and I have done this-I am getting eror- 'Carbon not found'-What can I do?Can anyone help, please?

2015-09-22 14:44:12Z

I want to get current timestamp in laravel 5 and I have done this-I am getting eror- 'Carbon not found'-What can I do?Can anyone help, please?You can try this if you want date time string:If you want timestamp, you can try:See the official Carbon documentation here.For Laravel 5.5 or above just use the built in helperIf you want a unix timestamp, you can also try this:You need to add another \ before your carbon class to start in the root namespace.Also, make sure Carbon is loaded in your composer.json.Laravel 5.2 <= 5.5In addition, this is how to change datetime format for given date & time, in blade:Laravel 5.6 <It may be a little late, but you could use the helper function time() to get the current timestamp. I tried this function and it did the job, no need for classes :). You can find this in the official documentation at https://laravel.com/docs/5.0/templatesRegards.With a \ before a Class declaration you are calling the root namespace:otherwise it looks for it at the current namespace declared at the beginning of the class. 

other solution is to use it:you can even assign it an alias:hope it helps.

Laravel 5.1 - Checking a Database Connection

Enijar

[Laravel 5.1 - Checking a Database Connection](https://stackoverflow.com/questions/33432752/laravel-5-1-checking-a-database-connection)

I am trying to check if a database is connected in Laravel.I've looked around the documentation and can't find anything. The closest thing I've found is this, but this doesn't solve my problem.I have three instances of MySQL that are set up on different machines. Below is a simplified version of what I am trying to achieve.To be clear, is there a way to check that a database is connected in Laravel 5.1?

2015-10-30 09:35:00Z

I am trying to check if a database is connected in Laravel.I've looked around the documentation and can't find anything. The closest thing I've found is this, but this doesn't solve my problem.I have three instances of MySQL that are set up on different machines. Below is a simplified version of what I am trying to achieve.To be clear, is there a way to check that a database is connected in Laravel 5.1?Try just getting the underlying PDO instance.  If that fails, then Laravel was unable to connect to the database!You can use alexw's solution with the Artisan. Run following commands in the command line.If connection is OK, you should see near the end of the response. You can use this, in a controller method or in an inline function of a route:You can use this query for checking database connection in laravel:For more information you can checkout this page https://laravel.com/docs/5.0/database.When Laravel tries to connect to database, if the connection fails or if it finds any errors it will return a PDOException error. We can catch this error and redirect the actionAdd the following code in the app/filtes.php file.Hope this is helpful.

Unable to Get Eloquent to Automatically Create Joins

Graham Kennedy

[Unable to Get Eloquent to Automatically Create Joins](https://stackoverflow.com/questions/11099570/unable-to-get-eloquent-to-automatically-create-joins)

Apologies in advance if the answer to my question is obvious. I have done my due diligence in researching this topic before I posted it here.Most of my framework experience comes from using CodeIgniter, so I've never had hands-on experience using ORM. (CI does have some off-the-shelf ORM solutions, but I've never used them.)I would like to use built-in ORM functionality in Laravel's Eloquent ORM to automatically join the tournaments and countries tables together when running a query, and return the data set that includes tournament data as well as its associated country data.That is, I want Eloquent to recognize the foreign key relationship automatically so that I can just run a query (e.g. Tournament:: with('Country')->all()) that will return the entire set of tournament and country data.Please stop me right now if I'm using Eloquent in a way that it was never intended to be used! My confusion may be more about me trying to mash together an untenable solution rather than syntax or coding error.I expect to receive an array of Tournament objects (in PHP), where a single Tournament object would look like:I ran all of these attempts in a dummy controller method and output the result as a formatted string to the profiler.PHP code in the dummy controller:Generates the following query:Attempt #1 returns:An array containing Tournament objects that only include the columns in the tournaments table.PHP code in the dummy controller:Generates the following error:I've tried various combinations of naming conventions (e.g. columns, tables, etc.) to no avail. I've also tried creating the query in Fluent, which worked fine, but required me to specify the joins which is what I'm trying to avoid.

2012-06-19 10:59:36Z

Apologies in advance if the answer to my question is obvious. I have done my due diligence in researching this topic before I posted it here.Most of my framework experience comes from using CodeIgniter, so I've never had hands-on experience using ORM. (CI does have some off-the-shelf ORM solutions, but I've never used them.)I would like to use built-in ORM functionality in Laravel's Eloquent ORM to automatically join the tournaments and countries tables together when running a query, and return the data set that includes tournament data as well as its associated country data.That is, I want Eloquent to recognize the foreign key relationship automatically so that I can just run a query (e.g. Tournament:: with('Country')->all()) that will return the entire set of tournament and country data.Please stop me right now if I'm using Eloquent in a way that it was never intended to be used! My confusion may be more about me trying to mash together an untenable solution rather than syntax or coding error.I expect to receive an array of Tournament objects (in PHP), where a single Tournament object would look like:I ran all of these attempts in a dummy controller method and output the result as a formatted string to the profiler.PHP code in the dummy controller:Generates the following query:Attempt #1 returns:An array containing Tournament objects that only include the columns in the tournaments table.PHP code in the dummy controller:Generates the following error:I've tried various combinations of naming conventions (e.g. columns, tables, etc.) to no avail. I've also tried creating the query in Fluent, which worked fine, but required me to specify the joins which is what I'm trying to avoid.Clearly with('Country') or with('country') doesn't do any different due to the fact that he managed to get following error:What wrong is how the relationship is defined: A tournament must have a country would be a tournament need to belong to a country, and not has one country. So to solve this change the relationship to According to the Eloquent docs:So with that in mind something like:Should be replicable in Eloquent. I personally use the query builder version just now which you may want to use but I will try and test with Eloquent when I get the chance and update this.UPDATE:Yep, using Eloquent's query builder methods you can have:This will return a Tournament model that includes the fields of both tables.HTHYour 'with' clause asks for 'Country', but your code declares it as 'country'.So, should:Be:Because in your Tournaments Model, you've defined this as:Does making this change solve it?You have to make sure your relationship is declared in your Tournament model:Also, you will have to declare the opposite in your Country model:At this point, you can access the tournament object associated with the country object like so:Let me know if this display each corresponding country to the tournament.

Laravel RESTful API versioning design

Sam Wong

[Laravel RESTful API versioning design](https://stackoverflow.com/questions/30239823/laravel-restful-api-versioning-design)

I am new to Laravel (4 and 5) and recently I am working on a RESTful API.

In order to allow  multiple version of the API, I am using URL to determine the version. I read follow this post and it seem most people following this approach:

How to organize different versioned REST API controllers in Laravel 4?Folders structures:And in UserController.php files I set the namespace accordingly:orand in routes:URL will be simple http://..../api/v1 for version 1 and http://..../api/v2 for version. This is straight forward.My questions is:

What if I am building minor upgrade of api, say v1.1 , how do I organize my folder structure? 

My thought was  this and it should be still fine as dot is valid name of folders? Also, how should I write the namespace? This is no namespace like this Is there naming convention I can refer to for using "dot" ?Note: I do not want to call it as version v2 because this is not a major upgrade.

2015-05-14 14:23:09Z

I am new to Laravel (4 and 5) and recently I am working on a RESTful API.

In order to allow  multiple version of the API, I am using URL to determine the version. I read follow this post and it seem most people following this approach:

How to organize different versioned REST API controllers in Laravel 4?Folders structures:And in UserController.php files I set the namespace accordingly:orand in routes:URL will be simple http://..../api/v1 for version 1 and http://..../api/v2 for version. This is straight forward.My questions is:

What if I am building minor upgrade of api, say v1.1 , how do I organize my folder structure? 

My thought was  this and it should be still fine as dot is valid name of folders? Also, how should I write the namespace? This is no namespace like this Is there naming convention I can refer to for using "dot" ?Note: I do not want to call it as version v2 because this is not a major upgrade.IMO, minor upgrades should not publish breaking changes to an API. So my suggestion is to stick to integer versioned APIs. Enhancements are no problems, but existing endpoints should behave as usual. This way your API-Versions would be in sync with the route-prefixes and the namespaces as well as the tests.EXAMPLEBe aware that you can of course keep track of the minor versions internally (e.g in SCM), but there should be no need for developers to change all of their API-Calls just to benefit from that little bugfix you published. Anyways, it is nice of course if you notify your clients of the newer minor versions and the bugfixes or enhancements they offer (blog, newsletter, ..)Let me add, that i am not aware of any RESTful APIs with minor API-URL-prefixes, so i guess this is quite a common practice.You can not use dots, use underscores instead.But...A well-designed api must have BC between minor versions, so you do not need to create new version for minor update, instead you need to write compatible code.

php artisan migrate throwing [PDO Exception] Could not find driver - Using Laravel

Vamshi Vangapally

[php artisan migrate throwing [PDO Exception] Could not find driver - Using Laravel](https://stackoverflow.com/questions/22463614/php-artisan-migrate-throwing-pdo-exception-could-not-find-driver-using-larav)

I have a bad experience while installing laravel. However, I was able to do so and move to the next level. I used generators and created my migrations. 

But when I type the last command It's throwing a PDOException - could not find driver.That's my configuration in config/database.php.I tried searching on stackoverflow and laravel forums and people suggest that it's PDO problem and not artisan's or php's - I followed those suggestions like adding in php.ini No positive result. It always says [PDOException]could not find driver.Can someone please help resolving this.Environment that I am using: Mac, laravel 4, MAMP PRO with php 5.4.4

2014-03-17 19:30:09Z

I have a bad experience while installing laravel. However, I was able to do so and move to the next level. I used generators and created my migrations. 

But when I type the last command It's throwing a PDOException - could not find driver.That's my configuration in config/database.php.I tried searching on stackoverflow and laravel forums and people suggest that it's PDO problem and not artisan's or php's - I followed those suggestions like adding in php.ini No positive result. It always says [PDOException]could not find driver.Can someone please help resolving this.Environment that I am using: Mac, laravel 4, MAMP PRO with php 5.4.4You can useororThis worked for me.This worked for me:This installed sqlite for php5, then I ran the php artisan migrate command again and worked perfectly.You need to specifically enable the pdo_mysql plugin. Assuming you're using a standard PHP installation, then generally you would simply need to add this to your PHP.ini file:You need to ensure that this file exists in the extension directory though.Adding pdo_pgsql.so doesn't help because that is for PostgreSQL.Additionally, you should ensure that you restart the web-server after you make the changes to the PHP ini file, as the changes may not be reflected otherwise.Ran into the same issue here, and turns out this is because PHP at the command line uses a different php.ini file from the browser version, which is why it looks like it's loading the extension correctly when you look at phpinfo() in a browser.As per this answer, you just need to run:At the command line, which will tell you the path to the currently loaded php.ini (probably actually a php-cli.ini file located in the same place as your regular php.ini file).Once you've found that, modify it with the pdo extensions you want (in this case for MySQL):Or, for any other users that are on Windows using some kind of WAMP server, it probably looks like this instead:I think you missed the mysql driver for php5.

Execute below command:Please check your Laravel .env file also. Make sure DB_CONNECTION=mysql, otherwise it won't work with MySQL. It tried to load something else.You are missing a PDO driver.First install the driver For ubuntu: For mysql database.You also can search for other database systems.You also can search for the driver:Had the same issue and just figured, website is running under MAMP's php, but when you call in command, it runs mac's(if no bash path modified). you will have issue when mac doesn't have those extensions.run php -i to find out loaded extensions, and install those one you missed. or run '/Applications/MAMP/bin/php/php5.3.6/bin/php artisan {your command}' to use MAMP'sI was also getting the same error --> "[PDOException]

  could not find driver "After that I used many commands but not didn't get any helpFinally I used the following command, which solved my problem.sudo apt-get install php5-sqliteLaravel Testing with sqlite needs php pdo sqlite driversFor Ubuntu 14.04In ubuntu 16.04 there is no php5-sqliteYou must be installing the latest version of php mysql

in my case I am install php7.1-mysqlTry thisI am using the latest version of laravelI got this error for the PostgreSQL and the solution is:You only need to use your installed PHP version, mine is 7.1.

This has fixed the issue for PostgreSQL.I'm unsing ubuntu 14.04Below command solved this problem for me.In my case, after updating my php version from 5.5.9 to 7.0.8 i received this error including two other errors.errors: Solutions:I installed this packages and my problems are gone.I had this problem on debian. The issue was, I was using the dotdeb repository for more recent PHP packages. For some reason, it updated the php cli to 7.0, while the web php binary remained php 5.6. I used this answer to link the php command line binary to the 5.6 version, like so:This worked with me:(for pgsql: use 'pgsql' instead of 'mysql')Step 1)Step 2)Step 3)Step 4)

Then restart your server, and generate key again and migrate it, Its Donefirst check your php version  like this : after you get  version number for example i get 7.1 then install like thatand need to restart apache2For future searchers.

On FreeBSD try the next if you see the empty line in return do the following:and the do the installthen simply restart your apache and you are donee.g.  sudo /usr/local/etc/rc.d/apache22 restart

Install it via this command sudo apt-get install php5-gdthis worked for me.In my case I wasn't aware that the PHP run by Apache was different from the one run by CLI. That might be the case if during configuration in httpd.conf you specified a PHP module, not being the default one your CLI uses.I found the proper solution for this error! Either you don't have any database installed or your default database in this file

config/database.php

is set to some other database like thischange the default to which one you have installed or install that database which is made to be default! I had installed mysql and php artisan migrate worked after i changed that line to this:I was also getting the same error --> "[PDOException]

could not find driver "I realized that the php was pointing to /usr/bin/php instead of the lampp /opt/lampp/bin/php so i simply created

and aliasalias php="/opt/lampp/bin/php" also had to make update to the .env file to ensure the database access credentials were updated.And guess what, it Worked!If you are using Laravel 5.x, and the error is from trying to modify the attributes of a column, it is possible the error comes from a missing pre-requisite.Try this:Then try running your migrations.From here:

https://laravel.com/docs/master/migrations#modifying-columnsjust replaced: ;extension=pdo_mysql to extension=pdo_mysql in php.ini file.If you are using arch based system like in manjaro just use Restart your httpdfor those users of windows 10 and WAMP that found this post, i have a solution.Please go visit this link. It worked for me and it was difficult to come to the solution but i hope it might be of help for others in the future.Assuming you did the normal installation with virtual box, vagrant etc..

This can happen to new people.

PHP can be installed on your PC but all the modules PHP for your laravel project is on your VM

So to access your VM, go to your homestead folder and type:

vagrant sshthen to go your project path and execute the php artisan migrate.

Laravel Eloquent get results grouped by days

jct

[Laravel Eloquent get results grouped by days](https://stackoverflow.com/questions/20603075/laravel-eloquent-get-results-grouped-by-days)

I currently have a table of page_views that records one row for each time a visitor accesses a page, recording the user's ip/id and the id of the page itself. I should add that the created_at column is of type: timestamp, so it includes the hours/minutes/seconds. When I try groupBy queries, it does not group same days together because of the seconds difference.I'd like to get results based on views/day, so I can get something like:I'm thinking I'll need to dig into DB::raw() queries to achieve this, but any insight would help greatly, thanksEdit: Added clarification of created_at format.

2013-12-16 03:40:46Z

I currently have a table of page_views that records one row for each time a visitor accesses a page, recording the user's ip/id and the id of the page itself. I should add that the created_at column is of type: timestamp, so it includes the hours/minutes/seconds. When I try groupBy queries, it does not group same days together because of the seconds difference.I'd like to get results based on views/day, so I can get something like:I'm thinking I'll need to dig into DB::raw() queries to achieve this, but any insight would help greatly, thanksEdit: Added clarification of created_at format.I believe I have found a solution to this, the key is the DATE() function in mysql, which converts a DateTime into just Date:However, this is not really an Laravel Eloquent solution, since this is a raw query.The following is what I came up with in Eloquent-ish syntax. The first where clause uses carbon dates to compare.You can use Carbon (integrated in Laravel) Here is how I do it. A short example, but made my query much more manageableYou can filter the results based on formatted date using mysql (See here for Mysql/Mariadb help) and use something like this in laravel-5.4:I had same problem, I'm currently using Laravel 5.3.I use DATE_FORMAT()

Hopefully this will help you.Like most database problems, they should be solved by using the database.Storing the data you want to group by and using indexes you can achieve an efficient and clear method to solve this problem.To group data according to DATE instead of DATETIME, you can use CAST function.Warning: untested code.Using Laravel 4.2 without CarbonHere's how I grab the recent ten days and count each row with same day created_at timestamp.Hope this helpsin mysql you can add MONTH keyword having the timestamp as a parameter

in laravel you can do it like thisI built a laravel package for making statistics : https://github.com/Ifnot/statisticsIt is based on eloquent, carbon and indicators so it is really easy to use. It may be usefull for extracting date grouped indicators.```I know this is an OLD Question and there are multiple answers. How ever according to the docs and my experience on laravel below is the good "Eloquent way" of handling thingsIn your model, add a mutator/Getter like thisAnother way is to cast the columns

in your model, populate the $cast arrayThe catch here is that you won't be able to use the Carbon on this model again since Eloquent will always cast the column into stringHope it helps :)You could also solve this problem in following way:

Laravel 5.4 Disable Register Route

Dev.Wol

[Laravel 5.4 Disable Register Route](https://stackoverflow.com/questions/42695917/laravel-5-4-disable-register-route)

I am trying to disable the register route on my application which is running in Laravel 5.4.In my routes file, I have only theIs there any way to disable the register routes?

2017-03-09 12:52:38Z

I am trying to disable the register route on my application which is running in Laravel 5.4.In my routes file, I have only theIs there any way to disable the register routes?The code:its a shorcut for this collection of routes:So you can substitute the first with the list of routes and comment out any route you don't want in your application.Edit for laravel version => 5.7 In newer versions you can add a parameter to the Auth::routes() function call to disable the register routes:The email verification routes were added:BTW you can also disable Password Reset and Email Verification routes:Since Laravel 5.7, a new $options parameter is introduced to the Auth::routes() method; through which you can pass an array to control the generation of the required routes for user-authentication (valid entries can be chosen from the 'register', 'reset', or 'verify' string literals).You could try this. Add those routes just below the Auth::routes() to override the default registration routes. Any request to the /register route will redirect to the baseUrl. This is deceptively easy! You just need to override two methods in your app/Http/Controllers/Auth/RegisterController.php Class. See below which will prevent the form from being displayed and most importantly block direct POST requests to your application for registrations..In web.php, Replace Auth::routes();WithAuth::routes(['register' => false]);So that you can remove register route from default auth route list. i tried in 5.7 and it worked fine.Though the above solutions work but, I think changing the middleware to 'auth' in the App\Http\Controllers\Auth\RegisterController will be one of the easiest solutions. This will redirect all visitors to login page if they want to access any of the registration routes. Like this:I suppose you want to restrict access to some pages for guests and only the admin can register a guest. You can achieve it by adding your own middleware on kernel.php file like below:After creating the middleware you have to use it so you can go on web.php file where your routes are and add it to the route you want to restrict like below:This way registration is restricted to guests but the admin can still access the page if he ever want to register some other admin!Don't forget to replace the Auth::routes(); with the detailed list as below:I guess you can do it like this, in your web.php file:On my Laravel 5.6 project this method didn't work:So I had to use the following method:Add this two method to app\Http\Controllers\Auth\RegisterController.phpJust overwrite your auth showRegistrationForm() method ( place this code inside your Auth/RegisterController )public function showRegistrationForm()

    {

        return redirect()->route('login');

    }I'm just redirecting my register route to login route. Here you don't need to append or remove any other codeYes, there is a wayRemote that route from your web.php in your routes directory.That route is what controls registration.Change to routes :

How to solve a timeout error in Laravel 5

Geordie Gadgie

[How to solve a timeout error in Laravel 5](https://stackoverflow.com/questions/30270316/how-to-solve-a-timeout-error-in-laravel-5)

I have the following set up:In routes I have:Route::get('articles', 'ArticlesController@index');The index method in the controller is simply:and in the view:I attempted to replace the: withsuch that I can actually show the articles latest first.

I got the error:and the call stack is:... etcI have restored the controller method to what it was, but the error persists.Can you please tell me how I can solve this problem?

2015-05-15 23:49:11Z

I have the following set up:In routes I have:Route::get('articles', 'ArticlesController@index');The index method in the controller is simply:and in the view:I attempted to replace the: withsuch that I can actually show the articles latest first.

I got the error:and the call stack is:... etcI have restored the controller method to what it was, but the error persists.Can you please tell me how I can solve this problem?The Maximum execution time of 30 seconds exceeded error is not related to Laravel but rather your PHP configuration.Here is how you can fix it. The setting you will need to change is max_execution_time. You can change the max_execution_time to 300 seconds like max_execution_time = 300You can find the path of your PHP configuration file in the output of the phpinfo function in the Loaded Configuration File section.it's a pure PHP setting.

The alternative is to increase the execution time limit only for specific php scripts, by inserting on top of that php file, the following:In Laravel:Add set_time_limit(0) line on top of query.It helps you in different large queries but you should need to improve query optimise. Sometimes you just need to optimize your code or query, Setting more max_execution_time is not a solution.A code should not be run more than 30s.set time limit in __construct method or you can set in your index controller also where you want to have large time limit.trywhere $time is in seconds, set it to 0 for no time. make sure to make it 60 back after your function finishIf using PHP7, I would suggest you changing the default value in the public/.htaccess Execution  is not related to laravel go to the php.ini file 

In php.ini file  set max_execution_time=360 (time may be variable depends on need)

if you want to increase execution of a specific page then write ini_set('max_execution_time',360) at top of page otherwise in htaccess 

php_value max_execution_time 360

Add above query ini_set("memory_limit", "10056M");If you are hosting your Laravel app on Heroku, you can create custom_php.ini in the root of your project and simply add max_execution_time = 60

    

        Options -MultiViews -Indexes

    You need to just press CTRL + F5. It will work after that. 

Laravel default orderBy

M K

[Laravel default orderBy](https://stackoverflow.com/questions/20701216/laravel-default-orderby)

Is there a clean way to enable certain models to be ordered by a property by default?

It could work by extending the laravel's QueryBuilder, but to do so, you'll have to rewire some of it's core features - bad practice.reasonThe main point of doing this is - one of my models get's heavily reused by many others and right now you have to resort the order over and over again. Even when using a closure for this - you still have to call it. It would be much better to be able to apply a default sorting, so everyone who uses this model, and does not provide custom sorting options, will receive records sorted by the default option. Using a repository is not an option here, because it get's eager loaded.SOLUTIONExtending the base model:In your model:In your controller:

2013-12-20 10:13:24Z

Is there a clean way to enable certain models to be ordered by a property by default?

It could work by extending the laravel's QueryBuilder, but to do so, you'll have to rewire some of it's core features - bad practice.reasonThe main point of doing this is - one of my models get's heavily reused by many others and right now you have to resort the order over and over again. Even when using a closure for this - you still have to call it. It would be much better to be able to apply a default sorting, so everyone who uses this model, and does not provide custom sorting options, will receive records sorted by the default option. Using a repository is not an option here, because it get's eager loaded.SOLUTIONExtending the base model:In your model:In your controller:Yes you would need to extend Eloquent to always do this as standard for any query. What's wrong with adding an order by statement to the query when you need it ordered? That is the cleanest way, ie, you dont need to 'unhack' Eloquent to get results by natural order.Other than that the closest thing to what you want would be to create query scopes in your models.You can then call ordered as a method instead of get to retrieve your ordered results.If you wanted this across different models you could create a base class and just extend it to the models you want to have access to this scoped method.Nowadays we can solve this problem also with global scopes, introduced in Laravel 4.2 (correct me if I'm wrong). We can define a scope class like this:Then, in your model, you can add the scope in the boot() method:Now the model is ordered by default. Note that if you define the order also manually in the query: MyModel::orderBy('some_column'), then it will only add it as a secondary ordering (used when values of the first ordering are the same), and it will not override. To make it possible to use another ordering manually, I added an (optional) macro (see above), and then you can do: MyModel::unordered()->orderBy('some_column')->get().Laravel 5.2 introduced a much cleaner way to work with global scopes. Now, the only thing we have to write is the following:Then, in your model, you can add the scope in the boot() method:To remove the global scope, simply use:Solution without extra scope classIf you don't like to have a whole class for the scope, you can (since Laravel 5.2) also define the global scope inline, in your model's boot() method:You can remove this global scope using this:Another way of doing this could be by overriding the newQuery method in your model class. This only works if you never, ever want results to be ordered by another field (since adding another ->orderBy() later won't remove this default one). So this is probably not what you'd normally want to do, but if you have a requirement to always sort a certain way, then this will work:In Laravel 5.7, you can now simply use addGlobalScope inside the model's boot function:In the above example, I order the model by created_at desc to get the most recent records first. You can change that to fit your needs.you should use eloquent global scope that can apply to all queries(also you can set parameter for it).And for relations you can use this useful trick:this will add order by to all posts when we get them from a category.

If you add an order by to your query, this default order by will cancel!An slightly improved answer given by Joshua Jabbouryou can use the code he offered in a Trait, and then add that trait to the models where you want them to be ordered.then in whichever model you want the data to be ordered you can use use :now everytime you request that model, data will be ordered, that's somehow more organized, but my answers is Jabbour's answer.A note from my experience, never to use orderBy and GroupBy such term on global scope. Otherwise you will easily face database errors while fetching related models in other places.Error may be something like:Thanks.

How add Custom Validation Rules when using Form Request Validation in Laravel 5

gsk

[How add Custom Validation Rules when using Form Request Validation in Laravel 5](https://stackoverflow.com/questions/28793716/how-add-custom-validation-rules-when-using-form-request-validation-in-laravel-5)

I am using form request validation method for validating request in laravel 5.I would like to add my own validation rule with form request validation method.My request class is given below.I want to add custom validation numeric_array with field items.My cusotom function is given belowHow can use this validation method with about form request validation in laravel5? 

2015-03-01 12:48:46Z

I am using form request validation method for validating request in laravel 5.I would like to add my own validation rule with form request validation method.My request class is given below.I want to add custom validation numeric_array with field items.My cusotom function is given belowHow can use this validation method with about form request validation in laravel5? Using Validator::extend() like you do is actually perfectly fine you just need to put that in a Service Provider like this:Then register the provider by adding it to the list in config/app.php:You now can use the numericarray validation rule everywhere you wantWhile the above answer is correct, in a lot of cases you might want to create a custom validation only for a certain form request. You can leverage laravel FormRequest and use dependency injection to extend the validation factory. I think this solution is much simpler than creating a service provider.Here is how it can be done. The accepted answer works for global validation rules, but many times you will be validating certain conditions that are very specific to a form. Here's what I recommend in those circumstances (that seems to be somewhat intended from Laravel source code at line 75 of FormRequest.php):Add a validator method to the parent Request your requests will extend:Now all your specific requests will look like this: You need to override getValidatorInstance method in your Request class, for example this way:Custom Rule ObjectOne way to do it is by using Custom Rule Object, this way you can define as many rule as you want without need to make changes in Providers and in controller/service to set new rules.In NumericArray.phpThen in Form request haveYou don't need to extend the validator to validate array items, you can validate each item of a array with "*" as you can see in

Array ValidationAlternatively to Adrian Gunawan's solution this now also can be approached like:For me works the solution that give us lukasgeiter, but with a difference that we create a class with our custom validations ,like this, for laravel 5.2.* The next example is for add a validation to a range of date in where the second date has to be equals or more big that the first oneIn app/Providers create ValidatorExtended.phpOk. now lets create the Service Provider. Create ValidationExtensionServiceProvider.php inside app/Providers, and we codeNow we to tell Laravel to load this Service Provider, add to providers array at the end in config/app.php andnow we can use this validation in our request in function rulesor in Validator:makeyou have to notice that the name of the method that makes the validation has the prefix validate and is in camel case style validateAfterOrEqual but when you use the rule of validation every capital letter is replaced with underscore and the letter in lowercase letter.All this I take it from https://www.sitepoint.com/data-validation-laravel-right-way-custom-validators// here explain in details. thanks to them.All answers on this page will solve you the problem, but... But the only right way by the Laravel conventions is solution from Ganesh KarkiOne example:Let’s take an example of a form to fill in Summer Olympic Games events – so year and city. First create one form.Now, let’s create a validation rule that you can enter only the year of Olympic Games. These are the conditionsLet’s run a command:php artisan make:rule OlympicYearLaravel generates a file app/Rules/OlympicYear.php. Change that file to look like this:namespace App\Rules;use Illuminate\Contracts\Validation\Rule;class OlympicYear implements Rule

{}Finally, how we use this class? In controller's store() method we have this code:If you want to create validation by Laravel conventions follow tutorial in link below. It is easy and very well explained. It helped me a lot. Link for original tutorial is here Tutorial link.

hasMany vs belongsToMany in laravel 5.x

user101289

[hasMany vs belongsToMany in laravel 5.x](https://stackoverflow.com/questions/36208460/hasmany-vs-belongstomany-in-laravel-5-x)

I'm curious why the Eloquent relationship for hasMany has a different signature than for belongsToMany. Specifically the custom join table name-- for a system where a given Comment belongs to many Roles, and a given Role would have many Comments, I want to store the relationship in a table called my_custom_join_table and have the keys set up as comment_key and role_key.But on the inverse, I can't define that custom table (at least the docs don't mention it):If I have a Role object that hasMany Comments, but I use a non-standard table name to store that relationship, why can I use this non-standard table going one way but not the other?

2016-03-24 19:25:47Z

I'm curious why the Eloquent relationship for hasMany has a different signature than for belongsToMany. Specifically the custom join table name-- for a system where a given Comment belongs to many Roles, and a given Role would have many Comments, I want to store the relationship in a table called my_custom_join_table and have the keys set up as comment_key and role_key.But on the inverse, I can't define that custom table (at least the docs don't mention it):If I have a Role object that hasMany Comments, but I use a non-standard table name to store that relationship, why can I use this non-standard table going one way but not the other?hasMany is used in a One To Many relationship while belongsToMany refers to a Many To Many relationship. They are both distinct relationship types and each require a different database structure - thus they take different parameters.The key difference is that in a One To Many relationship, you only need the two database tables that correspond to the related models. This is because the reference to the relation is stored on the owned model's table itself. For instance, you might have a Country model and a City model. A Country has many cities. However, each City only exists in one country. Therefore, you would store that country on the City model itself (as country_id or something like that).However, a Many To Many relationship requires a third database table, called a pivot table. The pivot table stores references to both the models and you can declare it as a second parameter in the relationship declaration. For example, imagine you have your City model and you also have a Car model. You want a relationship to show the types of cars people drive in each city. Well, in one city people will drive many different types of car. However, if you look at one car type you will also know that it can be driven in many different cities. Therefore it would be impossible to store a city_id or a car_id on either model because each would have more than one. Therefore, you put those references in the pivot table.As a rule of thumb, if you use a belongsToMany relationship, it can only be paired with another belongsToMany relationship and means that you have a third pivot table. If you use a hasMany relationship, it can only be paired with a belongsTo relationship and no extra database tables are required.In your example, you just need to make the inverse relation into a belongsToMany and add your custom table again, along with the foreign and local keys (reversing the order from the other model).Try to understand with text and a figure.

Laravel - Check if @yield empty or not

user2840318

[Laravel - Check if @yield empty or not](https://stackoverflow.com/questions/20412738/laravel-check-if-yield-empty-or-not)

Is it possible to check into a blade view if @yield have content or not?I am trying to assign the page titles in the views:So I would like to check in the main layout view... something like:

2013-12-05 23:11:08Z

Is it possible to check into a blade view if @yield have content or not?I am trying to assign the page titles in the views:So I would like to check in the main layout view... something like:There is probably a prettier way to do this. But this does the trick.In Laravel 5 we now have a hasSection method we can call on a View facade.You can use View::hasSection to check if @yeild is empty or not:This conditional is checking if a section with the name of title was set in our view. Tip: I see a lot of new artisans set up their title sections like this:but you can simplify this by just passing in a default value as the second argument:  The hasSectionmethod was added April 15, 2015. For those looking on it now (2018+), you can use : See : https://laravel.com/docs/5.6/blade#control-structuresGiven from the docs:Type in your main layout e.g. "app.blade.php", "main.blade.php", or "master.blade.php"And in the specific view page (blade file) type as follows:You can simply check if the section exists:And you can even go a step further and pack this little piece of code into a Blade extension: http://laravel.com/docs/templates#extending-bladewhy not pass the title as a variable View::make('home')->with('title', 'Your Title') this will make your title available in $titleI don't think you can, but you have options, like using a view composer to always provide a $title to your views:Can you not do:layout.blade.php<title> Sitename.com @section("title") Default @show </title>And in subtemplate.blade.php:The way to check is to not use the shortcut '@' but to use the long form: Section.Building on Collin Jame's answer, if it is not obvious, I would recommend something like this:Sometimes you have an enclosing code, which you only want to have included in that section is not empty. For this problem I just found this solution:The title H2 gets only displayed it the section really contains any value. Otherwise it won't be printed...Complete simple answerI have a similar problem with the solution:The result will be the empty <div></div>Now, my suggestion, to fix this, is

Laravel nested relationships

Miguel Stevens

[Laravel nested relationships](https://stackoverflow.com/questions/25628754/laravel-nested-relationships)

I'm having trouble getting a very-nested relationship to work correctly in laravel.The wanted behaviour is as follows, I select an event by ID and i want to see which persons are subscribed to it.

Now the problem is there are some tables between the event and the person..This is the query that works!andAnd many other possibilities, I'm really stuck on this. Is it so difficult in laravel to achieve this kind of nested relationship linking?Thanks!

2014-09-02 17:08:52Z

I'm having trouble getting a very-nested relationship to work correctly in laravel.The wanted behaviour is as follows, I select an event by ID and i want to see which persons are subscribed to it.

Now the problem is there are some tables between the event and the person..This is the query that works!andAnd many other possibilities, I'm really stuck on this. Is it so difficult in laravel to achieve this kind of nested relationship linking?Thanks!If you only want to select certain fields from the persons table, use this:For city and companies specific fields , you need to distribute the with eloquent.

Eg: I created a HasManyThrough relationship for cases like this: Repository on GitHubAfter the installation, you can use it like this:You can get attributes from intermediate tables with withIntermediate():To expand on @rashmi-nalwaya 's answer. I got it working for a 5.8 project with some tweaks.My example was a bit different because I am trying to reference hasOne relations, rather than hasMany.So for reference, Domains belong to one Website, which belongs to one Server.  I only wanted to return certain columns from all of those tables.  I had to do this.Had to make sure I passed through the primary key for the table I'm on at any time (so the id in my case), and secondly, the foreign key of the related table I'm trying to get to.  So website_id from domain, and server_id from website.  Then it worked perfectly.In my code I also have a further where clause on the main domain, after all this with-ness.

Laravel 5: Handle exceptions when request wants JSON

Jonathon

[Laravel 5: Handle exceptions when request wants JSON](https://stackoverflow.com/questions/28944097/laravel-5-handle-exceptions-when-request-wants-json)

I'm doing file uploads via AJAX on Laravel 5. I've got pretty much everything working except one thing.When I try to upload a file that is too big (Bigger than upload_max_filesize and post_max_size I get a TokenMismatchException thrown.This is to be expected however, because I know that my input will be empty if these limits are being exceeded. Empty input, means no _token is received hence why the middleware responsible for verifying CSRF tokens is kicking up a fuss.My issue however is not that this exception is being thrown, it is how it is being rendered. When this exception is being caught by Laravel it's spitting out the HTML for the generic Whoops page (With a load of stack tracing since I'm in debug mode).What's the best way to handle this exception so that JSON is returned over AJAX (Or when JSON is requested) while keeping the default behaviour otherwise?Edit: This seems to happen regardless of the exception thrown. I've just tried making a request via AJAX (Datatype: JSON) to a 'page' that doesn't exist in an attempt to get a 404 and the same thing happens - HTML is returned, nothing JSON friendly.

2015-03-09 14:12:02Z

I'm doing file uploads via AJAX on Laravel 5. I've got pretty much everything working except one thing.When I try to upload a file that is too big (Bigger than upload_max_filesize and post_max_size I get a TokenMismatchException thrown.This is to be expected however, because I know that my input will be empty if these limits are being exceeded. Empty input, means no _token is received hence why the middleware responsible for verifying CSRF tokens is kicking up a fuss.My issue however is not that this exception is being thrown, it is how it is being rendered. When this exception is being caught by Laravel it's spitting out the HTML for the generic Whoops page (With a load of stack tracing since I'm in debug mode).What's the best way to handle this exception so that JSON is returned over AJAX (Or when JSON is requested) while keeping the default behaviour otherwise?Edit: This seems to happen regardless of the exception thrown. I've just tried making a request via AJAX (Datatype: JSON) to a 'page' that doesn't exist in an attempt to get a 404 and the same thing happens - HTML is returned, nothing JSON friendly.I'm going to take a shot at this one myself taking into account the answer given by @Wader and the comments from @Tyler Crompton:app/Exceptions/Handler.phpIn your application you should have app/Http/Middleware/VerifyCsrfToken.php. In that file you can handle how the middleware runs. So you could check if the request is ajax and handle that how you like.Alternativly, and probably a better solution, would be to edit the exception handler to return json. See app/exceptions/Handler.php, something like the below would be a starting placeBuilding on @Jonathon's handler render function, I would just modify the conditions to exclude ValidationException instances. Laravel 5 returns validation errors in JSON already if appropriate.The full method in App/Exceptions/Handler.php:I have altered several implementations found here to work on Laravel 5.3.

The main difference is that mine will return the correct HTTP status textsIn your render() function in app\Exceptions\Handler.php add this snippet to the top:Contents of renderExceptionAsJson:Using @Jonathon's code, here's a quick fix for Laravel/Lumen 5.3 :)Quick note on this... In Laravel 5.5 the exception is named "$exception" and not "$e" in the method. 

Laravel: validate an integer field that needs to be greater than another

Alexandre Thebaldi

[Laravel: validate an integer field that needs to be greater than another](https://stackoverflow.com/questions/32036882/laravel-validate-an-integer-field-that-needs-to-be-greater-than-another)

I have two fields that are optional only if both aren't present:Now, end_page needs to be greater than initial_page. How include this filter?

2015-08-16 15:35:50Z

I have two fields that are optional only if both aren't present:Now, end_page needs to be greater than initial_page. How include this filter?There is no built-in validation that would let you compare field values like that in Laravel, so you'll need to implement a custom validator, that will let you reuse validation where needed. Luckily, Laravel makes writing custom validator really easy.Start with defining new validator in yor AppServiceProvider:Now you can use your brand new validation rule in your $rules:You'll find more info about creating custom validators here: http://laravel.com/docs/5.1/validation#custom-validation-rules. They are easy to define and can then be used everywhere you validate your data.For Laravel 5.4 it will be:As of Laravel 5.6 gt, gte, lt and lte rules are added.I think you can try something like this,the question was asked in 2015 so most of the answers are also outdated now in 2019i want to give answer which uses features provided by laravel team which is included in it's new version,so as stated by @Sarpadoruk as of laravel 5.6 laravel added features in validation like 

gt,gte,lt and lte which means:so using gt you can check that your end_page should be greater than your initial_page and your task becomes very easy now:Why not just define $min_number = $min + 1 number and use validator min:$min_number, example:And you can then return custom error message to explain the error to user.

eloquent laravel: How to get a row count from a ->get()

JP Foster

[eloquent laravel: How to get a row count from a ->get()](https://stackoverflow.com/questions/33676576/eloquent-laravel-how-to-get-a-row-count-from-a-get)

I'm having a lot of trouble figuring out how to use this collection to count rows. I have tried adding->count() but didn't work. I have tried doing count($wordlist). I'm not really sure what to do without needing a second request as a->count() method. 

2015-11-12 16:34:57Z

I'm having a lot of trouble figuring out how to use this collection to count rows. I have tried adding->count() but didn't work. I have tried doing count($wordlist). I'm not really sure what to do without needing a second request as a->count() method. Answer has been updatedcount is a Collection method. The query builder returns an array. So in order to get the count, you would just count it like you normally would with an array:If you have a wordlist model, then you can use Eloquent to get a Collection and then use the Collection's count method. Example:There is/was a discussion on having the query builder return a collection here: https://github.com/laravel/framework/issues/10478However as of now, the query builder always returns an array.Edit: As linked above, the query builder now returns a collection (not an array). As a result, what JP Foster was trying to do initially will work:However, as indicated by Leon in the comments, if all you want is the count, then querying for it directly is much faster than fetching an entire collection and then getting the count. In other words, you can do this:Direct get a count of row Using EloquentUsing query builderIts better to access the count with the laravels count method orit's work me Step 1Add in headerStep 2use in div tag 

Skip model accessor

LHolleman

[Skip model accessor](https://stackoverflow.com/questions/17543843/skip-model-accessor)

I got a model called Run which contains this method:I need this setup for laravel administrator, since alot of runs will have the same name and the only difference is the race name. But in 1 place in the website i need to get the name only, without mutating. Is this possbile?

2013-07-09 08:49:34Z

I got a model called Run which contains this method:I need this setup for laravel administrator, since alot of runs will have the same name and the only difference is the race name. But in 1 place in the website i need to get the name only, without mutating. Is this possbile?this is the correct wayhttps://laravel.com/api/5.2/Illuminate/Database/Eloquent/Model.html#method_getOriginalEdit: Careful! As Maksym Cierzniak explained in the comments, getOriginal() doesn't just skip mutators, it also returns the "original" value of the field at the time the object was read from the database.  So if you have since modified the model's property, this won't return your modified value, it will still return the original value.  The more consistent and reliable way to get the un-mutated value from within the model class is to retrieve it from the attributes property like this:  But be aware that attributes is a protected property, so you can't do that from outside the model class. In that case, you can use or Maksym's technique from his comment below.I was running into an issue with Eloquent accessors and form model binding - by formatting an integer with money_format, the value was no longer being loaded into the form number input field.The workaround I am using is to create an accessor with a different name:This provides me with an accessor without affecting the form model binding.

How to test file upload in Laravel 5.2

Ramin

[How to test file upload in Laravel 5.2](https://stackoverflow.com/questions/36408134/how-to-test-file-upload-in-laravel-5-2)

Im trying to test an upload API but it fails every time: Test Code :Here is My Upload code in a controller :How should I test file upload in Laravel 5.2? How to use call method to upload a file?

2016-04-04 16:35:11Z

Im trying to test an upload API but it fails every time: Test Code :Here is My Upload code in a controller :How should I test file upload in Laravel 5.2? How to use call method to upload a file?When you create an instance of UploadedFile set the last parameter $test to true.Here is a quick example of a working test. It expects that you have a stub test.png file in tests/stubs folder.In Laravel 5.4 you can also use \Illuminate\Http\UploadedFile::fake(). A simple example below:If you want to fake a different file type you can use More information directly on Laravel Documentation.You can find this code at this linkSetupUsageFolder Structure:The laravel documentation has an answer for when you want to test a fake file. When you want to test using a real file in laravel 6 you can do the following:

What is the purpose of the server.php file in Laravel 4?

Michael Irigoyen

[What is the purpose of the server.php file in Laravel 4?](https://stackoverflow.com/questions/16919920/what-is-the-purpose-of-the-server-php-file-in-laravel-4)

In the /app/ directory in Laravel 4, there is a file called server.php. The contents of this file look like this:It seems that this file is in someway used to mimic Apache's mod_rewrite functionality, however I cannot find anything in the Laravel documentation that mentions it or it's use.I currently am trying to utilize Laravel on an IIS server that I do not manage. I do not have the ability to modify the URL rewrite module options on IIS (I will in the future), but would like to get started working with the framework now, if possible. This server.php file seems like it may be a stop-gap solution to do just that.Can anyone shed some light on the purpose of the server.php file and how to use/activate it if the purpose is really to emulate Apache's mod_rewrite functionality?

2013-06-04 14:02:45Z

In the /app/ directory in Laravel 4, there is a file called server.php. The contents of this file look like this:It seems that this file is in someway used to mimic Apache's mod_rewrite functionality, however I cannot find anything in the Laravel documentation that mentions it or it's use.I currently am trying to utilize Laravel on an IIS server that I do not manage. I do not have the ability to modify the URL rewrite module options on IIS (I will in the future), but would like to get started working with the framework now, if possible. This server.php file seems like it may be a stop-gap solution to do just that.Can anyone shed some light on the purpose of the server.php file and how to use/activate it if the purpose is really to emulate Apache's mod_rewrite functionality?It is meant to be used with PHP's internal web server which was introduced in PHP 5.4.According to the PHP manual:I can't emphasize this enough.If you would like to use it with the Laravel server.php file you can head to your cli and start the server with the following command (from the root of your Laravel directory):You should then be able to head to localhost:8000 in your web browser and begin using your Laravel application.Alternatively as Anand Capur mentioned you can launch the server with:Ultimately this just runs the aforementioned php -S command for you.You can optionally specify the host and port by doing something like:As with all artisan commands you can find out this information and additional information by doing:You can also use the commandartisan serve which will run the appropriate command to start the development server.

Posting JSON To Laravel

Joel_Blum

[Posting JSON To Laravel](https://stackoverflow.com/questions/21219482/posting-json-to-laravel)

I am trying to make a post request of json to Laravel. The request is received on the server however when I try to access a property I get: 

"Trying to get property of non-object".

On the client I'm using angularjs.angular: laravel: Note: I can see in Fiddler that the JSON being sent is valid and that it reaches the controller+method (http 200).The post request itself (As seen with Fiddler) 

2014-01-19 16:37:23Z

I am trying to make a post request of json to Laravel. The request is received on the server however when I try to access a property I get: 

"Trying to get property of non-object".

On the client I'm using angularjs.angular: laravel: Note: I can see in Fiddler that the JSON being sent is valid and that it reaches the controller+method (http 200).The post request itself (As seen with Fiddler) Laravel's Input::all method returns an associative array, not an object of PHP's stdClass.Please note as of Laravel 5.0, the Input facade has been removed from the official documentation (and in 5.2 it was also removed from the list of default Facades provided) in favor of directly using the Request class that Input invokes, which is Illuminate\Http\Request.Also, as of the Laravel 5.1 documentation, all references to the Request facade have been removed, again in preference of using the Illuminate\Http\Request instance directly, which it encourages you to do via dependency injection in either:...your Controller Method:...or a Route Closure (as of 5.3):It's worth noting that $request->json() returns an instance of Symfony\Component\HttpFoundation\ParameterBag, and that ParameterBag's ->all() method returns an associative array, and not an object as the OP expected.So one would now fetch the rough equivalent of $_POST['id'] as follows:Both facades have been removed from the official documentation (as of 5.1), and yet they both also remain in the source code with no 'deprecated' label.As mentioned earlier, Input was removed as a default facade ('alias') in 5.2, but as of 5.4, the Request facade remains a default.This seems to imply that one could still use the Request facade to invoke methods on the Request instance (e.g. Request::json()), but that using dependency injection is simply now the officially preferred method.To expand (and correct) the above, in Laravel 5 you would retrieve JSON as shown:In non-trivial examples you might want to also validate your input first.

PHP7.1 and Laravel 5.3: Function mcrypt_get_iv_size() is deprecated

nodeffect

[PHP7.1 and Laravel 5.3: Function mcrypt_get_iv_size() is deprecated](https://stackoverflow.com/questions/41031076/php7-1-and-laravel-5-3-function-mcrypt-get-iv-size-is-deprecated)

I'm using Laravel 5.0 for all my projects. Yesterday, I've updated my PHP version from 7.0.x to version 7.1.0. Once updated, I tried opening my Laravel project and saw this message below:May I know how can I solve this ? Does using Laravel 5.3 solve the problem? I don't feel like updating my Laravel to 5.3 because it's a huge project and it will takes a long time to update. There are too much differences between these two versions. Lots of codes need to be modified.Is there an easier way to solve this issue? 

2016-12-08 03:05:21Z

I'm using Laravel 5.0 for all my projects. Yesterday, I've updated my PHP version from 7.0.x to version 7.1.0. Once updated, I tried opening my Laravel project and saw this message below:May I know how can I solve this ? Does using Laravel 5.3 solve the problem? I don't feel like updating my Laravel to 5.3 because it's a huge project and it will takes a long time to update. There are too much differences between these two versions. Lots of codes need to be modified.Is there an easier way to solve this issue? This error occurs because you probably have something other than AES-256-CBC as your cipher in your config/app.php file that depends on the mcrypt extension. Perhaps you are using MCRYPT_RIJNDAEL_256 or MCRYPT_RIJNDAEL_128?The best thing you can do without a full-blown Laravel upgrade is install the legacy encrypter and use it to update all your encrypted data to use the AES-256-CBC cipher which has been the default cipher since Laravel 5.1, I believe. Once you do this, you should be able to use PHP 7.1 for your Laravel application.In your config/app.php configuration file, you should update the cipher to "AES-256-CBC" and set your key to a random 32 byte string which may be securely generated using php artisan key:generateAdd this to the beginning of the config/app.php:error_reporting(E_ALL ^ E_DEPRECATED);Source: https://stackoverflow.com/a/42515505/225790to solve this just change cipher in app.php from 'MCRYPT_RIJNDAEL_128' to 'AES-256-CBC'

disable csrf in laravel for specific route

jedrzej.kurylo

[disable csrf in laravel for specific route](https://stackoverflow.com/questions/31729415/disable-csrf-in-laravel-for-specific-route)

I've a payment system, where data is submitted to 3rd party site and than hauled back...When data returns it hits specific url lets say /ok route. $_REQUEST['transaction'].But because of laravel middleware I'm getting token mismatch. There is no way 3rd party payment API can generate token, so how I disable it? only for this route?or is there a better option?

2015-07-30 16:36:33Z

I've a payment system, where data is submitted to 3rd party site and than hauled back...When data returns it hits specific url lets say /ok route. $_REQUEST['transaction'].But because of laravel middleware I'm getting token mismatch. There is no way 3rd party payment API can generate token, so how I disable it? only for this route?or is there a better option?Since version 5.1 Laravel's VerifyCsrfToken middleware allows to specify routes, that are excluded from CSRF validation. In order to achieve that, you need to add the routes to $except array in your App\Http\Middleware\VerifyCsrfToken.php class:See the docs for more information.

Laravel Custom Model Methods

Jeremy Harris

[Laravel Custom Model Methods](https://stackoverflow.com/questions/23658479/laravel-custom-model-methods)

Whenever I add additional logic to Eloquent models, I end up having to make it a static method (i.e. less than ideal) in order to call it from the model's facade. I've tried searching a lot on how to do this the proper way and pretty much all results talk about creating methods that return portions of a Query Builder interface. I'm trying to figure out how to add methods that can return anything and be called using the model's facade.For example, lets say I have a model called Car and want to get them all:Great, except for now, let's say I want to sort the result into a multidimensional array by make so my result may look like this:Taking that theoretical example, I am tempted to create a method that can be called like:For a moment, lets forget the terrible method name and the fact that it is tightly coupled to the data structure. If I make a method like this in the model:And finally call it in my controller, I will get this Exception thrown:TL;DR: How can I add custom functionality that makes sense to be in the model without making it a static method and call it using the model's facade?This is a theoretical example. Perhaps a rephrase of the question would make more sense. Why are certain non-static methods such as all() or which() available on the facade of an Eloquent model, but not additional methods added into the model? This means that the __call magic method is being used, but how can I make it recognize my own functions in the model?Probably a better example over the "sorting" is if I needed to run an calculation or algorithm on a piece of data:To me, it makes sense for something like that to be in the model as it is domain specific.

2014-05-14 15:05:07Z

Whenever I add additional logic to Eloquent models, I end up having to make it a static method (i.e. less than ideal) in order to call it from the model's facade. I've tried searching a lot on how to do this the proper way and pretty much all results talk about creating methods that return portions of a Query Builder interface. I'm trying to figure out how to add methods that can return anything and be called using the model's facade.For example, lets say I have a model called Car and want to get them all:Great, except for now, let's say I want to sort the result into a multidimensional array by make so my result may look like this:Taking that theoretical example, I am tempted to create a method that can be called like:For a moment, lets forget the terrible method name and the fact that it is tightly coupled to the data structure. If I make a method like this in the model:And finally call it in my controller, I will get this Exception thrown:TL;DR: How can I add custom functionality that makes sense to be in the model without making it a static method and call it using the model's facade?This is a theoretical example. Perhaps a rephrase of the question would make more sense. Why are certain non-static methods such as all() or which() available on the facade of an Eloquent model, but not additional methods added into the model? This means that the __call magic method is being used, but how can I make it recognize my own functions in the model?Probably a better example over the "sorting" is if I needed to run an calculation or algorithm on a piece of data:To me, it makes sense for something like that to be in the model as it is domain specific.If you look at the Laravel Core - all() is actually a static functionYou have two options:orBoth will allow you to doActually you can extend Eloquent Builder and put custom methods there. Steps to extend builder : 1.Create custom builder2.Add this method to your base model : 3.Run query with methods inside your custom builder : for above code generated mysql query will be : PS: First Laurence example is code more suitable for you repository not for model, but also you can't pipe more methods with this approach : Second Laurence example is event worst. Many people suggest using scopes for extend laravel builder but that is actually bad solution because scopes are isolated by eloquent builder and you won't get the same query with same commands inside vs outside scope. I proposed PR for change whether scopes should be isolated but Taylor ignored me.More explanation : 

For example if you have scopes like this one : and two eloquent queries : vsGenerated queries would be : vs on first sight queries look the same but there are not. For this simple query maybe it does not matter but for complicated queries it does, so please don't use scopes for extending builder :)for better dynamic code, rather than using Model class name "Car",just use "static" or "self"

How to check if row is soft-deleted in Eloquent?

DisgruntledGoat

[How to check if row is soft-deleted in Eloquent?](https://stackoverflow.com/questions/34003284/how-to-check-if-row-is-soft-deleted-in-eloquent)

In Laravel 5.1 is there a nice way to check if an eloquent model object has been soft-deleted? I'm not talking about selecting data but once I have the object e.g. Thing::withTrashed()->find($id)So far the only way I can see isI do not see any relevant method in the API that would allow for example

2015-11-30 16:27:56Z

In Laravel 5.1 is there a nice way to check if an eloquent model object has been soft-deleted? I'm not talking about selecting data but once I have the object e.g. Thing::withTrashed()->find($id)So far the only way I can see isI do not see any relevant method in the API that would allow for exampleJust realised I was looking in the wrong API. The Model class doesn't have this, but the SoftDelete trait that my models use has a trashed() method.So I can writeIn laravel6, you can use followings.To check the Eloquent Model is using soft delete:To check the Eloquent Model is using soft delete in resource (when using resource to response):And finally to check if the model is trashed:Hope, this will be helpful!

Laravel Rule Validation for Numbers

AngularAngularAngular

[Laravel Rule Validation for Numbers](https://stackoverflow.com/questions/27614936/laravel-rule-validation-for-numbers)

I have the following Rule : But How to have the Rule that Fno Should be a Digit with Minimum 2 Digit to Maximum 5 Digit andLno Should be a Digit only with Min 2 Digit

2014-12-23 06:02:24Z

I have the following Rule : But How to have the Rule that Fno Should be a Digit with Minimum 2 Digit to Maximum 5 Digit andLno Should be a Digit only with Min 2 DigitIf I correctly got what you want:orFor all the available rules: http://laravel.com/docs/4.2/validation#available-validation-rulesTry this it will be workAlso, there was just a typo in your original post.'min:2|max5' should have been 'min:2|max:5'.

Notice the ":" for the "max" rule.Laravel min and max validation do not work properly with a numeric rule validation. Instead of numeric, min and max, Laravel provided a rule digits_between.

Run raw SQL in migration

Milkncookiez

[Run raw SQL in migration](https://stackoverflow.com/questions/28787293/run-raw-sql-in-migration)

I was trying with whatever syntax and can't think how can I write this correctly:also tried withand double quotation marks and so on. I always get the following when I run the migration:Yes, I have checked, MariaDB uses MySQL's syntax (at least for this case).

2015-02-28 21:44:34Z

I was trying with whatever syntax and can't think how can I write this correctly:also tried withand double quotation marks and so on. I always get the following when I run the migration:Yes, I have checked, MariaDB uses MySQL's syntax (at least for this case).Use back-ticks instead of single quotes to escape identifiers in MySQL:In this particular case you can omit escaping at all:The issue (as @postashin said) was the backticks.As of Laravel 5 (not sure about Laravel 4), you could have done this:In fact you didn't even need the back ticks as they don't need escaping. So you could have just written:You do not need this in the closure either if you are just executing a database statement.However a better approach to what you are doing is as follows:Note the last solution can sometimes raise an error due to a bug in Doctrine, which usually occurs if you have an enum in the table (not just the column you are changing).For more information, see Laravel Database Migration - Modifying Column

Calculate difference between two dates using Carbon and Blade

iivannov

[Calculate difference between two dates using Carbon and Blade](https://stackoverflow.com/questions/39508963/calculate-difference-between-two-dates-using-carbon-and-blade)

Does anyone know how to pass a given variable instead the Carbon's default parameters ?The documentation of Carbon says:And i want to do something like this in my controller:And retrieving that on a Blade template

2016-09-15 10:37:05Z

Does anyone know how to pass a given variable instead the Carbon's default parameters ?The documentation of Carbon says:And i want to do something like this in my controller:And retrieving that on a Blade templateYou are not following the example from the Carbon Documentation. The method Carbon::createFromDate() expects 4 parameters: year, month, day and timezone. And you are trying to pass a formatted date string.If you want to create a Carbon object from a formatted date string you can use the constructor of the class just like this:Or you can use the static Carbon::parse() method:For your purposes you can use the this full example:And then in your Blade template:You code can be cleaned up and have the commented out code removed by doing:Blade Template A shorter codeResult : 6 minutes ago

Laravel quick start guide route not working

twigg

[Laravel quick start guide route not working](https://stackoverflow.com/questions/16897504/laravel-quick-start-guide-route-not-working)

Ok I'm new to Laravel so went straight to the documentation to get started. There are massive holes in the documentation so it took a lot of effort and googling to fill the gaps in order to get Laravel set-up. I now have it set up and moved on to the next step in the quick start guide.I created my routeNow it says:So I hit up:but get a 404? I tried but still a 404? I followed the steps on the quick start guide to the letter, what am I missing?

2013-06-03 13:08:12Z

Ok I'm new to Laravel so went straight to the documentation to get started. There are massive holes in the documentation so it took a lot of effort and googling to fill the gaps in order to get Laravel set-up. I now have it set up and moved on to the next step in the quick start guide.I created my routeNow it says:So I hit up:but get a 404? I tried but still a 404? I followed the steps on the quick start guide to the letter, what am I missing?Seems like your Laravel app is accesible via an Apache HTTP alias, because your URL looks like: http://localhost/laravel/. If this is the case and assuming that http://localhost/laravel is pointing to your public directory, then follow these steps:Basically, if you app resides in a alias or virtual directory (say http://localhost/alias) you should add an entry in your rewrite rule to rewrite the base directory with alias.Apache isn't probably reading the public/.htaccess file due to the directive AllowOverride being set to None. Try to set it to All.Laravel 4 simple route not working using mod_rewrite, and .htaccess The problem is well explained by Rubens above, A simpler solution is to use the supplied built-in PHP Server by issuing this commandNote that I am using port 8080 here, you can omit it.Now you can browse the site by going toand it should work!I had the same problem and spent hours to solve it. 

I have several apps under the same domain, but in different segments. So Laravel's url is http://myhostname/mysubdir/My controllers were only working as http://myhostname/mysubdir/index.php/mycontrollerOn /var/www/.../public/.htaccess I put RewriteBase /mysubdir and worked!!! I know this question is 4 years old but still it have its significance.Rubens Mariuzzo was answered it correctly but I want to add some points on it. You said"There are massive holes in the documentation so it took a lot of effort and googling to fill the gaps in order to get Laravel set-up"For beginners it is difficult to find correct way of configuring Laravel. Once it is mastered it is fun developing Laravel :) . There are certain correct way of doing this.Detailed description is given in this blog http://masterlaravel.blogspot.in/2017/08/laravelquick-start-composer-create.htmlplease refer to this follow url and see RoboTamer's config:http://forums.laravel.io/viewtopic.php?id=511it solved my problem the same as yourssolution in nginx:server {}Thanks. Knowledge of the above by @rubens, and a comment by @GaryJ here made me do this to make it work from my Apache virtual hosts file.Copied these lines from .htaccess file in laravel within  node of the vhosts config.

Removed my .htaccess file (it was anyway not being applied, i am on a windows apache virtual host, laravel env)Better:

Later read @Ag0r0 's reply, that worked. i was missing the allow override, making the above neccessary. once allowoverride all was there, the default settings itself worked.In my case (Ubuntu 14.04 LTS & Apache 2.2) I was stuck at #1 step of @Rubens' solution. I could see the page with this url: http://localhost/laravel/index.php/users but step #2 and others didn't work.Also I've tried to add RewriteBase /laravel/public to .htaccess but it didn't work too.Then I've set up a new virtual host with the help of this awesome tutorial: https://www.digitalocean.com/community/tutorials/how-to-set-up-apache-virtual-hosts-on-ubuntu-14-04-lts (they rock with these tuts)In addition to tutorial, I've set DocumentRoot (in example.com.conf file) like this:Yes, public is the big deal here. Btw, don't put RewriteBase /laravel/ to your .htacces file otherwise you'll get HTTP/500 error.Now, I can see example.com/users page.my previous post with the describtion of the problem was deleted, but it was similar to the situation that is described here. anyway... simply i have tried all the possibilities that are described here as well as on other pages and I did not find solution to my problem. The fresh installation of the Laraval simply did not worked.... after trying everythink from this post i decided to create yet another fresh installation and miracle happened this installation is actually working... So my advice is: if you are not able to fix this problem just try to create another installation of the laravel and it might actually work. This might be actually the easiest way how to fix your problem in case you are starting from the scrach. 

Laravel 5 migration identifier name too long

geoffs3310

[Laravel 5 migration identifier name too long](https://stackoverflow.com/questions/30170268/laravel-5-migration-identifier-name-too-long)

I am trying to run the following migration:But I get the following error:

2015-05-11 14:24:55Z

I am trying to run the following migration:But I get the following error:You can pass a custom index name as the second parameter into the foreign() method. Or just use shorter table/column names.So you want to do something like:

validating a numeric input's length in laravel 5

bobD

[validating a numeric input's length in laravel 5](https://stackoverflow.com/questions/39539436/validating-a-numeric-inputs-length-in-laravel-5)

foo.blade.phpFooController.phpthe national-id field should contain 10 digits and I actually expected the code above to validate this , but instead It will check If the national-id exactly equals to 10 or not ...

how can I validate the length of a numeric field?

2016-09-16 20:13:46Z

foo.blade.phpFooController.phpthe national-id field should contain 10 digits and I actually expected the code above to validate this , but instead It will check If the national-id exactly equals to 10 or not ...

how can I validate the length of a numeric field?In fact you don't need to use digits_between rule. You can use digits rule so according to documentation it will be enough to use:without numeric rule because digits rule also verify if given value is numeric.When using size on a number it will check if the number is equal to the size, on string, it will check the amount of characters, for number you should use :In laravel the size validation on a field that's numeric  will indicate the max integer it cannot be larger than.Use digits_between: 

Displaying the Error Messages in Laravel after being Redirected from controller

SA__

[Displaying the Error Messages in Laravel after being Redirected from controller](https://stackoverflow.com/questions/26732821/displaying-the-error-messages-in-laravel-after-being-redirected-from-controller)

How can I display the validation message in the view that is being redirected in Laravel ?Here is my function in a ControllerI know the below given code is a bad try, But how can I fix it and what am 

 I missing 

2014-11-04 10:27:11Z

How can I display the validation message in the view that is being redirected in Laravel ?Here is my function in a ControllerI know the below given code is a bad try, But how can I fix it and what am 

 I missing Laravel 4When the validation fails return back with the validation errors.You can catch the error on your view usingUPDATETo display error under each field you can do like this.For better display style with css.You can refer to the docs here.UPDATE 2To display all errors at onceTo display error under each field.If you want to load the view from the same controller you are on:And if you want to quickly display all errors but have a bit more control:to Make it look nice you can use little bootstrap helpA New Laravel Blade Error Directive comes to Laravel 5.8.13Move all that in kernel.php if just the above method didn't work for you

remember you have to move all those lines in kernel.php in addition to the above solutionlet me first display the way it is there in the file already..now what you have to do isi.e.;

How to use the request route parameter in Laravel 5 form request?

Rohan

[How to use the request route parameter in Laravel 5 form request?](https://stackoverflow.com/questions/30051970/how-to-use-the-request-route-parameter-in-laravel-5-form-request)

I am new to Laravel 5 and I am trying to use the new Form Request to validate all forms in my application.Now I am stuck at a point where I need to DELETE a resource and I created a DeleteResourceRequest for just to use the authorize method.The problem is that I need to find what id is being requested in the route parameter but I cannot see how to get that in to the authorize method.I can use the id in the controller method like so:But how to get this to work in the authorize method of the Form Request?

2015-05-05 11:39:38Z

I am new to Laravel 5 and I am trying to use the new Form Request to validate all forms in my application.Now I am stuck at a point where I need to DELETE a resource and I created a DeleteResourceRequest for just to use the authorize method.The problem is that I need to find what id is being requested in the route parameter but I cannot see how to get that in to the authorize method.I can use the id in the controller method like so:But how to get this to work in the authorize method of the Form Request?That's very simple, just use the route() method. Assuming your route parameter is called id:You can accessing a Route parameter Value via  Illuminate\Http\Request instanceLaravel 5.2, from within a controller:I've found this useful if you want to use the same controller method for more than one route with more than one URL parameter, and perhaps all parameters aren't always present or may appear in a different order...i.e. getParameter('id')will give you the correct answer, regardless of {id}'s position in the URL.See Laravel Docs: Accessing the Current RouteDepending on how you defined the parameter in your routes.For my case below, it would be: 'user' not 'id'$id = $this->route('user');I came here looking for an answer and kind of found it in the comments, so wanted to clarify for others using a resource route trying to use this in a form requestas mentioned by lukas in his comment:

Given a resource controller Route::resource('post', ...) the parameter you can use will be named postThis was usefull to me but not quite complete. It appears that the parameter will be the singular version of the last part of the resource stub.In my case, the route was defined as $router->resource('inventory/manufacturers', 'API\Inventory\ManufacturersController');And the parameter available was manufacturer (the singular version of the last part of the stub inventory/manufacturers)

Add「ON DELETE CASCADE」to existing column in Laravel

Farid Movsumov

[Add「ON DELETE CASCADE」to existing column in Laravel](https://stackoverflow.com/questions/26820788/add-on-delete-cascade-to-existing-column-in-laravel)

I have user_id fk column in my tableI should add on cascade delete feature to this existing column. How can I do this?

2014-11-08 18:49:34Z

I have user_id fk column in my tableI should add on cascade delete feature to this existing column. How can I do this?Drop foreign key first. Thanks to Razor for this tip

Laravel schema builder can't modify columns at the current state, so you will use raw queries. You will have to drop and recreate the constraint:PostgreSQLMySQLIn my case, i'll need to put the col name in an array else that will be an error.mysql 5.7 verThanks for question answer. Help me get to this working code in L5.1 :I am assuming you used Illuminate\Database\Schema\Blueprint::primary() to create users.id. If that is the case, then users.id will be unsigned. Therefore your foreign key column user_id must also be unsigned.Use the unsigned function to user_id in the present migration:

Laravel 4 - logging SQL queries

ericbae

[Laravel 4 - logging SQL queries](https://stackoverflow.com/questions/19131731/laravel-4-logging-sql-queries)

There are already several questions in regards to logging the SQL query in Laravel 4. But I've tried almost all of them and it's still not working the way I want.Here's my situationIf I useI just get "select * from my_table where id=?" as the log message without the ID value actually populated.If I useI still don't have the final SQL query with the ID populated.Finally, if I use a logging tool like https://github.com/loic-sharma/profiler - it doesn't display anything since I'm making an AJAX request.Have I exhausted my options? Is there still another better way?

2013-10-02 07:14:42Z

There are already several questions in regards to logging the SQL query in Laravel 4. But I've tried almost all of them and it's still not working the way I want.Here's my situationIf I useI just get "select * from my_table where id=?" as the log message without the ID value actually populated.If I useI still don't have the final SQL query with the ID populated.Finally, if I use a logging tool like https://github.com/loic-sharma/profiler - it doesn't display anything since I'm making an AJAX request.Have I exhausted my options? Is there still another better way?Here is what I am currently using for logging of sql queries. You should be able to drop this into your main routes file then add 'log' => true into your database config. Thanks to Jeemusu answer for the bit about inserting the bindings into the prepared statement.You should be able to find the bindings by passing $bindings as the second parameter of the Event function.In Laravel 3.x I think the event listener was called laravel.queryContinuing on @Collin James answer.If you want to log to a seperate file only for sql, you can do it with this:With this at the top of your file:This will log all your queries to a file named sql-YYYY-mm-dd.log in storage/logs/.While the accepted answer stands correct, this answer explains how to update loic-sharma profiler when making Ajax requests using jQuery. Using this approach one doesn't need to read file logs. The first problem is to send the updated profiler data to the client on every Ajax-request. This can be solved using the "after" events of the Laravel application.app/filters.php:The App::after filter will run upon every Laravel request. The first line of the closure above, makes sure that it will only continue if a the response is of type JsonResponse and the profiler is enabled. If that is the case, render the profiler and append the HTML to the JSON object. Note: this code assumes that the returned JSON is a object. So it will fail for arrays: Response::json(array(1,2,3)).Now that the updated profiler HTML is being sent to the client, we must update the DOM with the new profiler HTML using javascript. This should happen every time the client gets a JSON response. jQuery provides global Ajax event handlers, which is perfect to achive this.Here's a method to replace the old profiler with the new one:Now it is as simple as returning responses as:Laravel will append the profiler HTML. The javascript will catch the JSON response and update the DOM. You will have the SQL queries and timings right on the web page.While the code is tested, there might be a bug or two. This is also not exactly how I do it. Instead of sending the HTML in the json response, I extend the object with the actual data from the profiler. On the client side I render the profiler using a mustache template.That's what I've been using:While the question was originally targeted at Laravel 4, I still ended up here through google, but I'm using Laravel 5.There are new ways to log all queries in Laravel 5 using Middleware, but if you prefer the same approach here is the same code provided by Collin James but working for Laravel 5

Starting with laravel on ubuntu

Isaac Gonzalez

[Starting with laravel on ubuntu](https://stackoverflow.com/questions/11981621/starting-with-laravel-on-ubuntu)

I'm trying laravel as a PHP framework, I have already extracted the laravel zip into ~/opt/xampp/htdocs/laravel but when I go to localhost/laravel or localhost/laravel I get a 403 error message saying: I read somewhere that I need to edit the storage folder inside of laravel so it can be readable and writable so I chmod -R 766 laravel/storage but still no luck, I'm doing this from Ubuntu 12.04 have anyone encountered this ?

EDIT 

I have chmod -R 0+w laravel/storage and now when i go to localhost/laravel i get an index of some files in there, but when i go to localhost/laravel/public/ still get the 403 error, instead of the expected result

EDIT 2 

I have set chmod -R 765 laravel/public and now when i get to localhost/laravel/public i get this message which leads me to believe i'm getting closer: 

2012-08-16 06:13:29Z

I'm trying laravel as a PHP framework, I have already extracted the laravel zip into ~/opt/xampp/htdocs/laravel but when I go to localhost/laravel or localhost/laravel I get a 403 error message saying: I read somewhere that I need to edit the storage folder inside of laravel so it can be readable and writable so I chmod -R 766 laravel/storage but still no luck, I'm doing this from Ubuntu 12.04 have anyone encountered this ?

EDIT 

I have chmod -R 0+w laravel/storage and now when i go to localhost/laravel i get an index of some files in there, but when i go to localhost/laravel/public/ still get the 403 error, instead of the expected result

EDIT 2 

I have set chmod -R 765 laravel/public and now when i get to localhost/laravel/public i get this message which leads me to believe i'm getting closer: Final Update

I finally solved it, what happened was that the laravel folder was read protected, what i had to do was to set chmod 755 -R laravel and then chmod -R o+w storage and voila i had laravel up and running, thanks to everybody that contributed.for just getting start with laravel, I just do these following steps:then add www-data group to your laravelYour on the right track, after install of laravel you need to ensure the storage directory has the correct permissions: Then make sure you are serving your public folder and not your laravel folder in apaches document rootBoth requirements are covered hereOn the Laravel forum, Kaspien gave this usefull answers:From the thread: http://forums.laravel.com/viewtopic.php?id=1552In your .htaccess file:Change permission to the storage and bootstrap folders like so

Laravel, How to use where conditions for relation's column?

Tharshan Venkdesan

[Laravel, How to use where conditions for relation's column?](https://stackoverflow.com/questions/14621943/laravel-how-to-use-where-conditions-for-relations-column)

I'm using Laravel and having a small problem with Eloquent ORM.. I can get this working simply with SQL query using a JOIN but I can't seem to get it working with Eloquent!This is what I want, I have two tabels. one is 'Restaurants' and other is 'Restaurant_Facilities'. The tables are simple.. and One-To-One relations. like there is a restaurant table with id, name, slug, etc and another table called restaurant_facilities with id, restaurant_id, wifi, parking, etcNow what I want to do is.. load all restaurants which have wifi = 1 or wifi = 0..

How can i do that with Eloquent ? I have tried eager loading, pivot tables, with(), collections() and nothing seems to work!The same problem I have for a Many-To-Many relation for cuisines!

I have the same restaurant table and a cuisine table and a restaurant_cuisine_connection table..but how do I load all restaurants inside a specific cuisine using it's ID ?This works.Cuisine::find(6)->restaurants()->get();but I wanna load this from Restaurant:: model not from cuisines.. because I have many conditions chained together.. its for a search and filtering / browse page.Any ideas or ways ? I've been struggling with this for 3 days and still no answer.Example Models :PS :

This seems to be working.. but this is not Eloquent way right ?Also what is the best method to find a count of restaurants which have specific column value without another query ? like.. i have to find the total of restaurants which have parking = 1 and wifi = 1 ?Please help on this.Thank you.

2013-01-31 09:04:49Z

I'm using Laravel and having a small problem with Eloquent ORM.. I can get this working simply with SQL query using a JOIN but I can't seem to get it working with Eloquent!This is what I want, I have two tabels. one is 'Restaurants' and other is 'Restaurant_Facilities'. The tables are simple.. and One-To-One relations. like there is a restaurant table with id, name, slug, etc and another table called restaurant_facilities with id, restaurant_id, wifi, parking, etcNow what I want to do is.. load all restaurants which have wifi = 1 or wifi = 0..

How can i do that with Eloquent ? I have tried eager loading, pivot tables, with(), collections() and nothing seems to work!The same problem I have for a Many-To-Many relation for cuisines!

I have the same restaurant table and a cuisine table and a restaurant_cuisine_connection table..but how do I load all restaurants inside a specific cuisine using it's ID ?This works.Cuisine::find(6)->restaurants()->get();but I wanna load this from Restaurant:: model not from cuisines.. because I have many conditions chained together.. its for a search and filtering / browse page.Any ideas or ways ? I've been struggling with this for 3 days and still no answer.Example Models :PS :

This seems to be working.. but this is not Eloquent way right ?Also what is the best method to find a count of restaurants which have specific column value without another query ? like.. i have to find the total of restaurants which have parking = 1 and wifi = 1 ?Please help on this.Thank you.I don't see anything wrong with doing the left join here, if you have to load from the Restaurant model. I might abstract it away to a method on my Restaurant model, like so:And then, from your routes:On the go - haven't tested that code, but I think it should work. You could instead use eager loading with a constraint, but that will only specify whether the facility object is null or not. It would still return all restaurants, unless you specify a where clause.(P.S. I'd stick with the singular form of Facility. Notice how hasOne('Facilities') doesn't read correctly?)I stumbled across this post while trying to improve my REST API methodology when building a new sharing paradigm. You want to use Eager Loading Constraints. Let's say you have an api route where your loading a shared item and it's collection of subitems such as this:When hitting this route with a GET request, you want to load that specific subitem. Granted you could just load that model by that id, but what if we need to validate if the user has access to that shared item in the first place? One answer recommended loading the inversed relationship, but this could lead to a confusing and muddled controller very quickly. Using constraints on the eager load is a more 'eloquent' approach. So we'd load it like this:So where only want the subitem that has that id. Now we can check if it was found or not by doing something like this:Since subitems is a collection (array of subitems) we return the subitem[0] with this:Use whereHas to filter by any relationship.  It won't join the relation but it will filter the current model by a related property.  Also look into local scopes to help with situations like this https://laravel.com/docs/5.3/eloquent#local-scopesYour example would be:To achieve the same thing with local scopes: For local scopes you DO NOT want to define them as static methods on your model as this creates a new instance of the query builder and would prevent you from chaining the methods.  Using a local scope will injects and returns the current instance of the query builder so you can chain as many scopes as you want like:Local Scopes are defined with the prefix scope in the method name and called without scope in the method name as in the example abover.Another solution starring whereHas() function:Nice and tidy.Do you absolutely have to load it from the Restaurant model? In order to solve the problem, I usually approach it inversely.This will get all the restaurant facilities that match your conditions, and eager load the restaurant. You can chain more conditions and count the total like this.. This will work with cuisine as wellThis grabs the cuisine object with the id of 1 eager loaded with all the restaurants that have this cuisine

PHP Artisan Tinker crashing from any command

G.S.

[PHP Artisan Tinker crashing from any command](https://stackoverflow.com/questions/53773098/php-artisan-tinker-crashing-from-any-command)

I haven't had this problem before, but my php artisan tinker crashes from issuing any command - and leaves no logs whatsoever on what is causing the crash.or even the simplest command:I almost wonder if it isn't connecting to PHP correctly, but I can't find any logs anywhere. Laravel has no trace of the commands. I ran brew update, but no difference. For the record, all of my projects are affected. I can't tinker on any of my projects. Help!I did recently upgrade to PHP 7.3.0, which is working fine in every other area. Hmm...

2018-12-14 03:25:15Z

I haven't had this problem before, but my php artisan tinker crashes from issuing any command - and leaves no logs whatsoever on what is causing the crash.or even the simplest command:I almost wonder if it isn't connecting to PHP correctly, but I can't find any logs anywhere. Laravel has no trace of the commands. I ran brew update, but no difference. For the record, all of my projects are affected. I can't tinker on any of my projects. Help!I did recently upgrade to PHP 7.3.0, which is working fine in every other area. Hmm...If you are using PHP 7.3 installed by homebrew on Mojave, try creating a config file at ~/.config/psysh/config.php if not already there:Source: https://github.com/bobthecow/psysh/issues/540#issuecomment-446480753This happens on Mojave when you upgrade/install PHP 7.3 using homebrew, 

(It's a problem with PsySh (used by Tinker) and Homebrew's PHP 7.3.0 build.)Simple solution is, 

In your php.ini set If you don't know which ini file is used, you can run php --ini to find it,I'd recommend to install a previous version of PHP via brew, if you have PHP 7.3 just a take a step back and install 7.2brew install php@7.2It worked for me, hope does it for you too. 

Can't make Laravel 4 to work on localhost

Carlo

[Can't make Laravel 4 to work on localhost](https://stackoverflow.com/questions/14345174/cant-make-laravel-4-to-work-on-localhost)

I'm trying Laravel for the first time after reading an announcement of the Laravel4 beta releasing.I followed these steps I installed composer and laravel with all the dependencies it needed. I put the laravel inside my ~/public_html directory - as I'm used to do it with Codeigniter, but I think something's wrong here.If I point to the browser to http://localhost/~carlo/laravel-develop/, it just displays the content of the directory.Then, while on the filesystem I had a laravel-develop/public folder, it didn't appear on the browser.I've found that changing the .htaccess like this:resulted in an error when I try to access the public folder.

The error:another one:then a long list of errors. The last one is:

2013-01-15 19:15:52Z

I'm trying Laravel for the first time after reading an announcement of the Laravel4 beta releasing.I followed these steps I installed composer and laravel with all the dependencies it needed. I put the laravel inside my ~/public_html directory - as I'm used to do it with Codeigniter, but I think something's wrong here.If I point to the browser to http://localhost/~carlo/laravel-develop/, it just displays the content of the directory.Then, while on the filesystem I had a laravel-develop/public folder, it didn't appear on the browser.I've found that changing the .htaccess like this:resulted in an error when I try to access the public folder.

The error:another one:then a long list of errors. The last one is:Try to change the folder permissions for the storage folder using the terminal:chmod -R 777 storageMore info on this matter can be found here.Your errors resulted because laravel couldn't write to the app/storage folder. The rest was just a stack trace. In order to make the storage folder writable, cd into your app folder and then run:Production way, moderate complexity for people not familiar with Unix, but more secure: Voila!.Fast and dirty way, for those who doesn't care about security and want make it works at any cost, not secure:In my case I resolved this error by modifying in file /app/config/app.php the default setting:to my local custom virtualhost host url:This seemed to be THE essential change that resolved the issue (I also chmod'ed the storage folder, as suggested here)hope this helps some of you..further to above, if you're using a virtualbox/vagrant VM type environment, then on my Mac I needed to issue the chmod on the host (mac) system but on my Windows box, it was fine issuing the chmod direcly on the VM.You need to add: Options +FollowSymLinksYou need to read the installation documentation:http://laravel.com/docs/installation#configurationPay attention to the bit here:There is also other stuff thats useful in that document, so make sure you read it all.I had the same problem, here is how I solve it:

In your httpd-vhosts.conf files you need to add the configurations to your folders, this is what I have in mineThe webroot of your server should point to the /public folder of your Laravel installation. This is where the index.html file recides from where Laravel is initialized.First, this answer here will help you with permissions.  Second, you may need to add RewriteBase ~/carlo/public_html/laravel-develop to your .htaccess since you're running it out of a home directory.Hey I got this error too and changing the write permissions didn't seem to work either. It turned out I needed to change the User and Group settings in apache's httpd.conf file. Here's a good tutorial for it: Enable Write Permissions for the Native Built-In Apache in Mac OS X LionChecking on the Requirement for the LR4, your local server must have these:

PHP >= 5.3.7

MCrypt PHP ExtensionOtherwise, will fail. I am facing this trouble also and now looking for an updated PHP and its extension for my XAMPP.I like this method better than changing permissions to 777.

Set Apache to run as you.I ran into this problem a few minutes back and using sudo chmod -R 777 storage seemed to help make the storage/meta/services.json writable. Just to add to what everyone has been saying. This worked for me.

Laravel - Model Class not found

Sylnois

[Laravel - Model Class not found](https://stackoverflow.com/questions/28350232/laravel-model-class-not-found)

When starting to work with models I got the following error All I did:

- Created a Model with  the command php artisan make:model

- Tried to get all entries from table posts with echo Post::all()  I used the following code:router.phpPost.php  What I tried

- Renaming Class

- Dump-autoload (Laravel 4 Model class not found)

2015-02-05 17:23:44Z

When starting to work with models I got the following error All I did:

- Created a Model with  the command php artisan make:model

- Tried to get all entries from table posts with echo Post::all()  I used the following code:router.phpPost.php  What I tried

- Renaming Class

- Dump-autoload (Laravel 4 Model class not found)Laravel 5 promotes the use of namespaces for things like Models and Controllers. Your Model is under the App namespace, so your code needs to call it like this: As mentioned in the comments you can also use or import a namespace in to a file so you don't need to quote the full path, like this: While I'm doing a short primer on namespaces I might as well mention the ability to alias a class as well. Doing this means you can essentially rename your class just in the scope of one file, like this: More info on importing and aliasing namespaces here: http://php.net/manual/en/language.namespaces.importing.phpI was having the same "Class [class name] not found" error message, but it wasn't a namespace issue. All my namespaces were set up correctly. I even tried composer dump-autoload and it didn't help me.Surprisingly (to me) I then did composer dump-autoload -o which according to Composer's help, "optimizes PSR0 and PSR4 packages to be loaded with classmaps too, good for production." Somehow doing it that way got composer to behave and include the class correctly in the autoload_classmap.php file.I had the same error in Laravel 5.2, turns out the namespace is incorrect in the model class definition.I created my model using the command:By default, Laravel 5 creates the model under App folder, but if you were to move the model to another folder like I did, you must change the the namespace inside the model definition too:To include the folder name when creating the model you could use (don't forget to use double back slashes):If after changing the namespace and the config/auth.php it still fails, you could try the following:In your router.php file, you should use the model class like thisand use the model class like this.As @bulk said, it uses namespaces.I recommend you to start using an IDE, it will suggest you to import all the required namespaces (\App\Post in this case).Make sure to be careful when editing your model file. For example, in your post model:You need to pay close attention to the class Post extend Model line. The class Post defined here will be your namespace for your controller.For me it was really silly I had created a ModelClass file without the .php extension.  So calling that was giving model not found.  So check the extension has .php

Storage in laravel says symlink - no such file

Programmmereg

[Storage in laravel says symlink - no such file](https://stackoverflow.com/questions/47409417/storage-in-laravel-says-symlink-no-such-file)

I deployed laravel app on shared hosting in public_html/app folder. Here is everything from public folder. In /../../files I have rest of files. When I do php artisan storage:link in files folder my console says On localhost I upload files to storage/uploads folder. What to do now? I tried to change links but nothing works for me...

2017-11-21 09:21:10Z

I deployed laravel app on shared hosting in public_html/app folder. Here is everything from public folder. In /../../files I have rest of files. When I do php artisan storage:link in files folder my console says On localhost I upload files to storage/uploads folder. What to do now? I tried to change links but nothing works for me...Edited on May 1st 2018This problem comes when laravel project is moved/copied to some other folder.The storage link is still there thus causing the exception error. public/storage folder exists and points to wrong location and it needs to be deleted with rm storage command.After that run php artisan storage:link in terminal and it will create the storage link.This needs to be done EVERY time when laravel is moved/copied/deployed!I'm face same error when use share hosting and my public directory move to public_html or different directory

like : 

project directory in root name "project"

and public directory in root name "public_html"when run artisan command by Artisan::call('storage:link'); then face this error.Solution: 

 1st need to bind your public directory in app/Providers/AppServiceProvider register methodNow run the command its working fineThis usually happens after moving Laravel app to another directoryThe actual storage directory is "/AppName/storage/app/public/"Laravel creates a symbolic link pointing to actual storage dir  "/AppName/public/storage"Other meaning On changing root app directory to "/AnotherAppName/" symlink will still point to the old pathmy solution is to manually update the symlink usingDelete the existing storage symbolic link (public/storage) and then run 

php artisan storage:link command again.create new php file and put this code on the file:"CpanelUser" change to youre cpanel user name or host name.upload this file to public_html folder (www) of site

execute file with write site name+this file in browser

done!example:

my file name is symlink.php and site name is www.anysite.com

upload symlink.php to public_html folder in host and get web address in browserhttp://www.anysite.com/symlink.phpafter execute this file storage folder creite in public folder in laravel and link to storage folder in app.I was using Vagrant and had the same problem. I removed to storage directory in public/storage but couldn't resolve the problem when using the command php artisan storage:link.Therefore I connected with ssh to my vagrant box and ran the command there. It worked, so if you are running Vagrant and have the same problem this might help.Make sure the APP_URL configuration in .env file is set correctly. after that run following command line:

Empty string instead of null values Eloquent

Israel Ortuño

[Empty string instead of null values Eloquent](https://stackoverflow.com/questions/17452923/empty-string-instead-of-null-values-eloquent)

I'm trying to create entities using mass-assignment Eloquent feature...The problem's that this way, every field's filled out with an empty string instead of null values as I expected.I'm currently developing the system and still some table columns're not defined, that's why using this method, to avoid adding every new field to $fillable array and to a new Contact(array(...));...Also I've around 20 fields in this table, so It'd be a bit ugly to have an array such asAny tips of how to do this or fix?Update By now I've sorted out this doing the array_filter in the App::before() filter.Update In filter was a bit mess. I end up doing:And in my functions.php.By now only working with fields that ends with "_id". This is my biggest problem as if a relationship is not NULL, the database will throw an error as the foreign key "" cannot be found.Works perfect. Any comment?

2013-07-03 16:07:55Z

I'm trying to create entities using mass-assignment Eloquent feature...The problem's that this way, every field's filled out with an empty string instead of null values as I expected.I'm currently developing the system and still some table columns're not defined, that's why using this method, to avoid adding every new field to $fillable array and to a new Contact(array(...));...Also I've around 20 fields in this table, so It'd be a bit ugly to have an array such asAny tips of how to do this or fix?Update By now I've sorted out this doing the array_filter in the App::before() filter.Update In filter was a bit mess. I end up doing:And in my functions.php.By now only working with fields that ends with "_id". This is my biggest problem as if a relationship is not NULL, the database will throw an error as the foreign key "" cannot be found.Works perfect. Any comment?Use the model 'saving' event to look for empty models and explicitly set them to null. 'Project' is the name of my model in this example. Put this in a helper function and wire it up to all your models.UPDATE FOR LARAVEL 5 (April 11 2016)I also ended up creating an Http Middleware to cleanup the input data from the http request, in addition to cleaning up the data before it is sent to the database.I've looked for the answer to this myself, and the closest I can come up with is using Mutators (http://laravel.com/docs/eloquent#accessors-and-mutators).The same problem was solved by adding a (magic!) Mutator method for the foreign key field in the model:For a table with a lot of foreign keys, this can get kind of bulky, but it's the most "built-in" method I've found for handling this. The upside is that it's magic, so all you have to do is create the method and you're good to go.UPDATE -- Laravel 5.4 and aboveAs of Laravel 5.4, the \Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull::class middleware handles this when the request is received. In my example above, if the request contains an empty string value for 'header_image_id', this middleware automatically converts it to null before I can assign it to my model.If it is necessary you could remove any empty string in an array by filtering.Then if you have something like array('a' => 'a', 'b' => '') you will get: array('a' => 'a').As far as I know, if a field is not specified in the array for mass-assignment, then Laravel Eloquent ORM will treat it like NULL.orProbably more generic solution:The model where you needs to sanitize empty form fields should extends this class, then you should fill $forcedNullFields array with field names that required to be NULL in case of empty form fields:And thats all, you should not repeat same code in mutators.For a form input, it's normal, and more logical to have empty values, rather then null values.If you really think the best way to do this, is to directly put the input into your database, than the solution to make empty values null would be something like this.Personally I don't approve with these kind of solutions, but it does work for some people.Another simple solution is to create base model class and extend models from it:Then just fill required fields in $forcedNullFields for each model if needed.In your Eloquent model, make sure $guarded is empty. You don't need to set $fillable.Mass assignment isn't usually a good idea, but it's OK to do in some scenarios - you must determine when.See: http://laravel.com/docs/eloquent#mass-assignment

Laravel 5 controller sending JSON integer as string

Muggles

[Laravel 5 controller sending JSON integer as string](https://stackoverflow.com/questions/31527050/laravel-5-controller-sending-json-integer-as-string)

On my development server the JSON response from the Laravel 5 controller shows the data in the correct types.e.gBut on the production server, the JSON response is sent back as strings.Both development and production have the same version of PHP installed (5.6.11-1).Any ideas on what may be causing this behaviour?

2015-07-20 21:58:33Z

On my development server the JSON response from the Laravel 5 controller shows the data in the correct types.e.gBut on the production server, the JSON response is sent back as strings.Both development and production have the same version of PHP installed (5.6.11-1).Any ideas on what may be causing this behaviour?Make sure to use MySQL Native Driver which will support native data types.MySQL Client Library will return all fields as strings.Another solution would be to use json_encode options with JSON_NUMERIC_CHECK.For example:I just ran into this same issue! For those of you looking for a more appropriate solution, you might want to check out the $casts property for Eloquent models.The accepted solution will work, but it will also convert fields that you may not want converted. I would recommend adding this to your Eloquent model:This will convert the values directly in your model object, so you won't need to worry about updating multiple endpoints. I hope this helps others as it did me!you can return the integer with typecasting like 

Laravel classloader.php error failed to open stream: No such file or directory

Matt

[Laravel classloader.php error failed to open stream: No such file or directory](https://stackoverflow.com/questions/31284774/laravel-classloader-php-error-failed-to-open-stream-no-such-file-or-directory)

I am able to run "php artisan migrate" fine. I'm able to get all the form input if I use Request::all() but when I try to add the data to my mysql database table I get the below error:I currently have the form attached to a controller method with the below code:I know that I am properly connected to mysql server because I'm able to migrate my migrations.Any help would be great. Also why did laravel change so many things in Laravel 5?Thanks

2015-07-08 06:09:51Z

I am able to run "php artisan migrate" fine. I'm able to get all the form input if I use Request::all() but when I try to add the data to my mysql database table I get the below error:I currently have the form attached to a controller method with the below code:I know that I am properly connected to mysql server because I'm able to migrate my migrations.Any help would be great. Also why did laravel change so many things in Laravel 5?ThanksYou have to run composer dumpautoload inside your project folder.ClassLoader.php Load the given class file into Laravel. Similar errors are due to failure to autoload new classes.composer dump-autoload regenerates the list of all classes that need to be included in the project (autoload_classmap.php). It won’t download anything. When to use: 

When you have a new class inside your project, Run it from the project root. 

Laravel 5.2 $errors not appearing in Blade

Neal Crowley

[Laravel 5.2 $errors not appearing in Blade](https://stackoverflow.com/questions/34438463/laravel-5-2-errors-not-appearing-in-blade)

So I'm following along with the Laravel 5 fundamentals tutorial and I am stuck on the form validation. I have followed along exactly with the tutorial but I am getting a Undefined variable: errors in my create articles view.In the tutorial I am following and what I have found online they say the errors variable is always there in the blade file for you to use so I don't know what i am doing wrong?Any help would be appreciated! loving Laravel except for this error!ControllerRequest validation

2015-12-23 15:05:19Z

So I'm following along with the Laravel 5 fundamentals tutorial and I am stuck on the form validation. I have followed along exactly with the tutorial but I am getting a Undefined variable: errors in my create articles view.In the tutorial I am following and what I have found online they say the errors variable is always there in the blade file for you to use so I don't know what i am doing wrong?Any help would be appreciated! loving Laravel except for this error!ControllerRequest validationThis is a breaking problem with the 5.2 upgrade.  What's happening is the middleware which is responsible for making that errors variable available to all your views is not being utilized because it was moved from the global middleware to the web middleware group.There are two ways to fix this: SolvedYou may change any one of the following:1. put your working route (app/http/routes.php) onRoute::group(['middleware' => ['web']], function () {

    // Here like

    Route::get('/', 'TodoController@index');

    Route::post('/', 'TodoController@store');

});Screenshot - 2. Move your protected $middlewareGroups web (app/Http/Kernel.php) on protected $middleware = []Screenshot -simply, you have to move : from protected $middlewareGroups to protected $middlewareThis is solution:Change the defination of your Route groups with a middleware, from :toSource: https://github.com/laravel/framework/issues/13000From protected $middlewareGroups to protected $middleware in kernel.php page As the Laravel Documentation says: So removing from routes.php file would be the correct way.Posting this as it might be useful for others, As Smartrahat mentioned in 1st solution, in your Kernel.php file(app/Http/Kernel.php) move \Illuminate\View\Middleware\ShareErrorsFromSession::class

from $middlewareGroups to protected $middleware property, but the same will start throwing the error "Session store not set on request", to resolve this move

\Illuminate\Session\Middleware\StartSession::class, to $middleware property as well.As of 5.2, routes.php is by default already called in the context of a ['middleware'=>'web'] by RouteServiceProvider. But in routes.php default generation of auth routes, the Route::group call is still happening by default - so if you delete that Route::group declaration from routes.php the application then correctly shows errors.A couple of observations regarding this issue. First off there a related bug in github regarding this issue

PFA

https://github.com/laravel/framework/issues/12022If you look at the last comment which Graham wrote, I think that is the facing I was facing.

For me even though there was a error in form post data, I was getting the below equalityIn my case I added log statements in the the above  middleware class ran twice for a given request, I am not sure why it ran twice, but I think because of this the $errors variable is getting reset.

I was using this configuration (which I think came default with Laravel@5.2.43)I changed the configuration which worked for me and the $errors variable's count is not zero (also the above middleware ran only once per request)Note:

All my routes are in the web middleware group before and after the Kernel.php configuration change, I didnot move my routes at all from the web middleware group.Change @foreach($errors->any() as $error) to @foreach($errors->all() as $error)in this case laravel 5.2 you can refer may example code and edit your kernal.php file. move this  \Illuminate\View\Middleware\ShareErrorsFromSession::class, form middlewareGroups to middleware and add  \Illuminate\Session\Middleware\StartSession::class, to  middleware 

then its work correctly.Having both Web and API requirements in our application, we did not want to move the middleware around; perhaps that would have worked, however:We had the very peculiar situation that the flash[] and $errors session data was transmitted correctly between the standard laravel resource methods, store() and edit(), but in some cases the data did not get back across nearly identical methods, storeSale() and editSale().We found that in our development and deployment environments, the 'file' and 'database' session drivers worked in all cases, but the 'cookie' driver did not.Switching to the database driver in all instances solved the problem.

Laravel not sending email and not giving errors

Daniel Barde

[Laravel not sending email and not giving errors](https://stackoverflow.com/questions/23980979/laravel-not-sending-email-and-not-giving-errors)

I've been on a project for the past four months now and I am really pissed at what am facing with Laravel right now. It's not sending emails; I set it up to use the mail driver and put in the right code, but it seems not to work at all. Besides not working, it doesn't even give me an error!Here is my configuration:Here is my PHP code  for sending email:

2014-06-01 14:39:11Z

I've been on a project for the past four months now and I am really pissed at what am facing with Laravel right now. It's not sending emails; I set it up to use the mail driver and put in the right code, but it seems not to work at all. Besides not working, it doesn't even give me an error!Here is my configuration:Here is my PHP code  for sending email:First and foremost, go to the app/config/mail.php and change the driver to「mail」. Also put the host as blank.In my scenario email was being queued so that is why I got no output. I had forgotten I set email to queue by default. I looked in the Jobs table I saw all my messages waiting in there. I ran php artisan queue:work to get the queue running/sending them.It could be because you have a ".env" file, in the Laravel project root, with mail server configuration like this:It seems the ".env" file just overrides "config/mail.php" file. You can just remove same lines from the ".env" file for use "config/mail.php" configuration options.Go to .env file and set Or you can set driver from the config files. Go to file

Laravel 4 : app/config/mail.php

Laravel 5 : config/mail.php

and set You may use SMTP. Hope It will help.The Fix That Worked For MeAfter that my mail started sending! How I Arrived At That FixI had previously set my SMTP details up correctly, but even after doing config:cache config:clear and restarting my server, the emails were not sending. After that I compared it to my working Laravel App, and the only difference was the 127.0.0.1 -> http://localhost, so I changed that as a last ditch attempt, and it worked.A solution for notifications not sent via 'mail'https://laravel.com/docs/5.7/notifications#customizing-the-recipientConfiguration file:Then run the make:mail command:Routes:Controller:View:Mail:Thing to remember: The message variable is a build-in variable and will generate error so use any other variable instead of message.More details:Change the driver in your config file to 'smtp' from 'mail'. I guess that should work. I finally got it to work. If you're using mailgun, add this information below to your .env fileand then runFor Laravel 6, if verification email is not send anymore:in user.php addandand in routes/web.phpFirstle go to your project root on cmd and run this cmd -Go to .env fileGo to project root and use this cmdafter that goto App\mail\WelcomeUserVerifyMail

add these line -In your controller where you use mail functionality -Not a technical answer but it fixed my issue.If your using GMAIL to check the incoming mail just make sure you check your SPAM folder.run as

Laravel migrations nice way of disabling foreign key checks

Pavlin

[Laravel migrations nice way of disabling foreign key checks](https://stackoverflow.com/questions/34298639/laravel-migrations-nice-way-of-disabling-foreign-key-checks)

When running laravel migrations, I am facing a small inconvenience. I use Laravel 5.1.Since there are a lot of tables with many relationships, it is probably impossible that I rename the migration files so they run in the correct order, so no foreign key constraint is violated. This was what I did once in the past, and it was very inpractical.What I'm doing now is defining each migration like this:The problem with this is that it's tedious to write and it clutters up the code.I've also thought about creating two dummy migration files, whose only purpose would be to enable and disable the foreign key checks, and I would name them in such a way that they would run at the beginning and the end of each migration.If there is an elegant solution, would it be possible to apply it to the seeding process as well, since this tends to be a problem there as well.This is obviously a very improvised solution, and I am asking if there is a better way of doing it. Is there some beforeMigrate and afterMigrate methods that I can override or something along those lines?And if not, how do you go about doing it?Any insights would be appreciated, I dislike all the options I have stated.

2015-12-15 20:20:46Z

When running laravel migrations, I am facing a small inconvenience. I use Laravel 5.1.Since there are a lot of tables with many relationships, it is probably impossible that I rename the migration files so they run in the correct order, so no foreign key constraint is violated. This was what I did once in the past, and it was very inpractical.What I'm doing now is defining each migration like this:The problem with this is that it's tedious to write and it clutters up the code.I've also thought about creating two dummy migration files, whose only purpose would be to enable and disable the foreign key checks, and I would name them in such a way that they would run at the beginning and the end of each migration.If there is an elegant solution, would it be possible to apply it to the seeding process as well, since this tends to be a problem there as well.This is obviously a very improvised solution, and I am asking if there is a better way of doing it. Is there some beforeMigrate and afterMigrate methods that I can override or something along those lines?And if not, how do you go about doing it?Any insights would be appreciated, I dislike all the options I have stated.I had a similar task at hand when Lumen / Laravel started using Passport and I had to ditch the previous oauth server implementation from lucadegasperi/oauth2-server-laravel.I finally managed to get things going by creating 2 migrations, where the first one clears foreign keys and the second one actually deletes the tables.I had to use dates before the migrations of Laravel's Passport (2016-06-01) so they will be executed before those.2016_05_31_000000_clear_old_oauth_relations.phpAnd in the second file

2016_05_31_000001_clear_old_oauth.phpI got this done by extracting the foreign key logic into a separate migration file. This helped me to:In code:Another important aspect to remember is to drop the foreignKey FIRST, then the column. Dropping the column first throws the error: Cannot drop index 'tableName_columnName_foreign': needed in a foreign key constraintThe proper order matters:

Tell Composer to use Different PHP Version

Boom

[Tell Composer to use Different PHP Version](https://stackoverflow.com/questions/32750250/tell-composer-to-use-different-php-version)

I've been stuck at this for a few days. I'm using 1and1 hosting, and they have their PHP set up a bit weird.If I use just php composer.phar install, then I'm using PHP 4.4.6, which is horribly insufficient. However, I can run php5.5 composer.phar install, get a little bit further, but it still fails because somewhere along the line, PHP is called again, but it fails, as it's using 4.4.6.Is there any way to tell Composer to use the php5.5 command? Has anyone successfully gotten Composer configured on 1and1 hosting?I'm trying to get Laravel up and running (which uses Composer). I've been able to do it on my GoDaddy domain, but not 1and1.

2015-09-23 22:01:48Z

I've been stuck at this for a few days. I'm using 1and1 hosting, and they have their PHP set up a bit weird.If I use just php composer.phar install, then I'm using PHP 4.4.6, which is horribly insufficient. However, I can run php5.5 composer.phar install, get a little bit further, but it still fails because somewhere along the line, PHP is called again, but it fails, as it's using 4.4.6.Is there any way to tell Composer to use the php5.5 command? Has anyone successfully gotten Composer configured on 1and1 hosting?I'm trying to get Laravel up and running (which uses Composer). I've been able to do it on my GoDaddy domain, but not 1and1.Ubuntu 18.04 case ... this run for me.On xubuntu I had php 7.2 as default. But needed to run composer with php 5.6.So this worked for me:Just add below code to your composer.json file to set different php version.Try this approachI too have a shared hosting account on 1&1 (ionos) and here's what I have had to do:if you login as the root ssh account, you can create a ~/.bash_profile and addto it so that you can now use the commands you would normally use and it just works. (put composer.phar in your project folder root)Then, make sure your laravel composer.lock file from your dev machine gets up to your project folder on 1and1 and run I still had STDIN issues with artisan commands so make sure you change the .env file tobecause having it set to production throws infinite STDIN warnings as it waits for you to type yes. At least on my account it does.Hope this helps somebody.You could change your PATH to override the php version.In /home/user/bin (or any other directory really) make a symlink named php to the php5 binary.Another option, use a shell alias:php5.5 composer.phar install fails because your composer.json is telling it to run php and not php5.5, edit the file composer.json replace the php scripts references to php5.5. Example:From:To:Even when doing this, 1and1 has a memory limit for scripts execution so php5.5 composer.phar install won't fail but it won't complete its execution either. You can still run the scripts post install manually.I have deployed Laravel webapps to 1and1 without commit vendor directory, following this guide: Deploy Laravel Webapp to 1and1composer is a PHP binary script and it's using Unix Shebang to define which interpreter for executing.So if you're running composer without any specific option, it will use your PHP version at /usr/bin/env php (which is your default PHP)We can have many versions of PHP inside your Linux and you can flexible use which PHP version for executing as you want like this way:Or justTo check & find all installed PHP packages, goto /usr/bin/ Know this question is a bit old... but if you pull down composer into your app root:https://getcomposer.org/download/Instead of relying on global composer, then you can run:or I believe newer homstead versions would be like:https://laracasts.com/discuss/channels/laravel/run-composer-commands-with-different-php-versionsYou could try and copy the php and php-config files into /usr/local/bin instead.  That path has a higher order of precedence and should override the /usr/bin folder without needing to disable SIP.  That is what I did.

Class 'UserTableSeeder' does not exist - Laravel 5.0 [php artisan db:seed]

thirdriver

[Class 'UserTableSeeder' does not exist - Laravel 5.0 [php artisan db:seed]](https://stackoverflow.com/questions/36206742/class-usertableseeder-does-not-exist-laravel-5-0-php-artisan-dbseed)

I'm trying a basic php artisan db:seed after migrating my database but it keeps returning the title error in cmd -[ReflectionException] Class 'UserTableSeeder' does not existThings I Have TriedBelow is the migrationsBelow is the UserTableSeeder.phpBelow is the DatabaseSeeder.php

2016-03-24 17:47:31Z

I'm trying a basic php artisan db:seed after migrating my database but it keeps returning the title error in cmd -[ReflectionException] Class 'UserTableSeeder' does not existThings I Have TriedBelow is the migrationsBelow is the UserTableSeeder.phpBelow is the DatabaseSeeder.phpRun composer dumpautoload after creating files in the database/ folder.Why?Check the composer.json autoload section and you'll see the database/ folder is loaded by "classmap" (source):The Composer docs describe classmap as:Emphasis added. You need to run the composer dumpautoload command to generate a new classmap every time you add a file to database/, otherwise it will not be autoloaded.The app/ folder, by contrast, uses the PSR-4 standard for converting a fully qualified class name to a filesystem path. This is why you don't need to dumpautoload after adding files there.Try changing toand try runningSometimes the code is correct but you need to run the following command in order to run the seeder command.

First Run this commandThen seed the seederI hope it will workWhen we change or delete the Controller file or another file then their file should be removed from everywhere in code. You need to run command to refresh your composer

Laravel password validation rule

Bharanikumar

[Laravel password validation rule](https://stackoverflow.com/questions/31539727/laravel-password-validation-rule)

How to added password validation rule in the validator?Validation rule:The password contains characters from at least three of the following five categories:How to add above rule in the validator rule?My Code Here

2015-07-21 12:59:49Z

How to added password validation rule in the validator?Validation rule:The password contains characters from at least three of the following five categories:How to add above rule in the validator rule?My Code HereI have had a similar scenario in Laravel and solved it in the following way.The password contains characters from at least three of the following five categories:First, we need to create a regular expression and validate it.Your regular expression would look like this:I have tested and validated it on this site. Yet, perform your own in your own manner and adjust accordingly. This is only an example of regex, you can manipluated the way you want.So your final Laravel code should be like this: Update

As @NikK in the comment mentions, in Laravel 5.6 the the password value should encapsulated in array Square brackets likeI have not testing it on Laravel 5.6 so I am trusting @NikK hence I have moved to working with c#/.net these days and have no much time for Laravel.Note: Some online referencesRegarding your custom validation message for the regex rule in Laravel, here are a few links to look at:This doesn't quite match the OP requirements, though hopefully it helps. With Laravel you can define your rules in an easy-to-maintain format like so:Would output:(The regex rules share an error message by default—i.e. four failing regex rules result in one error message)Sounds like a good job for regular expressions. Laravel validation rules support regular expressions. Both 4.X and 5.X versions are supporting it :This might help too:http://www.regular-expressions.info/unicode.html

Mongo groupby is not working with different time in Laravel raw method

Sarath TS

[Mongo groupby is not working with different time in Laravel raw method](https://stackoverflow.com/questions/45568957/mongo-groupby-is-not-working-with-different-time-in-laravel-raw-method)

The below code is to fetch data from MongoDB and plot sum of amounts and dates in a graph within date range (sum(prepayment_amount) and sum(total_prepayment_amount) group by checkin_from date). The sum of amounts is in y axis and date is in x axis.  From this code, I am getting the sum of amounts and date but the problem is, see date and time 2017-10-05T19:07:17Z & 2017-10-05T00:00:00Z. In this case (sum(prepayment_amount) and sum(total_prepayment_amount) dates are plotting separately.  If date and time is 2017-10-05T00:07:17Z & 2017-10-05T00:00:00Z, I am getting a correct result.I don't know where is the issue. I have added expected results. Any help would be appreciated. ThanksBooking.php (model)DashbardController.phpBooking CollectionExpecting resultImagePlease check the image, here you can find the problem. For better understanding I have listed time also in the x-axis.Note: In graph data not match with question data because I have connected a database with a test server.

2017-08-08 12:54:35Z

The below code is to fetch data from MongoDB and plot sum of amounts and dates in a graph within date range (sum(prepayment_amount) and sum(total_prepayment_amount) group by checkin_from date). The sum of amounts is in y axis and date is in x axis.  From this code, I am getting the sum of amounts and date but the problem is, see date and time 2017-10-05T19:07:17Z & 2017-10-05T00:00:00Z. In this case (sum(prepayment_amount) and sum(total_prepayment_amount) dates are plotting separately.  If date and time is 2017-10-05T00:07:17Z & 2017-10-05T00:00:00Z, I am getting a correct result.I don't know where is the issue. I have added expected results. Any help would be appreciated. ThanksBooking.php (model)DashbardController.phpBooking CollectionExpecting resultImagePlease check the image, here you can find the problem. For better understanding I have listed time also in the x-axis.Note: In graph data not match with question data because I have connected a database with a test server.In the $group you are using $checkin_from directly as a date with time hence it is grouped by date AND time.The answer is to use $dateFormat so we have only the date without the time:You can use this group stag, Where I am convert string into number. total_prepayment_amount and prepayment_amount are string as per provided data 

  they should be integer to $sum. like this in query for mongodbPlease make sure mongodb ^4.0 (for use $toInt) 

Laravel 5.1 Eloquent ORM randomly returning incorrect relationship - *major update*

BrynJ

[Laravel 5.1 Eloquent ORM randomly returning incorrect relationship - *major update*](https://stackoverflow.com/questions/33607125/laravel-5-1-eloquent-orm-randomly-returning-incorrect-relationship-major-upda)

I have a Laravel app that powers an ecommerce website with moderate traffic. This website allows people to place orders via the frontend, but it also has backend functionality for taking orders over the phone via a call centre. An order is related to a customer, and a customer can optionally be a user - a user being someone with a login to the frontend. A customer with no user account is only ever created as a result of an order being taken via the call centre.The issue I have encountered is very odd, and I believe might be some kind of Laravel bug. It only occurs very occasionally, but what is happening is that when an order is taken via the call centre for a customer with no user account, an order confirmation is being sent out to a random user - literally random, as far as I can tell, just plucked out of the database despite no relation in the data.These are the relevant parts of the models in the project:These are the database migrations for the above (edited for brevity):The logic that sends the order confirmation is within an event handler that gets fired after the order has been paid. Here is the OrderSuccess event (edited for brevity):As can be seen, this event is passed an Order model object.Here is the event handler (edited for brevity):There is a check to see if the $order->customer->user object is not null and, if true, an order confirmation is sent. If it is null (which it frequently is), then no confirmation is sent.As can be seen from the above, I added a log to record the objects when an email is sent. Here is an example of an erroneous one (again, truncated for brevity):As you can see, there is no user_id for Customer, and yet Laravel has returned a User object.What is more, if I manually fire the exact same OrderSuccess event, the above is not reproducible - it does not send the email, and it does not load a User object.As I said before, this issue is happening very infrequently - there are on average about 40 orders a day via the call centre for customers with no user account, and the highlighted issue might only occur once or twice a week.I'm not familiar enough with Laravel to know what might be the issue here - is it some form of model caching, a problem with Eloquent ORM, or some other gremlin in the system?Any ideas appreciated - I may post this problem in the Laravel github issue tracker if it appears to be some form of bug.Update Relating to some of the answers / comments put forward, I have tried to remove any potential Eloquent ORM issues, to retrieve the data manually, like so:The above is still producing the same random results - unrelated users are being retrieved even when the customer has no user_id (it's NULL in this instance).Update 2 As the first update did not help in any way, I reverted to using the original Eloequent approach. To try another solution, I took my event code out of the event handler, and placed it in my controller - I was previously firing by OrderSuccess event using Event::fire(new OrderSuccess ($order));, and instead I commented this line out and just placed the event handler code in the controller method:The above change has been on the production site for over a week now - and since that change, there has not been a single instance of the issue. The only possible conclusion I can reach is some kind of bug in the Laravel event system, somehow corrupting the passed object. Or could something else be at play? Update 3

It seems I was premature to state that moving my code outside the event fixed the issue - in fact, via my logging, in the last 2 days I can see some more incorrect order confirmation were sent out (a total of 5, after almost 3 weeks of no issues).I noticed that the user ids that had received the rogue order confirmations appeared to be incrementing (not without gaps, but still in ascending order). I also noticed that each of the problem orders had been paid for via cash and account credit - most are cash only. I looked further into this, and the user ids are actually the ids of the related credit transactions! The above is the first cast iron breakthrough in trying to resolve this issue. On closer inspection, I can see that the issue is still random - there are quite a few (at least 50%) orders that have been paid via account credit for customer's with no user account, but that have not caused incorrect emails to be sent out (despite the associated credit transaction id having a user id match).So, the problem is still random, or seemingly so. My credit redemption event is triggered like so:The above is called just prior to my OrderSuccess event - as you can see, both events are passed the $order model object.My CreditRedemption event handler looks like this:The $credit_transaction->save(); is generating the id in my credit_transactions table that is somehow being used by Laravel to retrieve a user object. As can be seen in the above handler, I'm not updating my $order object at any point. How is Laravel using (remember, still randomly, some < 50% of the time) the id of my newly created $credit_transaciton to populate the $order->customer->user model object?

2015-11-09 10:29:05Z

I have a Laravel app that powers an ecommerce website with moderate traffic. This website allows people to place orders via the frontend, but it also has backend functionality for taking orders over the phone via a call centre. An order is related to a customer, and a customer can optionally be a user - a user being someone with a login to the frontend. A customer with no user account is only ever created as a result of an order being taken via the call centre.The issue I have encountered is very odd, and I believe might be some kind of Laravel bug. It only occurs very occasionally, but what is happening is that when an order is taken via the call centre for a customer with no user account, an order confirmation is being sent out to a random user - literally random, as far as I can tell, just plucked out of the database despite no relation in the data.These are the relevant parts of the models in the project:These are the database migrations for the above (edited for brevity):The logic that sends the order confirmation is within an event handler that gets fired after the order has been paid. Here is the OrderSuccess event (edited for brevity):As can be seen, this event is passed an Order model object.Here is the event handler (edited for brevity):There is a check to see if the $order->customer->user object is not null and, if true, an order confirmation is sent. If it is null (which it frequently is), then no confirmation is sent.As can be seen from the above, I added a log to record the objects when an email is sent. Here is an example of an erroneous one (again, truncated for brevity):As you can see, there is no user_id for Customer, and yet Laravel has returned a User object.What is more, if I manually fire the exact same OrderSuccess event, the above is not reproducible - it does not send the email, and it does not load a User object.As I said before, this issue is happening very infrequently - there are on average about 40 orders a day via the call centre for customers with no user account, and the highlighted issue might only occur once or twice a week.I'm not familiar enough with Laravel to know what might be the issue here - is it some form of model caching, a problem with Eloquent ORM, or some other gremlin in the system?Any ideas appreciated - I may post this problem in the Laravel github issue tracker if it appears to be some form of bug.Update Relating to some of the answers / comments put forward, I have tried to remove any potential Eloquent ORM issues, to retrieve the data manually, like so:The above is still producing the same random results - unrelated users are being retrieved even when the customer has no user_id (it's NULL in this instance).Update 2 As the first update did not help in any way, I reverted to using the original Eloequent approach. To try another solution, I took my event code out of the event handler, and placed it in my controller - I was previously firing by OrderSuccess event using Event::fire(new OrderSuccess ($order));, and instead I commented this line out and just placed the event handler code in the controller method:The above change has been on the production site for over a week now - and since that change, there has not been a single instance of the issue. The only possible conclusion I can reach is some kind of bug in the Laravel event system, somehow corrupting the passed object. Or could something else be at play? Update 3

It seems I was premature to state that moving my code outside the event fixed the issue - in fact, via my logging, in the last 2 days I can see some more incorrect order confirmation were sent out (a total of 5, after almost 3 weeks of no issues).I noticed that the user ids that had received the rogue order confirmations appeared to be incrementing (not without gaps, but still in ascending order). I also noticed that each of the problem orders had been paid for via cash and account credit - most are cash only. I looked further into this, and the user ids are actually the ids of the related credit transactions! The above is the first cast iron breakthrough in trying to resolve this issue. On closer inspection, I can see that the issue is still random - there are quite a few (at least 50%) orders that have been paid via account credit for customer's with no user account, but that have not caused incorrect emails to be sent out (despite the associated credit transaction id having a user id match).So, the problem is still random, or seemingly so. My credit redemption event is triggered like so:The above is called just prior to my OrderSuccess event - as you can see, both events are passed the $order model object.My CreditRedemption event handler looks like this:The $credit_transaction->save(); is generating the id in my credit_transactions table that is somehow being used by Laravel to retrieve a user object. As can be seen in the above handler, I'm not updating my $order object at any point. How is Laravel using (remember, still randomly, some < 50% of the time) the id of my newly created $credit_transaciton to populate the $order->customer->user model object?I can't help you get to the root of whats causing your issue, but I can offer a possible work around based on the logic you provided in Update 1 of your question. Because a customers user_id can be null, it may be more effective to limit the returned customers to those who have a user_id. This can be achieved by using the whereNotNull() method. We can then go on to check if a customer was returned, and if so send the email, etc.By not giving the application a chance to return a customer with a null user_id this should hopefully solve your issue, but unfortunately it doesn't shine any light on why it is happening in the first place.Shouldn't your migrations havefor example:As mentioned in the Laravel Doc?I am not sure if your migrations are defined correctly specially when compared to your Models. If you are using belongsTo and hasOne relationship, you should use foreign key references in migrations. Now you will need to set this column whenever an actual user exists when the customer record is being created. But you don't actually have to set this column manually. You can do this below as you are using relationships:Step 1: Save the customer first.Step 2: Now we will set the user_id on the customer if exists. To do this, you can get the user object in $user and then just callThe code above will automatically set the user_id on customers tableThen I will check if user record exists in this way below:It is not necessary to have FK.

Eloquent can mange to build relations based on the name of the columns. Change the name of the fields. The name of the field should match table name with suffix "_id". In the customers table user_id should be users_id. In orders customer_id should be customers_id. You can try to pass the name of the field you want to join with:I am not very advanced user with Laravel so this might not work. I had the same issue and I solved it by renaming all models and columns to match table names (with "s").your user_id field in customers table should be nullable.

laravel model callbacks after save, before save, etc

Orbitum

[laravel model callbacks after save, before save, etc](https://stackoverflow.com/questions/13518674/laravel-model-callbacks-after-save-before-save-etc)

Are there callbacks in Laravel like:I searched but found nothing. If there are no such things - what is best way to implement it?Thanks!

2012-11-22 19:01:17Z

Are there callbacks in Laravel like:I searched but found nothing. If there are no such things - what is best way to implement it?Thanks!Actually, Laravel has real callback before|after save|update|create some model. check this:https://github.com/laravel/laravel/blob/3.0/laravel/database/eloquent/model.php#L362the EventListener like saved and saving are the real callbacks how can we work with that? just assign it to this eventListener example:The best way to achieve before and after save callbacks in to extend the save() function.Here's a quick exampleSo now when you save a Page object its save() function get called which includes the parent::save() function;Adding in an example for Laravel 4:Even though this question has already been marked 'accepted' - I'm adding a new updated answer for Laravel 4.Beta 4 of Laravel 4 has just introduced hook events for Eloquent save events - so you dont need to extend the core anymore:In Laravel 5.7, you can create a model observer from the command line like this:Then in your app\AppServiceProvider tell the boot method the model to observe and the class name of the observer.Then in your app\Observers\ you should find the observer you created above, in this case ClientObserver, already filled with the created/updated/deleted event hooks for you to fill in with your logic.  My ClientObserver:I really like the simplicity of this way of doing it.  Reference https://laravel.com/docs/5.7/eloquent#eventsIf you want control over the model itself, you can override the save function and put your code before or after __parent::save().Otherwise, there is an event fired by each Eloquent model before it saves itself.There are also two events fired when Eloquent saves a model."eloquent.saving: model_name" or "eloquent.saved: model_name".http://laravel.com/docs/events#listening-to-eventsYour app can break using afarazit solution*

Here's the fixed working version:NOTE: saving or any other event won't work when you use eloquent outside of laravel, unless you require the events package and boot the events. This solution will work always.So now when you save a Page object its save() function get called which includes the parent::save() function;afarazit* I tried to edit his answer but didn't work

Find or Create with Eloquent

charleyh

[Find or Create with Eloquent](https://stackoverflow.com/questions/20309033/find-or-create-with-eloquent)

I have recently started working with Laravel and Eloquent, and was wondering about the lack of a find or create option for models. You could always write, for example:However, is there not a better way to find or create? It seems trivial in the example, but for more complex situations it would be really helpfully to either get an existing record and update it or create a new one.

2013-12-01 05:26:49Z

I have recently started working with Laravel and Eloquent, and was wondering about the lack of a find or create option for models. You could always write, for example:However, is there not a better way to find or create? It seems trivial in the example, but for more complex situations it would be really helpfully to either get an existing record and update it or create a new one.Below is the original accepted answer for: Laravel-4There is already a method findOrFail available in Laravel and when this method is used it throws ModelNotFoundException on fail but in your case you can do it by creating a method in your model, for example, if you have a User model then you just put this function in the modelFrom your controller, you can useIf a user with id of 5 exists, then it'll be updated, otherwise a new user will be created but the id will be last_user_id + 1 (auto incremented).This is another way to do the same thing:Instead of creating a static method, you can use a scope in the Model, so the method in the Model will be scopeMethodName and call Model::methodName(), same as you did in the static method, for exampleThe firstOrCreate is available in Laravel 5x, the answer is too old and it was given for Laravel-4.0 in 2013.In Laravel 5.3, the firstOrCreate method has the following declaration:Which means you can use it like this:User's existence will be only checked via email, but when created, the new record will save both email and name.API DocsAlternatively, in this case you can also use Laravel's function and search for id as an attribute, i.e.Laravel 4 models have a built-in findOrNew method that does what you need:Find or New based on primary key idFirst or New based on non-primary key single filedFirst or New based on non-primary key multiple filedIn Laravel 5:

There are two methods you may use to create models by mass assigning attributes: firstOrCreate and firstOrNew. 

The firstOrCreate method will attempt to locate a database record using the given column / value pairs. If the model can not be found in the database, a record will be inserted with the given attributes.

The firstOrNew method, like firstOrCreate will attempt to locate a record in the database matching the given attributes. However, if a model is not found, a new model instance will be returned. Note that the model returned by firstOrNew has not yet been persisted to the database. You will need to call save manually to persist it:You can use firstOrCreate (It's working with Laravel 4.2)returns found instance or new instance.

Generate Controller and Model

Sophy

[Generate Controller and Model](https://stackoverflow.com/questions/14265996/generate-controller-and-model)

I am newbie with Laravel and I played around laravel 4(Beta version). I want to know how to generate Controller and Model by command line use php artisan. But I don't know how to do them.

2013-01-10 19:44:19Z

I am newbie with Laravel and I played around laravel 4(Beta version). I want to know how to generate Controller and Model by command line use php artisan. But I don't know how to do them.See this video: http://youtu.be/AjQ5e9TOZVk?t=1m45s

You can do php artisan list to view all commands, 

The command for generating REST-ful controllers is controller:make

You can view the usage with: php artisan help make:controllerLaravel 5The other answers are great for Laravel 4 but Laravel 5 is here! We now have the ability to generate all kinds of stuff by default. Run php artisan help to view all artisan commands. Here are all of the make commands:Note: we no longer use item:make. Instead we now have make:item. Run php artisan help make:item to see what you can pass it. For instance php artisan help make:migration shows that we need to pass it the migration name but we can also pass it --create="" or --table="" to specify the table name to create or modify respectively. Run php artisan make:migration create_articles_table --create="articles" to generate the articles table. Moreover, generating models takes care of generating the migration for that model. Follow the naming conventions and it will be pluralized it for the migration. Thank you @user1909426, I can found solution by php artisan list it will list all command that was used on L4. It can create controller only not Model. I follow this command to generate controller.On Laravel 5, the command has changed:Note: [Name] name of controllerMake resource controller with Model.php artisan make:controller PostController --model=PostFor generate Model , controller with resources and migration best command is:laravel artisan does not support default model and view generation. check this provider https://github.com/JeffreyWay/Laravel-4-Generators to generate models, views, seeder etc.You can make a plain controller file likeModels:Create with Resource MethodUse It With a pathMake model , Controller by Make model , Controller with Resource Use:e.g

Laravel migration array type (store array in database column)

Zakaria Acharki

[Laravel migration array type (store array in database column)](https://stackoverflow.com/questions/32954424/laravel-migration-array-type-store-array-in-database-column)

I want to store an array of integers in my table and I can't find any type that supports array in Documentation, any suggestion.Migration:

2015-10-05 17:28:08Z

I want to store an array of integers in my table and I can't find any type that supports array in Documentation, any suggestion.Migration:The array datatype is not present in all database systems and because Laravel's Schema Builder is database agnostic, it doesn't offer methods to create non-common datatype columns. So you have two options:1. Use a raw SQL statement to add the column, something like the statement below I think should work. Although I'm not sure if the Query Builder or Eloquent can handle these types of columns correctly:2. Use Eloquent's available workaround by using attribute casting. In your migration create the column as json like so:Then you can setup your Pickup model (if you haven't done so already) and use the $casts property:This will let Eloquent know that when it fetches data from the database it will have to convert the shifts column value to an array. This is only emulating an actual array, as at the database level the column is of type TEXT and the array is serialized. However when unserializing the column value, Eloquent returns an actual array of integers for you to use in your code. Below is an example use case:Assuming the above generated an entry with id equal to 1 when you later retrieve the entry:The dump() from the code above will output an actual array of integers:

Laravel retrieve binded model in Request

Phil Cross

[Laravel retrieve binded model in Request](https://stackoverflow.com/questions/29775032/laravel-retrieve-binded-model-in-request)

Is there any easy way of retrieving the route binded model within a Request?I want to update a model, but before I do, I want to perform some permissions checks using the Requests authorize() method. But I only want the owner of the model to be able to update it.In the controller, I would simply do something like this:But I'm looking to do this within the Request, rather than within the controller. If I do:It only gives me the scalar form properties (such as _method and so on, but not the model).QuestionIf I bind a model to a route, how can I retrieve that model from within a Request?Many thanks in advance.

2015-04-21 14:24:12Z

Is there any easy way of retrieving the route binded model within a Request?I want to update a model, but before I do, I want to perform some permissions checks using the Requests authorize() method. But I only want the owner of the model to be able to update it.In the controller, I would simply do something like this:But I'm looking to do this within the Request, rather than within the controller. If I do:It only gives me the scalar form properties (such as _method and so on, but not the model).QuestionIf I bind a model to a route, how can I retrieve that model from within a Request?Many thanks in advance.Absolutely! It’s an approach I even use myself.You can get the current route in the request, and then any parameters, like so:Unlike smartman’s (now deleted) answer, this doesn’t incur another find query if you have already retrieved the model via route–model binding.To add on to Martin Bean's answer, you can access the bound instance using just route($param):Note: This works in Laravel 5.1. I have not tested this on older versions.Once you did your explicit binding (https://laravel.com/docs/5.5/routing#route-model-binding) you actually can get your model directly with $this.Even cleaner!

Laravel Auth:attempt() will not persist login

Leon Revill

[Laravel Auth:attempt() will not persist login](https://stackoverflow.com/questions/21603347/laravel-authattempt-will-not-persist-login)

I have found many resources online with similar issues but none of the solutions appear to solve my problem.When I log a user in with the following code, everything seems fine:The Auth::attempt() function returns true and the logged in user is returned to the client using Auth::user().But if the client makes another request to the server directly after, Auth::user() returns NULL.I have confirmed that Laravel sessions are working correctly by using the Session::put() and Session::get() successfully. On further investigation it appears that sessions are not persisting either! Could this be something to do with having the AngularJS web app server via app.mydomain.com and the Laravel API being served via api.mydomain.com?My User model is as follows:My auth config is as follows:The migration used to create the users table is as follows:And the session config:Any ideas?

2014-02-06 12:43:10Z

I have found many resources online with similar issues but none of the solutions appear to solve my problem.When I log a user in with the following code, everything seems fine:The Auth::attempt() function returns true and the logged in user is returned to the client using Auth::user().But if the client makes another request to the server directly after, Auth::user() returns NULL.I have confirmed that Laravel sessions are working correctly by using the Session::put() and Session::get() successfully. On further investigation it appears that sessions are not persisting either! Could this be something to do with having the AngularJS web app server via app.mydomain.com and the Laravel API being served via api.mydomain.com?My User model is as follows:My auth config is as follows:The migration used to create the users table is as follows:And the session config:Any ideas?I had this problem. Changing primary key for user model helped for me.Try to add something likein class User{} (app/models/User.php)(Field user_id is auto increment key in my Schema for 'users' table)See also this ticket: https://github.com/laravel/framework/issues/161I had this problem today morning, and I realized that when you output data before callingThen you can BE SURE THAT YOUR SESSION WILL NOT BE SET.

So for example if you do something like just above the line that says Then rest assured that you will spend the whole morning trying to find why laravel is not persisting the authenticated user and calling will give you a null, and also calling will always give you false.This was my problem and that is how I fixed it, by removing the echo statement.I had the same issue in laravel 5.7. Whoever facing similar issues if session not persisting after authentication , can follow the solution like below..Open file App\Http\kernel.phpMove \Illuminate\Session\Middleware\StartSession::class, from protected $middlewareGroups to protected $middleware . That's it.Try passing true to Auth:attempt() for the remember parameter:I'm not sure why you're returning Auth::user() at all though.I was having a similar issue, and in the end I was so focused on the back-end that I didn't consider the problem could be on the front-end. I'd used blade to output Auth:logout() directly to the front end to create a logout button, like so:Which is incorrect. Each time I logged into the application, I would be directed to a page with this button on, which I mistakenly thought would call Auth::logout() when pressed. Of course, the PHP is rendered on pageload and Auth::logout() is called straight away. Then when a user navigates to another page, since they've been logged out they're redirected to the login page to start the process again.FYI - The correct way to create a logout button, if you're using the default Auth route controller would be to direct to the route '/auth/logout', like so:<a href="{{url('/auth/logout')}}">Log Out</a>Firstly, I have the same problem on Laravel 5.8.I confirm that the solution of @nayeem-azad is the good one, at least in my case.

One difference, in App\Http\kernel.php, I do not moved this line :from protected $middlewareGroups to protected $middleware but only copied it to protected $middleware.Hope it helps ;-)The issue might be with your session configuration. Check to see if you've set up the session table Laravel needs to use the 'database' driver. You can see the config here: http://laravel.com/docs/session#database-sessionsHope this helps!How long is the id field in your sessions table?  Laravel uses a sha1 hash as the session id, which yields a string of length 40.  I had a similar problem and it was because my id field was set to length 32.See this question: Laravel 4.1 authentication session data not persisting across requestsOkay I haven't dug deep into it, but i've figured that laravel only returns cookies over a secure connection. As you must have noticed, laravel is setting up a cookie but it is not responding to the lifetime setting in session.phpTo get this to work on your local server you must mimic a https connection to ensure that the login persists. 

You can do this by generating a fake ssl certificate/key for your local domain.There are several tutorials available online that can help you enable ssl. These might be useful :How to enable SSL in MAMP ProMAMP with SSL (https)How To Create a SSL Certificate on Apache for Ubuntu 12.04Try to use before the return or the echo statment;ex:Using Laravel 5.7 by the way.I had the same problem but it was because I was trying to use their username for logging in. In the case you have custom user data besides the default email, name, and password and you don't want them to login via their email then you go to vendor/laravel/framework/src/Illuminate/Foundation/Auth/ and open the AuthenticatesUsers.php file. In it there's a public function called username:As you can see, by default it's set to 'email'. You can then change this to what you want the user to login with in combination with their password. So for my website I wanted the user to login using their username. So you simply change it from 'email' to 'username'.I hope this helps someone.NOTE: Peculiarly enough, for whatever reason, it gave me no errors when I tried to log in using username and password. Instead, it would seemingly validate but just not persist the user and I have no idea why.

Laravel's Artisan says nothing to migrate

totymedli

[Laravel's Artisan says nothing to migrate](https://stackoverflow.com/questions/21266956/laravels-artisan-says-nothing-to-migrate)

I installed migrations with php artisan migrate:install then created a migration with the php artisan migrate:make create_teams_table command. Now I try to run them with the following command that I made according to the official documentation:This gives me the following on the console:The migrations table in the database is empty and the new table isn't created neither. I don't understand why the documentation says foo in the path. What does foo mean and where does it comes from? First I tought that the path is wrong because of the foo thing and as I know the path is relative to the app folder so I changed it to app/database/migrations but it doesn't work. I also tried a lot of other path combination but none of them worked.Did I entered the wrong path? In this case shouldn't the console show some other kind of helpfull message? What does foo mean? How can I run my migration?

2014-01-21 19:08:16Z

I installed migrations with php artisan migrate:install then created a migration with the php artisan migrate:make create_teams_table command. Now I try to run them with the following command that I made according to the official documentation:This gives me the following on the console:The migrations table in the database is empty and the new table isn't created neither. I don't understand why the documentation says foo in the path. What does foo mean and where does it comes from? First I tought that the path is wrong because of the foo thing and as I know the path is relative to the app folder so I changed it to app/database/migrations but it doesn't work. I also tried a lot of other path combination but none of them worked.Did I entered the wrong path? In this case shouldn't the console show some other kind of helpfull message? What does foo mean? How can I run my migration?That foo thing is just an example. Laravel will look for migrations to run in app/database/migrations on default. Try removing that --path parameter and see if it works.Try this:First:Rolled back: 2014_03_28_142140_user_tableNothing to rollback.second:Migrated: 2014_03_28_142140_user_tablecheck the database.The path argument is for creating a migration for example:But it is not documented to use while running the migrations, as it was in prior versions of laravel. Dropping the --path argument should work in your caseWhat helped me:You don't need to move the migration file anywhere, just change its filename; for example, increase time integer and then run the migrate command with path pointing the migration. e.g: php artisan migrate --path="database/migrations/2019_07_06_145857_create_products_table.php"For anyone who still cannot migrate their database:Assume you have a file to migrate abc_migrate.php.Firstly put your file inside the new folder named abc_folder.

Then, enter this command 

php artisan migrate --path=database/migrations/abc_folder/.You don't have to add file name at last of the directory path.Done. Hope it helps.          The problem arises if the migrations table in the database is empty.

So the solution is open up the tinker from the composerHere is the result of the above commands executedAlso define the method down(), if it doesn't exist. 

Otherwise, it'll show

How to load view from alternative directory in Laravel 4

devo

[How to load view from alternative directory in Laravel 4](https://stackoverflow.com/questions/18954758/how-to-load-view-from-alternative-directory-in-laravel-4)

In my Laravel 4 application's root directory, I have a folder themes. Inside the themes folder, I have default and azure.

How can I access view from this themes/default folder in a specific route. -app--themes---default---azureI need to load views from localhost/laravel/app/themes/default folder. Please explain this.

2013-09-23 08:27:33Z

In my Laravel 4 application's root directory, I have a folder themes. Inside the themes folder, I have default and azure.

How can I access view from this themes/default folder in a specific route. -app--themes---default---azureI need to load views from localhost/laravel/app/themes/default folder. Please explain this.This is entirely possible with Laravel 4. What you're after is actually the view environment. 

You can register namespace hints or just extra locations that the finder will cascade too. Take a look hereYou'd add a location like so:It might be easier if you namespace them though, just in case you have conflicting file names as your path is appended to the array so it will only cascade so far until it finds an appropriate match. Namespaced views are loaded with the double colon syntax.You can also give addNamespace an array of view paths instead of a single path.Here I am not accessing my project from public folder. Instead of this I am accessing from project root itself. I have seen a forum discussion about Using alternative path for views here. But I am little confused about this.The discussed solution was,You'd add a location like,Then add namespace for theme,Then render it,What will be the value for /path/to/ ? Can I use the same project in different operating system without changing the path?Yes, we can do this using the following,Put the following in app/start/global.phpThen call view like the default way,This will render page.php or page.blade.php file from project_directory/app/themes/defualt folder.I've developed a theme package for laravel 5 with features like:Try it here: igaster/laravel-theme\View::addLocation($directory); works fine but the new right way to do it  is using loadViewsFrom($path, $namespace) (available on any service provider).

Laravel 5 Form Request data pre-manipulation

Jonathon

[Laravel 5 Form Request data pre-manipulation](https://stackoverflow.com/questions/28854585/laravel-5-form-request-data-pre-manipulation)

I'm processing a form where a user can update their date of birth. The form gives the user 3 separate fields for day, month and year. On the server-side of course I want to treat these 3 separate fields as one value i.e. yyyy-mm-dd.So before validation and updating my database, I want to alter the form request to create a date_of_birth field by concatenating year, month and day with - characters to create the date format I need (And possibly unset the original 3 fields).Achieving this manually with my controller is not a problem. I can simply grab the input, join the fields together separated by - characters and unset them. I can then validate manually before passing off to a command to deal with the processing.However, I would prefer to use a FormRequest to deal with the validation and have that injected into my controller method. Therefore I need a way of actually modifying the form request before validation is executed.I did find the following question which is similar: Laravel 5 Request - altering dataIt suggests overriding the all method on the form request to contain the logic for manipulating the data prior to validation.This is all well and good for the validation, but overriding the all method doesn't actually modify the data on the form request object. So when it comes to executing the command, the form request contains the original unmodified data. Unless I use the now overridden all method to pull the data out.I'm looking for a more concrete way to modify the data within my form request that doesn't require the calling of a specific method.Cheers

2015-03-04 12:30:35Z

I'm processing a form where a user can update their date of birth. The form gives the user 3 separate fields for day, month and year. On the server-side of course I want to treat these 3 separate fields as one value i.e. yyyy-mm-dd.So before validation and updating my database, I want to alter the form request to create a date_of_birth field by concatenating year, month and day with - characters to create the date format I need (And possibly unset the original 3 fields).Achieving this manually with my controller is not a problem. I can simply grab the input, join the fields together separated by - characters and unset them. I can then validate manually before passing off to a command to deal with the processing.However, I would prefer to use a FormRequest to deal with the validation and have that injected into my controller method. Therefore I need a way of actually modifying the form request before validation is executed.I did find the following question which is similar: Laravel 5 Request - altering dataIt suggests overriding the all method on the form request to contain the logic for manipulating the data prior to validation.This is all well and good for the validation, but overriding the all method doesn't actually modify the data on the form request object. So when it comes to executing the command, the form request contains the original unmodified data. Unless I use the now overridden all method to pull the data out.I'm looking for a more concrete way to modify the data within my form request that doesn't require the calling of a specific method.Cheersin laravel 5.1 you can do thatSince Laravel 5.4, you can use the prepareForValidation method on FormRequest classes.There's a more detailed write-up here:

https://sampo.co.uk/blog/manipulating-request-data-before-performing-validation-in-laravelNote: This question and answer were both posted before Laravel 5.1 was released and both target 5.0. For 5.1 and above, see this answer by @Julia Shestakova or this answer by @BenSampo for a more modern solution.After some messing around myself I've come up with the following:app/Http/Requests/Request.phpThen on extending classes you can just override the modifyInput method like this:app/Http/Requests/TestRequest.phpThis seems to work for my needs. I'm not sure of any drawbacks of doing it this way so I welcome any comments/criticism.The answer given by The Shift Exchange above will also work just fine.I took a similar approach to Julia Logvina but I think this way is a slightly more elegant way to add/modify fields before validation (Laravel 5.1) This will extend the default getValidatorInstance so we can modify the input values in the request before it gets to the validator (preventing it from using the original unmodified data). Once the data has been modified, it fires off the original getValidatorInstance then everything continues as normal.You can either use $this->replace(array()) or $this->merge(array()) your new fields into your request.  I've included an example of how to do both in the snippet above. replace() will replace all fields with the array you provide.merge() will add a new field into your request.I think this is the best approach to do so: Laravel 5.1 Modify input before form request validationIn Laravel 5.4+ there is a dedicated method for stuff like this so use it: prepareForValidationYou still override the all() method - but try it like thisThen you dont actually call the method yourself - it will be called by the validator itself when doing the rules.I too needed a quick and dirty way to accomplish this. I wanted to use The Shift Exchanges solution but it didn't work because of the calls to $this which creates an infinite recursive loop. A quick change to reference the parent method instead will fix the issue:HTH others in need.

naming tables in many to many relationships laravel

Pedram marandi

[naming tables in many to many relationships laravel](https://stackoverflow.com/questions/34897444/naming-tables-in-many-to-many-relationships-laravel)

I concerned about auto naming tables in many-to-many Laravel relationship.for example: when change the table name to:I have an error in my relationship. What's the matter with product_feature? 

2016-01-20 10:26:44Z

I concerned about auto naming tables in many-to-many Laravel relationship.for example: when change the table name to:I have an error in my relationship. What's the matter with product_feature? Laravel's naming convention for pivot tables is snake_cased model names in alphabetical order separated by an underscore. So, if one model is Feature, and the other model is Product, the pivot table will be feature_product.You are free to use any table name you want (such as product_feature), but you will then need to specify the name of the pivot table in the relationship. This is done using the second parameter to the belongsToMany() function.You can read more about many to many relationships in the docs.

Check if laravel model got saved or query got executed

user2722667

[Check if laravel model got saved or query got executed](https://stackoverflow.com/questions/27877948/check-if-laravel-model-got-saved-or-query-got-executed)

I've seen alot of people using this way to check if a laravel model got saved. So now I wonder if it is a safe way.And also can I check if the queries bellow got executed like thisCheck if model got saved Eg:Is the above a safe way to check whenever my model got saved or not?Check if query returned a resultEg:Does above return an error if no product where found?Check if query got executedEg:Does above check if a user was created?

2015-01-10 15:40:17Z

I've seen alot of people using this way to check if a laravel model got saved. So now I wonder if it is a safe way.And also can I check if the queries bellow got executed like thisCheck if model got saved Eg:Is the above a safe way to check whenever my model got saved or not?Check if query returned a resultEg:Does above return an error if no product where found?Check if query got executedEg:Does above check if a user was created?save() will return a boolean, saved or not saved. So you can either do:Or directly save in the if:Note that it doesn't make sense to call save() two times in a row like in your example. And by the way, many errors or problems that would keep the model from being saved will throw an exception anyways...first() will return null when no record is found so your check works find. However as alternative you could also use firstOrFail() which will automatically throw a ModelNotFoundException when nothing is found:(The same is true for find() and findOrFail())Unfortunately with create it's not that easy. Here's the source:As you can see it will create a new instance of the model with the $attributes and then call save(). Now if save() where to return true you wouldn't know because you'd get a model instance anyways. What you could do for example is check for the models id (since that's only available after the record is saved and the newly created id is returned)You can also check the public attribute $exists on your model.I would do such move to when I use Model::create method : As for the Save method it's easier because $model->save() returns Bool :

How to execute Stored Procedure from Laravel

Jordan Davis

[How to execute Stored Procedure from Laravel](https://stackoverflow.com/questions/34497063/how-to-execute-stored-procedure-from-laravel)

I need to execute a stored procedure after my form submits data. I have the stored procedure working like I want it, and I have my form working properly. I just do not know the statement to execute the sp from laravel 5.it should be something like this: execute my_stored_procedure. but I can not seem to find anything like that online. 

2015-12-28 16:27:36Z

I need to execute a stored procedure after my form submits data. I have the stored procedure working like I want it, and I have my form working properly. I just do not know the statement to execute the sp from laravel 5.it should be something like this: execute my_stored_procedure. but I can not seem to find anything like that online. Try something like thisorTry this for without parameters You can also do this:for Laravel 5.4if you want to pass parameters:for Laravel 5.5orno parameterRunning the Microsoft SQL Server Stored Procedure (MS SQL Server) using PHP Laravel framework.

If you are trying to run SP using Laravel Model then you can use following two approaches.If incase you are passing the Varchar Parameter then use the following:If you are just passing parameter which are of INT or BIGINT then this should work and you can get the return from SP:Once the stored procedure is executed the values will be present in the $submit in the form of array, you need to loop through it and access the required columns.After a long research, this works:For version 5.5 use CALL:Working code with Laraval 5.6,If using MySql with Laravel. Below is the way to go.DB::select(

        'call sp($id)'

    );

What's the difference between Commands and Events in the context of Laravel 5?

Peter Fox

[What's the difference between Commands and Events in the context of Laravel 5?](https://stackoverflow.com/questions/28344009/whats-the-difference-between-commands-and-events-in-the-context-of-laravel-5)

So Laravel 5 was finally released yesterday with the final implementation of the command bus but I was wandering, what's the real difference in using a command bus over event mechanisms that we have in the previous releases?Ok, I see the reason that it can be used to create commands from Request objects which is pretty useful but beyond that it seems to behave in a similar way even down to the whole queuing functionality for events now?Can you please provide examples of use cases and where the pros and cons of either are?

2015-02-05 12:29:12Z

So Laravel 5 was finally released yesterday with the final implementation of the command bus but I was wandering, what's the real difference in using a command bus over event mechanisms that we have in the previous releases?Ok, I see the reason that it can be used to create commands from Request objects which is pretty useful but beyond that it seems to behave in a similar way even down to the whole queuing functionality for events now?Can you please provide examples of use cases and where the pros and cons of either are?The differences appear minor - but have some key differences.Lets do an example to illustrate it best. Lets say we create a user, and we want to send them a welcome email and also update our newsletter list.In a Command Scenario would would dothen in our CommandClass - we would doBut if we use events - we would do something like this in our CommandClassthen we can create as many events as we want to listen to that event and do something:EventClassAEventClassB   The great thing is separation of concerns. The command "createuser" now does not need to worry itself about what happens after a user is created. It just needs to CreateUser.Also - if we want to add another function after a user signs up - say enter them in a lotto draw - you can just add another Event Class and add a new event listener.EventClassCNotice how we didnt need to touch the command CreateUser class code at all? This provides a true separation concerns of classes in a OOP style approach.I just want to share my understanding of this concept on top of the correct answer:The main difference is that Commands can change a Model state, while Events just react to a state change.COMMANDS:Commands in Laravel represent the implementation of the Command design pattern.The main adventages of Commands: To create a Command in Laravel 5:You need to generate a command DTO (which can implement the SelfHandling interface). Using php artisan make:command {command-name}Example: php artisan make:command Course/PostCourseCommandThe naming convention for commands: speak the business language and add postfix Command to itTo call (dispatch) the command from you controller, you can use:$this->dispatch(new PostCourseCommand())or Bus::dispatch(new PostCourseCommand());Side Note: 

The "dispatch from request」feature is a nice way to skip passing the variables to the command constructor one by one, instead it will resolve this for you:Example: Finally:You can separate the handler function and it’s logic from the command DTO to the Handlers directory, to do so:art handler:command --command="Course/PoatCourseCommand"EVENTS:Events in Laravel represent the implementation of the Observer design pattern.To create an Event in Laravel 5:Example: art make:event LogSomethingart handler:event LogSomething --event="LogSomething"Example: To call (fire) an Event:use:Event::fire(New LogSomething());or you can use the event helper          event(New LogSomething());Side Note:

alternatively you can generate an event by simply registering the event in the service provider then running this command.php artisan event:generate << this will automatically add the two classes for youAlso you can listen to an event without creating an event handler or registering a lister in the listeners array, by just going to the event service prover and inside the boot function writing your event and its action (NOT RECOMMENDED). Example:Finally: you can queue an event or even subscribe to multiple events from within the class itself..

How to add custom config file to app/config in Laravel 5?

Alexander Lomia

[How to add custom config file to app/config in Laravel 5?](https://stackoverflow.com/questions/38665907/how-to-add-custom-config-file-to-app-config-in-laravel-5)

I want to add custom_config.php to app/config directory of my Laravel 5 project, but can't find any article explaining this process. How is this done?

2016-07-29 19:04:21Z

I want to add custom_config.php to app/config directory of my Laravel 5 project, but can't find any article explaining this process. How is this done?You can easily add a new file to the config folder. This file should return configuration values. Check other config files for reference. Say constants.php is like soYou can now access this config file from anywhere by either using the Config Facade or the config() global function like soori.e. I don't know how many times one might need to create a config file, but here you have an Artisan command for it: https://gist.github.com/jotaelesalinas/eafd831048ca5fb5fba970afd1921f70

How to use pagination in laravel 5?

Sojan V Jose

[How to use pagination in laravel 5?](https://stackoverflow.com/questions/27980373/how-to-use-pagination-in-laravel-5)

am trying to port my laravel4 application to laravel 5 . In the previous version i could use the following method for generating pagination urls .In controller:and after sharing the data array with the view, i could user In views :In laravel 5 the doing that results in following errornot sure what i am missing here, can somebody help ?

2015-01-16 09:03:08Z

am trying to port my laravel4 application to laravel 5 . In the previous version i could use the following method for generating pagination urls .In controller:and after sharing the data array with the view, i could user In views :In laravel 5 the doing that results in following errornot sure what i am missing here, can somebody help ?In Laravel 5 there is no method "links" you can try thisIn other frameworks, pagination can be very painful. Laravel 5 makes it a breeze. For using it, first you have to make a change in your controller code where you calling data from the database:...after that you can use this code:That will make you use simple Laravel 5 beauty.Pagination Laravel 5.6.26,

  for the pagination  the controller are :  Controller code  (https://laravel.com/docs/5.6/pagination#basic-usage)Front end into blade (view) (https://laravel.com/docs/5.6/pagination#displaying-pagination-results)Use the array name (items) in the render() or links() method NOT the array item. It worked for me.Hi there is my code for pagination:

Use in view:

@include('pagination.default', ['paginator' => $users])Views/pagination/default.blade.php

laravel 5.2 How to get route parameter in blade?

msonowal

[laravel 5.2 How to get route parameter in blade?](https://stackoverflow.com/questions/39011648/laravel-5-2-how-to-get-route-parameter-in-blade)

this is my url

http://project.dev/blogs/image-with-article

so, here I need the parameter image-with-article

in my blade to display which is a parameter named slug here is in my routes file I need the slug paramter in blade.

2016-08-18 06:51:50Z

this is my url

http://project.dev/blogs/image-with-article

so, here I need the parameter image-with-article

in my blade to display which is a parameter named slug here is in my routes file I need the slug paramter in blade.I'm not sure what you mean. If you're trying to construct the route in a Blade template, useIf you're trying to access the given parameter, I would suggest passing it from the controller:And if you really need to access the parameter from the view without first sending it from the controller... you really shouldn't, but you can use the facade:If you want to get the parameters without using the controller method

Response::json() - Laravel 5.1

senty

[Response::json() - Laravel 5.1](https://stackoverflow.com/questions/31865493/responsejson-laravel-5-1)

I am trying to return Response::json('data', $request); however, I am getting an error:Where is the Response::json() is located? What am I doing wrong?

2015-08-06 20:46:00Z

I am trying to return Response::json('data', $request); however, I am getting an error:Where is the Response::json() is located? What am I doing wrong?use the helper function in laravel 5.1 instead:This will create an instance of \Illuminate\Routing\ResponseFactory. See the phpDocs for possible parameters below:After enough googling I found the answer from controller you need only a backslash like return \Response::json(['success' => 'hi, atiq']); . Or you can just return the array return array('success' => 'hi, atiq'); which will be rendered as json  in Laravel version 5.2 .You need to add use Response; facade in header at your file.Only then you can successfully retrieve your data with From a controller you can also return an Object/Array and it will be sent as a JSON response (including the correct HTTP headers).although Response::json() is not getting popular of recent, that does not stop you and Me from using it.

In fact you don't need any facade to use it,instead of:Use this:with the slash, you are sure good to go.However, the previous answer could still be confusing for some programmers. Most especially beginners who are most probably using an older book or tutorial.

Or perhaps you still feel the facade is needed. Sure you can use it.

Me for one I still love to use the facade, this is because some times while building my api I forget to use the '\' before the Response.if you are like me,

simply add above your class ...extends contoller.

this should do.with this you can now use:instead of:

Laravel 5 : Use different database for testing and local

James Okpe George

[Laravel 5 : Use different database for testing and local](https://stackoverflow.com/questions/35227226/laravel-5-use-different-database-for-testing-and-local)

How does one change database for development and testing on local system without editing the .env file each time?I have found it quite inconvenient to practice TDD because of this.Is it possible for a Laravel application to differentiate between normal development and testing so that it can choose the appropriate database?

2016-02-05 15:02:29Z

How does one change database for development and testing on local system without editing the .env file each time?I have found it quite inconvenient to practice TDD because of this.Is it possible for a Laravel application to differentiate between normal development and testing so that it can choose the appropriate database?Edit the config\database.php file and add a testing-array into the connections array:Then add the necessary variables to your .env-file.Open your phpunit.xml-file and add the following within your <php>-tag:<env name="DB_CONNECTION" value="testing"/>Now PHPUnit will run with the tests on the database you defined in the testing-array.For Laravel 5.5, the proper way to do this is create a testing environment file called .env.testing.  Here, you can define your testing environment, including the database you want to use for testing...Then run this command...This will configure the cache to the .env.testing file parameters.Here is a link to the documentation.If your testing database uses the same configuration but only it's name is different, you could only change the selected database name by addingto the file phpunit.xml in the <php> nodeif you need a specific database for one of your unit tests, add this code at the start of your unit testYou can use a different .env file for each type of test. You can modify your tests/functional.suite.yml and  tests/unit.suite.yml something like this:And this:Or you can simply modify your phpunit.xml and add environment vars like @Tijmen did above.

Laravel 4/5 search form like

erm_durr

[Laravel 4/5 search form like](https://stackoverflow.com/questions/18283714/laravel-4-5-search-form-like)

I have a search form and functions, all done. Just to ask, is it possible to do it in Eloquent a query like this:To display some possible matching names. My current controller function:And my view:Thanks in advance.

2013-08-16 23:56:36Z

I have a search form and functions, all done. Just to ask, is it possible to do it in Eloquent a query like this:To display some possible matching names. My current controller function:And my view:Thanks in advance.Hmmm, yes, just set like as your comparison operator, and send the string with %'s. Something like this:If you need to frequently use LIKE, you can simplify the problem a bit. A custom method like () can be created in  the model that inherits the Eloquent:So then you can use this method in such way:With quote of string:Try the above

Laravel pluck fields from relations

Alan

[Laravel pluck fields from relations](https://stackoverflow.com/questions/40635146/laravel-pluck-fields-from-relations)

I have a Seller object which has a related User. I need to fill a select from LaravelCollective so I need to make something like this:The problem is that I cannot take fields from relationships (user.first_name). How can I do it?UPDATEI want to avoid doing this...

2016-11-16 14:51:14Z

I have a Seller object which has a related User. I need to fill a select from LaravelCollective so I need to make something like this:The problem is that I cannot take fields from relationships (user.first_name). How can I do it?UPDATEI want to avoid doing this...You can use Laravel's pluck method as:You can achieve it by using join() & pluck() like this:This would give an array like this:Hope this helps!Another way to do it is to define what columns you need inside the relationship. It's good if you always need just these columns on the given relationship. Example: 

How to make a REST API first web application in Laravel

Martin Taleski

[How to make a REST API first web application in Laravel](https://stackoverflow.com/questions/23115291/how-to-make-a-rest-api-first-web-application-in-laravel)

I want to make an API first application in Laravel. I don't know what is the best approach to do this, I will explain what I am trying to do, but please feel free to give answers how to do this in a different way.I don't want all my frontend to be written in javascript and parse the JSON output of the API with angular.js or something similar. I want my Laravel application to produce the HTML views. I am trying to go down the road of having two controllers one on for the API and one for the web. For the show User action my routes.php looks like this:So /user will take me to WebUserController and /api/user will take me to the UserController. Now I want to put all my logic in the API UserController, and call its actions from the WebUserController. Here is the code for both of them:In the WebUserController I am able to get the json content of the response with getData(), but I am not able to get the headers and status code (they are protected properties of Illuminate\Http\JsonResponse).I think that my approach might not be the best, so I am open to suggestions how to make this app.EDIT: The question how to get the headers and status of the response has been answered by Drew Lewis, but I still think that there might be a better way how to design this

2014-04-16 16:39:47Z

I want to make an API first application in Laravel. I don't know what is the best approach to do this, I will explain what I am trying to do, but please feel free to give answers how to do this in a different way.I don't want all my frontend to be written in javascript and parse the JSON output of the API with angular.js or something similar. I want my Laravel application to produce the HTML views. I am trying to go down the road of having two controllers one on for the API and one for the web. For the show User action my routes.php looks like this:So /user will take me to WebUserController and /api/user will take me to the UserController. Now I want to put all my logic in the API UserController, and call its actions from the WebUserController. Here is the code for both of them:In the WebUserController I am able to get the json content of the response with getData(), but I am not able to get the headers and status code (they are protected properties of Illuminate\Http\JsonResponse).I think that my approach might not be the best, so I am open to suggestions how to make this app.EDIT: The question how to get the headers and status of the response has been answered by Drew Lewis, but I still think that there might be a better way how to design thisYou should utilize the Repository / Gateway design pattern: please see the answers here.For example, when dealing with the User model, first create a User Repository. The only responsibility of the user repository is to communicate with the database (performing CRUD operations). This User Repository extends a common base repository and implements an interface containing all methods you require:Then, create a service provider, which binds your user repository interface to your eloquent user repository. Whenever you require the user repository (by resolving it through the IoC container or injecting the dependency in the constructor), Laravel automatically gives you an instance of the Eloquent user repository you just created. This is so that, if you change ORMs to something other than eloquent, you can simply change this service provider and no other changes to your codebase are required:Next, create a User Gateway, who's purpose is to talk to any number of repositories and perform any business logic of your application:Finally, create your User web controller. This controller talks to your User Gateway:By structuring the design of your application in this way, you get several benefits: you achieve a very clear separation of concerns, since your application will be adhering to the Single Responsibility Principle (by separating your business logic from your database logic) . This enables you to perform unit and integration testing in a much easier manner, makes your controllers as slim as possible, as well as allowing you to easily swap out Eloquent for any other database if you desire in the future.For example, if changing from Eloquent to Mongo, the only things you need to change are the service provider binding as well as creating a MongoUserRepository which implements the UserRepository interface. This is because the repository is the only thing talking to your database - it has no knowledge of anything else. Therefore, the new MongoUserRepository might look something like:And the service provider will now bind the UserRepository interface to the new MongoUserRepository:Throughout all your gateways you have been referencing the UserRepository, so by making this change you're essentially telling Laravel to use the new MongoUserRepository instead of the older Eloquent one. No other changes are required.You should be use Repository for this design.Example -Checkout Laravel's RESTful controllers:http://laravel.com/docs/controllers#restful-controllersTheir docs do a pretty good job.But even better is this tutorial:http://code.tutsplus.com/tutorials/laravel-4-a-start-at-a-restful-api-updated--net-29785This is a video by Jeffrey Way he is one of the better Laravel developers. In this tutorial he is connecting a BackboneJS application to a RESTful service that he sets up in Laravel. It doesn't get any better then this. I can write you a lot of boilerplate, but just learn it by watching a nice video and having a coffee. ;)https://www.youtube.com/watch?v=uykzCfu1RiQI have a response to the problem you are having with the Response.

You can get the headers, status code and data from the Response.$response->headers is a Symfony\Component\HttpFoundation\ResponseHeaderBag which inherits from Symfony\Component\HttpFoundation\HeaderBagI would also recommend using a repository.

Attempting to call one controller from another would be falling into a pattern called HMVC (Hierarchical model–view–controller).

This means that your entire application relies on lower modules.

In this case, your API would serve as a repository for your data (which isn't the worst thing in the world at first).However, when you then modify the structure of how data is returned in your API, everything else relying on it would have to know how to respond.

Say you wanted to have authorization checks to see if a logged in user should be able to see the details of a returned user and there was an error.In the API, you would return a Response object with a 403 forbidden code and some meta data.

Your HTML controller would have to know how to handle this.Contrast this to a repository which could throw an exception.And your API controller would look more like this:Your HTML controller would then look like this:This gives you very reusable code and let's you change your controller implementations independently without worry of changing the other's behavior.

I wrote more on how to implement the repository pattern in this post: you can ignore the interface and skip right to the implementations if you would like.

How does Reflection in Laravel work?

Krystian Polska

[How does Reflection in Laravel work?](https://stackoverflow.com/questions/47200527/how-does-reflection-in-laravel-work)

How does reflection in Laravel actually work?I tried to debug it to see how Laravel uses reflection in a controller's constructor or methods to resolve their dependencies and sub-dependencies and then and give it back to us.But I found it hard, and it's very complicated to see and to even understand 50% of. Jumping from class to class, I can't really see it. I tried a few times by debugging it with low results of understanding.I am very impressed by this and by reflection, and the way Laravel uses it makes my heart burn—it's just beautiful. And I wish to fully understand that—the whole process—in general, and step by step.Beginning from hitting the route to finally having, let's say, dd($x), where $x is from a method argument and is a TestClass that has another dependency of TestClass2 that should be constructed through: $x = new TestClass(new TestClass2());I think those are beautiful mechanics and architecture, and understanding this is something I want so badly.So again, my question is: how does reflection in Laravel actually work?It's not about dd guys... Let's say without dd. Just as I said earlier - when we have this object instantiated from the class method. It's not about dumping it, it's just about having it from method injection by reflection.The dd was only an example. It can even be die(var_dump()); and it will work

2017-11-09 11:20:01Z

How does reflection in Laravel actually work?I tried to debug it to see how Laravel uses reflection in a controller's constructor or methods to resolve their dependencies and sub-dependencies and then and give it back to us.But I found it hard, and it's very complicated to see and to even understand 50% of. Jumping from class to class, I can't really see it. I tried a few times by debugging it with low results of understanding.I am very impressed by this and by reflection, and the way Laravel uses it makes my heart burn—it's just beautiful. And I wish to fully understand that—the whole process—in general, and step by step.Beginning from hitting the route to finally having, let's say, dd($x), where $x is from a method argument and is a TestClass that has another dependency of TestClass2 that should be constructed through: $x = new TestClass(new TestClass2());I think those are beautiful mechanics and architecture, and understanding this is something I want so badly.So again, my question is: how does reflection in Laravel actually work?It's not about dd guys... Let's say without dd. Just as I said earlier - when we have this object instantiated from the class method. It's not about dumping it, it's just about having it from method injection by reflection.The dd was only an example. It can even be die(var_dump()); and it will workLaravel uses PHP's reflection API for several components. Of these, the inverson-of-control (IoC) dependency injection container and controller method injection are most visible to developers.To more clearly illustrate the use of reflection, here's a dramatically simplified version of the routine Laravel's IoC container class uses to build up an object's dependencies through constructor injection:As we can see, the concept isn't too difficult to understand. The container uses PHP's ReflectionClass to find the names of the classes in an object's constructor, and then loops through each of these names recursively to create instances of each object in the dependency tree. With these instances, build() finally instantiates the original class and passes the dependencies as arguments to the constructor.Controller method injection uses the same container functionality shown above to resolve instances of dependencies declared as method parameters, but there's a bit of extra logic needed to separate class dependencies from route parameters:Again, this adaptation is slimmed-down to highlight the role reflection plays and relies on our build() function shown previously. The ControllerDispatcher class uses the getParameters() method of PHP's ReflectionMethod to determine which parameters a controller method expects, and then loops through these to find parameters that represent dependencies that it can resolve from the container. Then, it splices each dependency it finds back into the array of route parameters that it passes back to the controller method defined for the route. See RouteDependencyResolverTrait for details.If we ignore the application bootstrapping process, this dependency injection cascade typically starts for a request when Laravel maps a request to a route, and then determines which controller to pass the request to. Laravel first resolves an instance of the controller from the container, which builds out any constructor-injected dependencies. Then, Laravel finds the appropriate controller method and resolves any more dependencies for the arguments as needed.As shown here, Laravel uses relatively simple techniques to implement these tools using reflection. However, unlike the examples shown in this answer, the framework adds a lot of additional code to make them as robust and flexible as they are today.

change password user laravel 5.3

ardi gunawan

[change password user laravel 5.3](https://stackoverflow.com/questions/39586104/change-password-user-laravel-5-3)

I want to create form with 3 field (old_password, new_password, confirm_password) with laravel 5.Viewold password : 

{!! Form::password('old_password',['class' => 'form-control']) !!}New Password : {!! Form::password('password',['class' => 'form-control']) !!}Confirm New Password : {!! Form::password('verify_password',['class' => 'form-control']) !!}Controller when user registerI'm new in laravel, i've read some similar problem to change password in stackoverflow but it didn't help me.How should I write code in my controller for change password user?.

Thanks in Advance.

2016-09-20 05:09:19Z

I want to create form with 3 field (old_password, new_password, confirm_password) with laravel 5.Viewold password : 

{!! Form::password('old_password',['class' => 'form-control']) !!}New Password : {!! Form::password('password',['class' => 'form-control']) !!}Confirm New Password : {!! Form::password('verify_password',['class' => 'form-control']) !!}Controller when user registerI'm new in laravel, i've read some similar problem to change password in stackoverflow but it didn't help me.How should I write code in my controller for change password user?.

Thanks in Advance.This is change password formCreate rulesUser controller method to changes passworduse Validator;I am explain here another method to change user password

changepassword.blade.phpThis is route in web.php Controller Methodi have follow that link :- https://www.5balloons.info/setting-up-change-password-with-laravel-authentication/Laravel 6 Check Old Password and Updating a New PasswordThis is how I do this with Laravel 5.8:ViewConfirm password must be something like this:Because Laravel provides out the box a field confirmed rule. Create a form request and put this inside the rules part:Let's use artisan to generate a rule that verifies if old_password is the real current password:And put this inside the passes method of rule generated:Do not forget to import Hash:ControllerAll you need to do in your controller is this:And tada :) Hope I help.changePassword.blade.phpController Post Function

Laravel default mail not working

Sainath Krishnan

[Laravel default mail not working](https://stackoverflow.com/questions/22192133/laravel-default-mail-not-working)

Im attempting to send a user activation email upon registration. I have a simple laravel site with registration and authentication. Upon registration, there are no errors, and the data is stored correctly, however the email never actually gets sent. Tried a few different examples, but I have the same problem.This is my mail.php config file -And this is the logic for handling the mailer - (This is in UsersController)

2014-03-05 08:17:53Z

Im attempting to send a user activation email upon registration. I have a simple laravel site with registration and authentication. Upon registration, there are no errors, and the data is stored correctly, however the email never actually gets sent. Tried a few different examples, but I have the same problem.This is my mail.php config file -And this is the logic for handling the mailer - (This is in UsersController)Okay, I'd give Yousef an ''Up One''

, but my reputation is not high enough (seems broken). I had EXACTLY the same issue with my ISP in connecting to their smtp server. The only way I could FINALLY get an email through using laravel was to set the 'encryption' value to nothing (ie just as in the post above). Every other combination of port-change, account-change, etc. resulted in a laravel exception. I tried using my gmail account and credentials with no luck.The only combination of settings that finally worked was to useExpanding on the answers above as they weren't working for me.The port you define has to correlate with the right type of encryption. As it turns out, ssl and tls are not equivalent and correlate to different ports.

The default encryption setting in laravel is set on tls (port 587), but if you're using port 465, you need to change it to ssl.Google's smtp.gmail.com server is a good example of this:ORFurthermore, port 587 doesn't mandate the use of encryption (more on that here). If you find that setting 'encryption' => '' works for you, it should raise a red flag as it may mean the smtp server you're using is not encrypting your emails.

In this case, you should find alternative means of sending your emails.try removing tls encryption by setting it toi had a similar issue, and the tls was it.If you are using this on local machine using Xampp. Please disable all the encryption application which are running at the back end. I had experienced the same issue and it was solved when i disabled PGP encryption software. The encryption software doesn't allow to pass token to the email.I had this problem but I set configuration mail in .env file and I used this:

Templating in Laravel

coryj

[Templating in Laravel](https://stackoverflow.com/questions/12524712/templating-in-laravel)

I'm trying to get my default template working with Laravel. I'm coming from Codeigniter and Phil Sturgeon's template system so I'm trying to do it in a similar way. Can anyone help me with what I'm missing/doing wrong? Thanks!

2012-09-21 05:26:15Z

I'm trying to get my default template working with Laravel. I'm coming from Codeigniter and Phil Sturgeon's template system so I'm trying to do it in a similar way. Can anyone help me with what I'm missing/doing wrong? Thanks!

You are mixing two different layout approaches of Laravel.

This way you are rendering the layout view, include the home view and try to include inside again the layout.My personal preference is the controller approach.The controller and the layouts can remain the same.Note: As a shortcut you could nest the content instead of View::make, that automaically renders it when you echo it out in the layout.In home.blade.php remove the @layout function.Edit (example):controllers/home.phpviews/layouts/default.blade.php

views/home.blade.phpPartials are included in the content.

If you want this approach you have a few problems there. First, you are including new content after the layout. Not sure if intentional, but the @layout function itself is basicly just an @include restricted to be at the very beginning of the view. So if your layout is a closed html, any include after that will be appended after your html layout.Your content should use sections here with the @section function and @yield it in your layout. The header and footer could be included in the layout with @include or if you want to define it in the content view then put those in a @section too, like below. If you define it that way if a section doesn't exist nothing gets yielded.controllers/home.phpviews/layouts/default.blade.php

views/home.blade.php

The answer given above explains how templating is done in Laravel, however to gain additional benefits like managing themes organised into a theme directory with ability to switch between themes and having partials and theme resources all together sounds like almost something similar to Phil Sturgeon Template Library for CI. You may want to check the Theme bundle for Laravel. Here is the link:http://raftalks.github.io/Laravel_Theme_Bundle/

How to Format Laravel Blade Codes in Visual Studio Code?

coolsaint

[How to Format Laravel Blade Codes in Visual Studio Code?](https://stackoverflow.com/questions/46268211/how-to-format-laravel-blade-codes-in-visual-studio-code)

I have installed some Visual Studio Code extensions to handle Laravel Blade Codes likelaravel-blade [ https://marketplace.visualstudio.com/items?itemName=KTamas.laravel-blade ]Laravel Blade Snippets [ https://marketplace.visualstudio.com/items?itemName=onecentlin.laravel-blade ]But they are not helping me to format Laravel Blade Codes [blade.php files]. I mean they are not auto indenting the codes as I expected. But I have seen blade codes online which are well indented in visual studio Code IDE.Example : https://medium.com/@ardanirohman/laravel-%EF%B8%8F-visual-studio-code-debug-environment-65440274d3b0Is their any specific configuration or technique which I can use to make these extensions work or there is some other way? Thanks in advance

2017-09-17 19:44:57Z

I have installed some Visual Studio Code extensions to handle Laravel Blade Codes likelaravel-blade [ https://marketplace.visualstudio.com/items?itemName=KTamas.laravel-blade ]Laravel Blade Snippets [ https://marketplace.visualstudio.com/items?itemName=onecentlin.laravel-blade ]But they are not helping me to format Laravel Blade Codes [blade.php files]. I mean they are not auto indenting the codes as I expected. But I have seen blade codes online which are well indented in visual studio Code IDE.Example : https://medium.com/@ardanirohman/laravel-%EF%B8%8F-visual-studio-code-debug-environment-65440274d3b0Is their any specific configuration or technique which I can use to make these extensions work or there is some other way? Thanks in advanceIt'll associate .blade.php and .tpl file extensions for html type Save it and your are good to go. Happy formatting :)Update: There are still some issues in formatting html with blade code, the formatter tend to bring blade codes in a single line while executing format command. However, if your codes grow that's won't be a problem. Moreover, you can easily manage those by putting a line comment in between your blade blocks. And commenting in code is always a good thing.Update: Seems updated version adds an option to enable blade formatting in the user settings. To use that, 

 3. In "User settings" > "Extensions" > "Blade Configaration" check the option Enable format blade file. That's it.Update your VSCode. Go to Settings>Extensions and Enable Blade Format checkbox.

Use Shortcut for Window: Shift+Alt+F:For me, this extension works perfect for auto indentation with the following settings:Then Enable format blade file (Follow Image).Then Restart Visual Studio Code.Now Use Shift+Alt+F To format. Now OK.

First install this extension, https://marketplace.visualstudio.com/items?itemName=onecentlin.laravel-bladeOpen settings.json.

Add this lines.

Laravel 4 - Connect to other database

TheNiceGuy

[Laravel 4 - Connect to other database](https://stackoverflow.com/questions/17410049/laravel-4-connect-to-other-database)

I want to connect to another database sometimes.I created a config.php with the database connection data.But how can i tell laravel to connect to this database insted of using the config/database.php?For example when using the Schema class.Since no one seems to understand what i want.I DON'T want to use the config/database.php, i want to use a different config file on a different location.

2013-07-01 17:16:02Z

I want to connect to another database sometimes.I created a config.php with the database connection data.But how can i tell laravel to connect to this database insted of using the config/database.php?For example when using the Schema class.Since no one seems to understand what i want.I DON'T want to use the config/database.php, i want to use a different config file on a different location.It sounds like you figured this out. Here's how I'd accomplish it anyway for other people coming in, or in case something useful is here for you.First, Add a second connection in app/config/database.php. Note: That file path may change depending on your environment.Second, in your code, you can use (as mentioned) the 2nd connection where you would like:Schema::connection('mysql2')->create('users', function($table) {})There's more documentation on this - see Accessing Connections.Eloquent ORM

You can define the variable for "connection" in an eloquent class to set which connection is used. That's noted in the Basic Usage section.See that variable on here on Github and the method which you can set to set the connection dynamically here.Edit

The OP has made it clear that they do not wish to use the config/database.php file for config.However without explaining further, I can't comment. I'm happy to help - sounds like it would be useful to know why the config/database.php file can't/shouldn't be used, as this can help us ascertain the problem and create a useful solution. Remember that Laravel 4 is actually a collection of components, and you can use these components solo.https://github.com/illuminate/databaseThere is an example here that shows off how interacting with the Capsule class works:This is a bunch of bootstrapping that you'll need to run, so tuck it away somewhere in a function or method.But, its absolutely possible.I believe you want to implement some kind of logical sharding where databases would be dynamically created.In such scenario in laravel you can dynamically add a database config, like belowNow to connect via eloquentIncase of Query Builder you can douse $DB->select() for querying now.Hope this would help devs looking for a possible solution for this questionThere is a simpler solution. If you are using Larave 4 there is an option that worked for me. Recently they added $table variable that you can specify in your model. Refer to this link. If you are using MySQL, you can do the following:If you are using SQL Server, you can do this:My Config file had DB1 specified but I created a model which wants to access DB2 in the same MySQL host. So this was a quick and dirty way to accomplish this. Now I don't fully leverage Eloquent ORM all the time so this "hack" may not work with Many to Many or one to Many Eloquent methods.One another idea I had but I didn't actually try was creating a stored procedure (routine) in DB1 and inside of that routine I can access DB2 tables by querying link this:To use a config file in another location, say src/config:Where dbInfo is a simple php file in your app's src/config directory returning an array containing the element connections which is an array of database properties.You can tell Laravel to use an external config file using:Edit bootstrap/start.php file and add your machine name (open terminal: hostname).Add your machine to $env,

How can I query raw via Eloquent?

Chilion

[How can I query raw via Eloquent?](https://stackoverflow.com/questions/22925451/how-can-i-query-raw-via-eloquent)

I am trying to do a query in my Laravel app and I want to use a normal structure for my query. This class either does use Eloquent so I need to find something to do a query totally raw.Might be something like Model::query($query);. Only that doesn't work.

2014-04-08 00:25:45Z

I am trying to do a query in my Laravel app and I want to use a normal structure for my query. This class either does use Eloquent so I need to find something to do a query totally raw.Might be something like Model::query($query);. Only that doesn't work.use DB::statement('your raw query here'). Hope this helps.You may try this:An Example:Also, you may use something like this (Using Query Builder):Also, you may try something like this  (Using Query Builder):Check more about Raw-Expressions on Laravel website.You can use hydrate() function to convert your array to the Eloquent models, which Laravel itself internally uses to convert the query results to the models. It's not mentioned in the docs as far as I know.Below code is equviolent to $userModels = User::where('id', '>', $userId)->get();:hydrate() function is defined in \Illuminate\Database\Eloquent\Builder as:I don't think  you can by default. I've extended Eloquent and added the following method.You can then do something like this:Old question, already answered, I know.However, nobody seems to mention the Expression class.Granted, this might not fix your problem because your question leaves it ambiguous as to where in the SQL the Raw condition needs to be included (is it in the SELECT statement or in the WHERE statement?).  However, this piece of information you might find useful regardless.Include the following class in your Model file:Then inside the Model class define a new variableAnd add a scope:Then from your controller or logic-file, you simply call:Happy days.(Works in Laravel framework 5.5)You could shorten your result handling by writing

Laravel mail pretend prints nothing

totymedli

[Laravel mail pretend prints nothing](https://stackoverflow.com/questions/18532353/laravel-mail-pretend-prints-nothing)

I set 'pretend' => true, in the mail.php, created this new.php view:Then in my controller I use this code to "send" the mail:The output in the log file is only this:I tried with a full HTML view, also with another view that contains only strings, no variables, but the output is the same.Is this the way how this should work? Shouldn't it print the whole message, title, etc? Is there a problem with the code or this is the proper output?

2013-08-30 11:55:42Z

I set 'pretend' => true, in the mail.php, created this new.php view:Then in my controller I use this code to "send" the mail:The output in the log file is only this:I tried with a full HTML view, also with another view that contains only strings, no variables, but the output is the same.Is this the way how this should work? Shouldn't it print the whole message, title, etc? Is there a problem with the code or this is the proper output?If you set 'pretend' => true in app/config/mail.php then no mail is ever sent, you get just a message in the log, like this:However, if you leave 'pretend' => false and instead use the log driver ('driver' => 'log', available since Laravel 4.2), then instead of sending the mail, you'll get the whole mail content written into the log:If you actually want to view the contents of the message (for instance when testing user account verification or password reset emails) in the /storage/logs logfile; You can modify your local copy of vendor/laravel/framework/src/Illuminate/Mail/Mailer.php and in the logMessages function modify it to look likeThen you will see the body of the message in the logs.This is the normal behaviour of pretend in the Laravel Mailer system. It will not render your message anywhere, not even in the log, it will just log that a mail message was pretended to be sent. Look at the related source code:I include this in my send callbacks:Alternately, you can pass the views render into another view to see the html rendered in your browser.I created a package to also include subject and body for laravel 4.2.The package can be found here: https://packagist.org/packages/peercode/mailJust enable the package as descripted here: https://github.com/peercode-eric/laravel-maillog

and the log will contain the additional information.

Artisan, creating tables in database

Streetlamp

[Artisan, creating tables in database](https://stackoverflow.com/questions/30447385/artisan-creating-tables-in-database)

I am trying to create mysql tables in Laravel 5. I created a file in /project/database/migrations called users.php:I then tried running these commands in the project-folder:None of them return any output and no tables are created. The database to be populated exists.

2015-05-25 23:45:05Z

I am trying to create mysql tables in Laravel 5. I created a file in /project/database/migrations called users.php:I then tried running these commands in the project-folder:None of them return any output and no tables are created. The database to be populated exists.Migration files must match the pattern *_*.php, or else they won't be found. Since users.php does not match this pattern (it has no underscore), this file will not be found by the migrator.Ideally, you should be creating your migration files using artisan:This will create the file with the appropriate name, which you can then edit to flesh out your migration. The name will also include the timestamp, to help the migrator determine the order of migrations.You can also use the --create or --table switches to add a little bit more boilerplate to help get you started:The documentation on migrations can be found here.In order to give a value in the table, we need to give a command:and after then this command line

How to autoload Guzzle in Laravel 4?

Iain

[How to autoload Guzzle in Laravel 4?](https://stackoverflow.com/questions/22725266/how-to-autoload-guzzle-in-laravel-4)

How can I autoload Guzzle in Laravel 4?I am encountering the following error when I try to create a new GuzzleHttp/Client:I have the following set up in my composer.json autoload section:

2014-03-29 00:04:53Z

How can I autoload Guzzle in Laravel 4?I am encountering the following error when I try to create a new GuzzleHttp/Client:I have the following set up in my composer.json autoload section:You don't need to add Guzzle to your composer.json, it's already autoloaded by it's own composer.json.Create a client:Get results:Install it:Create a client setting the base URL:Get your response:And display it:If you still don't get it running, check the file vendor/composer/autoload_psr4.php, Guzzle must appear in it. If it doesn't, remove your vendor folder and install it again:

Can I use Laravel's database layer standalone?

sjosen

[Can I use Laravel's database layer standalone?](https://stackoverflow.com/questions/26083175/can-i-use-laravels-database-layer-standalone)

For some time now I have been looking towards using a php framework for my work. I've been writing procedural style until recently and is still trying to find my way around the oop world/style.

I figured that a php framework would help me write better code and I'm pretty sure I'll lean towards the Laravel project in a near future. Right now I'm in need of a database layer that I can use in my existing code. I use mysqli with prepared statements right now, as it was easy for me to implement (using MySQL before).I've been looking at http://medoo.in as an "easy" way to use a pdo wrapper/class but the lack of activity on the support page, and the fact that I'm working on using Laravel in the future, made me wonder if I could use the Laravel database layer now for my existing code. Could this be done and would it make sense or am I misunderstanding and mixing concepts of code styling?

2014-09-28 08:45:34Z

For some time now I have been looking towards using a php framework for my work. I've been writing procedural style until recently and is still trying to find my way around the oop world/style.

I figured that a php framework would help me write better code and I'm pretty sure I'll lean towards the Laravel project in a near future. Right now I'm in need of a database layer that I can use in my existing code. I use mysqli with prepared statements right now, as it was easy for me to implement (using MySQL before).I've been looking at http://medoo.in as an "easy" way to use a pdo wrapper/class but the lack of activity on the support page, and the fact that I'm working on using Laravel in the future, made me wonder if I could use the Laravel database layer now for my existing code. Could this be done and would it make sense or am I misunderstanding and mixing concepts of code styling?IMO it's absolutely valid to transition to an OOP approach step by step.To your question:Yes, you can use Eloquent standalone.Here is the packagist site: https://packagist.org/packages/illuminate/database

Add "illuminate/database": "5.0.*@dev" to your composer.json and run composer update.

Now you'll need to bootstrap Eloquent. (https://github.com/illuminate/database)The following is copied from the repo's readme:Usage InstructionsFirst, create a new "Capsule" manager instance. Capsule aims to make configuring the library for usage outside of the Laravel framework as easy as possible.Once the Capsule instance has been registered. You may use it like so:Using The Query BuilderOther core methods may be accessed directly from the Capsule in the same manner as from the DB facade:Using The Schema BuilderUsing The Eloquent ORMFor further documentation on using the various database facilities this library provides, consult the Laravel framework documentation.Bastian's answer is pretty well. But there is one more thing. It can't work without Event Lib. To install it;You are good to go

Laravel Creating Dynamic Routes to controllers from Mysql database

user3150060

[Laravel Creating Dynamic Routes to controllers from Mysql database](https://stackoverflow.com/questions/23145245/laravel-creating-dynamic-routes-to-controllers-from-mysql-database)

I have the following table: group_pages in mysql database with page name route name :what I am trying to do is to create dynamic routes in my : routes.php ? Where if I go to for example: /about it will go to AboutController.php ( which will be created dynamically) is that possible? is it possible to create a dynamic controller file? I am trying to create dynamic pages routes that links to a controllerexample i want to generate this dynamically in my routes.php

2014-04-17 23:40:10Z

I have the following table: group_pages in mysql database with page name route name :what I am trying to do is to create dynamic routes in my : routes.php ? Where if I go to for example: /about it will go to AboutController.php ( which will be created dynamically) is that possible? is it possible to create a dynamic controller file? I am trying to create dynamic pages routes that links to a controllerexample i want to generate this dynamically in my routes.phpThis is not the right way to create dynamic pages instead, you should use a database and keep all pages in the database. For example:Then create Page Eloquent model:Then create  Controller for CRUD, you may use a resource controller or a normal controller, for example, normally a PageController:The views/page/index.blade.php view file:To show pages create a route like this:To access a page, you may require url/link like this:This is a rough idea, try to implement something like this.After spending 2 hours, digging through google and Laravel source, I came up with this solution, which I think works the best and looks the cleanest. No need for redirects and multiple inner requests.You add this route at the very bottom of routes files.

If no other routes are matched, this is executed. In the closure, you decide which controller and action to execute.

The best part is - all route parameters are passed to action, and method injection still works. The ControllerDispatcer line is from Laravel Route(r?) class.My example would handle 2 cases - first checks if user exists by that name, then checks if an article can be found by the slug.Laravel 5.2 (5.3 below)5.3 has changed how the controller gets dispatched.Heres my dynamic controller example for 5.3, 5.4Hope this helps!try We can make dynamic route by this wayGet Route value from DatabaseThen iterate the value to make dynamic routeYou can use GET|POST|PUT|PATCH|DELETE methods alsoThere is a component available, which you can use to store routes in a database. As an extra advantage, this component only loads the current active route, so it improves performance, since not all routes are loaded into the memory.https://github.com/douma/laravel-database-routesFollow the installation instructions provided in the readme. Storing routes in the databaseThe only thing needed here is injecting the RouteManager into for example a cli command. With addRoute can tell the RouteManager to store the route into the database. You can easily change this code and use your own repository of pages or other data to construct the routes. Run this cli command every 2-5 minutes or after a change in your data to make sure the routes are recent. Register the RouteMiddleware in App\Http\Kernel.php\Douma\Routes\Middleware\RouteMiddleware::classEmpty your web.phpIf you have defined any Laravel route, make sure to empty this file. Using routes from the databaseYou can use the route in blade: Or you can inject the RouteManager-interface anywhere you like to obtain the route:For more information see the readme. 

Has one through Laravel Eloquent

yayuj

[Has one through Laravel Eloquent](https://stackoverflow.com/questions/27466542/has-one-through-laravel-eloquent)

I have three tables garages, cars, securities.The securities are the ones that is keeping one car safe, you can have more than one security, but a single security can keep only one car safe. The garage is where the car is and the securities are as well.What I want is to list all the securities and know the name of the garage that he is. The problem is that securities doesn't have a column containing the id of the garage, only the id of the car that he is keeping safe, but car has the id of the garage.Laravel Eloquent has a method called hasManyThrough, but securities has one garage through cars only.Here is the tables:garages table:cars table:securities table:The output must to be:And I have the models:The code is to list the garages, but I want to make similar but to list the securities (just for you to have an idea of how the structure is).And just to make an emphasis again: I want to have the name of the garage related to the car that the security is keeping safe.Just to make it even easier to understand, if I do this:I will get only the garage_id from cars table as relations. What I really want is the name of the garage.

2014-12-14 05:07:31Z

I have three tables garages, cars, securities.The securities are the ones that is keeping one car safe, you can have more than one security, but a single security can keep only one car safe. The garage is where the car is and the securities are as well.What I want is to list all the securities and know the name of the garage that he is. The problem is that securities doesn't have a column containing the id of the garage, only the id of the car that he is keeping safe, but car has the id of the garage.Laravel Eloquent has a method called hasManyThrough, but securities has one garage through cars only.Here is the tables:garages table:cars table:securities table:The output must to be:And I have the models:The code is to list the garages, but I want to make similar but to list the securities (just for you to have an idea of how the structure is).And just to make an emphasis again: I want to have the name of the garage related to the car that the security is keeping safe.Just to make it even easier to understand, if I do this:I will get only the garage_id from cars table as relations. What I really want is the name of the garage.It looks like you are not relating objects correctly. Let's break that down:If a Garage Has Many Car then a Car Belongs To Garage, Lets proceed with this idea in mind.In Eloquent you can just go ahead and clap those relations in, it should work given the schema you posted above.And that should be it.EDIT: You can access all these relations from any model as long as there is a path you can draw from one model to another using a combination of these relations. Check this out for example:will retrieve first Security record and load Car relation on it, then it goes one more step and load all Garage relations on every Car object loaded under Security model.You can access them using this syntax:Furthermore, notice that the relationship objects are an instance of Collection so you have all the fancy methods such as ->each(), ->count(), ->map() available on them.I ran into a similar problem recently and was able to do something like this:This gives you the Securities has one garage relationship and you can do something like:This is relevant to your original inquiry.hasOneThrough will be available in Laravel 5.8https://github.com/laravel/framework/pull/26057/filesYou can use hasOneThrough, integrated on Laravel => 5.8.Dont use solutions likeBecause it are using eager loading, and you call to database on each iteration. These type of solution are not optimized.

Laravel 5 CSRF global token hidden field for all forms in a page

raphadko

[Laravel 5 CSRF global token hidden field for all forms in a page](https://stackoverflow.com/questions/28500525/laravel-5-csrf-global-token-hidden-field-for-all-forms-in-a-page)

I recently migrated to Laravel 5, and now CSRF check is on every post submission. I thought about removing it but I want to follow the best practices, so I'll keep it that way.On the other hand, I'm problems submitting ajax requests.. my page has multiple forms and some submissions are not even from forms, just plain ajax calls. My idea is to have one single hidden "token" input on the page and attach it to every submission. Are there any drawbacks on having that universal single token input?Also, how can I output the token? Would it be ok to just create a hidden input on the page footer?

2015-02-13 13:17:56Z

I recently migrated to Laravel 5, and now CSRF check is on every post submission. I thought about removing it but I want to follow the best practices, so I'll keep it that way.On the other hand, I'm problems submitting ajax requests.. my page has multiple forms and some submissions are not even from forms, just plain ajax calls. My idea is to have one single hidden "token" input on the page and attach it to every submission. Are there any drawbacks on having that universal single token input?Also, how can I output the token? Would it be ok to just create a hidden input on the page footer?I don't see any drawbacks. You can easily create a global token field in your layout file:Or if you use the form builder:In jQuery you could use something like this to attach the token to every request.There is a helper to add the form token inside forms. You can just useinside the forms. It will add the hidden input and the token.You can use something like this at the bottom of the page:This will append a hidden input to all your forms:And for all your AJAX requests:Here are some excerpts of how I got my CSRF working for all the different scenarios in my jQuery Mobile application that I recently upgraded to use Laravel 5:I added an encrypted csrf token in a variable that will be passed to my views in my main base controller:

app\Http\Controllers\MyController.phpThen, I added the meta tag in my main view header:

resources\views\partials\htmlHeader.blade.phpThen, I also added this jquery snippet as suggested in some forums:But, the key (for my setup at least) was the addition of the check for the XSRF-TOKEN cookie in my custom VerifyCsrfToken middleware:

app\Http\Middleware\VerifyCsrfToken.php:Before I added that, just about all of my AJAX POSTs (including form submissions and lazyloading listviews) were failing due to a TokenMismatchException.  EDIT:

On second thought, I'm not sure how much sense it makes to compare the session token with the one set in the cookie (which would have come from the session token in the first place right?).  That may have just been bypassing the security of it all.I think my main issue was with the jquery snippet above which was supposed to be adding the X-XSRF-TOKEN header to every ajax request.  That wasn't working for me in my in jQuery Mobile app (specifically, in my lazyloader plugin) until I added some options for the plugin itself.  I added a new default selector csrf (which would be meta[name="_token"] in this case) and a new default setting csrfHeaderKey (which would be X-XSRF-TOKEN in this case).  Basically, during initialization of the plugin, a new _headers property is initialized with the CSRF token if one is locatable by the csrf selector (default or user-defined).  Then, in the 3 different places where an ajax POST can be fired off (when resetting session variables or when lazyloading a listview) the headers option of $.ajax is set with whatever is in _headers.        Anyway, since the X-XSRF-TOKEN received on the server-side comes from the encrypted meta _token, I think the CSRF protection is now working as it should.    My app\Http\Middleware\VerifyCsrfToken.php now looks like this (which is essentially back to the default implementation provided by Laravel 5 - LOL):I think you can do something like this (not tested will update if I get a chance)you actually might want to store token in a variable that you reupdate as it expires. The benefit of appending it on submit is if you append elements via ajax I think it'll still work without having to add anything else.EDIT: Here's a great article on using Rails UJS with Laravel (which includes this auto CRSF token functionality): https://medium.com/@barryvdh/unobtrusive-javascript-with-jquery-ujs-and-laravel-e05f444d3439You need to pass along the header X-XSRF-TOKEN which contains an encrypted version of the csrf-token.There are two ways which this can be done that I am aware of. You can encrypt the token and pass it along to the view:Or you can grab the token from cookies using JavaScript (Angular makes this easy). In vanilla JS you might do something like this:In jQuery you might then do something like this for the ajax request:

Class 'App\Http\Controllers\Session' not found in Laravel 5.2 [duplicate]

AiD

[Class 'App\Http\Controllers\Session' not found in Laravel 5.2 [duplicate]](https://stackoverflow.com/questions/34419378/class-app-http-controllers-session-not-found-in-laravel-5-2)

Hi guys i'm using sessions in Laravel 5.2 

there is my Controller code :i try just to get a value from the session , and i got this error :How can i resolve it ?

2015-12-22 15:38:11Z

Hi guys i'm using sessions in Laravel 5.2 

there is my Controller code :i try just to get a value from the session , and i got this error :How can i resolve it ?From the error message:I see that Laravel is searching the Session class in the current namespace: App\Http\ControllersThe problem is you don't have aliased the class from the global namespace: Session is a Facade, and all the facades are in the global namespaceTo use the class from the global namespace, put:on top of your controller, after your namespace declarationAlternatively, you can call the class from the global namespace with:

Can I group multiple domains in a routing group in Laravel?

Andy Fleming

[Can I group multiple domains in a routing group in Laravel?](https://stackoverflow.com/questions/18603330/can-i-group-multiple-domains-in-a-routing-group-in-laravel)

Let's say I have the following:Is there any way to have multiple domains share a routing group? Something like:

2013-09-04 00:01:23Z

Let's say I have the following:Is there any way to have multiple domains share a routing group? Something like:Laravel does not seem to support this.I'm not sure why I didn't think of this sooner, but I guess one solution would be to just declare the routes in a separate function as pass it to both route groups.I'm not sure if there is any significant performance impact to this solution.Laravel 5.1Interested in this also! I'm trying to register a local development + production subdomain route, for the one controller action.i.e.I tried:But it failed.Not a huge issue, as DesignerGuy mentioned I can just pass in a function to both routes - but it would just be more elegant if they could be grouped :)check in laravel docs, if you main domain is myapp, in production is myapp.com and in local environment is myapp.dev try using a *You can pass on the domain name as well:Just in case you need to know with which domain name the controller is called.

Tested it with Laravel 5.6.Currently you cannot. I had the same 'problem'; my fix is to cycle through your subdomains with a foreach and register the routes.according to laravel document

in laravel 5.4+ you can use this way:see this link. http://laravel.com/docs/routing#sub-domain-routingor Use this package.https://github.com/jasonlewis/enhanced-routerIt help you can set where on group routing like this.

LAMP PHP Configuration

Arafath

[LAMP PHP Configuration](https://stackoverflow.com/questions/47493587/lamp-php-configuration)

OS : Ubuntu 17.10 

I have installed LAMP stack and Laravel, and when I tried composer install in my Laravel app, I got the following errors.I have rechecked the files, all extensions are enabled and they are located in 

/usr/lib/php/20160303 folder.

2017-11-26 06:21:29Z

OS : Ubuntu 17.10 

I have installed LAMP stack and Laravel, and when I tried composer install in my Laravel app, I got the following errors.I have rechecked the files, all extensions are enabled and they are located in 

/usr/lib/php/20160303 folder.Sometimes the problem is the php-xml extension.Try:If still facing the issue then tryTry following command : As the log speaks we need to install the extension dom. This is how we do it:If the log shows only one extension missing, than above command works. If there are other extension missing, you can add those extension in the same line like shown below:That’s it. Now you won’t have any issues in installing  composer. Enter composer install

laravel TokenMismatchException in ajax request

DolDurma

[laravel TokenMismatchException in ajax request](https://stackoverflow.com/questions/21627170/laravel-tokenmismatchexception-in-ajax-request)

i'm using resource group and use this filter to resolve TokenMismatchException problem:my route :now. i get error to Ajax requests such as this code:ERROR:i think i'm must be sent _token in $.post. but i can not get input tag with name attribute. iget this error:

2014-02-07 11:55:50Z

i'm using resource group and use this filter to resolve TokenMismatchException problem:my route :now. i get error to Ajax requests such as this code:ERROR:i think i'm must be sent _token in $.post. but i can not get input tag with name attribute. iget this error:There is a tip in the Laravel docs on how to do this.  This might not have been available at the time of the question, but I thought I would update it with a answer.http://laravel.com/docs/master/routing#csrf-x-csrf-tokenI have tested the meta tag method from the documentation and got it working.  Add the following meta tag into your global templateAdd this JavaScript that sets defaults for all ajax request in jQuery.  Preferably in a js file that is included across your app.This token can exist in the request header or the form.  This populates it into the request header of every ajax request.You have to insert a hidden input with the _token and later get that value as you do to get the other form fields in your ajax post.An another method,On your view you can set an object with the _token and later on your ajax call you can get the _token from the object like this:and include it on your ajax post.Just do simple thing as i have shown in following code,I hope this one is the easiest way to solve this problem without any hidden field and it works for me in laravel 5.4 version :)Hope it helps.You can as well add the url thats giving you the error inside the VerifyCsrfToken.php file in the Let's say your route is post. You can just add in like this Hope this helps others.and VerifyCsrfToken.php file add this function

Laravel routes.php getting big [closed]

Chris G.

[Laravel routes.php getting big [closed]](https://stackoverflow.com/questions/14904333/laravel-routes-php-getting-big)

As you continually add more and more routes to Routes.php it gets bigger and bigger. How do you organize them?

2013-02-15 22:20:47Z

As you continually add more and more routes to Routes.php it gets bigger and bigger. How do you organize them?I usually use Group routes (because controllers tend to have the same type of filtering needed if they are related) to organize them or if you wish to/can have a smaller routes file you might want to register your controllers and do the extra validation checks of the URL's parameters inside the controller itself.I created a directory /application/routes/ and added files in there. Each file is just a set of routes. Then in routes.php I added the following code to include them all:even after adopting all the best practices as mentioned in the other answers, 

Ie: using resource controller, route groups etc.You can simple 'include' the route files the old fashion way. as mentioned by Chris G in this comment. you can create simple directory structure and include the route files in the route.php file.In route.php file There is nothing wrong in it. This is how routes are included in the packages.http://laravel.com/docs/packages#package-routingActually routs should stay slim. Just move your code to controllers and use the routs to register and redirect to them. The convention is to store one controller per file so your code becomes automatically organized.Take a look at this The controller-action route can be registered like this: Very straight forward and comfortable. Update:You can also register all your controllers with this line for the whole application automatically:Or the controller with all actions:Alternatively you could just store the routes in a different files and then get those files using include:That gives a nice and clean way to sort handle when there's way too much code, also you could just mention And then structure your controllers accordingly:If you have to passin parameters to some function:You can reach those functions like this:Then you could just call the function by appending the parameters to the URL,               If you need some methods to be protected then append them without the action_ so that they can't be accessed by the public.Alternatively, you could switch to restful methods which is basically a way to respond to some input based on the type of query you get, for instance when you receive a "GET" request to the login page that means that the user needs to see the login screen, when you receive a "POST"request that would usually mean that the user is posting login data and accordingly you can respond which will help you cut down on the number of functions for more information on restful methods you can read this brilliant article by Ryan Tomayako at http://tomayko.com/writings/rest-to-my-wifeTo use restful methods you need to mention restful to true and then append the action keyword before the function's name.This way you can eliminate the need for another route to process and verify the users credentials!and if you don't want certain methods to be accessed using restful methods then just don't include the action keyword, (get,post,...) in the function name.Combining restful methods with smart routing is the most efficient way to keep your code clean and safe.

DomPDF: Image not readable or empty

David P. P.

[DomPDF: Image not readable or empty](https://stackoverflow.com/questions/25558449/dompdf-image-not-readable-or-empty)

For some reason, DomPDF won't render an image included in the html that is being parsed:However, the image is rendered on the page when it is returned as html:I've looked at these issues and have make sure that DOMPDF_ENABLE_REMOTE is set to true and verified file permissions:

dompdf image not real image not readable or empty

Image error in DOMPDF for ZF2Are there any other things that I should be checking for?

2014-08-28 21:37:52Z

For some reason, DomPDF won't render an image included in the html that is being parsed:However, the image is rendered on the page when it is returned as html:I've looked at these issues and have make sure that DOMPDF_ENABLE_REMOTE is set to true and verified file permissions:

dompdf image not real image not readable or empty

Image error in DOMPDF for ZF2Are there any other things that I should be checking for?Following helped me like charm, at least localy, and even with The solution is to change the image SRC to the absolute path on the server, like this:All of the following worked for me:$_SERVER["DOCUMENT_ROOT"] is C:/wamp/www/ZendSkeletonApplication/publicThanks to this: lost in codeOk

I had the same problem with image using :But if I add a . before /images, without changing anything in dompdf_config.custom.inc, it worksHope it helpsAs there was another answer that suggests enabling the remote option in module.config.php and I can't yet add comments, I thought it would be best to answer that this file does not exist in newer versions of DomPDF.If you need to include remotely stored images in a newer version you have to pass it as an option to the constructor:This fixed the issue I had.Now (May 2018) the correct way is :In path :change settings то true.None of the solutions here worked for me. Instead I just base64 encoded the image and then it worked. You can use this tool.I solve this problem by using external CSS's full path. This one worked on my linux ubuntu server :<link href="{{ public_path('css/style.css') }}" /><img src="{{ public_path('images/image.jpg') }}" />and work on image.For our use case we had to convert all the images on the page to base64 since the pdf should be usable offline. Our code lives inside a controller class but you can modify that to your needs.Here's the code:You can use base64 encoded image

How create package in Laravel 5?

Marty Aghajanyan

[How create package in Laravel 5?](https://stackoverflow.com/questions/27661322/how-create-package-in-laravel-5)

command is not available in laravel 5, but how now create package in laravel 5 ?

2014-12-26 19:52:36Z

command is not available in laravel 5, but how now create package in laravel 5 ?The laravel workbench has been renamed in laravel 5 to "Package Development" in the documentationhttp://laravel.com/docs/master/packagesNotice that there is no longer a workbench command and you need to create your own package structure, as the Laravel creator want to limit the dependency between created packages and the Laravel framework (#ref)UPDATE: Laravel 5 is now stable and the illuminate/workbench package can be used in a laravel 5 application as I suggested in this postShameless self-promotion, but I've written a post about this called "Creating Laravel 5 packages for dummies" that explains how to create the package, how to put it on GitHub & Packagist and how to push changes/new versions afterwards.If you're already familiar with creating packages in Laravel 4, the fastest solution I've found was to use this CLI tool.

Authenticate users from more than two tables in laravel 5 [duplicate]

RAUSHAN KUMAR

[Authenticate users from more than two tables in laravel 5 [duplicate]](https://stackoverflow.com/questions/46292391/authenticate-users-from-more-than-two-tables-in-laravel-5)

As I know Auth::attempt is used to authenticate users from users table,  but i want to authenticate another users from managers table and admin from admins table. I know there are laravel-multiauth plugin already exist. But can we create our own AuthServiceProvider for authenticating users from multiple tables..?

2017-09-19 05:21:22Z

As I know Auth::attempt is used to authenticate users from users table,  but i want to authenticate another users from managers table and admin from admins table. I know there are laravel-multiauth plugin already exist. But can we create our own AuthServiceProvider for authenticating users from multiple tables..?First create Admin Authenticatable in Illuminate\Foundation\Auth like Then create Admin Model by extending  Authenticatable Admin Model :-After that you need to modify config/auth.php like below 

Add in providers arrayand Add in guards array.Now to authenticate from user table And to authenticate from Admin tableYou could setup multiple authentication guards, with each one having a different provider. The providers define the table or model to be used.In config/auth.php you setup the providers as follows and you also setup corresponding guards for each of those providers:Then you can authenticate like this:Check out the docs here.Try my idea if you want to. I'm expecting that different table has different users. Because it won't work if you have the same user in other tables.Note: Your priority table here is users, then if the user doesn't exists in that table, it will try the managers table, then if still doesn't exists, it will check the admins table, otherwise (use else) return a message error.Other option:Other option is to use this package sarav/laravel-multiauth. You can follow this thread. How to use authentication for multiple tables in Laravel 5 for more information.More Reference:https://laracasts.com/discuss/channels/general-discussion/using-laravel-auth-for-multiple-tables?page=1Can anyone explain Laravel 5.2 Multi Auth with examplehttps://laracasts.com/discuss/channels/laravel/52-auth-multiple-tables?page=1Create a model for managers table and admins table. This model should extend Illuminate\Foundation\Auth\UserIn config/auth.php,Add to the providers array:Add to the guards array:Then. in LoginController (create one for manager using php artisan make:auth) use the trait Illuminate\Foundation\Auth\AuthenticatesUsers and 

override  guard and redirect properties.The manager model is authenticated and you can get the auuthenticated manager's object  Auth::guard('web_manager')->user();

Laravel: Access Model instance in Form Request when using Route/Model binding

Jonathon

[Laravel: Access Model instance in Form Request when using Route/Model binding](https://stackoverflow.com/questions/37347415/laravel-access-model-instance-in-form-request-when-using-route-model-binding)

I have some route/model binding set up in my project for one of my models, and that works just fine. I'm able to use my binding in my route path and accept an instance of my model as a parameter to the relevant method in my controller.Now I'm trying to do some work with this model, so I have created a method in my controller that accepts a Form Request so I can carry out some validation.Each different instance of my model can be validated differently, so I need to be able to use an instance of the model in order to build a custom set of validation rules.Is there a way of getting the instance of the model, that is injected into the controller from the Form Request?I have tried type-hinting the model instance in the Form Request's constructorI have also tried type-hinting the model instance in the Form Request's rules() method.In both instances I am provided an empty/new instance of the model, rather than the instance I am expecting.Of course, I could always get around this by not bothering with Form Requests and just generate the rules in the controller and validate manually - but I would rather do it the Laravel way if it's possible.Thanks

2016-05-20 12:58:59Z

I have some route/model binding set up in my project for one of my models, and that works just fine. I'm able to use my binding in my route path and accept an instance of my model as a parameter to the relevant method in my controller.Now I'm trying to do some work with this model, so I have created a method in my controller that accepts a Form Request so I can carry out some validation.Each different instance of my model can be validated differently, so I need to be able to use an instance of the model in order to build a custom set of validation rules.Is there a way of getting the instance of the model, that is injected into the controller from the Form Request?I have tried type-hinting the model instance in the Form Request's constructorI have also tried type-hinting the model instance in the Form Request's rules() method.In both instances I am provided an empty/new instance of the model, rather than the instance I am expecting.Of course, I could always get around this by not bothering with Form Requests and just generate the rules in the controller and validate manually - but I would rather do it the Laravel way if it's possible.ThanksYou can simply access it using the binding key, so for example if you bind Brand model: $router->model('brand', '\App\Brand') you can get instance of your model with $this->brand. Here is validation rules example:EDITSometimes you might have an input name that uses the same name as the binding key, for example, if you bind Address model as address then you have an input field address it will make Laravel confuse. For this situation you can use route() method.

Including PHP files with Laravel framework

user1072337

[Including PHP files with Laravel framework](https://stackoverflow.com/questions/17159046/including-php-files-with-laravel-framework)

I am trying to "include" a php script into one of my views (landing.blade.php).  The script is in: When I try to include this code in the view:I get the error:  include_once(/assets/scripts/config.php): failed to open stream: No such file or directoryThis is on localhost using MAMP.  I'm not sure if there is a different set of rules I need to use with Laravel 4 to include a php file.  Thank you for your help!

2013-06-18 00:47:55Z

I am trying to "include" a php script into one of my views (landing.blade.php).  The script is in: When I try to include this code in the view:I get the error:  include_once(/assets/scripts/config.php): failed to open stream: No such file or directoryThis is on localhost using MAMP.  I'm not sure if there is a different set of rules I need to use with Laravel 4 to include a php file.  Thank you for your help!First, it's not really recommended that you keep your PHP files in the public directory, they should be kept inside the app folder. I'd suggest you create a folder inside app, something like includes and put your files there. Then, you include it, do:Although, since it looks like you're trying to load some configuration files, I'd recommend you also check out Laravel's own way of handling configurations. For instance, if you created a myapp.php file inside the app/config folder, Laravel would handle it automatically for you, as long as you'd have some key-value pairs, like this:You could then retrieve these values using the Config class:This is a better solution because you can also take advantage of Laravel's environment configuration.

Laravel: Class 'GuzzleHttp\Client' not found

InvalidSyntax

[Laravel: Class 'GuzzleHttp\Client' not found](https://stackoverflow.com/questions/31227080/laravel-class-guzzlehttp-client-not-found)

I am trying to use Mandrill to send emails via my Laravel framework, however I am receiving the following error:I have installed Guzzle using the following command in Terminal:According to Laravel's documentation I need to add "guzzlehttp/guzzle": "~4.0" to my composer.json file, but I'm not sure if where I have placed it is correct as I still see the error.Here is the list of packages my application has, notice that guzzle has a different version: 4.2.3 which i've also tried updating to but still get the same error.

2015-07-05 04:14:14Z

I am trying to use Mandrill to send emails via my Laravel framework, however I am receiving the following error:I have installed Guzzle using the following command in Terminal:According to Laravel's documentation I need to add "guzzlehttp/guzzle": "~4.0" to my composer.json file, but I'm not sure if where I have placed it is correct as I still see the error.Here is the list of packages my application has, notice that guzzle has a different version: 4.2.3 which i've also tried updating to but still get the same error.

Open up your terminal at the root of your project and enterIt worked for the mailgun API. For some reason, the suggested method at the laravel's mail doc. You may install this package to your project by adding the following line to your composer.json file doesn't make the composer download the Guzzle source codes. By the way, I didn't find out what | means in determining the version. This command just downloads the PSR code. In this moment, the solution may work. However, be aware of compatibility issues. Because the command would install the latest stable version, not the suitable one. If you're using Laravel when you run into this error, just run:And try again.After updating your composer.json file you need to run the update command to resolve and install your dependencies:or, if composer isn't in your path:Did you try :or if artisan is not available try to remove compiled.php if exist (in vendor directory) and launch composer dumpautoload  I had the same issue.

I used an old version in order to work.

It's not working anymore since version 4.

It works on version 3.8.1So you can add "guzzlehttp/guzzle": "~3" to workssimple in my case add "guzzlehttp/guzzle": "^6.3" in composer.json

require object as mentioned belowthan run composer update in project root using terminal than its working fine.I got this error when I tried running my code outside of the Laravel framework while testing in a stand alone file.  It worked for me when I moved it inside a controller.You can solve this problem to add "mews/captcha": "1.0.1" and "guzzlehttp/guzzle": "~4.0" to your composer.json file. And then you need run composer update command on your terminal.I have tried on Laravel 4. It works for me.I am oblivious to why this worked for me, I saw this in a forum somewhereI just added this captcha generator to the composer.json fileadded it to all the require packageIf someone knows why this worked it would really scratch the itch in my brain.

The Mix manifest does not exist when it does exist

Chris

[The Mix manifest does not exist when it does exist](https://stackoverflow.com/questions/45153738/the-mix-manifest-does-not-exist-when-it-does-exist)

For my admin panel I extract all the assets including the manifest-json.js to mix.setPublicPath(path.normalize('public/backend/')).All the files get correctly added to the backend folder, and the manifest-json.js file looks as follows:the problem is that when using in my blade-files, it looks in public/manifest-json.js instead of looking for it in backend/manifest-json.js.How can I make sure the right manifest-json.js file is used?

2017-07-17 21:11:22Z

For my admin panel I extract all the assets including the manifest-json.js to mix.setPublicPath(path.normalize('public/backend/')).All the files get correctly added to the backend folder, and the manifest-json.js file looks as follows:the problem is that when using in my blade-files, it looks in public/manifest-json.js instead of looking for it in backend/manifest-json.js.How can I make sure the right manifest-json.js file is used?i solved my problem running this commandand thenThank You.I had same exception after deployment  laravel project to  server. It was working perfectly fine on localhost but after  lot of research I found a solution. If you encounter this exception on server then you have to bind your public path to public_htmlJust go to under the app/Providers, you will find your AppServiceProvider file and inside boot() method make the binding as below.The problem I faced was that the mix()-helper function by default looks for the manifest-json file in /public/manifest-json.js so if you store that file on any other directory level then it will throw that error.Let's say the manifest-json file is stored in public/app/manifest-json.js, then for a file located in public/app/css/app.css you would use:The mix()-helper function allows for a second argument, the directory of the manifest file. Just specify it there and it will use the correct manifest file.In shared hosts and laravel 5.6 tested:

after doing standard levels such as explained here;

two levels needed:

in app/Providers/AppServiceProvider.php:and in public_html file make .htaccess file with content:source: here

this file most change for some situations.that's all and solved my problemi have same problem as questioner: manifest does not exist for solving it what i have done is ran 2 commands as following:and thenand the error is solved now. yippi.I had the same issue with a Laravel package, its assets were not published:This solved the issue for me:php artisan vendor:publish --tag=telescope-assets --forceSources:

https://github.com/laravel/telescope/issues/136

https://github.com/laravel/telescope/issues/250I found new solutionThe problem is mix manifest right?

So just redirect to the mix manifest feature. for example, you have:just change your code into it works for meI had the issue on a shared host, where I was not able to run npm commands. Then I used the simplest way. In the /vendor/laravel/.../Foundation/Mix.php replace toNot recommended, but it works. You can use it as your last try.

Expected response code 250 but got code「530」, with message "530 5.7.1 Authentication required

Abdallah Abdillah

[Expected response code 250 but got code「530」, with message "530 5.7.1 Authentication required](https://stackoverflow.com/questions/48341078/expected-response-code-250-but-got-code-530-with-message-530-5-7-1-authentic)

I got stack on this error I trying to configure SMTP  mail on laravel here is my configuration on .env 

I have try to authenticate the SMTP on env  but I keep get the same error so for now am stack on that error

2018-01-19 12:25:35Z

I got stack on this error I trying to configure SMTP  mail on laravel here is my configuration on .env 

I have try to authenticate the SMTP on env  but I keep get the same error so for now am stack on that erroryour mail.php on config you declare host as smtp.mailgun.org and port is 587 while on env is different. you need to change your mail.php to'host' => env('MAIL_HOST', 'mailtrap.io'),'port' => env('MAIL_PORT', 2525),if you desire to use mailtrap.Then runI believe this has been answered in some sections already, just test with gmail for your "MAIL_HOST" instead and don't forget to clear cache. Setup like below:

Firstly, you need to setup 2 step verification here google security. An App Password link will appear and you can get your App Password to insert into below "MAIL_PASSWORD". More info on getting App Password hereClear cache with:That is basically authentication error due to misconfiguration of email settings.Go to .env filechangetoThe MAIL_USERNAME and PASSWORD should be replaced with your Gmail Email address and Password respectively. Login to your Google Account, Go to security settings and enable Allow Less Secure App switch button.After that go to your project root directory and run the following command:. Please refer to this guide  for assistance and clarification (Note: For MAIL_HOST use smtp.gmail.com)I see you have all the settings right. You just need to end the local web server and start it again with Everytime you change your .env file, you need tor restart the server for the new options to take effect.Or clear and cache your configuration with Yep, and if you have tried all the above solutions (what's more likely to happen) and none work for you, it may happen that Guzzle is not installed.Laravel ships mailing tools, by which is required the Guzzle framework, but it won't be installed, and AS OF the documentation, will have to install it manually:

https://laravel.com/docs/master/mail#driver-prerequisites

Eloquent ORM Code Hinting in PhpStorm

Josh Janusch

[Eloquent ORM Code Hinting in PhpStorm](https://stackoverflow.com/questions/29439753/eloquent-orm-code-hinting-in-phpstorm)

So I'm just starting off with Laravel (using v5) and Eloquent. I'm working on getting some basic APIs up and running and noticing that a lot of working methods don't show up in PhpStorm's code hintingSo I have this model:And in one of my controllers I try to doUser::query() creates a Eloquent Builder object and orderBy() behave properly and without error. However, PhpStorm does not show orderBy() (or take(), skip(), and I'm sure others) when I type User::query()-> and gives warnings when I actually do use it.I am using Laravel IDE Helper which has helped immensely with bringing code hints to the Facades, but not to the models/builders it would seem.Does anyone have a solution to this?

2015-04-03 21:12:54Z

So I'm just starting off with Laravel (using v5) and Eloquent. I'm working on getting some basic APIs up and running and noticing that a lot of working methods don't show up in PhpStorm's code hintingSo I have this model:And in one of my controllers I try to doUser::query() creates a Eloquent Builder object and orderBy() behave properly and without error. However, PhpStorm does not show orderBy() (or take(), skip(), and I'm sure others) when I type User::query()-> and gives warnings when I actually do use it.I am using Laravel IDE Helper which has helped immensely with bringing code hints to the Facades, but not to the models/builders it would seem.Does anyone have a solution to this?For future Googlers, and perhaps OP as well if you are still sticking to Laravel.The laravel-ide-helper package solves this issue for you quite elegantly, with what I believe is a relatively new feature; generated model PHPDocs.You can generate a separate file for all PHPDocs with this command:The generated metadata will look something like this for each class:This caused issues for me in PHPStorm however, where the software was complaining about multiple class definitions. Luckily an option is readily available for writing directly to the model files:There are a few more options and settings available if you need to tweak the behavior, but this is the gist of it.Add in model PHPDoc@mixinIn PHPStorm worksOr add to \Illuminate\Database\Eloquent\ModelPHPDocA little late but I recently had the same problem so I thought I would put a note down:This is because Database\Eloquent\Model.php has a query() function which returns \Illuminate\Database\Eloquent\Builder and the Eloquent\Builder has a line:Then it uses 'magic' __call methods to call to functions in Query\Builder. (look for __call method in Eloquent\Builder)See:

http://php.net/manual/en/language.oop5.overloading.php#object.callSo, indeed the method you are calling is inaccessible :) There is not much that the IDE can do.There are workarounds like using @method tags but it is unmaintainable. An alternative is to use @mixin (but this is not standards based).

See: https://github.com/laravel/framework/issues/7558I think this all be resolved when they get rid of all the magic calls in the Laravel code and use PHP 'traits' instead. See last message here. :)You can try Laravel plug-in for PhpStorm and you need to specifically activate it in your project settings.If you're using BarryVHD's Laravel IDE Helper package, run:This will write /** @mixin \Eloquent */ into the vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php file.I wanted to have some kind of explicit "casting" when interacting with the query builder. Example...Since all my models are extending my custom base Model which in turn extends Eloquent, I've ended up creating this method in my custom base model:This way, it solves the IDE invalid error and helps me:Please note that this is not OOP type casting. It is only a hint to help the IDE. In my example, the returned Model was already a User. If I woud use this method on a derived class like SuperUser, only the IDE will be fooled...An nice alternative also is to put meta information directly over the assignment statement:Or next to it...

CRUD Laravel 4 how to link to destroy?

helloworld

[CRUD Laravel 4 how to link to destroy?](https://stackoverflow.com/questions/19643483/crud-laravel-4-how-to-link-to-destroy)

I will destroy my user with a HTML link, but it doesn't seem to generate the correct link, what am i doing wrong?In my view i call this

{{URL::action('UserController@destroy', array($user->id))}}

2013-10-28 19:30:56Z

I will destroy my user with a HTML link, but it doesn't seem to generate the correct link, what am i doing wrong?In my view i call this

{{URL::action('UserController@destroy', array($user->id))}}Update 08/21/2017 for Laravel 5.xThe question asks about Laravel 4, but I include this in case people looking for Laravel 5.x answers end up here. The Form helper (and some others) aren't available as of 5.x. You still need to specify a method on a form if you are doing something besides GET or POST. This is the current way to accomplish that:You can also use {{ method_field('PUT') }} instead of writing out the hidden _method input.See https://laravel.com/docs/5.4/routing#form-method-spoofingOriginal Answer for Laravel 4I think when you click the link, it is probably sending a GET request to that end point. CRUD in Laravel works according to REST. This means it is expecting a DELETE request instead of GET.Here's one possibility from a tutorial by Boris Strahija.This way, you send the request in a form with the DELETE method. The article explains why a traditional link won't work:An cool ajax solution that works is this:And in the UserController.php we have this method: Another "clean" solution is to make it the Rails way as described here:What I like about this that it seems much cleaner than bloating your code with Form::open(); in blade templates.For those looking to create the delete button in Laravel 5:This is similar to Tayler's answer but we use the new blade escape tags ( {!! and !!} ), we use the Form facade to generate the button and we use a more elegant approach to link to the controller. In Laravel < 5 the Forms & HTML package was pulled in automatically. In Laravel 5 we must add this package to composer.json:Now add the Service Provider and Alias in config/app.php:The above will outputIf you are using a different form builder just make sure it generates something similar to the above. This is an old questions, but I was just looking for a quick answer and am not satisfied with any of these.  What I would suggest to anyone with this same problem is create a new route.  Worrying too much about crud compliance is silly, because there is no such thing over HTML; any solution is just shoe-horned to fit, whether it's a hidden form field or a get route.So, in your routes, you likely have something like this:Route::resource('users', 'UsersController');

The problem with this is that the only way to get to the "destroy" method is to sent a post request which has a hidden input named "_method" and a value of "DELETE".Simply add under that line:

Route::get('users/{id}/destroy',['as'=>'users.delete','uses'=>'UsersController@destroy']);Now you have a route you can access from HTML::linkRoute, Route::url, or whatever method you please.For example:

{{ HTML::linkRoute( 'users.delete', 'Delete' , [ 'id' => $user->id ]) }}EDITI want to clarify, though I have explained why it's somewhat silly to bend over backward to fit crud compliance, it is still true that your app will be more secure if changes are made only through POST requests.Want to send a DELETE request when outside of a form?Well, Jeffrey Way created a nice javascript that creates a form for you and to use it you only need to add data-method="delete" to your delete links.To use, import script, and create a link with the data-method="DELETE" attribute.script :For those looking to create delete button using anchor tag in laravel 5.I tried your code, used it like this and worked:I think that the only problem is in your array: 

Laravel redirect with logout not working

winnyboy5

[Laravel redirect with logout not working](https://stackoverflow.com/questions/23242533/laravel-redirect-with-logout-not-working)

I am Using laravel 4 framework's. When I used redirect after the Auth::logout(), the redirection was not working. I used View::make() too, but same "Whoops, looks like something went wrong." error throws up.This is the logout code. I am using. Some one please help me with this.routes.php HTMLThis is what my debugger shows.

2014-04-23 11:11:32Z

I am Using laravel 4 framework's. When I used redirect after the Auth::logout(), the redirection was not working. I used View::make() too, but same "Whoops, looks like something went wrong." error throws up.This is the logout code. I am using. Some one please help me with this.routes.php HTMLThis is what my debugger shows.You may be missing the remember_token for the users table.see: http://laravel.com/docs/upgrade#upgrade-4.1.26Laravel requires "nullable remember_token of VARCHAR(100), TEXT, or equivalent to your users table."Update for new documentationLaravel 4.2 and up now has a method you can use with your schema builder to add this column.$table->rememberToken();Laravel Docs - Schema - Adding ColumnsIf you have Laravel 4.2 you can do this:Command Line:After this open the file app/database/migrations/2014_10_16_124421_add_remember_token_to_users_table and edit it like this:for your problem ,you may pass null value or you may off your remember_token value in your model php file ashere is a sample code from how I handle logging out users on my system using Laravel 4. I am not sure why yours isn't working and it will be great to see your route, and html code that triggers the logout process as well. The RouteThe HTML button/link triggering the logoutThe Controller Function Handling the logoutHere you got! You should replace it with your route names and controller function. This should work! If it doesn't, post your route and html code! Cheers!Due to the current Laravel update there should be a "remember_token" column in the user table. This solves the problem.I learned that I was getting the logout error in my application because I was usingJust remember to use the following instead.This worked smoothly.You need to add updated_at column into your SQL table user_tbl. If you do not wish to use it. you may also turn off timestamps within your model.

What is the usage of repositories and interfaces in Laravel?

Dreengreen

[What is the usage of repositories and interfaces in Laravel?](https://stackoverflow.com/questions/45914154/what-is-the-usage-of-repositories-and-interfaces-in-laravel)

After developing a few projects using Codeigniter since 2 years,  I stared to learn Laravel.I downloaded a few projects lo learn how they are coded. As I understood, many of them are using only models, views and controllers which is same as Codeigniter.But one project has used repositories and interfaces. It is really hard to understand whats going on that project. So what is the usage of repositories and interfaces in Laravel? When should I use them?

2017-08-28 07:49:16Z

After developing a few projects using Codeigniter since 2 years,  I stared to learn Laravel.I downloaded a few projects lo learn how they are coded. As I understood, many of them are using only models, views and controllers which is same as Codeigniter.But one project has used repositories and interfaces. It is really hard to understand whats going on that project. So what is the usage of repositories and interfaces in Laravel? When should I use them?I will try to explain as clearly as possible the two concepts.Interfaces\ContractsIn general OOP interfaces are used to describe which methods/functionalities the class that implements that interface is offering without caring about the actual implementation.Laravel uses Contracts mainly to separate a service from the actual implementation. To be more clear let's make an exampleAs you can see in this class the code is tightly coupled to a cache implementation (i.e. \SomePackage\Cache\Memcached) so if the API of that Cache class changes our code also must be changed accordingly. The same thing happens if we want to change the Cache implementation with another one (e.g. redis).Instead of doing that, our code could depend on an interface that is agnostic from the implementation:Now our code is not coupled with any specific implementation because Cache is actually an interface. So basically in our class we are requiring an instance of a class that behaves like described in the Cache interface, but we are not really interested in how it works internally. Doing that if we want to change the cache implementation we could write a class that implements the interface Cache without changing any line of code in our OrdersCache class. Doing that our code is easier to understand and maintain and your packages are a lot more reusable. See the section Loose Coupling in the Laravel documentation for further examples.Interfaces and Service ContainerOne of the main features of Laravel is its Service Container, it is used to manage dependencies and performing dependency injection. Please take a look at Service Container definition from Laravel documentation.Dependency Injection is widely used by Laravel also to bind interfaces to implementation. Let's make an example:And let our class beWithout declaring anything else we are basically saying everytime that someone need an EventPusher instance, please Laravel, provide an instance of RedisEventPusher class. In this case everytime that your controller is instantiated, Laravel will pass an instance of RedisEventPusher to your controller without specifying anything else.You can dig into that by looking at Binding Interfaces to Implementation section on the Laravel documentation.RepositoriesRepositories is a concept applicable to the MVC pattern independently from any specific framework. Typically you have your Model that is the data layer (e.g. interacts with the database directly), your Controller that handles the access logic to the data layer and your View that shows the data provided by the Controller.Repositories instead could be defined as follows:To know how to use them within Laravel please take a look at this great article.That's all, i hope it helps to clear up your mind.Interfaces are what any implementing class should call. 

Think of it like programming without bothering with logic.Now we could have passed a Bird object, or an Aeroplane object! PHP DOESN'T CARE, so long as it implements the interface!Your other question, what a Repository class is. It's just a class that keeps all your DB queries in the one place. Check this interface as an example:Hopefully this should clear things up for you! Good luck with all your PHP coding :-DLet's start with the easier one, the interface:You normally use interfaces to implement classes with required methods:

http://php.net/manual/en/language.oop5.interfaces.phpWhen Laravel is running it can check if a class implements a special interface:Since Laravel is able to work with queues it will check if the event should be queued or not by checking for an exiting interface.Repository:I didn't found that much about this:But I found some other information on a webpage:The link will give you more information about the the details.Hope I could help you :)First of all, using Repository and Interface in larger application is not only beneficiary in Laravel but in all technology for coding standard as well as for separation of concern.According to Microsoft (I found best explanation here)Why to use Repository:For Interface, you have a lot of answers above, hope you have understand.First of all, repositories and interfaces are not specific to Laravel but common coding standards in most of the languages.Below Laracasts videos will be useful to understand the basics if you don't mind spend few dollars.https://laracasts.com/lessons/repositories-and-inheritancehttps://laracasts.com/series/object-oriented-bootcamp-in-php

Laravel form model binding

eimajenthat

[Laravel form model binding](https://stackoverflow.com/questions/16873638/laravel-form-model-binding)

I've been reading about this feature: http://laravel.com/docs/html#form-model-bindingAnd it looks really neat, but there are couple of things that I'm not certain about.Do I need to put any code in the controller action to process this form?  What does that look like?The model (User) I want to bind in my form has a separate table for addresses.  So I want to be able to fill out the User model's fields, but also the fields for the related Address model.  Can I do that with form-model-binding, or do I have to handle the form manually?Or, failing that, can I use form model binding for the user fields, but manually handle the address fields?

2013-06-01 14:18:02Z

I've been reading about this feature: http://laravel.com/docs/html#form-model-bindingAnd it looks really neat, but there are couple of things that I'm not certain about.Do I need to put any code in the controller action to process this form?  What does that look like?The model (User) I want to bind in my form has a separate table for addresses.  So I want to be able to fill out the User model's fields, but also the fields for the related Address model.  Can I do that with form-model-binding, or do I have to handle the form manually?Or, failing that, can I use form model binding for the user fields, but manually handle the address fields?You don't need any different code in your controller to process this form. All your (named) form variables will be in Input::all(). The model ($user) you pass in Is just any record you need to, if you have more than one table involved, you'll have to do something likeAnd pass this composed model to your Form::model().How you name your inputs is entirely up to you, because you'll have to write the logic to process your form. But, in my opinion users_address[street] for the address inputs is good, because you'll end up with an array of addresses columns that you can pass right away to your UserAddress model.And if you do dd( Input::all() ) in your controller, you'll get something like this:

This result is provided by Kint's dd(): https://github.com/raveren/kint. Really helpful.If your form just have fields from a single Model, your update method can be very simple and look something like:On forms a little bit more complex, coders will have to add more logic to their controllers, in you case with a little bit more of research I think you can make this happen:In Laravel 5.1 for relation model binding you just need to eager load relation table(s):And in view set fields names as array:

Laravel dynamic config settings

Courtney Ball

[Laravel dynamic config settings](https://stackoverflow.com/questions/39563042/laravel-dynamic-config-settings)

I'm using a package within my project and it stores a setting inside config/packagenameI would like to dynamically change this value inside the config file, this is how the file structure looks currently;I would like to change it to something like this - Can you do this within the config file, or do you have to store some sort of variable to be updated later within a controller. Is there a way to place these variables in an env file and access these new variables from a controller?

2016-09-18 21:54:35Z

I'm using a package within my project and it stores a setting inside config/packagenameI would like to dynamically change this value inside the config file, this is how the file structure looks currently;I would like to change it to something like this - Can you do this within the config file, or do you have to store some sort of variable to be updated later within a controller. Is there a way to place these variables in an env file and access these new variables from a controller?This also is a generic solution to dynamically update your .env file (respective the individual key/value pairs)(The $delim parameter is needed if you want to make this function more generic in order to work with key=value pairs in .env where the value has to be enclosed in double quotes because they contain spaces).Admittedly, this might not be a good solution if you have multiple users at the same time using this package in your project. So it depends on what you are using this package for.NB: You need to make the function public of course if you plan to use it from other classes.All configuration files of Laravel framework stored in the app/config directory.so if we need to create custom configuration values it would be better to keep separate our custom configuration in custom file.

so we need to create custom file in app/config directory. Laravel auto read this file as a config file and will auto manage it

In this topic we are working with custom configuration in laravel and get configuration value in controller or view.Now i am going to explain how to create a custom config file in Laravel so that we can implement dynamic feature over to this.create a file in app/config/custom.php which have config keys and value like:-Now need to get these config values in view/controller so we will use Config class get() method for thisSyntax:where filename is the config file’s name, custom in our case, and key is the array key of the value you’re wanting to access.In Our case it will be as:Create run time configuration in laravel :- Configuration values which are set at run-time are will set for the current request, not be carried over to subsequent requests.Like how the @Kundan roy as suggested using of the isset() the same condition applies here to. But this one is the alternative method that will work for the dynamic setting of the values in the config.Hence by using this method you can create the dynamic config files based on the values that you need.If you want to actually edit the config files (either config/packagename.php or .env) then you may follow matthiku's answer.However, if I were you, I guess I'd rather want to configure this 3rd party package based on some value defined at runtime, instead of modifying any file (which by the way won't take effect until the next request, when the env values are read again).So, in my opinion the cleanest way to do this is::This way you can have the provider read the config values when you are about to instantiate the service, after you set any runtime config values.Use this in controller when you need to change.  You can do like this.In your custom config file. Add the following code You can send your id dynamically from the query string.To get view idSince Laravel v5.2 you can dynamically set config values this way:Actually if you are that point of code which forces you to make the config values dynamic, then there should be something wrong with your code flow, as the use of config file is just for initializing required values - which should be defined before the app is loaded.Making config values dynamic is a "BAD PRACTICE" in the world of coding.

So there is the following alternative for your problem.Define value in .env file (optional)Use value inside ControllerHope this helps you!

Laravel 5.3 date validator: equal to or after start_date

Paul Z.

[Laravel 5.3 date validator: equal to or after start_date](https://stackoverflow.com/questions/41342818/laravel-5-3-date-validator-equal-to-or-after-start-date)

I'm using Laravel 5.3 to validate start_date and end_date for an event.

end_date should be equal to start_date or the after date. end_date >= start_dateI tried to use after, but it only works for end_date > start_date.

Of course, I can add custom rule using Validator::extend, but I'd like to know if we can do without adding custom rule.Is there any way to add negative rule or add >= rule?Thanks

2016-12-27 09:50:34Z

I'm using Laravel 5.3 to validate start_date and end_date for an event.

end_date should be equal to start_date or the after date. end_date >= start_dateI tried to use after, but it only works for end_date > start_date.

Of course, I can add custom rule using Validator::extend, but I'd like to know if we can do without adding custom rule.Is there any way to add negative rule or add >= rule?ThanksUse after_or_equal Actually, you can also use after_or_equal and before_or_equal when using at least Laravel version 5.3.31. This may help to avoid having to upgrade to a higher Laravel version.upgarate to 5.4 and you can use after_or_equal

see

https://laravel.com/docs/5.4/validation#rule-after-or-equalBe careful when you set a validation rule after_or_equal:now and date_format with a format without hours, minutes or seconds!For example:Laravel passing all date fields into the strtotime() function.

Including now string.

And strtotime('now') will return a unix timestamp with current minutes, hours and seconds.For example, the today date is 2020-05-03.

When you send a date value 2020-05-03 into your script, Laravel will pass 2 values into the strtotime() for compare:And you will always fail a validation (exclude a 1 second of the day).To fix it, you should use:

Laravel 5.6 Upgrade caused Logging to break

cbloss793

[Laravel 5.6 Upgrade caused Logging to break](https://stackoverflow.com/questions/49073558/laravel-5-6-upgrade-caused-logging-to-break)

Heey!So I've recently been given the task to take a Laravel 5.2 up to 5.6. It seemed to be fine...until I tried to do a \Log::info(). Every time I run that, I get a big error, but at the end, it still prints to the log. I saw the 5.6 documentation on creating the config/logger.php. I took a fresh copy of it from github. The only thing I did after that was set an env variable for the LOG_CHANNEL to be single. Here's the error I get: I did a file comparison between Laravel 5.2 and 5.6. I'm not seeing anything that jumps out that would break the Logging functionality. Has anyone run into this with a Laravel upgrade?

2018-03-02 16:42:41Z

Heey!So I've recently been given the task to take a Laravel 5.2 up to 5.6. It seemed to be fine...until I tried to do a \Log::info(). Every time I run that, I get a big error, but at the end, it still prints to the log. I saw the 5.6 documentation on creating the config/logger.php. I took a fresh copy of it from github. The only thing I did after that was set an env variable for the LOG_CHANNEL to be single. Here's the error I get: I did a file comparison between Laravel 5.2 and 5.6. I'm not seeing anything that jumps out that would break the Logging functionality. Has anyone run into this with a Laravel upgrade?Add this file to your config folder

https://github.com/laravel/laravel/blob/develop/config/logging.phpand add this to your .env file LOG_CHANNEL=stackI was facing the same issue due to upgrade of my laravel version from 5.3 to 5.7. But after search of few mints i found the solution. 

You just need to follow the following steps.All done. Happy Coding :) I recently had the same error in my development machine (and not in the production one, oddly). In my development machine I have both php 7.1 and php 7.2 installed. Checking with phpinfo(), I discovered that 7.1 was the default version, so I decided to switch to 7.2.That didn't solve the problem (but maybe was part of it).After several hours spent on trying everything suggested around the web, I found my solution by:In detail:After this, I had no problem any more. Maybe try 0755 as permission for the storage folder. Hope this helps!I got the same problem and tried to do everything as you did but not work.Finally, I've found that it was because of cached config, just clear it and everything will be fine:After two days of some research, I found a solution on Github.If you are using Laravel 5.5.4 to Laravel 5.6.*, then you can just install and configure the exceptions package by Graham Campbell.Link: https://github.com/GrahamCampbell/Laravel-ExceptionsThis worked perfectly for me on Mac OSX (PHP 7.1.7), Laravel 5.6.22My initial error:Using emergency logger. {"exception":"[object] (InvalidArgumentException(code: 0): Log [] is not defined. at /Users/pro/Sites/metiwave/vendor/laravel/framework/src/Illuminate/Log/LogManager.php:181)use upgrade guide , and add logging.php to your config files.

A __construct on an Eloquent Laravel Model

Nathan Lochala

[A __construct on an Eloquent Laravel Model](https://stackoverflow.com/questions/30502922/a-construct-on-an-eloquent-laravel-model)

I have a custom setter that I'm running in a __construct method on my model. This is the property I'm wanting to set.My ConstructorThe setter:My problem is that inside my setter the, $this->student_id (which is an attribute of the model being pulled from the database) is returning null.

When I dd($this) from inside my setter, I notice that my #attributes:[] is an empty array.  So, a model's attributes aren't set until after __construct() is fired. How can I set my $directory attribute in my construct method?

2015-05-28 09:45:00Z

I have a custom setter that I'm running in a __construct method on my model. This is the property I'm wanting to set.My ConstructorThe setter:My problem is that inside my setter the, $this->student_id (which is an attribute of the model being pulled from the database) is returning null.

When I dd($this) from inside my setter, I notice that my #attributes:[] is an empty array.  So, a model's attributes aren't set until after __construct() is fired. How can I set my $directory attribute in my construct method?You need to change your constructor to:The first line (parent::__construct()) will run the Eloquent Model's own construct method before your code runs, which will set up all the attributes for you. Also the change to the constructor's method signature is to continue supporting the usage that Laravel expects: $model = new Post(['id' => 5, 'title' => 'My Post']);The rule of thumb really is to always remember, when extending a class, to check that you're not overriding an existing method so that it no longer runs (this is especially important with the magic __construct, __get, etc. methods). You can check the source of the original file to see if it includes the method you're defining.

How do you get the HTTP host with Laravel 5

Sean the Bean

[How do you get the HTTP host with Laravel 5](https://stackoverflow.com/questions/39835650/how-do-you-get-the-http-host-with-laravel-5)

I'm trying to get the hostname from an HTTP request using Laravel 5, including the subdomain (e.g., dev.site.com). I can't find anything about this in the docs, but I would think that should be pretty simple. Anyone know how to do this?

2016-10-03 15:54:51Z

I'm trying to get the hostname from an HTTP request using Laravel 5, including the subdomain (e.g., dev.site.com). I can't find anything about this in the docs, but I would think that should be pretty simple. Anyone know how to do this?Good news! It turns out this is actually pretty easy, although Laravel's Request documentation is a bit lacking (the method I wanted is inherited from Symfony's Request class). If you're in a controller method, you can inject the request object, which has a getHttpHost method. This provides exactly what I was looking for:From anywhere else in your code, you can still access the request object using the request helper function, so this would look like:If you want to include the http/https part of the URL, you can just use the getSchemeAndHttpHost method instead:It took a bit of digging through the source to find this, so I hope it helps!There two ways, so be careful:Example of use in blade : You can use request()->url();Also you can dump the complete request()->headers();And see if that data is useful for you.

global variable in laravel

Pars

[global variable in laravel](https://stackoverflow.com/questions/19808715/global-variable-in-laravel)

In PHP, I used to define some variables in my header.php and use them in all my pages.  How can I have something like that in Laravel?I am not talking about View::share('xx', 'xx' );Assume I want to have a variable which holds a number in it and I need this number inside all my controllers to calculate something.

2013-11-06 09:49:01Z

In PHP, I used to define some variables in my header.php and use them in all my pages.  How can I have something like that in Laravel?I am not talking about View::share('xx', 'xx' );Assume I want to have a variable which holds a number in it and I need this number inside all my controllers to calculate something.Sounds like a good candidate for a configuration file.Create a new one, let's call it calculations.php:Laravel ~4ish:Laravel 5,6,7+:Then put stuff in the new config file:Then retrieve the config in your code somewhere (note the file name becomes a "namespace" of sorts for the config item):Set a property on the BaseController, which should be located in your controllers directory.Your controllers should extend the BaseController class and thus inherit its properties.You could use View ComposersAnd instead of using the boot method described in the docs you could use:That would render whatever variables you declare with to all the views in your app.Here is a full example of how I used this in one of my projects.app/Providers/ComposerServiceProvider.phpapp/Http/ViewComposers/UserComposer.phpJust remember that because you declared a new service provider it needs to be included in the 'providers' array in config/app.php

How can I paginate a merged collection in Laravel 5?

KinsDotNet

[How can I paginate a merged collection in Laravel 5?](https://stackoverflow.com/questions/30420505/how-can-i-paginate-a-merged-collection-in-laravel-5)

I am creating a stream which contains two types of objects, BluePerson and RedPerson. To create the stream, I fetch all of both objects, then merge them into one collection. After doing so, I need to paginate them, however paginate is for eloquent models and DB queries, and not collections, it seems. I have seen a lot about manually creating a paginator, but the documentation, especially in the API is sparse (I can't even seem to find the arguments the Paginator class accepts.) How can I paginate the results of merging my collections?

2015-05-24 05:48:45Z

I am creating a stream which contains two types of objects, BluePerson and RedPerson. To create the stream, I fetch all of both objects, then merge them into one collection. After doing so, I need to paginate them, however paginate is for eloquent models and DB queries, and not collections, it seems. I have seen a lot about manually creating a paginator, but the documentation, especially in the API is sparse (I can't even seem to find the arguments the Paginator class accepts.) How can I paginate the results of merging my collections?You are right. but there is ineed a paginator function for collections. forPageRest is simple. If you want to use a LengthAwarePaginator simply instantiate one. As mentioned in the comments of a previous answer you will have to set the path for this. You will also need to make sure you resolve the "currentPage" and set the items to be returned before you instantiate the paginator. This can all be done before/on instantiation. So a function may look something like:You might try paginating both sets and merging them. You can find more information about pagination in the docs and the api. Here is an example of manually creating your own paginator...I have included the PaginationMerger class below.You can add the following code for Collection in the Providers/AppServiceProvider. Then, you can call paginate from a Collection, just like an Eloquent model. For examplebest way for paginate collection:1- add this to boot function in \app\Providers\AppServiceProvider 2-From hereafter for all collection you can paginate like your codeTry following.I had to deal with something like that in a project i was working on, where in one of the pages i had to display two type of publication paginated and sorted by the created_at field. In my case it was a Post model and an Event Model (hereinafter referred to as publications).The only difference is i didn't want to get all the publications from database then merge and sort the results, as you can imagine it would rise a performance issue if we have hundreds of publications.So i figure out that it would be more convenient to paginate each model and only then, merge and sort them.So here is what i did (based on answers and comments posted earlier)First of all let me show you a simplified version of "my solution", then i will try to explain the code as much as i could.

As you can guess it by now, the facade Paginator is the responsible of merging and sorting my paginators ($events & $posts)To make this answer a little bit more clear and complete, i will show you how to create your own Facade.You can choose to put your own facades anywhere you like, personally, i choose to put them inside Facades folder under the app folder, just like shown in this tree.Put this code inside app/Facades/Paginator.php

For more info, you can see How Facades WorkNext, bind paginator to service container, open app\Providers\AppServiceProvider.php

For more info, you can see The Boot MethodMy Paginator class is under app/Services/Pagination/ folder. Again, you can put your classes wherever you like.

Definitely there is room for improvements, so please if you see something that needs to be changed, leave a comment here or reach me on twitter.

In Laravel, how can I obtain a list of all files in a public folder?

kant312

[In Laravel, how can I obtain a list of all files in a public folder?](https://stackoverflow.com/questions/31316543/in-laravel-how-can-i-obtain-a-list-of-all-files-in-a-public-folder)

I'd like to automatically generate a list of all images in my public folder, but I cannot seem to find any object that could help me do this.The Storage class seems like a good candidate for the job, but it only allows me to search files within the storage folder, which is outside the public folder.

2015-07-09 11:47:34Z

I'd like to automatically generate a list of all images in my public folder, but I cannot seem to find any object that could help me do this.The Storage class seems like a good candidate for the job, but it only allows me to search files within the storage folder, which is outside the public folder.You could create another disk for Storage class. This would be the best solution for you in my opinion.In config/filesystems.php in the disks array add your desired folder. The public folder in this case.Then you can use Storage class to work within your public folder in the following way:The $exists variable will tell you if file.jpg exists inside the public folder because the Storage disk 'public' points to public folder of project.You can use all the Session methods from documentation, with your custom disk. Just add the disk('public') part.http://laravel.com/docs/5.0/filesystem#basic-usageStorage::disk('local')->files('optional_dir_name');or array_filter(Storage::disk('local')->files(), function ($item) {return strpos($item, 'png');});Note that laravel disk has files() and allfiles().  allfiles is recursive.Consider using glob. No need to overcomplicate barebones PHP with helper classes/methods in Laravel 5.To list all files in directory use thisTo list all images in your public dir try this:

see here btw http://php.net/manual/en/class.splfileinfo.phpPlease use the following code and get all the subdirectories of a particular folder in the public folder. When some click the folder it lists the files inside each folder.Controller FileRoute ( Web.php )Route::get('get-files/{directoryName}', 'Displaybackups\BackupController@getFiles');View files - List FoldersView - List Files

Laravel - Database, Table and Column Naming Conventions?

The Dude

[Laravel - Database, Table and Column Naming Conventions?](https://stackoverflow.com/questions/25927700/laravel-database-table-and-column-naming-conventions)

I'm using laravel eloquent data objects to access my data, what is the best way to name my tables, columns, foreign/primary keys etc?I found, there are lots of naming conventions out there. I'm just wondering which one best suits for laravel eloquent models.I'm thinking of following naming convention:So with this, I could use similar syntax in the controller.Are there any recommended Laravel guidelines for this? Can I proceed with these naming conventions?If someone has better suggestions, I will be very happy to hear them.Thanks a lot!

2014-09-19 06:31:41Z

I'm using laravel eloquent data objects to access my data, what is the best way to name my tables, columns, foreign/primary keys etc?I found, there are lots of naming conventions out there. I'm just wondering which one best suits for laravel eloquent models.I'm thinking of following naming convention:So with this, I could use similar syntax in the controller.Are there any recommended Laravel guidelines for this? Can I proceed with these naming conventions?If someone has better suggestions, I will be very happy to hear them.Thanks a lot!Laravel has it's own naming convention. For example, if your model name is User.php then Laravel expects class 'User' to be inside that file. It also expects users table for User model. However, you can override this convention by defining a table property on your model like,From Laravel official documentation:If you will use user table id in another table as a foreign key then, it should be snake-case like user_id so that it can be used automatically in case of relation. Again, you can override this convention by specifying additional arguments in relationship function. For example,Docs for Laravel eloquent relationship For other columns in table, you can name them as you like.I suggest you to go through documentation once.I don't agree in general with these examples you both have shown right on here.It is clean if you take a look at the official Laravel documentation, especially in the Eloquent's relationship session (http://laravel.com/docs/4.2/eloquent#relationships).Table names should be in plural, i.e. 'users' table for User model.And column names don't need to be in Camel Case, but Snake Case. See it is already answered: Database/model field-name convention in Laravel?It is too usual you can see it is like the RedBeanORM: the Snake Case for columns, even if you try other one. And it is adviced to avoid repeating the table names with column ones due to the method you can call from the Model object to access their relationships.The default table naming conventions can easily cause conflicts with the installation of multiple packages who may have incidentally the same class names. A solution would be to name tables as: [vendor].[package].[class], which is in line with how namespacing in Laravel is applied.  Edited: Using dots in table names is not recommended though. Would there be an alternative convention to use to ensure developers of a modular built application do not need to worry about existing table names.

Laravel 5 needs index.php using Apache virtual host

Sven van den Boogaart

[Laravel 5 needs index.php using Apache virtual host](https://stackoverflow.com/questions/30825221/laravel-5-needs-index-php-using-apache-virtual-host)

When I load pages that are not root, the page won't load without index.php before the route. The error I get:To start with I have a virtual host file containing:and a .htacces in my public with :I have another domain with the same .htaccess and appache config on the same server and it works fine. Also I did restart apache. If I use phpinfo on my index.php/route page I see at Loaded Modules:When running the website localy with xampp everything works fine.

For hours i'm trying now but I can't fix it or find any error (logs are empty) or any solutions that I haven't tried yet.Edit:Im using Ubuntu Ubuntu 14.04 x64 on a digital ocean VPS. And I tried turning it on and off again (as suggested). PHP Version 5.5.9-1ubuntu4.9. I followed this tutorial to config everything (except the direcoty part). I changed the location of the apache log and a file error.log is created on the given directory but no errors are in it.My currently appache config is : (i've triple checked the white parts where the domain name is).When I run apache2ctl -t D DUMP_VHOSTS I get this looks fine to me, also tried disabling the default config but it didnt help.Note: i've replaced my real domain with mydomain.com in reality I use my real domain on these spots.Thought how do I know for sure that the conf file im editing is the one being used by the domain?

2015-06-14 01:40:07Z

When I load pages that are not root, the page won't load without index.php before the route. The error I get:To start with I have a virtual host file containing:and a .htacces in my public with :I have another domain with the same .htaccess and appache config on the same server and it works fine. Also I did restart apache. If I use phpinfo on my index.php/route page I see at Loaded Modules:When running the website localy with xampp everything works fine.

For hours i'm trying now but I can't fix it or find any error (logs are empty) or any solutions that I haven't tried yet.Edit:Im using Ubuntu Ubuntu 14.04 x64 on a digital ocean VPS. And I tried turning it on and off again (as suggested). PHP Version 5.5.9-1ubuntu4.9. I followed this tutorial to config everything (except the direcoty part). I changed the location of the apache log and a file error.log is created on the given directory but no errors are in it.My currently appache config is : (i've triple checked the white parts where the domain name is).When I run apache2ctl -t D DUMP_VHOSTS I get this looks fine to me, also tried disabling the default config but it didnt help.Note: i've replaced my real domain with mydomain.com in reality I use my real domain on these spots.Thought how do I know for sure that the conf file im editing is the one being used by the domain?This is the correct Alternative htaccess rule for Laravel 5 suggested to use when the default doesn't work:The Options +FollowSymLinks I believe plays an important role because the DirectotyIndex acts like a symlink.Also check /app/config/app.php to make sure you haven't set the Config('app.url') to contain the index.php. If you have laravel installed in a sub-directory see this:

How can I remove "public/index.php" in the url generated laravel?Have you tried turning it all off (shutdown), and then turning it on again?If everything is as you say, it should work. I would try a restart to see if it changes anything.If it doesn't, please update with what OS you are using.I ended up deleting the complete conf file and copied it again from the one thats working. I took the default .htaccess from laravel and it worked. Unfortunately I still dont know what was wrong though. The current conf file looks likeMy .htaccess in /publicI had almost exactly the same problem today, which @dasper also helped me out on. I am using digital ocean Ubuntu 14.04 also, and I had to run the command a2enmod rewrite then reload apache2. It seemed that even though rewrite appeared to be on, it actually wasn't. First, make sure mode_rewrite is enabled.  I am sure you have probably done this but I want to make sure nothing is missed.Next, see what version of apache you are running since the syntax has changed between 2.2 and 2.4. This should not be a big deal and highly doubt this is the culprit but could save you trouble in the futureNext, try putting the rewrite condition inside of the vhost information instead of the htaccess file. This can help a little with performance as well as give you a console warn/err when restarting apache where the htaccess errors could be squelched.Beyond this point I would be at a loss without some more logging or information from the server. You can also add CustomLog into the vhost and report all requests processed by the server.The problem could be with your virtual host configuration and/or a misplaced .htaccess file.Make sure your .htaccess file is in the public/ folder and that the DocumentRoot is set to that public/ folder.And also, the < Directory> directive isn't controlling your virtual host but rather controls the folder itself and how it can be (or can't be) accessed on the server. To change the configuration of the virtual host do so inside the < VirtualHost> directive.Here is an example of a virtual host configuration:Here is the default Laravel Apache config:and here is an alternative:Try to rename the server.php in the your Laravel root folder to index.php and copy the .htaccess file from /public directory to your Laravel root folder.Solution found hereI believe your directory path is wrong. You need /public on the end because Laravel treats that directory as the web root. Try this:But the better solution is to put the contents of the .htaccess file in your virtual host. Like this:Also, you should make sure your config file is loaded by running:apache2ctl -t -D DUMP_VHOSTSThis will print a list of all the loaded vhosts. If yours isn't in that list then make sure it is enabled by running:a2ensite [name_of_your_config_file]Then restart apache with: service apache2 reloadOne more note: don't forget to edit /etc/hosts and add 127.0.0.2 yourdomain.com

How to pass a PHP variable to Vue component instance in Laravel blade?

mastercheef85

[How to pass a PHP variable to Vue component instance in Laravel blade?](https://stackoverflow.com/questions/41520258/how-to-pass-a-php-variable-to-vue-component-instance-in-laravel-blade)

How can I pass a value of a PHP variable to a Vue component in Laravel blade files?In my example, I have an inline template client-details, I get this view from Laravel so now I want to pass the id which comes with the url /client/1 to my Vue instance.My component, which is loaded by Laravel, looks like:and mounted by:I already tried like but it does not work.

2017-01-07 10:12:43Z

How can I pass a value of a PHP variable to a Vue component in Laravel blade files?In my example, I have an inline template client-details, I get this view from Laravel so now I want to pass the id which comes with the url /client/1 to my Vue instance.My component, which is loaded by Laravel, looks like:and mounted by:I already tried like but it does not work.You have to use Vue's props to be able to pass attributes to Vue's components through markup. Take a look at the following example:In your Vue component:Now in other parts of your Vue component, you can access this value as this.clientId. Issue DetailsPlease note that in HTML we write attribute name in kebab-case but in Vue side we write it in camelCase. More info in official docs here.Also, you are using Vue's v-bind shorthand in :clientId="{{ $client->id }}" which means that Vue will deal anything inside double quotes as a JavaScript expression, therefore you may get errors in that case as well. Instead, you should use this format clientId="{{ $client->id }} without a colon.I just did this and it's working great for me. Using Laravel 5.4 and Vue 2.x.In my component, declare a property (props) for the object:props: ['currentUser'],On my blade page where the component is instantiated:<my-component v-bind:current-user='{!! Auth::user()->toJson() !!}'></my-component>Note that in the component, I am using camelCase for currentUser, but because html is case-insensitive, you have to use kebab-case (thus, the 'current-user').Also note, if you use blade syntax {{  }} then the data between is run through php htmlspecialchars. if you want unencoded data (which in this case you would), then use {!! !!} For anyone who comes across this thread and is still getting errors, the answer is correctly given above by Mustafa Ehsan, but not explained. Trial and error helped me see it. My component in newuser.blade.phpIts very important to note the binding method used. On the component above, I wrote only the name of the data binding (like React props), then registered it on the component props (see below). This is how Mustafa wrote his binding in his answer, and works fine. The other, more Vue way to pass the props is with the v-bind: or :, but you have to make sure to use both double-quotes and single-quotes:Without both quotes, you get Vue warnings. AccessRequest.vue:I had to pass some server data to my Vue component, I ended up creating a $server_data variable in the controller and passing it in a json script tag.In the controller:In the template:In the vue initialisation, I put a computed property:Then, the data is accessible in the component template with server_data.some_object.This allows to pass a lot of structured data without needing many html attributes. Another benefit is that the data is escaped by the the json encoding. This avoids potential bugs with variables that contain double quotes ("), which would mess up the dom.

The Response content must be a string or object implementing __toString(), \「boolean\」given."

Alen

[The Response content must be a string or object implementing __toString(), \「boolean\」given."](https://stackoverflow.com/questions/26022390/the-response-content-must-be-a-string-or-object-implementing-tostring-boo)

I'm trying to return a rendered View using Response::json but I'm getting this error:This is my code:If I var_dump($data) I get this:This is posts.partials.loadHome view:I tested this on localhost and everything works fine. What could be the problem?

2014-09-24 16:51:38Z

I'm trying to return a rendered View using Response::json but I'm getting this error:This is my code:If I var_dump($data) I get this:This is posts.partials.loadHome view:I tested this on localhost and everything works fine. What could be the problem?Check to make sure there aren't any illegal characters. I had this issue once and ran utf8_encode on the string and that solved the issue.I ran in to this blog post and think it gives a pretty good idea for fixing it: Create the following functionTry to do the followingIn my case the error apeared also even when eliminating view variables one by one or when using another view (as suggsested by WillyBurb). So his answer was not working for me. After a long research I found out that the problem was caused by the following columns:After adding them to the $hidden property, the error was gone.from the docs:You can try this please? im return true or false (a boolean value) and not an Response value like thisthis error only happened when you return false;it means  Response::json($data) == false  .some character that json can't encode perhaps，some ASCII char (like 0x00~0x31 that can't display) in your string...so,json encode return falseAlthough this question is a bit old and your problem probably solved by now, I thought this may be relevant for others. Tl;dr: use DB::statement("SET NAMES 'UTF8'"); just before retrieving the results from the database.Your data is probably stored in a character set other than UTF-8 in the database, for instance lantin1. As an alternative for encoding the DB results in your application, you might consider letting the DB handle this. When using MySQL, you can specify the character set to communicate to the server with using SET NAMES 'charset_name'. This specifies to the server that queries are sent using this character set, and asks the server to return results using this character set. (see documentation)Laravel expects UTF-8 data. So, in this case you can issue a statement asking to communicate in UTF-8 before selecting results:If necessary, you can always switch back to another character set afterwards. That you didn't create $data = array(); and the local and remote PHP versions differ.

Laravel 5.2 : Do something after user has logged in?

夏期劇場

[Laravel 5.2 : Do something after user has logged in?](https://stackoverflow.com/questions/36491035/laravel-5-2-do-something-after-user-has-logged-in)

(I'm a beginner of Laravel)I'm using Laravel 5.2. I have successfully enabled the Authentication; by doing the php artisan make:auth and stuffs.So my login is working.Now i need to do something once someone has logged in. For an simple example:LOGIN:LOGOUT:I'm not sure whether there are (things like) hooks or Event Listeners, Event Handlers, or something like that.How can i do it please?

2016-04-08 03:31:45Z

(I'm a beginner of Laravel)I'm using Laravel 5.2. I have successfully enabled the Authentication; by doing the php artisan make:auth and stuffs.So my login is working.Now i need to do something once someone has logged in. For an simple example:LOGIN:LOGOUT:I'm not sure whether there are (things like) hooks or Event Listeners, Event Handlers, or something like that.How can i do it please?For newer versions of LaravelIf you are only doing something very simple then creating an event handler seems overkill to me. Laravel has an empty method included in the AuthenticatesUsers class for this purpose.Just place the following method inside app\Http\Controllers\LoginController (overriding it):For the post login, you can do that by modifying App/Http/Controllers/Auth/AuthController.phpAdd authenticated() into that class to override the default one:For the logout, add this function into the same class:You could try setting up event listeners for the Auth events that are fired.You can setup a listener that listens for Illuminate\Auth\Events\Login to handle what you need post login and Illuminate\Auth\Events\Logout for post logout.Laravel Docs - Authentication - EventsAlief's Answer below works fine as expected. But as i googled through, using the Event Handlers is probably the more preferred way. (It works like custom hooks).So without any less respects to Alief's Answer below, let me choose --> this Event Handers approach i just found out.Thanks all with regards!If you are testing, with authenticated(Request $request, User $user) method dont use alert inside this method to test, it will not show any result, so better put some insert query or something like that to test this method.Why not simple check forMake sure you include use Auth;

How to sort NULL values last using Eloquent in Laravel

eagle0042

[How to sort NULL values last using Eloquent in Laravel](https://stackoverflow.com/questions/17644072/how-to-sort-null-values-last-using-eloquent-in-laravel)

I've got a many to many relationship between my employees and groups table. I've created the pivot table, and all is working correctly with that. However, I've got a sortOrder column on my employees table that I use to determine the order in which they display. Employee with a value of 1 in the sortOrder column should be first, value of 2 should be second, so on. (Or backwards if sorted descending) The sortOrder column is a integer column that allows null values.I've set up my group model to sort the employees by the sort column, but I've run into a problem. The null values always are displayed first. I've tried using ISNULL and similar SQL methods in place of the regular "asc" or "desc" used, but I only get an error.Here's the code in my Group model:And here's what I use in the controller to access my model:What's the trick in Laravel to sorting NULL values last?

2013-07-14 21:42:25Z

I've got a many to many relationship between my employees and groups table. I've created the pivot table, and all is working correctly with that. However, I've got a sortOrder column on my employees table that I use to determine the order in which they display. Employee with a value of 1 in the sortOrder column should be first, value of 2 should be second, so on. (Or backwards if sorted descending) The sortOrder column is a integer column that allows null values.I've set up my group model to sort the employees by the sort column, but I've run into a problem. The null values always are displayed first. I've tried using ISNULL and similar SQL methods in place of the regular "asc" or "desc" used, but I only get an error.Here's the code in my Group model:And here's what I use in the controller to access my model:What's the trick in Laravel to sorting NULL values last?Explanation:

The IF statement solves the issue here. If NULL value is found, some big number is assigned to sortOrder instead. If found not NULL value, real value is used.Laravel does not take into consideration the ISNULL method however, you can pass it in as a raw query and still make use of it as it's more efficient than IF statements and the results will stay the same if you ever go beyond 1000000 employees (accepted answer), like so:Update:

You can also use the orderByRaw() method:Just add a minus sign to field and change order to DESC.In Laravel 5.2 or higher just call orderByRaw. You even able to sort through aggregated value rather than a column. In the following example max_st can be null if there is no submodels.Instead of relying on an arbitrary large number you can also do:It has an added benefit of being supported by SQLite.I ran into this problem recently using Laravel 5.6, where junkystu answer was perfect for me. However our testing framework uses sqlite, so tests were constantly returning a 500 error.This is what we came up with, which should be slightly more agnostic of a DB driver.AscendingDescendingA workaround for PostgreSQL For numeric types:For text types:The trick is to replace NULL values in the sorting column to zero (or empty string) so that it could be sorted as an ordinary integer (or text) value.Seems to work.

laravel 4 artisan — how to rollback to a specific migration state?

do.

[laravel 4 artisan — how to rollback to a specific migration state?](https://stackoverflow.com/questions/17697247/laravel-4-artisan-how-to-rollback-to-a-specific-migration-state)

Say i got a.php, b.php, c.php and d.php migration classes files.  How to rollback to a specific migration state, the state defined within b.php for example, with artisan command ?

2013-07-17 10:23:53Z

Say i got a.php, b.php, c.php and d.php migration classes files.  How to rollback to a specific migration state, the state defined within b.php for example, with artisan command ?I am afraid, you cannot do this directly.You can:

1, Rollback The Last Migration Operation (all migrations ran in the last batch)2, Rollback all migrations3, Rollback all migrations and run them all again  In your situation, modify b.php and it's up() method, then execute artisan migrate:refresh command.There's a way to hack it by manually editing the database. In the migrations table change the batch column by giving the last migration a different batch number. Be aware that they are in increasing order, so edit accordingly. This tracks which migrations were applied separately.Then run artisan:rollback and it will undo the last "batch".So if you want to separate them all, then start from the top and give each 1,2,3,4,5 and so on... You can see that it is easily scriptable, and you can make an artisan command if you wish to separate all your migrations.In my experience. I never do migrate:rollback. I would usually create another migration that does all the changes i need to "undo/rollback" the previous migrations.This way you can be flexible if you want to rollback 2-x steps back, you can just create a new migration to effect the changes you want and then run the new migration by php artisan migrate.In fact, there is not this feature (yet). surprisinglyThe best idea, is create a new file backtob.php and make its up call the down of your other migrate files. To avoid copy and paste, you can do something like this:As you can see, you can create the up and down calling the up and down of those migrations what you want to revert.It is not the ideal, but it is what we can do.With Laravel 5.3 there is no need for heavy scripting. As it allows to rollback given number of migrations.Here's the manual page for reference.If you really wanted to - you could write a custom function that queries the migrations table, looks for the file you are after, and works out how many times to roll back - then does a loop of 'migrate:rollback' until you reach the required migration...There is an easy yet dirty way:If you have migrations a.php, b.php and c.php and want to rollback c and b, you can simply modify a.php in such a way that there will be a syntax error... drop a semi-colon or something.So, when you run php artisan migrate:rollback it will rollback both c and b and stop with an error in a. From then on, the rollback of c and b will be considered the last migration operation.Don't forget to fix whatever error you made on purpose in a.php.Since Laravel just provide php artisan migrate:rollback to rollback your migration script, the best way to rollback your selected migration script is to create a new migration script and put the script in your down method (on your selected migration script) to the newly created migration script.

Hope this help.Use the php artisan migrate:rollback command.To see what rollback will do, use the --pretend option.You can also specify a database connection other than the default one.

laravel 4 -> get column names

Centurion

[laravel 4 -> get column names](https://stackoverflow.com/questions/19951787/laravel-4-get-column-names)

How to get column names of a table in an array or object in Laravel 4 , using Schema, DB, or Eloquent.It seems that I can't find a ready to use function, maybe you have some custom implementations.Thx.

2013-11-13 10:51:03Z

How to get column names of a table in an array or object in Laravel 4 , using Schema, DB, or Eloquent.It seems that I can't find a ready to use function, maybe you have some custom implementations.Thx.At the time I gave this answer Laravel hadn't a way to do this directly, but now you can just:Using attributes won't work because if you doYou have no attributes set to that model and you'll get nothing.Then there is still no real option for that, so I had to go down to the database level and this is my BaseModel:Use it doing:You may try Schema::getColumnListing('tablename'):Result would be something like this depending on your table:You can dig down into DB's Doctrine instance.edit: Doctrine is no longer (as of L4.1) installed by default (it's a 'suggested' rather than 'required' package), but can be added to your composer.json as doctrine/dbal to retain this functionality.I think there's a couple different options, if you are using an Eloquent model, you can look at the getAccessibleAttributes() method, which in theory would give you all the columns of a model consider Eloquent seems them as properties.For example, you'd be able to do something like this for your users table on a User Eloquent model.Another Eloquent method to look at that's similar, but doesn't have the 'accessibility' requirement is the attributesToArray() method.  The returned array of which should have your columns as a key.  Then you can use the PHP function array_keys() to build an array of the keys, which would be your columns.I know it might not be the answer for everyone, but maybe you can grab one record, and get all keys of the data. Ex.This may also be of interest:http://laravelsnippets.com/snippets/get-all-columns-names-from-a-eloquent-model-2You also can try this:I use SQL Server and the Schema way worked for me:

Laravel 4 migrate base table not found

ihkawiss

[Laravel 4 migrate base table not found](https://stackoverflow.com/questions/19265202/laravel-4-migrate-base-table-not-found)

I'm trying to make following tutorial: https://medium.com/on-coding/e8d93c9ce0e2When it comes to run:I get following error:Database connection is working, the migrations table was created successfully. Database name was changed as you can see in the error message. Whats quite strange to me, is that it tries to alter the table - which doesn't exists - and not to create it.Here are my other files, like UserModel, Seeder, Migtation and DB Config.CreateUserTable:UserModel:

    

UserSeeder:

    

DatabaseSeeder:

    

Database Config:

    

Hope somebody can give me a hint here. Best regards ihkawiss

2013-10-09 07:01:17Z

I'm trying to make following tutorial: https://medium.com/on-coding/e8d93c9ce0e2When it comes to run:I get following error:Database connection is working, the migrations table was created successfully. Database name was changed as you can see in the error message. Whats quite strange to me, is that it tries to alter the table - which doesn't exists - and not to create it.Here are my other files, like UserModel, Seeder, Migtation and DB Config.CreateUserTable:UserModel:

    

UserSeeder:

    

DatabaseSeeder:

    

Database Config:

    

Hope somebody can give me a hint here. Best regards ihkawissIn your CreateUserTable migration file, instead of Schema::table you have to use Schema::create.The Schema::table is used to alter an existing table and the Schema::create is used to create new table.Check the documentation:So your user migration will be:The underlying cause of this may be if the syntax used for creating the migration php artisan migrate ... is not quite correct.  In this case the --create will not get picked up properly and you will see the Schema::table instead of the expected Schema::create.  When a migration file is generated like this you might also be missing some of the other markers for a create migration such as the $table->increments('id'); and $table->timestamps();For example, these two commands will not create a create table migration file as you might expect:However, the command will not fail with an error. Instead laravel will create a migration file using Schema::tableI always just use the full syntax when creating a new migration file like this:to avoid any issues like this.  Sometimes it is caused by custom artisan commands. Some of these commands might initiate few classes. And because we did a rollback, the table cannot be found. Check you custom artisan commands. You can comment out the lines which are causing the trigger. Run the php artisan migrate command and then uncomment. This is what I had to do.

Laravel Eloquent: How to automatically fetch relations when serializing through toArray/toJson

Ronni Egeriis Persson

[Laravel Eloquent: How to automatically fetch relations when serializing through toArray/toJson](https://stackoverflow.com/questions/21589622/laravel-eloquent-how-to-automatically-fetch-relations-when-serializing-through)

I figures this works for automatically fetching user and replies when I am serializing my object to JSON, but is overriding toArray really the proper way of doing this?

2014-02-05 22:10:00Z

I figures this works for automatically fetching user and replies when I am serializing my object to JSON, but is overriding toArray really the proper way of doing this?Instead of overriding toArray() to load user and replies, use $with.Here's an example:Also, you should be using toArray() in your controllers, not your models, like so:Hope this helps!I must submit a new answer since I'm a SO pleb. A more proper way to accomplish this for those finding this on Google like I did would be to avoid using protected $with if you don't have to and instead move that with() call to your retrieval.And then you could modify the Post call to pre-load as needed:This way, you won't be including un-needed data every time you grab a record, if you don't need it.

Laravel how to return single column value using Query Builder

user3349495

[Laravel how to return single column value using Query Builder](https://stackoverflow.com/questions/27143961/laravel-how-to-return-single-column-value-using-query-builder)

I want to use the data from the SQL Query, to explain it further here is my code:Now I want the value of my $myquery to be USER_ID's value, I get error if I used the Above code -$myquery->user_id;

2014-11-26 08:03:50Z

I want to use the data from the SQL Query, to explain it further here is my code:Now I want the value of my $myquery to be USER_ID's value, I get error if I used the Above code -$myquery->user_id;You're trying to get property of the array, so obviously you're getting error.If you need single field only, then use pluck (which returns single value - string by default):When you need whole row, then first (which returns stdObject):And get is when you want multiple results (which returns simple array of stdObjects):That's for Laravel 5.3:This will return user_id onlyTo get only the list of value of a single column you can do like this.here $result will give you the result like this:hope it may help someoneAccording to the latest documentation: 5.6will do the trick.I think there is some confusion; but I am using Laravel 5.3 and pluck and value function is not deprecated as depicted above.For more clarification:

pluck() will be used instead of get() when you want all the values only

value() will be used instead of first() when you want only one value.use method all() to get the array of itmes. 

usage:DB::table('table_name')->select('column_na')->get();If you have data in array already and you want to filter only such kind of data, you can do this as wellby default, the returned data will be array of objects. you need to loop over it. e.g. 

BinaryFileResponse in Laravel undefined

Sebi55

[BinaryFileResponse in Laravel undefined](https://stackoverflow.com/questions/29289177/binaryfileresponse-in-laravel-undefined)

I have got the following problem:

I want to return an Image on the route /getImage/{id}

The function looks like this:When I do this it returns me this:I have got use Response; at the beginning of the controller.

I dont think that the HandleCors.php is the problem but anyway:I actually dont know why this happens since it is exactly like it is described in the Laravel Docs.

I have updated Laravel when I got the error but this did not fix it.

2015-03-26 21:25:58Z

I have got the following problem:

I want to return an Image on the route /getImage/{id}

The function looks like this:When I do this it returns me this:I have got use Response; at the beginning of the controller.

I dont think that the HandleCors.php is the problem but anyway:I actually dont know why this happens since it is exactly like it is described in the Laravel Docs.

I have updated Laravel when I got the error but this did not fix it.The problem is that you're calling ->header() on a Response object that doesn't have that function (the Symfony\Component\HttpFoundation\BinaryFileResponse class). The ->header() function is part of a trait that is used by Laravel's Response class, not the base Symfony Response.Fortunately, you have access to the headers property, so you can do this:When responding to file a request, you may not want to set headers at all on these types of requests but do on all other native response types.This can be done by checking the header method exists in the returned closure.You may want to do something else if the header method is not available on the current closure instance.

Query relationship Eloquent

Vuk Stanković

[Query relationship Eloquent](https://stackoverflow.com/questions/20036269/query-relationship-eloquent)

I have News model, and News has many comments, so I did this in News model:But I also have field trashed in comments table, and I only want to select comments that are not trashed. So trashed <> 1. So I wonder is there a way to do something like this: Is there a way to use above method or should I just write something like this: 

2013-11-17 21:15:47Z

I have News model, and News has many comments, so I did this in News model:But I also have field trashed in comments table, and I only want to select comments that are not trashed. So trashed <> 1. So I wonder is there a way to do something like this: Is there a way to use above method or should I just write something like this: Any of these should work for you, pick the one you like the most:I couldn't help but notice, though, that what you're probably trying to do is handle soft deleting, and that Laravel has built-in functionality to help you with that: http://laravel.com/docs/eloquent#soft-deletingrmobis's answer was what I needed, but it throws an error in current Laravel 5. You have to use it as an associatve array now:Took me some time to figure it out, hope this will help others.Read more in Laravel's Docs (5.6): https://laravel.com/docs/5.6/eloquent-relationships#querying-relationsYou can do simply in your eloquent model file.

do like this :call like this : 

laravel updateOrCreate method

Gammer

[laravel updateOrCreate method](https://stackoverflow.com/questions/42695943/laravel-updateorcreate-method)

I have the following code in my method which I am sending via ajax to the controller method :The dd($request->all()) gives me :which is perfect.Jquery code :Now the problem is that i have a record in my table, But the above code creates another one, And the second is that it creates multiply by two records on each button click (request). 

2017-03-09 12:54:15Z

I have the following code in my method which I am sending via ajax to the controller method :The dd($request->all()) gives me :which is perfect.Jquery code :Now the problem is that i have a record in my table, But the above code creates another one, And the second is that it creates multiply by two records on each button click (request). In your use case, you should specify a second parameter. The first indicates the conditions for a match and second is used to specify which fields to update.Here is an example from the documentation: https://laravel.com/docs/5.4/eloquentMy code is

Multi-tiered comment system Laravel

O P

[Multi-tiered comment system Laravel](https://stackoverflow.com/questions/35073613/multi-tiered-comment-system-laravel)

I'm having difficulty with blade recursive partial views. Everything works for the most part with the exception of recursion in the comment.blade.php file.I know I need to use a foreach around the @include('articles.comments.comment', $comment) to call itself again, but I'm not sure how to call for it.article_comments table:app\Article.php Class:app\Comments.php Class:app\Http\Controllers\ArticlesController.php:resources\views\articles\show.blade.phpresources\views\articles\comments\comment.blade.phpCurrent error:

2016-01-28 22:45:44Z

I'm having difficulty with blade recursive partial views. Everything works for the most part with the exception of recursion in the comment.blade.php file.I know I need to use a foreach around the @include('articles.comments.comment', $comment) to call itself again, but I'm not sure how to call for it.article_comments table:app\Article.php Class:app\Comments.php Class:app\Http\Controllers\ArticlesController.php:resources\views\articles\show.blade.phpresources\views\articles\comments\comment.blade.phpCurrent error:You're pretty close.  I think this should work:    resources\views\articles\show.blade.phpresources\views\articles\comments\comment.blade.phpapp\Http\Controllers\ArticlesController.php:First, I see that you're laying all the comments in one page without any pagination, yet, you constrain your comments() method on the Article model to only comments having parent_id=0 to get only the root comments. But, looking further at your code, in your controller, you're lazy loading comments.author and comments.children along. Note that the lazy loading will happen only for the first parent comments and after that, all the children will have to do a lot queries to get their relations by eagerly loading the relations. If you stil want to lay all the comments in one page, I suggest you remove the parent_id=0 constraint and load the comments all at once and apply a strategy to order them. Here's an example:app\Article.php app\Http\Controllers\ArticlesController.phpNow that we have our comments all sorted without penalizing the database, we can start looping through the ads. I prefer to use two files instead of one for looping so I can reuse the code later.resources\views\articles\show.blade.phpresources\views\articles\comments\container.blade.phpresources\views\articles\comments\show.blade.phpI might be missing something, but it looks to me like you have over complicated some of your code. For example, you could add a user relation to your comments model (You could also possibly remove the whole count method as well):Then whenever you need to access the user id or username of the commenter, you can just call:Then you should be able to clean up a lot of your controller:Your show.blade.php file should be just fine as is.

Your comment.blade.php file could be written this way:I believe your issue with the Invalid argument supplied for foreach() error you are getting has to do with your original query for the comments. The error should be fixed by using the proper relational models.As a side note, if you need to count your comment's children by a node column, you should be able to do something like this:I simplified it a bit but this is what I would do:Eloquent part:Controller/Route action part:View part:

Article view:Comments view:Please note that this is not very efficient if there are a lot of nested comments such as:A different way to structure this would be by by fetching all comments as once:Assuming here the default value for parent_id is 0 then in your article view you could do something like this:And in your comments view you could do something like this:Update:

Looking at how you're still stuck with this I've uploaded an example: https://github.com/rojtjo/comments-exampleMake sure check out the last commit, it shows the diff between the different methods I've used in the examples.Starting with the mysql database:Comment table structureArticle table structureYour models will be setup as such: Comments model will be polymorphic, so that you may use your comments on other sections of your application. Note: I recommend moving your models to app\models\ folder.app\Comments.php Class:app\Articles.php class:The article controller will be practically the same with the added code to eager load the comments and its children.app\Http\Controllers\ArticlesController.php:Finally, the views to display your dataresources\views\articles\show.blade.phpresources\views\articles\comments\comment.blade.phpI sort of refactored your Comments.php. You can try this:app\Comments.phpresources\views\articles\comments\comment.blade.phpresources\views\articles\show.blade.php

Dynamic urls in laravel?

Hailwood

[Dynamic urls in laravel?](https://stackoverflow.com/questions/13860162/dynamic-urls-in-laravel)

I am looking at switching to laravel for my next project.My next project is probably going to be a small site with a few static pages, a blog and a projects manager and will be using controllers not routes.What I am curious about is how I can manage dynamic routes in Laravel.Basically, I want to build in an admin section so I can easily create the static pages on the fly, and the static pages will have SEO focussed urls, e.g. http://domain.com/when-it-started I do not want to have to create a new controller or route manually for each page.So I am wondering what the cleanest way is to handle this.essentially all static pages are going to share the same view, just a few variables to change.The dynamic routing should work with the controllers not instead of.E.g. if we have a controller about with a function staff then this should be loaded via  http://domain.com/about/staffbut we dont have the function players, so a call to http://domain.com/about/players should check the database to see if a dynamic route exists and matches. If it does display that, otherwise show the 404 page. Likewise for a non-existant controller. (e.g. there would not be a when-it-started controller!)The chosen answer doesn't seem to work in Laravel 4. Any help with that?

2012-12-13 12:46:23Z

I am looking at switching to laravel for my next project.My next project is probably going to be a small site with a few static pages, a blog and a projects manager and will be using controllers not routes.What I am curious about is how I can manage dynamic routes in Laravel.Basically, I want to build in an admin section so I can easily create the static pages on the fly, and the static pages will have SEO focussed urls, e.g. http://domain.com/when-it-started I do not want to have to create a new controller or route manually for each page.So I am wondering what the cleanest way is to handle this.essentially all static pages are going to share the same view, just a few variables to change.The dynamic routing should work with the controllers not instead of.E.g. if we have a controller about with a function staff then this should be loaded via  http://domain.com/about/staffbut we dont have the function players, so a call to http://domain.com/about/players should check the database to see if a dynamic route exists and matches. If it does display that, otherwise show the 404 page. Likewise for a non-existant controller. (e.g. there would not be a when-it-started controller!)The chosen answer doesn't seem to work in Laravel 4. Any help with that?For Laravel 4 do thisYou could use the route wildcards for the job, you can start with an (:any) and if you need multiple url segments add an optional (:all?), then identify the page from the slug.For example:Very similar to Charles' answer, but in the controller:Then you can route it like this:...which has the added bonus of allowing you an easy way to link straight to the slug routes on an index page, for example:

Laravel PDOException SQLSTATE[HY000] [1049] Unknown database 'forge'

Anastasie Laurent

[Laravel PDOException SQLSTATE[HY000] [1049] Unknown database 'forge'](https://stackoverflow.com/questions/24119818/laravel-pdoexception-sqlstatehy000-1049-unknown-database-forge)

I am using Laravel to connect to MySQL database.I got this exception:and this is my config.database.phpwhy is the error referring to PDO database? and why the forge database name? I have already changed it. Should I do anything to tell Laravel that I am using MySQL database?I found this line

protected $table = 'users';

in my user.php file and I have changed it to 

protected $table = 'user'; because the table in my database is user not usersI wrote this in my Routeand I added UsersController.php in my controllers folderand inside UsersController.php I have this:and I call this url http://localhost:8082/laravel/public/users/I am using Windows 7 with Laravel 4.2Thanks in advance

2014-06-09 11:57:45Z

I am using Laravel to connect to MySQL database.I got this exception:and this is my config.database.phpwhy is the error referring to PDO database? and why the forge database name? I have already changed it. Should I do anything to tell Laravel that I am using MySQL database?I found this line

protected $table = 'users';

in my user.php file and I have changed it to 

protected $table = 'user'; because the table in my database is user not usersI wrote this in my Routeand I added UsersController.php in my controllers folderand inside UsersController.php I have this:and I call this url http://localhost:8082/laravel/public/users/I am using Windows 7 with Laravel 4.2Thanks in advanceYou have to clear the cache like that (because your old configuration is in you cache file) :The pdo error comes from the fact Laravel use the pdo driver to connect to mysqlHope your problem will get resolved.Using phpMyAdmin (or whatever you prefer), I just created a database called "forge" and re-ran the php artisan migrate command and it all worked.Sounds like you have an environment-specific config file somewhere that overrides the default database settings. Possibly app/config/local/database.php.Note: Once it happened that I accidentally had a space before my database name such as mydatabase instead of mydatabase, phpmyadmin won't show the space, but if you run it from the command line interface of mysql, such as mysql -u the_user -p then show databases, you'll be able to see the space.I had the same problem...

If you have set your DB name and username and pass correctly in .env file and its still not working run the blow code in terminal:(this will clean the caches that left from previous apps)and then run the command php artisan serve again (if you are running it stop and run it again)Encountered this issue quite a few times, note that I'm running laravel via Vagrant. So here are the fixes that work for me:You may try reloading your server instead of vagrant (ie MAMP)OK, found solution. In the file database.php, by default, it comes the "mysql" part:all you need to do is change the values :by your database name (you must create one if you dont have any) and by that database usernamelike thisMake sure you do not have a duplicated .env file in the laravel folder. If it exists, delete it. Only keep the .env file. You need to modify the name of the DB in the file .env (and if need in .env.example)

I solved my problem with this little correction.In my particular case, I finally realised that my phpMyAdmin was using port 3308 while Laravel was attempting to connect through 3306. so my advice would be to ensure you have the correct connection string!If you've used Homestead, make sure the database name in your .env file belowIs the same as the value in your Homestead.yaml file.I did all of them but didn't work, I find out should stop php artisan serve(Ctrl + C) and start php artisan serve again.Here is my response to the problem described in the question.in cmd write:then try to do this code in your terminalnote:

this will start again the serverI had this problem for several days, it turns out if I created the db inside phpMyAdmin it wouldn't appear to Laravel,

so, I created the db through MySqlWorkbench, and it worked :)sometimes its because DB_CONNECTION=mysql and you want to use SQLite database.

A solution to that is to make DB_CONNECTION=sqlite. hope it helps

Laravel, create MySQL trigger from Migration

maytham-ɯɐɥʇʎɐɯ

[Laravel, create MySQL trigger from Migration](https://stackoverflow.com/questions/27410909/laravel-create-mysql-trigger-from-migration)

I have created MySQL stored procedure from migration and it works just fine.Hereafter I tried to do the same to create MySQL trigger with following codeBut it returns error after I run php artisan migrateQuestion: What is going wrong?

2014-12-10 21:13:26Z

I have created MySQL stored procedure from migration and it works just fine.Hereafter I tried to do the same to create MySQL trigger with following codeBut it returns error after I run php artisan migrateQuestion: What is going wrong?There was issue with class naming.Correct class name could help OR do as I did, Copy your working trigger code temporary in notepad/text. Delete the old migration trigger file and generate new one.In Laravel 4In Laravel 5After it was generated I copy and paste the same Trigger code from my notepad/text and it works just fine.Here is the final working code for creating trigger through migration.it works both with RAW and UNPREPARED method.Run composer dumpautoload in the root (the same place as artisan) should make it work.In Laravel 5.5 works only with DB::unprepared() method.

How to debug php artisan serve in PHPStorm?

chemitaxis

[How to debug php artisan serve in PHPStorm?](https://stackoverflow.com/questions/32780258/how-to-debug-php-artisan-serve-in-phpstorm)

I am using PHPStorm for develop my PHP web pages. All work fine with my Apache Server, XDebug, and a simple web PHP project. No problem.But, when I try to debug a Laravel 5.1 Web Project using php artisan serve, I can't debug the breakpoints. It's like the php artisan serve use another server...And on my PHPStorm, I always see:I have configured all in PHPStorm (enabling remote debug, correct port, etc.), and with "normal" PHP projects all works fine.Can someone tell me if I need to change something?Thanks!

2015-09-25 10:32:37Z

I am using PHPStorm for develop my PHP web pages. All work fine with my Apache Server, XDebug, and a simple web PHP project. No problem.But, when I try to debug a Laravel 5.1 Web Project using php artisan serve, I can't debug the breakpoints. It's like the php artisan serve use another server...And on my PHPStorm, I always see:I have configured all in PHPStorm (enabling remote debug, correct port, etc.), and with "normal" PHP projects all works fine.Can someone tell me if I need to change something?Thanks!Debugging using php artisan serve does not work unless you have enabled debugging in ini file.@Bogdan pointed out the reason. artisan serve will call PHP Built-in Web Server but does not pass on the php command line options (named interpreter options in PHPStorm).ie if you execute from command line:Then these options given by -d are not passed to called PHP Built-in Web server. You can see the calling of build-in server here.Workaround in PHPStorm is to create Run configuration that calls PHP Build-in Web server directly. Instructions:Now the PHPStorm will execute same command as php artisan serve does with additional interpreter options. Actually the php artisan serve only purpose is to append the server.php to PHP Build-In Web Server. server.php just emulates Apache's mod_rewrite functionality. Update: Good reminder from @attila-szeremi: make sure "Start Listening for PHP Debug Connections" is enabled which you manually need to do if you don't run a PhpStorm configuration with "Debug"I don't use phpstorm, but perhaps the solution that I use for debugging in netbeans will prove useful.artisan serve uses a different ini file from the one loaded by your web containerFind this by typingOn my ubuntu box it's located at Edit the ini for your cli environment and use the same configuration you used to enable it for your web container;Example...The only caveat for this, is that as long as you have this configured, it will impact other things that you use php cli for.Additional noteIf you want your debug session to always start automatically (instead of initiating a remote debug via URL request parameter  XDEBUG_SESSION_START=name, for example, when debugging CLI stuff), you can set XDEBUG to always start a remote debugging session with this additional configuration;See https://xdebug.org/docs/allSo, after going through Jeffry's Be Awesome in PhpStorm, I had been stuck in a similar situation to the OP (in the chapter regarding Xdebug and Laravel). I was setting up the breakpoints, but PhpStorm was not able to break the execution according to those points. And, to be honest, Josh's answer here somewhat helped me to understand the problem, but was not clear enough for me. So, I went out and found the solution myself by hit and trial method, the final solution of which I want to share. May be it will come in handy for some folks still wondering.Firstly, as OP said/guessed, php artisan server does use another server. It is PHP's built in web server plus the server.php router file. And the configurations it uses are the CLI configurations. Try php --ini to find all the included configurations. In my case (Ubuntu 17.10), the Xdebug configuration file being included was from the location /etc/php/7.2/cli/conf.d/20-xdebug.ini. I added the second line to enable remote xdebug and now the file looks like this with total 2 lines:zend_extension=xdebug.so

 xdebug.remote_enable=1

Now for configuring PhpStorm:Please remember that the debugger will only work after the actual web server starts, which is the server that starts with php artisan server command.Now, start the web server ie. php artisan serve and in PhpStorm click Run > Debug 'your-debug-config', and everything should work fine!Part 1

Run > Edit Configurationschoose PHP-BuiltIn Web Server

and just set the

Host: localhost

Port: 8000 // or whichever you are usingClick OKPart 2

Install Xdebug helper Chrome extensionIn Chrome browser there should be a bug icon in top right corner

Click on it and choose Debug

so that the gray bug icon changes the color to greenNow when you run php artisan serve

and set a debug checkpointand click on phone icon to "Start listening for Xdebug connection"it should catch your debug checkpoint

create folder in laravel

user1775888

[create folder in laravel](https://stackoverflow.com/questions/21869223/create-folder-in-laravel)

I have problem let user create folder in laravel 4 through ajax request > route > controller@method.

I did test ajax success request to the url call right method.

When I use mkdir or File::mkdir($path); (is this method exist?) , I will get the response Failed to load resource: the server responded with a status of 500 (Internal Server Error) and fail to create new folder.. how to solve it ?route.phpAdminDashboardControllerjs

2014-02-19 01:37:25Z

I have problem let user create folder in laravel 4 through ajax request > route > controller@method.

I did test ajax success request to the url call right method.

When I use mkdir or File::mkdir($path); (is this method exist?) , I will get the response Failed to load resource: the server responded with a status of 500 (Internal Server Error) and fail to create new folder.. how to solve it ?route.phpAdminDashboardControllerjsNo, actually it'sAlso, you may try this:Update: Actually it does work, mkdir is being used behind the scene. This is the source:For deleting:Check the source at following path (in your local installation): Thanks to The Alpha. Your answer helped me, here is a laravel 5 way to do it for those who use the later version :This will create a directory in storage/app/path/toRetrieve the directory you just created with :There's multiple arguments you can use.You can create a directory using defaults.This will return true if directory was able to be created in the /path/to directory. The file mode of the created directory is 0777.You can specify the mode.This will return true if directory was able to be created in the /path/to directory. The file mode of the created directory will be 0775.You can also create the directories recursively.

ajax post in laravel 5 return error 500 (Internal Server Error)

Juliver Galleto

[ajax post in laravel 5 return error 500 (Internal Server Error)](https://stackoverflow.com/questions/30154489/ajax-post-in-laravel-5-return-error-500-internal-server-error)

this is my test ajax in laravel 5 (refer below)and the trigger linkand my routebut it gives me error when I run the console in google chrome and it doesnt return the expected response "return 'Success! ajax in laravel 5';"whats wrong/problem to my code? anything im missing?

2015-05-10 17:34:25Z

this is my test ajax in laravel 5 (refer below)and the trigger linkand my routebut it gives me error when I run the console in google chrome and it doesnt return the expected response "return 'Success! ajax in laravel 5';"whats wrong/problem to my code? anything im missing?While this question exists for a while, but no accepted answer is given I'd like to point you towards the solution. Because you're sending with ajax, and presumably still use the CSRF middleware, you need to provide an additional header with your request.Add a meta-tag to each page (or master layout): <meta name="csrf-token" content="{{ csrf_token() }}">And add to your javascript-file (or section within the page):See https://laravel.com/docs/master/csrf#csrf-x-csrf-token for more details.90% of the laravel ajax internal server error is due to missing CSRF token. other reasons can inlucde:You can read further about this in details here: https://abbasharoon.me/how-to-fix-laravel-ajax-500-internal-server-error/I guess this has been solved by now but still the best thing to do here is to send the token with your form and then in your ajax You can add your URLs to VerifyCsrfToken.php middleware. The URLs will be excluded from CSRF verification.In App\Http\Middleware\VerifyCsrfToken.php you could try updating the file to something like:This allows you to explicitly bypass specific routes that you do not want verified without disabling csrf validation globally.By default Laravel comes with CSRF middleware.You have 2 options:for me this error cause of different stuff.

i have two ajax call in my page.

first one for save comment and another one for save like.

in my routes.php i had this:and i got 500 internal server error for my save like ajax call.

so i change second line http request type to PUT and error goes away.

you can use PATCH too.

maybe it helps.you have to pass the csrf field through ajax please look at the code hereand you also need to write this input field before thisstill if you do not understand please enjoy this video

https://www.youtube.com/watch?v=ykXL8o0slJA&t=20sUsing post jquery instead helped me to solve this problemI have written this blog just for you guys, hope it helped you. do not forget add "use Illuminate\Http\Request;" on your controller

Required_if laravel with multiple value

Donny Akhmad Septa Utama

[Required_if laravel with multiple value](https://stackoverflow.com/questions/36274940/required-if-laravel-with-multiple-value)

I have a dropdown menu like this:I want the following in laravel:But if I select option 1, stext is still required. Why?

How can I fix it?

2016-03-29 03:36:37Z

I have a dropdown menu like this:I want the following in laravel:But if I select option 1, stext is still required. Why?

How can I fix it?I think that the require_if validation accept only one value per time.

Try to change your validation code as below:EDIT:

Check LePhleg answer, is more cleaner.

At the time of the answer that was not possible, just check the question, he was using the same method but not worked.You just have to pass all the values as parameters separated by comma:try this oneif single match value then used like thatif you have multiple value then used like that (separated by comma)for more information see documentation required_ifYou can go ahead with sometimes validation for laravel. you can define a custom closure as in the below example 

CRUD Laravel 5 how to link to destroy of Resource Controller?

xenish

[CRUD Laravel 5 how to link to destroy of Resource Controller?](https://stackoverflow.com/questions/30299202/crud-laravel-5-how-to-link-to-destroy-of-resource-controller)

I have a link         this link is supposed to direct to the destroy method of the Usercontroller , this is my route Route::resource('/user', 'BackEnd\UsersController');UserController is a  Resource Controller. But at this moment it is directing me to the show method rather than directing to the destroy method

2015-05-18 09:13:33Z

I have a link         this link is supposed to direct to the destroy method of the Usercontroller , this is my route Route::resource('/user', 'BackEnd\UsersController');UserController is a  Resource Controller. But at this moment it is directing me to the show method rather than directing to the destroy methodThis is because you are requesting the resources via GET method instead DELETE method. Look:Both routes have the same URL, but the header verb identifies which to call. Looks the RESTful table. For example, via ajax you can send a DELETE request:You need to send a DELETE request instead of a GET request. You can't do that with a link, so you have to use an AJAX request or a form.Here is the generic form method:If you're using Laravel 5.1 or later then you can use Laravel's built-in helpers to shorten your code:If you're using Laravel 5.6 or later then you can use the new Blade directives to shorten your code even further:You can read more about method spoofing in Laravel here.I use this template 'resources/views/utils/delete.blade.php'Called as this:If you're looking to do this via a regular link instead of through AJAX or another type of form request you can set up a special route that will respond to a normal GET request:In your routes, define this in addition to the resource:In your view:In your controller:If we need to use an anchor to trigger the destroy route, and we don't want to use ajax, we can put a form inside our link, and submit the form using the onclick attribute:If you really want to visit the destroy action on delete route by HTML, then there is an approach to use HTTP Method Spoofing which means that you could visit a delete HTTP method by adding a hidden input named _method with the value of `"DELETE". Same way can be used for "PUT" and "PATCH" HTTP method.Below is a sample for DELETE method.will get the routeif you use laravel collective, you can write this way in your views.If you want to use a link, you can use a library I have created that lets people make links that behave like POST, DELETE... calls.https://github.com/Patroklo/improved-linksIn case someone came here to find how to replace standard laravel form for delete, from button in it to link, you can just replace:TOJust replace button with simple <a href="#"... but with onclick attribute to submit the form!GET and DELETE Both routes have the same URL, but the header verb identifies which to call. Here are my code snippets for edit and delete. I use bootstrap modal confirmation for delete action BootStrap Modal

And Finally JS codeMy, non-ajax version. I use it in dropdowns (bootstrap) in resource list (datatables as well). Very short and universal.Global jQuery method:And then we can use everywhere something like this:Recommend: It's easy to integrate with confirms scripts for example swal.

Laravel / Intervention Image Class - class not found

Tomas Turan

[Laravel / Intervention Image Class - class not found](https://stackoverflow.com/questions/27374613/laravel-intervention-image-class-class-not-found)

I just installed Intervention Image Class following instructions from here: http://image.intervention.io/getting_started/installationI also added these 2 lines into config/app.php file:When I open my website, i get this error:Why is that and what should I do now?

2014-12-09 08:44:31Z

I just installed Intervention Image Class following instructions from here: http://image.intervention.io/getting_started/installationI also added these 2 lines into config/app.php file:When I open my website, i get this error:Why is that and what should I do now?Add "intervention/image": "dev-master" to the「require」section of your composer.json file.If you've got this warning:do $ composer update and then $ composer installopen the config/app.php file. Add this to the $providers array.Next add this to the $aliases array.If there is an error;try Try this, It works for me.solves definitively the problem.Try add \ symbol before Image:It helped for me on Laravel 5.3 and Intervention 2.3add new code "intervention/image": "dev-master"  in composer.json, and

cmd just write that on the controllerconfig/app.php 

providersAliasIn laravel 5.8 you can easily fix that error.first open config folder app.php file add providers then goto aliases and add the open the the if you want to image upload controller add theprovidersaliasesController

Can't get Laravel associate to work

Matthijn

[Can't get Laravel associate to work](https://stackoverflow.com/questions/26160661/cant-get-laravel-associate-to-work)

I'm not quite sure if I understand the associate method in Laravel. I understand the idea, but I can't seem to get it to work. With this (distilled) code:I get a Call to undefined method Illuminate\Database\Query\Builder::associate() when I try to run this.From what I can read, I do it exactly as is stated in the docs. What am I doing wrong?

2014-10-02 12:19:17Z

I'm not quite sure if I understand the associate method in Laravel. I understand the idea, but I can't seem to get it to work. With this (distilled) code:I get a Call to undefined method Illuminate\Database\Query\Builder::associate() when I try to run this.From what I can read, I do it exactly as is stated in the docs. What am I doing wrong?I have to admit that when I first started using Laravel the relationships where the part that I had to consistently refer back to the docs for and even then in some cases I didn't quite get it right.To help you along, associate() is used to update a belongsTo() relationship. Looking at your code, the returned class from $user->customer() is a hasOne relationship class and will not have the associate method on it.If you were to do it the other way round.It would work as $customer->user() is a belongsTo relationship.To do this the other way round you would first save the user model and then save the customer model to it like:Edit: It may not be necessary to save the user model first but I've just always done that, not sure why.As I understand it, ->associate() can onyl be called on a BelongsTo relationship. So, in your example, you could do $customer->user()->associate($user). However, in order to 'associate' a Has* relationship you use ->save(), so your code should be $user->customer()->save($customer)

Passing arguments to a filter - Laravel 4

AndrewMcLagan

[Passing arguments to a filter - Laravel 4](https://stackoverflow.com/questions/18249260/passing-arguments-to-a-filter-laravel-4)

Is it possible to access route parameters within a filter?e.g. I want to access the $agencyId parameter:I want to access this $agencyId parameter within my filter:Just for reference i call this filter in my controller as such:

2013-08-15 08:49:42Z

Is it possible to access route parameters within a filter?e.g. I want to access the $agencyId parameter:I want to access this $agencyId parameter within my filter:Just for reference i call this filter in my controller as such:Input::get can only retrieve GET or POST (and so on) arguments.To get route parameters, you have to grab Route object in your filter, like this :And get parameters (in your filter) :(just for fun)

In your routeyou can use in the parameters array 'before' => 'YOUR_FILTER' instead of detailing it in your constructor.The method name has changed in Laravel 4.1 to parameter. For example, in a RESTful controller:Another option is to retrieve the parameter through the Route facade, which is handy when you are outside of a route:

How to specify a different .env file for phpunit in Laravel 5?

Gnuffo1

[How to specify a different .env file for phpunit in Laravel 5?](https://stackoverflow.com/questions/31681914/how-to-specify-a-different-env-file-for-phpunit-in-laravel-5)

I have a .env file containing my database connection details, as is normal for Laravel 5. I want to override these for testing, which I can do in phpunit.xml. However, doing this seems to go against the philosophy of .env which is not to commit environmental configurations, particularly passwords.Is it possible to have something like .env.testing and tell phpunit.xml to read from that?

2015-07-28 16:18:41Z

I have a .env file containing my database connection details, as is normal for Laravel 5. I want to override these for testing, which I can do in phpunit.xml. However, doing this seems to go against the philosophy of .env which is not to commit environmental configurations, particularly passwords.Is it possible to have something like .env.testing and tell phpunit.xml to read from that?Copy your .env to .env.testing, then edit the .env.testing file and change the APP_ENV parameter to make it like this APP_ENV=testing this way you will be able to specify your settings int this new fileIn case you don't want to create a new .env.testing file you have to specify your variables in the phpunit.xml in the php section with the values you need, something like thisJust use the key values in the name section and the value of that key in the value section.For this example I am specifying phpunit to use an sqlite database with the name of testing.By the way in config/database.php I added this

'default' => env('DB_CONNECTION', 'mysql'), to use mysql by default unless I specify something diferent, as in this case.You could override the .env file being used in your TestCase file, where the framework is booted for testing.More specific:tests/TestCase.phpAll the tests extending TestCase will use this configuration file.Please note that any setting defined in phpunit.xml will override this configuration.Starting Laravel5.4, the createApplication function is no longer found in tests\TestCase. It has been moved to tests\CreatesApplication trait.This is 2019.I had this issues for so long until I was able to figure it out.And here is my assumption:If you are also finding it difficult to make your PHPUnit.xml talk with your .env.testing file, then you are likely using PHPStorm!If this is true, continue reading.If not, nope...this won't help.Ok...Here you go:What this does is to make all your changes in the xml file take effect.

So, go ahead, create the .env.testing file, create your preferred DB config variables for test...and try running your tests again!Create a local database on your dev machine, e.g. 'local_test_db'Create a new .env.testing file.Make sure your phpunit.xml file has at least this one env var:Lastly your base testcase (TestCase.php) should run a migration to populate the db with tables:From this linkMethod 1Step 1: Create New Test Database Connection on Database/Config.php as below:Step 2: Specify the Database Credential on .env fileStep 3: Specify test db conection to be used on phpunit.xml.Step 4: Migrate database to this new testing database - if you choose to use Database Transaction to Rollback insertion on the table.Step 5: Now, the Unit test with Database Transaction looks like below:Note: If you prefer not to use Database Transaction, you can use setup and teardown method on TestCase.php class to migrate and rollback the database as below:I can't think of a way other than temporarily renaming .env.testing to .env before the unit tests start.You could put some logic in bootstrap/autoload.php as this is what phpunit uses as it's bootstrap file before loading the application.In your app.php change the Dotenv sectionThis will work hence PHPUnit changes the env before loading your app..so if running tests you will have the env already at testingI did all the steps in @Sambhu Singh answer as well as followed his link.

But didn't work for me in L5.5When migrating, adding/setting APP_ENV to 'testing' in front of the artisan command worked for me:Been struggling with this for a few months now and just came across this Github issue today.

From the solutions proposed there, here's what you should do in your CreatesApplication.php file (to delete the cached config in order to have Laravel load the test environment):If you're still experiencing this issue after the above modification, you can go further by rebuilding the entire application as follows:This is working just fine for me.UpdatedFor Laravel 5.8 users, you may create a .env.testing file in the root of your project. Use a different db, like my_app_testing.So, it will be, in .env and in .env.testingThen, make config clear.Re-run the test. In my setup, it works.

Passing a class as function parameter

Alex

[Passing a class as function parameter](https://stackoverflow.com/questions/32614696/passing-a-class-as-function-parameter)

I'm trying to do something like this:Is it possible?To explain better what I'm trying to do. I have a helper function in Laravel to generate unique slugs, so I have to query different tables depending on where the slug is going to be saved.Actual code I'm trying to write:Thanks!

2015-09-16 17:09:16Z

I'm trying to do something like this:Is it possible?To explain better what I'm trying to do. I have a helper function in Laravel to generate unique slugs, so I have to query different tables depending on where the slug is going to be saved.Actual code I'm trying to write:Thanks!You can use the magic ::class constant:In PHP, classes (or class names) are handled as strings. Since PHP 5.5, you can use YourClass::class to get a fully qualified class name.

If you want to get it in an earlier version of php, you can (if you have already an object of the calss) either do the following:or, you can implement a static method in your class, like this:If you want to pass a class to a function, you can do it like this:orIf you need to call a non-static method of that class, you need to instanciate it:Note: You can use PHP type hinting with passed class names:I think you can.Send the class name as string parameter then use it like below.Send the class name as string parameter you need use the namespace. For example:

Storing an array of data using Redis (from Laravel)

Kalai

[Storing an array of data using Redis (from Laravel)](https://stackoverflow.com/questions/22718903/storing-an-array-of-data-using-redis-from-laravel)

I have started to work with laravel. It is quite interesting to work. I have started to use the features of laravel. I have started to use redis by install redis server in my system and change the configuration for redis in app/config/database.php file. The redis is working fine for the single variables by using set. i.e.,and i could able to get the value by usingBut i want to set the array by using set function. If i try do that getting the following error I have tried by using following codes.and if i use getting the following error Can any one explain me the problem and is that possible with redis?...we can set the array values using redis ?

2014-03-28 16:57:56Z

I have started to work with laravel. It is quite interesting to work. I have started to use the features of laravel. I have started to use redis by install redis server in my system and change the configuration for redis in app/config/database.php file. The redis is working fine for the single variables by using set. i.e.,and i could able to get the value by usingBut i want to set the array by using set function. If i try do that getting the following error I have tried by using following codes.and if i use getting the following error Can any one explain me the problem and is that possible with redis?...we can set the array values using redis ?This has been answered in the comments but to make the answer clearer for people visiting in the future.Redis is language agnostic so it won't recognise any datatype specific to PHP or any other language. The easiest way would be to serialise / json_encode the data on set then unserialise/json_decode on get.Example to store data using json_encode:Example to retrieve data using json_decode:In your controller, you can add such function:Then in your index method (or others) you can do this:Source: accepted answer and this.

Good single sign-on solution for Laravel

lesssugar

[Good single sign-on solution for Laravel](https://stackoverflow.com/questions/31241498/good-single-sign-on-solution-for-laravel)

I plan to introduce a single sign-on (SSO) to my Laravel 5 applications. Basically, I have two websites on different domains. The idea is simple: if I'm already authenticated on one of them, I don't need to sign in on the other.I've been looking for a solution for a while now, but I would like to ask you: Do you know or can recommend a package or library to provide SSO to Laravel application?Native PHP solutions are also welcome. Thanks!

2015-07-06 08:52:57Z

I plan to introduce a single sign-on (SSO) to my Laravel 5 applications. Basically, I have two websites on different domains. The idea is simple: if I'm already authenticated on one of them, I don't need to sign in on the other.I've been looking for a solution for a while now, but I would like to ask you: Do you know or can recommend a package or library to provide SSO to Laravel application?Native PHP solutions are also welcome. Thanks!You can use the SAML standard in order to solve your SSO needs.Review this github repository that help you implement a SAML service provider:

https://github.com/aacotroneo/laravel-saml2If you need to implement a SAML Identity provider you can use simpleSAMLphp and use Lavarel database as authentication source.

https://simplesamlphp.org/docs/stable/simplesamlphp-idpYou can try out the miniorange/saml-laravel-free package. It makes things quite simple as it also provides a GUI and also does the whole authentication thing own its own. 

Laravel: how to separate cache and session into different redis database?

Nemo Jia

[Laravel: how to separate cache and session into different redis database?](https://stackoverflow.com/questions/27835300/laravel-how-to-separate-cache-and-session-into-different-redis-database)

I want to put session and cache data into redis. This is my configuration in database.php:session.php:cache.php:However, where I write code like this:cache driver uses the same redis database as session driver does, which results in:Anyone knows how to force cache to use a specific redis connection? Or I have to mix them up together?

2015-01-08 07:50:45Z

I want to put session and cache data into redis. This is my configuration in database.php:session.php:cache.php:However, where I write code like this:cache driver uses the same redis database as session driver does, which results in:Anyone knows how to force cache to use a specific redis connection? Or I have to mix them up together?Here is my note, for some other guy who running in to this problem, I think this is should be in the docs.By default, redis gives you 16 separate databases, but laravel out of the box will try to use database 0 for both sessions and cache.Our solution is to let Redis caching using database 0, and database 1 for Session, there for solving the session clear by running php artisan cache:clear problem. Modify config/database.php, add session key to the redis option:Modify config/session.php, change the following:to:Modify .env, change SESSION_DRIVER:Execute the following artisan command, then check your login state:If the login state persists, voilà!Laravel 5 now supports this.https://github.com/laravel/framework/commit/d10a840514d122fa638eb5baa24c8eae4818da3eYou can select redis connection by modifying config/cache.phpLaravel 4 CacheManager does not support selecting redis connection.What you need to do is to modify/extend CacheManager and override createRedisDriver() method.Modify this line ToNow you can define your configuration in cache.phpLaravel 5.5: database.php should look like this:And in the session.php you have to update also the key "connection" to the right key. In this case 'session'

how to authenticate RESTful API in Laravel 5?

Vaibhav

[how to authenticate RESTful API in Laravel 5?](https://stackoverflow.com/questions/28829587/how-to-authenticate-restful-api-in-laravel-5)

How to authenticate RESTful API in Laravel 5?

I am using Laravel 5 to build a RESTful API & I want to use those API for mobile application.I have also seen http://laravel.com/docs/5.0/authentication

but not getting any related example so,please provide me sample example or appropriate link for authenticate RESTful API in Laravel 5.

2015-03-03 10:35:42Z

How to authenticate RESTful API in Laravel 5?

I am using Laravel 5 to build a RESTful API & I want to use those API for mobile application.I have also seen http://laravel.com/docs/5.0/authentication

but not getting any related example so,please provide me sample example or appropriate link for authenticate RESTful API in Laravel 5.I was looking for the same answer and I found this link very useful with detailed information and usage for L5 with the use of JWT . JSON Web TokenHope it helps you too.The Concept to use here would be Middleware:

To get you started, put this in your API-Controller's ctors:Your app should then be able to call the resources like

Get instance of subtype of a model with Eloquent

ClmentM

[Get instance of subtype of a model with Eloquent](https://stackoverflow.com/questions/60191688/get-instance-of-subtype-of-a-model-with-eloquent)

I have an Animal model, based on the animal table.This table contains a type field, that can contain values such as cat or dog.I would like to be able to create objects such as :Yet, being able to fetch an animal like this :But where $animal would be an instance of Dog or Cat depending on the type field, that I can check using instance of or that will work with type hinted methods. The reason is that 90% of the code is shared, but one can bark, and the other can meow.I know that I can do Dog::find($id), but it's not what I want : I can determine the type of the object only once it was fetched. I could also fetch the Animal, and then run find() on the right object, but this is doing two database calls, which I obviously don't want.I tried to look for a way to "manually" instantiate an Eloquent model like Dog from Animal, but I could not find any method corresponding. Any idea or method I missed please ?

2020-02-12 15:26:24Z

I have an Animal model, based on the animal table.This table contains a type field, that can contain values such as cat or dog.I would like to be able to create objects such as :Yet, being able to fetch an animal like this :But where $animal would be an instance of Dog or Cat depending on the type field, that I can check using instance of or that will work with type hinted methods. The reason is that 90% of the code is shared, but one can bark, and the other can meow.I know that I can do Dog::find($id), but it's not what I want : I can determine the type of the object only once it was fetched. I could also fetch the Animal, and then run find() on the right object, but this is doing two database calls, which I obviously don't want.I tried to look for a way to "manually" instantiate an Eloquent model like Dog from Animal, but I could not find any method corresponding. Any idea or method I missed please ?You can use the Polymorphic Relationships in Laravel as explained in Official Laravel Docs. Here is how you can do that.Define the relationships in the model as givenHere you'll need two columns in the animals table, first is animable_type and another is animable_id to determine the type of model attached to it at runtime.You can fetch the Dog or Cat model as given,After that, you can check the $anim object's class by using instanceof.This approach will help you for future expansion if you add another animal type (i.e fox or lion) in the application. It will work without changing your codebase. This is the correct way to achieve your requirement. However, there is no alternative approach to achieve polymorphism and eager loading together without using a polymorphic relationship. If you don't use a Polymorphic relationship, you'll end up with more then one database call. However, if you have a single column that differentiates the modal type, maybe you have a wrong structured schema. I suggest you improve that if you want to simplify it for future development as well. Rewriting the model's internal newInstance() and newFromBuilder() isn't a good/recommended way and you have to rework on it once you'll get the update from framework.If you really want to do this, you could use the following approach inside your Animal model.As the OP stated inside his comments: The database design is already set and therefore Laravel's Polymorphic Relationships seems not to be an option here.I like the answer of Chris Neal because I had to do something similar recently (writing my own Database Driver to support Eloquent for dbase/DBF files) and gained a lot experience with the internals of Laravel's Eloquent ORM.I've added my personal flavour to it to make the code more dynamic while keeping an explicit mapping per model.Supported features which I quickly tested:Disadvantages:I hope it helps and I'm up for any suggestions, questions and additional use-cases in your scenario. Here are the use-cases and examples for it: And this is an example of how it can be used and below the respective results for it:which results the following:And in case you want you use the MorphTrait here is of course the full code for it: I think you could override the newInstance method on the Animal model, and check the type from the attributes and then init the corresponding model.You'll also need to override the newFromBuilder method.I think I know what you're looking for. Consider this elegant solution which uses Laravel query scopes, see https://laravel.com/docs/6.x/eloquent#query-scopes for additional information:(same applies to another class Cat, just replace the constant)The global query scope acts as a default query modification, such that the Dog class will always look for records with type='dog'.Say we have 3 records:Now calling Dog::find(1) would result in null, because the default query scope will not find the id:1 which is a Cat. Calling Animal::find(1) and Cat::find(1) will both work, although only the last one gives you an actual Cat object.The nice thing of this setup is that you can use the classes above to create relations like:And this relation will automatically only give you all the animals with the type='dog' (in the form of Dog classes). The query scope is automatically applied.In addition, calling Dog::create($properties) will automatically set the type to 'dog' due to the saving event hook (see https://laravel.com/docs/6.x/eloquent#events).Note that calling Animal::create($properties) does not have a default type so here you need to set that manually (which is to be expected).Although you are using Laravel, in this case, I think you should not stick to Laravel short-cuts.This problem you are trying to solve is a classic problem that many other languages/frameworks solve using Factory method pattern (https://en.wikipedia.org/wiki/Factory_method_pattern).If you want to have your code easier to understand and with no hidden tricks, you should use a well-known pattern instead of hidden/magic tricks under the hood.The easiest way yet is to make method in Animal classResolving modelThis will return instance of class Animal, Dog or Cat depending on model type

(Laravel) Dynamic dependency injection for interface, based on user input

JuanDMeGon

[(Laravel) Dynamic dependency injection for interface, based on user input](https://stackoverflow.com/questions/36853791/laravel-dynamic-dependency-injection-for-interface-based-on-user-input)

I am currently facing a very interesting dilemma with my architecture and implementation.I have an interface called ServiceInterface which have a method called execute()Then I have two different implementations for this interface: Service1 and Service2, which implements the execute method properly.I have a controller called MainController and this controller has a "type-hint" for the ServiceInterface (dependency injection), it means that both, Service1 and Service2, can be called as resolution for that dependency injection.Now the fun part:I do not know which of those implementations to use (Service1 or Service2) because I just know if I can use one or other based on a user input from a previous step.It means the user choose a service and based on that value I know if a can use Service1 or Service2.I am currently solving the dependency injection using a session value, so depending of the value I return an instance or other, BUT I really think that it is not a good way to do it.Please, let me know if you faced something similar and, how do you solve it, or what can I do to achieve this in the right way.Thanks in advance. Please let me know if further information is required.

2016-04-26 01:24:05Z

I am currently facing a very interesting dilemma with my architecture and implementation.I have an interface called ServiceInterface which have a method called execute()Then I have two different implementations for this interface: Service1 and Service2, which implements the execute method properly.I have a controller called MainController and this controller has a "type-hint" for the ServiceInterface (dependency injection), it means that both, Service1 and Service2, can be called as resolution for that dependency injection.Now the fun part:I do not know which of those implementations to use (Service1 or Service2) because I just know if I can use one or other based on a user input from a previous step.It means the user choose a service and based on that value I know if a can use Service1 or Service2.I am currently solving the dependency injection using a session value, so depending of the value I return an instance or other, BUT I really think that it is not a good way to do it.Please, let me know if you faced something similar and, how do you solve it, or what can I do to achieve this in the right way.Thanks in advance. Please let me know if further information is required.Finally after some days researching and thinking alot about the best approach for this, using Laravel I finally solved.I have to say that this was specially difficult in Laravel 5.2, because in this version the Session middleware only is executed in the controllers used in a route, it means that if for some reason I used a controller (not linked for a rote) and try to get access to the session it is not going to be possible.So, because I can not use the session I decided to use URL parameters, here you have the solution approach, I hope some of you found it useful.so, you have an interface:Then a couple of implementations for the interface:The service one:The service two.Now the interesting part: have a controller with a function that have a dependency with the Service interface BUT I need to resolve it dinamically to ServiceOne or ServiceTwo based in a use input. So:The controllerPlease note that ServiceRequest, validated that the request already have the parameter that we need to resolve the dependency (call it 'service_name')Now, in the AppServiceProvider we can resolve the dependency in this way:So now all the responsibilty is for the Resolver class, this class basically use the parameter passed to the contructor to return the fullname (with namespace) of the class that is going to be used as a implementation of the Service interface:Well, I really hope it help to some of you.Best wishes!---------- EDIT -----------I just realize, that it is not a good idea to use directly the request data, inside the container of Laravel, it really is going to make some trouble in the long term.The best way is to directly register all the possible instances suported (serviceone and servicetwo) and then resolve one of them directly from a controller or a middleware, so then is the controller "who  decides" what service to use (from all the available) based on the input from the request.At the end it works at the same, but it is going to allow you to work in a more natural way.I have to say thanks to rizqi. A user from the questions channel of the slack chat of Laravel.He personally created a golden article about this. Please read it because solve this issue completely and in a very right way.laravel registry patternThe fact that you define that your controller works with ServiceInterface is okIf you have to choose the concrete implementation of the service basing on a previous step  (that, as i've understood, happens in a previous request) storing the value in session or in database is right too, as you have no alternative: to choose the implementation you have to know the value of the inputThe important point is to 'isolate' the resolution of the concrete implementation from the input value in one place: for example create a method that takes this value as a parameter and returns the concrete implementation of the service from the value:and in your controller:In this example i've used a different class to store the method, but you can place the method in the controller or use a Simple Factory pattern, depending on where the service should be resolved in your applicationIt's an interesting problem. I'm currently using Laravel 5.5 and have been mulling it over. I also want my service provider to return a specific class (implementing an interface) based upon user input. I think it's better to manually pass the input from the controller so it's easier to see what's going on. I would also store the possible values of the class names in the config.

So based upon the Service classes and interface you've defined above i came up with this:/config/services.php/app/Http/Controllers/MainController.php/app/Http/Requests/ServiceRequest.php/app/Providers/CustomServiceProvider.phpThis way we can validate the input to ensure we are passing a valid service, then the controller handles passing the input from the Request object into the ServiceProvider. I just think when it comes to maintaining this code it will be clear what is going on as opposed to using the request object directly in the ServiceProvider.

PS Remember to register the CustomServiceProvider!I find the best way to deal with this is using a factory pattern. You can create a class say ServiceFactory and it has a single method create() it can accept an argument which is used to dynamically choose which concrete class to instantiate.It has a case statement based on the argument. It will use App::make(ServiceOne::class) or App::make(ServiceTwo::class).depending on which one is required. You are then able to inject this into your controller (or service which depends on the factory). You can then mock it in a service unit test.

Laravel eloquent get relation count

Vincent Decaux

[Laravel eloquent get relation count](https://stackoverflow.com/questions/41165726/laravel-eloquent-get-relation-count)

I use Laravel 5.3. I have 2 tables :AndI have defined my relations in my models : Is there an easy way using Eloquent to have a list a categories with count of articles. The difficulty is that I want to group categories where id_parent = 0, i.e. I want to display only parent categories with count of articles in children.I tried something like that :But I am lost...

2016-12-15 13:45:52Z

I use Laravel 5.3. I have 2 tables :AndI have defined my relations in my models : Is there an easy way using Eloquent to have a list a categories with count of articles. The difficulty is that I want to group categories where id_parent = 0, i.e. I want to display only parent categories with count of articles in children.I tried something like that :But I am lost...you can use withCount(). It is available from 5.3 versionfor more info about eloquent visit : https://laravel.com/docs/5.3/eloquent-relationshipsYou can use the hasManyThrough() Eloquent method to fetch all of the childrens' Articles, then add the article counts together in a nice little getter. I added the getter to the $appends array on the model to help illustrate it in the Tinker output.Here's the Tinker output:If you want to restrict your Category query to ones that have children that have articles, you could do that using the has() method:Here's more on the has() method:https://laravel.com/docs/5.3/eloquent-relationships#querying-relationship-existenceAnd the hasManyThrough() method:https://laravel.com/docs/5.3/eloquent-relationships#has-many-throughDefine a articles() relation in your Category model as:Then you can try it as:This should work:The above query will get you category IDs and count of all articles that belong to the category.After reading your question and comments again, if I understand correctly you want to get the count of all articles that belong to those categories (with parent_id = 0) + the count of articles that belong to sub categories (those with parent_id = (id of some category)).Now I have no way of testing this easily, but I think something along these lines should work for that.That beign said, I think you're better of having a column named count in categories and update it each time a new article gets added. For performance.I am sure somebody is still going through this, I was able to solve it the following way, suppose I have an Agent model and a Schedule model, i.e. one agent may have many schedules:Well some agents may not necessarily have schedules assigned, thus, I filtered those before calling the with() method, like this:Hope this helps!.

How to break a foreach loop in laravel blade view?

Sagar Gautam

[How to break a foreach loop in laravel blade view?](https://stackoverflow.com/questions/45189524/how-to-break-a-foreach-loop-in-laravel-blade-view)

I have a loop like this:I want to break the loop after data display if condition is satisfied.How it can be achieved in laravel blade view ?

2017-07-19 11:43:20Z

I have a loop like this:I want to break the loop after data display if condition is satisfied.How it can be achieved in laravel blade view ?From the Blade docs:By default, blade doesn't have @break and @continue which are useful to have. So that's included.Furthermore, the $loop variable is introduced inside loops, (almost) exactly like Twig.you can break like this   

Laravel: Difference Between Route Middleware and Policy

James Okpe George

[Laravel: Difference Between Route Middleware and Policy](https://stackoverflow.com/questions/35019292/laravel-difference-between-route-middleware-and-policy)

I am developing an app with laravel, I realised that what can be done with Policy can exactly be done with Middleware. Say I want to prevent a user from updating a route if he/she is not the owner of the information, I can easily check from the route and can do the same from the policy.So my question is why should I use policy over middleware and vice versa

2016-01-26 16:50:45Z

I am developing an app with laravel, I realised that what can be done with Policy can exactly be done with Middleware. Say I want to prevent a user from updating a route if he/she is not the owner of the information, I can easily check from the route and can do the same from the policy.So my question is why should I use policy over middleware and vice versaI'm currently going through a small refactor with my roles, permissions and routes and asked myself the same question. At the surface level, it appears true middleware and policies perform the same general idea. Check if a user can do what they are doing.For reference here's the laravel docs...Middleware 

"May I see this? May I go here?"https://laravel.com/docs/master/middleware#introductionIn my reading, Middleware is about operating at the request level. In the terms of "Can this user see a page?", or "Can this user do something here?" If so, it goes to the controller method associated with that page. Interestingly enough, Middleware may say, "Yes you may go there, but I'll write down that you are going." Etc.Once it's done. It has no more control or say in what the user is doing. Another way I think of it as the middleperson. Policies 

"Can I do this? Can I change this?"https://laravel.com/docs/master/authorization#introductionPolicies however, appear to be more concerned with doing. Can the user update any entry, or only theirs?These questions seem fit for a controller method where all the calls to action on a resource are organized. Retrieve this object, store or update the article. As tjbb mentioned, middleware can make routes very messy and hard to manage. This is an example from my routes file:The problemThis gets very hard to read in my route file!Another approach with policiesRoute middleware allows you to apply request handling to a large range of routes, instead of repeating the code in every controller action - checking authentication and redirecting guests is a good example. Controllers instead contain logic unique to specific routes/actions - you could use middleware for this, but you'd need separate middleware for every route's logic and it would all get very messy.Policies/abilities are simply a way of checking user permissions - you can query them from a controller, or from middleware, or anywhere else. They only return true or false, so they aren't equivalent to controllers or middleware. Most of the time abilities will be comparing a user to another model, which will have been loaded based on an identifier sent to a controller action, but there are probably some applications for use with middleware too.

Guzzle: handle 400 bad request

mwafi

[Guzzle: handle 400 bad request](https://stackoverflow.com/questions/25040436/guzzle-handle-400-bad-request)

I'm using Guzzle in Laravel 4 to return some data from another server, but I can't handle Error 400 bad requestusing:how to solve it?

thanks,

2014-07-30 15:10:07Z

I'm using Guzzle in Laravel 4 to return some data from another server, but I can't handle Error 400 bad requestusing:how to solve it?

thanks,As written in Guzzle official documentation: http://guzzle.readthedocs.org/en/latest/quickstart.htmlFor correct error handling I would use this code:Use http_errors => false option with the request.

Is there any way to validate a foreign key using Laravel's Validation syntax?

ReactingToAngularVues

[Is there any way to validate a foreign key using Laravel's Validation syntax?](https://stackoverflow.com/questions/29611807/is-there-any-way-to-validate-a-foreign-key-using-laravels-validation-syntax)

Say I have an object which relates to a mission. Users can upload objects and say that it has a relationship with one of these missions. Is there anyway to check that the mission_id that the user has selected for this object actually exists in this database using Laravel's Validation class and rules?This way, I can check that mission_id is not only an integer, but also exists in the database.For example, I guess I'm looking for something like:Where foreignKeyExistsInMissions is the validation rule I'm looking for. 

2015-04-13 17:51:51Z

Say I have an object which relates to a mission. Users can upload objects and say that it has a relationship with one of these missions. Is there anyway to check that the mission_id that the user has selected for this object actually exists in this database using Laravel's Validation class and rules?This way, I can check that mission_id is not only an integer, but also exists in the database.For example, I guess I'm looking for something like:Where foreignKeyExistsInMissions is the validation rule I'm looking for. This should work:And the message:Source (v4.2 docs)Source (v5.5 docs)

Laravel 5.3 Storage::put creates a directory with the file name

zundi

[Laravel 5.3 Storage::put creates a directory with the file name](https://stackoverflow.com/questions/40002275/laravel-5-3-storageput-creates-a-directory-with-the-file-name)

I'm using Laravel's file storage functionality to save a file:This does save the file, but inside a directory named the same as the file, for example:storage/app/952d6c009.jpg/952d6c009.jpgorstorage/app/234234234.jpg/234234234.jpgIs this expected? Is there any way to just store the file without a separate directory for each file?Thanks!

2016-10-12 15:16:43Z

I'm using Laravel's file storage functionality to save a file:This does save the file, but inside a directory named the same as the file, for example:storage/app/952d6c009.jpg/952d6c009.jpgorstorage/app/234234234.jpg/234234234.jpgIs this expected? Is there any way to just store the file without a separate directory for each file?Thanks!you need to provide the file contents in the second argument not file object, try this:Storage::disk('local')->put($newFilename, file_get_contents($file));This happened because you specify the directory to store as filename. The newFilename, should be the directory name such as 'images'. Refer to this lineSo you could change this toThen you will get the path stored at storage/app/images/234234234.jpg$file is encoded.You have to unencode the file.Storage::disk('local')->put($newFilename, File::get($file));

Read file contents with Laravel

Cheskq

[Read file contents with Laravel](https://stackoverflow.com/questions/26730861/read-file-contents-with-laravel)

I am trying to read the contents of a file line by line with Laravel.

However, I can't seem to find anything about it anywhere.Should I use the fopen function or can I do it with the File::get() function?I've checked the API but there doesn't seem to have a function to read the contents of the file.

2014-11-04 08:43:38Z

I am trying to read the contents of a file line by line with Laravel.

However, I can't seem to find anything about it anywhere.Should I use the fopen function or can I do it with the File::get() function?I've checked the API but there doesn't seem to have a function to read the contents of the file.You can use simple PHP:You can use the following to get the contents:Which will return a Illuminate\Filesystem\FileNotFoundException if it's not found. If you want to fetch something remote you can use: Which will return false if not found. When you have the file you don't need laravel specific methods for handling the data. Now you need to work with the content in php. If you wan't to read the lines you can do it like @kylek described: You can use

if else condition in blade file (laravel 5.3)

user3386779

[if else condition in blade file (laravel 5.3)](https://stackoverflow.com/questions/40122633/if-else-condition-in-blade-file-laravel-5-3)

I want to check if else condition in my blade file.

 I want to check $user->status =='waiting' as code given below.output return correctly what I expect.But along with my output I caught curly braces {} printed above.I to remove curly brace.Is anything wrong in my if condition

2016-10-19 05:11:17Z

I want to check if else condition in my blade file.

 I want to check $user->status =='waiting' as code given below.output return correctly what I expect.But along with my output I caught curly braces {} printed above.I to remove curly brace.Is anything wrong in my if conditionNo curly braces required you can directly writeI think you are putting one too many curly brackets. Try this

best way for managing uploaded files in my editor?

k90mirzaei

[best way for managing uploaded files in my editor?](https://stackoverflow.com/questions/52734396/best-way-for-managing-uploaded-files-in-my-editor)

I'm working on a social blog that has an editor built in JavaScript for creating a blog by a user. One of my biggest issues is uploading files and its limitations. Right now for auto-saving user posts, I store images uploaded simultaneously to the server. But the problem is when the user deletes images from the editor because:My editor is a customized version of ckeditor5, and for uploading files, I use an uploadadapter like :

2018-10-10 06:59:00Z

I'm working on a social blog that has an editor built in JavaScript for creating a blog by a user. One of my biggest issues is uploading files and its limitations. Right now for auto-saving user posts, I store images uploaded simultaneously to the server. But the problem is when the user deletes images from the editor because:My editor is a customized version of ckeditor5, and for uploading files, I use an uploadadapter like :IMHO first you should define your goals, then search for the solution.Managing images removed from the content can be tricky depending on the needs. For example, if you want to keep track changes and allow users to re-use uploaded images in other posts - before removing any image from the storage you should check all posts and all versions if they do not contain this image anymore. OTOH if you don't care about versions and do not allow users to re-use images - then you can remove any image just after it's removed from the content.Nowadays storage is cheap, so I wouldn't bother that much about keeping some extra images that are not used anymore. And what's more important - I wouldn't add the clean-up to the main flow. Rather than that - create a dedicated, repeated job for scanning the content and removing unused images. To make it more robust I would save the image usages in some kind of database. This way it would be much easier to perform the clean-up.There are out-of-the-box paid solutions like EasyImage (upload, re-scale and optimize images to the CDN), or CKFinder (fully-featured file manager).Although, depending on your needs you may need to tune those solutions anyway. For example, if you have a file manager then maybe you would like to block deleting files if they are used anywhere. So additional work on some plugin might be needed.Steps i followed when i inserting images with other contents:Collected all the images from editor Here i receiving the images as base64. thats why i needed to decode them and store separately When i delete or update the content i just remove all the images which i received in $imagePaths array previously and stored.When i worked on this, i followed this documentationHere i shared full controller script.I used the below to embed the images as base64 instead of uploading themIt seems like that you just need an extra hidden input which records all uploaded successfully images and do a little compare with the image`s urls in the editor after user posted the form, and then you will get the image list to be deleted.

I wish I had expressed my mean clearly.

Random RuntimeException: The only supported ciphers are AES-128-CBC and AES-256-CBC with the correct key length

Raul

[Random RuntimeException: The only supported ciphers are AES-128-CBC and AES-256-CBC with the correct key length](https://stackoverflow.com/questions/41551622/random-runtimeexception-the-only-supported-ciphers-are-aes-128-cbc-and-aes-256)

I have same problem with Laravel 5.3 (on windows server). I did all possible attempts: checked .env file, config, artisan new key generation, cache: clear, config: clear, composer update, but the problem randomly persists.Note that the same code with exactly same version of apache, mysql, php, doesn't generate this problem on Mac OS.I found that the key (first parameter of Encrypter constractor) arrives "sometimes" empty and of course it fails. Most of the times the key is correct, but randomly the key arrives empty from EncryptionServiceProvider that in turns asks it to the app config.So the only solution that worked for me was to add an if ($key) in EncryptionServiceProvider so that the Encryption constructor doesn't get called with empty key.Of course is not a "clean" solution nor it explains the problem, but at least avoids to find the log file filled with the error: If this is a Laravel bug I don't know, but of course if someone could explain this I will be more then happy to know.Below is my modified class: I just added the if ($key) line before new Encrypter:Further details and backtrace log:Of course, as I wrote I checked, .env file, config, artisan new key generation, cache: clear, config: clear, composer update.

This stuff is ok since it works 99% of the time but randomly I get the error.Here the back trace:Stack trace:

2017-01-09 15:44:08Z

I have same problem with Laravel 5.3 (on windows server). I did all possible attempts: checked .env file, config, artisan new key generation, cache: clear, config: clear, composer update, but the problem randomly persists.Note that the same code with exactly same version of apache, mysql, php, doesn't generate this problem on Mac OS.I found that the key (first parameter of Encrypter constractor) arrives "sometimes" empty and of course it fails. Most of the times the key is correct, but randomly the key arrives empty from EncryptionServiceProvider that in turns asks it to the app config.So the only solution that worked for me was to add an if ($key) in EncryptionServiceProvider so that the Encryption constructor doesn't get called with empty key.Of course is not a "clean" solution nor it explains the problem, but at least avoids to find the log file filled with the error: If this is a Laravel bug I don't know, but of course if someone could explain this I will be more then happy to know.Below is my modified class: I just added the if ($key) line before new Encrypter:Further details and backtrace log:Of course, as I wrote I checked, .env file, config, artisan new key generation, cache: clear, config: clear, composer update.

This stuff is ok since it works 99% of the time but randomly I get the error.Here the back trace:Stack trace:The issue occurs when using thread-safe versions of PHP on multi-threaded web servers, instead of multi-process web servers. You can read about the issue a little more on the Github issue here, Github issue here, and a PHP bug report here. There are a few more links, but they are just branched off from those few I posted.The basic gist is that with the multi-threaded web server, you have a single process that handles multiple threads. However, the putenv()/getenv() methods are not thread safe, and change environment variables at the process level, so all threads under that process are affected.So, you end up with something like this: (as described in this issue):So, request 1 comes in, loads the environment fine, and gets to work. While request 1 is working, request 2 comes in and starts on another thread. Before request 2 reads the environment variables, request 1 finishes and PHP clears out all variables set by putenv(). Now, request 2 attempts to read the environment, but gets null because the variables were cleared when request 1 finished.This issue can be mitigated in two ways:I installed Laravel 5.3 and I didn't found a .env file there. And boom.... That was the issue. I created .env file in root of application and ran in terminal and it generated base 64 encoded string in terminal. Copy that string in to .env file aswhere **** is generated encoded string. Run application again and it should work.It is so simple, copy the APP_KEY from .env file to config/app.php -> key or run command below:php artisan key:generate

403 Forbidden on nginx/1.4.6 (Ubuntu) - Laravel

cyber8200

[403 Forbidden on nginx/1.4.6 (Ubuntu) - Laravel](https://stackoverflow.com/questions/33443918/403-forbidden-on-nginx-1-4-6-ubuntu-laravel)

I keep getting 403 ForbiddenMy settings:/etc/nginx/sites-available/defaultdefaultUpdateI followed this instruction : here Any hints/suggestions on this will be a huge help ! 

2015-10-30 19:53:55Z

I keep getting 403 ForbiddenMy settings:/etc/nginx/sites-available/defaultdefaultUpdateI followed this instruction : here Any hints/suggestions on this will be a huge help ! You need to specify an absolute path for your root directive. Nginx uses the directory set at compile time using the --prefix switch. By default this is /usr/local/nginx.What this means is that your root, which is currently set to root home/laravel-app/ causes nginx to look for files at /usr/local/nginx/home/laravel-app/ which presumably isn't where your files are.If you set your root directive to an absolute path such as /var/www/laravel-app/public/ nginx will find the files.Similarly you'll note that I added /public/ to the path above. This is because Laravel stores it's index.php file there. If you were to just point at /laravel-app/ there's no index file and it'd give you a 403.you need to have a rule for php files (in the default file)The error you added in your update indicates that nginx is attempting a directory index from your ssc-portal folder. Since you appear to be using a basic nginx installation, the only reason a directory index should fail here is if nginx is unable to find the listed index options.In your server block, you are telling nginx to try the following locations in order when a directory listing is requested (a URI that ends with a trailing slash): index.php, index.html, then index.htm.If none of those files is found, the directory index request fails.My best guess is you have your index.php file in the wrong place. Did you move it up from the ssc-portal folder?

Rate limiting yourself from overloading external API's

williamvicary

[Rate limiting yourself from overloading external API's](https://stackoverflow.com/questions/31195934/rate-limiting-yourself-from-overloading-external-apis)

I found a lot of information and script examples around that showed how to rate limit the users of an API but I wasn't able to find any examples of how to rate limit your own requests of an API when these limits are imposed.I've always rate limited my scripts with code such as sleep or usleep commands but it feels like an inefficient way of doing things, especially when the API endpoints have pretty high rate limits and hammering API's until you hit the limits is also inefficient.For example, Google's API limits vary based on the API you are using and can increase/decrease, in this case a fixed rate limit hard coded into the code just seems like primitive guess work!Have I missed something pretty obvious? Or is this just not as common as I expect it to be?

2015-07-02 22:56:27Z

I found a lot of information and script examples around that showed how to rate limit the users of an API but I wasn't able to find any examples of how to rate limit your own requests of an API when these limits are imposed.I've always rate limited my scripts with code such as sleep or usleep commands but it feels like an inefficient way of doing things, especially when the API endpoints have pretty high rate limits and hammering API's until you hit the limits is also inefficient.For example, Google's API limits vary based on the API you are using and can increase/decrease, in this case a fixed rate limit hard coded into the code just seems like primitive guess work!Have I missed something pretty obvious? Or is this just not as common as I expect it to be?Okay, for giggles I've thrown together a limiter class that will allow you to specify the limit per second, minute and hour.  I can't resist having a good reason to use a circular queue!If you have multiple processes doing the consumption, whether simultaneous or not, you'll have to devise a way to store and/or share the usage history on your own.In order to demonstrate it in action I've put in some "verbose mode" statements in the limit checking function.  Here is some sample output.Well, first things first - you should call any external API's only when you actually need to - the providers will thank you dearly.There is two ways I usually "impose" a limit on my own API usage - if possible, cache the result for N amount of time, usually a lot less than hard limit of the API itself. This, however, works only in very specific cases.The second is persistent/semi-persistent counters, where you store a counter in some sort of memory backend along with time when the limiting period begins. Every time before calling API check the storage and see whether the current time minus interval begin and number of requests you have already made is less than imposed by API. If it is, you can make a request - if the interval is larger, you can reset the limit, and if your next request will exceed the limit, and you are still in the previous interval, you can show a pretty error. On each external request then update the interval time if it's exceeded and increment the counter.I think we can not answer your question in a few sentences . It takes a true reflection of architecture linked to your application . For me to make an API rate limit for repeat I use caches that store values ​​and utilization of my API. I have to date found no code ready .

「There are no commands defined in the 'command' namespace.」after running command:make in Laravel

Zbigniew Kisły

[「There are no commands defined in the 'command' namespace.」after running command:make in Laravel](https://stackoverflow.com/questions/32396158/there-are-no-commands-defined-in-the-command-namespace-after-running-comman)

Just like in title. I'm trying to run from artisanbut all I see isAny idea what is this?

2015-09-04 10:45:58Z

Just like in title. I'm trying to run from artisanbut all I see isAny idea what is this?You have misplaced the command it isand not If you have simply write php artisan within your command prompt it'll show you the list of commands over there have a lookAs the documentation says (Current version is 5.2 at this moment): in the Kernel.php file you must add:

    protected $commands = [

      Commands\NameOfCommand::class

    ];

(ref: https://laravel.com/docs/5.2/artisan#registering-commands)In laravel 5.2 use php artisan make:console NameOfCommand

How to format PHP files with HTML markup in Visual Studio Code?

progonkpa

[How to format PHP files with HTML markup in Visual Studio Code?](https://stackoverflow.com/questions/41330707/how-to-format-php-files-with-html-markup-in-visual-studio-code)

I'm using Laravel so all the views are .blade.php files. Visual Studio Code won't format the HTML because of the PHP extension. I removed the blade part of the filename, but it still isn't formatting the files properly (via Alt+Shift+F).I also tried about five extensions but none of them do the reformatting.How can I format .blade.php files in Visual Studio Code?

2016-12-26 11:40:07Z

I'm using Laravel so all the views are .blade.php files. Visual Studio Code won't format the HTML because of the PHP extension. I removed the blade part of the filename, but it still isn't formatting the files properly (via Alt+Shift+F).I also tried about five extensions but none of them do the reformatting.How can I format .blade.php files in Visual Studio Code?The extension beautify just do it very well, either add php and any other file extension type to the config as said above here is an example : 

OTHERWISE: you can also do it directly, type F1 then write beautify, the auto completion give you two choices beautify selection or beautify file. Choose the one you need, and it will do the job. that's a straight direct way.You can also add a keybinding to have a keyboard shortcut, here how to do it:choose any key you want, and make sure you don't override and existing one, search first in the left side if it exist or not.note that all of those things are well documented on the description of the extension.Beautify does solve this problem! Many people add "blade.php" and "php" to HTML config Beautify does not recognize and manually choose HTML template. Instead just adding "blade" to HTML config fix all issues.I think beautify might do the trick. Just add 'php' and/or 'blade.php' to the HTML section of its config to beautify PHP / Blade view files. Works for me!If you want something that just works out the box, adds the format nested HTML in PHP files support vscode should already have.Uses all the native settings for html.format, format on save, etc. Give the extension Format HTML in PHP a try. I made it because every other solution made me annoyed because it didn't work 100%.I found this extension called Format HTML in PHP that works well for me.This can be done by using html formatting for .blade.php Andrew Schultz mentioned the extension: "[Format HTML in PHP][1]"

[1]: https://marketplace.visualstudio.com/items?itemName=rifi2k.format-html-in-php. This is indeed a great extension for format PHP files with html markup. It also format js included in PHP files. Moreover. Good news! The developer is already working successfully to include Laravel blade.php files. In the meantime I format Laravel blade files on vscode by switching language manually from blade to php then I use the extension "[Format HTML in PHP][1]" with CTRL+ALT+F or right click. It works great for me.  

Laravel belongsToMany exclude pivot table

Patrick Reck

[Laravel belongsToMany exclude pivot table](https://stackoverflow.com/questions/26474201/laravel-belongstomany-exclude-pivot-table)

I have two models, User and Badge. A user can have multiple badges, and a badge can belong to multiple users. (using a pivot table)Currently I am getting the data I need, but additionally I am getting the pivot table along. How do I exclude this?Here's the User model:And the Badge model:

2014-10-20 20:20:43Z

I have two models, User and Badge. A user can have multiple badges, and a badge can belong to multiple users. (using a pivot table)Currently I am getting the data I need, but additionally I am getting the pivot table along. How do I exclude this?Here's the User model:And the Badge model:Add pivot to your $hidden property's array in your model(s).And same with your User modelOr you can still hide the pivot on demand this way... 

Where to place Blade::extend

Vincent

[Where to place Blade::extend](https://stackoverflow.com/questions/18329541/where-to-place-bladeextend)

I want to add the following code to my laravel project to support the break and continue statements in blade.This is the code:I have no idea however where to place it, any help would be appreciated?

2013-08-20 07:43:07Z

I want to add the following code to my laravel project to support the break and continue statements in blade.This is the code:I have no idea however where to place it, any help would be appreciated?There's no requirement telling you where you should put the code, you could even put it in your routes.php (which is a bit messy of course). You only have to make sure that it's loaded when laravel processes a page view.In this case, creating a new file blade_extensions.php somewhere and including it in start/global.php might be a good solution.PS: Be sure to clear out your compiled views, as Blade only recompiles the views if it detects a change, so if you've just plonked in this code it won't work until you clear out the views.1) create app/Providers/BladeServiceProvider.php2) in config/app.php add3) run php artisan clear-compiled4) in your template use @datetime($updated_at) or @eval($var = 1), @eval($var++) for example5) important remarka) run php artisan clear-compiled might be helpfulb) I changed the code for$pattern = $compiler->createOpenMatcher('datetime');andreturn preg_replace($pattern, '$1<?php echo $2->format(\'m/d/Y H:i\')); ?>', $view);because the example from the Laravel 5 Documentation will not work.The example is corrected now.The example was removed.Laravel 5 update:1) You may want to create Extensions\BladeExtensions.php folder\file on the same level as Models, Providers, Services folders2) BladeExtensions.php3) AppServiceProvider.php

Check if row exists, Laravel

O P

[Check if row exists, Laravel](https://stackoverflow.com/questions/25209302/check-if-row-exists-laravel)

I have the following db structure:On my items permalink pages, I have an 'Add to favorites' button which inserts a new row into user_favoritesI want to be able to replace it for a 'Remove from favorites' button if the user already has it in their favorites.I can't figure out the logic behind this - do I need to check if a row exists in user_favorites that has the current user's id and the permalink item id? This did not work for me:

2014-08-08 17:46:07Z

I have the following db structure:On my items permalink pages, I have an 'Add to favorites' button which inserts a new row into user_favoritesI want to be able to replace it for a 'Remove from favorites' button if the user already has it in their favorites.I can't figure out the logic behind this - do I need to check if a row exists in user_favorites that has the current user's id and the permalink item id? This did not work for me:You may want something like this:I advise you to use exists() or count() to check, not use first().The fastest way:Or:SQL:The faster way: only select idSQL:The normal way:SQL:Let User_favorite be a model that accesses your user_favorites tableThe simplest way to do is to use toggle() method of many-to-many relationship.e.g.It also returns an array which tells you if the ID is attached or detached in DB.

Laravel - Where relationship column equals?

VoiD HD

[Laravel - Where relationship column equals?](https://stackoverflow.com/questions/43105870/laravel-where-relationship-column-equals)

I am trying to grab all records where Player's relationship called stats() has a column value of something. I would usually do ::where('column_name' 'column_value') for the players table, but how can I get ::where the relationship table's column equals to something?But I want to check a column in the relationships table?

2017-03-29 23:20:42Z

I am trying to grab all records where Player's relationship called stats() has a column value of something. I would usually do ::where('column_name' 'column_value') for the players table, but how can I get ::where the relationship table's column equals to something?But I want to check a column in the relationships table?This will filter Player based on a related table

Laravel 4 - two submit buttons in one form and have both submits to be handled by different actions

Abhay PS

[Laravel 4 - two submit buttons in one form and have both submits to be handled by different actions](https://stackoverflow.com/questions/20932543/laravel-4-two-submit-buttons-in-one-form-and-have-both-submits-to-be-handled-b)

I have a login form which has email and password fields. And I have two submit buttons, one for login ( if user is already registered ) and the other one for registration ( for new users ). As the login action and register action are different so I need some way to redirect the request with all the post data to its respective action. Is there a way to achieve this in Laravel 4 in pure Laravel way?

2014-01-05 10:35:41Z

I have a login form which has email and password fields. And I have two submit buttons, one for login ( if user is already registered ) and the other one for registration ( for new users ). As the login action and register action are different so I need some way to redirect the request with all the post data to its respective action. Is there a way to achieve this in Laravel 4 in pure Laravel way?The way I would do itIf your form is (2 buttons):Create a controller 'TestController'Add a routeIn TestController you'd have one method that checks which submit was clicked on and two other methods for login and registerMy solution:first I set up form with no actionfor routes (routes.php):controller (TestController.php)Jquery: (test.js)ClickCoder's answer is spot-on, the only thing I would replace, to do it in an 100% "pure Laravel way" would be to use the Form Builder for the submit buttons as well. http://laravel.com/docs/4.2/html#buttonsThe first parameter is the submit's value, and you can pass its name in the following options array.So instead of:You'd do:If you'd like, you could escape the if statement altogether by having them share the same name and do something like this:html:php:A bit less nesting, a bit more Laravel!You can do like the following:Your routes (routes.php):filters.phpTestController.phpForm: should be in your view.however, I have created a temp form in route file for this answer.now browse:Please note: I am not sure this is the right approach to allow two submit buttons but it work for two submit buttons.Give the submit buttons different names, egIn your controller, simply handle login or signup depending on which button was submitted. You will still get all your inputs, you can do this;

Laravel 4.2 blade: check if empty

Marten

[Laravel 4.2 blade: check if empty](https://stackoverflow.com/questions/27486179/laravel-4-2-blade-check-if-empty)

In Laravel blade you can do: This will check if a variable is set or not. I get some data from the database, and those variables are always set, so I can not use this method.I am searching for a shorthand 'blade' function for doing this:It is hard to use this piece or code for doing this beacuse of, I do not know how to do it with a link or something like this:I tried:But, it does not work. And, I would like to keep my code as short as possible ;)Can someone explain it to me?UPDATEI do not use a foreach because of, I get a single object  (one school) from the database. I passed it from my controller to my view with: So, I do not want to make an @if($value != ''){} around each $variable (like $school->name).

2014-12-15 14:23:05Z

In Laravel blade you can do: This will check if a variable is set or not. I get some data from the database, and those variables are always set, so I can not use this method.I am searching for a shorthand 'blade' function for doing this:It is hard to use this piece or code for doing this beacuse of, I do not know how to do it with a link or something like this:I tried:But, it does not work. And, I would like to keep my code as short as possible ;)Can someone explain it to me?UPDATEI do not use a foreach because of, I get a single object  (one school) from the database. I passed it from my controller to my view with: So, I do not want to make an @if($value != ''){} around each $variable (like $school->name).try this:I prefer the @unless directive for readability in this circumstance.With php 7, you can use null coalescing operator. This is a shorthand for @m0z4rt's answer.change toor the same codeI wonder why nobody talked about $variable->isEmpty() it looks more better than other. Can be used like:  

Laravel Session Flash persists for 2 requests

Walid Ammar

[Laravel Session Flash persists for 2 requests](https://stackoverflow.com/questions/24579580/laravel-session-flash-persists-for-2-requests)

Recently I have changed to Laravel from Codeigniter, everything was going fine except I encountered a problem with Session::flash.when I create new user I get success message but It will persist for 2 requests, even I didn't pass the validator:

my code in UsersController:in form.blade:in master.blade:Maybe I'm not alone with this issue, here is another unanswered question.For anyone in future facing this problem: 

Never flash session data without redirecting.My code now looks like this:

2014-07-04 18:51:24Z

Recently I have changed to Laravel from Codeigniter, everything was going fine except I encountered a problem with Session::flash.when I create new user I get success message but It will persist for 2 requests, even I didn't pass the validator:

my code in UsersController:in form.blade:in master.blade:Maybe I'm not alone with this issue, here is another unanswered question.For anyone in future facing this problem: 

Never flash session data without redirecting.My code now looks like this:You are Flashing session data and creating a view instead of redirecting, meaning the message will Flash for this request and for the next one, showing twice. If you want to show the message on the current request without redirecting, I would suggest providing the errors to your View::make instead of trying to Flash the messages. If you MUST Flash the message on the current request, then you will need to Session::forget('key') or Session::flush() after your view.The following seems to be available from version 5.1 onward. Although the method is not mentioned on Laravel's documentation page about sessions.This is the same as flash, except it won't persist to the next request.As @Drew  said earlierAn easy way to flash a message once when you are creating a view is:Happy coding!I had a similar problem, but I couldn't use Return::redirct, as I was using Ajax to to post to and from a  within a set of Tabs. Therefore, I was calling only if the validation failed and returning a view with the old input. Assuming validation passed and I wanted to run some functions and create a new view based on new data, I would call:I would put this before my final View::makeHope this helps (or makes sense)...create:delete:A good method to repopulate form with old data:Controller:View:

laravel fatal error for TestCase not found

Steve Bals

[laravel fatal error for TestCase not found](https://stackoverflow.com/questions/21726963/laravel-fatal-error-for-testcase-not-found)

if i run laravel it shows the following errorFatal error: Class 'TestCase' not found in D:\xampp\htdocs\laravel\app\tests\ExampleTest.php on line 3 , any idea 

2014-02-12 11:41:39Z

if i run laravel it shows the following errorFatal error: Class 'TestCase' not found in D:\xampp\htdocs\laravel\app\tests\ExampleTest.php on line 3 , any idea Run following command in your project's root directoryUpdate:You can also run with the following command if phpunit is not installed on your machine. Which is also better to avoid version differences between team mates.Check if your tests directory is listed on the classmap property of your composer.json file.If not add it and run composer dump-autoload.In my case, i noticed that my root folder not contained the phpunit.xml file.Solve it including the following code in phpunit.xml at the root folder:You haven't really given much information to go on here, but the specific problem is probably that you don't have an autoloader (thus the TestCase class that PHP is expecting isn't actually loaded. The underlying problem in turn is likely that you're trying to run ExampleTest.php directly on the terminal, whereas instead you must bootstrap a test environment correctly through Laravel and PHPUnit.You should find a phpunit.xml file in the root of your Laravel install. This file tells PHPUnit how to bootstrap and start executing tests for your application, so you should just be able to run phpunit on the command line in the root of your application and it should work.If that's not the issue, please do provide more detail for people to help with.I had same issue, you should run test from root folder, in your case 'http://localhost/laravel' and in terminal you just need to write phpunit, and test will be executed.Had the same issue with PHPUnit, he would output always the same message : PHP Fatal error:  Class 'Tests\TestCase' not found ... and indeed I think he had troubles to find that class so what you need to do is transform one line : From this : To this : I got the same error but none worked, except for this one, this worked for me,I tried reinstalling and upgrading my phpunit in Laravel 5.4,or run specific unit,  phpunit --filter yourTestCaseClassThe is caused by an outdated phpunit. If you using a globally installed phpunit, here is a link on how to update it https://stackoverflow.com/a/40701333/3792206  . Or you can explicitly use the phpunit that was installed with the project.

What do the three dots before a function argument represent?

Salar

[What do the three dots before a function argument represent?](https://stackoverflow.com/questions/40439733/what-do-the-three-dots-before-a-function-argument-represent)

I was working with Laravel 5.3 and in one of the functions, I found this piece of

code:The code comes from \Illuminate\Auth\Middleware\Authenticate::class.What are those 3 dots before $guards variable?

2016-11-05 15:07:31Z

I was working with Laravel 5.3 and in one of the functions, I found this piece of

code:The code comes from \Illuminate\Auth\Middleware\Authenticate::class.What are those 3 dots before $guards variable?It indicates that there may be a variable number of arguments. When the function is called with more than 3 arguments, all the arguments after $next will be added to the $guards array.You can read about it here.

Laravel migration transaction

olivarra1

[Laravel migration transaction](https://stackoverflow.com/questions/20420600/laravel-migration-transaction)

When developing i'm having so many issues with migrations in laravel.I create a migration. When i finish creating it, there's a small error by the middle of the migration (say, a foreign key constraint) that makes "php artisan migrate" fail. He tells me where the error is, indeed, but then migrate gets to an unconsistent state, where all the modifications to the database made before the error are made, and not the next ones.This makes that when I fix the error and re-run migrate, the first statement fails, as the column/table is already created/modified. Then the only solution I know is to go to my database and "rollback" everything by hand, which is way longer to do.migrate:rollback tries to rollback the previous migrations, as the current was not applied succesfully.I also tried to wrap all my code into a DB::transaction(), but it still doesn't work.Is there any solution for this? Or i just have to keep rolling things back by hand?

edit, adding an example (not writing Schema builder code, just some kind of pseudo-code):

Migration1:Migration1 executed OK. Some days later we make Migration 2:Now what will happen is that migrate will call the first statement and will create the table items with his foreign key to users. Then when he tries to apply the next statement it will fail.If we fix the make_some_error_here, we can't run migrate because the table "items" it's created. We can't rollback (nor refresh, nor reset), because we can't delete the table users since there's a foreign key constraint from the table items.Then the only way to continue is to go to the database and delete the table items by hand, to get migrate in a consistent state.

2013-12-06 09:40:15Z

When developing i'm having so many issues with migrations in laravel.I create a migration. When i finish creating it, there's a small error by the middle of the migration (say, a foreign key constraint) that makes "php artisan migrate" fail. He tells me where the error is, indeed, but then migrate gets to an unconsistent state, where all the modifications to the database made before the error are made, and not the next ones.This makes that when I fix the error and re-run migrate, the first statement fails, as the column/table is already created/modified. Then the only solution I know is to go to my database and "rollback" everything by hand, which is way longer to do.migrate:rollback tries to rollback the previous migrations, as the current was not applied succesfully.I also tried to wrap all my code into a DB::transaction(), but it still doesn't work.Is there any solution for this? Or i just have to keep rolling things back by hand?

edit, adding an example (not writing Schema builder code, just some kind of pseudo-code):

Migration1:Migration1 executed OK. Some days later we make Migration 2:Now what will happen is that migrate will call the first statement and will create the table items with his foreign key to users. Then when he tries to apply the next statement it will fail.If we fix the make_some_error_here, we can't run migrate because the table "items" it's created. We can't rollback (nor refresh, nor reset), because we can't delete the table users since there's a foreign key constraint from the table items.Then the only way to continue is to go to the database and delete the table items by hand, to get migrate in a consistent state.It is not a Laravel limitation, I bet you use MYSQL, right?As MYSQL documentation says hereAnd we have a recommendation of Taylor Otwell himself here saying: -- UPDATE --Do not worry!The bast practises say:It means, in one deployment you create new tables and fields and deploy a new release that uses them. In a next deployment you delete unused table and fields. Now, even if you'll get a problem in either of these deployments, don't worry if your migration failed, the working release uses the functional data structure anyway. And with the single operation per migration you'll find a problem in no time.I'm using MySql and I'm having this problem.My solution depends that your down() method does exactly what you do in the up()  but backwards.This is what i go:So here if something fails automatically calls the down() method and throws again the exception.Instead of using the migration between transaction() do it between this tryLike Yevgeniy Afanasyev highlighted Taylor Otwell as saying (but an approach I already took myself): have your migrations only work on specific tables or do a specific operation such as adding/removing a column or key. That way, when you get failed migrations that cause inconsistent states like this, you can just drop the table and attempt the migration again.I’ve experienced exactly the issue you’ve described, but as of yet haven’t found a way around it.Just remove the failed code from the migration file and generate a new migration for the failed statement. Now when it fails again the creation of the database is still intact because it lives in another migration file.Another advantage of using this approach is, that you have more control and smaller steps while reverting the DB.Hope that helps :DI know it's an old topic, but there was activity a month ago, so here are my 2 cents.This answer is for MySql 8 and Laravel 5.8

MySql, since MySql 8, introduced atomic DDL: https://dev.mysql.com/doc/refman/8.0/en/atomic-ddl.html

Laravel at the start of migration checks if the schema grammar supports migrations in a transaction and if it does starts it as such.

The problem is that the MySql schema grammar has it set to false. We can extend the Migrator, MySql schema grammar and MigrationServiceProvider, and register the service provider like so:Of course, we have to add transactions to our database config...

DISCLAIMER - Haven't tested yet, but looking only at the code it should work as advertised :) Update to follow when I test...I think the best way to do it is like shown in the documentation:See: https://laravel.com/docs/5.8/database#database-transactions

Hotmail rejecting all emails using Mailgun or SparkPost [closed]

Syed Abdur Rehman Kazmi

[Hotmail rejecting all emails using Mailgun or SparkPost [closed]](https://stackoverflow.com/questions/50416923/hotmail-rejecting-all-emails-using-mailgun-or-sparkpost)

I have been trying to send mail using Laravel. I have been successful in integrating Mailgun/SparkPost in my application. It is sending mail to every other domain except for Hotmail/Outlook/MSN/Live. 

Somehow they are saying that the IP I am trying to send mail from is on their blocked list.This is the error message i keep on getting: When I tried to reach out to Hotmail's support and explained my issue to them, this is the reply I got from them. I am using Laravel 5.4 and i am able to send mails to every other network i.e gmail/yahoo 

2018-05-18 18:00:03Z

I have been trying to send mail using Laravel. I have been successful in integrating Mailgun/SparkPost in my application. It is sending mail to every other domain except for Hotmail/Outlook/MSN/Live. 

Somehow they are saying that the IP I am trying to send mail from is on their blocked list.This is the error message i keep on getting: When I tried to reach out to Hotmail's support and explained my issue to them, this is the reply I got from them. I am using Laravel 5.4 and i am able to send mails to every other network i.e gmail/yahoo Seems like there is some problem with the IpAddress that Mailgun assigns you.All I had to do was to go into the domain i setup at Mailgun there was an IP address assigned to my domain. I removed it. It assigned me a new one and done. I recently encountered this issue as well - I highly recommend that you reach out to the Mailgun support team and notify them of the issue. They recognized that the IP that I was on was associated with a user who had been sending a lot of spam and they hooked us up with a "clean" IP. I'd guess that if you delete your IP and they automatically assign you a new one, that can work but might not be a guaranteed fix if the new IP is also blacklisted - just let them know, they'll help you out.Hotmail reject email, maybe Mailgun server is using a IP address, but it is in blacklist of Hotmail, you can create new ticket, and Mailgun will support to change IP address. Your can send the detail of error by go to tab: Logs > coppy json returned and send to mailgun. Good luck.

Check for Session timeout in Laravel

mattl

[Check for Session timeout in Laravel](https://stackoverflow.com/questions/14688853/check-for-session-timeout-in-laravel)

I was just wondering if anyone knew how to check for session timeout in Laravel. You can check whether the session has a specific item:But you can't check whether the session has expired. It would be nice so that I can report back to the user in a more specific way. "Your session has timed out, please start again."Any thoughts?

2013-02-04 14:30:13Z

I was just wondering if anyone knew how to check for session timeout in Laravel. You can check whether the session has a specific item:But you can't check whether the session has expired. It would be nice so that I can report back to the user in a more specific way. "Your session has timed out, please start again."Any thoughts?Just use the same logic as the session class itself.Place this in your 'before' filter - and it will run on every request.Why not do this?If a session times out then the name will no longer be set. You can then write some code to respond to $sessionTimeout == 1;BTW,

Specifically if you need the session lifetime,Use this:When describing this, Use this:

Setting up Laravel with Nginx

Kyle Decot

[Setting up Laravel with Nginx](https://stackoverflow.com/questions/8856664/setting-up-laravel-with-nginx)

I'm attempting to set up the Laravel PHP Framework to work with Nginx. Here is my directory structure:Basically what I have is a standard Laravel download w/ a legacy folder thrown in which holds all of the files from my non-MVC project. I need Nginx to first check if the requested page/file exists inside of legacy, if it does then I want to use that. Otherwise, I want to fall back to Laravel's index.php file which is located in project/public/. I'm no expert when it comes to Nginx configurations so any help that you can provide would be most appreciated.

2012-01-13 20:12:54Z

I'm attempting to set up the Laravel PHP Framework to work with Nginx. Here is my directory structure:Basically what I have is a standard Laravel download w/ a legacy folder thrown in which holds all of the files from my non-MVC project. I need Nginx to first check if the requested page/file exists inside of legacy, if it does then I want to use that. Otherwise, I want to fall back to Laravel's index.php file which is located in project/public/. I'm no expert when it comes to Nginx configurations so any help that you can provide would be most appreciated.

Using withTrashed with relationships in Eloquent

Vuk Stanković

[Using withTrashed with relationships in Eloquent](https://stackoverflow.com/questions/25868025/using-withtrashed-with-relationships-in-eloquent)

Is there a way to use withTrashed with relationships in Eloquent. What I need is this. I have table and model Mark and another table User. User has many Mark and Mark belongs to User. So I defined this in Eloquent models.Now I need to get an instance of Mark that is soft deleted. This is not a problem if User isn't soft deleted, but if both Mark and User are soft deleted, I get an error Trying to get property of non-object, becausewon't return actual user, cause it is soft deleted.Is there a way that I can do something like to get this related user even if it is deleted?

2014-09-16 11:49:43Z

Is there a way to use withTrashed with relationships in Eloquent. What I need is this. I have table and model Mark and another table User. User has many Mark and Mark belongs to User. So I defined this in Eloquent models.Now I need to get an instance of Mark that is soft deleted. This is not a problem if User isn't soft deleted, but if both Mark and User are soft deleted, I get an error Trying to get property of non-object, becausewon't return actual user, cause it is soft deleted.Is there a way that I can do something like to get this related user even if it is deleted?Depenging on your needs, you can define the relationship:or use it on the fly:And in your pasted example it will be:You can do that like this:

Laravel Homestead Swift Cannot send message without a sender address

Gergely Havlicsek

[Laravel Homestead Swift Cannot send message without a sender address](https://stackoverflow.com/questions/31871806/laravel-homestead-swift-cannot-send-message-without-a-sender-address)

I get this error with stock email settings in Laravel 5.1 Homestead when I try to send a password reset mail. The address is filled in app/config/mail.php: 

2015-08-07 07:20:26Z

I get this error with stock email settings in Laravel 5.1 Homestead when I try to send a password reset mail. The address is filled in app/config/mail.php: In your .env file you will need to set the email address and password of your email account. You also need to set the host and port of the mail server you are using.Or make sure that everything is complete in your mail.php file (see note below). Note: It's better to use the .env file, as you most likely will have a different configuration in your production environment.If everything is completed and it still doesn't work, it might be caching. You can clear the config cache with this:Also note: As Viktorminator mentioned:

Take into consideration creating app passwords and not using your usual pass for this needs. Link for creating passwords myaccount.google.com/apppasswords Make sure you have set the 'from' in app/config/mail.phpIt will fix the problem.If you don't have access to the .env file, you can add default values to those env calls on app/config/mail.php, like this:This approach will try to get the data from the .env file, if there's nothing there, it'll default to whatever you set.error was still occure. after settings and run commandscheck the codeTo make Mailtrap work in my case, I had to provide a value for MAIL_FROM_ADDRESS environment variable on Laravel 6+ instead of keeping it null.Maybe someone is using laravel 6

Its problem is "Cannot send message without a sender address" so there is no email address to send the email in .env fileJust add sender email addressI didn't change anything in the mail.php file, its work for me in laravel 6, after that runThe file: /bootstrap/cache/config.php

The change:

How to change reset password email subject in laravel?

Chinmay235

[How to change reset password email subject in laravel?](https://stackoverflow.com/questions/40574001/how-to-change-reset-password-email-subject-in-laravel)

I am beginner in Laravel. Currently I am learning this framework. My curent Laravel version is 5.3.I am scaffolding my auth by using php artisan make:auth All are working fine. Also I configured gmail smtp in my .env file and mail.php in config directgory. All are perfectly working. But I saw by-default the forgot password email subject is going Reset Password. I want to change that.I saw some blog. I found some blog. I have implement that in my site. But same output coming.I followed these links - https://laracasts.com/discuss/channels/general-discussion/laravel-5-password-reset-link-subjecthttps://laracasts.com/discuss/channels/general-discussion/reset-password-email-subjecthttps://laracasts.com/discuss/channels/laravel/how-to-override-message-in-sendresetlinkemail-in-forgotpasswordcontroller

2016-11-13 12:48:37Z

I am beginner in Laravel. Currently I am learning this framework. My curent Laravel version is 5.3.I am scaffolding my auth by using php artisan make:auth All are working fine. Also I configured gmail smtp in my .env file and mail.php in config directgory. All are perfectly working. But I saw by-default the forgot password email subject is going Reset Password. I want to change that.I saw some blog. I found some blog. I have implement that in my site. But same output coming.I followed these links - https://laracasts.com/discuss/channels/general-discussion/laravel-5-password-reset-link-subjecthttps://laracasts.com/discuss/channels/general-discussion/reset-password-email-subjecthttps://laracasts.com/discuss/channels/laravel/how-to-override-message-in-sendresetlinkemail-in-forgotpasswordcontrollerYou can change your password reset email subject, but it will need some extra work. First, you need to create your own implementation of ResetPassword notification.Create a new notification class insideapp\Notifications directory, let's named it ResetPassword.php:You can also generate the notification template using artisan command: Or you can simply copy-paste the above code. As you may notice this notification class is pretty similar with the default Illuminate\Auth\Notifications\ResetPassword. You can actually just extend it from the default ResetPassword class. The only difference is here, you add a new method call to define the email's subject:You may read more about Mail Notifications here.Secondly, on your app\User.php file, you need to override the default sendPasswordResetNotification() method defined by Illuminate\Auth\Passwords\CanResetPassword trait. Now you should use your own ResetPassword implementation:And now your reset password email subject should be updated!Hope this help!You may easily modify the notification class used to send the password reset link to the user. To get started, override the sendPasswordResetNotification method on your User model. Within this method, you may send the notification using any notification class you choose. The password reset $token is the first argument received by the method, See the Doc for CustomizationHope this helps!In Laravel 5.7 the default implementation is similar to this:All you have to do is change your locale from config/app.php for example to ro, then in your resources/lang, create a file ro.json similar to this:It will translate both the subject (first key) and the mail body.UPDATE for Laravel 6.*

This can be also used for VerifyEmail.php notification.You can create a custom function that will create the reset password token like this.To everyone asking how to update the Hello, Regards, and subcopy text:php artisan vendor:publish (option 11)then in views/vendor/notifications/email.blade.phpIn this file there will be the text like Hello, wich you can change by changing:

for example:

line 9# @lang('Hallo!, Hei!, Bonjour!, Guten Tag!,   Geia!')Just add the line:->subject('New Subjetc')in the the method toMail of the file Illuminate\Auth\Notifications\ResetPassword

like this:

Laravel Task Scheduling Every X Hours

senty

[Laravel Task Scheduling Every X Hours](https://stackoverflow.com/questions/42799953/laravel-task-scheduling-every-x-hours)

I undestand that you can create hourly tasks on Laravel by using:$schedule->command('catalog:update')->hourly(); however is there a way to do for example every 2 hours or 5 hours? I couldn't find it on documentation or here.

2017-03-15 02:14:31Z

I undestand that you can create hourly tasks on Laravel by using:$schedule->command('catalog:update')->hourly(); however is there a way to do for example every 2 hours or 5 hours? I couldn't find it on documentation or here.You've tagged your question as Laravel 4, but I don't think the scheduler was introduced until Laravel 5...Anyway, based on the code snippet you've posted, you could use the cron method.See the docs for other options. https://laravel.com/docs/5.4/scheduling#defining-schedules

How to implement a self referencing (parent_id) model in Eloquent Orm

Dinesh Copoosamy

[How to implement a self referencing (parent_id) model in Eloquent Orm](https://stackoverflow.com/questions/20292329/how-to-implement-a-self-referencing-parent-id-model-in-eloquent-orm)

I have a User table and need to allow for users to have a parent user.the table would have the fields:How would I define this self referencing relationship in Eloquent ORM?

2013-11-29 19:32:50Z

I have a User table and need to allow for users to have a parent user.the table would have the fields:How would I define this self referencing relationship in Eloquent ORM?I had some success like this, using your exact DB table.User Model:and then I could use it in my code like this:Give that a try and let me know how you get on!I had a chain of self referencing contracts (a contract can be continued by another contract) and also needed self referencing. Each contract has zero or one previous and also zero or one next contract.My data table looked like the following:To define the inverse of a relationship (previous contract) you have to inverse the related columns, that means setting

 * foreign key column on the model table

 * associated column on the parent table (which is the same table)See http://laravel.com/docs/5.0/eloquent#one-to-one for further details.

How to use break or continue with Laravel Eloquent Collection's each method?

Nasif Md. Tanjim

[How to use break or continue with Laravel Eloquent Collection's each method?](https://stackoverflow.com/questions/29725880/how-to-use-break-or-continue-with-laravel-eloquent-collections-each-method)

How to use break or continue with Laravel Eloquent Collection's each method.

My code is this:

2015-04-19 04:43:30Z

How to use break or continue with Laravel Eloquent Collection's each method.

My code is this:To continue, just return out of the inner function. To break, well..If you're using Laravel 5.1+, you can return false to break the loop:For older version of Laravel, use a regular foreach loop:We can return true/false true for continue, false for breakContinue:Output:

1 3 4Break:Output:

1

Laravel Update Query

Brent

[Laravel Update Query](https://stackoverflow.com/questions/27248753/laravel-update-query)

I am trying to update a User on the basis of the email not there id, is there a way of doing this without raw queries. Currently the error My Code 

2014-12-02 11:51:56Z

I am trying to update a User on the basis of the email not there id, is there a way of doing this without raw queries. Currently the error My Code This error would suggest that User::where('email', '=', $userEmail)->first() is returning null, rather than a problem with updating your model.Check that you actually have a User before attempting to change properties on it, or use the firstOrFail() method.or using the firstOrFail() method, theres no need to check if the user is null because this throws an exception (ModelNotFoundException) when a model is not found, which you can catch using App::error() http://laravel.com/docs/4.2/errors#handling-errorsYou could use the Laravel query builder, but this is not the best way to do it.Check Wader's answer below for the Eloquent way - which is better as it allows you to check that there is actually a user that matches the email address, and handle the error if there isn't.If you have multiple fields to update you can simply add more values to that array at the end.Try doing it like this.

What is Closure in Laravel?

vishal ribdiya

[What is Closure in Laravel?](https://stackoverflow.com/questions/47348081/what-is-closure-in-laravel)

I saw one Laravel function in middlewere:What is Closure and what does it do?

2017-11-17 10:07:40Z

I saw one Laravel function in middlewere:What is Closure and what does it do?A Closure is an anonymous function. Closures are often used as callback methods and can be used as a parameter in a function. If you take the following example:We start by adding a Closure parameter the handle function. This will type hint us that the handle function takes a Closure.We then call the handle function and pass a function as the first parameter.By using $closure(); in the handle function we tell PHP to execute the given Closure which will then echo 'Hello!'It is also possible to pass parameters into a Closure. We can do so by changing the Closure call in the handle function to pass on a parameter. In this example i'll just pass a string but this can be any variable.The handle function now looks likeWe now also need to modify the Closure itself to take the parameter. We do so by simply adding a parameter to the function. And then we pass that variable to the echo. The function now looks likeWhich will echo Hello World!For more information you can check out these links:http://php.net/manual/en/functions.anonymous.phphttp://php.net/manual/en/class.closure.php

Pass a custom message (or any other data) to Laravel 404.blade.php

giò

[Pass a custom message (or any other data) to Laravel 404.blade.php](https://stackoverflow.com/questions/29163564/pass-a-custom-message-or-any-other-data-to-laravel-404-blade-php)

I am using Laravel 5, and I have created a file 404.blade.php inThis file gets rendered each time I call:How can I pass a custom message? Something like this in 404.blade.phpFilled by (example):or In Laravel 4 one could use App::missing:

2015-03-20 09:45:13Z

I am using Laravel 5, and I have created a file 404.blade.php inThis file gets rendered each time I call:How can I pass a custom message? Something like this in 404.blade.phpFilled by (example):or In Laravel 4 one could use App::missing:(Note: copied from my answer here.)In Laravel 5, you can provide Blade views for each response code in the /resources/views/errors directory. For example a 404 error will use /resources/views/errors/404.blade.php.What's not mentioned in the manual is that inside the view you have access to the $exception object. So you can use {{ $exception->getMessage() }} to get the message you passed into abort().Extend Laravel's Exception Handler, Illuminate\Foundation\Exceptions\Handler, and override renderHttpException(Symfony\Component\HttpKernel\Exception\HttpException $e) method with your own.If you haven't run php artisan fresh, it will be easy for you. Just edit app/Exceptions/Handler.php, or create a new file.And then, use $e variable in your 404.blade.php.i.e.and in your 404.blade.phpFor other useful methods like getStatusCode(), refer Symfony\Component\HttpKernel\ExceptionHow about sharing a variable globally?Just make sure in the template to fallback to a default in case you forget to set it.See sharing data with views: http://laravel.com/docs/5.0/views

Laravel 5.1 PHP DOMDocument() class not found

user3023925

[Laravel 5.1 PHP DOMDocument() class not found](https://stackoverflow.com/questions/31577588/laravel-5-1-php-domdocument-class-not-found)

I'm using PHP's built-in DOMDocument() class to do some simple web-scrapping.

However, it works on my 4.2 site, but not my 5.1 (both are on same installation of PHP).Here's the error:Here's my controller:I figure this is a namespace issue, but I have no idea how to access DOMDocument()Thanks for any help.

2015-07-23 03:16:45Z

I'm using PHP's built-in DOMDocument() class to do some simple web-scrapping.

However, it works on my 4.2 site, but not my 5.1 (both are on same installation of PHP).Here's the error:Here's my controller:I figure this is a namespace issue, but I have no idea how to access DOMDocument()Thanks for any help.In Laravel 5.1 you must prefix the class name with the global namespace prefix '\'.So your updated code:For me, in order to solve the error: DOMDocument() class not found. I had to install the DOM extension.If you are using PHP 5:You can do so on Debian / Ubuntu using:And on Centos / Fedora / Red Hat:If you are using PHP 7:For Ubuntu:For CentOS / Fedora / Red Hat:Tested in Laravel 5.4 you can use keyword use :In top of file before define the class you can write use DOMDocument; instead of new \DOMDocument();For eg:what is this '...' ?I had this problem in laravel 5.6 on a server with ubuntu 16.04, and I solved this issue installing the xml package for php7.1 version, this does not work for me in the php7.2 version I don't know why.1.- Make sure you have the version 7.1 of php installed, I use this command to select the correct php version in ubuntu: Note: In case you don't have installed the php7.1 version, do you need to install it before the above command, in that case you can use this command: apt-get install php7.12.- To install the package XML I was used the following command:3.- Restart your apache server, in my case with this command:I hope to be helpful, this saved my day.I had the same issue with Amazon Linux 2 (LAMP) with laravel frameworkPlease find below steps resolve issues:

Laravel 5.3 - How to log all queries on a page?

DevK

[Laravel 5.3 - How to log all queries on a page?](https://stackoverflow.com/questions/41163199/laravel-5-3-how-to-log-all-queries-on-a-page)

My team and I are working on a rather big project. There's queries going on everywhere - in controllers, in view composers in views (lazy loading) and probably in some other services as well. It's getting hard to keep a track of it all and the page load speed is fairly slow at the moment. Where would I put \DB::enableQueryLog() and \DB::getQueryLog() to log ALL the queries and dump them? Basically I'm looking for some place in code that happens before any of the queries happen (to put enableQueryLog()) and I'm looking for a place that happens after the views render (to dump getQueryLog()).What would be a good way to go about this?Thanks in advance.

2016-12-15 11:35:35Z

My team and I are working on a rather big project. There's queries going on everywhere - in controllers, in view composers in views (lazy loading) and probably in some other services as well. It's getting hard to keep a track of it all and the page load speed is fairly slow at the moment. Where would I put \DB::enableQueryLog() and \DB::getQueryLog() to log ALL the queries and dump them? Basically I'm looking for some place in code that happens before any of the queries happen (to put enableQueryLog()) and I'm looking for a place that happens after the views render (to dump getQueryLog()).What would be a good way to go about this?Thanks in advance.Here comes the perfect example:https://laravel.com/docs/5.3/database#listening-for-query-eventsOpen app\Providers\AppServiceProvider.php and add the following to Boot() function:   You can add this to the Providers/AppServiceProvider.php file and check them in the laravel log file with tail:You can even filter with queries you want to log. For example, here I was using Laravel Passport, and didn't want to log all the oauth queries.If you want to print a query which is executed on your app do following steps.Step1: Go to your AppServiceProvider.php file.   // File path App\Providers\AppServiceProvider.phpStep2: Make boot() method and paste below code.Step3: Now you can see you queries in lumen.log or laravel.log file. File path is laravel_app\storage\logs\laravel.log or lumen.log.Enjoy....Put this code right above the code where your query is executed Just modified for executable query:add a middleware that executes after the request is done and logs your queries ... see Terminable MiddlwaresAre you using MySQL? You can just tail the log.How to show the last queries executed on MySQL?Or use the Laravel Debug Bar?Additioanlly There's package available also: https://packagist.org/packages/technoknol/log-my-queries Just install and add it's entry to middleware. It will log all the queries in laravel.log default log file. 

How To Cast Eloquent Pivot Parameters?

Josh Janusch

[How To Cast Eloquent Pivot Parameters?](https://stackoverflow.com/questions/30226496/how-to-cast-eloquent-pivot-parameters)

I have the following Eloquent Models with relationships:The pivot table contains an additional param (is_primary) that marks a relationship as the primary. Currently, I see returns like this when I query for a contact:Is there a way to cast the is_primary in that to a boolean? I've tried adding it to the $casts array of both models but that did not change anything.

2015-05-13 22:50:02Z

I have the following Eloquent Models with relationships:The pivot table contains an additional param (is_primary) that marks a relationship as the primary. Currently, I see returns like this when I query for a contact:Is there a way to cast the is_primary in that to a boolean? I've tried adding it to the $casts array of both models but that did not change anything.Since this is an attribute on the pivot table, using the $casts attribute won't work on either the Lead or Contact model.One thing you can try, however, is to use a custom Pivot model with the $casts attribute defined. Documentation on custom pivot models is here. Basically, you create a new Pivot model with your customizations, and then update the Lead and the Contact models to use this custom Pivot model instead of the base one.First, create your custom Pivot model which extends the base Pivot model:Now, override the newPivot() method on the Lead and the Contact models:In Laravel 5.4.14 this issue has been resolved. You are able to define a custom pivot model and tell your relationships to use this custom model when they are defined. See the documentation, under the heading Defining Custom Intermediate Table Models.To do this you need to create a class to represent your pivot table and have it extend the Illuminate\Database\Eloquent\Relations\Pivot class. On this class you may define your $casts property.You can then use the using method on the BelongsToMany relationship to tell Laravel that you want your pivot to use the specified custom pivot model.Now, whenever you access your pivot by using ->pivot, you should find that it is an instance of your custom pivot class and the $casts property should be honoured.Update 1st June 2017The issue raised in the comments by @cdwyer regarding updating the pivot table using the usual sync/attach/save methods is expected to be fixed in Laravel 5.5 which is due to be released next month (July 2017).See Taylor's comment at the bottom of this bug report and his commit, fixing the issue here.Good news! Tylor already fixed this bug:https://github.com/laravel/framework/issues/10533In Laravel 5.1 or higher you can use dot notation for pivot casts:The answer provided by @patricus above is absolutely correct, however, if like me you're looking to also benefit from casting out from JSON-encoded strings inside a pivot table then read on.I believe that there's a bug in Laravel at this stage. The problem is that when you instantiate a pivot model, it uses the native Illuminate-Model setAttributes method to "copy" the values of the pivot record table over to the pivot model.This is fine for most attributes, but gets sticky when it sees the $casts array contains a JSON-style cast - it actually double-encodes the data.The way I overcame this is as follows:1. Set up your own Pivot base class from which to extend your pivot subclasses (more on this in a bit)2. In your new Pivot base class, redefine the setAttribute method, commenting out the lines that handle JSON-castable attributesThis highlights the removal of the isJsonCastable method call, which will return true for any attributes you have casted as json, array, object or collection in your whizzy pivot subclasses.3. Create your pivot subclasses using some sort of useful naming convention (I do {PivotTable}Pivot e.g. FeatureProductPivot)4. In your base model class, change/create your newPivot method override to something a little more usefulMine looks like this:Then just make sure you Models extend from your base model and you create your pivot-table "models" to suit your naming convention and voilà you will have working JSON casts on pivot table columns on the way out of the DB!NB: This hasn't been thoroughly tested and may have problems saving back to the DB.I had to add some extra checks to have the save and load functions working properly in Laravel 5.

Temporary property for Laravel Eloquent model

Nick

[Temporary property for Laravel Eloquent model](https://stackoverflow.com/questions/22297240/temporary-property-for-laravel-eloquent-model)

I have a Laravel Eloquent model User, which has a table with username and email columns. I need to add a property for the model on runtime, something like $user->secure. This property doesn't need to go to database.When i add this property and hit $user->save() i get an error saying i don't have database column 'secure'. I can unset 'secure' before save but somehow it feels there should be a better way to do so. Any suggestions?

2014-03-10 10:10:49Z

I have a Laravel Eloquent model User, which has a table with username and email columns. I need to add a property for the model on runtime, something like $user->secure. This property doesn't need to go to database.When i add this property and hit $user->save() i get an error saying i don't have database column 'secure'. I can unset 'secure' before save but somehow it feels there should be a better way to do so. Any suggestions?Just add an attribute to your class.Note that it is better to declare it protected and add corresponding accessors and mutators (getSecure and setSecure methods) to your model.For those who still find this post (like I did), you may need to explicitly declare the property as null to prevent it from being automatically added to the attributes array, and thus being added to INSERT/UPDATE queries:Source: http://laravel.io/forum/02-10-2014-setting-transient-properties-on-eloquent-models-without-saving-to-databaseIf you intend to make use of that add-on property, then $append will blow your mind.http://laraveldaily.com/why-use-appends-with-accessors-in-eloquent/

Call Laravel model by string [duplicate]

Parampal Pooni

[Call Laravel model by string [duplicate]](https://stackoverflow.com/questions/34409665/call-laravel-model-by-string)

Is it possible to call a Laravel model by string? This is what i'm trying to achieve but its failing:I get the following exception:

2015-12-22 06:23:20Z

Is it possible to call a Laravel model by string? This is what i'm trying to achieve but its failing:I get the following exception:Yes, you can do this, but you need to use the fully qualified class name:If your model name is stored in something other than a plain variable (e.g. a object attribute), you will need to use an intermediate variable in order to get this to work.Try this:Yes you can do it with more flexible way. Create a common function.Now you can call this method in different ways.By the way I like to use such functions.if you use it in many of the places use this functionExample if you want to get all the userScenario 1:Scenario 2:if your model in in custom namespace may be App\ModelsHope it helpsThis method should work well:My project has multiple subdirectory and this function work well. So I recover the namespace of the model with $model = current($this->getNamespace($this->request->get('model'))); 

Then I just have to call my query: $model::all()You can also try like this:-

How do I send an email with Laravel 4 without using a view?

Jason Thuli

[How do I send an email with Laravel 4 without using a view?](https://stackoverflow.com/questions/25394476/how-do-i-send-an-email-with-laravel-4-without-using-a-view)

I'm developing a site using Laravel 4 and would like to send myself ad-hoc emails during testing, but it seems like the only way to send emails is to go through a view.Is it possible to do something like this?

2014-08-19 23:18:03Z

I'm developing a site using Laravel 4 and would like to send myself ad-hoc emails during testing, but it seems like the only way to send emails is to go through a view.Is it possible to do something like this?As mentioned in an answer on Laravel mail: pass string instead of view, you can do this (code copied verbatim from Jarek's answer):You can also use an empty view, by putting this into app/views/email/blank.blade.phpAnd nothing else. Then you code And this allows you to send custom blank emails from different parts of your application without having to create different views for each one.If you want to send just text, you can use included method:No, with out of the box Laravel Mail you will have to pass a view, even if it is empty. You would need to write your own mailer to enable that functionality. 

Is it possible to prevent Laravel running Model Events when the database is being Seeded?

Jack

[Is it possible to prevent Laravel running Model Events when the database is being Seeded?](https://stackoverflow.com/questions/30492227/is-it-possible-to-prevent-laravel-running-model-events-when-the-database-is-bein)

Laravel's seeder runs a variety of Model Events on my models which trigger New Order notification emails, among other things, from the Product::saved() Model Event.This significantly slows down database seeding. Is it possible to detect whether a Seed is being ran and if so, tell Laravel not to run the Model Events?

2015-05-27 20:10:15Z

Laravel's seeder runs a variety of Model Events on my models which trigger New Order notification emails, among other things, from the Product::saved() Model Event.This significantly slows down database seeding. Is it possible to detect whether a Seed is being ran and if so, tell Laravel not to run the Model Events?There are functions on the Model class which will allow you to ignore events.Before using a model to seed, you will need to do something like this...I recommend to remove the Dispatcher in this Case from the Eloquent Model.For example.

How to simplify this Laravel PHP code to one Eloquent query?

Z0q

[How to simplify this Laravel PHP code to one Eloquent query?](https://stackoverflow.com/questions/41847910/how-to-simplify-this-laravel-php-code-to-one-eloquent-query)

I assume that this should all be in one query in order to prevent duplicate data in the database. Is this correct?How do I simplify this code into one Eloquent query?

2017-01-25 09:30:27Z

I assume that this should all be in one query in order to prevent duplicate data in the database. Is this correct?How do I simplify this code into one Eloquent query?It's not correct. You prevent duplication by placing unique constraints on database level.There's literally nothing you can do in php or any other language for that matter, that will prevent duplicates, if you don't have unique keys on your table(s). That's a simple fact, and if anyone tells you anything different - that person is blatantly wrong. I can explain why, but the explanation would be a lengthy one so I'll skip it.Your code should be quite simple - just insert the data. Since it's not exactly clear how uniqueness is handled (it appears to be user_2, accepted, but there's an edge case), without a bit more data form you - it's not possible to suggest a complete solution.You can always disregard what I wrote and try to go with suggested solutions, but they will fail miserably and you'll end up with duplicates.I would say if there is a relationship between User and Friend you can simply employ Laravel's model relationship, such as:Thats what I would do to ensure that the new data is updated or a new one is created.UPDATEOkay. Depending on what fields in the friends table marks the two friends, now using your example user_1 and user_2. By the example I gave, the $attributes_to_update would be (assuming otherID is the new friend's id):If your relationship between User and Friend is set properly, then the user_1 would already included in the insertion.Furthermore,on this updateOrCreate function:$attributes_to_check would mean those fields you want to check if they already exists before you create/update new one so if I want to ensure, the check is made when accepted is 0 then I can pass both say `['user_1' => 1, 'accepted' => 0]Hope this is clearer now.I'm assuming "friends" here represents a many-to-many relation between users. Apparently friend requests from one user (myID) to another (otherId).You can represent that with Eloquent as:That is, no need for Friend model.Then, I think this is equivalent to what you want to accomplish (if not, please update with clarification):(accepted 0 or 1, according to your business logic).This sync method prevents duplicate inserts, and updates or creates any row for the given pair of "myId - otherId". You can set any number of additional fields in the pivot table with this method.However, I agree with @Mjh about setting unique constraints at database level as well.For this kind of issue,  First of all, you have to enjoy the code and database if you are working in laravel.  For this first you create realtionship between both table friend and user in database as well as in Models . Also you have to use unique in database .This is query you can work with this . Also you can pass multiple condition here. ThanksYou can use firstOrCreate/ firstOrNew methods (https://laravel.com/docs/5.3/eloquent)Example (from docs) :use `firstOrCreate' it will do same as you did manually. Definition of FirstOrCreate copied from the Laravel Manual. The firstOrCreate method will attempt to locate a database record using the given column / value pairs. If the model can not be found in the database, a record will be inserted with the given attributes.So according to that you should try : It will check with both IDs if not exists then create record in friends table.

Laravel - Union + Paginate at the same time?

Lior

[Laravel - Union + Paginate at the same time?](https://stackoverflow.com/questions/25338456/laravel-union-paginate-at-the-same-time)

Brief:I am trying to union 2 tables recipes and posts then add ->paginate(5) to the queries.But for some reason I get this error:Code:Am i doing something wrong?Without ->paginate(5) the query works fine.

2014-08-16 08:45:42Z

Brief:I am trying to union 2 tables recipes and posts then add ->paginate(5) to the queries.But for some reason I get this error:Code:Am i doing something wrong?Without ->paginate(5) the query works fine.You're right, pagination cause problem. Right now, you can create a view and query the view instead of the actual tables, or create your Paginator manually: I faced this kind of issue already. I found a thread also not about pagination but about unions.Please see this link : Sorting UNION queries with Laravel 4.1@Mohamed Azher has shared a nice trick and it works on my issue.This creates an sql like below:And you can already utilize Laravel's paginate same as usual like $query->paginate(5). (but you have to fork it a bit to fit to your problem)View page :Reiterating jdme's answer with a more elegant method from Illuminate\Database\Query\Builder.I hope this helps!I had this same problem, and unfortunately I couldn't get the page links with {{ $result->links() }}, but I found another way to write the pagination part and the page links appearsCustom data pagination with Laravel 5Getting the total count for pagination is the problem here. This is the error I got when used $builder->paginate()If you want to paginate without total count you can useto get only set of rows in the page.Getting all the rows and counting total is memory inefficient. So I used following approach to get total count.Then we have to paginate the result manually.If you can use raw sql queries, it is much more CPU and memory efficient.for paginate collection do this:add this to boot function in \app\Providers\AppServiceProvider From hereafter for all collection you can paginate like your codeI know this answer is too late. But I want to share my problems and my solution.※This is the sample.

MariaDB, about 146,000 records.Reference from www.tech-corgi.com (やり方２), I updated my PHP code to filter inside my query, and then call paginate normally.I must add a condition (filter) before getting large records. In this example is organization_id.But it still cannot be used in paginate (). There is a trick to solve this problem. See below.Trick: put query inside (). For example: (SELECT * FROM TABLE_A).Reason: paginage () will generate and run Count query SELECT count (*) FROM (SELECT * FROM TABLE_A), if we did not put inside brackets, Count query would not be a correct query.Now I can use it normally:Hope it help!!!The accepted answer works great for Query Builder.But here's my approach for Laravel Eloquent Builder.Assume that we're referring to same ModelI'm using Laravel 5.6For those who may still look for the answer, I have tried union and paginate together and got right result under laravel 5.7.20. This will be better than merging collections then paginate which will not work on big amount of data.Some demo code (in my case, I will deal with multiple databases with same table name):I haven't tried on other higher version of laravel. But at least it could work now!More information My previous version of laravel is 5.7.9 which will report the Cardinality violation error. So the laravel team solved this issue in some version of 5.7.x.

Unit Test Laravel's FormRequest

Dov Benyomin Sohacheski

[Unit Test Laravel's FormRequest](https://stackoverflow.com/questions/36978147/unit-test-laravels-formrequest)

I am trying to unit test various custom FormRequest inputs. I found solutions that: I am looking for a solution where I can unit test individual field inputs against the rules (independent of other fields in the same request).Sample FormRequest:Desired Test:How can I unit test (assert) each validation rule of every field in isolation and individually?

2016-05-02 08:28:39Z

I am trying to unit test various custom FormRequest inputs. I found solutions that: I am looking for a solution where I can unit test individual field inputs against the rules (independent of other fields in the same request).Sample FormRequest:Desired Test:How can I unit test (assert) each validation rule of every field in isolation and individually?I found a good solution on Laracast and added some customization to the mix.The CodeUpdateThere is an e2e approach to the same problem. You can POST the data to be checked to the route in question and then see if the response contains session errors.Friends, please, make the unit-test properly, after all, it is not only rules you are testing here, the validationData and withValidator functions may be there too.This is how it should be done:

Cookie session driver won't save any validation error or flash data

ipalaus

[Cookie session driver won't save any validation error or flash data](https://stackoverflow.com/questions/46762477/cookie-session-driver-wont-save-any-validation-error-or-flash-data)

I am having a hard time with the cookie session driver in Laravel.I have a simple form with a validation in place. This is my method for saving this form data:Pretty simple.The problem is that, when using the cookie session driver, if I save this form with a description that's 1024 characters long, I'll get redirected back but with no flash data and no $errors in the view for the next request to handle.Example:This is a POST after using this line:In the description field. 1024 bytes to be exact.Instead, if I just fill the field with some more dummy data but nothing too crazy:If I change the session driver to file:... it works.But this does not fix my problem. I do need to use the cookie driver for session as the production website is running in 3 different datacenters to achieve high availability. Using the cookie for the session allows the user to hit any of the 3 servers and still continue with it's request without having to use any sticky session or any central session driver.Using the database as a driver—which is also in a cluster with HA—is not an option as this is a really high traffic website and that would be a write per request which doesn't sound appealing at all. I would like to prevent that at any cost.There is anyway this can be solved?I must say this is the backoffice of the website, but soon the user in the frontend will be able to also write more than 1024 characters in a textarea... so if I just change the driver for the backoffice doesn't help, as we will run into the same for our users.

2017-10-16 03:20:24Z

I am having a hard time with the cookie session driver in Laravel.I have a simple form with a validation in place. This is my method for saving this form data:Pretty simple.The problem is that, when using the cookie session driver, if I save this form with a description that's 1024 characters long, I'll get redirected back but with no flash data and no $errors in the view for the next request to handle.Example:This is a POST after using this line:In the description field. 1024 bytes to be exact.Instead, if I just fill the field with some more dummy data but nothing too crazy:If I change the session driver to file:... it works.But this does not fix my problem. I do need to use the cookie driver for session as the production website is running in 3 different datacenters to achieve high availability. Using the cookie for the session allows the user to hit any of the 3 servers and still continue with it's request without having to use any sticky session or any central session driver.Using the database as a driver—which is also in a cluster with HA—is not an option as this is a really high traffic website and that would be a write per request which doesn't sound appealing at all. I would like to prevent that at any cost.There is anyway this can be solved?I must say this is the backoffice of the website, but soon the user in the frontend will be able to also write more than 1024 characters in a textarea... so if I just change the driver for the backoffice doesn't help, as we will run into the same for our users.The cookie session driver is not suitable for applications that must store any significant amount of data in the user's session. Browsers typically limit data stored in one cookie to around 4 KB (4096 bytes). As we found, we can easily exhaust this capacity by attempting to store a 1024-character-long string in the session cookie—the "Lorem ipsum..." string in the question contains only ASCII characters, and each ASCII character is represented using 4 bytes, so 1024 × 4 = 4096 bytes. As we can see, we quickly begin to run out of space when we need to store additional items in one session cookie, such as the serialization metadata for PHP values, or when the data contains UTF-8 characters that consume more than 4 bytes per character. To continue to use cookies to store session data greater than 4 KB, we'd need to write a custom session driver that partitions session data across multiple cookies for each response and then reassembles them on each request. For good reason, no existing packages do this that I'm aware of. This brings me to my next point...I want to strongly discourage the use of cookies for storing a full session (instead of just a session ID). This approach can expose security vulnerabilities, adds overhead to requests and responses (including requests for static assets on the same domain), risks desynchronizing data (right-click app tab → Duplicate to see what happers), complicates tests and debugging, and causes problems when storing certain kinds of data.For the distributed application in the question, we have four options: I think we can reasonably eliminate the fourth option. Unless we have a very good reason to avoid using the first three approaches, and for typical applications we usually don't, we cannot justify the amount of work, complexity, and overhead needed to build a system to transfer session data back and forth across HTTP when the first three options are standard, widely-accepted solutions. Based on the information in the question, it sounds to me like you already understand the concepts and implications behind the other three options, so I won't elaborate on explanations for each one (but do comment to let me know if I should). For applications without advanced infrastructure requirements, I recommend the third approach: sticky sessions. These are relatively easy to set up and usually require configuration on the load balancer so that once a client starts a session with an application server, the load balancer routes any subsequent requests to the same server until the session ends. For high-availability, we can combine this approach with the Redis session driver and Redis servers configured for master-slave replication between the datacenters, and, optionally, Redis Sentinel to automate failover. Redis suits session data well and offers better performance than a relational database. If we have multiple application instances at each data center, Redis provides a central location for session data for all instances at one site.For completeness, and to directly answer the question, here's an overview for the development needed to create a cookie-based session driver that handles session data greater than 4 KB. Again, I recommend one of the other approaches described above: If you do decide to go down this path, be sure to test the implementation in every browser you plan to support, as different browsers impose their own limitations on the size and quantity of cookies. Even if we've increased the amount of session data we can store as cookies, we're still limited to the maximum number of cookies a browser will accept per domain.As a final note, storing sessions in the database may not impact performance as much as you think. It could be worth measuring the actual load created by this simple solution before investing many hours optimizing for a concern that might not be a real issue.The browser has limitation of cookie. It's too large for the browser to store the cookie while you use cookie as the session driver. You can check the browser cookie limitation here http://browsercookielimits.squawky.net/  Recommendation:

Use redis as the session driver.Steps:

 1.After installed Redis server, add the predis/predis package:2.Change your configuration file config/database.php:

How to test file upload with laravel and phpunit?

Jasper Kennis

[How to test file upload with laravel and phpunit?](https://stackoverflow.com/questions/33281614/how-to-test-file-upload-with-laravel-and-phpunit)

I'm trying to run this functional test on my laravel controller. I would like to test image processing, but to do so I want to fake image uploading. How do I do this? I found a few examples online but none seem to work for me. Here's what I have:But the controller doesn't get passed this check:So somehow the file isn't passed correctly. How do I go about this?

2015-10-22 12:57:27Z

I'm trying to run this functional test on my laravel controller. I would like to test image processing, but to do so I want to fake image uploading. How do I do this? I found a few examples online but none seem to work for me. Here's what I have:But the controller doesn't get passed this check:So somehow the file isn't passed correctly. How do I go about this?Docs for CrawlerTrait.html#method_action reads:So I assume the correct call should beunless it requires non-empty wildcards and cookies.For anyone else stumbling upon this question, you can nowadays do this:With phpunit you can attach a file to a form by using attach() method.Example from lumen docs:Here is a full example how to test with custom files. I needed this for parsing CSV files with known format so my files had to had exact formatting and contents. If you need just images or random sized files use $file->fake->image() or create() methods. Those come bundled with Laravel.Here is the controller to go with it:The best and Easiest way : First Import the Necessary thingsThen make a fake file to upload.Then make a JSON Data to pass the file. ExampleThen send the Data to your API.I hope it will work.Add similar setUp() method into your testcase:This will spoof your $_FILES global and let Laravel think that there is something uploaded.

Install multiple laravel projects in subfolders without subdomain

Rodrigo Souza

[Install multiple laravel projects in subfolders without subdomain](https://stackoverflow.com/questions/36404259/install-multiple-laravel-projects-in-subfolders-without-subdomain)

I already tried to search for this issue, but it's all different from mine, so I'm posting this here. I'm trying to create a webserver using nginx to host multiple laravel projects in subfolders. It's my labs server. So I'd like to have my projects like this:I'm copying the following nginx location block for each project (i don't know what's happening here, I just copied from the internet and it worked):And RESTful routes in my laravel app like this:

    

Although it seems to work (the page appears, etc) when it goes into bussiness logic (save to database, etc.) it appears to have many bugs. For example when I try to create a new employee in url http://domain.com/project1/administracao/funcionarios it gives me the error: SQLSTATE[42S22]: Column not found: 1054 Unknown column '/administracao/funcionarios' in (it's kinda prepending some url routes)And when I setup a subdomain like project1.domain.com everything works fine. But I don't want to create a subdomain for each project, I want it to work in subfolders url. Is it possible?

2016-04-04 13:37:14Z

I already tried to search for this issue, but it's all different from mine, so I'm posting this here. I'm trying to create a webserver using nginx to host multiple laravel projects in subfolders. It's my labs server. So I'd like to have my projects like this:I'm copying the following nginx location block for each project (i don't know what's happening here, I just copied from the internet and it worked):And RESTful routes in my laravel app like this:

    

Although it seems to work (the page appears, etc) when it goes into bussiness logic (save to database, etc.) it appears to have many bugs. For example when I try to create a new employee in url http://domain.com/project1/administracao/funcionarios it gives me the error: SQLSTATE[42S22]: Column not found: 1054 Unknown column '/administracao/funcionarios' in (it's kinda prepending some url routes)And when I setup a subdomain like project1.domain.com everything works fine. But I don't want to create a subdomain for each project, I want it to work in subfolders url. Is it possible?I have successfully run a Laravel 5.4 project in a "subfolder" of another site by using a simple symlink. There was no funky special rewrite rules in the Nginx configuration. No copy & paste of sections of the project. No mention of the subfolder in the routes. Just a regular Laravel 5 project neatly contained somewhere on the server and a symlink to it's public folder from the main site's document root. All the routes just work! When writing your views you do have to wrap the paths for client-side assets in asset() helper function so the paths in the HTML will contain the subfolder and the browser can find them. But doing that does not make your code less flexible, because if you do run the site in an environment where it is not accessed via a subfolder, it works because asset() works with what the address bar contains. Recently I had the exact same problem. I wanted to havebut I hated having to modify nginx conf every time I added a new project.Here's what I came up with:The result is that I don't have to do ANYTHING other than git clone in /sites/customerdemo.example.com/ folder and run composer install and php artisan migrate to add a new project.Actually, I have developed myself a control panel where I can click on "Add project" and specify project details and a new bitbucket repo, mysql user and database will be created and customerdemo server will be given deploy access to this bitbucket repo and a webhook is set up in this new repo which will call a deployment script on customerdemo server each time someone commits to master on this repo which will trigger either git clone or git pull and composer install and database migration. That's why I needed dynamic Nginx configuration. ;-)I think the problem might be in your nginx.conf file. Try this:Also, please be sure that /home/web/project1/ is outside of your web root.This being said, it is really not recommended to run Laravel in a subfolder. Much easier in a subdomain.I got the basic idea for this suggestion from this gist.Not completely sure about the solution, but I think you should try these ones:In last instance, var_dump the model and look for where it comes from.have you tried this configuration ?https://gist.github.com/tsolar/8d45ed05bcff8eb75404I will test tomorrow as soon I have time to replicate your situation in my env.There is a simple solution to " I want it to work in subfolders url. Is it possible?".Steps

 1. make folder inside of your main domain public folder.

 you need to create 3 folders 

home/web/public/project1

home/web/public/project2

home/web/public/project3

 2. Inside each project folder you need to paste the content of the public folder of your laravel app

(from your Laravel Project) project1/public/{contents}  -- copy this to -->(hosted server) home/web/public/project1/{contents} require __DIR __.'/../../PROJECTONE/bootstrap/autoload.php';$app = require_once __DIR __.'/../../PROJECTONE/bootstrap/app.php';try something like this .... I'm using following .conf for my server :Check this Nginx configuration I believe it will helps you 

Laravel migrations/db:seed super slow

JSelser

[Laravel migrations/db:seed super slow](https://stackoverflow.com/questions/31706146/laravel-migrations-dbseed-super-slow)

I recently upgraded from my old Windows computer into a gen. 4 I7 Ubuntu 15.04Runs like a dream, well...Except that any Laravel artisan command that touch the database takes a million years to complete, while my old computer performed any of those commands in seconds.The major difference is that instead of XAMPP I'm running MySQL as a local service.Also in my old computer I could see how migrations slowly showed on screen as they appear to be processed while now, it takes like 2~5 minutes and when done the whole migration list is shown at once.

This could indicate a bottle neck of sort somewhere.Somewhere around the internet someone said to use '127.0.0.1' instead of 'localhost' because of DSN resolution. Didn't solve it.To make sure that's not the issue i ran~halpEditI collected the running times for each query from the framework, I have LOTS of migrations, analyzing the data I found there's nothing insanely slow (like a query running for a minute). Here's a link with the data. Actual queries were ommited in favor of my employer. Although there's many queries running for a second or longer, the slowest, number 221 takes a whoping 3.5 seconds. I have around a hundred migrations(I know) but here's the thing, if each migration took a second I'd be waiting around a minute and a half to migrate, but it often takes from 4 to 5 minutes.As suggested by oliverpool, I did some profiling by replaying queries on the mysql via terminal, but I never had to wait longer than a second with the average query taking around thenth of a second.Here is a pic of the profiling for the slowest query (3.5secs in migration, not close to a second in the pic)Maybe this points towards the connection? By the way the slow query log is empty after running the migrations.Also, I'm using laravel 5 now and the behaviour is the same. I dont know how to trouble shoot connection so I guess some googling is in order, any suggestions are welcome.Thanks in advance.

2015-07-29 16:29:06Z

I recently upgraded from my old Windows computer into a gen. 4 I7 Ubuntu 15.04Runs like a dream, well...Except that any Laravel artisan command that touch the database takes a million years to complete, while my old computer performed any of those commands in seconds.The major difference is that instead of XAMPP I'm running MySQL as a local service.Also in my old computer I could see how migrations slowly showed on screen as they appear to be processed while now, it takes like 2~5 minutes and when done the whole migration list is shown at once.

This could indicate a bottle neck of sort somewhere.Somewhere around the internet someone said to use '127.0.0.1' instead of 'localhost' because of DSN resolution. Didn't solve it.To make sure that's not the issue i ran~halpEditI collected the running times for each query from the framework, I have LOTS of migrations, analyzing the data I found there's nothing insanely slow (like a query running for a minute). Here's a link with the data. Actual queries were ommited in favor of my employer. Although there's many queries running for a second or longer, the slowest, number 221 takes a whoping 3.5 seconds. I have around a hundred migrations(I know) but here's the thing, if each migration took a second I'd be waiting around a minute and a half to migrate, but it often takes from 4 to 5 minutes.As suggested by oliverpool, I did some profiling by replaying queries on the mysql via terminal, but I never had to wait longer than a second with the average query taking around thenth of a second.Here is a pic of the profiling for the slowest query (3.5secs in migration, not close to a second in the pic)Maybe this points towards the connection? By the way the slow query log is empty after running the migrations.Also, I'm using laravel 5 now and the behaviour is the same. I dont know how to trouble shoot connection so I guess some googling is in order, any suggestions are welcome.Thanks in advance.In this case, I think that the buffer pool size increment is required. Set the following:

Handling Mysql Spatial datatypes in Laravel Eloquent ORM

Jithin Jose

[Handling Mysql Spatial datatypes in Laravel Eloquent ORM](https://stackoverflow.com/questions/30682538/handling-mysql-spatial-datatypes-in-laravel-eloquent-orm)

How to handle mysql spatial datatypes in eloquent ORM?, This include how to create migration, insert spatial data and performing spatial query's. If there is not actual solutions exists, is there any workarounds?

2015-06-06 11:54:11Z

How to handle mysql spatial datatypes in eloquent ORM?, This include how to create migration, insert spatial data and performing spatial query's. If there is not actual solutions exists, is there any workarounds?A workaround I have implemented a while ago is to have a latitude and longitude fields on the model with the following validations (see Validator class):The magic comes on the boot method of the model, which sets the correct value of the spatial point field:About migrations, like @jhmilan says you can always use the Schema::create and DB::statement methods to customize the migration.It is available to use https://github.com/grimzy/laravel-mysql-spatialyou may use:then you are able to run queries on the 'location' field.to store model you may use:to retrieving a model you should use:

How to create the migrations for database views using php artisan in Laravel?

rc.adhikari

[How to create the migrations for database views using php artisan in Laravel?](https://stackoverflow.com/questions/36287364/how-to-create-the-migrations-for-database-views-using-php-artisan-in-laravel)

Actually, I have managed to create a sql views for Laravel using PHP Artisan using below step.Step 1. Run below command:Step 2.Open the migration file and add the below code:Step 3. To call and run the SQL Views via Laravel queryHope that helps. Please let me know if anyone has better solution!!

2016-03-29 14:33:46Z

Actually, I have managed to create a sql views for Laravel using PHP Artisan using below step.Step 1. Run below command:Step 2.Open the migration file and add the below code:Step 3. To call and run the SQL Views via Laravel queryHope that helps. Please let me know if anyone has better solution!!Stumbled on the same issue and found the solution @ http://programmingarehard.com/2013/11/10/eloquent_and_views.html/I've created a package for creating, renaming and dropping views:

https://github.com/staudenmeir/laravel-migration-viewsYou can provide a query builder instance or an SQL string:You can also try this DB::connection()->getPdo()->exec("your sql query");  it worksWrite your migration like this, with 'CREATE OR REPLACE' in up function:You have to use laravel eloquent an create the relation between in your model.

Forexample:

If you have 2 table (roles , users) and the relation between them  is many to many you have to create to model Role and User after that in Role Model write the code below:

    public function users()

    {

    return $this->belongaToMany('App/User');

    }and in User model:after that create a new migration and put the table name role_user and put the code below into this:Save it and run php artisan migrate.

Its finished and now you have many to many relation.

After all of this for geting query forexample for related role to a user add your User and Role model to your controler an do like this:and to show the selected roles into your view write:Its finished.

Generate HTML to show custom questions with the correct type (text, checkbox, …) and add the required attribute properly

johnW

[Generate HTML to show custom questions with the correct type (text, checkbox, …) and add the required attribute properly](https://stackoverflow.com/questions/50724984/generate-html-to-show-custom-questions-with-the-correct-type-text-checkbox)

I have a form for a user create custom questions. For that the user needs to introduce the question (ex: Whats your phone?) and also the type of field (text, long text, checkbox, select menu, radio button). If the user selects a field of checkbox, select menu or radio button he also need to introduce the available options for the question.In the database the questions are inserted in the questions and question_options tables like:Questions Table:Registration_type_questions pivot table:The options are stored in the questions_options table:Then in the view I want to show properly in the view registration.blade.php the inputs (text, radio button, checkbox, select, textarea and input file) based on the type stored in the column "type" of the questions table. And also add the required attribute if the required column in the pivot table is "1".When a question is of the type text, radio button, select, textarea or file it is working fine, the required attribute is added to the form field. But it's not working properly with checkboxes because in the case of checkboxes if the question is of type checkbox and the question is required that should mean that the user needs to answer that question but should not mean that the user needs to check all checkboxes. The issue is that with the function getHTMLInput() the generated html for checkboxes have required in each checkbox input and because of that the user needs to check all checkboxes:Do you know how to solve that issue? When a custom question is required that should mean that the question is required so the user should select at least 1 checkbox but should not mean that the user needs to check all checkboxes.And also do you know how to, if the custom question is required add inside each question label this "<span class="text-primary">*</span>"?GetHtmlInput() in the Question model:Then the getHtmlInput() is used like:Generated HTML with getHTMLInput():Also, checking this form in a HTML validator like w3c validator it appears some errors:

2018-06-06 16:11:20Z

I have a form for a user create custom questions. For that the user needs to introduce the question (ex: Whats your phone?) and also the type of field (text, long text, checkbox, select menu, radio button). If the user selects a field of checkbox, select menu or radio button he also need to introduce the available options for the question.In the database the questions are inserted in the questions and question_options tables like:Questions Table:Registration_type_questions pivot table:The options are stored in the questions_options table:Then in the view I want to show properly in the view registration.blade.php the inputs (text, radio button, checkbox, select, textarea and input file) based on the type stored in the column "type" of the questions table. And also add the required attribute if the required column in the pivot table is "1".When a question is of the type text, radio button, select, textarea or file it is working fine, the required attribute is added to the form field. But it's not working properly with checkboxes because in the case of checkboxes if the question is of type checkbox and the question is required that should mean that the user needs to answer that question but should not mean that the user needs to check all checkboxes. The issue is that with the function getHTMLInput() the generated html for checkboxes have required in each checkbox input and because of that the user needs to check all checkboxes:Do you know how to solve that issue? When a custom question is required that should mean that the question is required so the user should select at least 1 checkbox but should not mean that the user needs to check all checkboxes.And also do you know how to, if the custom question is required add inside each question label this "<span class="text-primary">*</span>"?GetHtmlInput() in the Question model:Then the getHtmlInput() is used like:Generated HTML with getHTMLInput():Also, checking this form in a HTML validator like w3c validator it appears some errors:It is because you have the checkbox group html inside your foreach loop here:You need to think about how you would get around this maybe using a variable like $checkboxesFound and set it to 0 at the start of the function and when case is checkbox, increment the variable, and if $checkboxesFound == 0 then echo the group div.Replace your getHtmlInput() with thisandblade code with thisyou need to set the name attribute same of same group options in order to work required option properly.But in your code all options including of different option groups are sharing same name attribute.The above code is not tested. But I hope it will work for youHTML5 doesn't have a solution to implement that a group of checkboxes should be required, so with some changes you could achieve it. First on your controller you will need to change it to achieve the same you are doing with your select menu.Then in your case 'checkbox' you would only need to print the options that will be inside your 'required group of checkboxs':This should output the following html:Then  on submit, I don't know if you do it with ajax or not but I'll assume you do not, so if you add an id to your form -> id="questionForm"Unfortunately there is no way to achieve what you are looking for  using only html5, whatever solution you choose it will probably have to be done with js.

Extend Blueprint class?

mpen

[Extend Blueprint class?](https://stackoverflow.com/questions/22444685/extend-blueprint-class)

I want to override the timestamps() function found in the Blueprint class. How can I do that?e.g.,

2014-03-16 23:44:37Z

I want to override the timestamps() function found in the Blueprint class. How can I do that?e.g.,There is a new blueprintResolver function which takes a callback function which then returns the Blueprint instance.So create your custom Blueprint class like this:And then call the blueprintResolver function where you return your CustomBlueprint instance. I'm not sure if creating a new schema instance with  DB::connection()->getSchemaBuilder(); is state of the art but it works.You could additionally override the Schema facade and add the custom blueprint by default.Just to add a few points to Marcel Gwerder's answer (which is already great):

(edit 2016-03-06)A GitHub issue has been recently opened about this: #12539.Marcel Gwerder's answer was a life saver. Like some of the users commented there, I wondered if this could be done more automagically. My goal was similarly to overwrite the timestamps method. After some tinkering, this is what I ended up with which is working for me:I created a file at app/Classes/Database/Blueprint.php:I created a file at app/Facades/Schema.phpInside config/app.php I updated the alias for Schema as follows:Now, in my migrations, like the below, when I call timestamps(), it calls my overwritten method.

Two models into one paginated query with eager loaded relations using Laravel

whoacowboy

[Two models into one paginated query with eager loaded relations using Laravel](https://stackoverflow.com/questions/33354721/two-models-into-one-paginated-query-with-eager-loaded-relations-using-laravel)

I have two  Models that I would like to merge into one timeline. I have been able to do this by creating a View in mysql that normalizes and unions the tables. I created a Model for this view, NewsFeed. This works well if I do not want related Comment model. I have gotten close to this by overriding the getMorphClass method on the model. This allows me to get the related comments for the pictures, but not the posts, because when getMorphClass is called the model doesn't have any data. I am open to any approach on how to solve this, not just the way I am proposing, but I don't want to pull more data than I have to from the database.NewsFeedMySQL Viewpictures tableposts

2015-10-26 20:11:28Z

I have two  Models that I would like to merge into one timeline. I have been able to do this by creating a View in mysql that normalizes and unions the tables. I created a Model for this view, NewsFeed. This works well if I do not want related Comment model. I have gotten close to this by overriding the getMorphClass method on the model. This allows me to get the related comments for the pictures, but not the posts, because when getMorphClass is called the model doesn't have any data. I am open to any approach on how to solve this, not just the way I am proposing, but I don't want to pull more data than I have to from the database.NewsFeedMySQL Viewpictures tablepostsYou are really close with your idea to build a view. In fact, if you create an actual table instead of a view, the solution becomes quite simple.With a 'FeedItem' polymorph object that points to your Post class or Picture class, you can attach the comments directly to the FeedItem with a hasMany relationship.This solution may require some refactoring on your forms since you will need to create a FeedItem entry for each Post entry and Picture entry. Event listeners for Picture::created and Post::created should do the trick (http://laravel.com/docs/5.1/eloquent#events).Once it's set up, you can use:Although I am not familiar with Laravel nor Eloquent for that matter, Here's my input on this.Assuming you're getting the output from that SQL view into $EntriesAs I understand Eloquent allows you to set the values for yourself, therefore something like this might work for you (I am not sure about the syntax or usage for that matter).

Laravel 5.3 - Clear config cache in shared hosting

Wahyu Handy

[Laravel 5.3 - Clear config cache in shared hosting](https://stackoverflow.com/questions/41521837/laravel-5-3-clear-config-cache-in-shared-hosting)

Currently I'm working on small project that require me to host my laravel app on shared hosting (please ignore the reason why I didn't use VPS to host my laravel project) and this hosting provider disable escapeshellarg() for security reason so I can't use php artisan config:cache to clear config cache.Is there any workaround for this?

2017-01-07 13:15:07Z

Currently I'm working on small project that require me to host my laravel app on shared hosting (please ignore the reason why I didn't use VPS to host my laravel project) and this hosting provider disable escapeshellarg() for security reason so I can't use php artisan config:cache to clear config cache.Is there any workaround for this?config:clear command just deletes bootstrap/cache/config.php file, so just delete this file manually.You can call artisan commands programmaticallyThis can be helpful in setups where the PHP user has a different set of permissions than the FTP user (so files created by PHP cannot be deleted via FTP)Try also for command lineusing artisan commandshttps://www.tutsmake.com/laravel-clear-cache-using-artisan-command-cli/

Laravel validation checkbox

Sander Van Keer

[Laravel validation checkbox](https://stackoverflow.com/questions/37345363/laravel-validation-checkbox)

I am using the laravel register function to register a user. I added a checkbox where the user needs to accept the terms and conditions. I only want to user to register when the checkbox is checked. Can I use the 'required' validation in laravel? This is my validation function:When I use the function like this, laravel gives the required error for the checkbox even if it is checked. This is the html of the checkboxI hope you guys can help me!

2016-05-20 11:19:53Z

I am using the laravel register function to register a user. I added a checkbox where the user needs to accept the terms and conditions. I only want to user to register when the checkbox is checked. Can I use the 'required' validation in laravel? This is my validation function:When I use the function like this, laravel gives the required error for the checkbox even if it is checked. This is the html of the checkboxI hope you guys can help me!Use the accepted rule.Sample for your case:It will work, just be sure the input value will not be an empty string or false. And 'checkbox' =>'required' is ok as long as the key is the value of the input name attribute.I just had a big frustration, because the code i'm using returns the checkbox value as a boolean value.If you have a similar situation you can use the following rule:Use  required_without_all for checkbox :Refer : https://laravel.com/docs/5.1/validation#available-validation-rulesYour validation rules must corrolate with the name attributes of your html form fields:

revert 'php artisan serve' command in laravel

halkujabra

[revert 'php artisan serve' command in laravel](https://stackoverflow.com/questions/23932127/revert-php-artisan-serve-command-in-laravel)

I have a laravel app. I ran 'php artisan serve' command for local testing and my app was served at localhost:8000. But now I want to stop serving it at localhost:8000 ie., I want it not to serve now. I closed the command line, restarted the server but it is still serving. How can it be done?Note: I am using windows for testing purposes.

2014-05-29 11:19:54Z

I have a laravel app. I ran 'php artisan serve' command for local testing and my app was served at localhost:8000. But now I want to stop serving it at localhost:8000 ie., I want it not to serve now. I closed the command line, restarted the server but it is still serving. How can it be done?Note: I am using windows for testing purposes.Press Ctrl + Shift + ESC. Locate the php process running artisan and kill it with right click -> kill process.Reopen the command-line and start back the server.Note that you should be able to kill the process just by sending it a kill signal with Ctrl + C.here is what i do 

press ctrl+ cto check if the port is busy or not  if any process is listening to the port 8000 it will be displayed with port id kill the process that listen to that port id run lsof agin volaI used Ctrl + C in my mac for stop the command php artisan laravel serveFor windows user, type this command for showing the list of current running php artisan process:Will show:Look up PID number (XXXX), and type this to kill the process:Windows 10 with XAMPP server depending on what shell you use to run:In Windows CMD: CTRL + C

In XAMPP Shell: CTRL + Pause/Break

In Ubuntu and RedHat/CentOS terminal  it's: CTRL + CCtrl + Pause|Break should do it for Windows.If your using VS Code, simply do the following:This deletes the shell and kills the server.When I use cygwin to run my php artisan serve on Windows machine, pressing ctrl + c does not kill the process. To stop it, use @jsalonen's solution. Basically you are looking for this then kill it:

How to get last insert id in Eloquent ORM laravel

Deenadhayalan Manoharan

[How to get last insert id in Eloquent ORM laravel](https://stackoverflow.com/questions/27873777/how-to-get-last-insert-id-in-eloquent-orm-laravel)

I am performing a database operation with "Eloquent ORM in Laravel". I just want to take the last insert id (not the maximum id) in the database.I searched to get last insert id in laravel Eloquent ORM, I got following link (Laravel, get last insert id using Eloquent) that is refer to get last insert id from following function "$data->save()".But I need to get "Model::create($data)";My Query:How can I retrieve the last inserted id?

2015-01-10 07:12:19Z

I am performing a database operation with "Eloquent ORM in Laravel". I just want to take the last insert id (not the maximum id) in the database.I searched to get last insert id in laravel Eloquent ORM, I got following link (Laravel, get last insert id using Eloquent) that is refer to get last insert id from following function "$data->save()".But I need to get "Model::create($data)";My Query:How can I retrieve the last inserted id?Like the docs say: Insert, update, delete So in your sample:then on table2 it is going to be**** For Laravel ****You could wrap your data in the insertGetId() method like thisIn this case the array $data would look something like thisand  if you’re using the DB façade you could just append the lastInsertID() method to your query.As others said bfore me you may retrieve id by usingbut only if you are using standard naming convention for eloquent. If you want to use other name for primaryKey column, eg:you may retrieve last inserted id by callingIt is described in: https://laravel.com/docs/master/eloquent#eloquent-model-conventions where one can find:You may do it as,Hope this will help you.This is my try:And use $model_ins->id.This code works with Laravel 5.3:User pages/site I was call data.idThis is an eloquent model:A solution using Query Builder:This is my solution. I return the inserted object and get its ID or any other property.This is an easier way that works on all of the ways that you inserted:

Laravel 5.3 return custom error message using $this->validate()

cmac

[Laravel 5.3 return custom error message using $this->validate()](https://stackoverflow.com/questions/40067212/laravel-5-3-return-custom-error-message-using-this-validate)

How to return a custom error message using this format?

2016-10-16 05:35:15Z

How to return a custom error message using this format?to get custom error message you need to pass custom error message on third parameter,like that For Multiple Field, Role and Field-Role Specific Messagehttps://laravel.com/docs/5.3/validation#working-with-error-messages"In most cases, you will probably specify your custom messages in a language file instead of passing them directly to the Validator. To do so, add your messages to custom array in the resources/lang/xx/validation.php language file."You need to first add following lines in view page where you want to show the Error message:Here is a demo controller by which error message will appear on that page:For details You can follow the Blog post. 

Besides that you can follow laravel official doc as well Validation. 

Laravel 4 - how to return all validation error messages for all fields as a JSON structure?

mtmacdonald

[Laravel 4 - how to return all validation error messages for all fields as a JSON structure?](https://stackoverflow.com/questions/19422259/laravel-4-how-to-return-all-validation-error-messages-for-all-fields-as-a-json)

I'm upgrading from Laravel 3 to Laravel 4. My app has some AJAX-only forms that are rendered client-side (i.e. there are no server-side views). Therefore, instead of passing validation errors to views with the withErrors() method, I've been returning the validation error objects to the client as JSON structures.  In Laravel 3, I had this:But in Laravel 4, the error messages are protected:var_dump($validation->messages()) returns:json_encode($validation->messages) returnsQuestion: how do I return all the validation error messages for all fields as a JSON structure in Laravel 4?

2013-10-17 08:59:49Z

I'm upgrading from Laravel 3 to Laravel 4. My app has some AJAX-only forms that are rendered client-side (i.e. there are no server-side views). Therefore, instead of passing validation errors to views with the withErrors() method, I've been returning the validation error objects to the client as JSON structures.  In Laravel 3, I had this:But in Laravel 4, the error messages are protected:var_dump($validation->messages()) returns:json_encode($validation->messages) returnsQuestion: how do I return all the validation error messages for all fields as a JSON structure in Laravel 4?Simply use toJson() method.Here is another way that let u add HTTP code to the response:I discovered it was possible to use the toArray() method:I think that this is the Laravel way to get the error messages. There are special methods to get them. So here how I do this stuff:This produces output in the following format:

Convert laravel object to array

Your Friend

[Convert laravel object to array](https://stackoverflow.com/questions/26174267/convert-laravel-object-to-array)

Laravel output:I want to convert this into normal array. Just want to remove that stdClass Object. I also tried using ->toArray(); but I get an error:How can I fix this?Functionalities have been Implemented on http://www.srihost.com

2014-10-03 06:32:01Z

Laravel output:I want to convert this into normal array. Just want to remove that stdClass Object. I also tried using ->toArray(); but I get an error:How can I fix this?Functionalities have been Implemented on http://www.srihost.comUPDATE since version 5.4 of Laravel it is no longer possible.You can change your db config, like @Varun suggested, or if you want to do it just in this very case, then:For New Laravel above 5.4 (Ver > 5.4) 

see https://laravel.com/docs/5.4/upgrade fetch mode sectionOr when toArray() fails because it's a stdClass Not working? Maybe you can find your answer here:Convert PHP object to associative arrayYou can also get all the result always as array by changingHope this will help.this worked for me:or Just in case somebody still lands here looking for an answer. It can be done using plain PHP. 

An easier way is to reverse-json the object. this worked for me in laravel 5.4outputhttps://laravel.com/docs/5.4/collections#method-allYou need to iterate over the arrayans use (array) conversion because you have array of objects of Std class and not object itselfExample:Output for this is:as expected. Object of stdClass has been converted to array.If you want to get only ID in array, can use array_map:With that, return an array with ID in every pos.Its very simple. You can use like this :-Hope it helpsIt's also possible to typecast an object to an array. That worked for me here.(array) $object;will converttoHad the same problem when trying to pass data from query builder to a view. Since data comes as object. So you can do:And in your view you use variables likeI suggest you simply do this within your methodWith this all you need is to pass the string 'array' as your argument and Voila! An Associative array is returned.$foo = Bar::getBeers();

$foo = $foo->toArray();I use get(), it returns an object, I use the attributesToArray() to change the object attribute to an array.

Set session variable in laravel

user3429578

[Set session variable in laravel](https://stackoverflow.com/questions/28417796/set-session-variable-in-laravel)

I would like to set a variable in the session using laravel this waybut the problem is that I don't know where to put this code, 'cause I would like to set it for one time (when the guest visite the home page or any other page)?

The main idea is to use a global variable to use it in all application controllers, I heared about something related to configuration variables but I'm not sure if it will be a good Idea to use config variables or only the session?

Thanks

2015-02-09 19:33:30Z

I would like to set a variable in the session using laravel this waybut the problem is that I don't know where to put this code, 'cause I would like to set it for one time (when the guest visite the home page or any other page)?

The main idea is to use a global variable to use it in all application controllers, I heared about something related to configuration variables but I'm not sure if it will be a good Idea to use config variables or only the session?

ThanksThe correct syntax for this is...For Laravel 5.4 and later, the correct method to use is put.To get the variable, you'd use...If you need to set it once, I'd figure out when exactly you want it set and use Events to do it.  For example, if you want to set it when someone logs in, you'd use...I think your question ultimately can be boiled down to this:The obvious answer is that it depends.  What it depends on are a couple of factors:ConfigIf the value is the same for everyone and will seldom change, the best place to probably put it is in a configuration file somewhere underneath app/config, e.g. app/config/companyname.php:You could access this value from anywhere in your application via Config::get('companyname.somevalue')SessionIf the value you are intending to store is going to be different for each user, the most logical place to put it is in Session.  This is what you allude to in your question, but you are using incorrect syntax.  The correct syntax to store a variable in Session is:The correct syntax to retrieve it back out later is:As far as when to perform these operations, that's a little up to you.  I would probably choose a route filter if on Laravel 4.x or Middleware if using Laravel 5.  Below is an example of using a route filter that leverages another class to actually come up with the value:In Laravel 5.6, you will need to set it asTo retrieve it is as simple as in Laravel 5.4use this method:For example, To store data in the session, you will typically use the putmethod or the session helper:orfor retrieving an item from the session, you can use get :or global session helper : To determine if an item is present in the session, you may use the has method:You can try To add to the above answers, ensure you define your function like this:Note the "(Request $request)", now set a session like this:And retrieve the session in this way:To erase the session try this:orIn Laravel 6.xhttps://laravel.com/docs/6.x/sessionto set session you can try this:also to get session data you can try this:If you want to get all session data:

Using a Progress Bar while Seeding a database in Laravel

Sevenearths

[Using a Progress Bar while Seeding a database in Laravel](https://stackoverflow.com/questions/37319676/using-a-progress-bar-while-seeding-a-database-in-laravel)

I have to seed quite a lot of data into a database and I want to be able to show the user a progress bar while this happens. I know this is documented:but I'm having problems including it in my seeder.orfrom https://mattstauffer.co/blog/advanced-input-output-with-artisan-commands-tables-and-progress-bars-in-laravel-5.1Any ideas?

2016-05-19 09:51:28Z

I have to seed quite a lot of data into a database and I want to be able to show the user a progress bar while this happens. I know this is documented:but I'm having problems including it in my seeder.orfrom https://mattstauffer.co/blog/advanced-input-output-with-artisan-commands-tables-and-progress-bars-in-laravel-5.1Any ideas?You can get access to output through $this->command->getOutput()Your code isn't working because you're using $this->output in the wrong class. If you take a look again to the article you shared, $this-output is used in an Artisan command class.In fact, every Artisan command is made with the Symfony Console component.You're actually trying to use it in a database seeder :)My suggestion: build your seeders and then call them with an "install" or "seed" customized command for your needs.Here is my implementation code,Just in case anyone else comes across a similar scenario and is looking for a solution I created the following base class:And then used it something like this...

Laravel - htmlspecialchars() expects parameter 1 to be string, object given

Kiddo

[Laravel - htmlspecialchars() expects parameter 1 to be string, object given](https://stackoverflow.com/questions/43217872/laravel-htmlspecialchars-expects-parameter-1-to-be-string-object-given)

I go this error: I'm using in controller:And i send it to the view as array: 'data' => $newData

And when i try to use $data into the view, it give me that errorTried already to use $data->ac OR $data['ac'] but still the same...

Some help, please?

2017-04-04 21:18:27Z

I go this error: I'm using in controller:And i send it to the view as array: 'data' => $newData

And when i try to use $data into the view, it give me that errorTried already to use $data->ac OR $data['ac'] but still the same...

Some help, please?When you use a blade echo {{ $data }} it will automatically escape the output. It can only escape strings. In your data $data->ac is an array and $data is an object, neither of which can be echoed as is. You need to be more specific of how the data should be outputted. What exactly that looks like entirely depends on what you're trying to accomplish. For example to display the link you would need to do {{ $data->ac[0][0]['url'] }} (not sure why you have two nested arrays but I'm just following your data structure).if your intention is send the full array from the html to the controller, can use this:from the blade.php:in controllerYou could use serializeBut best way in this case use the json_encode method in your blade and json_decode in controller.This is the proper way to access data in laravel :

413 Request Entity Too Large

AhmedShawky

[413 Request Entity Too Large](https://stackoverflow.com/questions/26608606/413-request-entity-too-large)

I use nginX/1.6 and laravel when i posted data to server i get this error 413 Request Entity Too Large. i tried many solutions as bellowAfter restarting php5-fpm and nginx the problem still not solved

2014-10-28 12:39:42Z

I use nginX/1.6 and laravel when i posted data to server i get this error 413 Request Entity Too Large. i tried many solutions as bellowAfter restarting php5-fpm and nginx the problem still not solvedAdd ‘client_max_body_size xxM’ inside the http section in /etc/nginx/nginx.conf, where xx is the size (in megabytes) that you want to allow.I had the same issue but in docker. when I faced this issue, added client_max_body_size 120M; to my Nginx server configuration,nginx default configuration file path is /etc/nginx/conf.d/default.confit resizes max body size to 120 megabytes.after that, I did add these three lines to my PHP docker file since docker PHP image automatically includes all setting files from the path (/usr/local/etc/php/conf.d/) into php.ini file, PHP configuration file will change by these three lines and the issue must disappear

Run Laravel 5 seeder programmatically instead of from CLI

geoffs3310

[Run Laravel 5 seeder programmatically instead of from CLI](https://stackoverflow.com/questions/28799779/run-laravel-5-seeder-programmatically-instead-of-from-cli)

Is there a way to run the Laravel 5 seeder from within PHP rather than from the command line. The hosting I am using doesn't allow me to use the command line. Just to confirm I want to do the equivalent of this but in my app code:

2015-03-01 22:11:47Z

Is there a way to run the Laravel 5 seeder from within PHP rather than from the command line. The hosting I am using doesn't allow me to use the command line. Just to confirm I want to do the equivalent of this but in my app code:You can use the following method:To get the output of the last run command, you can use:You can also call directly the Seeder class if needed. 

Just make sure you did a composer dump-autoload if you created your seeder manually. From there code is very straightforward : You can add parameters to the seeder on runexample//school meal

Laravel 5.2 Auth not Working

Hassan Saqib

[Laravel 5.2 Auth not Working](https://stackoverflow.com/questions/34548061/laravel-5-2-auth-not-working)

As you guys know Laravel 5.2 was released a few days ago. I am trying this new version. I made a new project using the following command on CLI:As per documentation of Authentication Quickstart, I followed the following command  to scaffold  routes and views of authentication:It worked fine. Registration is working fine. But I am facing problem in Login. After login I tested following in route.php file:Auth::user() is returning null and also Auth::check() and Auth::guest() are not working appropriately. I have tried same thing again and again two three times by making new projects but couldn't get the correct results.Below is the complete route.phpCan anyone help me? or Is anyone facing the same problem? How can I fix it?

2015-12-31 14:55:53Z

As you guys know Laravel 5.2 was released a few days ago. I am trying this new version. I made a new project using the following command on CLI:As per documentation of Authentication Quickstart, I followed the following command  to scaffold  routes and views of authentication:It worked fine. Registration is working fine. But I am facing problem in Login. After login I tested following in route.php file:Auth::user() is returning null and also Auth::check() and Auth::guest() are not working appropriately. I have tried same thing again and again two three times by making new projects but couldn't get the correct results.Below is the complete route.phpCan anyone help me? or Is anyone facing the same problem? How can I fix it?Laravel 5.2 introduces the middleware groups concept: you can specify that one or more middleware belongs to a group, and you can apply a middleware group to one or more routesBy default Laravel 5.2 defines a group named web, used to group the middleware handling session and other http utilities:So, if you want session handling, you should use this middleware group for all the routes in which you want to use authentication:UPDATE FOR LARAVEL VERSION >= 5.2.27As of Laravel 5.2.27 version, all the routes defined in routes.php are using by default the web middleware group. That is achieved in app/Providers/RouteServiceProvider.php :So you don't need anymore to add manually the web middleware group to your routes.Anyhow, if you want to use the default authentication for a route, you still need bind the auth middleware to the route

What is the best practice to create a custom helper function in php Laravel 5?

cyber8200

[What is the best practice to create a custom helper function in php Laravel 5?](https://stackoverflow.com/questions/30804201/what-is-the-best-practice-to-create-a-custom-helper-function-in-php-laravel-5)

the default created_at date keep printing out as an MySQL format : 2015-06-12 09:01:26. I wanted to print it as my own way like 12/2/2017, and other formats in the future.a file called DataHelper.php and store it at /app/Helpers/DateHelper.php - and it looks like this to be able to called it in my blade view like I'm not sure what to do next.What is the best practice to create a custom helper function in php Laravel 5?

2015-06-12 13:21:32Z

the default created_at date keep printing out as an MySQL format : 2015-06-12 09:01:26. I wanted to print it as my own way like 12/2/2017, and other formats in the future.a file called DataHelper.php and store it at /app/Helpers/DateHelper.php - and it looks like this to be able to called it in my blade view like I'm not sure what to do next.What is the best practice to create a custom helper function in php Laravel 5?That should do it. :)Since your Helper method is static you could add your helper class to config/app alias just like a Facade, like so:Then later in your view:However, if you are also looking for a way to do this without a helper class. You may consider using Mutators and Appends in your model:Later you can do

Laravel - Artisan not working

He Hui

[Laravel - Artisan not working](https://stackoverflow.com/questions/21882897/laravel-artisan-not-working)

I'm aware of the other questions out there, but they are different to my situation.I installed a fresh copy of my own laravel, and I tried running php artisan list, which works.Now, I have a colleague who has installed a copy of laravel himself, and he pushes his entire directory onto a git repository. I pulled the entire branch off the repository, and tried running php artisan list, but nothing happens this time. I mean, literally, nothing happens.Any ideas as to why this is happening?

2014-02-19 14:07:49Z

I'm aware of the other questions out there, but they are different to my situation.I installed a fresh copy of my own laravel, and I tried running php artisan list, which works.Now, I have a colleague who has installed a copy of laravel himself, and he pushes his entire directory onto a git repository. I pulled the entire branch off the repository, and tried running php artisan list, but nothing happens this time. I mean, literally, nothing happens.Any ideas as to why this is happening?Generally speaking, the vendor directory is not committed to VCS, as such, doing a clone on a standard Laravel app won't include all its dependencies.Once you have cloned, doing composer install (or composer update if you want the latest packages as a developer) will fetch the dependencies and allow your app to work.You need to run composer install, so the composer refresh all dependencies, artisan's begin on the middle. That should do the job!My artisan was not working because i had the following lines in my routes.phpI simply commented the exit(). So my code becomes as followsJust to point out some thing to anyone struggling with artisan, as this answer is 1st link in google to artisan CLI empty line:It will print blank line whenever some error happens, even if you have all dependencies installed with composer install. And it won't tell you exactly what is wrong. I couldn't figure it out until I put into artisan file in the root directory this:That forced artisan CLI to show error message and therefore I was able to fix it (my .env file was broken).Hope this helps someone.In my case problem was to connect artisan with database (migrates) i.e. the command was not working.I was running laravel project on 8888 port.

In this case I updated .env file as:

DB_HOST=localhost to DB_HOST=localhost to DB_HOST=127.0.0.1

and DB_PORT=3306 to DB_PORT=8889Cleared cache by running artisan command and run the migrates:

Adjust number of Rows to Form:: Textarea Laravel 5

Jonny C

[Adjust number of Rows to Form:: Textarea Laravel 5](https://stackoverflow.com/questions/30107501/adjust-number-of-rows-to-form-textarea-laravel-5)

How can I control the number of Rows added to a textarea using the Illuminate\Html\FormFacade class?I have added the field into my template.When it gets rendered the textarea has cols="50" and rows="10"I want a way to control these numbers, I have checked the documentation but couldnt spot anything?

2015-05-07 17:03:42Z

How can I control the number of Rows added to a textarea using the Illuminate\Html\FormFacade class?I have added the field into my template.When it gets rendered the textarea has cols="50" and rows="10"I want a way to control these numbers, I have checked the documentation but couldnt spot anything?The options (third parameter) array is actually the attributes array of that element, you so can just pass any 'key' => 'value' and the element will have it as attributes, for example:I have accepted the other answer as it works perfectly.I have also found that the class actually checks for an attribute size Its a minor space saving, Im not sure it makes the code anymore readable, but it is an alternative to cut off a few charactersAlso try this:

Where to put the php artisan migrate command

Tara Prasad Gurung

[Where to put the php artisan migrate command](https://stackoverflow.com/questions/48850813/where-to-put-the-php-artisan-migrate-command)

The services and the task are running welldocker-compose.ymlHere is the dockerfile with which the image is generatedTried adding to the Dockerfile as is commented but didn't solve the problemTried adding on docker-compose as command: php artisan migrate:fresh too Previously was doing this in jenkins to make it work Now dont want it via jenkins

2018-02-18 10:50:10Z

The services and the task are running welldocker-compose.ymlHere is the dockerfile with which the image is generatedTried adding to the Dockerfile as is commented but didn't solve the problemTried adding on docker-compose as command: php artisan migrate:fresh too Previously was doing this in jenkins to make it work Now dont want it via jenkinsThis is how I solved it .Created a bash script called run.sh and added the php artisan migrations commands followed by the php serve command. run.sh Added entrypoint to the Dockerfile removing the CMD  in the end which will run the commands desired.Remove the command from the docker-compose.ymlto run all migrate u need to be inside ur container, for that u need to run ur containers with docker-compose up, here u need to be with terminal in the directory where ur docker-compose.yml file is. after that,and with the same place of docker-compose.yml file, run this commande to be inside ur container : and when u will be inside ur container, go to ur shared app inside the container, i think here is app so cd app.after all of this run :php artisan migrate

How to leverage the glob method of Filesystem class with StorageFacade?

Réjôme

[How to leverage the glob method of Filesystem class with StorageFacade?](https://stackoverflow.com/questions/29729863/how-to-leverage-the-glob-method-of-filesystem-class-with-storagefacade)

This is concerning Laravel 5.I can see in Illuminate\Filesystem\Filesystem a method called glob($pattern, $flags = 0)Unfortunately, this method is not reflected in the default FilesystemAdapter shipped with Laravel 5.This would be great, due to the fact that I would need to do something like Storage::disk('local')->glob([_]*[.blade.php]); (in order to get all stored blade files starting with an underscore.What is the cleanest way to achieve this?

2015-04-19 12:29:23Z

This is concerning Laravel 5.I can see in Illuminate\Filesystem\Filesystem a method called glob($pattern, $flags = 0)Unfortunately, this method is not reflected in the default FilesystemAdapter shipped with Laravel 5.This would be great, due to the fact that I would need to do something like Storage::disk('local')->glob([_]*[.blade.php]); (in order to get all stored blade files starting with an underscore.What is the cleanest way to achieve this?I think you cannot run glob here, but you could get all files and then filter them, for example:Of course you need to decide to use files or allFiles (recursively) depending on your needs. Probably it's not the best solution if you have thousands of files but if you don't it should be enough

How to properly install package in Laravel?

cyber8200

[How to properly install package in Laravel?](https://stackoverflow.com/questions/34726101/how-to-properly-install-package-in-laravel)

Recently, I installed the a package LaravelFacebookSdk.InstallI update my composer.json by adding Then, I run composer update Service ProviderIn my /config/app.php, I add the LaravelFacebookSdkServiceProvider to the providers array.Everything works great. Then, I pushed it to my repository. Here comes the issue !Second developer coming in did a git pull and run composer update He will get an error  is undefine. because, I declared that in my /config/app.php under my providers array.He have to go comment out that line, and run the composer update first. After everything successfully installed, then go back in and uncomment that line back again.Will other developer have to do this each time, we installed a new package ? Am I missing something here ? Please kindly advise if I did anything wrong. 

2016-01-11 16:10:05Z

Recently, I installed the a package LaravelFacebookSdk.InstallI update my composer.json by adding Then, I run composer update Service ProviderIn my /config/app.php, I add the LaravelFacebookSdkServiceProvider to the providers array.Everything works great. Then, I pushed it to my repository. Here comes the issue !Second developer coming in did a git pull and run composer update He will get an error  is undefine. because, I declared that in my /config/app.php under my providers array.He have to go comment out that line, and run the composer update first. After everything successfully installed, then go back in and uncomment that line back again.Will other developer have to do this each time, we installed a new package ? Am I missing something here ? Please kindly advise if I did anything wrong. The problem here is that there is a php artisan clear-compiled command being configured to run before the update process in your composer.json file. And since artisan is an integral part of the Laravel app, it will complain when there's something wrong with the app code. Since you have a reference to a class that is not yet present, it will spit out that RuntimeException. You can fix that by moving that command from the pre-update-cmd list to post-update-cmd list in your composer.json.So change this:To this:Now the clear-compiled command will be run after the update process, when the referenced LaravelFacebookSdkServiceProvider class is present, so no more errors.Instead of running composer update run composer install. There is no need to change the commands in your json file.When you run composer update it will go through all your packages and update to the most recent minor version based on your composer.json then update the composer.lock. This isn't what you want.When you run composer install it will make sure everything in your json file is installed, including packages you just added. This is what your looking for.

Laravel project next to Wordpress project (in public_html folder)

nielsv

[Laravel project next to Wordpress project (in public_html folder)](https://stackoverflow.com/questions/38716585/laravel-project-next-to-wordpress-project-in-public-html-folder)

I have a Laravel project in my public_html folder. The domain is for example domain.com My .htaccess file (in public_html folder) is like this:There are the following routes:So an example of a URL is http://domain.com/appointment.Now I would like to have a wordpress website on domain.com. So when you go to domain.com you see the wordpress website. But I also want to have the urls like /appointment of my laravel project.What's the easiest and cleanest way to do this?

2016-08-02 09:25:47Z

I have a Laravel project in my public_html folder. The domain is for example domain.com My .htaccess file (in public_html folder) is like this:There are the following routes:So an example of a URL is http://domain.com/appointment.Now I would like to have a wordpress website on domain.com. So when you go to domain.com you see the wordpress website. But I also want to have the urls like /appointment of my laravel project.What's the easiest and cleanest way to do this?You can create symlink to Wordpress public directory in Laravel folder. For example, wp:And describe Laravel routes in .htaccess. Example of code of /var/www/laravel/public/.htaccess:Code of /var/www/wordpress/public_html/.htaccess (just copy of your wordpress .htaccess):.htaccess files provide a way to make configuration changes on a per-directory basis. This means that you only need to direct the request to the directory that will have rules for how to best process the request. Thus you will leave the .htaccess files that came with both Laravel and WordPress in their directories. Just create another one for the parent directory that holds them both.The below assumes that the full path of public_html is /var/www/public_html.Both Laravel and WordPress have ways to generate links to their assets (images, CSS, JavaScript).WordPress is built to easily allow for installation to a sub-directory so you only need to change the WordPress Address and Site Address on the General Settings Screen.Laravel assumes that it is installed to the top directory. The asset() helper is used to generate paths to asset files. So you will need to override the default function with one of your own. Here is how:Here is an approach that I took when encountered a similar situation. Install your wordpress in public_html directory and preferably place your laravel application with the WP directory:Best approach is to follow the Laravel Service Provider Architecture. Write a service provider for including the wp-load.php and use the boot function to load assets: And add the service provider to your laravel app config, config/app.php:Now we have access to our WordPress functions within Laravel and can alter laravel views to something like:Your wordpress site should be accessible at www.urdomain.com and laravel app under url  www.urdomain.com/app/appointment or adjust you .htaccess if you wish a different URL pattern.  Hope this help.

Laravel Eloquent $model->save() not saving but no error

Jacob

[Laravel Eloquent $model->save() not saving but no error](https://stackoverflow.com/questions/46919857/laravel-eloquent-model-save-not-saving-but-no-error)

When updating my Post model, I run:This does not update my post. But it should according to the Laravel docs on updating Eloquent models. Why is my model not being updated?Post model:Post controller:Running dd($post->save()) returns true.Runningshows me that $fetchedPost is the same post as before without the updated data.

2017-10-24 20:55:05Z

When updating my Post model, I run:This does not update my post. But it should according to the Laravel docs on updating Eloquent models. Why is my model not being updated?Post model:Post controller:Running dd($post->save()) returns true.Runningshows me that $fetchedPost is the same post as before without the updated data.Check your database table if the 'id' column is in uppercase 'ID'. Changing it to lower case allowed my save() method to work.Since Laravel 5.5 laravel have change some validation mechanism I guess you need to try this way.I had the same and turned out to be because I was filtering the output columns without the primary key.Fixed withMakes perfect sense on review, without the primary key available the update command will be on Null.I had the same problem and changing the way I fetch the model solved it! Was not saving even though everything was supposedly working just as you have mentioned:This is working:Try this In my experience, if you select an Eloquent model from the db and the primary_key column is not part of the fetched columns, your $model->save() will return true but nothing is persisted to the database.So, instead of doing \App\Users::where(...)->first(['email']), rather do \App\Users::where(...)->first(['id','email']), where id is the primary_key defined on the target table.If the (sometimes micro-optimization) achieved by retrieving only a few columns is not really of importance to you, you can just fetch all columns by doing \App\Users::where(...)->first(), in which case you do not need to bother about the name of the primary_key column since all the columns will be fetched.Running dd() inside a DB::transaction will cause a rollback, and the data in database will not change.The reason being, that transaction will only save the changes to the database at the very end. Ergo, the act of running "dump and die" will naturally cause the script to cease and no therefore no database changes.I have been experiencing the same issue and found a workaround. I found that I was unable to save() my model within a function called {{ generateUrl() }} on my home.blade.php template. What worked was moving the save() call to the controller that returns the home.blade.php template. (IE, save()ing before the view is returned, then only performing read operations within {{ generateUrl() }}.)I was (and am) generating a state to put in a URL on page load:Below is what did not work.This was able to find() the User from the database, but it was unable to save() it back. No errors were produced. The function appeared to work properly... until I tried to read the User's state later, and found that it did not match the state in the URL.Here is what did work.Instead of trying to save() my User as the page was being assembled, I generated the state, save()d it, then rendered the page:Landing at the root directory sends you to the index() function of HomeController.php:Then, when generating the URL, I did not have to save() the User, only read from it:This worked! The only difference (as far as I see) is that I'm save()ing the model before page assembly begins, as opposed to during page assembly.

brew link php71: Could not symlink sbin/php-fpm

AlxVallejo

[brew link php71: Could not symlink sbin/php-fpm](https://stackoverflow.com/questions/46778133/brew-link-php71-could-not-symlink-sbin-php-fpm)

I'm trying to install Laravel Valet, which requires php 7.1, but when i run brew install php71, I get the following error:I get the same error when i run brew link php71. If i run php -v, I actually see that I'm currently running PHP 7.1.7.But when I run valet install, I get:I don't even have an sbin directory in /usr/local. Any suggestions?

2017-10-16 19:58:08Z

I'm trying to install Laravel Valet, which requires php 7.1, but when i run brew install php71, I get the following error:I get the same error when i run brew link php71. If i run php -v, I actually see that I'm currently running PHP 7.1.7.But when I run valet install, I get:I don't even have an sbin directory in /usr/local. Any suggestions?I solved this problem by first creating the directory sbin:then if you are like me using macOS highSierra 10+ you need to run:after thisInstalling Laravel Valet, I had a similar issue with sbin not being writable. I had to make the directory, then utilized the solution included at this page. This finally allowed me the proper permissions to run a brew link command with a previously installed version of php 7.1.

How can I return a view from an AJAX call in Laravel 5?

Chris Jackson

[How can I return a view from an AJAX call in Laravel 5?](https://stackoverflow.com/questions/28634712/how-can-i-return-a-view-from-an-ajax-call-in-laravel-5)

I'm trying to get an html table to return on an ajax call.  route:  ajax on calling page:  controller:  view:  Im not getting anything in the json.html data. nothing. If in the controller I say:  This works just fine.  How can I return a view from an ajax call in Laravel 5.

2015-02-20 17:24:11Z

I'm trying to get an html table to return on an ajax call.  route:  ajax on calling page:  controller:  view:  Im not getting anything in the json.html data. nothing. If in the controller I say:  This works just fine.  How can I return a view from an ajax call in Laravel 5.The view() function just creates an instance of the View class. Not just an HTML string. For that you should call render():use string function before view file name like asSo this question is old and the most upvoted answer did not solve the problem for the asker and for me neither. I ran into the same problem and it took me two days to find the solution. Everywhere I came looking for answers the said use ->render(). But nothing returned. I have a partial view which I wanted to include. I had not extended my partial view or given it a section name. Since this is not necessary when including it inside a blade file with the include directive.So the solution is, enclose your html inside a section and instead of render(), use renderSections()['sectionname']. Just using render() will not work. I hope this will safe somebody some time and frustration!if your ajax is correct and you are getting results from your DBDon't return your view as JSON, just return the view from your controller

For example:This will work for sure.Ok - I found by trial and error that you don't include the blade template commands in the view file for this to work.I had:and now its working with:Altho I searched - I never found documentation stating this.remove this if condition and see if it worksidk if you are still looking for answer but i ran into same issue as you, it kept returning blank. the key to success was to remove @section @endsection part in your partial viewThis helped me:I have used echo view('ajaxView') instead  return view('ajaxView').I got it working without these : @section & @stopeither or thisboth workedIf you use AJAX in Laravel then when you want to display view with AJAX response don't use return command instead use echo command.For example, don't use:use:Other example, don't use:use:

Laravel db migration - renameColumn error - Unknown database type enum requested

Latheesan

[Laravel db migration - renameColumn error - Unknown database type enum requested](https://stackoverflow.com/questions/29165259/laravel-db-migration-renamecolumn-error-unknown-database-type-enum-requested)

I am using Laravel 4.2. I have the following library loaded in my composer.jsonI created the following migration:Where delivery_notes column type is text.When I run the migration, I get the following error:Any idea why I am getting this error? How should I go about fixing this? I need to rename a column in my table. Are there any alternative way to rename the column?

2015-03-20 11:16:48Z

I am using Laravel 4.2. I have the following library loaded in my composer.jsonI created the following migration:Where delivery_notes column type is text.When I run the migration, I get the following error:Any idea why I am getting this error? How should I go about fixing this? I need to rename a column in my table. Are there any alternative way to rename the column?Laravel's documentation says that:Here: https://github.com/laravel/framework/issues/1186You can find some workarounds about this issue. And since you said that this column is not enum, take a look at @upngo's comment:Also I found this article that focuses on this issue and suggest an option that might help you.http://www.paulbill.com/110/laravel-unknown-database-type-enum-requested-doctrinedbalplatformsmysqlplatform-may-not-support-itThis works for me on Laravel 5.1I met this problem in Laravel version 5.1.19 (LTS). This is actual for earlier versions too.

I wanted to inform you as I resolved the issue base on previous comments.First of all, I tried next code in my migration file:But after command php artisan migrate, I got next error:As you know DBAL was removed from the laravel core and we need add it to the composer.json.(For example:"require": {"doctrine/dbal": "2.5.1"}).

I set DBAL as required and tried again to do migrate command but got next error:Then I tried next raw sql in my migration file:

For up():For down():and it works.P.S. For renaming other fields in the table which contains an enum field we should 

use same schema with raw sql as was written in previous comments.You can add custom constructor to migration and explain to Doctrine that enum should be treated like string.I had the same problem with Laravel 5.1 and PostGres.

So basically I used the DB::statement to create the ENUM and solve the problem:And then:Here is the answer for Laravel 5.2.45+ (might work in 5.1 as well, have not tested or checked yet, please let me know so I can update this question.)Add this line in you up method:Something like this:Though the original author had issues with Laravel 4, this can safely be fixed in Laravel 5 by bumping the version of doctrine/dbal in your composer.json to ^2.6, as it was fixed in this PR on release 2.6.0Make sure to check for compatibility-breaking changes in the release changelog

Check if name is unique among non-deleted items with laravel validation

Samsquanch

[Check if name is unique among non-deleted items with laravel validation](https://stackoverflow.com/questions/23374995/check-if-name-is-unique-among-non-deleted-items-with-laravel-validation)

I have a simple form which posts to a controller which checks if a name for an item is already taken for a particular project. If it is, then it returns an error. This is the code I'm using for that:The problem I've run into is that instead of a hard delete, I'm using a soft delete to remove them from the database, meaning that, for example, 'Test' can only be used as the name once, even after it's been deleted.How can I make it check that it is unique for that project among the items that are not soft deleted?

2014-04-29 20:51:02Z

I have a simple form which posts to a controller which checks if a name for an item is already taken for a particular project. If it is, then it returns an error. This is the code I'm using for that:The problem I've run into is that instead of a hard delete, I'm using a soft delete to remove them from the database, meaning that, for example, 'Test' can only be used as the name once, even after it's been deleted.How can I make it check that it is unique for that project among the items that are not soft deleted?You may try this:This will make sure that the name in the versions table will be unique, if a record is soft deleted and has same name name then it won't be counted, means, name will be accepted even if there is a soft deleted record with the same name exists.To ignore a model when updating, you should pass the id after name in the place of first NULL.Update: Also you may use something like this to add your own custom rule:You may use it like this:I know this question is old, but I stumbled across this when looking for a solution to a similar problem.  You don't need custom validation code.I have a database of ledger codes in which the 'name' and 'short_name' must be unique for each user (user_id). I have soft deletes enabled, so they should only be unique among non-deleted rows for a given user.This is my function which returns the validation strings:For any one wondering about the argument string syntax for the unique validator, it is as follows: The value fields in field name/value pairs can be either a value to match, NULL, or NOT_NULL.If someone is looking for solution using Rule class.Basically, we just ignoring rows which deleted_at fields are not null.Here are the methods which you can use along with ignore function: https://laravel.com/api/5.7/Illuminate/Validation/Rules/DatabaseRule.htmlOn Create Method:On Update Method:For add recordFor edit that record

General error: 1364 Field 'user_id' doesn't have a default value [duplicate]

Mohammed Sabbah

[General error: 1364 Field 'user_id' doesn't have a default value [duplicate]](https://stackoverflow.com/questions/43651446/general-error-1364-field-user-id-doesnt-have-a-default-value)

I am trying to assign the user_id with the current user but it give me this errorhere is my methodwith these fillablesHowever this method do the jobany idea why this fail?

2017-04-27 07:37:59Z

I am trying to assign the user_id with the current user but it give me this errorhere is my methodwith these fillablesHowever this method do the jobany idea why this fail?

you need to change database strict mode. for disable follow below stepSo, after After reviewing the code again, I found the error.

I am wondering how no one notice that!

In the above code I wroteactually, there is no need for the request function warping the body of the create function.Here's how I did it:This is my PostsControllerAnd this is my Post Model.And try refreshing the migration if its just on test instanceNote: migrate: refresh will delete all the previous posts, usersTry 'user_id' => auth()->id

or'user_id' => Auth::user()->idinstead of There are two solutions for this issue.First, is to create fields with default values set in datatable. It could be empty string, which is fine for MySQL server running in strict mode.Second, if you started to get this error just recently, after MySQL/MariaDB upgrade, like I did, and in case you already have large project with a lot to fix, all you need to do is to edit MySQL/MariaDB configuration file (for example /etc/my.cnf) and disable strict mode for tables:This error started to happen quite recently, due to new strict mode enabled by default. Removing STRICT_TRANS_TABLES from sql_mode configuration key, makes it work as before.User Auth::user()->id instead.Here is the correct way :If your user is authenticated, Then Auth::user()->id will do the trick. I've had a similar issue with User registration today and I was getting aSQLSTATE[HY000]: General error: 1364 Field 'password' doesn't have a default value (SQL: insert into `users`

I fixed it by adding password to my protected $fillable array and it workedprotected $fillable = [

        'name',

        'email',

        'password',

    ];

I hope this helps.Try doing Auth::id(), like also remember to include Auth facade at top of your controller which is App\Http\Controllers\Authuse print_r(Auth);then see in which format you have user_id / id variable and use itIt's seems flaw's in your database structure. Keep default value None to your title and body column.Try this:In my case, the error was because I had not declared the field in my $fillable array in the model. Well, it seems to be something basic, but for us who started with laravel it could work.Use database column nullble() in Laravel. You can choose the default value or nullable value in database.The above error can be as a result of wrongly named input variables from the view form, which resorts to seeking a default value since no variable is supplied hence-- SQLSTATE[HY000]: General error: 1364 Field 'user_id' doesn't have a 

default value (SQL: insert into posts (updated_at, created_at) 

values (2017-04-27 10:29:59, 2017-04-27 10:29:59))In your file create_file, the null option must be enabled.you dont need the request() as you doing that already pulling the value of body and title

Get user data using access token in laravel passport client app

Tauras

[Get user data using access token in laravel passport client app](https://stackoverflow.com/questions/41746078/get-user-data-using-access-token-in-laravel-passport-client-app)

I have successfully created server.app and client.app using Laravel Passport documentation. Everything works as expected.client.app Route:By default, this route returns access_token, with which i can do whatever i want.Request:Returns:Question:How to make correct request to server.app with given access_token in client.app to get for example user(s) email(s).Should i use: http://server.app/api/user request to get data? If yes, how i can do that? If possible, please write a code.Thanks for any answers.

2017-01-19 15:49:04Z

I have successfully created server.app and client.app using Laravel Passport documentation. Everything works as expected.client.app Route:By default, this route returns access_token, with which i can do whatever i want.Request:Returns:Question:How to make correct request to server.app with given access_token in client.app to get for example user(s) email(s).Should i use: http://server.app/api/user request to get data? If yes, how i can do that? If possible, please write a code.Thanks for any answers.I've been going absolutely insane about this issue! It just made no freaking sense as to why it kept spitting out the stupid Unauthenticated error when trying to hit-up a route such as /api/user. After much searching (MUCH searching), I finally found the answer. If you see this fero from Laracasts, you're my hero!https://laracasts.com/discuss/channels/laravel/laravel-53-passport-api-unauthenticated-in-postman-using-personal-access-tokensEdit:Once you've made the change to the app\Providers\RouteServiceProvider.php mentioned above, proceed with the below example.First things first, we need to retrieve a fresh access_token. To do this, I'm using the password grant_type (more info: https://laravel.com/docs/5.4/passport#password-grant-tokens)To retrieve a fresh access_token, I've created a new route on routes/web.php and called it /connect. I've then placed the code from the above link into it:Using Chrome Postman, you need to:Example result:Highlight the access_token string and copy it to a text editor.You'll then need to create a new route in routes/api.php. The route below will simply output the current API users' info:Once you've done the above, make these changes to Postman:Example output:Have you tried running it on POSTMAN chrome app?

If not, download it. https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=enFill the information.

After you successfully generated the data, click the CODE button from the top-right (I highlighted it with green).Lastly, select your language and copy the code. For PHP, I selected php cURL.Hope it works.According to Laravel documentation, you should add route to server app (routes/api.php): $response->getBody();Make request via quzzle:

What is the difference between laravel cursor and laravel chunk method?

Suraj

[What is the difference between laravel cursor and laravel chunk method?](https://stackoverflow.com/questions/45464676/what-is-the-difference-between-laravel-cursor-and-laravel-chunk-method)

I would like to know what is the difference between laravel chunk and laravel cursor method. Which method is more suitable to use? What will be the use cases for both of them? I know that you should use cursor to save memory but how it actually works in the backend? A detailed explanation with example would be useful because I have searched on stackoverflow and other sites but I didn't found much information.Here is the code snippet's from the laravel documentation.Chunking ResultsUsing Cursors

2017-08-02 15:12:39Z

I would like to know what is the difference between laravel chunk and laravel cursor method. Which method is more suitable to use? What will be the use cases for both of them? I know that you should use cursor to save memory but how it actually works in the backend? A detailed explanation with example would be useful because I have searched on stackoverflow and other sites but I didn't found much information.Here is the code snippet's from the laravel documentation.Chunking ResultsUsing CursorsIndeed This question might attract some opinionated answer, however the simple answer is here in Laravel DocsJust for reference:This is chunk:This is Cursor:Chunk retrieves the records from the database, and load it into memory while setting a cursor on the last record retrieved so there is no clash.So the advantage here is if you want to reformat the large record before they are sent out, or you want to perform an operation on an nth number of records per time then this is useful. An example is if you are building a view out/excel sheet, so you can take the record in counts till they are done so that all of them are not loaded into the memory at once and thereby hitting the memory limit.Cursor uses PHP Generators, you can check the php generators page however here is an interesting caption:While I cannot guarantee that I understand fully the concept of Cursor, but for Chunk, chunk runs the query at every record size, retrieving it, and passing it into the closure for further works on the records.Hope this is useful.We have a comparison:  chunk() vs cursor()10,000 records:100,000 records:chunk is based on pagination, it maintains a page number, and do the looping for you.For example, DB::table('users')->select('*')->chunk(100, function($e) {}) will do multiple queries until the result set is smaller than the chunk size(100):cursor is based on PDOStatement::fetch and Generator. will do issue a single query:But the driver doesn't fetch the result set at once.ProsConsProsConsI used to think cursor() will do query each time and only keep one row result in memory. So when I saw @mohammad-asghari's comparison table I got really confused. It must be some buffer behind the scenes.By tracking Laravel Code as below I understood Laravel build this feature by wrap PDOStatement::fetch().

And by search buffer PDO fetch and MySQL, I found this document.https://www.php.net/manual/en/mysqlinfo.concepts.buffering.phpso by doing PDOStatement::execute() we actually fetch whole result rows at ones and stored in the memory, not only one row. So if the result is too huge, this will lead to out of memory exception.Though the Document shown we could use $pdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, false); to get rid of buffered query. But the drawback should be caution.I made some benchmark using cursor and wherehere is the result: 

How to seed database migrations for laravel tests?

Jeff Puckett

[How to seed database migrations for laravel tests?](https://stackoverflow.com/questions/42350138/how-to-seed-database-migrations-for-laravel-tests)

Laravel's documentation recommends using the DatabaseMigrations trait for migrating and rolling back the database between tests.However, I've got some seed data that I would like to use with my tests. If I run:then it works for the first test, but it fails subsequent tests. This is because the trait rolls back the migration, and when it runs the migration again, it doesn't seed the database. How can I run the database seeds with the migration?

2017-02-20 16:52:39Z

Laravel's documentation recommends using the DatabaseMigrations trait for migrating and rolling back the database between tests.However, I've got some seed data that I would like to use with my tests. If I run:then it works for the first test, but it fails subsequent tests. This is because the trait rolls back the migration, and when it runs the migration again, it doesn't seed the database. How can I run the database seeds with the migration?All you need to do is make an artisan call db:seed in the setUp functionref: https://laravel.com/docs/5.6/testing#creating-and-running-testsIt took me some digging to figure this out, so I thought I'd share.If you look at the source code for the DatabaseMigrations trait, then you'll see it has one function runDatabaseMigrations that's invoked by setUp which runs before every test and registers a callback to be run on teardown.You can sort of "extend" the trait by aliasing that function, re-declare a new function with your logic in it (artisan db:seed) under the original name, and call the alias inside it.I know this question has already been answered several times, but I didn't see this particular answer so I thought I'd throw it in. For a while in laravel (at least since v5.5), there's been a method in the TestCase class specifically used for calling a database seeder:https://laravel.com/api/5.7/Illuminate/Foundation/Testing/TestCase.html#method_seedwith this method, you just need to call $this->seed('MySeederName'); to fire the seeder.So if you want this seeder to fire before every test, you can add the following setUp function to your test class:The end result is the same as:or But the syntax is a bit cleaner (in my opinion).If you're using the RefreshDatabase testing trait:Here is an alternate solution, in case you prefer to bypass Artisan's native DatabaseMigrations and seeder/migration methods. You can create your own trait to seed your database:Then call it in your test like this: 

Why does `catch (Exception $e)` not handle this `ErrorException`?

duality_

[Why does `catch (Exception $e)` not handle this `ErrorException`?](https://stackoverflow.com/questions/15071191/why-does-catch-exception-e-not-handle-this-errorexception)

I get the ErrorException on the function call bellow. How can this be? Why is it not caught?The underlying reason for the error is a file_put_contents call. I'm using the Laravel 4 framework, if it makes any difference.

2013-02-25 16:08:14Z

I get the ErrorException on the function call bellow. How can this be? Why is it not caught?The underlying reason for the error is a file_put_contents call. I'm using the Laravel 4 framework, if it makes any difference.I suspect that you need to write this:Note the \ in front of Exception.When you have declared a namespace, you need to specify the root namespace in front of classes like Exception, otherwise the catch block here will be looking for \Your\Namespace\Exception, and not just \Exception

How to write a migrate to undo the unique constraint in Laravel?

cyber8200

[How to write a migrate to undo the unique constraint in Laravel?](https://stackoverflow.com/questions/30607670/how-to-write-a-migrate-to-undo-the-unique-constraint-in-laravel)

I would do this to make my email field unique in the table. $table->unique('email');I've triedThen, when I run php artisan migrate, I got this It tell me that it's not there, but I'm 100% sure that it's there.How do write a migration to undo that ?

2015-06-02 22:24:40Z

I would do this to make my email field unique in the table. $table->unique('email');I've triedThen, when I run php artisan migrate, I got this It tell me that it's not there, but I'm 100% sure that it's there.How do write a migration to undo that ?You have to do $table->dropUnique('users_email_unique');This the better way to drop unique. You can use the real column name here.

Laravel - syntax error, unexpected end of file

Ivanka Todorova

[Laravel - syntax error, unexpected end of file](https://stackoverflow.com/questions/16116212/laravel-syntax-error-unexpected-end-of-file)

I have a website which works fine on host, but I'm currently trying to install it on localhost.I've downloaded everything and configured to work on localhost - Database & URL.The problem is this error:And I don't know what causes it. Any solutions?P.S. I've setup in my windows' host file 127.0.0.1 myproject.dev.

2013-04-20 03:23:41Z

I have a website which works fine on host, but I'm currently trying to install it on localhost.I've downloaded everything and configured to work on localhost - Database & URL.The problem is this error:And I don't know what causes it. Any solutions?P.S. I've setup in my windows' host file 127.0.0.1 myproject.dev.There is an error within one of your views. If there is a more detailed stack trace it should show you details of a view, although the name will be an md5() string so it's a bit hard to find. You might want to delete all compiled Blade views in storage/views and let Blade re-compile the views. If you still get the error then check your views to make sure you have all the proper closing tags, e.g., @endif or @endforeachAlways double check your views for any syntax errors.I've run into this same error and I was able to fix it by adding spaces to the content within an inline if statement. For example:Experienced error with:Fixed error with:This may not be a problem in all cases and it was certainly difficult to track down but it is just one example that can cause this exact error.A variation of this problem -- I had a php block, which I'd opened with 

<?  as opposed to <?php worked fine on LocalHost/MAMP, but gave the above error under Nginx/Ubuntu 16.04/PHP7 (both Laravel)you should remove a character from view file. for example my character was "," (a comma) before some "@endfor". when i remove those worked!

Parameters inside Laravel localized string

JasonGenX

[Parameters inside Laravel localized string](https://stackoverflow.com/questions/30242119/parameters-inside-laravel-localized-string)

I'd like have something like this in the lang/en/mymsgs.phpI would provide the content for %1 and %2 when getting the 'string1' from my code. I couldn't find a way to do this. Any pointers? 

2015-05-14 16:12:48Z

I'd like have something like this in the lang/en/mymsgs.phpI would provide the content for %1 and %2 when getting the 'string1' from my code. I couldn't find a way to do this. Any pointers? Laravel message localization uses named, not numeric, parameters.Rewriting your example message:You can now use, for example:If anyone use string translation for Laravel. They can use like this ->

__('Some translatable string with :attribute',['attribute' => $attribute_var])

check the documentation for more https://laravel.com/docs/5.7/localization#using-short-keys

Eloquent attach/detach/sync fires any event?

Mihai Crăiță

[Eloquent attach/detach/sync fires any event?](https://stackoverflow.com/questions/28925292/eloquent-attach-detach-sync-fires-any-event)

I have a laravel project, and I need to make some calculations immediately after I save a model and attach some data to it. Is there any event that is triggered in laravel after calling attach (or detach/sync)?

2015-03-08 10:14:46Z

I have a laravel project, and I need to make some calculations immediately after I save a model and attach some data to it. Is there any event that is triggered in laravel after calling attach (or detach/sync)?Steps to solve your problem:and that's it. I created package that already doing that: https://github.com/fico7489/laravel-pivotNo, there are no relation events in Eloquent. But you can easily do it yourself (Given for example Ticket belongsToMany Component relation):event object as simple as this:then a basic listener as a sensible example:and usage:Of course you could do it without creating Event objects, but this way is more convenient, flexible and simply better.Laravel 5.8 now fires events on ->attach()Check out: https://laravel.com/docs/5.8/releasesAnd search for: Intermediate Table / Pivot Model Eventshttps://laracasts.com/discuss/channels/eloquent/eloquent-attach-which-event-is-fired?page=1

Laravel Pass Parameter from Route to Filter

735Tesla

[Laravel Pass Parameter from Route to Filter](https://stackoverflow.com/questions/20790922/laravel-pass-parameter-from-route-to-filter)

I am using the laravel framework.

If I have the following route:And this filter:How can I pass parameters to the filter so that when visiting /test/foobar I would get a page saying: "The value is foobar"?

2013-12-26 20:35:55Z

I am using the laravel framework.

If I have the following route:And this filter:How can I pass parameters to the filter so that when visiting /test/foobar I would get a page saying: "The value is foobar"?Filters can be passed parameters, like the Route object or the Request:Specifying Filter ParametersAbove example is taken from the docs: http://laravel.com/docs/routing#route-filtersOnce you're inside the closure, you take the parameter from the $route:

Laravel Eloquent truncate - Foreign key constraint

Wesley

[Laravel Eloquent truncate - Foreign key constraint](https://stackoverflow.com/questions/29119272/laravel-eloquent-truncate-foreign-key-constraint)

I am having some issues with deleting data using Laravel 5. I seem to be stuck on a 'foreign key constraint', while I don't see why. In my current database model I have a datapoints table, which has a foreign key to the sensors table (datapoints.sensors_id -> sensor.id).The code I am trying:});The result:I would understand this constraint if the order would be inverse (first deleting sensors), but when datapoints is empty, there should be no problem deleting sensors? I have also tried:Lastly I also tried adding explicitly 'DB::commit()' between the delete statements, but all return the same result.Is this normal behaviour? Am I missing something?Thanks in advance.Cheers,Wesley

2015-03-18 10:14:26Z

I am having some issues with deleting data using Laravel 5. I seem to be stuck on a 'foreign key constraint', while I don't see why. In my current database model I have a datapoints table, which has a foreign key to the sensors table (datapoints.sensors_id -> sensor.id).The code I am trying:});The result:I would understand this constraint if the order would be inverse (first deleting sensors), but when datapoints is empty, there should be no problem deleting sensors? I have also tried:Lastly I also tried adding explicitly 'DB::commit()' between the delete statements, but all return the same result.Is this normal behaviour? Am I missing something?Thanks in advance.Cheers,WesleyNo, this is the way your database works. You can't truncate table that is referenced by some other table. You may do something liketo disable foreign key checks, truncate tables and enable it again.If you prefer to use Eloquent objects, Maksym's answer the "Eloquent" way

Get Laravel Models with All Attributes

kenshin9

[Get Laravel Models with All Attributes](https://stackoverflow.com/questions/33512184/get-laravel-models-with-all-attributes)

Is there a way to retrieve a model in Laravel with all the attributes, even if they're null? It seems to only return a model with the attributes that aren't null.The reason for this is that I have a function that will update the model attributes from an array, if the attributes exists in the model. I use the property_exists() function to check the model if it has a particular attribute before setting it. The array key and model attribute are expected to match, so that's how it works. It works fine if the model already has the attributes set, because the attribute exists and takes the value from the array. But nothing will get updated or set if the attribute was previously null, because it fails the property_exists() check.What's ultimately happening is that I have a single array of attributes, and then perhaps two models. And I run my setter function, passing in the attributes array, and each of the objects in separate calls. If the model has a matching property, it gets updated.

2015-11-04 01:28:25Z

Is there a way to retrieve a model in Laravel with all the attributes, even if they're null? It seems to only return a model with the attributes that aren't null.The reason for this is that I have a function that will update the model attributes from an array, if the attributes exists in the model. I use the property_exists() function to check the model if it has a particular attribute before setting it. The array key and model attribute are expected to match, so that's how it works. It works fine if the model already has the attributes set, because the attribute exists and takes the value from the array. But nothing will get updated or set if the attribute was previously null, because it fails the property_exists() check.What's ultimately happening is that I have a single array of attributes, and then perhaps two models. And I run my setter function, passing in the attributes array, and each of the objects in separate calls. If the model has a matching property, it gets updated.Here are two ways to do this. One method is to define default attribute values in your model.Then, you can use the getAttributes() method to get the model's attributes.If you don't want to set default attributes though, I wrote up a quick method that should work.Basically, if the attribute has not been set, this will append a null value to that attribute and return it to you as an array.Above will return an array of raw attributes (as stored in the database table)Above will return all the model's raw, mutated(if used), and appended attributesHope it will helpful!!Update:If you are trying to do this after instantiating like so:then please differ to Thomas Kim's answer.Otherwise:

You could use the toArray() or getArributes() method on the model instance, that would give back all the attributes including nulls. Then you can use array_key_exists to check.Like so:What if you were to explicitly declare all the fields you want back.Pretty generic example but hopefully someone will find this useful.

Laravel difference between Events, Listeners, Jobs, Queues [closed]

Taylor

[Laravel difference between Events, Listeners, Jobs, Queues [closed]](https://stackoverflow.com/questions/36106532/laravel-difference-between-events-listeners-jobs-queues)

It sounds extremely confusing to me, what are the differences? Can someone please do an ELI5?

2016-03-19 20:04:42Z

It sounds extremely confusing to me, what are the differences? Can someone please do an ELI5?Although they all can work together, I find it's easiest to look at Events and Listeners together, and then Jobs and Queues together.Events and ListenersEvents are objects that hold data that are "fired", the Laravel event system "catches" the event object when it is fired, and then all the Listeners that are registered for that particular event are run.If you think about it, this is akin to how exceptions work. You throw an exception, and you can define several catch blocks to react depending on which exception is thrown. In the case of Events and Listeners, an Event is thrown and one or more Listeners represent the contents of a catch block. Though similar, Events and Listeners are not error handlers, they just have conceptual similarities.Jobs and QueuesI think the best way to think of these is like a line at a bank. The line itself is the Queue, and each customer in the line is a Job.In order to process Jobs in the Queue you need command line processes or daemons. Think of launching a queue daemon on the command line as adding a new bank teller to the pool of available bank tellers. When a daemon is available it will ask the Queue for the next Job like the bank teller asking for the next person in line to step to the window.Each person in line has a specific task they want accomplished, like making a deposit or withdrawal. The action that the person in line needs completed is the Worker in Laravel.The Worker is the thing the daemon will do for the Job that was taken from the Queue, just like the task is the thing the bank teller will do for the customer who stepped forward from the line.Hope any of that makes some sense.

Laravel Policies - How to Pass Multiple Arguments to function

Johannes

[Laravel Policies - How to Pass Multiple Arguments to function](https://stackoverflow.com/questions/36482737/laravel-policies-how-to-pass-multiple-arguments-to-function)

I'm trying to authorize a users character to delete/update post. I was using policies to do so, but I could only pass one parameter to the policy function. If I pass more than the user and another variable, the variable isn't passed into the function.Models: User has many characters, a character can post multiple posts. So for authorization purposes, I would have to compare the post's character_id with the current character's id...-Per the docs, you can pass more multiples to the Gate Facade:But I couldn't find anyway to do so with policies. What I had to do was to inject the Request object to get the object needed for authorization. Basically I wouldn't even need the User Object. Using the Request object works, but it feels very hacky. Is there a nicer way to achieve this?edit:In the CharacterLocationController I have a method show and I want to authorize the action before showing the resource. The policy is registered like this: 'App\Location' => 'App\Policies\LocationPolicy' in the AuthServiceProviderI dumped the array passed to the policy function, and it only outputs the $location.

2016-04-07 17:01:30Z

I'm trying to authorize a users character to delete/update post. I was using policies to do so, but I could only pass one parameter to the policy function. If I pass more than the user and another variable, the variable isn't passed into the function.Models: User has many characters, a character can post multiple posts. So for authorization purposes, I would have to compare the post's character_id with the current character's id...-Per the docs, you can pass more multiples to the Gate Facade:But I couldn't find anyway to do so with policies. What I had to do was to inject the Request object to get the object needed for authorization. Basically I wouldn't even need the User Object. Using the Request object works, but it feels very hacky. Is there a nicer way to achieve this?edit:In the CharacterLocationController I have a method show and I want to authorize the action before showing the resource. The policy is registered like this: 'App\Location' => 'App\Policies\LocationPolicy' in the AuthServiceProviderI dumped the array passed to the policy function, and it only outputs the $location.I think there is possibly some confusion here on what functions are doing what.When you useOr in the CommentPolicyAll you are doing is defining the rules.  At this point, we aren't worried about passing anything, only that the objects we received can or should be able to interact with each other.  The only difference between these two is when using policies, it's just an easy way to abstract all your rules into one simple and easy to read class.  If you have an app with potentially hundreds of tables and models, it will get confusing fast if you have these rules littered all over your app so policies would help to keep them all organized.It's when you are actually checking if someone has permission to do something when you should be passing these items along.  For example, when you do the following, Or if in the CommentControllerThat is what controls which parameters are going to be passed to the policy or the Gate::define method.  According to the docs, the $user parameter is already added for you so in this case, you only need to worry about passing the correct $post and $comment being modified.

Where is Illuminate?

sCha

[Where is Illuminate?](https://stackoverflow.com/questions/38319050/where-is-illuminate)

Every time when I try to do some modifications in certain area, Authentication for example, I end up finding everything is declared in Illuminate\Foundation\....Okay, now all I need to do is get to that location and look into some codes.But hey, where is this Illuminate and all stuff???I don't see any folders named Illuminate anywhere in my Laravel package.Tried to search for the solution but I guess I'm the only silly person who lacks ability in understanding some basics.

2016-07-12 02:23:55Z

Every time when I try to do some modifications in certain area, Authentication for example, I end up finding everything is declared in Illuminate\Foundation\....Okay, now all I need to do is get to that location and look into some codes.But hey, where is this Illuminate and all stuff???I don't see any folders named Illuminate anywhere in my Laravel package.Tried to search for the solution but I guess I'm the only silly person who lacks ability in understanding some basics.Just to officially answer this question.The files OP was looking for, along with any other Laravel or package files, are stored in the vendor folder - which you can access from the root Laravel directory.As @Gavin points out in the comments:Laravel take the advantage of the autoload features in Composer. One quick and simple tips:You can actually find this in composer.lock file. Then find the PSR autoload. For instance, for Laravel/framework:Since there are a lot of packages in vendor folder, refer the name of the package in the composer.lock. For example, Illuminate is under laravel/framework packages. Then, look for vendor/laravel/frameworkThen you know, Illuminate is mapped to vendor/laravel/framework/src/Illuminate

How can I change the public path to something containing an underscore in Laravel Mix?

Mike

[How can I change the public path to something containing an underscore in Laravel Mix?](https://stackoverflow.com/questions/42051576/how-can-i-change-the-public-path-to-something-containing-an-underscore-in-larave)

In Laravel 5.4 Mix was introduced to compile assets and maintain the asset pipeline.  Mix defaults to your public directory being named public.  In many cases, including mine, my public directory is called something else.  In my case, it's public_html.How can I change the public directory where assets are compiled to?I have tried changing the paths within webpack.min.js to:Unfortunately this compiles to:In Laravel 5.3 and Elixir this was as simple as:I have checked Mix's config file, but can't see anything obvious here.Please note: this is Laravel Mix, the npm package, so it's nothing to do with amends in the index.php file.

2017-02-05 11:35:25Z

In Laravel 5.4 Mix was introduced to compile assets and maintain the asset pipeline.  Mix defaults to your public directory being named public.  In many cases, including mine, my public directory is called something else.  In my case, it's public_html.How can I change the public directory where assets are compiled to?I have tried changing the paths within webpack.min.js to:Unfortunately this compiles to:In Laravel 5.3 and Elixir this was as simple as:I have checked Mix's config file, but can't see anything obvious here.Please note: this is Laravel Mix, the npm package, so it's nothing to do with amends in the index.php file.There is an undocumented (I believe) method called setPublicPath.  You can then omit the public path from the output.  setPublicPath plays nicely with underscores.In Laravel 5.5 I've solved like this,In Laravel 5.8In Laravel 5.4 you can us this code:in AppServiceProvider :

Laravel : Redis No connection could be made : [tcp://127.0.0.1:6379]

Gammer

[Laravel : Redis No connection could be made : [tcp://127.0.0.1:6379]](https://stackoverflow.com/questions/38604524/laravel-redis-no-connection-could-be-made-tcp-127-0-0-16379)

I have installed redis with laravel by adding "predis/predis":"~1.0",Then for testing i added the following code :In app/config/database.php i have :It throws the following error : No connection could be made because the target machine actively refused it. [tcp://127.0.0.1:6379]I using virtualhost for the project.

Using Xampp with windows.

2016-07-27 05:37:53Z

I have installed redis with laravel by adding "predis/predis":"~1.0",Then for testing i added the following code :In app/config/database.php i have :It throws the following error : No connection could be made because the target machine actively refused it. [tcp://127.0.0.1:6379]I using virtualhost for the project.

Using Xampp with windows.First make sure Redis is actually listening on that port by opening up powershell and typing netstat -aon | more (this command may need to be enabled in features or installed somehow).  If it is listening then check your firewall settings. If if not listening then make sure Redis is started and is configured to listen on that port.It looks like predis/predis is a client library only.  See https://packagist.org/packages/predis/predis.You need to install the Redis server, but it looks like it is not officially supported on Windows. See http://redis.io/download.  Per information on that page, it looks like there is a Win64 port for Redis here https://github.com/MSOpenTech/redis.If it still doesn't work after that then update your question with the new error you see.I had this issue in Ubuntu 18.04I installed redis in my local system, got solved.Ref solution: https://rapidsol.blogspot.com/2018/10/php-fatal-error-uncaught.htmlIt is showing your server is not accepting connections from outside. You need to provide ip of your redis server.if problem still come then try below steps.So you need to edit :

$sudo vi /usr/local/etc/redis.confand find the line  bind 127.0.0.1 ::1

and change it to  #bind 127.0.0.1 ::1

and then find line protected-mode yes

and then change it to protected-mode noand then restart the redis server

In Laravel, how can I get *only* POST parameters?

NeuronQ

[In Laravel, how can I get *only* POST parameters?](https://stackoverflow.com/questions/27366243/in-laravel-how-can-i-get-only-post-parameters)

I know that one can use $request->get('my_param') or Input::get('my_param') to get a POST or GET request parameter in Laravel (I'm toying with v5/dev version now, but it's the same for 4.2).But how can I make sure that my my_param came via a POST parameter and was not just from a ?my_param=42 appended to the URL? (besides reverting to the ol' $_POST and $_GET superglobals and throwing testability out the window)(Note: I also know that the Request::get method will give me the POST param for a POST request, if both a POST an URL/GET param with the same name exist, but... but if the param land in via the url query string instead, I want a Laravel-idiomatic way to know this)

2014-12-08 20:24:09Z

I know that one can use $request->get('my_param') or Input::get('my_param') to get a POST or GET request parameter in Laravel (I'm toying with v5/dev version now, but it's the same for 4.2).But how can I make sure that my my_param came via a POST parameter and was not just from a ?my_param=42 appended to the URL? (besides reverting to the ol' $_POST and $_GET superglobals and throwing testability out the window)(Note: I also know that the Request::get method will give me the POST param for a POST request, if both a POST an URL/GET param with the same name exist, but... but if the param land in via the url query string instead, I want a Laravel-idiomatic way to know this)In the class Illuminate\Http\Request (or actually the Symphony class it extends from Symfony\Component\HttpFoundation\Request) there are two class variables that store request parameters.public $query - for GET parameterspublic $request - for POST parametersBoth are an instance of Symfony\Component\HttpFoundation\ParameterBag which implements a get method.Here's what you can do (although it's not very pretty)Why trying to complicate things when you can do easily what you need :

How to generate「screenshot」of html div with external images?

cytsunny

[How to generate「screenshot」of html div with external images?](https://stackoverflow.com/questions/41254805/how-to-generate-screenshot-of-html-div-with-external-images)

I have a HTML div with external images. (The following is an example, but in the actual case I am using Amazon S3, so downloading and storing the image on the same server is not an option) Currently I am using html2canvas to convert the div to image. However, the external image is always replaced by a blank space.The code I use to capture the image:Edited: jsfiddle: https://jsfiddle.net/0y2zxxL8/3/I may use other library. I may also do that in backend. (I am using PHP + laravel 5 for backend) Is there a way I can generate a "screenshot" of the HTML div with external images?Update The current answer are working after editing. Yet, for my actual use, there will be multiple image with their position set by the user by drag and drop. I can still get the position, but it would be better for me if it is possible to not set the position specifically.

2016-12-21 03:50:03Z

I have a HTML div with external images. (The following is an example, but in the actual case I am using Amazon S3, so downloading and storing the image on the same server is not an option) Currently I am using html2canvas to convert the div to image. However, the external image is always replaced by a blank space.The code I use to capture the image:Edited: jsfiddle: https://jsfiddle.net/0y2zxxL8/3/I may use other library. I may also do that in backend. (I am using PHP + laravel 5 for backend) Is there a way I can generate a "screenshot" of the HTML div with external images?Update The current answer are working after editing. Yet, for my actual use, there will be multiple image with their position set by the user by drag and drop. I can still get the position, but it would be better for me if it is possible to not set the position specifically.Your JSFiddle given ReferenceError: Canvas2Image is not defined while hit on 'Save PNG' button. So check your code(not fiddle) for same error.UPDATE

See this JSFiddle example as reference. May this one will help you.UPDATE 2

I place some code into your one, check it out. Hope this will be your solution..!Working result with FF v44 and its working. Taken snap with JSFiddle code

UPDATE 3 (12/29/2016) JSFiddleAfter research, found that the problem is because we are only assigning the image source which is only pass message to the browser to retrieve the data. Further image element is may be not really accessible with the browser when click to draw canvas from it. We are just tell code to load it and it's done.Change code to solve OP's facing chrome issue like below:UPDATE 4   JSFiddle

Make image position dynamic based on OP requirement.You may try to  scan the image source for external urls and change them to your website and load them with php.Something likeimageproxy.phpnote: php script is very simple, image detection is not working 100%, this is just ti give you an idea. If you use some php image libs to load and get image type you can do this just with few lines of code. you may also try with "php readfile".onrendered is no longer working..i solved this problem by adding "allowTaint" option2018 solution:

Twilio lookup API not working?

ReactingToAngularVues

[Twilio lookup API not working?](https://stackoverflow.com/questions/31354989/twilio-lookup-api-not-working)

I'm trying to use Twilio's Lookup API to get certain properties of a mobile number via PHP... with very little success:Note that this is the example code present within their 'Getting Started' page here. By taking a look at $number in the debugger, I can confirm it is returning something:The highlighted property of the object is simply recursive with no new information.Attempting to evaluate $number->phone_number returns null. I have tried this with perhaps half a dozen completely valid numbers now and this is the only response I get. Attempting to json_encode($number) returns false. I have no idea why this is not working, but it'd be helpful if I could know what I'm doing wrong. 

2015-07-11 08:13:04Z

I'm trying to use Twilio's Lookup API to get certain properties of a mobile number via PHP... with very little success:Note that this is the example code present within their 'Getting Started' page here. By taking a look at $number in the debugger, I can confirm it is returning something:The highlighted property of the object is simply recursive with no new information.Attempting to evaluate $number->phone_number returns null. I have tried this with perhaps half a dozen completely valid numbers now and this is the only response I get. Attempting to json_encode($number) returns false. I have no idea why this is not working, but it'd be helpful if I could know what I'm doing wrong. I'm just gonna go ahead and assume the phone numbers you've tried are neither from the US, nor in international format.From Twilio's Lookups Quickstart Tutorial:So your lookup should probably look like:If the phone numbers are from the US, in international format, or if the above still does not work, try whether the lookup succeeds on Twilio's web interface (you'll need the international prefix there).If it does, your software library might be broken or your Twilio account might have incorrect/broken access rights.If the web lookup fails as well, you should contact Twilio and report the issue.I would have been also not successful with their code defined so i used CURL to grab their API methods and it worked like a charm for me, you can try following code to get you needIt will return you few parameters (country_code, national_format, carrier)Now 9-6-2016 and they still haven't fixed their PHP library...None the less here is what worked for me. If you want more information like caller name etc you have to enable this in your twilio dashboard first.

How do I namespace a model in Laravel so as not to clash with an existing class?

Dwight

[How do I namespace a model in Laravel so as not to clash with an existing class?](https://stackoverflow.com/questions/16116378/how-do-i-namespace-a-model-in-laravel-so-as-not-to-clash-with-an-existing-class)

In Laravel 4 I want to use a model that represents an Event coming from my database. Thus, in app/models I have my Event model that extends Eloquent.However, Laravel 4 already has an Event class which is used to manage events within the application lifecycle. What I want to know is, how can I properly namespace my Event model and access it in a way that will not clash with the existing Event class.

2013-04-20 03:54:34Z

In Laravel 4 I want to use a model that represents an Event coming from my database. Thus, in app/models I have my Event model that extends Eloquent.However, Laravel 4 already has an Event class which is used to manage events within the application lifecycle. What I want to know is, how can I properly namespace my Event model and access it in a way that will not clash with the existing Event class.You just need to apply a namespace to it as you normally would. So, for example.You should then correctly setup your composer.json so that it loads your models. You could use classmap or psr-0 for this, depending on whether or not you're following PSR-0 with your directory structure.I'm pretty sure the models directory is already mapped.Edit

As mentioned in the comments you must run composer dump-autoload.As much i have research about using namespaces, because i want to use those inside the PHPDocumentar, its not possible to add twice the namespaces, as laravel already adds those for you, if we understand the basic problem, why we use namespaces1 - many libraries uses same class name, so we use namespaces to differentiate that.2 - if you want to use namespaces then you should be out of the scope of the app, means is the vendor folder for you to this kind of stuff.Enjoy

Download a file in Laravel using a URL to external resource

lesssugar

[Download a file in Laravel using a URL to external resource](https://stackoverflow.com/questions/38791635/download-a-file-in-laravel-using-a-url-to-external-resource)

I'm keeping all uploads on a custom, external drive. The files are being stored via custom API. In Laravel 5.2, I can do this for a local file to download it:Unfortunately, when I pass a URL instead of a path, Laravel throws an error:(the URL is a dummy of course).Is there any way I can download the image.jpg file using Laravel's implementation or do I do this with plain PHP instead?

2016-08-05 14:25:59Z

I'm keeping all uploads on a custom, external drive. The files are being stored via custom API. In Laravel 5.2, I can do this for a local file to download it:Unfortunately, when I pass a URL instead of a path, Laravel throws an error:(the URL is a dummy of course).Is there any way I can download the image.jpg file using Laravel's implementation or do I do this with plain PHP instead?There's no magic, you should download external image using copy() function, then send it to user in the response: TL;DR

Use the streamDownload response if you're using 5.6 <=. Otherwise implement the function below.Original Answer

Very similar to the "download" response, Laravel has a "stream" response which can be used to do this. Looking at the API, both of the these functions are wrappers around Symfony's BinaryFileResponse and StreamedResponse classes. In the Symfony docs they have good examples of how to create a StreamedResponseBelow is my implementation using Laravel:Update 2018-01-17This has now been merged into Laravel 5.6 and has been added to the 5.6 docs. The streamDownload response can be called like this:Why not just use a simple redirect?As for 2019 this is all pretty easy. 2 lines of code to download to your server and 2 lines to upload to browser (if needed).Assume you want an HTML for google home page to get saved locally onto your server, and then return an HTTP response to initiate browser to download the file:Look up Laravel Storage facade documentation for details on disk configuration and put method and Response with file download documentaion for returning file with an HTTP reponse.try this script:  If you do not want end user can see main_url in header try this:You could pull down the content of the original file, work out its mime type and then craft your own response giving the right headers.I do this myself using a PDF library, but you could modify to use file_get_contents() to pull down the remote assets:You need to change $pdf to be the data of the file, Content-Type to contain the mimetype of the file that the data is and Content-Disposition is the filename you want it to appear as.Not sure whether this will work, mine simply makes the browser popup with a PDF download so I'm not sure whether it'll work for embedding CDN files... Worth a try though.

How to select year and month from the created_at attributes of database table in laravel 5.1?

Pawan Dongol

[How to select year and month from the created_at attributes of database table in laravel 5.1?](https://stackoverflow.com/questions/32840698/how-to-select-year-and-month-from-the-created-at-attributes-of-database-table-in)

My problem is that I want to get data form the database table from the created_at attributes as per year and month only. The code I have tried is:

2015-09-29 09:40:31Z

My problem is that I want to get data form the database table from the created_at attributes as per year and month only. The code I have tried is:There are date helpers available in the query builder:If you want to get the year and month from a single instance of Mjblog you can access them like this:Read more about Carbon\Carbon getters documentation.

FatalErrorException in Inflector.php line 265: syntax error, unexpected ':', expecting ';' or '{'

Abdul Qadir

[FatalErrorException in Inflector.php line 265: syntax error, unexpected ':', expecting ';' or '{'](https://stackoverflow.com/questions/48380892/fatalerrorexception-in-inflector-php-line-265-syntax-error-unexpected-exp)

I went to update composer using after update having the following error:Please assistThanks in advanceUsing Laravel Framework version 5.2.45here is the composer codePlease see the function of inflector.php where error occures

2018-01-22 11:47:21Z

I went to update composer using after update having the following error:Please assistThanks in advanceUsing Laravel Framework version 5.2.45here is the composer codePlease see the function of inflector.php where error occuresIt's a PHP version issue, update to PHP 7.0 and doctrine/inflector will work properly because doctrine/inflector 1.20 and above require PHP 7. But if you want to stay at your current PHP version, you can downgrade the doctrine/inflector version by running the following commands:doctrine/inflector:1.1.0 supports PHP 5.6 & above. If you have another version of php, you can refer to this linkI'm working on:My table name is like this: "test_meetings"I solved the error specifying in testMeeting.php Model the table name:It's really obvious when you search for this file name and then start comparing package versions.You are requiring laravelcollective/html at any version, so, for now, the latest version is 5.5.x. This package in its turn requires "doctrine/inflector": "~1.1",, so any version below 2.0, which is currently 1.3.0 and requires PHP 7.0 or higher.If you look at the source of the latest inflector.php, you will see a return type is set on line 265, which is only supported in PHP 7.0 and up.You are using PHP 5.6.24, so this code won't work on your system.The simple way to fix your error is to use the laravelcollective/html version corresponding to your Laravel version. Which should probably be 5.2.*.In case this helps anyone. I had a similar problem. My doctrine/inflector was expecting php>=7 for some reason (That's what was to found in the composer.json from doctrine/inflector). And this even though I had followed the instructions to install laravel 5.4. I ran rm -f Composer.lock and rm -R -f vendor and then did a composer install after vagrant ssh to the homestead VM, which was using php 5.6.8 (originally I had run composer from my MacBook terminal, which was using php 7)This cleared up the issues.afterTry this after you have run the composer update:

Laravel 4 workbench class not found

Ray

[Laravel 4 workbench class not found](https://stackoverflow.com/questions/18499393/laravel-4-workbench-class-not-found)

I'm trying to develop a package in laravel 4 - my first attempt at a package. 

I found a couple of tutorials which I've tried to follow:and and of course in the official documentation.I've followed the basic structure to create the framework. However on loading the app I get a class not found error. This relates directly to the serviceprovider I have placed in the app.php file.here's my entry in the providers array:My folder structure is:My service provider has the following entries:I've double checked to spelling and ran a composer dump-autoload both from the root of the project and the root of the package.I've run out of ideas for solving the class not found  any ideas where I've gone wrong?The line producing the error is this one:Any help appreciatedThanksUpdate:

I ran a composer update as suggested in the workbench/package folder with a response nothing to update. I then ran composer at the root of the project and an error was produced: I probably posted the wrong error line earlier. The full exception response is:THe error extract:which I assume relates to the service provider loader not finding the CalendarServiceProvider?

2013-08-28 22:34:04Z

I'm trying to develop a package in laravel 4 - my first attempt at a package. 

I found a couple of tutorials which I've tried to follow:and and of course in the official documentation.I've followed the basic structure to create the framework. However on loading the app I get a class not found error. This relates directly to the serviceprovider I have placed in the app.php file.here's my entry in the providers array:My folder structure is:My service provider has the following entries:I've double checked to spelling and ran a composer dump-autoload both from the root of the project and the root of the package.I've run out of ideas for solving the class not found  any ideas where I've gone wrong?The line producing the error is this one:Any help appreciatedThanksUpdate:

I ran a composer update as suggested in the workbench/package folder with a response nothing to update. I then ran composer at the root of the project and an error was produced: I probably posted the wrong error line earlier. The full exception response is:THe error extract:which I assume relates to the service provider loader not finding the CalendarServiceProvider?I found that running composer install from within the workbench/[vendor]/[package] folder solved the problem.I encountered the same error, so I went deeper on its flow to knew what happens.So dissecting a little bit basically, in the bootstrap phase, when bootstrap/autoload.php is loaded it runs at the end:This requires EVERY workbench/vendor/package/**/**/**/autoload.php he found (by using Symfony Finder Component)Successively in bootstrap/start.php it gets the 'providers' defined in config/app.php and try to load each of them:and then in ProviderRepository.phpso we'll end up with:where it tried to create an instance of a class isn't really autoloaded. And so that's why the exception thrown!He's absolutely right because this create the autoload vendor dir and files, and everything works as we expect it to because it finds the autoload files:In addition to @ilpaijin's and @Andrew Holt's answer, there sometimes comes the need (when there's a new version of Laravel) to run composer update within the workbench/vendor/package folder.Also, as noted here, the composer.json within the package must require the same version of illuminate/support as the one required of laravel/framework in the project root's composer.json.Thanks to @biscii note that one should use:instead of 

Laravel Production issue - Updating composer with Laravel 4.1.x

olleh

[Laravel Production issue - Updating composer with Laravel 4.1.x](https://stackoverflow.com/questions/30868608/laravel-production-issue-updating-composer-with-laravel-4-1-x)

I haven't encountered any issue in deploying my laravel project until now. I've been deploying for like almost a year already for this project. But some new bug came up.First of all. 

I can't run composer update, cause it says this error.So what I did is update my Composer library.This is my current version.I updated composer.But I encounter a new problem once I ran composer updateNow I am leaning towards uninstalling my composer, and creating a new fresh copy.

2015-06-16 13:12:41Z

I haven't encountered any issue in deploying my laravel project until now. I've been deploying for like almost a year already for this project. But some new bug came up.First of all. 

I can't run composer update, cause it says this error.So what I did is update my Composer library.This is my current version.I updated composer.But I encounter a new problem once I ran composer updateNow I am leaning towards uninstalling my composer, and creating a new fresh copy.fixed this for me on Ubuntu with PHP 5.6. (Its nothing to do with Laravel BTW - I'm not using that framework at all.)I fixed it by installing the missing dependencies.had the same problem, performed the composer installation command in the terminal and problem solvedthe composer via yum install command:You can install phpunit, after that, if there are problems, execute the command: sudo a2dismod php5 .If you still have questions, to analyze your problem by looking at the system log.

array_map and pass 2 arguments to the mapped function - array_map(): Argument #3 should be an array

Latheesan

[array_map and pass 2 arguments to the mapped function - array_map(): Argument #3 should be an array](https://stackoverflow.com/questions/27599767/array-map-and-pass-2-arguments-to-the-mapped-function-array-map-argument-3)

I have an abstract class that looks like this:Then I have the following class that implements it:When this code runs, I get the error: How do you pass 2 or more arguments when you call array_map function within a class? I checked the PHP Documentation and it looks like this is allowed, but it isn't working on my Larave 4.2 project.Any ideas?

2014-12-22 09:22:35Z

I have an abstract class that looks like this:Then I have the following class that implements it:When this code runs, I get the error: How do you pass 2 or more arguments when you call array_map function within a class? I checked the PHP Documentation and it looks like this is allowed, but it isn't working on my Larave 4.2 project.Any ideas?Please always read docs:http://php.net/manual/en/function.array-map.phpand yet you pass bool $format as argumentI would create anonymous function with use() syntaxYou can't use array_map to pass hard-coded values to a callback function (what is commonly referred to as currying or partially-applied functions in functional languages). What array_map takes is a variable amount of arrays, all of which should have the same amount of elements. The element at the current index of each array is passed to the callback as separate arguments. So, for instance, if you do this:You get this:Hopefully that explains the idea behind it - each array you pass in will have the element at the current position in the first array passed as the relevant parameter to the callback function.So, as I said, it's not to be used for passing 'static' values to the callback. However, you can do this yourself by defining an anonymous function on the fly. In your transformCollection method:Most answers show that an anonymous function with the use keyword is the typical way to pass additional arguments through to other callables.Most likely though, this particular situation would be better suited by a standard foreach loop over array_map, as it would potentially be more efficient and easier to read. This would also prevent your indexes from being renumbered, as well as work with Traversable and ArrayAccess items.If you really, really have your heart set on using array_map, anonymous functions don't work with your environment (i.e. pre PHP 5.3) and you need to pass $format through as the 2nd argument, then you will need to convert $format to an array with the same length as $items.EDIT:I realised recently that there was another option available since you're using an instance to transform your data. It involves storing $format to the instance, possibly using a setter, and overriding it if it is provided as an argument. This way it's accessible via the transform method using $this->format.This may not be applicable for laravel 4.2 // pre php 5.3 (as Shaun mentions) but might come in handy for some people who come across this question.So, that's a dynamic use, by using the call-method on the Closure-class that's underneath php's anonymous functions. If the callback is an array, it will bind the scope of the ->call to the first array-element, which should be the method's object.

Laravel Lumen Ensure JSON response

John Fonseka

[Laravel Lumen Ensure JSON response](https://stackoverflow.com/questions/37296654/laravel-lumen-ensure-json-response)

I am new to Laravel and to Lumen. I want to ensure I am always getting only a JSON object as output. How can I do this in Lumen?I can get a JSON response using response()->json($response);. But when an error happens, API giving me text/html errors. But I want only application/json responses.Thanks in advance.

2016-05-18 10:17:24Z

I am new to Laravel and to Lumen. I want to ensure I am always getting only a JSON object as output. How can I do this in Lumen?I can get a JSON response using response()->json($response);. But when an error happens, API giving me text/html errors. But I want only application/json responses.Thanks in advance.You'll need to adjust your exception handler (app/Exceptions/Handler.php) to return the response you want.This is a very basic example of what can be done.A more accurate solution based on @Wader's answer can be:As MTVS answer you could even use JsonResponse class to format your response, and use it as static member from within render method, not importing it in the Handler namespace like this:

Method orderBy does not exist in Laravel Eloquent?

Harrison

[Method orderBy does not exist in Laravel Eloquent?](https://stackoverflow.com/questions/37760963/method-orderby-does-not-exist-in-laravel-eloquent)

I have a piece of code like this:I got the following error:I guess orderBy need to follow Product:: directly, but I can't save $products = Product::, can I?Any suggestions? Thanks.

2016-06-11 07:04:41Z

I have a piece of code like this:I got the following error:I guess orderBy need to follow Product:: directly, but I can't save $products = Product::, can I?Any suggestions? Thanks.You're trying to use orderBy() method on Eloquent collection. Try to use sortByDesc() instead.Alternatively, you could change $products = Product::all(); to $products = new Product();. Then all your code will work as you expect.just use the one line code it will work fineIf you want to get the list of all data and grab it in descending order try this:You are first getting all() data and then trying to sort which is wrong. You have to fix this by removing and changing your code into something like this Hope you get idea to tweak your code.Your query is wrong.remove all from $products = Product::all() and then put get() at the end of your query.You can use this...use sortByDesc('id') or simple sortBy() inside use the variable through which you wanna sort like i add id

How to access the laravel .env variables inside javascript?

Stephan-v

[How to access the laravel .env variables inside javascript?](https://stackoverflow.com/questions/35683562/how-to-access-the-laravel-env-variables-inside-javascript)

I am currently using Algolia for my search engine inside a Laravel application, so whenever a record is created it is also sent to the Agolia database. Of course I want to separate my data in the Algolia database with a testset for local development and a production set for the live website. I have defined which indices of my Algolia database are being used in a JavaScript file.Now I am wondering how do I react accordingly to my APP_ENV variable to change it depending on my current environment? Obviously I need to put stuff into an if statement in my JavaScript but how do I make my javascript access the .env variables properly?Hopefully somebody can help me out.Cheers.

2016-02-28 14:13:42Z

I am currently using Algolia for my search engine inside a Laravel application, so whenever a record is created it is also sent to the Agolia database. Of course I want to separate my data in the Algolia database with a testset for local development and a production set for the live website. I have defined which indices of my Algolia database are being used in a JavaScript file.Now I am wondering how do I react accordingly to my APP_ENV variable to change it depending on my current environment? Obviously I need to put stuff into an if statement in my JavaScript but how do I make my javascript access the .env variables properly?Hopefully somebody can help me out.Cheers.You can just echo out the env variable as a javascript string in your view:And your .env file would look like this:NAME=AlexAs the documentation suggest it: you can now easily use env variables by prefixing a key in your .env file with MIX_.MIX_SENTRY_DSN_PUBLIC=http://example.comAfter the variable has been defined in your .env file, you may access via the process.env object.process.env.MIX_SENTRY_DSN_PUBLICIf accessing the env vars from outside of the main js file. You can do the following:then:Requiring mix and the dotenv config gives you access. :)There are a lot of ways.One of the best is to pass data from Controller to the view:or like this:Or you could use Sessions:Of course you can create dedicated route and get it with Ajax, but I don't think it's a good way to do this in real life web application.A cleaner solution is to use the laracasts/utilities package to send your variables to your file.Install it with the composer require laracasts/utilities command.Then add use JavaScript; at the top of your controller.And finally send your variable this way :  JavaScript::put([ 'foo' => $bar ]);.

Laravel Carbon See if date is in the past

Packy

[Laravel Carbon See if date is in the past](https://stackoverflow.com/questions/47059484/laravel-carbon-see-if-date-is-in-the-past)

I am very confused by this, maybe its something simple I am not seeing. If I want to see if a date is in the past of today I should be able to do something like this? if I dump out the dates its $league->date_start is a protected date so its a carbon instance But this doesnt work, if I switch it to $league->date_start >= Carbon::now() it works and wont let me join. I know the "league" start date is in the past so shouldnt it be $league->date_start <= Carbon::now()?????

2017-11-01 16:31:24Z

I am very confused by this, maybe its something simple I am not seeing. If I want to see if a date is in the past of today I should be able to do something like this? if I dump out the dates its $league->date_start is a protected date so its a carbon instance But this doesnt work, if I switch it to $league->date_start >= Carbon::now() it works and wont let me join. I know the "league" start date is in the past so shouldnt it be $league->date_start <= Carbon::now()?????There's built-in Carbon method isPast so you can use:to determine if date is in past or notCheck the section「Comparison」on carbon docs. You should call $first->lte($second) to compare two carbon instances.Try using if ($league->date_start->diffInSeconds() >= 0). The method diffInSeconds returns the difference between the current time and your carbon instance.Here's an example of an output from tinker -

Combining AND/OR eloquent query in Laravel

SUB0DH

[Combining AND/OR eloquent query in Laravel](https://stackoverflow.com/questions/15653216/combining-and-or-eloquent-query-in-laravel)

How can I write following or similar kind of queries using Eloquent?SELECT * FROM a_table WHERE (a LIKE %keyword% OR b LIKE %keyword%) AND c = 1 AND d = 5I couldn't combine AND/OR in the way I wanted by chaining where & or_where functions.

2013-03-27 06:46:57Z

How can I write following or similar kind of queries using Eloquent?SELECT * FROM a_table WHERE (a LIKE %keyword% OR b LIKE %keyword%) AND c = 1 AND d = 5I couldn't combine AND/OR in the way I wanted by chaining where & or_where functions.You can nest where clauses : http://laravel.com/docs/database/fluent#nested-whereThis should produce : SELECT * FROM models WHERE (a LIKE %keyword% OR b LIKE %keyword%) AND c = 1For a more accurate answer to the example:Note: This is Laravel 3 syntax, use camelCase orWhere() for Laravel 4In Laravel 5.1+ this will also do the job and looks cleaner:You can use DB::raw() in the first where() to put in the like/or statement.

Laravel - delete whole collection

Marco

[Laravel - delete whole collection](https://stackoverflow.com/questions/38120305/laravel-delete-whole-collection)

I have images for articles, and when I am updating article I would like to check if the images are the same, if not I would like to delete them but if it is possible I would like to delete the whole collection without another query, something like what I have in the code below $images->delete();.

This is my function:

2016-06-30 10:21:06Z

I have images for articles, and when I am updating article I would like to check if the images are the same, if not I would like to delete them but if it is possible I would like to delete the whole collection without another query, something like what I have in the code below $images->delete();.

This is my function:You just can't delete from database without making a query. You will have to make new request like this: It's just one simple query, so there shouldn't be any performance penalty.If we are talking about collection with 100's of items, you can optimize the query like this:If you have your Models linked, you can.Class Exercise.php:and Class Lecture.php:Then you can in your controller simply do:(Imagine that your Article == my Lecture, and your Media == my Exerises)Of course, at first you have to set properly foreign keys in your DB and link your Models that way.

composite-unique-key-validation - laravel

sumit

[composite-unique-key-validation - laravel](https://stackoverflow.com/questions/29093061/composite-unique-key-validation-laravel)

seems it's not possible with built-in validators, how I should implement this feature in the model?above will prevent duplicacy of user_id and service_id  independently which is not my requirementit will reject because 1  is duplicate but it should be accepted as i want composite unique key

2015-03-17 06:59:03Z

seems it's not possible with built-in validators, how I should implement this feature in the model?above will prevent duplicacy of user_id and service_id  independently which is not my requirementit will reject because 1  is duplicate but it should be accepted as i want composite unique keyComposite unique field validation is provided out-of-the-box in 5.0+. I can't speak for earlier versions.You can essentially specify a where clause for when your unique validation rule applies. E.g.This rule says that term should be unique on the terms table but only where the taxonomy is equal to "category".For example, it will prevent a "news" category being duplicated but I can still have a "news" tag.I don't know your schema but in your case it'd be something like this:This is not possible out of the box in Laravel. You would either have to write a custom validator or use a package for that.Here is one that should do what you need:

- https://github.com/felixkiss/uniquewith-validatorWith this package, your rules could look like the following:It works for both Laravel 4 and 5.My solution Laravel 5.3 and 5.4Note: Without model bindingStoreUpdateWith the help of this link , I am able to achieve composite validation from out of the box laravel 5.3. I knew it is old question and answered already. In my case vendor and client combination is unique. My sample code is below

Laravel 5.2 Missing required parameters for [Route: user.profile] [URI: user/{nickname}/profile]

SCRATK

[Laravel 5.2 Missing required parameters for [Route: user.profile] [URI: user/{nickname}/profile]](https://stackoverflow.com/questions/35259948/laravel-5-2-missing-required-parameters-for-route-user-profile-uri-user-ni)

I keep getting this error When ever any page loads and I'm logged in.Here is what my nav looks likeThe problem I'm having is that the {{ route('user.profile') }} is not working??When i hit the link is www.mydomain.com/User/SCRATK/profile is works fine but the page wont load becuase of this error??This is my routes file

2016-02-07 22:29:47Z

I keep getting this error When ever any page loads and I'm logged in.Here is what my nav looks likeThe problem I'm having is that the {{ route('user.profile') }} is not working??When i hit the link is www.mydomain.com/User/SCRATK/profile is works fine but the page wont load becuase of this error??This is my routes fileYou have to pass the route parameters to the route method, for example:It's because, both routes have a {nickname} in the route declaration. I've used $nickname for example but make sure you change the $nickname to appropriate value/variable, for example, it could be something like the following: My Solution in laravel 5.2My Routes File (under middleware)

Using Laravel Socialite to login to facebook

Namit

[Using Laravel Socialite to login to facebook](https://stackoverflow.com/questions/30590243/using-laravel-socialite-to-login-to-facebook)

I am new to Laravel however and I am following the tutorial on http://www.codeanchor.net/blog/complete-laravel-socialite-tutorial/, to login a user through Facebook into my application. However, almost everywhere I find a tutorial using either Github or Twitter for the Socialite Plugin provided in Laravel.My problem is that on following everything in the tutorial, as I click on the "Login to Facebook" button, it throws an "Invalid Argument Exception" with No Socialite driver was specified.".Another stack overflow question seemed to narrow things down: 

https://stackoverflow.com/questions/29673898/laravel-socialite-invalidargumentexception-in-socialitemanager-php-line-138-nStating that the problem is in the config/services.phpNow, i have the app_id and app_secret. However, the redirect link seems to be confusing as I can't find it on Facebook either. I am aware that this is where my app should go to Facebook for login, however, unsure of what it should be.Does anyone have any idea on this.

2015-06-02 07:45:00Z

I am new to Laravel however and I am following the tutorial on http://www.codeanchor.net/blog/complete-laravel-socialite-tutorial/, to login a user through Facebook into my application. However, almost everywhere I find a tutorial using either Github or Twitter for the Socialite Plugin provided in Laravel.My problem is that on following everything in the tutorial, as I click on the "Login to Facebook" button, it throws an "Invalid Argument Exception" with No Socialite driver was specified.".Another stack overflow question seemed to narrow things down: 

https://stackoverflow.com/questions/29673898/laravel-socialite-invalidargumentexception-in-socialitemanager-php-line-138-nStating that the problem is in the config/services.phpNow, i have the app_id and app_secret. However, the redirect link seems to be confusing as I can't find it on Facebook either. I am aware that this is where my app should go to Facebook for login, however, unsure of what it should be.Does anyone have any idea on this.In your composer.json add- "laravel/socialite": "~2.0",the run composer updateIn config/services.php add:You need to create two routes, mine are like these:You also need to create controller  for the routes above like so:and finally add Site URL to your Facebook App like so:It's little bit tricky for something that looks/should be easy, but anyway this is how i make things works for me.you can find those instructions and more details in socialite docsin config/services.php add in .env file add in routes/web.php addin App\Http\Controllers\Auth add new controller FacebookController.phpgo to https://developers.facebook.com/apps and create new app (if you don't have one already)and make sur your app settings are like below in those screen shots:If you are developing in your local machine, you have to use tools like ngrok that provide a secure link to your localhost.In the facebook login settings change https://www.example.com with the url provided by ngrok something like https://8b0215bc.ngrok.io.It is the only way that worked for me while developing in my local machine.Create a provider under your config/services.php filenow you can create a controller with following code and this is your route

Pagination for search results laravel 5.3

Casper Spruit

[Pagination for search results laravel 5.3](https://stackoverflow.com/questions/39326206/pagination-for-search-results-laravel-5-3)

I have just started with Laravel and I am trying to make a search function with proper pagination. The function works for page one but on page two it doesn't. I think it's not giving the results to the next page but I can't seem to find an answer.this is my search function inside IndexController:this is my route:this is the URL of page two:this is how I show my pagination:the error:Get error on request.Route:Error:I hope my question is clear and in the right format. Thank you in advance (sorry for my bad English)Answer:I ended up using the answer of this post in combination with some help of this postI used a post function for the initial search and a get function for the following pages. This was possible because I'm now giving my search to the URL.EDIT:

2016-09-05 08:04:20Z

I have just started with Laravel and I am trying to make a search function with proper pagination. The function works for page one but on page two it doesn't. I think it's not giving the results to the next page but I can't seem to find an answer.this is my search function inside IndexController:this is my route:this is the URL of page two:this is how I show my pagination:the error:Get error on request.Route:Error:I hope my question is clear and in the right format. Thank you in advance (sorry for my bad English)Answer:I ended up using the answer of this post in combination with some help of this postI used a post function for the initial search and a get function for the following pages. This was possible because I'm now giving my search to the URL.EDIT:If you want to apply filters to the next page you should add them to your paginator like this:And change your route from post to get:View:I assume you want to change pages with urls like this search/1, search/2? First of all your route should be probably Route::post('search/{page?}').I'm not sure if only this change will work, but if it does not, you have to resolve page like thisand in your view page make your route to get methodthis will be done, thanks,a quick way in view (Lavarel 5.7)  in my case, i've laravel 5.7 installed.and my view files codes arefor per_page select dropdown and search area

  and my pagination generator codeIf you are using search form with GET method then use something like these to preserve pagination withing search results.For pagination, you should create a simple form:Pagination methods are here:In your view file where you display pagination...appends keeps the query string value except "page".use any in route Instead post

Route::any('search', 'IndexController@search');

Redirect::route with parameter in URL in Laravel 5

Bellots

[Redirect::route with parameter in URL in Laravel 5](https://stackoverflow.com/questions/30019627/redirectroute-with-parameter-in-url-in-laravel-5)

I'm developing a Laravel 5 app, I have this route Route::get('states/{id}/regions', ['as' => 'regions', 'uses' => 'RegionController@index']);

In my controller, after I make a post call correctly, I want to redirect to that view, with this command:The problem is that I don't know how can I pass {id} parameter, which should be in my URL.Thank you.

2015-05-03 21:29:34Z

I'm developing a Laravel 5 app, I have this route Route::get('states/{id}/regions', ['as' => 'regions', 'uses' => 'RegionController@index']);

In my controller, after I make a post call correctly, I want to redirect to that view, with this command:The problem is that I don't know how can I pass {id} parameter, which should be in my URL.Thank you.You can pass the route parameters as second argument to route():If it's only one you also don't need to write it as array:In case your route has more parameters, or if it has only one, but you want to clearly specify which parameter has each value (for readability purposes), you can always do this:You could still do it like this: In cases where you have multiple parameters, you can pass the parameters as array, for example, say you had to pass the capital of a particular region in you route, your route could look something like this:and you can then redirect using:You can pass {id} parameter with redirection like that If the router contains like this :and in the controller redirection can be done like thisYou can use the following ORThere are several ways to redirect this URL in laravel:

Laravel 5.5 API resources for collections (standalone data)

Dorin Niscu

[Laravel 5.5 API resources for collections (standalone data)](https://stackoverflow.com/questions/46388205/laravel-5-5-api-resources-for-collections-standalone-data)

I was wondering if it is possible to define different data for item resource and collection resource. For collection I only want to send ['id', 'title', 'slug'] but the item resource will contain extra details ['id', 'title', 'slug', 'user', etc.]I want to achieve something like:PageResourceCollection will not work as expected because it uses PageResource so it needs I could duplicate the resource into PageFullResource / PageListResource and PageFullResourceCollection / PageListResourceCollection but I am trying to find a better way to achieve the same result.

2017-09-24 08:39:06Z

I was wondering if it is possible to define different data for item resource and collection resource. For collection I only want to send ['id', 'title', 'slug'] but the item resource will contain extra details ['id', 'title', 'slug', 'user', etc.]I want to achieve something like:PageResourceCollection will not work as expected because it uses PageResource so it needs I could duplicate the resource into PageFullResource / PageListResource and PageFullResourceCollection / PageListResourceCollection but I am trying to find a better way to achieve the same result.The Resource class has a collection method on it. You can return that as the parameter input to your ResourceCollection, and then specify your transformations on the collection.Controller:Resources:If you want the response fields to have the same value in the Resource and Collection, you can reuse the Resource inside the CollectionPersonResource.phpPersonCollection.phpThe accepted answer works, if you are not interested in using links and meta data. If you want, simply return:in your controller. You should also look to eager load other dependent relationships before passing over to the resource collection.

Laravel route pass variable to controller

imperium2335

[Laravel route pass variable to controller](https://stackoverflow.com/questions/26844484/laravel-route-pass-variable-to-controller)

How do I pass a hard coded variable to a controller?My route is:I want to do something like:But that doesn't work.How can this be done?Sorry if I have not explained well.I wish to simply hardcode (set in stone by me) the type_id for certain routes like so:My ProductsController for reference:

2014-11-10 13:03:11Z

How do I pass a hard coded variable to a controller?My route is:I want to do something like:But that doesn't work.How can this be done?Sorry if I have not explained well.I wish to simply hardcode (set in stone by me) the type_id for certain routes like so:My ProductsController for reference:You can use a closure for your route and then call the controller action:However, a nicer way would be to use a where condition and then do the type-to-id conversion in the controller. You will lose the direct alias though and would have to pass in the product as parameter when generating the URL.I have used this to pass values to the controller...route:in controller:if want dynamic :hope this helps...I feel like the tidiest way to do this is probably with route constraints:It has some redundancy, but if you want to do it purely from your routes, I'd go with this.For making SEO-friendly names though, you could use Sluggable to generate a unique slug for each product, then create the following route:And this filter:Here is how you actually do it without messing up the url:Define Route:Now in the controller, inside function __construct(Request $request):

How to Disable Selected Middleware in Laravel Tests

surfer190

[How to Disable Selected Middleware in Laravel Tests](https://stackoverflow.com/questions/34357350/how-to-disable-selected-middleware-in-laravel-tests)

So it is common that errors from Authentication and CSRF arise when running phpunit.So in the TestCase we use:use WithoutMiddleware;The problem with this is that when forms fail, it usually comes back with a Flash Message and Old Input. We have disabled all middleware so we have no access to Input::old('username'); or the flash message.Furthermore our tests of this failed form post returns:Is there a way to enable the Session Middleware and disable everything else.

2015-12-18 13:58:54Z

So it is common that errors from Authentication and CSRF arise when running phpunit.So in the TestCase we use:use WithoutMiddleware;The problem with this is that when forms fail, it usually comes back with a Flash Message and Old Input. We have disabled all middleware so we have no access to Input::old('username'); or the flash message.Furthermore our tests of this failed form post returns:Is there a way to enable the Session Middleware and disable everything else.The best way I have found to do this isn't by using the WithoutMiddleware trait but by modifying the middleware you want to disable. For example, if you want to disable the VerifyCsrfToken middleware functionality in your tests you can do the following.Inside app/Http/Middleware/VerifyCsrfToken.php, add a handle method that checks the APP_ENV for testing.This will override the handle method inside of Illuminate\Foundation\Http\Middleware\VerifyCsrfToken, disabling the functionality entirely.As of Laravel 5.5, the withoutMiddleware() method allows you to specify the middleware to disable, instead of disabling them all. So, instead of modifying all of your middleware to add env checks, you can just do this in your test:If you're on Laravel < 5.5, you can implement the same functionality by adding the updated method to your base TestCase class to override the functionality from the framework TestCase.PHP >= 7If you're on PHP7+, add the following to your TestCase class, and you'll be able to use the same method call mentioned above. This functionality uses an anonymous class, which was introduced in PHP7.PHP < 7If you're on PHP < 7, you'll have to create an actual class file, and inject that into the container instead of the anonymous class.Create this class somewhere:Override the withoutMiddleware() method in your TestCase and use your FakeMiddleware class:You can use trait in test:Laravel >= 5.7

Laravel: How can i change the default Auth Password field name

D.Intziadis

[Laravel: How can i change the default Auth Password field name](https://stackoverflow.com/questions/39374472/laravel-how-can-i-change-the-default-auth-password-field-name)

I'm currently working on my first laravel project and i'm facing a problem.If you have experience with laravel you probably know that by calling php artisan make:auth you will get a predefined mechanism that handles login and registration.This mechanism is set to understand a couple of commonly used words in order to automate the whole procedure.The problem that occurs in my case is that i'm using oracle db and it won't let me have a table column with the name of password because its a system keyword and it throws errors when trying to insert a user.So far, i've tried to change my password column to passwd and it worked in my registration form as expected. The User row was successfully inserted and my page was redirected to /home.

But when i try to logout and then relogin, i get this error telling me that my credentials are not correct.

As for my code, i've changed my RegisterController.php so that it takes username instead of emailThe User $fillableI'm guessing that Auth is trying to authenticate with email and not username or that Auth is searching for password and not passwd

2016-09-07 15:55:10Z

I'm currently working on my first laravel project and i'm facing a problem.If you have experience with laravel you probably know that by calling php artisan make:auth you will get a predefined mechanism that handles login and registration.This mechanism is set to understand a couple of commonly used words in order to automate the whole procedure.The problem that occurs in my case is that i'm using oracle db and it won't let me have a table column with the name of password because its a system keyword and it throws errors when trying to insert a user.So far, i've tried to change my password column to passwd and it worked in my registration form as expected. The User row was successfully inserted and my page was redirected to /home.

But when i try to logout and then relogin, i get this error telling me that my credentials are not correct.

As for my code, i've changed my RegisterController.php so that it takes username instead of emailThe User $fillableI'm guessing that Auth is trying to authenticate with email and not username or that Auth is searching for password and not passwdFor having username instead of email, you can overwrite username() in your LoginController.phpAnd for passwd instead of password, you can do define an accessor in your App\User.phplogin.blade.php : Replace email input with username but do not change the name of the input for password.In the app/Http/Controllers/Auth/LoginController override the default class by adding:Don't forget to add use Illuminate\Http\Request;It could be you have to add this too to your LoginController. That should do it.Use this. It's work for me. So far I have changed the User.phpandAlso on LoginController.phpIn Laravel 5.7 beside above answer you must change EloquentUserProvider class. search in the file for 'password' word in lines (107,117, and 140) you found 'password' word and change it with new name, and this is all solustion.Edit :I change EloquentUserProvider class but if you think changing laravel class is a bad practice you can create custom provider and override the retrieveByCredentials and validateCredentials functions in the custom provider.If you are using the latest version. I am returning it like the following code below for a custom password field. On my end, I am using Lumen 6.x though it would apply to current version of Laravel also.In your AuthController.php (Located in app/http/Controllers/Auth)

Laravel 5 Multi-Tenancy App with separate databases - users have access to multiple installations

Nicko Brooko

[Laravel 5 Multi-Tenancy App with separate databases - users have access to multiple installations](https://stackoverflow.com/questions/28942145/laravel-5-multi-tenancy-app-with-separate-databases-users-have-access-to-multi)

Over the past couple of years I have developed a very customised PHP/MySQL application that is used for a number of clients. I have been creating a new database and new installation for each client up to this point.The first obvious problem here is keeping multiple installations up to date with any code changes; a second problem is that each installation has a large amount of users; and for most clients; some of these users are the same - and they have to have a number of seperate user accounts and urls to remember.I am moving the application over to Laravel 5 at the moment and looking into the best implementation for multi-tenancy; so looking for a little advice on the best implementation. I've used Laravel before but am by no means an expert.This is what I am thinking as far as setup.1 Master Database that holds tables for:Then a seperate database for each installation that contains all the information that is needed for, and submitted to, that installation.The ideal setup is that a user can go to a subdomain i.e installationname.appname.com; sign in with their master login details and automatically go to the required installation; OR go to appname.com, sign in and then select which installation to connect to.My questions are:I'm sure there's a lot of issues that I have not thought of; but if anyone has any links or guidance that may help that would be great. First time asking a question on SO but have found a huge amount of research help here in the past so thanks to the community! UPDATE - So I think I have a way to make this work now; using seperate databases as above; set in the models relating to tenant-specific database content.Then somewhere in a header file set the tenant_connection that is wanted based on a session variable which has been set on login/by subdomain.Assuming relationships will work across connections; I don't see why this would not work; just need to work out best place to set the tenant connection. 

2015-03-09 12:34:59Z

Over the past couple of years I have developed a very customised PHP/MySQL application that is used for a number of clients. I have been creating a new database and new installation for each client up to this point.The first obvious problem here is keeping multiple installations up to date with any code changes; a second problem is that each installation has a large amount of users; and for most clients; some of these users are the same - and they have to have a number of seperate user accounts and urls to remember.I am moving the application over to Laravel 5 at the moment and looking into the best implementation for multi-tenancy; so looking for a little advice on the best implementation. I've used Laravel before but am by no means an expert.This is what I am thinking as far as setup.1 Master Database that holds tables for:Then a seperate database for each installation that contains all the information that is needed for, and submitted to, that installation.The ideal setup is that a user can go to a subdomain i.e installationname.appname.com; sign in with their master login details and automatically go to the required installation; OR go to appname.com, sign in and then select which installation to connect to.My questions are:I'm sure there's a lot of issues that I have not thought of; but if anyone has any links or guidance that may help that would be great. First time asking a question on SO but have found a huge amount of research help here in the past so thanks to the community! UPDATE - So I think I have a way to make this work now; using seperate databases as above; set in the models relating to tenant-specific database content.Then somewhere in a header file set the tenant_connection that is wanted based on a session variable which has been set on login/by subdomain.Assuming relationships will work across connections; I don't see why this would not work; just need to work out best place to set the tenant connection. Ok so what I ended up doing was having all user info, names of installations and mappings of what users can access what installations in one database, and all tenant info in seperate databases.I then had two connections, mysql and mysql_tenant; where mysql_tenant database is not pre-set but dynamic.The User, Installations and mappings model use the mysql connection, all others use mysql_tenantCreated a code for each installation, and used this as the name of the tenant database; storing this code in the session.Used a middleware MultiTenant, to control the switching between installations using these key lines:There's a lot more to it for building the method to switch etc, but this is the gist.It is difficult to answer most of your question - as it is specific to your application and opinion based.But the one bit I can answer is different models can have different database connections. So your user model uses the normal default connection - but your other models can use another connection:Then in your DB connection file - you would have something like this:Laravel 5 is advanced enough that you should be able to have simply one installation along with a strategic database, with well defined relations and keys. There is rarely ever a need for multiple databases.If you can be more specific about your requirements I can provide a more specific answer.

Persist Form Data Across Multiple Steps in Laravel

Jeemusu

[Persist Form Data Across Multiple Steps in Laravel](https://stackoverflow.com/questions/22371630/persist-form-data-across-multiple-steps-in-laravel)

When I've made multistep forms in the past I would generally store the form data in the session before returning it to the view, that way the data persists if the user refreshes the page or clicks the browser's native back buttons.Transferring my past logic to Laravel I built the following form consisting of three stages:[Input  ->  Confirm  ->  Success]The above works fine, however I am wondering if this is the best way to approach multi-step forms in Laravel?

2014-03-13 07:14:49Z

When I've made multistep forms in the past I would generally store the form data in the session before returning it to the view, that way the data persists if the user refreshes the page or clicks the browser's native back buttons.Transferring my past logic to Laravel I built the following form consisting of three stages:[Input  ->  Confirm  ->  Success]The above works fine, however I am wondering if this is the best way to approach multi-step forms in Laravel?When I have created multi-part forms, I have always done it in a way so that the user can always come back and finish the form later, by making each form persist what it has to the database.For instanceI would have the user create their authentication details at this step, create the user account (with password) here and also log the user in, redirecting to the dashboard. There I can do a check to see if the user has a profile and if they don't, redirect them to the profile creation form.Because we have an authenticated user, the profile creation form can save its data to the currently logged in user. Subsequent sections follow the same process but check the existence of the previous step.Your question seems to be about confirming whether a user wishes to create an account. What I would do in your situation would be, on the form you created to confirm the user account, I would keep the user's data in hidden input fields.Although displaying the user's chosen password back to them on this page seems to be a bit superfluous when you ask them to confirm their password on the previous page, plus some users might question why their password is being shown in plaintext on the screen, especially if they are accessing the site from a public computer.The third option I would suggest would be to create the user account and soft-delete it (Laravel 4.2 Docs / Laravel 5 Docs), returning the user's account number to the new form:then undo the soft-delete when the user confirms their account. This has the added bonus that you could track people trying to sign up multiple times for an account and not completing the process and see if there's a problem with your UX.Of course, you could also still do it the way you always have with a session, all I have tried to do here is show you some other ways you can approach it, as with everything to do with the best way of doing something, this is a highly opinionated subject and is likely to get many opposing views on how it should be done. The best way to do it is the way that works best for you and your users... mainly your users.There are two ways to do it (that i can think of). I prefer second one.Adding "forget me" action would be nice (especially if form requires more private data).Why getCreate() has Session::forget()? If someone goes back to change something and accidently leaves your site his data will be lost.1st) Create a custom hidden field in the form containing a random md5 character set to submit it with the form... (it can be the timestamp, the user ip address, and country concatenated together as 3 md5 strings separated by whatever character , or #, so it can be working as a token of the form)2nd) pass the hidden field into your controller and validate it after getting the user input from the form by generating the same values in your controller, encrypting these values as md5 too, then concatenate them all together, and compare the values that is coming from the user input form with the values you are generating in your controller.3rd) Put the values of the form in your controller in a session then regenerate the session id every visit to every view the user is going to visit.4th) update the timestamp in your session according the timestamp the user is visiting every page.Just because you know Laravel, does not mean you have to do everything in Laravel.Multi-step forms should never involve server-side magic. The best and easiest you can do is to hide certain steps with display:none; and switch to the next step using javascript toggling visibilities only. 

How to Deploy CodeIgniter/Laravel Apps

Javier Cadiz

[How to Deploy CodeIgniter/Laravel Apps](https://stackoverflow.com/questions/13753198/how-to-deploy-codeigniter-laravel-apps)

I need to know which are my options when deploying codeigniter/laravel apps.I develop locally all the time at my home and when i go to work i need some quick way to push all the changes to the server.Application code needs to be updated, database schemas need to be migrated, and application servers must be restarted. I do all of this manually wasting a lot of time and i need some automated way kinda like capistrano in Rails environment.What are my options here ??Update:

I got my own server machine, and everything needs to work on an intranet environment without internet connection.

2012-12-06 21:46:42Z

I need to know which are my options when deploying codeigniter/laravel apps.I develop locally all the time at my home and when i go to work i need some quick way to push all the changes to the server.Application code needs to be updated, database schemas need to be migrated, and application servers must be restarted. I do all of this manually wasting a lot of time and i need some automated way kinda like capistrano in Rails environment.What are my options here ??Update:

I got my own server machine, and everything needs to work on an intranet environment without internet connection.I've used the following:Nothing has truly been satisfactory and DB schema changes are a huge pain.  So much so that for client configs, we're moving from MySQL to Cassandra, which is basically schemaless.  CI installer is interesting, but I'm not sure how it handles updates.I recently came across this CodeIgniter Installer on GitHub. I've played around with it a few times and it works like a charm for me.It's as simple as putting it in your root directory (alongside your system folder), generating a MySQL dump, and editing a few files. Full instructions are hereI hope it works for you as well as it did for me.I found this Laravel Installer on Github which might be useful. (First I came across this question after searching for Laravel installer in Google, then searched Github for Laravel Installer)

Get latest message (row) per user in Laravel

Trakus Ret

[Get latest message (row) per user in Laravel](https://stackoverflow.com/questions/38120810/get-latest-message-row-per-user-in-laravel)

TL;DR: Need latest message from each sender.In my Laravel application I have two tables:Users:Messages:And of course models.User model:Messages model:When user opens his inbox, he should see list of latest message from any other user.So if there are messages:Then user with id 1 (recipient_id) should see only messages with id 2 and 4.This is current solution in Users model:This is working, but I was wandering if it is possible to achieve this the Laravel way. Probably with eager loading. My Laravel skills just not enough and after several days of trying I don't have a solution.Thanks.

2016-06-30 10:44:16Z

TL;DR: Need latest message from each sender.In my Laravel application I have two tables:Users:Messages:And of course models.User model:Messages model:When user opens his inbox, he should see list of latest message from any other user.So if there are messages:Then user with id 1 (recipient_id) should see only messages with id 2 and 4.This is current solution in Users model:This is working, but I was wandering if it is possible to achieve this the Laravel way. Probably with eager loading. My Laravel skills just not enough and after several days of trying I don't have a solution.Thanks.Taking inspiration from this post, the most efficient way to do this would be like so:While it is not the most Laravel friendly, it is the best solution based on performance as highlighted by the post linked in this answer aboveWhy not simply accessing the messages, like this -I tried some similar approach and found out you only need to orderBy created_at immediately you find all the messages of the User then you can use Laravel's Collection to group them them by sender_id. So to my understanding, the following approach should work, i.e give you the last message receive by the user from the senders :So assuming you have an Authenticated User as $user which in this context is the same as receiver with receiver_id in messages table, then:Then loop round the collection, and fetch the first:You should end up with the result such as:Hope it helps :)UPDATE: I will break it down as I tried it. ~It fetches all records of messages that belongs to user into a collection (already ordered by created_at) then, using laravel's groupBy() you have a result like the example given in that doc.This time I didnt convert to Array. Instead, its a collection Of Collections. like collection(collection(Messages))Then you pick the first Model at each index. The parameters I already passed into the get() method ensures only those fields are present (i.e ->get(['sender_id', 'body', 'created_at']). This is is totally different from mysql groupBy(), as it does not return one row for each group rather, simply groups all records by the given identifier.ANOTHER UPDATEI discovered later that calling unique() method on the resulting ordered messages would actually do the job, but in this case the unique identifier would be sender_id. (ref: Laravel's unique)That is:The consequence is that we don't need the foreach and the groupBy we have the result here.One other way to avoid repeatition (of the above) if this is needed in more than one place is to use Laravel's query scope i.e in Message model we can have something as this:Then in the controller use:PS: Still not sure which one is optimally better than the other.this may be a solution (not tested though) I like a simpler approach which is mentioned here.In your User model additionally to existing messages() relationship,  add this relationshipThen when you query simply query like this.$messages contains latest message per user.EditIn order to order the result by datetime/id you could do it like this.$messages contains latest message per user ordered by id. Refer this answerThis is the most "Eloquent way" I have found of doing this:In User model:Then just $user->latestMessagePerSenderMaybe you can try this one:This may not be very efficient since it took two queries to do the job but you will gain benefits thru code readability.I hope it works the way it should be. I haven't tested it though but that's how I usually do this... Cheers!I found this solution in another forum, I think that is what you were looking for. I post it so it can be useful for other usersoriginal post: https://laracasts.com/discuss/channels/laravel/get-the-latest-message-of-chat-model-with-mysql-just-cannot-get-the-idea-how-to-do-this?page=1#reply=392529You can try this one

Laravel or Phalcon for a heavy-traffic site [closed]

Noah Goodrich

[Laravel or Phalcon for a heavy-traffic site [closed]](https://stackoverflow.com/questions/24997988/laravel-or-phalcon-for-a-heavy-traffic-site)

I come from a Codeigniter background. I've used it for three years and really like it. It's simplicity is great.I've built massive sites with Codeigniter, but I'm looking for a new PHP framework to learn.The main reason for this change is a potentially big project on the horizon. It will not have many users (perhaps 100 at most), but the outbound traffic produced by the server will be huge. The project will transmit thousands of files (ranging in size from 1mb to several hundred mb) via FTP, one after the other. It also deals with users uploading hundreds of files.The key for this project is speed. The system needs to fly through the running of the scripts (it runs a long script every time a file is sent via FTP to gather the file, it's type and it's destination) as quickly as possible to minimize performance issues. I'm aware that the transmitting of the files will only be as quick as the server can do it, and really as quick as the slowest bottleneck, but here I'm trying to minimize the bottleneck in the code as much as possible. After a bit of research, I like the look of Laravel and have installed it to get to grips with it. But it's could its speed be an issue as its been tested to be slower than Codeigniter? Will heavy traffic and a lot of PHP parsing slow down the  I know that Phalcon is based on C thus making it the fastest framework, would Phalcon be the better choice?Any thoughts are much appreciated :)

2014-07-28 14:55:09Z

I come from a Codeigniter background. I've used it for three years and really like it. It's simplicity is great.I've built massive sites with Codeigniter, but I'm looking for a new PHP framework to learn.The main reason for this change is a potentially big project on the horizon. It will not have many users (perhaps 100 at most), but the outbound traffic produced by the server will be huge. The project will transmit thousands of files (ranging in size from 1mb to several hundred mb) via FTP, one after the other. It also deals with users uploading hundreds of files.The key for this project is speed. The system needs to fly through the running of the scripts (it runs a long script every time a file is sent via FTP to gather the file, it's type and it's destination) as quickly as possible to minimize performance issues. I'm aware that the transmitting of the files will only be as quick as the server can do it, and really as quick as the slowest bottleneck, but here I'm trying to minimize the bottleneck in the code as much as possible. After a bit of research, I like the look of Laravel and have installed it to get to grips with it. But it's could its speed be an issue as its been tested to be slower than Codeigniter? Will heavy traffic and a lot of PHP parsing slow down the  I know that Phalcon is based on C thus making it the fastest framework, would Phalcon be the better choice?Any thoughts are much appreciated :)I am unsure if your question will be taken down as it being an opinion (you know according to guidelines and all) but IMO - despite Phalcon being fast for its C build, I find (being Laravel 3 user transitioning from Codeigniter before it retired) with Laravel 4 now - it has a lot of integration with known networks and architectures.Not to bash Phalcon as I have very minimal usage of it but here are some bullets for Laravel:Some further readings from those who switched over and wondered like you:

http://www.web-and-development.com/laravel-vs-codeigniter/and

http://mulzer.tumblr.com/post/24141993116/12-reasons-you-should-switch-from-codeigniter-toNow a bullets for Phalcon vs Laravel in speed:

With Laravel + APC + a few other tweaks you can achieve something close to it while giving you all the flexibility that you gain from Laravel.Finally if you need a side by side comparison:

http://vschart.com/compare/phalconphp/vs/laravelIf it's just about speed take a look at this benchmark: 

http://systemsarchitect.net/performance-benchmark-of-popular-php-frameworks/I would def go with phalcon since it's created on c level basically the same as if it is php  itself.As of the writing of this edit, the site mentioned above is non-functional. Below is a snapshot from archive.org:

https://web.archive.org/web/20160329072449/http://systemsarchitect.net:80/2013/04/23/performance-benchmark-of-popular-php-frameworks/

Get record by ID and all foreigns recursive in Laravel 5

Siper

[Get record by ID and all foreigns recursive in Laravel 5](https://stackoverflow.com/questions/31427227/get-record-by-id-and-all-foreigns-recursive-in-laravel-5)

I've two tables, looks that (migrations):The 'set' table is for storing data in which the location (country, city...) the post should be view. For example, let's store some countries:And, my post has set_id as 6. Looking logically, when I want get posts from Europe (ID 1), that post should be returned too, because 6 belongs to 5, and 5 belongs to 1. And this is that what I want to do. It's possible to do without using too much PHP? 

2015-07-15 09:58:07Z

I've two tables, looks that (migrations):The 'set' table is for storing data in which the location (country, city...) the post should be view. For example, let's store some countries:And, my post has set_id as 6. Looking logically, when I want get posts from Europe (ID 1), that post should be returned too, because 6 belongs to 5, and 5 belongs to 1. And this is that what I want to do. It's possible to do without using too much PHP? Okay, I found the best solution. It's the Nested Set pattern. I used baum package and it looks that:For sets table I added Baum's colums:And done! Just get set_id's and return posts, for example:I’m leave this for posterity ;)You need to break down region, country and city into different tables and establish the relationship between these OR

you can list all the combinations in one single table i.e. ID | Region | Country | City so you would have separate row for each city containing the country and the region.

Is Laravel 5.1 Compatible with PHP 7

Enijar

[Is Laravel 5.1 Compatible with PHP 7](https://stackoverflow.com/questions/34308160/is-laravel-5-1-compatible-with-php-7)

According to the installation section on the Laravel website, 5.1 is compatible with PHP >= 5.5.9.Looking through the incompatibilities I can't see anything that immediately flags warning signs.Has anyone run into issues running PHP 7 with Laravel 5.1?Edit: Set Kyar Wa Lar linked a useful resource to PHP 7 and Laravel.

2015-12-16 09:24:18Z

According to the installation section on the Laravel website, 5.1 is compatible with PHP >= 5.5.9.Looking through the incompatibilities I can't see anything that immediately flags warning signs.Has anyone run into issues running PHP 7 with Laravel 5.1?Edit: Set Kyar Wa Lar linked a useful resource to PHP 7 and Laravel.No issues on my local VM installed from Laravel Homestead Box.

Everything works really fine.You have all the setup information for this box here and a specific section for PHP 7 upgrade: http://laravel.com/docs/5.1/homesteadFor Laravel 5.1.43, with updated vendor, is compatible with PHP 7.and you can make sure through these methods by your self for any version of Laravel.1. All unit test passed in PHP 7.0.82. Homestead for 5.1 is already upgrade to PHP 7https://laravel.com/docs/5.1/homestead3. Analysis using PHP-MigrationThese spots is compatible with PHP 7 after manually checking.For better experience with PHP 7.3, you may simply upgrade it to Laravel 5.2.

It works well with PHP 7.3 environment.

Get enum options in laravels eloquent

barfoos

[Get enum options in laravels eloquent](https://stackoverflow.com/questions/26991502/get-enum-options-in-laravels-eloquent)

In my migration file, I gave my table pages a enum field with 2 possible values (as seen below). My question is, if it's possible to select these values with Laravels Eloquent?There are several Workarounds that I found, but there must be some "eloquent-native" way to handle this. My expected output would be this (that would be perfect!):Thank you in advance!

2014-11-18 10:03:59Z

In my migration file, I gave my table pages a enum field with 2 possible values (as seen below). My question is, if it's possible to select these values with Laravels Eloquent?There are several Workarounds that I found, but there must be some "eloquent-native" way to handle this. My expected output would be this (that would be perfect!):Thank you in advance!Unfortunately, Laravel does not offer a solution for this. You will have to do it by yourself. I did some digging and found this answerYou can use that function and turn it into a method in your model class...And you use it like thisIf you want you can also make it a bit more universally accessible and generic.First, create a BaseModel. All models should then extend from this classAfter that, put this function in thereYou call this one like thatMade a small improvement to lukasgeiter's function.  The foreach loop in his answer is parsing the string.  You can update the regex to do that for you.As of L5.17 Eloquent does not include this functionality, instead you need to fall back to native QL. Here's an example that will work with SQL and in one line - returning an array like you asked.In the spirit of one liner complexity ;)I threw this in one of my view composers - it fetches the column from the table, explodes it and assembles the values in an array.I iterate over that in my views using a foreach.

Laravel pagination pretty URL

jOpacic

[Laravel pagination pretty URL](https://stackoverflow.com/questions/20974404/laravel-pagination-pretty-url)

Is there a way to get a pagination pretty URL in Laravel 4?For example, by default:And what I would like to get:Also, the pagination should render this way, and appending to the pagination should appear in this way.

2014-01-07 14:38:58Z

Is there a way to get a pagination pretty URL in Laravel 4?For example, by default:And what I would like to get:Also, the pagination should render this way, and appending to the pagination should appear in this way.Here's a hacky workaround. I am using Laravel v4.1.23. It assumes page number is the last bit of your url. Haven't tested it deeply so I'm interested in any bugs people can find. I'm even more interested in a better solution :-)Route:View:Model:Migration:It's possible but you need to code a bit.First you need to change in app/config/app.php pagination service provider - you need to write your own.Comment:and addin providers section.Now you need to create your PaginationServiceProvider to use custom pagination factory:model/Providers/PaginationServiceProvider.php file:Above you create Providers\PaginationFactory object, so now we need to create this file:model/providers/PaginationFactory.php file:Here you create only \Utils\Paginator object so now let's create it:model/Utils/Paginator.php file:In this file we finally override default method for creating pagination urls.Let's assume you have route defined this way:As you see we defined here route name using as (it's important because of Paginator implementation above - but you can do it of course in different way).Now in method displayList of CategoryController class you can do:When in your view you add:you will get generated urls this way:without ? in query stringHowever in my opinion something like this should be added by default or at least it should be enough to extend one class and not to create 3 classes just to implement one method.hope this is helpful for someone, I've made a trait to be used in models.

The idea is that this custom method can detect current route and adjust links  to use correct segment position for {page} parameter:https://gist.github.com/zofe/ced0054e6ac6eff1ea95The only way I can think of doing this is by extending the Paginator class to do the matching. However, just know that it may conflict with third-party packages and other classes/libraries. The current method is designed to work with nearly all classes/libraries/packages.Perhaps you could try the following:http://packalyst.com/packages/package/desmart/pagination ('pagination' by 'desmart')For anyone that is using laravel version 5.6+You can pass additional parameters to set the page number.According to: https://laravel.com/api/5.6/Illuminate/Database/Eloquent/Builder.html#method_paginateExample:StoreController.phpThen, in your blade template. You can just route( ... , array('page' => $page));For Laravel 5.8 use this solution in blade.php where you generate links:

Laravel homestead IP address not working

evcohen

[Laravel homestead IP address not working](https://stackoverflow.com/questions/28036879/laravel-homestead-ip-address-not-working)

I’m using Laravel Homestead 2.0 for my VM and am trying to serve my sites on the default IP address in the YAML file 192.168.10.10My /etc/hosts file looks like this:My Homestead.yaml file looks like this:The sites come up when I link my domains to 127.0.0.1 but I have to append port 8000 onto the end of the URL (which isn’t a big deal, I just want to get the specified IP address to work). Does anyone know why I cannot connect to server when my domains are pointed to 192.168.10.10?When I ping deploy.dev the right IP address shows up, but still my browser can’t connect to the server. I’m thinking it might have something to do with DNS issues in Yosemite.

2015-01-20 02:39:17Z

I’m using Laravel Homestead 2.0 for my VM and am trying to serve my sites on the default IP address in the YAML file 192.168.10.10My /etc/hosts file looks like this:My Homestead.yaml file looks like this:The sites come up when I link my domains to 127.0.0.1 but I have to append port 8000 onto the end of the URL (which isn’t a big deal, I just want to get the specified IP address to work). Does anyone know why I cannot connect to server when my domains are pointed to 192.168.10.10?When I ping deploy.dev the right IP address shows up, but still my browser can’t connect to the server. I’m thinking it might have something to do with DNS issues in Yosemite.I had the same problems a few weeks ago.First:

make sure your folder paths are correct, if so, double check itNext:

run homestead destroy and homestead up to reinitialize the VMif that all didnt work:

Check if you have any devices at home that might also be on 192.168.10.10.If that all didnt work, your problem is probably alot harder to fix and i'd suggest making a github issue for it.Hey I had this exact same problem. I eventually got it working by installing the deprecated net-tools package: 

sudo apt-get update and

sudo apt-get install gnome-nettoolAfter this,

homestead destroy and

homestead upThis allowed me to access my virtual machine sites from my local machine's browser using the 'domains' I specified in the hosts file - in your case beta.dev and deploy.dev - without referring to localhost or port 8000. Good luck, hope this helps.This is the solution I did for my Windows 10 machine:Make sure you add a persistent route to your vagrant box

In Administrator command prompt enter

route -p add 192.168.10.0 mask 255.255.255.0 192.168.10.1And make sure you are able to ping 192.168.10.10Also check the IP address configured for the virtualbox host-only adapter is 192.168.10.1 with mask 255.255.255.0Installing net-tools on ubuntu fixed this for meI had exactly this issue, and it turned out that nginx was failing to start due to an error when loading the TLS certificates. The vagrant up command doesn't report that nginx failed to start, or that any ports failed to bind.To diagnose this, I did the following:There is no port 80 in the list. Let's double-check port 80.So it is certainly closed. What do the guest logs say? vagrant ssh and...Nginx has failed to start due to an error in it's config. The PEM_read_bio_X509_AUX error points to the /etc/nginx/ssl/homestead.app.crt file. Where is that file used in the configuration?I commented out the related lines:Start nginx with $ sudo service start nginx and run nmap again from the host.Port 80 is open and should be accessible now from http://homestead.app . Of course TLS won't be working but you should be able to fix it by generating new certificates. I'm not sure of the reason for the certificates failing to load in the first place.I had the same situation, but I made a change.I changed my /etc/hosts file with this IP 127.0.0.1I had a similar issue yesterday for Homestead 5. It turned out the cause of my problem was that I was running the wrong Vagrantfile.An instance should give a response to the ip address: 192.168.10.10To correct the problem in my case what I did was to follow these instructions: http://laravel.com/docs/5.0/homesteadTo recap:In terminal run: then then and run this command FROM INSIDE the new "Homestead" folderthen run the commands vagrant up and vagrant provision to that Vagrantfile, that should have been created inside ./HomesteadHere is what the output of the vagrant provision command looks like on my system:In my case the problem was solved by letting vagrant up install the guest additions:After this point, I got a new interface with the expected IP address:I had this issue come up on my Windows machine and it turns out I had accidentally reversed the folders section "map" and "to". When I found that the folder wasn't underneath ~/code/ in the vagrant ssh session it was obvious it wasn't working right, but double checking the paths didn't yield anything. Here is the correct way to map the folder section on your Windows machine:

Recommend way to Artisan on Docker

tomsowerby

[Recommend way to Artisan on Docker](https://stackoverflow.com/questions/24821859/recommend-way-to-artisan-on-docker)

I am yet to find an elegant and efficient way to run Laravel Artisan commands in my Docker based local dev environment.Could anybody suggest the recommended or "proper" way to do things like migrations?Or, has anybody found a neat way of doing this? Ideally with examples or suggestions.Things that I've considered:I'm still getting my head around Docker and it's new-container-for-everything approach.I suppose I want to balance cool-dev-ops stuff with why-do-I-need-another-fake-server-just-get-it-working-already.I'd love to commit to it for my dev workflow, but it seems to become awkward to use under certain circumstances, like this one...Any suggestions and ideas are welcome. Thanks all.

2014-07-18 09:40:13Z

I am yet to find an elegant and efficient way to run Laravel Artisan commands in my Docker based local dev environment.Could anybody suggest the recommended or "proper" way to do things like migrations?Or, has anybody found a neat way of doing this? Ideally with examples or suggestions.Things that I've considered:I'm still getting my head around Docker and it's new-container-for-everything approach.I suppose I want to balance cool-dev-ops stuff with why-do-I-need-another-fake-server-just-get-it-working-already.I'd love to commit to it for my dev workflow, but it seems to become awkward to use under certain circumstances, like this one...Any suggestions and ideas are welcome. Thanks all.The best practice regarding Docker is to run each process inside it's own container. Therefore, the ideal way to run artisan commands is to have an image for creating containers specifically for this purpose.I've created an image which can be pulled from the Docker Hub dylanlindgren/docker-laravel-artisan and it works really well. It's on GitHub as well if you want to take a look at the Dockerfile behind it.I've also just written a blog post describing the way that all these seperate containers fit together.Docker 1.3 bring new command exec

So now you can "enter" running container likeAfter that you can run any command you wantThere are a couple of possibilities...If you're primarily interested in deployment and you're doing it via a dockerfile, then the answer would be to add composer install and php artisan migrate to your dockerfile so they run when the container is built.I'm interested in hearing more answers to this. It's something that I'm just getting into as well and would like to learn more about.I use SSH and run migrations from a terminal inside the container.I personally like Phusion's approach of using Docker as a 'lightweight virtual machine'. So I used their baseimage-docker which I've extended to create my own Docker image for Laravel applications.I'm aware Phusion's image can be contentious in the Docker community, and that SSH is frowned upon by some who advocate Docker containers as microservices. But I'm happy with Phusion's approach until there are more established tools and practices for the multi-container approach.

How to retrieve full data of record by its foreign key in laravel?

user2551866

[How to retrieve full data of record by its foreign key in laravel?](https://stackoverflow.com/questions/17873721/how-to-retrieve-full-data-of-record-by-its-foreign-key-in-laravel)

I've been trying to figure out the proper way to get all the data from a record via a foreign key. I have  simple app where users can add books to their "bookshelf". Here are my tables:USERS BOOKSBOOKSHELFBOOKSHELF_BOOKSIn my Eloquent Models, a bookshelf hasMany books and bookshelf_books belongsTo a bookshelfand I have set those up in my models. What happens is users create a "bookshelf" and add books to it from the list of books. I'm at the point where I need to render the bookshelf with the user's books.When I retrieve my bookshelf books with a call like Bookshelf::find($id)->books, the books that belong to that bookshelf return just fine..but only columns from the bookshelf table. So I get in return the bookshelf id, the user id, and the book id.What I want to have returned is all the data of the book itself when i query for books in the bookshelf, not just it's id. E.G. [{"book_id":1, "pages":364, "number_of_chapters":14},{"book_id":2, "pages":211, "number_of_chapters":9}]. I've been scratching my head all day trying to figure out how to take this "join" one step further in Laravel/Eloquent ORM. Would love any help with this, thanks!!

2013-07-26 05:38:49Z

I've been trying to figure out the proper way to get all the data from a record via a foreign key. I have  simple app where users can add books to their "bookshelf". Here are my tables:USERS BOOKSBOOKSHELFBOOKSHELF_BOOKSIn my Eloquent Models, a bookshelf hasMany books and bookshelf_books belongsTo a bookshelfand I have set those up in my models. What happens is users create a "bookshelf" and add books to it from the list of books. I'm at the point where I need to render the bookshelf with the user's books.When I retrieve my bookshelf books with a call like Bookshelf::find($id)->books, the books that belong to that bookshelf return just fine..but only columns from the bookshelf table. So I get in return the bookshelf id, the user id, and the book id.What I want to have returned is all the data of the book itself when i query for books in the bookshelf, not just it's id. E.G. [{"book_id":1, "pages":364, "number_of_chapters":14},{"book_id":2, "pages":211, "number_of_chapters":9}]. I've been scratching my head all day trying to figure out how to take this "join" one step further in Laravel/Eloquent ORM. Would love any help with this, thanks!!Just eager load the relationshipChangetoWhat about just doing it manually, and building your own array.Then just return $thebooks to the View.  Which will be an array of book models.What you have should be correct.$bookshelf = Bookshelf::find($id)->books;To get your books, you would create a loop...To take this further, if you had an Author model which your books would belongTo(), you could even do something like..Try this queryTry this sql statement, it will work.

How to Display Validation Errors Next to Each Related Input Field in Laravel 5?

Matt Komarnicki

[How to Display Validation Errors Next to Each Related Input Field in Laravel 5?](https://stackoverflow.com/questions/36885413/how-to-display-validation-errors-next-to-each-related-input-field-in-laravel-5)

Default solution is trivial:and I can include errors.blade.php anywhere.Is there any way to extract each element and display it next to input field that holds the value that failed?I assume that would require me to define a lot of conditional if statements next to each input, right? How to sort this problem? Could you give me any examples?Thanks.

2016-04-27 09:16:29Z

Default solution is trivial:and I can include errors.blade.php anywhere.Is there any way to extract each element and display it next to input field that holds the value that failed?I assume that would require me to define a lot of conditional if statements next to each input, right? How to sort this problem? Could you give me any examples?Thanks.You can use something like this :@Zorx has given a right solution. But what if there are multiple errors and you want to display all of them at once.According to the documentation you could use:Retrieving All Error Messages For A FieldIf you are validating an array form field, you may retrieve all of the messages for each of the array elements using the * character:Retrieving All Error Messages For All Fields

Laravel Interfaces

Hardist

[Laravel Interfaces](https://stackoverflow.com/questions/30976140/laravel-interfaces)

I used the following tutorial to get an idea about interfaces:http://vegibit.com/what-is-a-laravel-interface/But I wanted to change the directory of where I am putting my interfaces to "App/Models/Interfaces". And so I did. But now I cannot get it to work anymore. Here is my code:Routes.phpModel Subaru.phpInterface CarInterfaceI added this in my composer.json:And I even added this in my start/global.php file:

2015-06-22 09:14:30Z

I used the following tutorial to get an idea about interfaces:http://vegibit.com/what-is-a-laravel-interface/But I wanted to change the directory of where I am putting my interfaces to "App/Models/Interfaces". And so I did. But now I cannot get it to work anymore. Here is my code:Routes.phpModel Subaru.phpInterface CarInterfaceI added this in my composer.json:And I even added this in my start/global.php file:In my recent laravel 5 project, I'm used to prepare my logics as Repository method. 

So here's my current directory structure. For example we have 'Car'.So first I just create directory call it libs under app directory and loaded it to composer.jsonafter that I create a subfolder call it Car . Under the Car folder create two file 'CarEloquent.php' for eloquent implementation and CarInterface.php as interface.Then create Car Service Provider to bind ioc controller.

For create Car service provider you can also use php artisan command by laravel. 

php artisan make:provider CarServiceProvider And final step would be add these service provider to config/app.php provider array.And finally we are ready to use our repository method in our controller.Main purpose to achieve here call repository method to controller, however you need use them as per your requirement.CarEloqent basically help us to improve database implementation, for example in future if you want to implement same functionality for other database like redis you just add another class CarRedis and change implementation file path from server provider. http://programmingarehard.com/2014/03/12/what-to-return-from-repositories.html[book] From Apprentice to Artisan by Taylor OtwellVery good explanation about repository method and software design principle commonly called separation of concerns. You should read this book. If you still have any confusion to achieve these behaviors let me know and however I will keep eye on this question to update this answer, if I find some things to change or update or as per requirement. 

Laravel artisan optimize Best Practices

suncoastkid

[Laravel artisan optimize Best Practices](https://stackoverflow.com/questions/31895854/laravel-artisan-optimize-best-practices)

I'm trying to fully understand the Laravel (5.1) artisan optimize command and best practices, but the documentation seems lacking. I don't have Composer installed on the production server so, specifically, I want to know what files are modified or created when running artisan optimize --force on development that must get pushed to production. The goal being not to blow up the app in production! After running the command, I see the following files have been modified:Am I overthinking this, or do I just push these files to production and I'm good to go? Also, what is the best practice regarding when to run artisan optimize? Each time a new model is created? What about controllers, routes and helper classes? Lastly, I see the \bootstrap\cache\compiled.php file is a whopping 548KB and almost 17K lines! Is that really considered optimal?

2015-08-08 16:00:01Z

I'm trying to fully understand the Laravel (5.1) artisan optimize command and best practices, but the documentation seems lacking. I don't have Composer installed on the production server so, specifically, I want to know what files are modified or created when running artisan optimize --force on development that must get pushed to production. The goal being not to blow up the app in production! After running the command, I see the following files have been modified:Am I overthinking this, or do I just push these files to production and I'm good to go? Also, what is the best practice regarding when to run artisan optimize? Each time a new model is created? What about controllers, routes and helper classes? Lastly, I see the \bootstrap\cache\compiled.php file is a whopping 548KB and almost 17K lines! Is that really considered optimal?[edit - As @crishoj says, as of Laravel 5.5, php artisan optimize is no longer needed]Normal Laravel practice is to have composer installed on your production server.These are the steps Envoyer (made by Laravel's creator) takes to deploy an app on production -- I've annotated them below:As of Laravel 5.5, php artisan optimize is not longer required.You can also take benefit of laravel packages to easily optimize your application by caching page partialshttps://github.com/imanghafoori1/laravel-widgetize

Laravel belongsTo returning null when using 'with'

Djave

[Laravel belongsTo returning null when using 'with'](https://stackoverflow.com/questions/26778082/laravel-belongsto-returning-null-when-using-with)

I'm just getting started with Laravel so please forgive any noobness.I have a User and Order model, a user has many orders:So I think I have the above right.But when I do this:I get Call to a member function addEagerConstraints() on null.However, if I do it the other way around, it works great:What am I doing wrong / what don't I understand?! Or is my problem bigger than I think?Database:

2014-11-06 11:14:35Z

I'm just getting started with Laravel so please forgive any noobness.I have a User and Order model, a user has many orders:So I think I have the above right.But when I do this:I get Call to a member function addEagerConstraints() on null.However, if I do it the other way around, it works great:What am I doing wrong / what don't I understand?! Or is my problem bigger than I think?Database:The problem is you don't have return for your orders relationship. It should be:You should also use your relationships case sensitive. you showed:is working, but you should rather use to avoid extra queries to your database in futureFor anyone else that runs across this, I was having the same issue, but my problem was that I had the foreign/local keys swapped. Example:Notice that for hasX relationships, the foreign key is the second parameter, and the local key is the third. However, for belongsTo relationships, these two are swapped.

laravel - Can't get session in controller constructor

gogagubi

[laravel - Can't get session in controller constructor](https://stackoverflow.com/questions/41542802/laravel-cant-get-session-in-controller-constructor)

In new laravel I can't get session in constructor. Why? and then below In old laravel i remember there was not this problem. something changed?

2017-01-09 07:15:04Z

In new laravel I can't get session in constructor. Why? and then below In old laravel i remember there was not this problem. something changed?You can't do it by default with Laravel 5.3. But when you edit you Kernel.php and change protected $middleware = []; to the following it wil work.Hope this works!As of other answers no out of the box solution for it.

But you still can access it using Middleware in constructor.So here is another hackLaravel 5.7 solutionIf you want to use constructor for any other functionality or query or data then do all the work in $this->middleware function, NOT outside of this. If you do so it will not work in all the functions of entire class.In Laravel 5.3 sessions related functionality will not work in the a controller constructor, so you should move all sessions related logic to methods.I used Session in the construct using middleware, You can try, It would be helpful

How to validate time in laravel

Vikash

[How to validate time in laravel](https://stackoverflow.com/questions/39467452/how-to-validate-time-in-laravel)

I want to validate time in Laravel. Ex:- I want that when user input the time between 8 PM to 10 PM then it will show the validation error. How can I achieve that in Laravel

2016-09-13 10:11:23Z

I want to validate time in Laravel. Ex:- I want that when user input the time between 8 PM to 10 PM then it will show the validation error. How can I achieve that in LaravelUse date_format rule validationFrom docsThe field under validation must match the format defined according to the date_parse_from_format PHP function.Probably this code would work in your controller. However it won't validate times from different days (eg 9pm - 3am next day). time_start and time_end in this case should be provided as HH:mm but you can change it easily.Try This codeCreate DateRequest and then addYou probably should take a look to this bit of the documentations. A custom rule sounds like your way to go.In Lavavel 5.6:Inside the file located in /app/Http/Requests/YourRequestValidation

Laravel 4 : Best Practice to Trim Input before Validation

Chen-Tsu Lin

[Laravel 4 : Best Practice to Trim Input before Validation](https://stackoverflow.com/questions/22399326/laravel-4-best-practice-to-trim-input-before-validation)

Now, I do trim for each input separately like below code:Is any approach to do Trim at the same time withInput::all() or Input::only('username', 'password', 'email')?And what is the best practice to do this?

2014-03-14 08:04:02Z

Now, I do trim for each input separately like below code:Is any approach to do Trim at the same time withInput::all() or Input::only('username', 'password', 'email')?And what is the best practice to do this?Note: This solution won't work if any of your inputs are arrays (such as "data[]").You may try this, trim using this one line of code before validation:Now do the rest of your codingIf you want to exclude some inputs from trimming then you may use following instead if all()Or you may useUpdate: Since Laravel 5.4.* inputs are trimmed because of new TrimStringsmiddleware. So, no need to worry about it because this middleware executes on every request and it handles array inputs as well.Depending on your project, the below might be too intrusive/generalized/etc for your needs; customize as needed.app/helpers.phpapp/filters.phpMaybe you can use the array_map function of php, to trim the content of your input array.Or if you want a variable you can use later:Usually, I also use this approach to replace optional values with null when they're empty, because I prefer to store them in DB as NULL rather than empty strings.It's a better practice to do trimming in the model instead of in controllers because then you don't have to duplicate code in all your controllers to trim the same things over and over:This way, you never have to remember to trim anything model attributes in your controllers. The model will take care of it and you don't have to worry about it ever again.As far as trimming everything at once vs. individually, I think the difference is so small that no human would ever notice the difference.A combination of the above is best. Generally you'll want to filter on all input apart from password and password_confirmation fields. Also doing it with a single line in a filter is nice.// app/filters.phpan improvement in Halil Özgür code to remove all spaces, <br>, <br >, <br class="asdasd">, &nbsp, etcJust Use TrimStrings and ConvertEmptyStringsToNull Middleware.You do not need to do anything extra, because those middlewares are built-in to Laravel 5.4.See this PostEdit:

What if I am not using Laravel 5.4?

How to give custom field name in laravel form validation error message

JOE

[How to give custom field name in laravel form validation error message](https://stackoverflow.com/questions/25187846/how-to-give-custom-field-name-in-laravel-form-validation-error-message)

I was trying form validation in laravel. 

I have a input text field in my form called 'Category' and i'm given the field name as 'cat' as short. And i defined the validation rules like this.When the validation fails i'm getting error message like thisBut i want to display it as "The category field is required" instead of 'cat'. How can i change 'cat' to 'Category' in error message ?.

2014-08-07 16:41:25Z

I was trying form validation in laravel. 

I have a input text field in my form called 'Category' and i'm given the field name as 'cat' as short. And i defined the validation rules like this.When the validation fails i'm getting error message like thisBut i want to display it as "The category field is required" instead of 'cat'. How can i change 'cat' to 'Category' in error message ?.You can specify custom error message for your field as follows.Please see Custom Error Messages section in laravel documentation for more information. Or you can keep a mapping for your field names like below. And you can set those into you validator. So you can see descriptive name instead of real field name.I'm using this to deal with dynamic row addition in forms. This answer is provided in context of managing larger forms.

This answer is for Laravel 5Form requestHope this help steer you in the right direction if you are using Laravel 5. I'm currently working on testing it out. The documentation seems to be amiss regarding this potential?I did some digging in the framework (Illuminate\Foundation\Http\FormRequest.php) and (Illuminate\Validation\Validator.php) for the clues. you can customize every message ,also change the attribute fields name in validation.php (resources/lang/en/).

for set the attribute in validation.php Here's an alternative:Simply got to resources/lang/en/validation.phpThere is a blank array named attributes.add your attribute name here like 'cat'=>'category'now all validation messages show category instead of cat.Here is an Alternative

$this->validate(request(), [rules], [custom messages], [Custom attribute name]);

Saving one to one relation in Laravel

rap-2-h

[Saving one to one relation in Laravel](https://stackoverflow.com/questions/32498142/saving-one-to-one-relation-in-laravel)

A User has one (or zero) Company, and a Company belongs to one and only one User. I try to save a company for a user but it adds a new entry in database every time I re-trigger the save method. It's a one to one relation, so I though save method on User.So Company has one method user():And User has one method company():I'm trying to save (so create or update) a user's company like this (in a Controller):First time I run this code it creates the entry in database (OK), but second time it adds a new entry for the same user (Not OK). I thought it will only update the database entry.Is it a glitch (or something I don't understand in one to one relation) in Laravel or am I doing something wrong? (I think and hope it's the second purpose)

2015-09-10 09:32:46Z

A User has one (or zero) Company, and a Company belongs to one and only one User. I try to save a company for a user but it adds a new entry in database every time I re-trigger the save method. It's a one to one relation, so I though save method on User.So Company has one method user():And User has one method company():I'm trying to save (so create or update) a user's company like this (in a Controller):First time I run this code it creates the entry in database (OK), but second time it adds a new entry for the same user (Not OK). I thought it will only update the database entry.Is it a glitch (or something I don't understand in one to one relation) in Laravel or am I doing something wrong? (I think and hope it's the second purpose)Creating and updating need to treat differently. So check the existence of company attribute first.Note that hasOne() does not guarantee that you will have one-to-one relationship, it just telling Eloquent how to create query. It works even you have multiple Company refer to same User, in such case when you call $user->company you will get first Company in the result data set from database.You can do exactly that with the updateOrCreate method:The first parameter of updateOrCreate is an empty array, because the companies id is determined by the hasOne relationship $user->company().And by the way, I would recommend not using an auto-increment id field in a hasOne relationship. If you set user_id as primary in your company table, its technically not possible to create duplicate company rows for one user. Check out my blog post for more.You are doing wrong hereSo your code has to be modified like this

Laravel access request object outside controller

xelber

[Laravel access request object outside controller](https://stackoverflow.com/questions/38319707/laravel-access-request-object-outside-controller)

According to the Laravel documentation Request is acquired via dependency injection. For a controller this is fine, but how do we access Request object outside a controller, for example in a view

2016-07-12 03:46:41Z

According to the Laravel documentation Request is acquired via dependency injection. For a controller this is fine, but how do we access Request object outside a controller, for example in a viewThere is request helper in laravel. You can use Request Object anywhere.

For exampleHere's  laravel documentation link for request helper

https://laravel.com/docs/5.2/helpers#method-request

In Laravel 5, What's the difference between {{url}} and {{asset}}?

无名小路

[In Laravel 5, What's the difference between {{url}} and {{asset}}?](https://stackoverflow.com/questions/39217975/in-laravel-5-whats-the-difference-between-url-and-asset)

I find sometimes both is OK?  So what's the really difference?For example,andthese two form is both OK.So, what's the differences?

2016-08-30 02:40:32Z

I find sometimes both is OK?  So what's the really difference?For example,andthese two form is both OK.So, what's the differences?Consider the type of URL that is needed / how the URL is being used. One of the advantages of having separate helper methods for each type of URL is they can have different handling logic. For example, assets (e.g. CSS, images, etc.) could involve a check that the file exists in the file system but do not require the type of analysis that a route would because the route may have parameters.{{url}} allows you to create a link to a URL on your site -- another benefit is the fact that you can set the second parameter to an array with query string parameters within.{{asset} simply allows you to link to an asset within your public directory -- for example css/main.css.asset() asset function generates a url for an asset using the current scheme of request.

Ex : asset('images/img.png')url() The url function generates a fully qualified URL to the given path.Ex : url('admin/users')URL::route gets the URL to a named route. So in your case if you name your route like this:then you will be able to use<a href="{{ URL::route('register') }}" >Register 1</a>

in Blade templates.

Check if any error message exists and show all of them in laravel

Suman Ghosh

[Check if any error message exists and show all of them in laravel](https://stackoverflow.com/questions/12419814/check-if-any-error-message-exists-and-show-all-of-them-in-laravel)

In laravel for showing all error messages at once i use the following code in the viewBut when I want to use $errors->all() instead of $something in the if condition it's showing an errorAlthough the above code works fine, I think there may be a better ways to check if any error message exists and if it does then display it. 

2012-09-14 07:17:35Z

In laravel for showing all error messages at once i use the following code in the viewBut when I want to use $errors->all() instead of $something in the if condition it's showing an errorAlthough the above code works fine, I think there may be a better ways to check if any error message exists and if it does then display it. Yes, because you can't use any method as empty function parameter. From php docs:What class is $errors? If it's your own class you can implement such method like 'isEmpty()' and then use in if statement:In my controller I use the following code to pass validation errors to my view:Then, in my view, I can use the following code to check if errors exist:You can also use if($errors->all()). From the Laravel (v4) docs:

PDOException: could not find driver when using phpunit

melanholly

[PDOException: could not find driver when using phpunit](https://stackoverflow.com/questions/23245800/pdoexception-could-not-find-driver-when-using-phpunit)

I am starting to use laravel 4 and I am trying to start using unit tests so I can make my live easier. Well as all of you will guess my development hasn't become easier after trying phpunit tests. The simple tests are well, easy but when the things start to get a bit more complicated  they does not go as I though they will. The problem is I have conducted simple tests but I get some strange error PDOException: could not find driver. I have read a few articles and post on this topic but nothing solved my problem. I have installed php5-mysql and when I call php -m it says that I have both PDO and pdo_mysql. The actual command I use is php -m |grep -i "pdo" and the output is: Well I've tried to actualy test PDOException class in the browser. For that purpose I have change the mysql user password to incorrect one and tested what will happen in artisan server (called with command php artisan serve ---> http://localhost:8000/). In the browser everything works as a charm but when I try to call ``phpunit` in the console the result is not the same. I have tried to see if webserver and cli have different configuration files but it turnout that the files are identical. The configuration files that I have compared are:for the web serverfor command lineto compare them I user the diff command like so diff -s /path/to/file1 /path/to/file2.The errors look like this:Can you give me a hint or solution to this problem? Thank you for your time :)

2014-04-23 13:26:44Z

I am starting to use laravel 4 and I am trying to start using unit tests so I can make my live easier. Well as all of you will guess my development hasn't become easier after trying phpunit tests. The simple tests are well, easy but when the things start to get a bit more complicated  they does not go as I though they will. The problem is I have conducted simple tests but I get some strange error PDOException: could not find driver. I have read a few articles and post on this topic but nothing solved my problem. I have installed php5-mysql and when I call php -m it says that I have both PDO and pdo_mysql. The actual command I use is php -m |grep -i "pdo" and the output is: Well I've tried to actualy test PDOException class in the browser. For that purpose I have change the mysql user password to incorrect one and tested what will happen in artisan server (called with command php artisan serve ---> http://localhost:8000/). In the browser everything works as a charm but when I try to call ``phpunit` in the console the result is not the same. I have tried to see if webserver and cli have different configuration files but it turnout that the files are identical. The configuration files that I have compared are:for the web serverfor command lineto compare them I user the diff command like so diff -s /path/to/file1 /path/to/file2.The errors look like this:Can you give me a hint or solution to this problem? Thank you for your time :)It seems Laravel using SQLite as database for testing. See the backtrace at line 2:But this seems not installed on your system. So I think you need to install the SQLite driver.If you are using sqlite for testing you will need php sqlite driversFor Ubuntu 14.04In ubuntu 16.04 there is no php5-sqliteOn Windows i had to activate extension=php_pdo_sqlite.dll in php.ini.If you are occupying SqLite you have to enter php.init and uncomment this line.For those using Laravel Homestead, make sure you're running phpunit from within Homestead and not on your local machine! You can SSH into it with vagrant ssh.As others have mentioned, it requires SQLite and thus running it within your virtual machine ensures that's available to your test.php7.0-sqlite no longer works use php7.1-sqlite

Laravel Mail sending email but returning false

Chris Casper

[Laravel Mail sending email but returning false](https://stackoverflow.com/questions/24772531/laravel-mail-sending-email-but-returning-false)

I am trying to send a email and show any errors if needed. The following code is sending a email and I am receiving it just fine. The issue though, is that when I do the check on the $sent var, it returns false for me.Am I just missing something here? It might be because it's late. Who knows...

2014-07-16 05:01:55Z

I am trying to send a email and show any errors if needed. The following code is sending a email and I am receiving it just fine. The issue though, is that when I do the check on the $sent var, it returns false for me.Am I just missing something here? It might be because it's late. Who knows...The Mail::send() method doesn't return anything.You can use the Mail::failures() (introduced in 4.1 I think) method to get an array of failed recipients, in your code it would look something like this.

Import CSV file to Laravel controller and insert data to two tables

Devin Gray

[Import CSV file to Laravel controller and insert data to two tables](https://stackoverflow.com/questions/35220048/import-csv-file-to-laravel-controller-and-insert-data-to-two-tables)

So I am a complete noob to Laravel and am trying something here. I want to import a CSV file into two tables, I have a table called lists that will get the list name and a client_id.Then I have a table called customers that will get name surname contact number as well as client_id and a list_id. What I want to achieve is to import a CSV file that will take the file name and store it in the list table, then create an array through the CSV file and import the data into the customers table with the list and client id's.I have the first part done, and it inserts into the lists table correctly, How do I now create an array from the CSV that is located in storage/documents and then insert that into the customers table?I chose to use the answer that I had accepted but I also played with the other answer and got it to work like this.

2016-02-05 09:03:25Z

So I am a complete noob to Laravel and am trying something here. I want to import a CSV file into two tables, I have a table called lists that will get the list name and a client_id.Then I have a table called customers that will get name surname contact number as well as client_id and a list_id. What I want to achieve is to import a CSV file that will take the file name and store it in the list table, then create an array through the CSV file and import the data into the customers table with the list and client id's.I have the first part done, and it inserts into the lists table correctly, How do I now create an array from the CSV that is located in storage/documents and then insert that into the customers table?I chose to use the answer that I had accepted but I also played with the other answer and got it to work like this.There are 3 steps to read CSV file and import it in database in Laravel. Before we start, I have created a sample test.csv file and put it on my public folder under file folder:Step 1 and 2; I created a helper function called csvToArray, I just put it in my controller for now (this function is inspired from this link) it simply reads the CSV file and convert it to array:Step 3; And here is my final step, read array and insert it in our database:if you use dd($customerArr) you will get this

In your store() method, create the record in your lists table, and then iterate over the contents of the CSV file and insert the data into the customers table. You should create a relation between customers and lists for this purpose. You would also be better off using something like the PHP League’s CSV package for reading such files:@maytham The solution by Maytham will work well. However, it will have a huge problem if you're trying to do with large data. Even if you do 1000 rows, it will create a problem, as it will make 1000 insert statement separately. I will just edit the third method by him and add my own inputThis will call the database once to insert as many rows as you wish. Be it 1000, 100000 or whatever. 

However, if you have a huge csv, this will be a problem too since you will be required to insert in chunks. Like in PostgreSQL, I have noticed that you can insert up to 65000 something rows in one statement. Maybe I am wrong about the number but there's a limit in every database and you need to look for that.

My composer won't update completely with Laravel 4 it gets stuck with artisan

jnbdz

[My composer won't update completely with Laravel 4 it gets stuck with artisan](https://stackoverflow.com/questions/19775012/my-composer-wont-update-completely-with-laravel-4-it-gets-stuck-with-artisan)

Here is the error I am getting:This shows after:I tried to delete all my folders in my vendor folder. But that did not change anything.I am using MAMP server on my Mac OS X.PHP Version 5.4.10mcrypt 2.5.8I just tried "sudo composer update --verbose" and I got this error:Here is the error I found in my PHP error logs:I just tried to test my composer:Just applied the recommendation in the error message from the last command. Now everything is showing as OK.I just tried this:I am now getting new errors in my PHP Error logs:

2013-11-04 18:58:52Z

Here is the error I am getting:This shows after:I tried to delete all my folders in my vendor folder. But that did not change anything.I am using MAMP server on my Mac OS X.PHP Version 5.4.10mcrypt 2.5.8I just tried "sudo composer update --verbose" and I got this error:Here is the error I found in my PHP error logs:I just tried to test my composer:Just applied the recommendation in the error message from the last command. Now everything is showing as OK.I just tried this:I am now getting new errors in my PHP Error logs:I believe this error results from not being able to find mcrypt.Apparently it is not quite that easy to install mcrypt.The final steps were inspired by Vuk Stanković.Okay, did some further research with Google and it seems that this has to do with the autoload caching from Composer. There are various ways on how you can solve this.This would re-create the autoload stuff for you and it should solve your problem for now.If this doesn't help, try deleting everything and re-install fresh: [ref]This would re-create just about everything.It looks like your laravel install did not run correctly and since part of the composer.json runs the php artisan clear-compiled and php artisan optimize if your laravel application is not working then composer will fail. Try running your composer update without invoking the Laravel scripts.After that you can either run the commands from the scripts block in your composer.json manually. Else you can just run a standardagain which will run the scripts for you.To fix this you need to install mcrypt.

In ubuntu execute the following command: Then update composer:Another solution for me, setting xdebug.scream = 1 gives problem:1) Find xdebug configuration file. 2) Edit file using any text editor.3) Set xdebug.scream = 04) Reload serverI had a similar issue when trying to run composer update and none of the solutions above had worked. It turns out I had 2 require sections in my composer.json which is actually wrong. Combining the two as below solved my issue.If you still have a problem, try deleting the composer.lock and the vendor directory and runTo clear the composer cache and finally run This should solve the issue.

Laravel check for constraint violation

guidsen

[Laravel check for constraint violation](https://stackoverflow.com/questions/26363271/laravel-check-for-constraint-violation)

I was curious if there is a way we can check if there is a constraint violation error when delete or insert a record into the database.The exception thrown is called 'QueryException' but this can be a wide range of errors. Would be nice if we can check in the exception what the specific error is.

2014-10-14 14:24:25Z

I was curious if there is a way we can check if there is a constraint violation error when delete or insert a record into the database.The exception thrown is called 'QueryException' but this can be a wide range of errors. Would be nice if we can check in the exception what the specific error is.You are looking for the 23000 Error code (Integrity Constraint Violation). If you take a look at QueryException class, it extends from PDOException, so you can access to $errorInfo variable.To catch this error, you may try:To be more specific (Duplicate entry, not null, add/update child row, delete parent row...), it depends on each DBMS:For laravel, handling errors is easy, just add this code in your "app/start/global.php" file ( or create a service provider):first put this in your controller second handle the error by using try catch like this exampleNew updates here without need to use try catch you can easily do that in validation rules as the following code blew where id related to record which you edit.You may also trythen look for error code.This catches all exception including QueryExceptionYou can add the following code in app/start/global.php file in order to print the exceptioncheck this part in the  documentationIf you are using Laravel version 5 and want global exception handling of specific cases you should put your code in the report method of the /app/Exception/Handler.php file. Here is an example of how we do it in one of our micro services:The Response class we use is a simple wrapper of Symfony\Component\HttpFoundation\Response as HttpResponse which returns HTTP responses in a way that better suits us.Have a look at the documentation, it is straightforward.

Laravel 5 form request validation returning forbidden error

Emeka Mbah

[Laravel 5 form request validation returning forbidden error](https://stackoverflow.com/questions/30878105/laravel-5-form-request-validation-returning-forbidden-error)

I am trying to use Laravel 5.1's form request validation, to authorize if the request is from the owner. The validation is used when the user is trying to update part of the table clinics through the show.blade.php.My set up so far:routes.php:ClinicController.php:UpdateClinicAddressFormRequest.php:Show.blade.phpAny help why on submit it's saying 'forbidden' would be hugely appreciated.

2015-06-16 21:00:33Z

I am trying to use Laravel 5.1's form request validation, to authorize if the request is from the owner. The validation is used when the user is trying to update part of the table clinics through the show.blade.php.My set up so far:routes.php:ClinicController.php:UpdateClinicAddressFormRequest.php:Show.blade.phpAny help why on submit it's saying 'forbidden' would be hugely appreciated.You are getting Forbidden Error because authorize() method of form request is returning false:The issue is this: $clinicId = $this->route('postUpdateAddress'); To access a route parameter value in Form Requests you could do this:$clinicId = \Route::input('id'); //to get the value of {id} so authorize() should look like this:I add this owner confirmation to authorize() method in Request and work

Laravel 5 Auth Logout not destroying session

seoppc

[Laravel 5 Auth Logout not destroying session](https://stackoverflow.com/questions/29621965/laravel-5-auth-logout-not-destroying-session)

I am using Laravel5 Auth system for my new project, I am able to use registration and login functions with out any problem but logout is not working as expected, however I get redirected to url specified at $redirectAfterLogout but it does not destroy session so even after hitting logout button I am able to see dashboard. Does laravel has some bug in Auth system, please suggest, thanks

2015-04-14 07:55:44Z

I am using Laravel5 Auth system for my new project, I am able to use registration and login functions with out any problem but logout is not working as expected, however I get redirected to url specified at $redirectAfterLogout but it does not destroy session so even after hitting logout button I am able to see dashboard. Does laravel has some bug in Auth system, please suggest, thanksYou have not provided any piece of code that you have used. However, the following code works:The Session::flush();clears all the existing sessions.Using Laravel 5.2, I registered a listener, handled the logout event and called Session::flush as suggested above. Seemed to work pretty well. Hope this is helpful.EventServiceProvider.phpClearSessionAfterUserLogout.phpI had the same issue and I tried everything, but in the end I could fix it.My problem was that when I hit on the logout button, before that I had some http requests that weren't answered yet, so even when the user was log out, later with the response of the pending requests it got logged in again. Here is an example:So Removing those non-answered requests worked for me. I hope that this answer helps :)I switched to the database session driver and used the following code in my logout actionYou can simply override the logout method in AuthController.phpHere is code sample:trait AuthenticatesUsers change this to  thisThe function getLogout() is never reached, hence the logout() method never fires.In your case you are not probably reaching the logout() method. If you are using Laravel 5 builting auth mechanism then you will run AuthenticatesAndRegistersUsers trait getLogout() method which does $this->auth->logout();Find this code edit the method like below for debugging. If you see the string "Logging out" then you must be logged out. Ohterwise something is wrong with your routing and logout is just never executed.I've been fighting with this, and I've come to a solution.In short: The Laravel session reads and writes with middleware. It reads the stored session in at the start of the request, and writes any changes at the end of the request. If you make a redirect, then the current request never finishes, and the middleware write doesn't happen.So, how to fix this? Depending on your implementation... you should return the redirect command rather than calling it directly.I ran into a similar issue and it turned out using the 'file' driver for sessions somehow the server was creating files it could not modify later but there was no file permission warning. I switched to a redis implementation so I unfortunately can not say how to fix the file creation issue, but thought this might save someone some time.By accepting the request object in a controller action (Remember to add this after the controller namespace declaration: use Auth; ):For the newest versions.

How can I redirect with old input in Laravel?

cyber8200

[How can I redirect with old input in Laravel?](https://stackoverflow.com/questions/30002608/how-can-i-redirect-with-old-input-in-laravel)

I have a login modal. When the user log-in fail the authentication, I want to redirect back to this modal with : As you can see as part of my image, the error message seem to display, but the old input of username doesn't seem to populate.Can someone please correct me ? 

Did I forget to do anything ? 

What is the most efficient way in Laravel to accomplish something like this ? 

2015-05-02 13:02:18Z

I have a login modal. When the user log-in fail the authentication, I want to redirect back to this modal with : As you can see as part of my image, the error message seem to display, but the old input of username doesn't seem to populate.Can someone please correct me ? 

Did I forget to do anything ? 

What is the most efficient way in Laravel to accomplish something like this ? You can access the last inputs like so:$username = Request::old('username');As pointed at by @Arian Acosta you may simply do<input type="text" ... value="{{ old('username') }}" ... >.As described in the docs it is more convenient in a blade view.There are several possibilties in the controller:Instead of

  ->withInput(Request::except('password')) do:a) Input::flash(); or:b) Input::flashExcept('password');and redirect to the view with:a) ->withInput(Input::except('password'));resp. with:b) ->withInput();The docs about Old Input for further reading...You are missing the value on your input element...For my project, I needed another way:Shove a GET request in the validation return to fetch some previous data:

Laravel Blade Templating @foreach order

Ugo Guazelli

[Laravel Blade Templating @foreach order](https://stackoverflow.com/questions/34700499/laravel-blade-templating-foreach-order)

Is there any way to sort @foreach loop in laravel blade? I wolud like to order by $key->description, I know I can use order by in my controller,but the controller returns other values and those values must be sorted as well, so I need to order by in blade.

2016-01-10 00:12:54Z

Is there any way to sort @foreach loop in laravel blade? I wolud like to order by $key->description, I know I can use order by in my controller,but the controller returns other values and those values must be sorted as well, so I need to order by in blade.Assuming that your $specialist variable is an Eloquent collection, you can do:Moreover, you could call your Eloquent model directly from the template:Note that you are using a misleading variable name of $key in your foreach() loop. Your $key is actually an array item, not a key. I assume that you saw foreach ($array as $key => $value) syntax somewhere and then removed the $value?I would suggest using a laravel collection. More specifically, the sortBy(). You can use either of these in your view or the controller that you are passing the data from. If the data is being passed by a model, be sure to use the collect() function before proceeding to use any of the others listed.Hope this helps!

Laravel 5 - skip migrations

Erhnam

[Laravel 5 - skip migrations](https://stackoverflow.com/questions/35115541/laravel-5-skip-migrations)

I have migrated an existing Laravel 5 application and database. Only no migrations table was there yet, so I created this with the following command:Inside the database migration folders three files exist (2015_12_08_134409_create_tables_script.php, 2015_12_08_134410_create_foreign.php, 2015_12_08_134411_create_index.php) When using 'php artisan migrate' the scripts inside the migrations folder are executed again. This is what I want to avoid. Is it possible to insert records in Laravel's migrations table, so these scripts will be skipped and new scripts will be picked up once 'php artisan migrate' is executed again?

2016-01-31 15:26:56Z

I have migrated an existing Laravel 5 application and database. Only no migrations table was there yet, so I created this with the following command:Inside the database migration folders three files exist (2015_12_08_134409_create_tables_script.php, 2015_12_08_134410_create_foreign.php, 2015_12_08_134411_create_index.php) When using 'php artisan migrate' the scripts inside the migrations folder are executed again. This is what I want to avoid. Is it possible to insert records in Laravel's migrations table, so these scripts will be skipped and new scripts will be picked up once 'php artisan migrate' is executed again?Once you have the migration table created, insert these records:So artisan will understand those migrations as 'executed'Another way is just create a folder under database/migrations to put you want skip migrations, this method works for both files that have been migrated or not yet migrated.This Artisan CLI extension command is support single command to migrate specific files on Laravel 5.4 or later:

Laravel: orderBy a column with collections

Hamed Kamrava

[Laravel: orderBy a column with collections](https://stackoverflow.com/questions/42854788/laravel-orderby-a-column-with-collections)

I need to OrderBy a column with collection.I need to orderBy(updated_at, 'desc') all posts which owned by current logged user. Here is my code :Here is User model :It doesn't return any errors also doesn't sort !Any helps would be great appreciated.P.S:I know I can achieve this with :But I would like to do the same thing with collections.

2017-03-17 10:16:01Z

I need to OrderBy a column with collection.I need to orderBy(updated_at, 'desc') all posts which owned by current logged user. Here is my code :Here is User model :It doesn't return any errors also doesn't sort !Any helps would be great appreciated.P.S:I know I can achieve this with :But I would like to do the same thing with collections.So this is how you sort with SQL:And with collections:I've tested the 2nd one and it works as intended for me.Documentation: https://laravel.com/docs/6.x/collections#method-sortbydesc 

*Its available since Laravel 5.1Try adding the following to your User modelThen get the posts by calling posts_sortedByDesc instead of  posts@devk is right. What I wrote in the first post is correct.The problem was in DataTables in the the view.It needed to add this line to the Datatables options:So this is working fine :

Trait not found inside Laravel 5 unit tests

John Dorean

[Trait not found inside Laravel 5 unit tests](https://stackoverflow.com/questions/31253706/trait-not-found-inside-laravel-5-unit-tests)

I'm writing some unit tests to test the API endpoints in my Laravel 5 application, and a lot of endpoints require user authentication. Instead of having the same user account creation code in every test, I wanted to define a RegistersUsers trait to use on the test classes, which will have a registerUser() method.The directory structure of my tests directory is like so:I've namespaced TestCase.php and UserTest.php by adding this namespace declaration:and I've namespaced RegistersUsers.php like so:My UserTest looks like this, with the namespace and the use declaration so that I can leverage RegistersUsers.However, when I run the test, PHPUnit dies with the fatal error:As far as I can tell, my namespacing is correct and my trait should be found. I've been going around in circles with this and can't seem to figure it out.

2015-07-06 19:08:19Z

I'm writing some unit tests to test the API endpoints in my Laravel 5 application, and a lot of endpoints require user authentication. Instead of having the same user account creation code in every test, I wanted to define a RegistersUsers trait to use on the test classes, which will have a registerUser() method.The directory structure of my tests directory is like so:I've namespaced TestCase.php and UserTest.php by adding this namespace declaration:and I've namespaced RegistersUsers.php like so:My UserTest looks like this, with the namespace and the use declaration so that I can leverage RegistersUsers.However, when I run the test, PHPUnit dies with the fatal error:As far as I can tell, my namespacing is correct and my trait should be found. I've been going around in circles with this and can't seem to figure it out.I'm guessing having the trait in the traits folder, the trait is no longer accounted for in your autoloader.In order to correct this, you should open up composer.json, find the sectionfor autoload-dev and change it to something like the following...And that should add any traits you have in that folder to the autloader.EditSome additional ideas were brought up in the comments.  If you are going to be maintaining proper folder/namespace structure, it would be a good idea to use psr-4 autoloading rather than maintaining the class map.Also, rather than put logic in a trait to register a user for use with testing, when you extend TestCase, it brings in a helper method for logging in as a certain user.  You'd use it like so...

Laravel controller construct

Raggaer

[Laravel controller construct](https://stackoverflow.com/questions/17697575/laravel-controller-construct)

I started with laravel few days ago and I'm facing this issue:The NO is never returned!This is Controller, do you have any idea why?

2013-07-17 10:39:49Z

I started with laravel few days ago and I'm facing this issue:The NO is never returned!This is Controller, do you have any idea why?

Laravel Eloquent: Best Way to Calculate Total Price

Wendy Adi

[Laravel Eloquent: Best Way to Calculate Total Price](https://stackoverflow.com/questions/31421666/laravel-eloquent-best-way-to-calculate-total-price)

Im building a simple buy and sell application with Laravel 5.1. Each Buy Model has many BuyDetail which stores bought item quantity and buy_price. I have implement the relationship between table on the Model.I'd like to calculate the total price for each Buy. What is the best way to calculate the total price using Eloquent ORM?for now i just implement it like this:

2015-07-15 04:42:57Z

Im building a simple buy and sell application with Laravel 5.1. Each Buy Model has many BuyDetail which stores bought item quantity and buy_price. I have implement the relationship between table on the Model.I'd like to calculate the total price for each Buy. What is the best way to calculate the total price using Eloquent ORM?for now i just implement it like this:This can be done in (at least) 2 ways.Using pure Eloquent model logic:The only issue here is that it needs to fetch all buy details from the database but this is something you need to fetch anyway to display details in the view.If you wanted to avoid fetching the relation from the database you could build the query manually:I realise an answer’s already been accepted, but just thought I’d add my own detailing another approach.Personally, I like to put「aggregate」methods like these on custom collection classes. So if I have a Buy model that can have many BuyDetail models, then I would put a getTotal() method on my BuyDetailCollection method like this:I can then add this to the BuyDetail model:And use my getTotal() method where ever I need to now:

Laravel: String data, right truncated: 1406 Data too long for column

Sergej Fomin

[Laravel: String data, right truncated: 1406 Data too long for column](https://stackoverflow.com/questions/48477861/laravel-string-data-right-truncated-1406-data-too-long-for-column)

I have a table with a column 'hotel'. The project is created in Laravel 5.4, so I used Migrations. This is MYSQL VARCHAR (50). It was working good, because when I was developing I used short hotel names like "HILTON NEW YORK 5"*. Now the project is on production and customer asked why they can't input long hotel names. I've tested it with such a mock hotel name as "Long long long long long long long long long and very-very-very long hotel name 5 stars"It gave me an error:I've opened database in my Sequel Pro and changed itAfter each change I tested it with the same "Long long long long long long long long long and very-very-very long hotel name 5 starts" and get the same error (see above).I've checked the type of column with and it gave me so the type of the field is 'text' indeed  (65 535 characters). Maybe it's somehow connected with Laravel Migration file (see above) where I set VARCHAR (50) in the beginning? But I can't re-run migration on production, because the table has data now. Would appreciate any help.UPDATE:

I discovered that it actually saves that long hotel name in the DB. But user still gets this annoying mistake every time after submitting the form...

2018-01-27 16:26:36Z

I have a table with a column 'hotel'. The project is created in Laravel 5.4, so I used Migrations. This is MYSQL VARCHAR (50). It was working good, because when I was developing I used short hotel names like "HILTON NEW YORK 5"*. Now the project is on production and customer asked why they can't input long hotel names. I've tested it with such a mock hotel name as "Long long long long long long long long long and very-very-very long hotel name 5 stars"It gave me an error:I've opened database in my Sequel Pro and changed itAfter each change I tested it with the same "Long long long long long long long long long and very-very-very long hotel name 5 starts" and get the same error (see above).I've checked the type of column with and it gave me so the type of the field is 'text' indeed  (65 535 characters). Maybe it's somehow connected with Laravel Migration file (see above) where I set VARCHAR (50) in the beginning? But I can't re-run migration on production, because the table has data now. Would appreciate any help.UPDATE:

I discovered that it actually saves that long hotel name in the DB. But user still gets this annoying mistake every time after submitting the form...You need to create a new migration, register it with composer du command and run php artisan migrate command to change type of the column:On your local development, try changing the column type to:from your migration file. That solved it for me. But if you have gone live, then create a new migration just as Alexey has suggested and then use longText() column type.change the type of column fromstring to text. Then run a migrate refresh using php artisan migrate:refeshChange column's datatype from string to text and do not give length.Change column's datatype from string to text and do not give length.

dd($request->all()); gives back empty array

chloealee

[dd($request->all()); gives back empty array](https://stackoverflow.com/questions/30334216/ddrequest-all-gives-back-empty-array)

I am trying to upload a photo from my Laravel 5 app to be stored in AWS. I am using the Postman REST client to test. When I upload a photo, the request returns an empty array. Does anyone know why this might be? Here's the code for my Avatar Controller: 

2015-05-19 19:11:34Z

I am trying to upload a photo from my Laravel 5 app to be stored in AWS. I am using the Postman REST client to test. When I upload a photo, the request returns an empty array. Does anyone know why this might be? Here's the code for my Avatar Controller: Found the answer - looks like there was an issue with my headers in Postman. I had both Accept application/json and Content-Type application/json. Once I removed Content-Type, all is fixed. Thanks! Bit late to the party, but might be usefull for others:

My problem was that the Content-Type header value was application/json while the actual payload was form data. Changing the header to application/x-www-form-urlencoded fixed the issue.You might want to test that the JSON is validTry dd($request), dd($_REQUEST), dd($request->files).try use thisThe same issue on postman, while using PUT/PATCH method directly.

One possible solution is to send your PUT/PATCH request as a POST, but include proper _method in the request body along with other parameters.

_method: PUTHope this helpsShould be using:Request::all();As per documents: http://laravel.com/docs/5.0/requests

OctoberCMS How To Create Custom User Registration Form With Fields From Plugin Extension

user2694306

[OctoberCMS How To Create Custom User Registration Form With Fields From Plugin Extension](https://stackoverflow.com/questions/34681748/octobercms-how-to-create-custom-user-registration-form-with-fields-from-plugin-e)

I'm trying to learn OctoberCMS and I am confused about the complete process of extending plugins. I've extended the user plugin according to the screencast (https://vimeo.com/108040919). Ultimately, I'm looking to create a new field called "category" which wold store a users category. On a new page, I have the following form which I am trying to use to register a new user based solely on their e-mail address. The "category" is populated based on the page that they registered from and the password should be automatically generated so that the user will set it upon confirming their account from an e-mail activation link. My plugin is called "Profile".My plugin.php file looks like:My profile.php file looks like:I am trying to create a user registration form that looks like the following:What I am confused about is how to make an "onSignup" component that will basically extend the functionality of the user plugins "onRegister" component and then automatically generate a password and also save the "category" field. Can anyone provide an example or link to a page that shows an example of this? Thanks.

2016-01-08 16:31:20Z

I'm trying to learn OctoberCMS and I am confused about the complete process of extending plugins. I've extended the user plugin according to the screencast (https://vimeo.com/108040919). Ultimately, I'm looking to create a new field called "category" which wold store a users category. On a new page, I have the following form which I am trying to use to register a new user based solely on their e-mail address. The "category" is populated based on the page that they registered from and the password should be automatically generated so that the user will set it upon confirming their account from an e-mail activation link. My plugin is called "Profile".My plugin.php file looks like:My profile.php file looks like:I am trying to create a user registration form that looks like the following:What I am confused about is how to make an "onSignup" component that will basically extend the functionality of the user plugins "onRegister" component and then automatically generate a password and also save the "category" field. Can anyone provide an example or link to a page that shows an example of this? Thanks.Okay, I just had to do something like this for my own site.  So I'll try and explain the 2 options you have.

1: Override stuff using the theme and page php.2: Create a component to do it all.  This is the way I ended up goingIt's definitely confusing.    Take a look at the User Plus plugin as a guide and the locations plugin (required) to add country/state dropdown.    Far as making the password random, not 100% the best way but you can use onInit for your component to just seed one in the form post data.  the password field has to be added to the post data since the user's plugin passes the post fields to the model (which is why you must set category_id as fillable or it gets blocked for security reasons).  I am messing with this stuff myself and the users plus with the location plugin helped a lot. Sorry i couldn't be more detailed. 

Integration tests mocking facades vs injecting mocks

myol

[Integration tests mocking facades vs injecting mocks](https://stackoverflow.com/questions/39255103/integration-tests-mocking-facades-vs-injecting-mocks)

We have some legacy laravel projects which use facades in the classes. Our more recent projects use dependency injection of the underlying laravel classes that the facades represent as has been hinted at by Taylor Otwell himself. (We use constructor injection for each class, but to keep the example short, here I use method injection and use a single class.)I know facades can be mockedWhich works nicely for unit tests. The problem I am trying to understand is if these facades are mocked 'globally'.For example, lets imagine I am writing an integration test (testing a few interconnected classes while mocking services - not an end to end test using live services) which at some point, executes two separate classes which contain the same facade that calls the same method with the same parameters. In between these classes being called, is some complex functionality that changes what data is returned by that facades method using the same parameter.*Our modern classes are easy to test because the underlying class that the facade represents is injected into each class (in this example, each method). This means I can create two separate mocks and inject them into each class (method) to mock the different results.In the legacy systems though, it would seem that the mocked facade is 'global' so that when the facade is run in each class, the exact same value is returned.Am I correct in thinking this?*I understand this example may seem completely redundant from a code architecture and testing point of view, but I am stripping out all real functionality to try and give some sort of 'simple' example of what I am asking.

2016-08-31 16:53:50Z

We have some legacy laravel projects which use facades in the classes. Our more recent projects use dependency injection of the underlying laravel classes that the facades represent as has been hinted at by Taylor Otwell himself. (We use constructor injection for each class, but to keep the example short, here I use method injection and use a single class.)I know facades can be mockedWhich works nicely for unit tests. The problem I am trying to understand is if these facades are mocked 'globally'.For example, lets imagine I am writing an integration test (testing a few interconnected classes while mocking services - not an end to end test using live services) which at some point, executes two separate classes which contain the same facade that calls the same method with the same parameters. In between these classes being called, is some complex functionality that changes what data is returned by that facades method using the same parameter.*Our modern classes are easy to test because the underlying class that the facade represents is injected into each class (in this example, each method). This means I can create two separate mocks and inject them into each class (method) to mock the different results.In the legacy systems though, it would seem that the mocked facade is 'global' so that when the facade is run in each class, the exact same value is returned.Am I correct in thinking this?*I understand this example may seem completely redundant from a code architecture and testing point of view, but I am stripping out all real functionality to try and give some sort of 'simple' example of what I am asking.Dependency Injection vs FacadesOne of the major benefits of Dependency Injection is that code becomes a lot more testable once you start injecting dependencies into methods instead of instantiating/hardcoding them inside the method. This is because you can pass in the dependencies from inside unit tests and they will propagate through the code.See: http://slashnode.com/dependency-injection/Dependency Injection stands in stark contrast to Facades. Facades are static global classes, the PHP language does not allow one to overwrite or replace static functions on static classes. The Laravel facades use Mockery to provide mock functionality and they are limited by the same facts as above. The issue for integration testing can come where you are hoping to retrieve data from a non-mocked Cache but once you use Facade::shouldReceive() then Facade::get() will be overridden by the mocked Cache. The reverse is also true. As a result, Facades are inappropriate where you are interleaving calls for mocked and unmocked data.In order to test your code with the different data sets that you require, the best practice would be to refactor your legacy code to use DI. Integration TestsEasier methodAn alternative is to call multiple Facade::shouldReceive() with expectations at the beginning of your integration test. Ensuring that you have the right numbers of expectations in the right order for each of the calls you will make in the integration test. This would probably be the faster way to write tests given your existing codebase.Harder methodWhilst dependency injection is programming best practice. It could very well be that your codebase has so many legacy classes that it would take an unbelievable amount of time to refactor. In this case, it might be worthwhile considering end-to-end integration tests using a test database with fixtures.Appendix:

Laravel 5 file downloads: stream() or download()

Jones03

[Laravel 5 file downloads: stream() or download()](https://stackoverflow.com/questions/44965777/laravel-5-file-downloads-stream-or-download)

I have a Laravel 5.4 app where authenticated users need to be able to download private files from S3 storage. I've setup a route and controller to allow private file downloads. The code looks like this:Route:Controller:All working fine, but when I had a closer look to the Laravel docs, I found that they just talk about response()->download(). If I implement that kind of response, my code would look like this:Both functions can be found in the API docs.My question: what would be the preferred way to go and what are the advantages/disadvantages of each?From what I've gathered so far:Stream:Download:

2017-07-07 08:11:46Z

I have a Laravel 5.4 app where authenticated users need to be able to download private files from S3 storage. I've setup a route and controller to allow private file downloads. The code looks like this:Route:Controller:All working fine, but when I had a closer look to the Laravel docs, I found that they just talk about response()->download(). If I implement that kind of response, my code would look like this:Both functions can be found in the API docs.My question: what would be the preferred way to go and what are the advantages/disadvantages of each?From what I've gathered so far:Stream:Download:When you call Laravel the response() helper, it returns an instance of the Illuminate\Routing\ResponseFactory. The ResponseFactory has these two methods: download and stream - the two methods in question. If you dig a little bit deeper, you'll see that download returns an instance of \Symfony\Component\HttpFoundation\BinaryFileResponse, while stream returns a \Symfony\Component\HttpFoundation\StreamedResponse - these are both Symfony components.Digging through the code here isn't necessary, but it is nice to have an understanding of what's going on under the hood. Now that we know the underlying objects returned are from the Symfony HTTP Component, we can consult the Symfony docs and see what they recommend using. Typically, streams are used when the size of the file is unknown, such as when you are generating the file on the fly. In most other cases, the BinaryFileResponse generated by the download method will be sufficient for your needs. You can take a look at a much more in-depth explanation of HTTP Streaming and its use cases here.

laravel whereHas results weird

user259752

[laravel whereHas results weird](https://stackoverflow.com/questions/46492444/laravel-wherehas-results-weird)

product modelthe controllerthe raw SQL:above SQL return no results(when the product id = 3below SQL return the correct result(when the product id = 6)have no idea, the query look like no problemprevious project i got this issues too, at the end i use find and loop once more instead of using whereHas, but this time i encounter this problem again and try to find out why but few hours wasted, still no clue, below is a workaround(ignoring the bugs?)

2017-09-29 15:42:01Z

product modelthe controllerthe raw SQL:above SQL return no results(when the product id = 3below SQL return the correct result(when the product id = 6)have no idea, the query look like no problemprevious project i got this issues too, at the end i use find and loop once more instead of using whereHas, but this time i encounter this problem again and try to find out why but few hours wasted, still no clue, below is a workaround(ignoring the bugs?)i created the tables mentioned above (giving exactly same relations, table names, model names) and tried your code (by giving hard coded values) but got the perfect resultsandpls check if everything is fine with your database, check if every primary key and foreign keys are created as "integer". And check "collation" of db well as tables.This doesn't seem Laravel-related (since you still get no results when running the query directly with MyAdmin).Run the query again, commenting each where condition one by one (I added a true first condition to easily comment out all "and ..." lines) to see if you spot where the problem begins.(I did try creating both tables, and both queries return correct results, by the way.)try this hope it will help you,I think you should change your relationship concept in the product model from hasMany to belongsToMany.

Also update the parameters by defining the country model as first argument, intermediate table name as second argument then foreign key and primary key as 3rd and 4th arguments. belongsToMany('App\Models\Country', 'product_country','product_id', 'country_id')Product ModelBecause each country may belong to many products and each product may belong to many countries.First things first:If you're using eloquent (find method), you can do something like:and it returns a model of product where the id you've provided equals the primary key. Having that said, there is no need to use a whereHas() since it will have no effect. Instead of find(), you can try get() or first() for example, depending on what you're looking for.If you want to print out your query, you can end it with ->toSql(); and it will print the query as a string (helps a lot!).I didn't paid much attention to the objective but I'm sure if you use the You'll be able to compare what you're doing (since you know what the correct result or query should be like) and be able to figure it out. After all, we do need to exercise to explore our mind!I know this thread is a little bit stale, but my team actually had a very similar issue with Laravel and the whereHas (MySQL EXISTS) on MySQL 5.7.18. As soon as we upgraded MySQL, the same query started to return exactly as expected. I haven't yet figured out if this was a bug with 5.7.18, but I suspect it might be.

Export CSV or PDF Based On Datatables Laravel 4

hahahaha

[Export CSV or PDF Based On Datatables Laravel 4](https://stackoverflow.com/questions/32173798/export-csv-or-pdf-based-on-datatables-laravel-4)

I have a datatables which contains the data retrieved from database. When I enter some keywords into search textbox (the search textbox is generated by datatables), the result of the table will be changes. This is good. But when I click export to csv or pdf, the result in csv or pdf will be retrieved from database instead of datatables. How to export to csv/pdf based on the datatables plugin using laravel? //datatable plugins//php

2015-08-24 02:45:35Z

I have a datatables which contains the data retrieved from database. When I enter some keywords into search textbox (the search textbox is generated by datatables), the result of the table will be changes. This is good. But when I click export to csv or pdf, the result in csv or pdf will be retrieved from database instead of datatables. How to export to csv/pdf based on the datatables plugin using laravel? //datatable plugins//phpI would probably post the keyword to my server and run the sql query again filtering those results and then create the csv/pdfOne way you could do it is to use jQuery and make an ajax call.Firstly, give the table an ID. Next, get the table itself and get its HTML using this bit of code:Then make an ajax call to Laravel to generate the PDF passing through the HTML. You can use this HTML to PDF library: http://wkhtmltopdf.org/You should then get back the PDF with the exact table you had on screen (with any filters etc).As a sidenote, you can also add your CSS to the HTML to give to the PDF library and it will even style the table to be the same too!Hope this helps.

Conditional extends in Blade

Jordan Doyle

[Conditional extends in Blade](https://stackoverflow.com/questions/18524365/conditional-extends-in-blade)

Is there any way to do a conditional @extends statement in the Blade templating language?When the request was not AJAX it printed out @extends('dashboard.master'), but the AJAX request worked fine.Stop including the master template (which includes header and footer) for AJAX so it can easily display the requested content

2013-08-30 03:18:35Z

Is there any way to do a conditional @extends statement in the Blade templating language?When the request was not AJAX it printed out @extends('dashboard.master'), but the AJAX request worked fine.Stop including the master template (which includes header and footer) for AJAX so it can easily display the requested contentin the master layout:This kind of logic should really be kept out of the template.In your controller set the $layout property to be dashboard.master then instead of calling returning your view or response, terminate with just $this->layout->content = View::make('dashboard.template')Take a look at the Laravel docs on thisYou could end up with something like this

Laravel 5 Class 'Collective\Html\HtmlServiceProvider' not found on AWS

carbide20

[Laravel 5 Class 'Collective\Html\HtmlServiceProvider' not found on AWS](https://stackoverflow.com/questions/32795154/laravel-5-class-collective-html-htmlserviceprovider-not-found-on-aws)

I know there are a bunch of other questions floating around out there with the same error, such as: Class 'Illuminate\Html\HtmlServiceProvider' not found Laravel 5My problem is that I've followed all suggested steps to solve this on my local (XAMPP), and it fixed it without a hitch. The issue is when I went to deploy to my AWS ubuntu box (nginx). I followed all the usual instructions: http://laravelcollective.com/docs/5.1/html#installationMy providers and aliases had been added when I did a git pull from what I had pushed from my local. Perhaps this file should have been gitignored, and the change made manually on the server?I then manually added:And finally, I ran:It was running this command that throws the error:I then tried running php artisan clear-compiled, to see if that would do anything, and got:I know my nginx ubuntu environment is not the same as a windows xampp env, but I'm still unsure why following the Laravel-provided instructions for adding this don't seem to working. Would greatly appreciate some advice on this.Cheers!

2015-09-26 08:29:05Z

I know there are a bunch of other questions floating around out there with the same error, such as: Class 'Illuminate\Html\HtmlServiceProvider' not found Laravel 5My problem is that I've followed all suggested steps to solve this on my local (XAMPP), and it fixed it without a hitch. The issue is when I went to deploy to my AWS ubuntu box (nginx). I followed all the usual instructions: http://laravelcollective.com/docs/5.1/html#installationMy providers and aliases had been added when I did a git pull from what I had pushed from my local. Perhaps this file should have been gitignored, and the change made manually on the server?I then manually added:And finally, I ran:It was running this command that throws the error:I then tried running php artisan clear-compiled, to see if that would do anything, and got:I know my nginx ubuntu environment is not the same as a windows xampp env, but I'm still unsure why following the Laravel-provided instructions for adding this don't seem to working. Would greatly appreciate some advice on this.Cheers!When you update your composer it will check the providers. Because you haven't installed laravelcollective/html yet he can't find it and throws an error:So first require your packeges, then add them to the config file.You can also work with composer require laravelcollective/html, it will add it to the json file automatically. Then it doesn't matter if you have added them before or not because the config file won't be checked.I have encountered the same error on Laravel 5.2.*, followed instruction here: https://laravelcollective.com/docs/5.2/html, but did not work.The other way to fix it, on your CLI, run:$ composer dump-autoloadThen run:$ composer updateThis works for me. ;)If you're using Laravel 5.2, try adding this to your composer.jsonInstallation failed, reverting ./composer.json to its original content.[ErrorException]

  copy(/home/zahid/.composer/cache/files/laravelcollective/html/20e9e29d83e23aba16dc4b8d93d0757e1541f076.zip): failed to open stream: Permiss

  ion denied Command: composer require laravelcollective/html --prefer-sourcethen it workFirst try composer update . It will update all dependencies but in case it doesn’t work delete vendor folder of your project and type composer install  and run in cli which again add dependencies.

how to clean Laravel Bootstrap cache config file?

Abel D

[how to clean Laravel Bootstrap cache config file?](https://stackoverflow.com/questions/33823207/how-to-clean-laravel-bootstrap-cache-config-file)

I developed laravel app locally and uploaded in shared hosting. While hosting I changed the database name and username of mysql in the .env and the config/database files.But in remote its still using the old db name and user which is found in the bootstrap/cache/config file.So how to clean the bootstrap/cache/config.php file?

2015-11-20 09:30:42Z

I developed laravel app locally and uploaded in shared hosting. While hosting I changed the database name and username of mysql in the .env and the config/database files.But in remote its still using the old db name and user which is found in the bootstrap/cache/config file.So how to clean the bootstrap/cache/config.php file?Use php artisan cache:clear to flush the application's cache.If you are trying to clear configuration cache, which it sounds like you are. You need to run:php artisan config:clearAt some point, you probably ran php artisan config:cache which generated a cached version of your config file, and this file is not cleared with php artisan cache:clearI tried all the above options but nothing works.I manually removed from bootstrap/cache/config.php. And it works. This is the Ultimate solution.I just stumbled into this while building automated deployment in AWS. The problem with Laravel is that artisan commands also use the cache. Now if you deploy new version of your application you may have outdated entries in the cache which in turn will make the artisan command to crash i.e. cannot find some class that was cached but no longer exist. Therefore you either need to:1) Clear cache before you deploy the application2) Clear cache manuallyFinally you want to run optimize command which will re-build your configuration cache, bootstrap file cache and route caches.Or you can just manually delete bootstrap/config.php, which is what artisan does after all.See: vendor\laravel\framework\src\Illuminate\Foundation\Console\ConfigClearCommand.phpYou can use:Laravel 4 : php artisan cache:clearalso for laravel 5(not tested),Illuminate\Cache\FileStore has the function flushalso,Here is the Tip,if you still stuck in finding helpful commands, you can run php artisan list and it will list out every command with its description. look for a specific thing you want to perform. if you need migration-related command, you can look in migration.The solution for me was to remove the files in the bootstrap/cache/ directory and then delete the vendor folder. Re-run composer install and then composer dump-autoload and the above campaigns should run fine. Deleting the vendor folder and re-running composer install was the missing link for me

Just installed Lumen and got NotFoundHttpException

robertsan

[Just installed Lumen and got NotFoundHttpException](https://stackoverflow.com/questions/36436967/just-installed-lumen-and-got-notfoundhttpexception)

I'm searching for a solution ... it's getting so frustrating.

After a fresh installation of Lumen by Laravel, I simply can't access the "/" route. When I try to, it throws an error:

2016-04-05 21:00:32Z

I'm searching for a solution ... it's getting so frustrating.

After a fresh installation of Lumen by Laravel, I simply can't access the "/" route. When I try to, it throws an error:Got it! .... The solution is to change in public/index.php at line 28:toNo clue why, maybe you know.The problem was solved by changing thein /public/index.php toI had the same problem today.I was accessing it using the url

http://localhost/lumen.api/public/ and I think that was the cause of the error.To get around it, this is what I did:First I configured a new VirtualHost entry on Xampp, located in "C:\xampp\apache\conf\extra\httpd-vhosts.conf" in my case:and restarted Apache on Xampp.Then I edited my hosts file (c:\windows\system32\drivers\etc\hosts) to map a new address to my localhost.I tried again using the new URL http://lumen.api and the error was gone.Probably the .htaccess file was deleted or somehow missing from public folder. Without it the rewrite URL will not work.Check this: https://github.com/laravel/lumen/blob/master/public/.htaccess

Laravel 4 CSRF on all POST requests

Dexty

[Laravel 4 CSRF on all POST requests](https://stackoverflow.com/questions/17329952/laravel-4-csrf-on-all-post-requests)

Been looking into laravel lately, and trying to figure out the CSRF protection that they have. However, i can't get it work. Is there any way i can validate all post request submitted, with the CSRF filter? I've seen that the laravel system has:How would i be able to use this with the CSRF filter? Been trying a few different things likeBut i'm probably way off here.. how would this work? or is it even possible doing it this way?

2013-06-26 20:34:32Z

Been looking into laravel lately, and trying to figure out the CSRF protection that they have. However, i can't get it work. Is there any way i can validate all post request submitted, with the CSRF filter? I've seen that the laravel system has:How would i be able to use this with the CSRF filter? Been trying a few different things likeBut i'm probably way off here.. how would this work? or is it even possible doing it this way?You can use route groups. This will apply the specified options to any routes defined in a group:For certain routes, or if grouping isn't what you want, you can also use a pattern filter:NOTE: this code would go in your routes.php fileThis is the best and the simplest solution:No need to group routes or to mess with constructors.In my BaseController I have this:Having such App::before filter is an interesting approach but I don't know which is better?For some reason puttinginto BaseController.php didn't work for me; I did the test with fake tokens. So i came with the following solution:routes.php:filters.php (csrf filter section):That did the trick for me.This will allow you to apply CSRF to all forms across all pages of your appNote: 'post' is the HTTP POST verb - so it will cover Laravel post, put, delete requests etc.The code you provided only creates the filter. You still need to use it in either your ROUTER or CONTROLLER (even in the basecontroller if need be).In my opinion, using the filter in your ROUTES is the best place to use it.Simply add this to the BaseController.This add the CSRF filter to all post, put, patch and delete request.

Laravel Dusk, how to destroy session data between tests

Inigo

[Laravel Dusk, how to destroy session data between tests](https://stackoverflow.com/questions/44906797/laravel-dusk-how-to-destroy-session-data-between-tests)

I am getting started using Laravel Dusk for browser testing, and have created a couple of tests to test my login form. I have the following code:See the comment. The first function runs fine, but when it comes to the second function, I have to logout first, since the user is already logged in as a result of running the first function. This came as a surprise to me as I thought unit tests were completely independent, with session data being destroyed automatically.Is there a better way of doing this- some Dusk method that I'm missing perhaps- than having to call $browser->visit('/admin/logout'); ?ThanksEDIT Thanks for the 2 answers so far, which both seem valid solutions. I've updated the second function to the following:Which does the job. So

2017-07-04 13:01:36Z

I am getting started using Laravel Dusk for browser testing, and have created a couple of tests to test my login form. I have the following code:See the comment. The first function runs fine, but when it comes to the second function, I have to logout first, since the user is already logged in as a result of running the first function. This came as a surprise to me as I thought unit tests were completely independent, with session data being destroyed automatically.Is there a better way of doing this- some Dusk method that I'm missing perhaps- than having to call $browser->visit('/admin/logout'); ?ThanksEDIT Thanks for the 2 answers so far, which both seem valid solutions. I've updated the second function to the following:Which does the job. SoIn my case, tearDown() was not enough, for some reason, a logged users was still persisted between tests, so I placed deleteAllCookies() at setUp().So, in my DuskTestCase.php I added:It was the only way I could flush up session around all tests. I hope it helps.Note: I'm using Homestead and Windows 10.If you just want to logout your signed in user, after login test, simply use:You could flush the session in a tearDown() method:If in case it helps some one else. You can use tearDown method to clear all cookies. Following is the example of doing so, you can add this method in DuskTestCase.php fileI hope this will help.You can call InteractsWithAuthentication - GithubEdit:This is the behaviour of the Dusk Test case, the primary browser instance remains for the other tests.A second solution, create a second browser instance, which will be destroyed after the single testSee Dusk/TestCase #L103I'm not sure if its the answer you are looking for, but you can create multiple browsers to perform a test that requires clean history/cookies/cache.For example, if you have lots of tests where the user should be logged in and you don't want to log out for only one test that checks reset password form, then you can create an additional browser for this exact case and switch to the previous browser when moving to the next tests.It might look the next way:

Convert hour to PM and AM with Carbon

Sredny M Casanova

[Convert hour to PM and AM with Carbon](https://stackoverflow.com/questions/34228745/convert-hour-to-pm-and-am-with-carbon)

I have a timestamp in PHP, so I'm using Carbon extension to manage everything that is related with date, time,etc. Now I have for example a hour 23:00 or 20:00 with this extension how I can convert that to AM and PM format?

2015-12-11 17:01:33Z

I have a timestamp in PHP, so I'm using Carbon extension to manage everything that is related with date, time,etc. Now I have for example a hour 23:00 or 20:00 with this extension how I can convert that to AM and PM format?I'm not sure if there is a out-of-the-box helper method for this, but you could always use the format method, which defers to the base class method DateTime::format().Example:This will echo out something like 5:17 PM.The g, i, and A can seem random, but the list of parameters can be found here: http://php.net/manual/en/function.date.phpg: 12-hour format of an hour without leading zerosi: Minutes with leading zerosA: Uppercase Ante meridiem and Post meridiem

Can't catch Exception thrown by Carbon

Nathan

[Can't catch Exception thrown by Carbon](https://stackoverflow.com/questions/31248584/cant-catch-exception-thrown-by-carbon)

The following code throws an exception that I can't catch for whatever reason.Now, if I put this in my routes file in a function closure, it works fine. It's only throwing an exception when it's called from the Model.exception 'Exception' with message 'DateTime::__construct(): Failed to parse time string (Summer 2015) at position 0 (S): The timezone could not be found in the database' in /home/vagrant/www/steamcompare/vendor/nesbot/carbon/src/Carbon/Carbon.php:222Has anyone else had this issue with Carbon?

2015-07-06 14:33:04Z

The following code throws an exception that I can't catch for whatever reason.Now, if I put this in my routes file in a function closure, it works fine. It's only throwing an exception when it's called from the Model.exception 'Exception' with message 'DateTime::__construct(): Failed to parse time string (Summer 2015) at position 0 (S): The timezone could not be found in the database' in /home/vagrant/www/steamcompare/vendor/nesbot/carbon/src/Carbon/Carbon.php:222Has anyone else had this issue with Carbon?Immediately after posing the question, I thought of the answer. Since I saw a lot of posts online about a very similar issue, I figured I'd go ahead and answer this one.The issue was namespacing. Carbon was running in a different namespace from my app (obviously) so when I tried to catch (Exception) I was actually trying to catch an exception within my app's namespace. Changing the catch statement to catch (\Exception) resolved it.I hope this helps anyone that ends up on this page.

Function mcrypt_get_iv_size() is deprecated on Laravel 4

cyber8200

[Function mcrypt_get_iv_size() is deprecated on Laravel 4](https://stackoverflow.com/questions/42515368/function-mcrypt-get-iv-size-is-deprecated-on-laravel-4)

I am in L4, here is my app.php I kept gettig How can I prevent that ?

2017-02-28 17:40:07Z

I am in L4, here is my app.php I kept gettig How can I prevent that ?You can use PHP 7 instead of PHP 7.1. Or you can upgrade to Laravel 5 if it's possible. If not, add this to the beginning of the config/app.php:It looks dirty, but I'm afraid there is no a better way to avoid the error at the moment.

How to display Laravel artisan command output on same line?

eComEvo

[How to display Laravel artisan command output on same line?](https://stackoverflow.com/questions/25388430/how-to-display-laravel-artisan-command-output-on-same-line)

I would like to display processing progress using a simple series of dots. This is easy in the browser, just do echo '.' and it goes on the same line, but how do I do this on the same line when sending data to the artisan commandline?Each subsequent call to $this->info('.') puts the dot on a new line.

2014-08-19 16:25:15Z

I would like to display processing progress using a simple series of dots. This is easy in the browser, just do echo '.' and it goes on the same line, but how do I do this on the same line when sending data to the artisan commandline?Each subsequent call to $this->info('.') puts the dot on a new line.The method info uses writeln, it adds a newline at the end, you need to use write instead.Probably a little bit of topic, since you want a series of dots only. But you can easily present a progress bar in artisan commands using built in functionality in Laravel.Declare a class variable like this:And initialize the progress bar like this, lets say in fire() method:And then do something like this:And finilize the progress when done by calling this:Update: For Laravel 5.1+ The simpler syntax is even more convenient:If you look at the source, you will see that $this->info is actually just a shortcut for $this->output->writeln: Source.You could use $this->output->write('<info>.</info>') to make it inline.If you find yourself using this often you can make your own helper method like:

How to customize the email verification email from Laravel 5.7?

Wayne Fulcher

[How to customize the email verification email from Laravel 5.7?](https://stackoverflow.com/questions/52416804/how-to-customize-the-email-verification-email-from-laravel-5-7)

I just upgraded to Laravel 5.7 and now I am using the built in Email Verification. However there is 2 things I have not been able to figure out and the primary issue is how can I customize the email that is being sent to the user for verifying their email? I also can't figure out how to initiate sending that email if the users changes their email but I can save that for another thread.

2018-09-20 02:42:23Z

I just upgraded to Laravel 5.7 and now I am using the built in Email Verification. However there is 2 things I have not been able to figure out and the primary issue is how can I customize the email that is being sent to the user for verifying their email? I also can't figure out how to initiate sending that email if the users changes their email but I can save that for another thread.When you want to add Email Verification in Laravel 5.7 the suggested method is to implement Illuminate\Contracts\Auth\MustVerifyEmail and use the Illuminate\Auth\MustVerifyEmail trait on the App\User Model.To make some custom behaviour you can override the method sendEmailVerificationNotification which is the method that notifies the created user by calling the method notify, and passes as a parameter a new instance of the Notifications\MustVerifyEmail class.You can create a custom Notification which will be passed as a parameter to the $this->notify() within the sendEmailVerificationNotification method in your User Model:...then in your CustomVerifyEmail Notification you can define the way the verification will be handled. You can notify created user by sending an email with a custom verification.route which will take any parameters that you want.Email verification notification processWhen a new user signs-up an Illuminate\Auth\Events\Registered Event is emitted in the App\Http\Controllers\Auth\RegisterController and that Registered event has a listener called Illuminate\Auth\Listeners\SendEmailVerificationNotification which is registered in the App\Providers\EventServiceProvider:The SendEmailVerificationNotification listener checks if the $user – which is passed as a parameter to new Registered($user = $this->create($request->all())) in the Laravel default authentication App\Http\Controllers\Auth\RegisterController – is an instance of Illuminate\Contracts\Auth\MustVerifyEmail which is the name of the trait that Laravel suggests is used in the App\User Model when you want to provide default email verification and also check that $user is not already verified. If all that passes, the sendEmailVerificationNotification method is called on that user:I think the simple way to do this is to make a new notification using the docs here: https://laravel.com/docs/5.7/notifications#creating-notificationsThen override the function:In the users model.Or you can This will copy the templates to the resources/views/vendor/notifications directory and you can modify them thereUnfortunately this email that is sent out is not from a "view", it is a Notification that is built inline actually. This is where it is currently built when needing to be sent off: Illuminate\Auth\Notifications\VerifyEmail@toMail. This particular class has a static callback that can be set to build this email instead of letting it do it.In a Service Provider in the boot method you will need to assign a callback for this class:Something "like" this might work:As this is a notification you should have more options on customizing it.If you want to use your own Notification class you can override the sendEmailVerificationNotification method on the User (Authenticatable) model (this is from the MustVerifyEmail trait).Second Question:The VerificationController (App\Http\Controllers\Auth\VerificationController) that you should have has a method named resend (from the trait VerifiesEmails) that looks like a good candidate for this purpose.You should have routes setup for these verification routes via Auth::routes(['verify' => true]);Note:The verification system uses a field on the users table email_verified_at in 5.7 to mark this. You would want to make sure you have this field. When the user changes email address I suppose you could make this null then redirect them to the resend route, to send off the new verification. This will put them into an "unverified" state though until they reverify, if that is what you intend to happen.Update:Seems we were going down the right track. I found this SO answer that goes over similar things:Changing the default「subject」field for the verification email in laravel 5.7For quick and easy way: It's creating a new file in: This is Laravel's email themplate. You can change and customize it.Building slightly on the answer by Andrew Earls, you can also publish all the markdown mail components used by the application with this command: php artisan vendor:publish --tag=laravel-mailOnce that's done you'll have a series of html and markdown files to modify in resources/views/vendor/mail. This will allow you to modify the overall email layout and also 'theme' the CSS. I'd highly recommend having a good read of the Mail docs - Customizing The Components.As a general email theming quick-start (Laravel 5.7), you can: Hope that helps someone. To send verification email you can just use the next code: Navigate to these filesand then customize it.

you can even introduce a constructor in 

vendor/laravel/framework/src/Illuminate/Auth/Notifications/VerifyEmail.php 

and pass value through vendor/laravel/framework/src/Illuminate/Auth/MustVerifyEmail.phpeg:

Laravel : Calling functions defined in base_controller from view

Jim

[Laravel : Calling functions defined in base_controller from view](https://stackoverflow.com/questions/13481136/laravel-calling-functions-defined-in-base-controller-from-view)

In using the laravel framework, how can I call a function defined in base_controller, in a view.  For exacmple:How can i call format_something() in a view file?Usually the error I get looks something like this:

    Method [link_to_action] is not defined on the View class.Probably a silly question, but thanks in advance!EditOkay! First the correct place to do something like this is in the libraries folder.

Second, problem is that your class cannot have underscores.So in application/libraries I made file AppHelper.php with classAnd can call it like:Thanks for the help and the good forum find Boofus McGoofus.

2012-11-20 20:01:15Z

In using the laravel framework, how can I call a function defined in base_controller, in a view.  For exacmple:How can i call format_something() in a view file?Usually the error I get looks something like this:

    Method [link_to_action] is not defined on the View class.Probably a silly question, but thanks in advance!EditOkay! First the correct place to do something like this is in the libraries folder.

Second, problem is that your class cannot have underscores.So in application/libraries I made file AppHelper.php with classAnd can call it like:Thanks for the help and the good forum find Boofus McGoofus.This answer was written for Laravel 3. For Laravel 4 and after, Lajdák Marek's answer using Composer's autoloader is better.Functions like format_something() don't belong in the controller.  The controller should just be about collecting data from various sources and passing it to the view. It's job is mostly just routing.I've created a folder called "helpers" in the application folder for all my little helpery functions.  To make sure all my controllers, views, and models have access to them, I've included the following in my start.php file:I suspect that there's a better way to do that, but so far it has worked for me.For me is working:Create directory "helpers" or whatever and file:Add path to composer.jsonRun: (reload the autoload)Now you can call: You can inspire yourself from Laravel framework itself.I will take your example of a formatter and refer to url helper in Laravel Framework.Start by creating your own helpers.php file:And add it to your composer.json file:Run this command to recreate the autoload php file:Create your service provider app/Providers/FormatterServiceProvider.php:Register your service provider. Laravel framework invokes register method but you only need to add it to your app config file config/app.php:Finally, create your actual generator class app/Helpers/FormatGenerator.phpYou can optionally create a Facade app/Facade/Formatter.php, to be able to do Formatter::format_that($text):You could ask yourself:

Laravel 4 - Route::resource vs Route::controller. Which to use?

Gravy

[Laravel 4 - Route::resource vs Route::controller. Which to use?](https://stackoverflow.com/questions/19102534/laravel-4-routeresource-vs-routecontroller-which-to-use)

I understand that a Resource controller can have the following methodsNow suppose I have the following actions which need to be performed in addition to the resource actions:Are resource controllers useless for the above functionality? If programming an API, I obviously want the index, show, edit,create,destroy... but also the login, find, search etc...Is it possible to route to both types of controller? e.g.Or should I just forget about the resource controller and use a restful controller instead?

2013-09-30 19:48:13Z

I understand that a Resource controller can have the following methodsNow suppose I have the following actions which need to be performed in addition to the resource actions:Are resource controllers useless for the above functionality? If programming an API, I obviously want the index, show, edit,create,destroy... but also the login, find, search etc...Is it possible to route to both types of controller? e.g.Or should I just forget about the resource controller and use a restful controller instead?Just use a resource controller, add those other methods to that same controller, and add routes to those methods directly:P.S. I generally shy away from using Route::controller(). It's too ambiguous.one of the problems associated with resource controllers are when you are using named routes, with group prefixes it all turns out into a big mess . if you want to make a small change in your prefix, you have to make changes throughout the views and controllers . ie you can't make full power of named routes.i follow this model when developing my laravel apps .  so that i have the following advantages .and i can generate urls comfortably using the syntax,even if i make a change in prefix or resource names urls are not affected 

Detect changes when saving Laravel 4: Eloquent

Karl

[Detect changes when saving Laravel 4: Eloquent](https://stackoverflow.com/questions/20179711/detect-changes-when-saving-laravel-4-eloquent)

I'm using the Laravel 4 framework and I am trying to work out a way to display notifications depending on whether a save() was successful or not. Here's what I have so far:My problem is that it always returns true when a user is saved, even if no changes have been made to the database (I know this from the updated_at timestamp). Is there a way to detect whether any changes have actually been made or not using Laravel?

2013-11-24 19:15:58Z

I'm using the Laravel 4 framework and I am trying to work out a way to display notifications depending on whether a save() was successful or not. Here's what I have so far:My problem is that it always returns true when a user is saved, even if no changes have been made to the database (I know this from the updated_at timestamp). Is there a way to detect whether any changes have actually been made or not using Laravel?Depending on what you want to achieve, you have some options here. Check out the below first.Model Hooks with Ardent package 

If you are interested in autovalidating models, take a look at the https://github.com/laravelbook/ardent package - Self-validating smart models for Laravel Framework 4's Eloquent O/RM. Apart form great validation features it offers additional model hooks you can use: Laravel Model Events 

If you dont want to use any additional stuff, you can just use the Laravel Model Events (that in fact Ardent is wrapping in the hooks). Look into the docs http://laravel.com/docs/eloquent#model-events Solution

Finally, reffering to you question you can utilize the above approaches in numerous ways but most obviously you can combine it (or not) with the Eloquent Models' getDirty() api docs here method. It will work for example with the saving event. You can take a look at the getDirty() method in the Eloquent model (model.php). 

This method should return the changed attributes.

Laravel hasManyThrough

Greg

[Laravel hasManyThrough](https://stackoverflow.com/questions/24994640/laravel-hasmanythrough)

I'm struggling to get my head around a hasManyThrough concept with laravel.

I have three tables:What I am trying to get is an Eloquent model that allows me to have a single booking record with multiple Meta records of type MetaType. I thought that hasManyThrough might have solved this, but now I am thinking that perhaps this is not the best way.In my booking model I haveBut this fails to generate the correct SQL and fails. I getWhereas what I am really trying to achieve isIf anyone can point me in the right direction I'd really appreciate it. Thanks.

2014-07-28 11:51:44Z

I'm struggling to get my head around a hasManyThrough concept with laravel.

I have three tables:What I am trying to get is an Eloquent model that allows me to have a single booking record with multiple Meta records of type MetaType. I thought that hasManyThrough might have solved this, but now I am thinking that perhaps this is not the best way.In my booking model I haveBut this fails to generate the correct SQL and fails. I getWhereas what I am really trying to achieve isIf anyone can point me in the right direction I'd really appreciate it. Thanks.hasManyThrough is not the way at all. It works only for relations like this:What you have here is a many to many (belongsToMany), with meta being the pivot table.So you can do this (assuming meta is table name, Booking and MetaType are models):Then you can access all associated MetaType:query it like this (eager loading):or set constraints on the related table to filter the Booking:Note: wherePivot works only when you eager load the relationship, so you can't use it in whereHas closure.

What does isDirty() mean in Laravel?

shay.k

[What does isDirty() mean in Laravel?](https://stackoverflow.com/questions/28836013/what-does-isdirty-mean-in-laravel)

First of all, I am not familiar with Laravel so much (or with the term "dirty" for that matter).

I stumbled upon this line of code - And I couldn't understand what that means exactly. I tried to find out on the internet but the Laravel site only says thiswhich doesn't really help...

2015-03-03 15:49:48Z

First of all, I am not familiar with Laravel so much (or with the term "dirty" for that matter).

I stumbled upon this line of code - And I couldn't understand what that means exactly. I tried to find out on the internet but the Laravel site only says thiswhich doesn't really help...When you want to know if the model has been edited since it was queried from the database, or isn't saved at all, then you use the ->isDirty() function.As support for the accepted answer:

Chain commands in Laravel Artisan Scheduler?

wkm

[Chain commands in Laravel Artisan Scheduler?](https://stackoverflow.com/questions/29825483/chain-commands-in-laravel-artisan-scheduler)

Suppose I have three commands I want to schedule:

'commandA', 'commandB', and 'commandC'But I don't want to run 'commandB' until 'commandA' is complete and I don't want to run 'commandC' until 'commandB' is complete.I know I can schedule each to run every five minutes:But is it possible to chain them one after the other?

2015-04-23 13:48:59Z

Suppose I have three commands I want to schedule:

'commandA', 'commandB', and 'commandC'But I don't want to run 'commandB' until 'commandA' is complete and I don't want to run 'commandC' until 'commandB' is complete.I know I can schedule each to run every five minutes:But is it possible to chain them one after the other?Use then(Closure $callback) to chain commands:

Class 'App\Http\Controllers\Excel' not found in Laravel

Lulzim

[Class 'App\Http\Controllers\Excel' not found in Laravel](https://stackoverflow.com/questions/30155145/class-app-http-controllers-excel-not-found-in-laravel)

In my controller I have the code as below:In config/app.php in aliases array i have defined this:I dont know why i cant make it work this library...

Any idea?

2015-05-10 18:31:42Z

In my controller I have the code as below:In config/app.php in aliases array i have defined this:I dont know why i cant make it work this library...

Any idea?Instead of Excel::create you should use \Excel::create or add at the beginning of your file after current namespace use Excel; and then you will be able to use Excel::createAnd the second error is that you used:and you should use:instead according to the docs.Sometimes, clearing configuration cache makes it workphp artisan config:cacheThis should work after all you have followed all the instruction correctly but still getting "Class 'App\Http\Controllers\Excel' not found in Laravel" errorAfter all this you need to check whether or not you have this at the top:

use DELETE method in route with Laravel 5.4

Needlle

[use DELETE method in route with Laravel 5.4](https://stackoverflow.com/questions/44113969/use-delete-method-in-route-with-laravel-5-4)

I'm working on a Laravel (v 5.4) project and i did the CRUD to manage categories. Currently, i can create a new category and i would be able to delete.I created the view (with blade) to delete the categories :And in the routing file web.php, i wrote :I have a controller CategoryController with a method destroy() who delete category and redirect to list of categories. But when i click on the button to delete, i get an error that explain this route is not define. If i replace Route::delete with Route::get it works. I think the url is called with GET but i would keep that for an other action.I tried to replace the link with a form and "DELETE" as the value of "method" attribute but it didn't work.How can i call url with DELETE method to catch it with Route::delete ?Thanks in advance.

2017-05-22 13:18:53Z

I'm working on a Laravel (v 5.4) project and i did the CRUD to manage categories. Currently, i can create a new category and i would be able to delete.I created the view (with blade) to delete the categories :And in the routing file web.php, i wrote :I have a controller CategoryController with a method destroy() who delete category and redirect to list of categories. But when i click on the button to delete, i get an error that explain this route is not define. If i replace Route::delete with Route::get it works. I think the url is called with GET but i would keep that for an other action.I tried to replace the link with a form and "DELETE" as the value of "method" attribute but it didn't work.How can i call url with DELETE method to catch it with Route::delete ?Thanks in advance.If you click on an url it will always be a GET method.Since you wish to define it as DELETE, you should remake it into a post form and addin it. Like replace:with:Same goes for PUT request.Since Laravel 5.1 method_field:Since Laravel 5.6 just with @ tag:Any method other than GET and POST  requires you to specify the method type using a hidden form input. That's how laravel detects them. In your case you need to send the delete action using a form. Do this.For laravel 5.7 please look my example:

Composite keys laravel schema builder

Can Geliş

[Composite keys laravel schema builder](https://stackoverflow.com/questions/17065112/composite-keys-laravel-schema-builder)

I need two composite primary keys and only one should be AUTO INCREMENT what I tried so far:None works. Error message:[Exception]

  SQLSTATE[42000]: Syntax error or access violation: 1068 Multiple primary ke

  y defined (SQL: alter tablekitchenadd primary key kitchen_restaurant_id

  _primary(restaurant_id)) (Bindings: array (

  ))       The solution without Schema builder: first, I need to add two composite primary keys and then I need to make one of the AUTO INCREMENT but I think Schema builder can't do this.Note: I can do this with SQL, I mean no problem with MySQLAny suggestions?   Summary:What I need is;http://oi39.tinypic.com/es91ft.jpgwith Schema builder

2013-06-12 12:08:32Z

I need two composite primary keys and only one should be AUTO INCREMENT what I tried so far:None works. Error message:[Exception]

  SQLSTATE[42000]: Syntax error or access violation: 1068 Multiple primary ke

  y defined (SQL: alter tablekitchenadd primary key kitchen_restaurant_id

  _primary(restaurant_id)) (Bindings: array (

  ))       The solution without Schema builder: first, I need to add two composite primary keys and then I need to make one of the AUTO INCREMENT but I think Schema builder can't do this.Note: I can do this with SQL, I mean no problem with MySQLAny suggestions?   Summary:What I need is;http://oi39.tinypic.com/es91ft.jpgwith Schema builderYou can do this with a little help from the unprepared method:This is tested, and works!I know it's a little late, and you might have moved on, but someone else might come across this :)Eloquent's increments() sets the column as an unsigned integer.  With that in mind you have multiple way of achieving your desired composite keys.You could use either interger() or unsignedInteger() and setting the autoIncrements to true:Then you could tell Eloquent which are your primary keys via primary().Your Schema::create() should look like this:Assuming your Restaurant table is using $table->increments('id') this should make 'id' and 'restaurant_id' your primary keys while also matching 'restaurant_id' to the Restaurant table 'id'.It makes no sense to have the autoincrement as part of a composite primary key as it will be unique for every record anyway.

If you want an autoincrement primary key and a unique composite key on eg 2 other columns such as 'restaurant_id' and 'name':It seems you've hit something that is not currently possible with Laravel, since ->increments() already sets ->primary() , so when you add it yourself you end up with two PRIMARY clauses in the resulting SQL.But you may want to try creating the table with the wrong primary key, dropping it, then recreating it:Another option from Dayle Rees

How can I get the return value of a Laravel chunk?

Citizen

[How can I get the return value of a Laravel chunk?](https://stackoverflow.com/questions/26026795/how-can-i-get-the-return-value-of-a-laravel-chunk)

Here's an over-simplified example that doesn't work for me. How (using this method, I know there are better ways if I were actually wanting this specific result), can I get the total number of users?This returns NULL. Any idea how I can get a return value from the chunk function?Edit:Here might be a better example:

2014-09-24 21:25:49Z

Here's an over-simplified example that doesn't work for me. How (using this method, I know there are better ways if I were actually wanting this specific result), can I get the total number of users?This returns NULL. Any idea how I can get a return value from the chunk function?Edit:Here might be a better example:I don't think you can achieve what you want in this way. The anonymous function is invoked by the chunk method, so anything you return from your closure is being swallowed by chunk. Since chunk potentially invokes this anonymous function N times, it makes no sense for it to return anything back from the closures it invokes.However you can provide access to a method-scoped variable to the closure, and allow the closure to write to that value, which will let you indirectly return results. You do this with the use keyword, and make sure to pass the method-scoped variable in by reference, which is achieved with the & modifier.This will work for example;

Overwrite laravel 5 helper function

guidsen

[Overwrite laravel 5 helper function](https://stackoverflow.com/questions/28474640/overwrite-laravel-5-helper-function)

I'm using the response() helper very often and I just return the data with a message to the user. Now I have to include the http status code as well, but I don't want to change every response (which is likely bad anyway).So I'm trying to overwrite the response() helper function by creating my own helpers.php within app/Http/helpers.php. When I add it to my composer files, it does autoload the current helpers.php from the framework first and when I add it before the autload include in bootstrap/global.php I wont be able to use the app() and other Laravel functions.How would I be able to solve this issue? I just want to include the status code as well in the response array.

2015-02-12 10:10:01Z

I'm using the response() helper very often and I just return the data with a message to the user. Now I have to include the http status code as well, but I don't want to change every response (which is likely bad anyway).So I'm trying to overwrite the response() helper function by creating my own helpers.php within app/Http/helpers.php. When I add it to my composer files, it does autoload the current helpers.php from the framework first and when I add it before the autload include in bootstrap/global.php I wont be able to use the app() and other Laravel functions.How would I be able to solve this issue? I just want to include the status code as well in the response array.All Laravel helper functions written with this logicfor first Laravel check is this function exists, if it exists, Laravel will not define this function again(otherwise it will throw fatal error).

So if you will define your function before autoloader include  vendor/laravel/framework/src/Illuminate/Foundation/helpers.php file, 

you can define your custom response function.Unfortunately there is no way to say composer load first your autoload.files section, then laravel autoload.files. But you can do small hack ...open bootstrap/autoload.php file and include your file before autoloaderI've just had to do this in order to override the now() helper so I can control the apparent time when running tests. I followed the regular advice of creating app/Http/helpers.php and then adding it to bootstrap/autoload.php like so:This usually works because as Marty says, all helpers are only defined if there's not an existing function with that name. So the two lines above load your custom helpers, then perform all vendor autoloading, which includes Laravel's helpers, and your already-defined function takes precedence.But unfortunately, autoload.php doesn't seem to be used when testing with Behat, which is what I'm using. So I needed an alternative solution. Long story short, the only easy way to ensure that files get autoloaded before vendor files is by using the https://github.com/funkjedi/composer-include-files package. To quote from its readme:So I installed this package using composer require funkjedi/composer-include-files and then added this to composer.json:Once that's done, run composer dump-autoload to regenerate the autoload files. Now the overrides work both during regular app operation, and when running tests!I'm not going to directly answer your question since I don't know if there's a solution (without changing Laravels helpers.php or renaming your function)However there is a solution from the framework for this common use case. Response MacrosYou can define a macro (this is done in a service provider)And you can use it like this:

Dynamic Routing in Laravel 5 Application

Becky

[Dynamic Routing in Laravel 5 Application](https://stackoverflow.com/questions/33003097/dynamic-routing-in-laravel-5-application)

I am hoping that someone can help me out with dynamic routing for urls that can have multiple segments. I've been doing some searching all over the web, but nothing I find helps me out with my specific situation.A little background ... several years ago, I developed a CMS package for custom client websites that was built on CodeIgniter. This CMS package has several modules (Pages, Blog, Calendar, Inquiries, etc). For the Pages module, I was caching the routes to a "custom routes" config file that associated the full route for the page (including parent, grandparent, etc) with the ID of the page. I did this so that I didn't have to do a database lookup to find the page to display.I am currently working on rebuilding this CMS package using Laravel (5.1) [while I'm learning Laravel]. I need to figure out the routing situation before I can move on with my Pages module in the new version of the package.I know that I can do something like ...And this would work if I didn't allow nested pages, but I do. And I only enforce uniqueness of the slug based on the parent. So there could be more than one page with a slug of fargo ... As with the package that I built using CodeIgniter, I would like to be able to avoid extra database lookups to find the correct page to display.My initial thought was to create a config file that would have the dynamic routes like I did with the old version of the system. The routes will only change at specific times (when page is created, when slug is modified, when parent is changed), so "caching" them would work great. But I'm still new to Laravel, so I'm not sure what the best way to go about this would be. I did manage to figure out that the following routes work. But is this the best way to set this up?Basically, I would like to bind a specific route to a specific page ID when the page is created (or when the slug or parent are changed).Am I just overcomplicating things?Any help or direction regarding this would be greatly appreciated.Thanks!

2015-10-07 21:57:48Z

I am hoping that someone can help me out with dynamic routing for urls that can have multiple segments. I've been doing some searching all over the web, but nothing I find helps me out with my specific situation.A little background ... several years ago, I developed a CMS package for custom client websites that was built on CodeIgniter. This CMS package has several modules (Pages, Blog, Calendar, Inquiries, etc). For the Pages module, I was caching the routes to a "custom routes" config file that associated the full route for the page (including parent, grandparent, etc) with the ID of the page. I did this so that I didn't have to do a database lookup to find the page to display.I am currently working on rebuilding this CMS package using Laravel (5.1) [while I'm learning Laravel]. I need to figure out the routing situation before I can move on with my Pages module in the new version of the package.I know that I can do something like ...And this would work if I didn't allow nested pages, but I do. And I only enforce uniqueness of the slug based on the parent. So there could be more than one page with a slug of fargo ... As with the package that I built using CodeIgniter, I would like to be able to avoid extra database lookups to find the correct page to display.My initial thought was to create a config file that would have the dynamic routes like I did with the old version of the system. The routes will only change at specific times (when page is created, when slug is modified, when parent is changed), so "caching" them would work great. But I'm still new to Laravel, so I'm not sure what the best way to go about this would be. I did manage to figure out that the following routes work. But is this the best way to set this up?Basically, I would like to bind a specific route to a specific page ID when the page is created (or when the slug or parent are changed).Am I just overcomplicating things?Any help or direction regarding this would be greatly appreciated.Thanks!The way I handle this is to use two routes, one for the home page (which generally contains more complex logic like news, pick up articles, banners, etc), and a catch all for any other page.The important part to note in the above is the ->where() method chained on the end of the route. This allows you to declare regex pattern matching for the route parameters. In this case I am allowing alphanumeric characters, hyphens and forward slashes for the {slug} parameter.This will match slugs like

test-page

test-page/sub-page

another-page/sub-page   I keep the template file information in the database, as I allow users to create templates in the content management system.The response from the query on the database is then passed to the view where it can be output to the metadata, page, breadcrumbs, etc.I was also looking for the same answer that is about creating a dynamic routing in laravel i come up with this:

In routes.phpExif you have PostController with method hello in laravel. You can use this url http://localhost/shortproject/public/post/hello. Where shortproject is your project folder name.

Laravel 5 console (artisan) command unit tests

bernie

[Laravel 5 console (artisan) command unit tests](https://stackoverflow.com/questions/34814954/laravel-5-console-artisan-command-unit-tests)

I am migrating my Laravel 4.2 app to 5.1 (starting with 5.0) and am a lot of trouble with my console command unit tests. I have artisan commands for which I need to test the produced console output, proper question/response handling and interactions with other services (using mocks). For all its merits, the Laravel doc is unfortunately silent with regards to testing console commands.I finally found a way to create those tests, but it feels like a hack with those setLaravel and setApplication calls.Is there a better way to do this? I wish I could add my mock instances to the Laravel IoC container and let it create the commands to test with everything properly set. I'm afraid my unit tests will break easily with newer Laravel versions.Here's my unit test:Use statements:SetupInput provided as command arguments. Checks console outputInput provided by simulated keyboard keys

2016-01-15 15:54:25Z

I am migrating my Laravel 4.2 app to 5.1 (starting with 5.0) and am a lot of trouble with my console command unit tests. I have artisan commands for which I need to test the produced console output, proper question/response handling and interactions with other services (using mocks). For all its merits, the Laravel doc is unfortunately silent with regards to testing console commands.I finally found a way to create those tests, but it feels like a hack with those setLaravel and setApplication calls.Is there a better way to do this? I wish I could add my mock instances to the Laravel IoC container and let it create the commands to test with everything properly set. I'm afraid my unit tests will break easily with newer Laravel versions.Here's my unit test:Use statements:SetupInput provided as command arguments. Checks console outputInput provided by simulated keyboard keysI have done this before as follows - my console command returns a json response:So if you want to put this in it's own command tester class, or as a function within TestCase etc... up to you.

Dynamic partial arguments in AngularJS routing

Ali

[Dynamic partial arguments in AngularJS routing](https://stackoverflow.com/questions/39727540/dynamic-partial-arguments-in-angularjs-routing)

I'm working with an angularjs site and have a background with working with routes in Rails and also Laravel in php. With routes in Laravel we could dynamically create a set of routes similar to:Here we defined series of seperate routes in Laravel which technically do look the same except for the value of city and slug.I'm finding angularJS a bit limited in defining routes in this case. Frankly am a bit lost here.I've made some modifications here - basically I set up a service which retrieves assets from my database such as in this case a list of cities and categories. I'm trying to do this:If {slug} is in the array of categories retrieved from my API, then use my ListController and list view but if its not then instead use my SingleVenueController and single view. Here's my code at the moment but its not working :(In the above sharedParams is a service and the getCurrentPageType just checks the url slug to decide what controller to send back - but its not really working at all :(

2016-09-27 14:36:40Z

I'm working with an angularjs site and have a background with working with routes in Rails and also Laravel in php. With routes in Laravel we could dynamically create a set of routes similar to:Here we defined series of seperate routes in Laravel which technically do look the same except for the value of city and slug.I'm finding angularJS a bit limited in defining routes in this case. Frankly am a bit lost here.I've made some modifications here - basically I set up a service which retrieves assets from my database such as in this case a list of cities and categories. I'm trying to do this:If {slug} is in the array of categories retrieved from my API, then use my ListController and list view but if its not then instead use my SingleVenueController and single view. Here's my code at the moment but its not working :(In the above sharedParams is a service and the getCurrentPageType just checks the url slug to decide what controller to send back - but its not really working at all :(How about defining a single route with a paramater ?

In angularjs v1.x you can defined as many routes you want with as many params xor queryref: https://docs.angularjs.org/api/ngRoute/service/$routeYou can do it with separate routes. The idea is when user hits the main route it resolves first with the data from the backend. If the condition is met, resolve function will redirect to specific route if not it wont passServices in Angular cannot be injected in the configuration phase since they become available only in the run phase of an Angular application.There is however a trick to load $http service in the config phase which you can use to load your cities/categories and set up your routes. Meanwhile, since controllers aren't registered up until the run phase, you may use the $controllerProvider to register your controllers beforehand in the configuration phase:You can now call your API to get the cities (or whatever else) and iterate while registering each route:Note that I'm using the getTemplate and the getController methods which return the templateUrl and the relevant controller name strings respectively using an ordinary switch expression. You can choose your own approach.Note:While a function with the templateUrl route options property does work with setting up a custom template, but when you use a function alongside the controller property, Angular will consider it as the constructor for the controller. Therefore, returning the name of the controller in that function won't work.As Ahmad has already pointed out in his answer, if you pass a function to controller it is considered as a constructor for the controller. 

Also you can't get a service injected dynamically in config block of your app.So what you can do is, move your sharedData service in separate app (in my code below I've used appShared as a separate app where this service is defined) and then access it using angular.injector. This way you don't have to define it as a parameter to templateUrl / controller functions.Btw, you can't pass custom parameters to templateUrl function (ref: https://docs.angularjs.org/api/ngRoute/provider/$routeProvider)Now for the controller, use $controller to dynamically load either ListsController or SingleController based on your condition.

Once that is loaded, extend your current controller (defined by your controller function) using angular.extend so that it inherits all the properties and methods of the dynamically loaded controller.Check the complete code here: http://plnkr.co/edit/ORB4iXwmxgGGJW6wQDy9

Optional parameter in the middle of a route

rap-2-h

[Optional parameter in the middle of a route](https://stackoverflow.com/questions/31584302/optional-parameter-in-the-middle-of-a-route)

Is there any way to add an optional parameter in the middle of a route ? Example routes:I tried this, but it does not work:I know I can do this...... but my question is:  Can I add an optional parameter in the middle of a route?

2015-07-23 10:10:31Z

Is there any way to add an optional parameter in the middle of a route ? Example routes:I tried this, but it does not work:I know I can do this...... but my question is:  Can I add an optional parameter in the middle of a route?No. Optional parameters need to go to the end of the route, otherwise Router wouldn't know how to match URLs to routes. What you implemented already is the correct way of doing that:You could try doing it with one route:and pass * or 0 if you want to fetch entities for all things, but I'd call it a hack.There are some other hacks that could allow you to use one route for that, but it will increase the complexity of your code and it's really not worth it.Having the optional parameter in the middle of the route definition like that, will only work when the parameter is present. Consider the following:So you'll have to go with the separate route definition approach.The "correct" answer for this question is; No, you can't and shouldn't use an optional parameter unless it's at the end of the route/url.But, if you absolutely need to have an optional parameter in the middle of a route, there is a way to achieve that. It's not a solution I would recommend, but here you go:routes/web.php:app/Http/Controllers/Pages/TestController.php:resources/views/test.blade.php:Both links will trigger the first-method in TestController. The second-method will never be triggered.This solution works in Laravel 6.3, not sure about other versions. And once again, this solution is not good practice.

Why should Client Creadentials be associated with a user in Laravel Passport?

Meena Alfons

[Why should Client Creadentials be associated with a user in Laravel Passport?](https://stackoverflow.com/questions/43706309/why-should-client-creadentials-be-associated-with-a-user-in-laravel-passport)

I want to use Client Credentials to authenticate client applications to access the API.My problem is with creating client credentials. Using php artisan passport:client requires me to enter a user_id to associate the client to that user. I don't get it. Why the client application has to be associated to a user?! Or Is there another way?passport:client command only supports creating Password Grant Clients and Personal Grant Client. I don't think that any of them is what I need.What I really need is to create client credentials that will only be used by the client application to authorize itself to access some APIs. How to do that?

2017-04-30 12:23:02Z

I want to use Client Credentials to authenticate client applications to access the API.My problem is with creating client credentials. Using php artisan passport:client requires me to enter a user_id to associate the client to that user. I don't get it. Why the client application has to be associated to a user?! Or Is there another way?passport:client command only supports creating Password Grant Clients and Personal Grant Client. I don't think that any of them is what I need.What I really need is to create client credentials that will only be used by the client application to authorize itself to access some APIs. How to do that?I assume you want to use machine-to-machine authentication (no user interactions)I would recommend to read through the docs a couple of times to get the hang of it.I do not believe there is an specific way to create an only client credentials client, What i do is to create an personal client then change the field for personal client in the database personal_access_client 1 => 0You could use the personal client option, as seen from the --help optionphp artisan passport:client --personaloutput You would need to use another middleware other then the default one because there is no user present when using this methodClass \App\Http\Kernel:

Class \App\Http\Controllers\ApiTestController:

From php artisan route:listFollowing the specified request in the documentation on client-credentials-grant-tokensI use Postman for simplicity, easily send test request with Postman (www.getpostman.com)Set authorization to OAuth 2.0, image: Postman authenticationSet access token URL, client id, client secret and grant type to 'Client Credentials', image: Postman OAuth FieldsPostman creates an token and appends it to URL or Header, in this case headerResponse:I was gonna comment but I don't have enough reputation yet =pYou could give the command a name parameter that won't require any user input. As far as how you would get that client secret over to your client without manual intervention is where the real wizardry would come in. That command would still give you:as expected.

Many-to-Many Eloquent relationship update with Laravel Form Model Binding & Checkboxes

Yev

[Many-to-Many Eloquent relationship update with Laravel Form Model Binding & Checkboxes](https://stackoverflow.com/questions/20179473/many-to-many-eloquent-relationship-update-with-laravel-form-model-binding-chec)

I have 3 tables:doorscolorsdoor_colorsand 2 models with a many-to-many relationship (each door comes in a variety colors, and many colors overlap door-to-door):Door ModelColor ModelI want to create a form where I can edit the door, and update the available colors via checkboxes.

This is my Admin Doors Controllerand the Admin Doors Form ViewQuestion 1: How do I make it so that as the checkboxes are outputted, the ones with an existing relationship with the current door are checked and the ones without are unchecked.Question 2: Once I check the boxes and hit submit, how would I update the relationships? $door->colors()->detach(); to clear all existing ones for this door, then $door->colors()->attach($color_id_array); to create new ones based on an array of color ids?Any input is appreciated!

2013-11-24 18:55:17Z

I have 3 tables:doorscolorsdoor_colorsand 2 models with a many-to-many relationship (each door comes in a variety colors, and many colors overlap door-to-door):Door ModelColor ModelI want to create a form where I can edit the door, and update the available colors via checkboxes.

This is my Admin Doors Controllerand the Admin Doors Form ViewQuestion 1: How do I make it so that as the checkboxes are outputted, the ones with an existing relationship with the current door are checked and the ones without are unchecked.Question 2: Once I check the boxes and hit submit, how would I update the relationships? $door->colors()->detach(); to clear all existing ones for this door, then $door->colors()->attach($color_id_array); to create new ones based on an array of color ids?Any input is appreciated!Question 1: You should pass this into the view that contains your form, though it can also go right in the view, though that's not really best practice.  Do something similar to this......where the door you are finding is the door that's being updated.  Then before you output the checkbox in the loop, add Then you would change to Question 2:  There is actually a perfect method given to you for this.  Use It will both delete the old ones and add all the new ones in one shot.Suppose you are modeling user and role and want to edit user with roles. In your controller edit, In your template if you use select,In your controller update,

Laravel File Storage delete all files in directory

ßiansor Å. Ålmerol

[Laravel File Storage delete all files in directory](https://stackoverflow.com/questions/47007356/laravel-file-storage-delete-all-files-in-directory)

Is there a way to delete all files in specific directory. I'm trying to clear all my files in my created folder backgrounds in storage\app\backgrounds but in docs seems no method for delete all.

2017-10-30 02:28:20Z

Is there a way to delete all files in specific directory. I'm trying to clear all my files in my created folder backgrounds in storage\app\backgrounds but in docs seems no method for delete all.I don't think if this is the best way to solve this. But I solved mine callingThen initiate new instanceYou can use Filesystem method cleanDirectoryPlease see documentation for more information:https://laravel.com/api/5.5/Illuminate/Filesystem/Filesystem.html#method_cleanDirectoryIn Laravel 5.8 you can use:Remember to include:In Laravel 5.7 you can empty a directory using the Storage facade like so:The delete() method can receive an array of files to delete, while deleteDirectory() deletes one directory (and its contents) at a time.I don't think it's a good idea to delete and then re-create the directory as that can lead to unwanted race conditions.Just use it.I'm handling this by deleting the whole directory as I don't need it. But if, for any case, you need the directory you should be good by just recreating it:

Laravel - Creating tables dynamically (without migration)

Shay

[Laravel - Creating tables dynamically (without migration)](https://stackoverflow.com/questions/30096105/laravel-creating-tables-dynamically-without-migration)

I'm trying to create a table dynamically upon an admin request, and while it seems all fun and dandy like in most of Laravel's documentation, I can't seem to create a table. Though I can drop tables, and add or drop columns as I wish.This is my basic code model:What could possibly be the problem here? Unfortunately I don't receive any errors, so I don't know how to debug it. It just goes on to the next line, like everything's working fine. It just doesn't create any tables.Any advice? Much thanks in advance!

2015-05-07 08:47:06Z

I'm trying to create a table dynamically upon an admin request, and while it seems all fun and dandy like in most of Laravel's documentation, I can't seem to create a table. Though I can drop tables, and add or drop columns as I wish.This is my basic code model:What could possibly be the problem here? Unfortunately I don't receive any errors, so I don't know how to debug it. It just goes on to the next line, like everything's working fine. It just doesn't create any tables.Any advice? Much thanks in advance!Ugh, never mind... I worked on it for long enough, and the solution as always was... Very simple.I just had to figure a connection for the database first, so instead ofIt isHope this helps someone someday in the future!This one is even better.

「laravel.log」could not be opened: failed to open stream [duplicate]

Josh Mountain

[「laravel.log」could not be opened: failed to open stream [duplicate]](https://stackoverflow.com/questions/24055056/laravel-log-could-not-be-opened-failed-to-open-stream)

I have setup Laravel homestead on a local OSX machine, everything seemed to be going smoothly until I tried to open example.app:8000 and got this error:I followed the Laravel docs as well as a Laracast about setting up homestead, so I am not sure what would be causing this. I can see that /home/vagrant/Code/example/app/storage/logs/laravel.log doesn't exist, but I assume that is something that should be created automatically?

2014-06-05 08:17:53Z

I have setup Laravel homestead on a local OSX machine, everything seemed to be going smoothly until I tried to open example.app:8000 and got this error:I followed the Laravel docs as well as a Laracast about setting up homestead, so I am not sure what would be causing this. I can see that /home/vagrant/Code/example/app/storage/logs/laravel.log doesn't exist, but I assume that is something that should be created automatically?You need to run one of the following:All files and folders under app/storage should be writable by you and group www-data (the webserver).If you get this error (or a similar error) in the browser when accessing your site, then the group www-data can't write to app/storage. If you get this error when you execute certain php artisan commands, then you (the user) can't write to app/storage. Therefore both you and the www-data group must have write permission.To ensure the files and folders have the correct permissions:As for me I had changed my storage permission with chmod -R 777 storage and it's work well.However, setting 777 permissions is incredibly dangerous and should not be done on any server other than your local machine.I had checked for this configuration at here.You can do this by following stepswhich meansIf your webserver is not running as Vagrant, it will not be able to write to it, so you have 2 options:or change the group to your webserver user, supposing it's www-data:If changing the file permissions as described in the other answers didn't work and you're using CentOS 7 or RHEL then the issue may be a security program called selinux.  I struggled with all kinds of permissions and groups before noticing user3670777 answer to Laravel 4: Failed to open stream: Permission deniedHope this helps others.If All Above suggestions not working disable your selinux and try againim pretty new on laravel. May be I could not explain it in depth but that command fixed my problem. 

Laravel/Eloquent: Fatal error: Call to a member function connection() on a non-object

J. LaRosee

[Laravel/Eloquent: Fatal error: Call to a member function connection() on a non-object](https://stackoverflow.com/questions/26680716/laravel-eloquent-fatal-error-call-to-a-member-function-connection-on-a-non-o)

I'm building a package in Laravel 4 but am getting a non-object error when attempting to access the db from which seems to be a properly instantiated object. Here's the setup:The config and class in question:composer.json:The class:The call:The error:I believe I'm missing something fundamental and under my nose. Thanks for any and all help!EDIT:Here is the class that's instantiating ChatHistory and calling the write:The fact that DB isn't available suggest that Eloquent isn't being loaded up top?

2014-10-31 17:54:17Z

I'm building a package in Laravel 4 but am getting a non-object error when attempting to access the db from which seems to be a properly instantiated object. Here's the setup:The config and class in question:composer.json:The class:The call:The error:I believe I'm missing something fundamental and under my nose. Thanks for any and all help!EDIT:Here is the class that's instantiating ChatHistory and calling the write:The fact that DB isn't available suggest that Eloquent isn't being loaded up top?Answer:Bootstrap your package in your service provider's boot method.Explanation:Since you're developing a package to be used with Laravel, there's no point in making your own Capsule instance. You can just use Eloquent directly.Your problem seems to stem from DB/Eloquent not being set up yet by the time your code hits it.You have not shown us your service provider, but I'm guessing you're using one and doing it all in the register method.Since your package depends on a different service provider (DatabaseServiceProvider) to be wired up prior to its own execution, the correct place to bootstrap your package is in your service provider's boot method.Here's a quote from the docs:In case you're working with Lumen, you may occur identical problem. In this case just uncomment:in bootstrap\app.php@matpop and @TonyStark were on the right track: Capsule\Manager wasn't being booted.I am able to extend Eloquent after booting. I think another solution might be along the lines of (but not tested):What i did was simple, i just forgot to uncomment $app->withFacades();

$app->withEloquent(); in my bootstrap/app.php.Now works fineTry including the DB facade as well as Eloquent......and then see if you have access to DB::table('chat_history'). (Also note that in your class, your call to use Illuminate\Database\Model; should be Illuminate\Database\Eloquent\Model; )

Is it possible to reference a Foreign Key in a different database in Laravel?

cchapman

[Is it possible to reference a Foreign Key in a different database in Laravel?](https://stackoverflow.com/questions/28950070/is-it-possible-to-reference-a-foreign-key-in-a-different-database-in-laravel)

I'm trying to create a model and a migration for that model in Laravel 4.2. All of my Laravel apps use the same MySQL database called laravel. However, we also have another database (on the same server), called main_db that contains a users table, which I would like to use for the source of a few foreign keys in my own laravel_users table in the laravel database.According to the Laravel documentation, I would designate a foreign key with this code:But I believe this assumes that the 'users' table exists within the same database.Is it possible to do trans-database foreign keys in Laravel? Would I have to first create a model that uses the users table from main_db? And is it possible to set up two different database connections in the app/config/database.php?

2015-03-09 19:18:17Z

I'm trying to create a model and a migration for that model in Laravel 4.2. All of my Laravel apps use the same MySQL database called laravel. However, we also have another database (on the same server), called main_db that contains a users table, which I would like to use for the source of a few foreign keys in my own laravel_users table in the laravel database.According to the Laravel documentation, I would designate a foreign key with this code:But I believe this assumes that the 'users' table exists within the same database.Is it possible to do trans-database foreign keys in Laravel? Would I have to first create a model that uses the users table from main_db? And is it possible to set up two different database connections in the app/config/database.php?Cross database foreign keys hasn't much to do with Laravel actually. The real question is if the database does support it. And MySQL (at least with InnoDB) does support foreign key constraints accross multiple databases. You just have to specify the database with the dot notation: db.table.Regarding the Laravel schema builder, this should work:If you get an error, check if the column types are the same.

(You can't reference varchar to int or vice versa, keys have to be of same type).For future reference if you ever change the name of the database this will not work.  It is best to grab the name of the database by the database definition.config/database.phpThen in your migration file:Answer of @lukasgeiter worked for me with following two changes:1- I changed both database engines to InnoDB.2- I had to set the foreign key to be an Unsigned integer in the migration file as the reference was an unsigned integer and was the primary key.

Laravel Migrations - Issues while creating timestamps

cheese5505

[Laravel Migrations - Issues while creating timestamps](https://stackoverflow.com/questions/30555844/laravel-migrations-issues-while-creating-timestamps)

I am trying to run migrations on my Laravel instance. They are just the default migrations (users and password resets) but when it tries to make the timestamps it  throws this error:as well as a PDOException:How can I fix this?Thanks.

2015-05-31 09:25:55Z

I am trying to run migrations on my Laravel instance. They are just the default migrations (users and password resets) but when it tries to make the timestamps it  throws this error:as well as a PDOException:How can I fix this?Thanks.This is due to MySQL not accepting zero as a valid default date and thus the table creation fails a constraint check on creation.You probably have NO_ZERO_DATE enabled in your MySQL configuration. Setting this to off will allow you to create the table or alternatively remove the default 0 value or change it to CURRENT_TIMESTAMP.You can find out more about this exact issue here: https://github.com/laravel/framework/issues/3602I have been facing the same error. Given solutions does work properly still i want to help laravel developers.

Simply add a following line to config/database.phpit sounds like strict mode.You may disable strict mode in one of two ways:Open your my.ini file within the MySQL installation directory, and look for the text sql-mode.Find:sql-mode="STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION"and change tosql-mode="NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION"or you can run the following in phpMyAdminSET @@global.sql_mode='';This is due to MySQL not accepting zero as a valid default date  so you can write or $table->nullableTimestamps();Instead of $table->timestamps();This worked for me after being unsuccessful with strict mode:You can use nullableTimestamps() instead of timestamps()or elsealso, check the database server versionPlease have a look on these ref links:https://github.com/laravel/framework/issues/3602https://laracasts.com/discuss/channels/forge/syntax-error-or-access-violation-1067-invalid-default-value-for-created-atI have used the following method:Really worked!Migrating old tables works like that:from https://github.com/laravel/framework/issues/3602you should disable MySQL strict mode on Laravel.

MySQL has had a strict mode since 5.1, but in 5.7 it became the default.

In Laravel, you can fix this in code: edit your database.php config file, and add a key of strict with a value of false.for non-Laravel users:if you're using a non-Laravel application,you won't have that option.Here's how to disable strict mode globally.find your MySQL configuration file my.cnf or my.ini 

the default MySQL configuration will live in /etc/mysql/my.cnf open the file and find the [mysqld] section.We're going to add a new key, sql_mode

On MySQL 5.7, the default values for this key out of the box are: The strict mode comes from STRICT_TRANS_TABLES. So, let's overwrite the sql_mode to:That's it! Save the file, and restart MySQL.MySQL 5.7.28The MySQL docs recommend the following (note the use of GLOBAL):

Laravel: blade foreach looping bootstrap columns

Thomas Charlesworth

[Laravel: blade foreach looping bootstrap columns](https://stackoverflow.com/questions/41650670/laravel-blade-foreach-looping-bootstrap-columns)

I have a foreach loop and inside that contains html with bootstrap columns.However, bootstrap requires the row div before creating columns, placing that straight in to the foreach loop would create a row div for each col-md-6. I want to know how I can throw in the row div, skip the next loop throwing in only the closing div tag. And then repeat that process.Example output where the loops 4 times:

2017-01-14 13:44:10Z

I have a foreach loop and inside that contains html with bootstrap columns.However, bootstrap requires the row div before creating columns, placing that straight in to the foreach loop would create a row div for each col-md-6. I want to know how I can throw in the row div, skip the next loop throwing in only the closing div tag. And then repeat that process.Example output where the loops 4 times:As an alternative to Alexey Mezenin's answer you could use array_chunk instead. http://php.net/manual/en/function.array-chunk.phpI personally find the the above a little more readable.Alternatively, if $address is a collection you could do $address->chunk(2) instead of array_chunk($address, 2).If you want to change the amount of columns you have you would simply need to change the 2 to be however many columns you want.You can use Laravel chunk in the blade template.Copied from the blogpost.Use the $loop variable:

How to create laravel storage symbolic link for production or sub domain system?

Mizanur Rahman Khan

[How to create laravel storage symbolic link for production or sub domain system?](https://stackoverflow.com/questions/45825889/how-to-create-laravel-storage-symbolic-link-for-production-or-sub-domain-system)

When I worked on laravel local development server php artisan storage:link works fine for me. But when I transfer my site to production server then I saw my public storage link was a folder. Then I delete that tried to create a link. I got an error because my app was in the root folder and tried to solve this problem.

2017-08-22 19:49:55Z

When I worked on laravel local development server php artisan storage:link works fine for me. But when I transfer my site to production server then I saw my public storage link was a folder. Then I delete that tried to create a link. I got an error because my app was in the root folder and tried to solve this problem.I solved this problem by another command for creating a symbolic link by terminal/cmd/shh:I solved this also Using laravel web route routes/web.phpAnother simple way is to run Executing php artisan storage:link Command ProgrammaticallyOn routes/web.php

Permission Denied Error using Laravel & Docker

Anand Naik B

[Permission Denied Error using Laravel & Docker](https://stackoverflow.com/questions/48619445/permission-denied-error-using-laravel-docker)

I have two docker containers: Nginx and App.

The app container extends PHP-fpm and also has my Laravel Code.In my docker-compose.yml I'm doing:In my Nginx Dockerfile i'm doing:In my App Dockerfile I'm doing:After successfully running docker-compose up, I have the following error when I try localhostFrom my understanding, the storage folder needs to writable by the webserver.

What should I be doing to resolve this?

2018-02-05 09:35:53Z

I have two docker containers: Nginx and App.

The app container extends PHP-fpm and also has my Laravel Code.In my docker-compose.yml I'm doing:In my Nginx Dockerfile i'm doing:In my App Dockerfile I'm doing:After successfully running docker-compose up, I have the following error when I try localhostFrom my understanding, the storage folder needs to writable by the webserver.

What should I be doing to resolve this?Make your Dockerfile something as below - This makes directory /var/www owned by www-data which is the default user for php-fpm. Since it is compiled with user www-data.Ref- https://github.com/docker-library/php/blob/57b41cfc2d1e07acab2e60d59a0cb19d83056fc1/7.0/jessie/fpm/DockerfileI found similar problem and I fixed it by When using bind mounts in Docker, the original permissions in the Docker host are preserved in the container. This enables us to set appropriate permissions on the Docker host, to be used inside the container.First, you should find the uid and gid of the nginx, for example:docker-compose exec nginx id www-dataThe output of this command would be something like this:uid=33(www-data) gid=33(www-data) groups=33(www-data)Then, you should use these uid and gid to set permissions on Docker host, which will be used by the container too. So, run the following command on the Docker host:sudo chown -R 33:33 siteNow everything must be working.You can do 3 things as I used/usingNote: If the project is in /var/www/ then if you wrote file upload also you need permission to that folders too. this will avoid such error when you moved that to /homeu can just right click on your laravel folder, click on properties,then permissions, and from 'group' field, select the 'docker' and give necessary permissions to 'docker' group :) thats work for me

How to use patch request in Laravel?

Darama

[How to use patch request in Laravel?](https://stackoverflow.com/questions/42313033/how-to-use-patch-request-in-laravel)

There is entity User that is stoted in table UsersSome fields in this table are null by default. I need to update these fields and set not null data.For this I try to use PATCH method in Laravel:Routing:Controller:Does it mean that I can pass any data to update?

Should I pass $id parameter to routing and controller relatively?How to use right handler for PATCH method in Laravel?

2017-02-18 08:43:29Z

There is entity User that is stoted in table UsersSome fields in this table are null by default. I need to update these fields and set not null data.For this I try to use PATCH method in Laravel:Routing:Controller:Does it mean that I can pass any data to update?

Should I pass $id parameter to routing and controller relatively?How to use right handler for PATCH method in Laravel?your route is:replace your route with following route that use for all CRUD opration:if you use ajax for submit data then replace your type and url with following:if you don't use ajax than use following:update: after version 5.6 you can use these syntax for above functions in any blade file:Update the routing as per below Yes, you need to send id for route patch. Example from https://laravel.com/docs/5.4/controllers#resource-controllers for Laravel PUT/PATCH  - /photos/{photo}, so you don't need update word in your route. Just users/id and methods PUT or PATCH.UPD for CRUD operations:

How to install PHP composer inside a docker container

Andre

[How to install PHP composer inside a docker container](https://stackoverflow.com/questions/51443557/how-to-install-php-composer-inside-a-docker-container)

I try to work out a way to create a dev environment using docker and laravel.I have the following dockerfile:Laravel requires composer to call composer dump-autoload when working with database migration. Therefore, I need composer inside the docker container. I tried:But when I call It throws the following error:I would be more than happy for advice how I can add composer to the PATH within my dockerfile or what else I can do to surpass this error. Thanks for your support.

Also: this is the gitub repository if you need to see the docker-compose.yml file or anything else.

2018-07-20 13:24:35Z

I try to work out a way to create a dev environment using docker and laravel.I have the following dockerfile:Laravel requires composer to call composer dump-autoload when working with database migration. Therefore, I need composer inside the docker container. I tried:But when I call It throws the following error:I would be more than happy for advice how I can add composer to the PATH within my dockerfile or what else I can do to surpass this error. Thanks for your support.

Also: this is the gitub repository if you need to see the docker-compose.yml file or anything else.I can install composer adding this line on my test dockerfile:Here is the dockerfile:It works for me, to test if the composer are installed i access to my container bash and execute:In Dockerfile :We have basicly the same command running with the difference, Alternatively, you should add the composer bin files path to the $PATH variable.Create an executable of your composer file using

Laravel 5 app always using 'testing' environment configuration

Simon Fredsted

[Laravel 5 app always using 'testing' environment configuration](https://stackoverflow.com/questions/27438817/laravel-5-app-always-using-testing-environment-configuration)

I have a Laravel 5 app with two environments and two configurations: testing (for PHPUnit configuration, in-memory db) and local (my development configuration).Even when the environment is configured to be local, the application only loads the configuration in the resources/config/testing folder. I can see the environment in the same app from the APP_ENV environment variable, and it is local.

2014-12-12 07:28:39Z

I have a Laravel 5 app with two environments and two configurations: testing (for PHPUnit configuration, in-memory db) and local (my development configuration).Even when the environment is configured to be local, the application only loads the configuration in the resources/config/testing folder. I can see the environment in the same app from the APP_ENV environment variable, and it is local.Laravel 5 doesn't cascade config files correctly anymore so your testing config file is overriding anything you have in your local config file. Now you aren't supposed to have any subfolders for each environment, but rather set configuration settings inside the .env file in the root folder.This file isn't checked in to the repo to ensure that nothing sensitive is checked into the repo. You should have a separate .env file for each environment your application is living.TESTINGFor php unit (functional) you can set env variables in the phpunit.xml file e.g..For behat (acceptance) testing the Laracasts Laravel Behat extension allows you to create a .env.behat file to change the environment variables.For phpspec (unit) testing well the environment shouldn't matter as your testing individual methods in isolation and mock everything else. For selenium (integration / system / e2e) testing the environment variables should come from the .env file on the server wherever you are doing this testing. Additional points I've just had to use to get tests running on sqlite, while the main app normally defaults to mysql:Add something like this to phpunit.xml, as explained by craig.michael.morris:And this change to config/database.phpAnd in the 'sqlite' section of config/database.php1) open the config file  database.php and add the following inside the 'connections' => [this in memory sqlite will be used for your testing2) open the .env file and make sure it has the following:3) open phpunit.xml and add the following inside the <php> tag:here’s where you can add all the testing related env variables4) in your tests were you use a database connection use the Database Migration Trait:for more details about the DatabaseMigrations refer to the documentation https://laravel.com/docs/5.1/testing#resetting-the-database-after-each-test

Fill method in Laravel not working?

marc_aragones

[Fill method in Laravel not working?](https://stackoverflow.com/questions/24303003/fill-method-in-laravel-not-working)

I am learning how to use Laravel framework but I am having troubles with filling a Model. Here is my code:The model Event:And here is the code in the controller:So, why the print_r is displaying an empty array?

2014-06-19 09:17:42Z

I am learning how to use Laravel framework but I am having troubles with filling a Model. Here is my code:The model Event:And here is the code in the controller:So, why the print_r is displaying an empty array?Actually. at first you should change the model name from Event to something else, Laravel has a Facade class as Illuminate\Support\Facades\Event so it could be a problem.Regarding the fill method, you should pass an associative array to fill method like:Also make sure you have a protected $fillable (check mass assignment) property declared in your Model with property names that are allowed to be filled. You may also do the same thing when initializing the Model:Finally, call:Because attributes is a protected property.Also make sure that the $fillable property is defined in your model class. For example, in your new renamed model:If you do not have either $fillable or $guarded defined on your Model, fill() won't set any values. This is to prevent the model from mass assignment. See "Mass Assignment" on the Laravel Eloquent docs: http://laravel.com/docs/5.1/eloquent.When filling the attributes, make sure to use an associative array:A useful way to debug and check all your values:Hope this helps!Use a key/value array in fill:An example:In your model you need to have protected $fillable = ['foo','bar'];Then you can do:The array key needs to be on the $fillable, as Laravel will effectively call:Alternatively, you can write directly to a column name:

How I can install the PHPExcel library in laravel?

TuGordoBello

[How I can install the PHPExcel library in laravel?](https://stackoverflow.com/questions/23764375/how-i-can-install-the-phpexcel-library-in-laravel)

I'm trying to use this library to create excel files but not how to install it. I was considering to download the library from its home page (http://phpexcel.codeplex.com/wikipage?title=Examples) but also do not know what folder should I place it. How I can install?

2014-05-20 15:40:32Z

I'm trying to use this library to create excel files but not how to install it. I was considering to download the library from its home page (http://phpexcel.codeplex.com/wikipage?title=Examples) but also do not know what folder should I place it. How I can install?You should use composer:  Add "phpexcel/phpexcel": "dev-master" to your composer.json Then execute composer update. So you can use it as normal: For install PhpExcel in laravel 5. Please visit this link for pakage -https://packagist.org/packages/phpoffice/phpexcel.Please follow the instruction --1:- Add "phpoffice/phpexcel": "dev-master" to your composer.json. 2:- execute "composer update" on terminal.3:- Open the file "/vendor/composer/autoload_namespaces.php". Paste the below line in the file.4:- Now you can use PHPEXCEL library in your controllers or middleware or library. There's actually a neat new PHPExcel library specifically made for Laravel. Easy installation and it looks easy to use (I'm unaffiliated). https://laravel-excel.com/If you are using Laravel 5. It is very easy. check this link for configurationyou may need to type in the following command to proceed with the package download check this link for usagemy might want to look at my example code:For future readers:PHPExcell is no more maintained. Rather use: https://github.com/PHPOffice/PhpSpreadsheet

http://phpspreadsheet.readthedocs.io/en/develop/#installation

Laravel - Add custom column in select with Eloquent query buider

ZarkDev

[Laravel - Add custom column in select with Eloquent query buider](https://stackoverflow.com/questions/27143652/laravel-add-custom-column-in-select-with-eloquent-query-buider)

this is a simplified use case, only to illustrate what I want to achieve:Considering this query in pure SQL:How can I add the constant active column using query builder ?Here is my Query Builder without the extra column:

2014-11-26 07:42:22Z

this is a simplified use case, only to illustrate what I want to achieve:Considering this query in pure SQL:How can I add the constant active column using query builder ?Here is my Query Builder without the extra column:Simplest would be to use DB::raw        We can add subquery or "custom column" in select with first argument of \Illuminate\Database\Query\Builder::selectSub method as raw SQL or Closure, or \Illuminate\Database\Query\Builder. Better solution is closure or Builder. 

In your case it will be:Tested on Laravel 5.5. In closure $query is a object of \Illuminate\Database\Query\Builder for subquery. Prepared SQL will be:Extended example... If we use App\Module eloquent for modules and we need get url of modules and count of their submodules with id > 5, we can write next:Prepared SQL will be:Or you can write your example with raw sql:Then prepared SQL will be:For get all columns necessarily to use select('*'): Not:Laravel Eloquent has very flexible query builder.You can specify a column to return as:

Run one file or map in phpunit

Jamie

[Run one file or map in phpunit](https://stackoverflow.com/questions/35596637/run-one-file-or-map-in-phpunit)

I'm using laravel and I've written some test files. But how can I exec only one file? When I do for example: phpunit tests/resulttesting/school/deleteSchoolForRealTest It throws an error:When I run phpunit it runs all my tests. And how can I exec only one folder? I'm on a mac. 

2016-02-24 08:13:49Z

I'm using laravel and I've written some test files. But how can I exec only one file? When I do for example: phpunit tests/resulttesting/school/deleteSchoolForRealTest It throws an error:When I run phpunit it runs all my tests. And how can I exec only one folder? I'm on a mac. You are doing everything correctly.1) First way to add folder.

 My correct way was:I had same errors when I forget to start from "tests" folderI got2) Filter is another option. read here

example:Meaning that you will have executed files EWalletTest and EWalletFooTest and test cases from other filee with names like `test_EWallet_with_Australian_dollar.Use filter optionUsing phpunit.xmlthe @group option can be used on classes and methods.class Aclass Bin phpunit.xmlthe classes that belongs to group active will be executed.

How to compare two encrypted(bcrypt) password in laravel

Jija

[How to compare two encrypted(bcrypt) password in laravel](https://stackoverflow.com/questions/35715755/how-to-compare-two-encryptedbcrypt-password-in-laravel)

How to compare two bcrypt passwordAnd Both $pass1 & $pass2 are bcrypt for 'test'.How I can check for equality. without using text 'test' like this

2016-03-01 06:01:47Z

How to compare two bcrypt passwordAnd Both $pass1 & $pass2 are bcrypt for 'test'.How I can check for equality. without using text 'test' like thisYou can't actually compare two encrypted bcrypt passwords to each other directly as strings because the encryption contains salt which makes the hashes different each time.You can simply use Hash::check() method

eg:reference https://laravel.com/docs/5.5/hashingYou can try this way:you can compare hash encrypt the password using Hash. but note that in this method 

the first value should be plain-text and second bcrypt value.

Laravel framework classes not available in PHPUnit data provider

FixMaker

[Laravel framework classes not available in PHPUnit data provider](https://stackoverflow.com/questions/26710631/laravel-framework-classes-not-available-in-phpunit-data-provider)

I have something like the following set up in Laravel:In /app/controllers/MyController.php:In /app/tests/MyControllerTest.php:However, when I run vendor/bin/phpunit I get the following error:If I remove the reference to the MyController class in myDataProvider() and replace it with a literal constant then the test completes successfully.In addition, I can place references to MyController::MAX_FILE_SIZE inside the actual testMyController() method, and the test also completes successfully.It appears that the autoloading setup for Laravel framework classes isn't being set up until after the data provider method is being called, but before the actual test methods are called. Is there any way around this so that I can access Laravel framework classes from within a PHPUnit data provider?NOTE: I'm calling PHPUnit directly from the command line and not from within an IDE (such as NetBeans). I know some people have had issues with that, but I don't think that applies to my problem.

2014-11-03 08:48:42Z

I have something like the following set up in Laravel:In /app/controllers/MyController.php:In /app/tests/MyControllerTest.php:However, when I run vendor/bin/phpunit I get the following error:If I remove the reference to the MyController class in myDataProvider() and replace it with a literal constant then the test completes successfully.In addition, I can place references to MyController::MAX_FILE_SIZE inside the actual testMyController() method, and the test also completes successfully.It appears that the autoloading setup for Laravel framework classes isn't being set up until after the data provider method is being called, but before the actual test methods are called. Is there any way around this so that I can access Laravel framework classes from within a PHPUnit data provider?NOTE: I'm calling PHPUnit directly from the command line and not from within an IDE (such as NetBeans). I know some people have had issues with that, but I don't think that applies to my problem.As implied in this answer, this appears to be related to the order that PHPUnit will call any data providers and the setUp() method in any test cases.PHPUnit will call the data provider methods before running any tests. Before each test it will also call the setUp() method in the test case. Laravel hooks into the setUp() method to call $this->createApplication() which will add the controller classes to the 'include path' so that they can be autoloaded correctly.Since the data provider methods are run before this happens then any references to controller classes inside a data provider fail. It's possible work around this by modifying the test class to something like this:This will call createApplication() before the data provider methods are run, and so there is a valid application instance that will allow the appropriate classes to be autoloaded correctly.This seems to work, but I'm not sure if it's the best solution, or if it is likely to cause any issues (although I can't think of any reasons why it should).The test will initialize much faster if you create the application right within the dataProvider method, especially if you have large set of items to test.Performance warning for the other solutions (especially if you plan to use factories inside your dataProviders):As this article explains:The above article proposes to return a closure from the dataProvider and execute that in your test:

Laravel seeder gives error. Class not found

samhu kiklsk

[Laravel seeder gives error. Class not found](https://stackoverflow.com/questions/26345408/laravel-seeder-gives-error-class-not-found)

I'm a newbie in Laravel and and I'm teaching myself how to authenticate from a login table. I have migrated and created the table. Now, I'm trying to seed the data into the login table, but the command prompt is continuously giving me error, which says Fatal Error, class login not found and I have no idea what i have missed. So can anyone please help me. Here is the code that i have, and yes I'm using Laravel 4.3

2014-10-13 17:17:29Z

I'm a newbie in Laravel and and I'm teaching myself how to authenticate from a login table. I have migrated and created the table. Now, I'm trying to seed the data into the login table, but the command prompt is continuously giving me error, which says Fatal Error, class login not found and I have no idea what i have missed. So can anyone please help me. Here is the code that i have, and yes I'm using Laravel 4.3You need to create an Eloquent model for that table in order to use Login::create(). You can do that with a simple artisan command:$ php artisan generate:model LoginThis will generate a new Eloquent model in app/models directory which should look like this.Your code should work after that. If it still doesn't make sure you run composer dump-autoload.EDITNow I see, the problem  is with your login class (with earlier question formatting the exact error was illegible). You should look again what's the name of file where you have login class and what's the name of class. The convention is that the file should have name Login.php (with capital letter) and the name of class also should be Login (with capital letter). You should also check in what namespace is your Login class. If it is defined in in App namespace, you should add to your LoginTableSeeder:in the next line after <?phpso basically the beginning of your file should look like this:EARLIER ANSWERYou didn't explained what the exact error is (probably the error is for Seeder class)  but:In database/seeds/DatabaseSeeder.php you should run Login seeder like this:You should put into database/seeds file LoginTableSeeder.php with capital letter at the beginning.Now, your file LoginTableSeeder.php file should look like this:you need to import Seeder with use at the beginning of file and again class name should start with capital letter.Now you should run composer dump-autoload and now when you run php artisan db:seed it will work fine.Just run 

composer dump-autoload -o

for the autoloader to pick up the newly classes because the database folder is not automatically autoloaded with PSR-4.This worked for meI have the same problem but you can solve it by adding your namespace:I've experienced the same problem. In my case, the composer was extremely old and after it's update everything runs Ok.Update composer with the command:$ composer self-update Hope it can help others.

Laravel eloquent where date is equal or greater than DateTime

Kaizokupuffball

[Laravel eloquent where date is equal or greater than DateTime](https://stackoverflow.com/questions/44266337/laravel-eloquent-where-date-is-equal-or-greater-than-datetime)

I'm trying to fetch relational data from a model where the date column is higher or equal to the current time.The date column is formated as this: Y-m-d H:i:sWhat I'm trying to do is to grab all rows where the Y-m-d H:i:s is in the future. Example: lets assume the date is 2017-06-01 and the time is 09:00:00

Then i would like got all rows where the date is in the future, and the time is in the future. Currently my code looks like this, and it's almost working but it doesn't grab the rows where the date is the current day.What am I doing wrong?

Thanks in advance.

2017-05-30 15:30:26Z

I'm trying to fetch relational data from a model where the date column is higher or equal to the current time.The date column is formated as this: Y-m-d H:i:sWhat I'm trying to do is to grab all rows where the Y-m-d H:i:s is in the future. Example: lets assume the date is 2017-06-01 and the time is 09:00:00

Then i would like got all rows where the date is in the future, and the time is in the future. Currently my code looks like this, and it's almost working but it doesn't grab the rows where the date is the current day.What am I doing wrong?

Thanks in advance.Sounds like you need to use >=, for example:Here you can use this:

Intervention Image: Save image directly from an url with original file name and ext?

Salines

[Intervention Image: Save image directly from an url with original file name and ext?](https://stackoverflow.com/questions/32828606/intervention-image-save-image-directly-from-an-url-with-original-file-name-and)

How to get the filename, when taking image from a remote server? And how to save with original size and filename?I use Intervention, (http://image.intervention.io/api/make) to build CakePHP 3 image Behavior, I want to provide an easy uploading from remote servers, and keep the original image as a source for future manipulation.EDIT I ask, is there the Intervention Image method that returns the name of the file, when taken from the remote server. I know php copy(), I can also use the CakePHP File  utilities, but it gives me the duplicate request on remote file.

2015-09-28 17:26:53Z

How to get the filename, when taking image from a remote server? And how to save with original size and filename?I use Intervention, (http://image.intervention.io/api/make) to build CakePHP 3 image Behavior, I want to provide an easy uploading from remote servers, and keep the original image as a source for future manipulation.EDIT I ask, is there the Intervention Image method that returns the name of the file, when taken from the remote server. I know php copy(), I can also use the CakePHP File  utilities, but it gives me the duplicate request on remote file.response() does not return the original filename like Salines was requesting. This should work  You can easily do it using the make(); and response(); methods. Check my code below.Just keep in mind that allow_url_fopen must be enabled to fetch a remote image.This will display my profile picture. If you are not using it with Laravel Framework, just replace return with echo.Hope that helps and upvote my reply if useful ;)If you need further help just ask.

Laravel Faker - What's the difference between create and make

Simon Suh

[Laravel Faker - What's the difference between create and make](https://stackoverflow.com/questions/44119401/laravel-faker-whats-the-difference-between-create-and-make)

I have the following code:what is the difference between create() and make() and why is it not listed in the helper functions page in the Laravel documentation? Thank you! :)

2017-05-22 18:07:56Z

I have the following code:what is the difference between create() and make() and why is it not listed in the helper functions page in the Laravel documentation? Thank you! :)create persists to the database while make just creates a new instance of the model.https://laravel.com/docs/5.4/database-testing#using-factoriesIf you'd like to see the source code differences between make and create you can see them in src/Illuminate/Database/Eloquent/FactoryBuilder.phpclick here for more info

What is a usage and purpose of Laravel's binding?

Andrii H.

[What is a usage and purpose of Laravel's binding?](https://stackoverflow.com/questions/49348681/what-is-a-usage-and-purpose-of-laravels-binding)

I cannot understand a point of Laravel's binding system. I know what does dependency injection mean. And it can work even without that weird "bindings", right? I saw in documentation, that binding can return a new object. Why and when I have to use that? Please, explain not very complicated, because I've read documentation and I could not understand the use and the purpose of that bindings. Thanks.

2018-03-18 13:58:11Z

I cannot understand a point of Laravel's binding system. I know what does dependency injection mean. And it can work even without that weird "bindings", right? I saw in documentation, that binding can return a new object. Why and when I have to use that? Please, explain not very complicated, because I've read documentation and I could not understand the use and the purpose of that bindings. Thanks.Not really. Sure it can work just fine if the required dependencies are simple to instantiate. Let's say you have this simple class Foo stored in app directory:You can type hinted this class without binding it first in the container. Laravel will still be able to resolve this class. Let's say you type-hinted it like this in the routes:We can even go further, let's say this Foo class required another simple class Bar. Our Bar class looks like this:And our Foo class looks like this now:Will Laravel be able to resolve the type-hinted Foo class now? YES! Laravel will still be able to resolve this Foo class.Now the issue will come in when our Foo class needs slightly more complex dependencies that need to be configured. Imagine that our Foo class simply need the name of our application. Sure you can simply use config('app.name') within the class's method, but imagine that this can be an HTTP client that requires a configuration array to instantiate.Will Laravel be able to solve this class now? NOPE. Service Container to the rescue! You can teach Laravel how to resolve this Foo class by binding it in service container. You can define the binding within the register method on app\Providers\AppServiceProvider.php file:And sometimes, you don't want multiple instances to be created. Like our Foo class for instance, there's no need for multiple instances for this kind of class. In this case, we can bind it with singleton method.More Important UsageBut the more important usage of this service container is that we can bind an interface to it's implementation. Let's say we have this PaymentProcessorInterface with pay method:Then we have the implementation of this interface named StripeProcessor:With service container, we can bind the PaymentProcessorInterface to StripeProcessor class:We can then type-hinted PaymentProcessorInterface within our code:This way we can easily swap the PaymentProcessorInterface implementation. Let's say we want to change the payment processor to Paypal then we have this PaypalProcessor class.All we have to do is update the binding:Hope this gives you some ideas.

How does the static password work in the default Laravel user factory?

Kim Prince

[How does the static password work in the default Laravel user factory?](https://stackoverflow.com/questions/44037895/how-does-the-static-password-work-in-the-default-laravel-user-factory)

Per this link, https://laravel.com/docs/5.4/database-testing#writing-factories, the default Laravel user factory tests the value of a static $password variable.  If it is falsey, it bcrypts 'secret' and uses that.How does one go about setting the value of the static variable $password?  Obviously I don't want to import it at the time the function is declared (since that would defeat the purpose of making it variable).  I realise that I can override the value of password by passing an array to the make() method, but this is a different thing altogether.

2017-05-18 03:00:15Z

Per this link, https://laravel.com/docs/5.4/database-testing#writing-factories, the default Laravel user factory tests the value of a static $password variable.  If it is falsey, it bcrypts 'secret' and uses that.How does one go about setting the value of the static variable $password?  Obviously I don't want to import it at the time the function is declared (since that would defeat the purpose of making it variable).  I realise that I can override the value of password by passing an array to the make() method, but this is a different thing altogether.I had the exact same question and found the answer here:See the comment at the bottomSo the static $password is not for including some password from the outside. It is just a clever trick to gain performance.

Laravel Composer sees wrong PHP Version

Miguel Stevens

[Laravel Composer sees wrong PHP Version](https://stackoverflow.com/questions/46785969/laravel-composer-sees-wrong-php-version)

I'm trying to install an older Laravel Project.When I run composer install I get the following errorWhen I run I get the following resultThis is the content of my composer.jsonHow is it possible that this project thinks I have php 5.6 running?Thank you.

2017-10-17 08:41:10Z

I'm trying to install an older Laravel Project.When I run composer install I get the following errorWhen I run I get the following resultThis is the content of my composer.jsonHow is it possible that this project thinks I have php 5.6 running?Thank you.I've had this problem too. If you don't want to update all your composer packages, you can solve this issue by manually changing the composer.lock file and writing your actual PHP version in platform > php in the JSON object.ExampleAlthough it works, the most recommended way to do this would be deleting your composer.lock file, changing the platform > php version in composer.json and then executing composer install.additional information and response to @nicohase,   Nico, you are correct when you state that composer is not using the same php executable as apache.  Why would composer ensure that php-cli meets the requirements of the other required packages?  It wouldn't and doesn't.   The user is administering composer with php-cli, which inherently means that they are compatible.  Composer is checking to ensure that the version of php that is running on the webserver and the other packages are compatible.  Now, as to why, both the method that I listed and the other post suggests, are both likely solutions. Composer caches information regarding the system, php and the packages that are installed for two reasons, 1. continuity.. 2. version history.  If composer modified its own cache files when external changes occurred, it would be difficult to know which packages versions were compatible with each other, and when.So, composer is not checking the php version when an update or install is occurring, it references its cache.  Apache likely greps any references to php versions that are being disabled by the user, it would find a reference in composer's cache files. My suggestion recommends that the cache be deleted for that reason.  Additionally, thetells composer to update itself, as opposed to the packages it manages ...at that point if php had been initially installed by way of yum/apt, and then upgraded by easy apache, the --ignore-platform-reqs flag will circumvent any rpm exclude functionality that may still exist, and allow the install or update of the composer packages. this is a config/env issue. Ideally you can have multiple php versions to test with, in apache you can swap versions like this:Whats happening here is when he runs php -v he is running php-cli which is configured to run in php7, but perhaps his apache has 5.5 enabled.

so In case it helps someone in the future, I ran into this problem while trying to run composer update from inside  PHPStorm (2017.2).  I tried the above suggestions, but none ofthem worked.  I have multiple versions of PHP installed (5.6, 7.0, 7.1) all added under PHPStorm settings, so I can switch based on project requirements.  Regardless of selected CLI interpreter setting, it always looks to PHP 7.0 when calling composer.  Running composer in a terminal outside of PHPStorm works without issue (references the path configured version, 7.1).  In my case, this feels like a PHPStorm bug.On my HostGator shared hosting, I was able to overcome this problem by creating Aliases in my .bashrc file for the php version I wanted to use:Remember to source after editing the .bashrc file: 'source ~/.bashrc'

Using Distinct in Laravel Fluent

Glenn Williams

[Using Distinct in Laravel Fluent](https://stackoverflow.com/questions/16298368/using-distinct-in-laravel-fluent)

I have this join:But it unsurprisingly returns duplicate records, so I try to use distinct(): but I want to use distinct() on a specific single field which I'd easily be able to do in SQL. It seems distinct() does not take parameters, i.e. I can't say distinct('volunteer.id').Can anyone point me to how can I remove my duplicate records? I bet this is another forehead slapper for me.

2013-04-30 11:06:34Z

I have this join:But it unsurprisingly returns duplicate records, so I try to use distinct(): but I want to use distinct() on a specific single field which I'd easily be able to do in SQL. It seems distinct() does not take parameters, i.e. I can't say distinct('volunteer.id').Can anyone point me to how can I remove my duplicate records? I bet this is another forehead slapper for me.In my project I tried distinct() and groupby() too and both of them worked:According to this, distinct() should work in your case too, just use it with get():Otherwise you don't need distinct() when you use groupby() so you could just use:

How to get next id of autogenerated field in laravel for specific table?

fico7489

[How to get next id of autogenerated field in laravel for specific table?](https://stackoverflow.com/questions/37210747/how-to-get-next-id-of-autogenerated-field-in-laravel-for-specific-table)

I am looking for something like :notDoes anybody know hot to achieve this ?

2016-05-13 13:00:24Z

I am looking for something like :notDoes anybody know hot to achieve this ?This work for me:

(PHP: 7.0 - Laravel 5.5)You need to execute MySQL query to get auto generated ID.In Laravel5, you can do as following.In Laravel5, you can do as following.Try this:This is the code snippet i used in laravel,witch will work perfectlythanks,In MySQL you can get auto generated id by this query.For PostgreSQL:The model:The result:

Laravel mail bcc

Ivan Dokov

[Laravel mail bcc](https://stackoverflow.com/questions/26774204/laravel-mail-bcc)

I am using the default Laravel Mail class to send emails.I am trying to add bcc to myself, but when I add a bcc the email is not send at all.

Here is my code:

2014-11-06 07:45:47Z

I am using the default Laravel Mail class to send emails.I am trying to add bcc to myself, but when I add a bcc the email is not send at all.

Here is my code:I have found the problem.

I didn't use the correct parameters for $message->bcc('mybcc@email.com');I had to write email AND name: $message->bcc('mybcc@email.com', 'My Name');

The same way as I use $message->to($toEmail, $toName);As Ivan Dokov said, you need to pass the email and name to the bcc function.

You could also shorten your code by doing this

Create model in a custom path in laravel

Saleh Ahmad Oyon

[Create model in a custom path in laravel](https://stackoverflow.com/questions/37251322/create-model-in-a-custom-path-in-laravel)

I want to create a model in a custom path. If i write the php artisan command like the following it will create model inside app.But i want to create the model file inside the custom made Models folder. How can i do it ?

2016-05-16 10:05:10Z

I want to create a model in a custom path. If i write the php artisan command like the following it will create model inside app.But i want to create the model file inside the custom made Models folder. How can i do it ?Just define the path where you want to create model. e.g.You can do it easily with custom directory of your Models Folder (I assume Models Folder is sub folder of App). 

Just use this command php artisan make:model Models/core then you will get your desire result.

Thanks.

Dynamic mail configuration with values from database [Laravel]

Saurabh

[Dynamic mail configuration with values from database [Laravel]](https://stackoverflow.com/questions/45146260/dynamic-mail-configuration-with-values-from-database-laravel)

I have created a service provider in my Laravel Application SettingsServiceProvider. This caches the settings table from the database.settings table:I am able to echo the value from the table like this:This works fine on any blade files or controllers in App\Http\ControllersProblem:I am trying to echo the value to App\config\mail.php like this:But I'm getting this error:Update:I have created a new service provider MailServiceProvider to override the settings in Mail.php like this:But still I am getting the same error!!Is there any way to override default mail configuration (in app/config/mail.php) on-the-fly (e.g. configuration is stored in database) before swiftmailer transport is created?

2017-07-17 13:58:07Z

I have created a service provider in my Laravel Application SettingsServiceProvider. This caches the settings table from the database.settings table:I am able to echo the value from the table like this:This works fine on any blade files or controllers in App\Http\ControllersProblem:I am trying to echo the value to App\config\mail.php like this:But I'm getting this error:Update:I have created a new service provider MailServiceProvider to override the settings in Mail.php like this:But still I am getting the same error!!Is there any way to override default mail configuration (in app/config/mail.php) on-the-fly (e.g. configuration is stored in database) before swiftmailer transport is created?Struggled for 3 days with this issue finally I figured out a way to solve it.First I created a table mails and populated it with my values.

Then I created a provider MailConfigServiceProvider.phpAnd then registered it in the config\app.phpMaybe its usefull to somebody, but I solved it as following;In a ServiceProvider under the boot-method;I used array_merge with the original config, so we only override the values we need to. Also we can use the Cache-facade in the boot-method.

Changing database name in Laravel/Homestead

Kapil Sharma

[Changing database name in Laravel/Homestead](https://stackoverflow.com/questions/25317370/changing-database-name-in-laravel-homestead)

I started learning Laravel just an hour ago and following tutorials.My settings for database are as follow (File: app/config/database.php):In mySQL on homestead, I already created laraveltest database. I also created migration file in database/migration directory with following code:and migration commands were:As displayed, table users created but in homestead database, not in laraveltest database. Can someone please tell where I went wrong and how to force laravel to use laraveltest database?Edit after first comment

File: bootstrap/start.php

2014-08-14 20:50:13Z

I started learning Laravel just an hour ago and following tutorials.My settings for database are as follow (File: app/config/database.php):In mySQL on homestead, I already created laraveltest database. I also created migration file in database/migration directory with following code:and migration commands were:As displayed, table users created but in homestead database, not in laraveltest database. Can someone please tell where I went wrong and how to force laravel to use laraveltest database?Edit after first comment

File: bootstrap/start.phpIt is most likely an issue with environments. Check that you have a database configuration file in app/config/local/, and check that it has the proper settings.If anyone finds this looking for the answer for Laravel 5 or later: It's the same as @camroncade says, but in this case it's your .env file in the project root you want to look at.I am currently dealing with this issue as well. Changed the .env file numerous times as well as the config.php file. Nothing seemed to work.

After having done some deep digging into the framework I have found an acceptable temporary workaround to the problem that does not conflict with ANY of Laravel 5.0.2's Exceptions.NOTE: I'm currently using Ampps 3.4 with php 7.0.2 phpmyadmin 4.4.15.1 on a Windows 8.1 OS.Inside of the file "ConnectionFactory.php" (located at "laravel\vendor\laravel\framework\src\Illuminate\Database\Connectors"),

scroll down to the public function make located at line 41.

Within this function you can do the following after this statement $config = $this->parseConfig($config, $name); which should be on line 43:This change will allow Laravel to continue with its normal process having no negative effect anywhere with the framework or your project. That is until this bug is fixed by the makers of Laravel or the community.Till then happy coding! =)

Configure and Test Laravel Task Scheduling

cyber8200

[Configure and Test Laravel Task Scheduling](https://stackoverflow.com/questions/40161679/configure-and-test-laravel-task-scheduling)

I'm trying to run a command every 1 minute using Laravel Task Scheduling.I've added this line to my cron tab file *   *   *   *   *   php artisan schedule:run >> /dev/null 2>&1Here is my /app/Console/Kernel.phpI've added this line $schedule->command('echo "Happy New Year!" ')->everyMinute();How do I test this ?How do I trigger my echo to display ? How do I know if what I did is not wrong ?  I'm opening to any suggestions at this moment.Any hints / suggestions / helps on this be will  be much appreciated !

2016-10-20 18:16:29Z

I'm trying to run a command every 1 minute using Laravel Task Scheduling.I've added this line to my cron tab file *   *   *   *   *   php artisan schedule:run >> /dev/null 2>&1Here is my /app/Console/Kernel.phpI've added this line $schedule->command('echo "Happy New Year!" ')->everyMinute();How do I test this ?How do I trigger my echo to display ? How do I know if what I did is not wrong ?  I'm opening to any suggestions at this moment.Any hints / suggestions / helps on this be will  be much appreciated !command() runs an artisan command. What you're trying to achieve - issuing a command to the OS - is done by exec('echo "Happy New Year!"')Testing depends on what you want to test:In this case, you don't have to. It is tested in the original framework code.Well, you can manually run php artisan schedule:run and see the output. The scheduler does not produce any output on default (>> /dev/null 2>&1). You can, however, redirect the output of the runned scripts to any file by chaining writeOutputTo() or appendOutputTo() (https://laravel.com/docs/5.1/scheduling#task-output).For more complex logic, write a console command instead (https://laravel.com/docs/5.1/artisan#writing-commands)  and use command() - this way you can write nice, testable code.If you want to unit test the scheduling of events you can use this example. It is based on the default inspire command:Building on Michiel's answer, I've used the methods contained in Illuminate\Console\Scheduling\Event to test if the event is due to run for a given date.I've mocked the current date using Carbon::setTestNow() so that any date based logic in the when() and skip() filters will behave as expected.

Laravel: Route::resource() GET & POST work, but PUT & DELETE throw MethodNotAllowedHttpException

mOrloff

[Laravel: Route::resource() GET & POST work, but PUT & DELETE throw MethodNotAllowedHttpException](https://stackoverflow.com/questions/27029025/laravel-routeresource-get-post-work-but-put-delete-throw-methodnotallo)

I'm writing a webservice API (in laravel 4.2).

For some reason, the routing to one of my controllers is selectively failing based on HTTP method.My routes.php looks like:So, when I try any of GET / POST / PUT / PATCH / DELETE methods for the

project.dev/v2/foo or project.dev/v2/foo/1234 urls, everything works perfectly.But, for some reason, only GET and POST work for project.dev/v2/foo/1234/bar. The other methods just throw a 405 (MethodNotAllowedHttpException).

(fyi, I am issuing requests via the Advanced Rest Client Chrome extension.)What's going on?

What am I missing?

2014-11-19 23:27:41Z

I'm writing a webservice API (in laravel 4.2).

For some reason, the routing to one of my controllers is selectively failing based on HTTP method.My routes.php looks like:So, when I try any of GET / POST / PUT / PATCH / DELETE methods for the

project.dev/v2/foo or project.dev/v2/foo/1234 urls, everything works perfectly.But, for some reason, only GET and POST work for project.dev/v2/foo/1234/bar. The other methods just throw a 405 (MethodNotAllowedHttpException).

(fyi, I am issuing requests via the Advanced Rest Client Chrome extension.)What's going on?

What am I missing?Solved!

The answer can be found by running php artisan routes.That showed me that DELETE and PUT/PATCH expect (require) a bar ID.

I happened to be neglecting that because there can only be one of this particular type of "bar". The easy fix it to simply add it to my URL's regardless, like project.dev/v2/foo/1234/bar/5678.For the ones who are using Laravel versions > 4.2  use this : This will give the list of routes set in your application. Check if routes for PUT and DELETE are allowed in your routes or not.

405 error is mostly because there is no route for these methods.I don't know about older Laravel versions. But I use Laravel since 5.2 and it is necessary to include a hidden method input when using put, patch or delete.Ex:Check https://laravel.com/docs/5.6/routing#form-method-spoofingJust add a hidden input field to your formAnd keep form method as post

Laravel 5 Force Download a pdf File [closed]

Ahmed Badawy

[Laravel 5 Force Download a pdf File [closed]](https://stackoverflow.com/questions/28465434/laravel-5-force-download-a-pdf-file)

Edited 

i want to Force Download a pdf File in laravel 5. 

in laravel 4 i used the following code: but in laravel 5 that doesn't work.it comes out with this error:also i tried this:same error apeared...

what can i do to force a download in laravel 5.it was a server thing. thanks any way.

you just enable this extension: php_fileinfo.dll in the php.ini file. 

then restart the server.

2015-02-11 22:05:03Z

Edited 

i want to Force Download a pdf File in laravel 5. 

in laravel 4 i used the following code: but in laravel 5 that doesn't work.it comes out with this error:also i tried this:same error apeared...

what can i do to force a download in laravel 5.it was a server thing. thanks any way.

you just enable this extension: php_fileinfo.dll in the php.ini file. 

then restart the server.Remove the headers, they're not necessary. In L5, you can do Please read the docs.

Composer & composer.lock in GIT and merge conflicts

cenob8

[Composer & composer.lock in GIT and merge conflicts](https://stackoverflow.com/questions/25728847/composer-composer-lock-in-git-and-merge-conflicts)

Here's our situation :We have 3 different Laravel projects and all 3 projects rely on our Core project.

This Core project is a separate Laravel package hosted on our private repo and is used as a dependency for other projects.Before, whenever something would change in the Core project we woud just run a composer update ourvendor/ourcorepackage on our servers for each project to pull in the core changes. However as of lately composer seems to suffer from serious memory issues when we try to run the update on our Digital Ocean staging environment with 512 MB Ram. See : https://github.com/composer/composer/issues/1898The solution I always come across is people saying that you should always run composer install on your production servers. I can relate to that in terms of security because it can be dangerous if you update to a new version of some 3rd party package that can possibly break your code. But in our case we only update our own core package so we know what we're doing but this memory issue forces us to use the composer install method because it is less memory demanding.So basically this is our current workflow :However this solution raises 2 issues :So what am I supposed to do here? Before the pull on the server remove the composer.lock file?

How should we handle the merge conflicts for the composer.lock file?It's a shame that composer update suffers from memory issues because that method seems much more logical. Just update the package you want and no hassle with the composer.lock file..Please advice how a correct workflow with GIT and composer should be in our case and how to solve the conflicts above ?Many thanks for your input

2014-09-08 16:27:54Z

Here's our situation :We have 3 different Laravel projects and all 3 projects rely on our Core project.

This Core project is a separate Laravel package hosted on our private repo and is used as a dependency for other projects.Before, whenever something would change in the Core project we woud just run a composer update ourvendor/ourcorepackage on our servers for each project to pull in the core changes. However as of lately composer seems to suffer from serious memory issues when we try to run the update on our Digital Ocean staging environment with 512 MB Ram. See : https://github.com/composer/composer/issues/1898The solution I always come across is people saying that you should always run composer install on your production servers. I can relate to that in terms of security because it can be dangerous if you update to a new version of some 3rd party package that can possibly break your code. But in our case we only update our own core package so we know what we're doing but this memory issue forces us to use the composer install method because it is less memory demanding.So basically this is our current workflow :However this solution raises 2 issues :So what am I supposed to do here? Before the pull on the server remove the composer.lock file?

How should we handle the merge conflicts for the composer.lock file?It's a shame that composer update suffers from memory issues because that method seems much more logical. Just update the package you want and no hassle with the composer.lock file..Please advice how a correct workflow with GIT and composer should be in our case and how to solve the conflicts above ?Many thanks for your inputHow can you test that a core update (or any other dependency that gets updated) doesn't break things in the projects using it if the developer don't do this step themselves?That's why the usual workflow is expecting the composer update being run on a development machine having enough RAM (i.e. probably more than 1GB set as memory limit for PHP), and the update should be triggered manually by the developer (and if triggered automatically by a continuous integration build, the memory requirements apply to this machine as well).There is no way around this memory requirement. A web server with only 512 MB RAM installed might be able to function as a staging server with barely any concurrent users present, but it shouldn't be used to update the Composer dependencies.Personally I fix the merge conflicts in the composer.lock with a very easy system: Delete the lock file and run composer update. This will update all dependencies to the latest versions that satisfy the version requirements, and create a new working composer.lock file that get's committed during the merge.I am not afraid to potentially update everything, because either it works as expected, or my tests will catch errors quickly. I do select the 3rd party packages I use carefully:This works with around 270 packages served by our local Satis instance (probably also a factor to consider when trying to reduce memory footprint - only the packages known to Composer can end up in memory: Compare the ten thousand packages potentially available on packagist.org with 270 local packages). 60 packages of the 270 are locally developed by 20 developers, and randomly releasing new versions. The update failures in the last 2 years are very rare, and should be handled like other bugs: If a tagged version is detected to be incompatible, we release a bugfix release reverting the change, and tag the original change with a new major release, if the incompatible change is necessary.So the workflow you ask for is probably like this:Merging an already committed version on another developers machine will likely show merge conflicts with composer.lock.Another approach (without doing composer update):This method will keep locks from remote branch (maybe master or develop branches), and only updates your new packages.

Laravel Input::hasFile('image') returns false even if a File is uploaded

jrenk

[Laravel Input::hasFile('image') returns false even if a File is uploaded](https://stackoverflow.com/questions/25929197/laravel-inputhasfileimage-returns-false-even-if-a-file-is-uploaded)

I have a Form field for an Image upload, which I open with 'files' => true, like so:And in my Controller I want to check if a File was uploaded and do something with it:But Input::hasFile always returns false and I don't know why.

results in:I have tested around with another picture for another User and this works fine. I don't get why this is working for some Users and for some others not.

Is there maybe some kind of Pictures that are not accepted?What other sources could be the cause of this problem?

2014-09-19 08:07:09Z

I have a Form field for an Image upload, which I open with 'files' => true, like so:And in my Controller I want to check if a File was uploaded and do something with it:But Input::hasFile always returns false and I don't know why.

results in:I have tested around with another picture for another User and this works fine. I don't get why this is working for some Users and for some others not.

Is there maybe some kind of Pictures that are not accepted?What other sources could be the cause of this problem?I solved what was wrong.

The code is fine, but the problem was some pictures were simply to big.

EDIT:

As Don't Panic pointed out, editing upload_max_filesize can solve the problem.How do you open your form? If you want your form to accept files you need so open it like this:Opening a form in the Laravel DocsI had the same problem, I checked my code and noticed that I had not the enctype="multipart/form-data" header in the form, hope that this big neglect help anyone 

Laravel : Setting dynamic routes based on access control list

user254153

[Laravel : Setting dynamic routes based on access control list](https://stackoverflow.com/questions/48758552/laravel-setting-dynamic-routes-based-on-access-control-list)

I am building REST API with JWT authentication and authorization with own logic. It's working perfectly. Now, I want to set the routes dynamically based on roles and permission. Suppose I have database structure like:Role:Permissions:Permission_roleNow, I want to create routes according to roles and permission in database.Currently my routes seems like:I don't want above routes to be hard coded. How can I get this routes from database. Something like below. But couldnot get idea how to do it.In routes file,Thank you.

2018-02-13 02:27:55Z

I am building REST API with JWT authentication and authorization with own logic. It's working perfectly. Now, I want to set the routes dynamically based on roles and permission. Suppose I have database structure like:Role:Permissions:Permission_roleNow, I want to create routes according to roles and permission in database.Currently my routes seems like:I don't want above routes to be hard coded. How can I get this routes from database. Something like below. But couldnot get idea how to do it.In routes file,Thank you.The best idea was using middleware parameter

create Middleware call CheckPermission then you have to register that middleware into your app/Http/kernel.php file thats only you need check below codeYour kernel.php fileCheckPermission.phpYour Route fileSo what you can do is make your role name accountants a value to key in the .env file and same for each and every role name.In case you want to change it in near future you can change it manually in the .env file or you can make changes in the .env file via php code writtern on one of your Laravel function.While I doubt that this is the best approach to this, but in your way of thinking you could try out this "pseudo code". I hope this expresses the basic idea. What that implies is:I'm not totally sure if you can load your middleware dynamically like this. If so, this could be a valid approach for this.In your routes.phpAdd this route at the end of all your routes.Now create a new controller called AccessController and add the below constructor and method to it.

Assuming user has a relationship with roles.Overall it is retrieving the URL and comparing it against available routes in the authenticated user's permissions. If the authenticated user has the permission which the route belongs to, Then adding appropriate middleware.Finally the redirectURI method is calling the appropriate controller method and returning the response.Remember to replace the code with appropriate namespace and relations where ever necessary. 

Laravel: Pass Parameter to Relationship Function?

user2840318

[Laravel: Pass Parameter to Relationship Function?](https://stackoverflow.com/questions/23016216/laravel-pass-parameter-to-relationship-function)

Is it possible to pass, somehow, a parameter to a relationship function?I have currently the following:The problem is that, in some cases, it does not fetch the unlocked_at column and it returns an error.I have tried to do something like:And call it as:But this does not work. Is there a way to pass parameters into that function or any way to check if the pivot_unlocked_at is being used?

2014-04-11 15:04:37Z

Is it possible to pass, somehow, a parameter to a relationship function?I have currently the following:The problem is that, in some cases, it does not fetch the unlocked_at column and it returns an error.I have tried to do something like:And call it as:But this does not work. Is there a way to pass parameters into that function or any way to check if the pivot_unlocked_at is being used?Well what I've did was just adding new attribute to my model and then add the my condition to that attirbute,simply did this.You can do more simple, and secure:When you call the relation function with the parentesis Laravel will return just the query, you will need to add the get() or first() to retrieve the resultsAnd then you can call it like:Works for the latest version of Laravel.You can simply create a scope and then when necessary add it to a builder instance.Example:User.phpAchievement.phpthen when using:You can read more about scopes at Eloquent documentation.

How to unlock the file after AWS S3 Helper uploading file?

cytsunny

[How to unlock the file after AWS S3 Helper uploading file?](https://stackoverflow.com/questions/41395252/how-to-unlock-the-file-after-aws-s3-helper-uploading-file)

I am using the official PHP SDK with the official service provider for laravel to upload an image to Amazon S3. The image is temporarily stored on my server and should be deleted after uploading. The following is the code I used to do my upload and delete.The upload is successful. I can see my image with the link return, and I can see it on the amazon console. The problem is that the delete fails, with the following error message:I am sure my file permission setting is correct, and I am able to delete my file with the section of code for uploading to S3 comment out. So it should be the problem that the file is locked during uploading the file. Is there a way I can unlock and delete my file?

2016-12-30 11:07:00Z

I am using the official PHP SDK with the official service provider for laravel to upload an image to Amazon S3. The image is temporarily stored on my server and should be deleted after uploading. The following is the code I used to do my upload and delete.The upload is successful. I can see my image with the link return, and I can see it on the amazon console. The problem is that the delete fails, with the following error message:I am sure my file permission setting is correct, and I am able to delete my file with the section of code for uploading to S3 comment out. So it should be the problem that the file is locked during uploading the file. Is there a way I can unlock and delete my file?Yes the stream upload locks the file till it finishes, Try either of 2,orWhen you're using SourceFile option at putObject S3Client opens a file, but doesn't close it after operation.In most cases you just can unset $client and/or $result to close opened files.

But unfortunately not in this case.Use Body option instead of the SourceFile.EDIT: I just noticed the string in your $temp_path begins with a "/" slash character. This beginning slash typically starts at the root directory of the website, are you sure this is the correct location? Use the getcwd() command in PHP to find out what folder PHP thinks it is inside of.I understand you believe the permissions are correct but in light of the "Permission denied" error I still believe it is telling you something relevant.I see you are trying to chown the directory, did you perhaps mean to chmod it? If you can SSH to your server and run this command you may have more luck:Or even try changing the "chown" to "chmod" in your PHP code.I'm not a PHP guy, but I'd try popping that bad boy into a stream and then passing the stream to the SDK.That way, you can explicitly close the stream and then delete the temp file.  You may even be able to eliminate the temporary file altogether and deal solely with streams, if that's allowed by your specific use-case.Looks like this SO post might set you on the right track.

What is the differences between updateOrCreate() and updateOrInsert() in Laravel

Daniel

[What is the differences between updateOrCreate() and updateOrInsert() in Laravel](https://stackoverflow.com/questions/44407210/what-is-the-differences-between-updateorcreate-and-updateorinsert-in-laravel)

Both methods seem to create a new record if not existed or update a record with provided data. Whats the difference between the two?

2017-06-07 08:18:14Z

Both methods seem to create a new record if not existed or update a record with provided data. Whats the difference between the two?updateOrCreate is method of Eloquent Builder and updateOrInsert is method of Query Builder.updateOrCreate returns model, whereas updateOrInsert returns booleanSignatures from Laravel code:updateOrCreateupdateOrInsert

「Access denied for user ''@'localhost' to database 'forge」appears randomly

cre8

[「Access denied for user ''@'localhost' to database 'forge」appears randomly](https://stackoverflow.com/questions/35187814/access-denied-for-user-localhost-to-database-forge-appears-randomly)

I have a search function for my database but sometimes I get this message:In one of ten calls I get this 500 error message, but I don't know why. The other calls give the right result..envSearch function:database.phpI haven't modified the database.php file and all other calls work great.

2016-02-03 21:12:38Z

I have a search function for my database but sometimes I get this message:In one of ten calls I get this 500 error message, but I don't know why. The other calls give the right result..envSearch function:database.phpI haven't modified the database.php file and all other calls work great.PLEASE RUN THIS COMMANDTHEN This seems to hold most of the answers : Laravel 5.2 not reading env fileRemember to not to edit your core files as one of the users said.

Just do the safe checks, clear cache, should work.Hope it helps.As a workaround you can add to your DB forge account with all privileges.Try php artisan clear:cache to clear your cache and re-configure your cache php artisan config:cache it might works for you . I had the same issue once. what I discovered was that my default connection was set to PostgreSQL instead of MySQL so I changed my  default connection in database.phpother wise do add following to your .envtry adding remaining methods in your .env file

How to send data from client to redis and then after to laravel

Mr. Engineer

[How to send data from client to redis and then after to laravel](https://stackoverflow.com/questions/46527342/how-to-send-data-from-client-to-redis-and-then-after-to-laravel)

I'm using laravel and redis for real time chat. I can fire event from my laravel and receiving that data to client side. My problem is how can i send something from client and then receive it to redis and pass it to laravelE.g How can i check if user has read the chat message.Code : Note : I'm emitting data from IOS app. 

2017-10-02 14:16:44Z

I'm using laravel and redis for real time chat. I can fire event from my laravel and receiving that data to client side. My problem is how can i send something from client and then receive it to redis and pass it to laravelE.g How can i check if user has read the chat message.Code : Note : I'm emitting data from IOS app. Redis is a key/value store engine.  You should treat it like a database.A client sends a request to a webserver that receives this request and decides what to do with it.  For requests that require server-side processing, it will pass that request to a server-side "engine" for processing, in your case, probably PHP-FPM, which then passes it to a PHP daemon that will then execute the request.Redis is not able to interpret a request in this manner.  Therefore, you must intercept the request with Laravel and then send it to Redis.  Not the other way around.If you're trying to have Laravel get the information from Redis, you'll want to use Redis' pub/sub feature.  Then you can have Laravel subscribe to Redis updates, get the updates and persist or handle the data however you want.The phpredis lib supports the pub/sub functionality.Here is an example of the PHP implementation with that lib.

https://xmeng.wordpress.com/2011/11/14/pubsub-in-redis-using-php/You can leverage Broadcasting in Laravel for the same. Also you can broadcast between multiple clients using whisper. Also there is a redis based broadcaster in it.First you need to include its package in composer.Configure the credentials in app/broadcasting.phpYou need to configure broadcasting queue as well.Sending BroadcastReceiving BroadcastInstantiate socket ID for echo [included in header as X-Socket-ID]Make sure you have echo installedCreate echo instanceListening eventsBroadcast an event to other connected clients without hitting your Laravel application at allLaravel Broadcast DocumentationI think this tutorial is what you want:Laravel 5 and Socket.io Tutorialit contains tutorial for client side and server sideyou could use: Socket.IO-Client-Swiftcheck this also: Socket.IO on iOS

Laravel scheduler not working as expected

twister_void

[Laravel scheduler not working as expected](https://stackoverflow.com/questions/54864558/laravel-scheduler-not-working-as-expected)

I build an application in laravel which suppose to fetch news using webhose.io every 4 hours for all country . It seems to work fine for sometime . But stops and restart again after sometime . I don't know how to track what is going wrong . Laravel Version Laravel Framework 5.5.45Ubuntu 16.04.5 LTS (GNU/Linux 4.4.0-142-generic x86_64)CRON Job details Kernel.phpLaravel Logs for Jobs 

Recent logs ( Which is working fine ) Log for CRON JobLOG for CRON from System logEdit : Added withoutoverlapping() Logs with time 

I found news update task is running every 4 hours but getting intreputted by other task . Logs with timeLaravel Recent Log where you can see inconsistency . Incomplete task is being done if you compare with complete task from above.

2019-02-25 10:51:53Z

I build an application in laravel which suppose to fetch news using webhose.io every 4 hours for all country . It seems to work fine for sometime . But stops and restart again after sometime . I don't know how to track what is going wrong . Laravel Version Laravel Framework 5.5.45Ubuntu 16.04.5 LTS (GNU/Linux 4.4.0-142-generic x86_64)CRON Job details Kernel.phpLaravel Logs for Jobs 

Recent logs ( Which is working fine ) Log for CRON JobLOG for CRON from System logEdit : Added withoutoverlapping() Logs with time 

I found news update task is running every 4 hours but getting intreputted by other task . Logs with timeLaravel Recent Log where you can see inconsistency . Incomplete task is being done if you compare with complete task from above.In Simple Terms 

When the CRON daemon calls the php artisan schedule:run command every minute, the Console Kernel will be booted up and the jobs you defined inside your App\Console\Kernel::schedule() method will be registered into the scheduler.The schedule() method takes an instance of Illuminate\Console\Scheduling\Schedule as the only argument, this is the schedule manager used to record the jobs you give it and decides what should run every time the CRON daemon pings it.Now moving towards your issue . as @hoseinz3 Mentioned is almost right How Laravel prevents your scheduled jobs from overlapping ?Sometimes a scheduled job takes more time to run than what we initially expected, and this causes another instance of the job to start while the first one is not done yet, for example imagine that we run a job that generates a report every minute, after sometime when the data gets huge the report generation might take more than 1 minute so another instance of that job starts while the first is still ongoing.In most scenarios this is fine, but sometimes this should be prevented in order to guarantee correct data or prevent a high server resources consumption .Laravel will check for the Console\Scheduling\Event::withoutOverlapping class property and if it's set to true it'll try to create a mutex for the job, and will only run the job if creating a mutex was possible.For more on MutexSo Laravel creates a mutex when the job starts the very first time, and then every time the job runs it checks if the mutex exists and only runs the job if it doesn't.So Laravel creates a filter-callback method that instructs the Schedule Manager to ignore the task if a mutex still exists, it also creates an after-callback that clears the mutex after an instance of the task is done.Try this snippet  Try some kind of CRON Job Monitoring system . 

You can Try Eyewitness which is very good tool to monitor Laravel Application .You have used withoutOverlapping method, based on  Laravel documentation that means when one job took longs time to run Laravel Hold new job for 24 hours by default, and after that, it tries to run that job if no job would running, and you could also change this number by passing through withoutOverlapping argument. for exampleIt means Laravel hold new command for 5 hours if there is running command after that it will try to run this again.Laravel run cron jobs synchronously, so some tasks can block other.Since cron start each minute all scheduled tasks will be started normally with few minutes delay between it without blocking each other.or

Laravel 5 / Codeception not routing correctly

delatbabel

[Laravel 5 / Codeception not routing correctly](https://stackoverflow.com/questions/29529440/laravel-5-codeception-not-routing-correctly)

I'm trying to write an API test case for a controller function using codeception, and I'm hitting an issue where the route to the controller function does not appear to be evaluated correctly, and the evaluation seems to be different depending on what I have in my test case.Here is a code sample from my test case:I have a routes.php file containing these routes:I have inserted some debug statements into my controller classes so that I can see what routes get run, like this:At the moment I have stripped down everything from my controller classes so that ONLY the debug statements are included.When I run the test case as above, I get the following debug output:... so it appears that sendPOST('register', ...) actually routes to the GET route for "/" instead of the POST route for "/register".  Outside of the test case everything works normally -- I can POST to the register routes fine, routing appears to work OK, the problem only appears inside a codeception test case.If I change the test case so that I am doing the sendGET and the sendPOST inside the same function call, for example like this:then I see this debug output:... so that by inserting the sendGET into the same function as the sendPOST, it has changed the sendPOST behaviour so that it now routes to the GET route for register instead of the GET route for index (but still won't route to the correct POST route).I have tried turning xdebug on and don't have any clues from the xdebug output as to what's going on either.

2015-04-09 03:54:00Z

I'm trying to write an API test case for a controller function using codeception, and I'm hitting an issue where the route to the controller function does not appear to be evaluated correctly, and the evaluation seems to be different depending on what I have in my test case.Here is a code sample from my test case:I have a routes.php file containing these routes:I have inserted some debug statements into my controller classes so that I can see what routes get run, like this:At the moment I have stripped down everything from my controller classes so that ONLY the debug statements are included.When I run the test case as above, I get the following debug output:... so it appears that sendPOST('register', ...) actually routes to the GET route for "/" instead of the POST route for "/register".  Outside of the test case everything works normally -- I can POST to the register routes fine, routing appears to work OK, the problem only appears inside a codeception test case.If I change the test case so that I am doing the sendGET and the sendPOST inside the same function call, for example like this:then I see this debug output:... so that by inserting the sendGET into the same function as the sendPOST, it has changed the sendPOST behaviour so that it now routes to the GET route for register instead of the GET route for index (but still won't route to the correct POST route).I have tried turning xdebug on and don't have any clues from the xdebug output as to what's going on either.I think I found the answer after a lot of command line debugging (using phpstorm):The POST register route handling function in the controller was declared like this:... requiring an instance of Request to be passed in via dependency injection.  That request contained some validation code and if for some reason the validation code could not complete (e.g. throws an exception) then the controller function never gets called -- because building the request fails.This, in browser-land, throws a 500 error but in codeception land the exception is trapped differently and it returns a redirect to / with no data.  This all happens outside of the controller function rather than inside it, so that the Log statement in the controller function never runs because the function never gets called.  The exception handler in codeception is a generic trap.The implicit suggestion is that maybe dependency injections in controllers are a bad idea.  Or, maybe, that generic exception handlers are a bad idea.

implement DDD in MVC Frameworks - PHP

Susantha7

[implement DDD in MVC Frameworks - PHP](https://stackoverflow.com/questions/42803820/implement-ddd-in-mvc-frameworks-php)

in mvc the model is a layer and it's contain all the domain business logic.

in domain driven design business logic can be divide into various building blocks like.in Domain Driven Design domain model is.developer has read Domain Driven Design, or is using Doctrine2 or Hibernate,

usually have a better focus on the domain model in DDD.in mvc frameworks model layer is overlap with domain model in DDD.it  means we can implement domain model in model folder in mvc frameworkssuch a implementations is shown below.shows how model folder is structure

2017-03-15 07:49:18Z

in mvc the model is a layer and it's contain all the domain business logic.

in domain driven design business logic can be divide into various building blocks like.in Domain Driven Design domain model is.developer has read Domain Driven Design, or is using Doctrine2 or Hibernate,

usually have a better focus on the domain model in DDD.in mvc frameworks model layer is overlap with domain model in DDD.it  means we can implement domain model in model folder in mvc frameworkssuch a implementations is shown below.shows how model folder is structureI doubt MVC pattern itself declares something special about the Domain. It operates model as a bag of properties and doesn't care how it was created and how it guards its invariants.At the same time Onion architecture states that it's important to isolate Domain out of Application Service (which MVC Framework is). So I like to place Domain layer which contains Entities, Value objects, Domain events and Aggregates to a separate module or a top-level folder. One more reason for placing Domain separately from MVC stuff is that it will allow you easier manage multiple bounded contexts, because each context needs its own module/folder.I sugget you to check out this ASP MVC project structure. It was designed by well-known DDD expert. Besides domain, please take a look at how MVC part is organized. It exploits feature slice approach which is getting more and more popular these days and I find it extremely useful.Although I'm quite new to the world of DDD, in the process of gradually migrating an application I was working on to a more DDD-oriented structure I also confronted the question of directory structure.  Piecing together the information I was able to find which wasn't entirely conceptual I came up with the following simplified directory structure, (which exists within a CRUD-oriented Laravel application), that has served me well enough:Addressing your specific concerns, repository interfaces and entities were placed within Domain folders underneath each separable component of the application (e.g. - User).  Additionally, this is where I placed any Domain events and exceptions.  Repository implementations were placed under each Infrastructure folder.  Application services are placed within a Services directory under Application directories.Leaving aside the hybrid nature of my own application (I'm using ORM-reliant DAO's/Entities, transaction scripts, and avoiding Value Objects just to name a few diversions), this may still help serve as a rough idea of a potential DDD directory structure within an MVC app.I am agree with @Zharro's suggestion.Good structure is like below:1) View part access only CoreBundle and does not change behaviour of database.2) Core part access BuisnessLogic and Entity3) BuisnessLogic part access only Entity4) Entity part access only database.I would consider the Model in MVC to be a combination of ViewModels and Commands. Incoming requests are mapped to commands that would get dispatched to a "write" layer that retrieves the appropriate aggregate and calls the appropriate method on it, then commits the transaction.ViewModels exist solely to carry data in a presentation-ready format for the user interface. You can have a very simple "read" layer that queries database views or tables and returns the results to the client. This will allow you to have a domain model that does not expose all of its state via getters and setters.Your first assumption is not correct, MVC does not really fit with DDD, a better approach would be to use the CQRS pattern.Your second assumption is also not correct, buildings blocks are not all in the domain model folder, actually, here is a good structure for your project:That way you can keep a pseudo MVC, but with the difference that View and Controller are in Interfaces package, and the Rich Model is in the domain/model package. You can only manipulate the model through Application services, and querying the model through Query services. Query services provides you fast access to model representation, and commands are sent to Application services to behave as controllers.Note the CommentAuthor class could be a Value Object, not containing the user ID of database but a unique username. Since the User aggregate root is from another package: which makes sense from a domain PointOfView. We could call it an identity (or username). This would be ideally mapped to a unique column of the User table, but would be an indexed value of the Comment table.Another option would be to use the User in the Blog package as part of the same concept which is a blog but DDD does not recommend this approach. Actually it would recommand you to put the Identity and Access in a separate bounded context, but I guess in the context of the application you are writing mapping the user as part of a Comment could be ok.In the infrastructure layer, you define your persistence provider, that way, the day you want to switch to Doctrine, only the implementation in this package must change.The application layer is responsible to manage security, span transactionnal context, and log high level events.I can provide you more insight about the inners of classes if you need some clarification. Also this might requires some infrastructure or a support framework to get it working, i'm thinking at:

PHP AWS ElastiCache Connection Failure

whobutsb

[PHP AWS ElastiCache Connection Failure](https://stackoverflow.com/questions/37306112/php-aws-elasticache-connection-failure)

Recently I just started using AWS ElastiCache for a Laravel application.  The application is running on 2 instances behind a ELB and handles about 6-10 request/second.  Everything was going fine when I launched the application but then I started to receiving connection errors to the application with high latency and timeouts.  The error messages was as follows: For my setup I'am using: To solve my issue for the time being I have installed memcached on a separate EC2 instance and have had no issues.  My question is, do I need to use AWS ElastiCache PHP Client instead of the php5-memcached to use Elasticache? I was under the impression that Elasticache was a drop in replacement for Memcached and could be used with out a problem. Thank you for the help!

2016-05-18 17:09:59Z

Recently I just started using AWS ElastiCache for a Laravel application.  The application is running on 2 instances behind a ELB and handles about 6-10 request/second.  Everything was going fine when I launched the application but then I started to receiving connection errors to the application with high latency and timeouts.  The error messages was as follows: For my setup I'am using: To solve my issue for the time being I have installed memcached on a separate EC2 instance and have had no issues.  My question is, do I need to use AWS ElastiCache PHP Client instead of the php5-memcached to use Elasticache? I was under the impression that Elasticache was a drop in replacement for Memcached and could be used with out a problem. Thank you for the help!Check what your security group settings are and set them to 0.0.0.0/32(not secure - open to everyone but a good way to test) then if that works just set it to your public ip address which you can find here https://www.whatismyip.com/what-is-my-public-ip-address/.

Trying to avoid Duplicate User's Session Records in Session Table: Laravel

Pankaj

[Trying to avoid Duplicate User's Session Records in Session Table: Laravel](https://stackoverflow.com/questions/38969510/trying-to-avoid-duplicate-users-session-records-in-session-table-laravel)

Sample data in this table looks like below: There are multiple duplicate User's Session records present in the table.In the above file path, we have below methodIt checks for Session ID.QuestionCan I avoid creation of duplicate User Session Records in Session Table? Is there any flag that do so in Session Config file? 

2016-08-16 08:00:24Z

Sample data in this table looks like below: There are multiple duplicate User's Session records present in the table.In the above file path, we have below methodIt checks for Session ID.QuestionCan I avoid creation of duplicate User Session Records in Session Table? Is there any flag that do so in Session Config file? It seems to be an error in your traitement, must be like this no ? :From your question, you want only leave one user session in database, which means one user can only login from one device, example if you already logined from chrome , then if you login from firefox, your chrome login status will be removed.To acheive this you can write a function in App\Http\Controllers\Auth\AuthController:this function will destory prvious session from database before login.

for more info you should check Trait :Illuminate\Foundation\Auth\AuthenticatesUsers

Laravel Model Factory without connection to database

user1292810

[Laravel Model Factory without connection to database](https://stackoverflow.com/questions/38882594/laravel-model-factory-without-connection-to-database)

I would like to use Laravel's Model Factory in some PHPUnit tests. The only thing I want to do is make a Model instance without saving it to database.Why the Model Factory needs connection to database? These tests must pass on CI environment without configured database.When I create Model manually by new App\Model($dataArray), tests pass and the connection is not needed.I am using Model Factory in other places, so I would like to reuse it in that tests, to avoid code duplication.I am using MongoDB and jenssegers/laravel-mongodb library, but I am guessing that it has no matter - in pure Eloquent and e.g. MySQL database, the issue would be the same.Test that works without database:My Model FactoryTest that needs database connection:Full stack trace:

2016-08-10 20:06:49Z

I would like to use Laravel's Model Factory in some PHPUnit tests. The only thing I want to do is make a Model instance without saving it to database.Why the Model Factory needs connection to database? These tests must pass on CI environment without configured database.When I create Model manually by new App\Model($dataArray), tests pass and the connection is not needed.I am using Model Factory in other places, so I would like to reuse it in that tests, to avoid code duplication.I am using MongoDB and jenssegers/laravel-mongodb library, but I am guessing that it has no matter - in pure Eloquent and e.g. MySQL database, the issue would be the same.Test that works without database:My Model FactoryTest that needs database connection:Full stack trace:I don't think this is currently possible. The make() method calls newModelInstance() which tries to set a database connection.You can review the source code yourself.Do you try using DatabaseTransactions?For exampleI normally go for creating a similar test DB and run all the tests on that DB. It ensures that your test DB type is same as production and you don't touch the production DB for running the tests.

Randomly appearing gzip headers

Kristoffer Sall-Storgaard

[Randomly appearing gzip headers](https://stackoverflow.com/questions/21547936/randomly-appearing-gzip-headers)

I have a long running script in a shared hosting environment that outputs a bunch of XMLSometimes (only sometimes) a random GZIP header will appear in my output, and the output will be terminated.For instanceor orThe switch to GZIP does not seem to hit at any particular time og byte count, it can be after 1MB of data or after 15MBThe compiled blade template at the corresponding lines are as follows--I am at my wits end, I have tried the following:When I visit other pages, no gzip encoding or headers appear, so I'm thinking this is something with the output size or output buffer.

2014-02-04 09:00:38Z

I have a long running script in a shared hosting environment that outputs a bunch of XMLSometimes (only sometimes) a random GZIP header will appear in my output, and the output will be terminated.For instanceor orThe switch to GZIP does not seem to hit at any particular time og byte count, it can be after 1MB of data or after 15MBThe compiled blade template at the corresponding lines are as follows--I am at my wits end, I have tried the following:When I visit other pages, no gzip encoding or headers appear, so I'm thinking this is something with the output size or output buffer.Did you finally find out where these headers come from? I mean apache or php?You can simulate xml generator scipt with something like: If you won't see any headers, I suggest to debug your xml generator. You can try to call header_remove(); before output. If you see headers, you have to debug your web server. Try to disable gzip in apache by rewrite rule: Whenever you have any proxy or balancer (nginx, squid, haproxy) you automaticly get one more firing line.your gziping is not related to server output that returns your main xml body. Otherwise the whole xml would be compressed.These methods return GZIP sometimes because the source where these take the items is set to support gzip and are not asked properly.Look inside these. 

- Check web calls for all places where headers are set.

-  temporally disable compression for database connection if any.Add CDATA tags for all places where binary data could be returned to avoid main xml body building termination. Wait for an xml with bin data, Save bin data, unzip it and look what is inside. :-)This is more of a set of comments, but it is too long for the comment box.First, this very likely NOT an output buffer issue. Even though <![CDATA[ and  ]]> is not within PHP tags this doesn't mean that it doesn't pass through PHP's output buffer. To be clear, anything within a .php file will be placed in the PHP output buffer. The content within a .php file (including static content) is buffered outside of Apache and then passed back to Apache through this buffer when the script is finished. This means that your problem must lie within the code itself, which is a shot in the dark to solve without viewing the code.My suggestions:1) do a search within the script to find any instances of gz functions (gzcompress, gzdeflate, gzdecode, etc). I have seen scripts compress content if it was greater than a specific size and then decompress the content on the fly when taken from the DB. If that is the case you are likely dealing with a faulty comparison operation. In short, the logic within compression and decompression conditions is slightly off so it is failing to decompress SOME of the content.2) do a search within the script to see how this data is fetched. Is it all from a database? Does any of it come from a stream? Is any of it fetched remotely? These questions might not directly lead to an answer but are vital. It can safely be assumed that these variables are being set with data already compressed when it shouldn't be. It requires knowing where/why/how the compression is taking place in order to answer why it is not being decompressed.3) It matters greatly that it is working as expected on one system but not the other. The only times I have seen this happen was always due to differences in configuration. What operating system was your local machine using? What's the difference in local database (if any), what extensions might be missing/present on one or the other, possibly causing a function to fall back on different procedure on the two different machines.EDIT:

Also, and this is a small chance, but are you dealing with data that originated from an SQL dump from a different server? You said it works on your local host but not on a different host, so we know your dealing with two machines. Was there a third at some point? If so, it might have been compressed using a mismatched version/form of compression, or might be an issue with encoding.

Laravel: Working a large number of tasks into a queue

haakym

[Laravel: Working a large number of tasks into a queue](https://stackoverflow.com/questions/35648386/laravel-working-a-large-number-of-tasks-into-a-queue)

I'm building a web application using Laravel 5 that creates links to the web application that when visited show a form for a student's progress report. These links are sent by the web application to an email of a contact at the institution the student attends in order for the recipient to complete the progress report accessed by the link in the email.The problem I face is when creating and sending links. I have some code which works fine with a couple of hundred students, however in real world use the application would be potentially creating and sending 3000+ or so links at one time. The code I've written simply can't handle such a large number in a timely manner and the application crashes. Strangely enough though I don't receive any timeout error via laravel (I'll need to double check the php logs).Although I'm more than welcome to other suggestions, I believe the answer to the problem is utilising queues. I have already used queues when sending email (see code), but I would like to work some other parts of the code into queues, but I'm a bit unsure how to do this!Brief database schemaStudent hasMany LinkStudent hasMany InstitutionContact (limited to two by my application)Link hasMany InstitutionContact (limited to two by my application)Email manyToMany LinkWhat I am trying to accomplishSo the main challenge I'm facing is performing the aforementioned task with a large dataset. I have already considered creating and sending a Link one by one via a queue, however this wouldn't allow me to group all the Links together by contact/email. As the task wouldn't be performed regularly I would be open to consider performing the task as it is with an increase in memory and time for the process, however I didn't have much success when attempting this using set_time_limit(0); and ini_set('memory_limit','1056M'); before sending any links.Any help would be really appreciated, thank you if you read this far!Codeapp\Http\Controllers\LinkController.phpapp\Models\Link.phpapp\Emails\LinkEmailer.php

Edit 1I've got this working now with set_time_limit(0); and ini_set('memory_limit','1056M'); it took 8 mins to do 3000 students. Edit 2I'm running Laravel Framework version 5.1.6 (LTS), MySQL for DB.Edit 3Appreciate all the answers so far, thank you all. I am thinking that I may work the link creation process into a queue which will have a related entity in the database called something like Batch and when that Batch of links has finished being created then group all the Links from that Batch and send them.I could use the approach that @denis-mysenko suggested by having a sent_at field in the Links table and have a scheduled process to check for Links that haven't been sent and then send them. However, using the aforementioned approach I can send the Batch of Links when they've all finished being created, whereas with the sent_at approach with a scheduled process looking for Links that haven't been sent it could potentially send some links when all the links haven't been created yet.

2016-02-26 09:51:14Z

I'm building a web application using Laravel 5 that creates links to the web application that when visited show a form for a student's progress report. These links are sent by the web application to an email of a contact at the institution the student attends in order for the recipient to complete the progress report accessed by the link in the email.The problem I face is when creating and sending links. I have some code which works fine with a couple of hundred students, however in real world use the application would be potentially creating and sending 3000+ or so links at one time. The code I've written simply can't handle such a large number in a timely manner and the application crashes. Strangely enough though I don't receive any timeout error via laravel (I'll need to double check the php logs).Although I'm more than welcome to other suggestions, I believe the answer to the problem is utilising queues. I have already used queues when sending email (see code), but I would like to work some other parts of the code into queues, but I'm a bit unsure how to do this!Brief database schemaStudent hasMany LinkStudent hasMany InstitutionContact (limited to two by my application)Link hasMany InstitutionContact (limited to two by my application)Email manyToMany LinkWhat I am trying to accomplishSo the main challenge I'm facing is performing the aforementioned task with a large dataset. I have already considered creating and sending a Link one by one via a queue, however this wouldn't allow me to group all the Links together by contact/email. As the task wouldn't be performed regularly I would be open to consider performing the task as it is with an increase in memory and time for the process, however I didn't have much success when attempting this using set_time_limit(0); and ini_set('memory_limit','1056M'); before sending any links.Any help would be really appreciated, thank you if you read this far!Codeapp\Http\Controllers\LinkController.phpapp\Models\Link.phpapp\Emails\LinkEmailer.php

Edit 1I've got this working now with set_time_limit(0); and ini_set('memory_limit','1056M'); it took 8 mins to do 3000 students. Edit 2I'm running Laravel Framework version 5.1.6 (LTS), MySQL for DB.Edit 3Appreciate all the answers so far, thank you all. I am thinking that I may work the link creation process into a queue which will have a related entity in the database called something like Batch and when that Batch of links has finished being created then group all the Links from that Batch and send them.I could use the approach that @denis-mysenko suggested by having a sent_at field in the Links table and have a scheduled process to check for Links that haven't been sent and then send them. However, using the aforementioned approach I can send the Batch of Links when they've all finished being created, whereas with the sent_at approach with a scheduled process looking for Links that haven't been sent it could potentially send some links when all the links haven't been created yet.If you've tested your code with a small amount of data and it succeeds without crashing, it's clear that the problem is (as you said) the quite high number of records you're dealing with. Why don't you process your collection with the chunk method?Accordingly to the Laravel docs: Anyway, I think the use of a queue it's required in this kind of scenarios. I believe that working on a large set of data on a HTTP request should be absolutely avoided due to the high risk of request timeout. The queued process doesn't have the limit of execution time.Why don't you use the queue AND the chunk method on your collection together? This will make you able to:The Laravel docs covers all you need: Eloquent - Retrieving multiple models (see the "Chunking results" chapter for going deeper on how to save memory when dealing with a large data set) and Queues for creating jobs and detach some parts of your software that should not run under your webserver, avoiding the risk of timeoutsI would propose to change the architecture. I think it's unnecessarily overcomplicated.Controller could like like:Why keep so many fields in Link model that already exist in Student model and are accessible via student() relationship? You could just keep the status and the token (I assume it's part of the link?), as well as 'sent_at' timestamp. If links are usually sent only once, it's reasonable to keep the email body and subject there as well.If student updates his institution contacts, fresh data will be used at the time of email composition because you are not linking links to institution contacts explicitly.Then, I would create a command (let's say newLinkNotifier) that would run, for instance, every 10 minutes and that would look for links that haven't been sent yet ($links->whereNull('sent_at')), group them by email ($link->student->institutionContacts) and email content ($link->email_body, $link->email_subject) and create queued email jobs. Then a queue worker would send those emails (or you could set queue to 'async' to send them right away from the command).Since this command will run async, it doesn't really matter if it takes 5 minutes to finish. But in real life, it would take less than a minute for thousands and thousands of objects.How to do the grouping? I would probably just rely on MySQL (if you are using it), it will do the job faster than PHP. Since all 3 fields are accessible from SQL tables (two directly, another from JOIN) - it's actually a pretty simple task.In the end your emailers send() method will become as trivial as:This is not perfect yet, and I haven't tested this code - I wrote it right here, but it shows the proposed concept.If you don't plan to get millions of entries - this is probably good enough. Otherwise, you could move link creation into a separate async job as well.Assuming you're running version 5.0, how about passing off that initial processing to the queue as well?app\Http\Controllers\LinkController.phpapp\Console\Commands\CreateActiveLinks.php (queued job)Queuing Commands in Laravel 5.0In 5.1 forward, these are called Jobs and work a little differently.This code is untested, and I don't have a firm grasp on your application structure, so please don't take it as gospel.  It's just based on work I've done in my own application when faced with similar circumstances.  Maybe this will at least give you some ideas.  If you really have a lot of records, then adding the chunk() method in the CreateActiveLinks class query might be helpful.I have found out that creating an Event/Listener and them implementing queue is a lot more easier. All you have to is to create an Event and Listener for your email process(LinkEmailer) and then implement ShouldQueue interface as mentioned in the documentation.https://laravel.com/docs/5.1/events#queued-event-listeners

Laravel check for unique rule without itself in update

user3714582

[Laravel check for unique rule without itself in update](https://stackoverflow.com/questions/28198897/laravel-check-for-unique-rule-without-itself-in-update)

I am having my validation rules for unique in the update section.In inserting or adding the unique rule is 'Email' =>  array('unique:driver_details'), and it will check for the unique coloumn. But this fails for the update section. While updating it satisfies the other rules and in the unique of email it is checking itself for the unique coloumn  and it fails but seeing its own field.So, how can i check for the unique except its own value in the database ?

2015-01-28 17:43:50Z

I am having my validation rules for unique in the update section.In inserting or adding the unique rule is 'Email' =>  array('unique:driver_details'), and it will check for the unique coloumn. But this fails for the update section. While updating it satisfies the other rules and in the unique of email it is checking itself for the unique coloumn  and it fails but seeing its own field.So, how can i check for the unique except its own value in the database ?This forces to ignore specific id:replace segments table, email_column_to_check, id_to_ignore in above exampleYou could check it here http://laravel.com/docs/4.2/validation#rule-uniqueFor those using Laravel 5 and Form Requests, you may get the id of the model of the Route-Model Binding directly as a property of the Form Request as $this->name_of_the_model->id and then use it to ignore it from the unique rule.For instance, if you wanted to have unique emails, but also allow an administrator to edit users, you could do:Route:Controller:Form Request:Please note that we are ignoring the user that is being edited, which in this case could be different than the authenticated user.Include Rule by writingand write your validation code as follows:Here $id is the id of the email that you want to ignore during validation which is obtained from the controller.I am using Laravel 5.2if your primary key is named 'id'

table name is users_table and I want to update user_name

so I do it this wayif your primary key is not named 'id'

In my case my primary key is user_id and table name is users_table and I want to update user_nameso I do it this wayThis took me a while to figure out but when you are dealing with update/create requests you also have access to the request object. Here I am enforcing that client names are unique but allowing currently edited client.Been facing this issue for a while also. Try this:Works on Laravel 5.8. I don't know if it does work on lower versions of Laravel.In Laravel 6 app it helped me to exclude current user's email from validation:Try this$this->id will be the value from your request

Using JavaScript to display Laravel's Variable

Sylar

[Using JavaScript to display Laravel's Variable](https://stackoverflow.com/questions/29308441/using-javascript-to-display-laravels-variable)

In my code I am using typeahead.js. I use Laravel 5 and I need to replace the var states with my {{ $jobs }} variable. I need to list all Job Titles as an array.In my controller I haveI know the loop method in javascript but I dont know how to "link" my blade's variable in the javascript. Anyone knows how to?I have tried, in my.jsBut that wont work.

2015-03-27 19:10:20Z

In my code I am using typeahead.js. I use Laravel 5 and I need to replace the var states with my {{ $jobs }} variable. I need to list all Job Titles as an array.In my controller I haveI know the loop method in javascript but I dont know how to "link" my blade's variable in the javascript. Anyone knows how to?I have tried, in my.jsBut that wont work.For more complex variable types like arrays your best bet is to convert it into JSON, echo that in your template and decode it in JavaScript. Like this:Note that PHP has to run over this code to make it work. In this case you'd have to put it inside your Blade template. If you have your JavaScript code in one or more separate files (which is good!) you can just add an inline script tag to your template where you pass your variables. (Just make sure that it runs before the rest of your JavaScript code. Usually document.ready is the answer to that)If you don't like the idea of doing it like this I suggest you fetch the data in a separate ajax request.This works for meJust to add to above :var jobs = JSON.parse("{{ json_encode($jobs) }}");will return escaped html entities  ,hence you will not be able to loop over the json object in javascript , to solve this please use below :var jobs = JSON.parse("{!! json_encode($jobs) !!}");or var jobs = JSON.parse(<?php echo json_encode($jobs); ?>);this approach work for me:and use in java script in laravel 6 this works for meusing laravel blade directivealso used @json directive using php style I just solved this by placing a reference on the window Object in the <head> of my layout file, and then picking that reference up with a mixin that can be injected into any component..envconfig/geodata.phpresources/views/layouts/root.blade.phpresources/js/components/mixins/geodataUrl.jsusageIf you want, you can use a global mixin instead by adding this to your app.js entrypoint:I would not recommend using this pattern, however, for any sensitive data because it is sitting on the window Object.I like this solution because it doesn't use any extra libraries, and the chain of code is very clear. It passes the grep test, in that you can search your code for "window.geodataUrl" and see everything you need to understand how and why the code is working.That consideration is important if the code may live for a long time and another developer may come across it.However, JavaScript::put([]) is in my opinion, a decent utility that can be worth having, but in the past I have disliked how it can be extremely difficult to debug if a problem happens, because you cannot see where in the codebase the data comes from.Imagine you have some Vue code that is consuming window.chartData that came from JavaScript::put([ 'chartData' => $user->chartStuff ]). Depending on the number of references to chartData in your code base, it could take you a very long time to discover which PHP file was responsible for making window.chartData work, especially if you didn't write that code and the next person has no idea JavaScript::put() is being used.In that case, I recommend putting a comment in the code like:Then the person can search the code for "JavaScript::put" and quickly find it. Keep in mind "the person" could be yourself in 6 months after you forget the implementation details.It is always a good idea to use Vue component prop declarations like this:My point is, if you use JavaScript::put(), then Vue cannot detect as easily if the component fails to receive the data. Vue must assume the data is there on the window Object at the moment in time it refers to it. Your best bet may be to instead create a GET endpoint and make a fetch call in your created/mounted lifecycle method.I think it is important to have an explicit contract between Laravel and Vue when it comes to getting/setting data.In the interest of helping you as much as possible by giving you options, here is an example of making a fetch call using ES6 syntax sugar:routes/web.phpapp/Http/Controllers/UserController.phpAnywhere in Vue, especially a created lifecycle method:That example assumes your Vue component is a Mealy finite state machine, whereby the component can only be in one state at any given time, but it can freely switch between states.I'd recommend using such states as computed props:With markup such as:

How to fix in laravel 5.2 zizaco entrust:migration class name validation?

Noproblem

[How to fix in laravel 5.2 zizaco entrust:migration class name validation?](https://stackoverflow.com/questions/34529621/how-to-fix-in-laravel-5-2-zizaco-entrustmigration-class-name-validation)

I have followed zizac/entrust installation tutorial from GitHub Link and faced  with error:MigrationCommand.php file url : LinkOutut: the command: php artisan vendor:publish was successful.File : config/entrust.php exist.I didin't change any options to config/auth.php file same as - auth.php. How to fix it?         

2015-12-30 12:31:20Z

I have followed zizac/entrust installation tutorial from GitHub Link and faced  with error:MigrationCommand.php file url : LinkOutut: the command: php artisan vendor:publish was successful.File : config/entrust.php exist.I didin't change any options to config/auth.php file same as - auth.php. How to fix it?         in vendor/zizaco/entrust/src/commands/MigrationCommand.php on line 86remove line :add line :and config/auth.php file write provider line as like me : then your problem will solve : happy coding In vendor/zizaco/entrust/src/commands/MigrationCommand.php on line 86.Laravel 5.1.* Add LineLaravel 5.2.* Add LineThe accepted answer may fix the problem but it is very bad practice to edit direct vendor files. The following will fix the issue you may be having and will support your app still working if you decide to update Entrust and they fix their codebase.Add the following lines to config/auth.php underneath:Laravel 5.1 - 5.4Once Entrust rolls out an update you can remove this or keep it. Up to you.Try running:to make sure your application is using fresh config filesEDITOk, now I see, this library want to use:but there is no something like this in auth any more.So as temporary workaround you should probaby add table and model to auth file like so: https://github.com/laravel/laravel/blob/5.1/config/auth.phpand wait until Entrust will be upgraded to remove this

Getting selected values from a multiple select form in Laravel

SUB0DH

[Getting selected values from a multiple select form in Laravel](https://stackoverflow.com/questions/15358227/getting-selected-values-from-a-multiple-select-form-in-laravel)

For generating a drop-down list with an item selected by default, the following is done:So I generated a drop-down list that has more than one item selected by default, in the following way:But how do I get the more than one selected values?Input::get('size') returns only the last selected string.

2013-03-12 10:05:18Z

For generating a drop-down list with an item selected by default, the following is done:So I generated a drop-down list that has more than one item selected by default, in the following way:But how do I get the more than one selected values?Input::get('size') returns only the last selected string.First, if you want to have multiple item selected by default, you have to give an array of values as 3rd parameter, not a simple value.Exemple:should show the select with S and M selected.For the second point, you should try to give a name like size[] instead of size, it could be solve the problem (because your posted select is not a simple value, its an array of values)Usual Select statements go  And the workflow is that Laravel gets the form elements by their name. 

To make it work, change the name to an array. This will make laravel get the values of select as an array of data. According with https://laravelcollective.com/docs/5.2/html#drop-down-listsBy the way, please notice dropdown's name (size[]) if you want to be able to use this field as array in your backend.Things get tricky when you want uses relationships as value, for instance So $user->colors will return something likeYou could do something like, remember User Model have a sizes relationship of one to many with SIZE Model Hope it helps

Pinging test.dev after Laravel Valet install returns「Unknown Host」

Nate Ritter

[Pinging test.dev after Laravel Valet install returns「Unknown Host」](https://stackoverflow.com/questions/37719851/pinging-test-dev-after-laravel-valet-install-returns-unknown-host)

Update: Don't use ".dev". When this was originally posted in 2016, it was fine. Now it's not. Start by changing your TLD to somethinge else like ".localhost" or whatever. (This change would not have fixed my issue, but it might fix yours if you're still using ".dev").Problem: I've installed Laravel Valet and it all seems to be working except when I ping test.dev (which just contains an index.htm file and is located in ~/Sites), after hanging for a long time I get the response ping: cannot resolve test.dev: Unknown hostHere's what I've already done:Now, in addition to all this, I decided to try all the valet arguments out. valet share seemed to bork with an error at one point, which is interesting but I'm not sure it has anything to do with the original issue. ERROR:  Tunnel 'command_line' specifies invalid address 'test.dev:80': unexpected '[' in address test.dev:80After this I get 21 lines of Failed to connect to 127.0.0.1 port 4040: Connection refused and then an exception: 

2016-06-09 07:47:45Z

Update: Don't use ".dev". When this was originally posted in 2016, it was fine. Now it's not. Start by changing your TLD to somethinge else like ".localhost" or whatever. (This change would not have fixed my issue, but it might fix yours if you're still using ".dev").Problem: I've installed Laravel Valet and it all seems to be working except when I ping test.dev (which just contains an index.htm file and is located in ~/Sites), after hanging for a long time I get the response ping: cannot resolve test.dev: Unknown hostHere's what I've already done:Now, in addition to all this, I decided to try all the valet arguments out. valet share seemed to bork with an error at one point, which is interesting but I'm not sure it has anything to do with the original issue. ERROR:  Tunnel 'command_line' specifies invalid address 'test.dev:80': unexpected '[' in address test.dev:80After this I get 21 lines of Failed to connect to 127.0.0.1 port 4040: Connection refused and then an exception: The problem ended up being something to do with dnsmasq.  Using the very thorough this answer to another related SO post, I ended up doing the following to solve my issue:brew unlink dnsmasqbrew install dnsmasqbrew prunebrew services restart dnsmasqvalet installThen, just to test before I did a ping, I did dig test.dev and the response included: I'm not sure why the IP is 127.0.53.53 and not 127.0.0.1 but when I did a ping test.dev it did return ...Browsing to test.dev worked as well.  One thing to note that I haven't looked into yet is that index.htm is not recognized by valet/caddy as a potential index file.  Not part of the issue, but something interesting to note.I had the same problem, some brew services were stopped, running this command fixed it:I had everything set up correctly, but had the same issue - could not get the app.dev running.After runningI noticed that all services except dnsmasq were running as "root", but dnsmasq was running on my user.Stopped dnsmasq withand started it with:This worked for me, after a few hours of frustration.Nothing mentioned above helped me on macos sierra, but one little remark did: Avoiding '.dev' and using '.devel' did the trick for me, probably needed if you are on google's 8.8.8.8 dns *.dev does not work anymore since it is a real TLD. So use something else like *.test or *.local.Also don't forget to add http:// or https:// to your domain like http://blog.test for the first time when you open in the browser. Otherwise it will go to your default search engine.If you're just getting started with Laravel and following the Laracast tutorials, make sure to also read the latest documentation.In Laravel 5.6 and Valet 2.0.12 the *.dev domains were replaced by *.test, as you can see in here: https://laravel.com/docs/5.6/valet#installationFor me somehow a syntax error sneaked into the dnsmasq.conf which would prevent it from starting up correctly. To check this I did dnsmasq --test which gave the following output dnsmasq: bad option at line 1 of /usr/local/etc/dnsmasq.conf I fixed the typo on line 1 and did restarted all services with brew services restart --allAfter that, I can ping again to .dev domains and it works in my browserHope this will help some one!

Laravel create or update without two queries

mpen

[Laravel create or update without two queries](https://stackoverflow.com/questions/23315949/laravel-create-or-update-without-two-queries)

I'm trying to use one form for both creates and updates. Both actions save through this method:How can I rewrite this line:So that it doesn't fetch the object from the database first? There's no need for that; I'm not doing anything with it. It should either issue a INSERT if Input::get('id') is set, or an UPDATE if it's not.

2014-04-26 20:08:30Z

I'm trying to use one form for both creates and updates. Both actions save through this method:How can I rewrite this line:So that it doesn't fetch the object from the database first? There's no need for that; I'm not doing anything with it. It should either issue a INSERT if Input::get('id') is set, or an UPDATE if it's not.If you have all fields unguarded in your model, I think you can do it like this:If you have some guarded fields, then you can unguard it first:The reguard() call is not actually needed if you don't do anything else with the model.This is what I use:The second parameter is an array of the data for the model you want to save.I used to have this problem and created an accepted pull request on Laravel which you can use. Try the code below. The method you will basically need is the findOrNew.My model uses self validation but you can create your own validation like the one you have now.Find or New based on primary key idFirst or New based on non-primary key single filedFirst or New based on non-primary key multiple filedIf you are following the resource router methodology of laravel, you should use a separate method named update to update your model, so the separation can be done by the framework. With this it is still possible to reuse your form.If you really want to avoid a new method to update the model, you could rewrite it as follows:You may try this:If $data contains an id/primary key it'll be updated otherwise insert will be performed. In other words, for updating, you need to pass the id/primary key in the $data/attributes with other attributes and second argument in the newInstance method must be true.If you pass false/default to newInstance method then it'll perform an insert but $data can't contain an id/primary key. You got the idea and these three lines of code should work. $isSaved will be a Boolean value, true/false.If $data contains id/primary key then it'll be updated, otherwise an insert will be performed.

Laravel 5 InvalidArgumentException in FileViewFinder.php line 137: View [.admin] not found

deep singh

[Laravel 5 InvalidArgumentException in FileViewFinder.php line 137: View [.admin] not found](https://stackoverflow.com/questions/31262069/laravel-5-invalidargumentexception-in-fileviewfinder-php-line-137-view-admin)

This is student.php and my function for admin:routes.phpThis is admin form:Don't know why showing error:

2015-07-07 07:13:32Z

This is student.php and my function for admin:routes.phpThis is admin form:Don't know why showing error:A view should an extension .blade.php.So your file that has the admin form should have the name admin.blade.phpNote : If you have the view under any sub directory like somefolder/admin.blade.phpThen you should do like this return \View::make('somefolder/admin');Learn more about templating here :)If you recently deployed you project to your production server or moved the project to another server, do not forget to clear the app cache by running these commands.it should fix it.Also consider updating your .env file to match new environment variables.If any of the answers above do not work. why don't you try modifying the name of config.php project/bootstrap/cache/config.php to another name like config.php.old  it worked for me with laravel 5.3I had the same problem because I had a backslash \, the solution was change it to slash:You don't want to reference your views beginning with a slash.This:return \View::make('/admin');Should look like:return \View::make('admin');Please check first that  folder is under views folder

i.e resources/views/foldername/filenamethen you can testLaravel has an authentication skeleton generator which might have been previously used prior to your current state in your project. I had this error and I was coming from a git clone that had Laravel extra's omitted from sharing good practices.By reissuing the command https://laravel.com/docs/5.6/authentication#introduction

Laravel 5.4: Class 'App\Http\Controllers\Response' not found error

Tartar

[Laravel 5.4: Class 'App\Http\Controllers\Response' not found error](https://stackoverflow.com/questions/44506361/laravel-5-4-class-app-http-controllers-response-not-found-error)

I am following the Laracast's API tutorial and trying to create an ApiController that all the other controllers extend. ApiController is responsible for response handling.And i also have a ReportController that extends ApiController.When i try to call respondNotFound method from ReportController i geteventhough i add use Illuminate\Support\Facades\Response;to parent or child class i get the error. How can i fix this ?Any help would be appreciated.

2017-06-12 18:28:44Z

I am following the Laracast's API tutorial and trying to create an ApiController that all the other controllers extend. ApiController is responsible for response handling.And i also have a ReportController that extends ApiController.When i try to call respondNotFound method from ReportController i geteventhough i add use Illuminate\Support\Facades\Response;to parent or child class i get the error. How can i fix this ?Any help would be appreciated.Since it's a facade, add this:Or use full namespace:Or just use helper:

Laravel 4.1: How to paginate eloquent eager relationship?

user991

[Laravel 4.1: How to paginate eloquent eager relationship?](https://stackoverflow.com/questions/20913606/laravel-4-1-how-to-paginate-eloquent-eager-relationship)

There was question about old L3 eager loaded paginations, not using eloquent. But i want to use eloquent to get eager loaded relationship with pagination.Main model: Topic that has one to many relationship with Posts,

So that one Topic has many Posts. I get all data with this function:And later I make loop to display all results, but they are not paginated:So, i could make a workaround and select separately all posts that has $id of topic and use ->paginate() instead of ->get() and would got paginated $pots, 

2014-01-03 22:10:00Z

There was question about old L3 eager loaded paginations, not using eloquent. But i want to use eloquent to get eager loaded relationship with pagination.Main model: Topic that has one to many relationship with Posts,

So that one Topic has many Posts. I get all data with this function:And later I make loop to display all results, but they are not paginated:So, i could make a workaround and select separately all posts that has $id of topic and use ->paginate() instead of ->get() and would got paginated $pots, To clarify something: paginating eager-loaded relationships is somewhat of a misconception. The point of eager loading is to retrieve all relationships in as few queries as you can. If you want to retrieve 10 topics, all of which have 35 posts, you will only need two queries. Sweet!That said, paginating an eager-loaded relationship is not going to work. Consider two scenarios when eager loading happens:That said, there are two potential solutions:Option 1: Create a custom accessor that paginates the Eloquent relationship.Pros: Paginates very easily; does not interfere with normal posts relationship.

Cons: Eager loading posts will not affect this accessor; running it will create two additional queries on top of the eager loaded query.Option 2: Paginate the posts Collection returned by the eager-loaded relationship.Pros: Uses the eager-loaded relationship; creates no additional queries.

Cons: Must retrieve ALL elements regardless of current page (slow); have to build the current-page elements manually.You may want to take a look at following:By Zenry :

Source:http://laravel.io/forum/02-25-2014-eager-loading-with-constrains-load-post-based-on-category-nameHope this helps

Undefined variable: errors — Laravel 5.2

Muhammad Asif Saleem

[Undefined variable: errors — Laravel 5.2](https://stackoverflow.com/questions/34474224/undefined-variable-errors-laravel-5-2)

I am new in Laravel and using laravel version 5.2.I created a controller and request named as ArticlesController and CreateArticleRequest respectively and i defined some validation rules.CreateArticleRequestArticlesControllerWhen i use $errors variable in my template named as add.blade.php it show error undefined variable: $errors 

I tried to solve the problem but i did't .Please tell me where i am wrong .

add.blad.php

2015-12-26 18:51:15Z

I am new in Laravel and using laravel version 5.2.I created a controller and request named as ArticlesController and CreateArticleRequest respectively and i defined some validation rules.CreateArticleRequestArticlesControllerWhen i use $errors variable in my template named as add.blade.php it show error undefined variable: $errors 

I tried to solve the problem but i did't .Please tell me where i am wrong .

add.blad.phpThis is a breaking problem with the 5.2 upgrade. What's happening is the middleware which is responsible for making that errors variable available to all your views is not being utilized because it was moved from the global middleware to the web middleware group.There are two ways to fix this:Posting this as it might be useful for others, As Praveen mentioned in 1st solution, in your Kernel.php file(app/Http/Kernel.php) move \Illuminate\View\Middleware\ShareErrorsFromSession::class

from $middlewareGroups to protected $middleware property, but the same will start throwing the error "Session store not set on request", to resolve this move

\Illuminate\Session\Middleware\StartSession::class, to $middleware property as well.This happens because the file below is not updated in the composer update process, so doesn't have the mapWebRoutes method implemented.Copy this file over from a fresh install and it will work. Better, follow the upgrade path on the docs.Just cut all your routes from routes.php file and paste it between the middleware group 'web', just like this:Routes fileFor 5.2, simply move the the routes that have the errors variable to middleware groupWith this code, you can catch errors and display them :

php Laravel- A non well formed numeric value encountered (on string)

Farzan Najipour

[php Laravel- A non well formed numeric value encountered (on string)](https://stackoverflow.com/questions/40057476/php-laravel-a-non-well-formed-numeric-value-encountered-on-string)

I have two function in my controller and service. I want to call a function in service. Here is my code : Controller:my service (Map.php) :Actually , I get an error :at this line: 

public function getOriginPoint(string $origin):PointHow to solve it?

2016-10-15 09:43:42Z

I have two function in my controller and service. I want to call a function in service. Here is my code : Controller:my service (Map.php) :Actually , I get an error :at this line: 

public function getOriginPoint(string $origin):PointHow to solve it?This is a bug in the symfony/var-dumper package when using PHP7.1. It was fixed in version 2.7.16, 2.8.9, 3.0.9 and 3.1.3. See the pull request: https://github.com/symfony/symfony/pull/19379In my case, I needed to composer update my laravel framework packages, as my vendor directory copy of that package was at 2.7.9. (I'm using Laravel 5.1; later versions use 2.8 and 3.0 of symfony, which also had the bug)I had the same issue on Laravel 5.2 PHP 7.1. If you don't want to update the entire framework, you can do:as stated here.

laravel search multiple words separated by space

user4006175

[laravel search multiple words separated by space](https://stackoverflow.com/questions/28270244/laravel-search-multiple-words-separated-by-space)

I am new to laravel query builder, I want to search multiple words entered in an input field for example if I type "jhon doe" I want to get any column that contains jhon or doeI have seen/tried solutions using php MySQL but can't able to adapt to query builderhow do I do this using query builderthis is what i have so far, what is the proper way of doing this, please help, thanks in advance

2015-02-02 02:12:58Z

I am new to laravel query builder, I want to search multiple words entered in an input field for example if I type "jhon doe" I want to get any column that contains jhon or doeI have seen/tried solutions using php MySQL but can't able to adapt to query builderhow do I do this using query builderthis is what i have so far, what is the proper way of doing this, please help, thanks in advanceThis is how you do it with Query\Builder, but first some additional notes:That said, you obviously can't rely on explode because in the above case you would get all the rows.So, this is what you should do:There is closure in the where because it is a good practice to wrap your or where clauses in parentheses. For example if your User model used SoftDeletingScope and you would not do what I suggested, your whole query would be messed up.This would work.the whereIn would search for first name from the keywords you entered.Try this..You can try as followsHave you considered using a FULLTEXT index on your first_name column?You can create this index using a Laravel migration, although you need to use an SQL statement:You can then run quite advanced searches against this field, like this:That will match records containing either the words "john" or "doe"; note that this approach will match on whole words, rather than substrings (which can be the case if you use LIKE).If you want to find records containing all words, you should precede each keyword with a '+', like this:You can even sort by relevance, although this is probably overkill for your needs (and irrelevant for "all" searches). Something like this:There is a good article that covers this general approach here:http://www.hackingwithphp.com/9/3/18/advanced-text-searching-using-full-text-indexesYou can use this package https://github.com/nicolaslopezj/searchableor just do this, if you don't want to use packageUsing 'orWhere' will get you results for each keyword not results for keyword1 + keyword2...So all depends on what your looking for

laravel mysql query with multiple where orwhere and inner join

Alberto

[laravel mysql query with multiple where orwhere and inner join](https://stackoverflow.com/questions/27063077/laravel-mysql-query-with-multiple-where-orwhere-and-inner-join)

How can I prepare the following MySQL query in Laravel?This is the code I used without success:The conditions must be:

2014-11-21 14:00:32Z

How can I prepare the following MySQL query in Laravel?This is the code I used without success:The conditions must be:Okay it looks like your problem is with the nested whereTry this one:I think you want to look into the possibility of using an inline function on the join clause... Your where clauses might be colliding - and really you want the role_id clause to be on your join.http://laravel.com/docs/4.2/queries#joinsThe above produces this query:Which is giving me one row back, given the following database:

How to get list of all cached items by key in Laravel 5?

kohloth

[How to get list of all cached items by key in Laravel 5?](https://stackoverflow.com/questions/31791178/how-to-get-list-of-all-cached-items-by-key-in-laravel-5)

The Cache class in laravel has methods such as get('itemKey') to retrieve items from the cache, and remember('itemKey', ['myData1', 'myData2']) to save items in the cache.There is also a method to check if an item exists in the cache: Cache::has('myKey');Is there any way, (when using the file-based cache driver), to get a list of all items in the cache?For instance, something that might be named something like "Cache::all()" that would return:The only way I can think of doing this is to loop through all possible key names using the Cache::has() method. i.e. aaa, aab, aac, aad... but of course, this is not a solution.I can't see anything in the documentation or the API that describes a function like this, but I don't think its unreasonable to believe that one must exist.

2015-08-03 15:28:26Z

The Cache class in laravel has methods such as get('itemKey') to retrieve items from the cache, and remember('itemKey', ['myData1', 'myData2']) to save items in the cache.There is also a method to check if an item exists in the cache: Cache::has('myKey');Is there any way, (when using the file-based cache driver), to get a list of all items in the cache?For instance, something that might be named something like "Cache::all()" that would return:The only way I can think of doing this is to loop through all possible key names using the Cache::has() method. i.e. aaa, aab, aac, aad... but of course, this is not a solution.I can't see anything in the documentation or the API that describes a function like this, but I don't think its unreasonable to believe that one must exist.There is no way to do that using Cache facade. Its interface represents the functionality that all underlying storages offer and some of the stores do not allow listing all keys.If you're using the FileCache, you could try to achieve that by interacting with the underlying storage directly. It doesn't offer the method you need, so you'll need to iterate through the cache directory. It won't be too efficient due to a lot of disk I/O that might need to happen.In order to access the storage, you need to do ^This above dont work in LV 5.2Try this solution: In 'yourKeyGoesHere' you can insert a string used as same as a like with a * or insert directly the exactly key.     For Memcached, you can do this:This gives you an array of keys you can go through.in \config\database.php make a redis store for the cachein \config\cache.php use this redis databasenow you can use Redis class to check what is in your cache

Laravel uploading file Unable to write in directory

user3714932

[Laravel uploading file Unable to write in directory](https://stackoverflow.com/questions/34836602/laravel-uploading-file-unable-to-write-in-directory)

I'm uploading files in my system and it works locally where am using windows and xampp but when hosting where am using an Ubuntu stack my file is not being uploaded. I'm getting an error that it cannot be written in the 'system' directory which is within the public folder. This is my code    after looking for solutions I found out that I should make my directory writable so I ran the following command in puttychmod 770 /var/www/html/public/systembut still even after that am getting an error Unable to write in the "/var/www/html/public/system" directory.I'm using laravel 5 and my host is digital ocean. Thanks

2016-01-17 08:45:35Z

I'm uploading files in my system and it works locally where am using windows and xampp but when hosting where am using an Ubuntu stack my file is not being uploaded. I'm getting an error that it cannot be written in the 'system' directory which is within the public folder. This is my code    after looking for solutions I found out that I should make my directory writable so I ran the following command in puttychmod 770 /var/www/html/public/systembut still even after that am getting an error Unable to write in the "/var/www/html/public/system" directory.I'm using laravel 5 and my host is digital ocean. Thankschmod 755 /var/www/html/public/system and  chown www-data:www-data /var/www/html/public/system as stated by @JLPuro works perfectly. Thanks a lot guys.permission for folder sudo chmod 777./(folder name)for file sudo chmod 777 -R ./(file name)

In Laravel, how do I retrieve a random user_id from the Users table for Model Factory seeding data generation?

Simon Suh

[In Laravel, how do I retrieve a random user_id from the Users table for Model Factory seeding data generation?](https://stackoverflow.com/questions/44102483/in-laravel-how-do-i-retrieve-a-random-user-id-from-the-users-table-for-model-fa)

Currently, in my ModelFactory.php, I have:I would like to generate a random user_id from one of the user ID's already stored in the user table. I'm stumped because I don't know the way to display data output to code properly, and I was wondering how I would be able to allow Laravel to choose a random user ID and insert into the database. Thank you! :)

2017-05-21 22:38:09Z

Currently, in my ModelFactory.php, I have:I would like to generate a random user_id from one of the user ID's already stored in the user table. I'm stumped because I don't know the way to display data output to code properly, and I was wondering how I would be able to allow Laravel to choose a random user ID and insert into the database. Thank you! :)Try the below. Remember that this gets all the user data from your table and then choses an id randomly. So if your table has huge amount of data, it is not recommended. Instead, in your Test Case, you can create a new User (via its own factory) and assign the id to the Reply object generated from the above factory.Alternately, you can query for a specific user in the above factory definition.If you have a test user set up in your DB this will avoid pulling all the user data.It does not work like that 'user_id':But that's how it works:Any class that extends Illuminate\Database\Eloquent\Model will be able to do this:Or to get a Collection of 3 items:This might be more efficient than using User::all()->first(), which ought to first query all Users.Your IDE (like PhpStorm) will probably be wildly confused that this is an option though.Also see: Laravel - Eloquent or Fluent random row

Laravel 5.4 get Referer

PHPprogrammer42

[Laravel 5.4 get Referer](https://stackoverflow.com/questions/45713409/laravel-5-4-get-referer)

I'm trying to get the Referer of my users. Like if they come from facebook, youtube, google or anything else. Now I've tried something like that: This: that: But nothing worked like expected.Does someone know a solution how I can check the referer? I need that because I want to check if the user comes from some specific URL's and if so, I want to give the user some extra "clicks" to rank up. Something like a small affiliate system.

2017-08-16 12:21:26Z

I'm trying to get the Referer of my users. Like if they come from facebook, youtube, google or anything else. Now I've tried something like that: This: that: But nothing worked like expected.Does someone know a solution how I can check the referer? I need that because I want to check if the user comes from some specific URL's and if so, I want to give the user some extra "clicks" to rank up. Something like a small affiliate system.It seems like this will do what you are looking for :You can read the Api DOC here : http://laravel.com/api/5.0/Illuminate/Http/Request.html#method_server The reason you get Undefined index: HTTP_REFERER is because not all requests have a HTTP_REFERER header, only most of the requests that come from other websites. If you visit a website directly with the url, you wont be sending a HTTP_REFERER header.So, you should check if the header is set first.Proper way is to use I hope this message finds you happy with your code. However, if you are facing any issue with referrer URL, you probably should read this article https://scotthelme.co.uk/a-new-security-header-referrer-policy/. The Referrer Policy header is the key behind such an issue. I have been facing problem with referrer URL in my Laravel + NGINX application and tried all possible ways to fix that by code mentioned in above comments (back, previous, header etc.) but finally found this article to enrich my knowledge before fixing my issue appropriately. It's up to the client to send the referrer information int he HTTP request's header.So if the client (browser, app, etc.) doesn't send the referrer, it won't be available to the server in the request headers. I guess the WhatsApp app has disabled sending the referrer, so there is no way to get it.In some browsers, sending of the referrer information can be turned off in the settings or with a extension. It is also easily spoofed with curl for instance, so it cannot be relied on as a security measure.More info in my answer here: https://stackoverflow.com/questions/49050268/does-document-referrer-equal-the-http-referer-header/49050494If your unsure about the client sending the referrer, it's easy to check it with JavaScript (referrer is spelled here differently from the HTTP header, to add to the confusion):

Laravel Unit Testing Dependency Injection

Denis Priebe

[Laravel Unit Testing Dependency Injection](https://stackoverflow.com/questions/40657440/laravel-unit-testing-dependency-injection)

I'm trying to write a test class for a shopping cart. Here is what I have: ShoppingCartTest.phpHowever, when I run phpunit, it seems like Laravel is unable to resolve my ShoppingCartClass.Here is the error:I have my ShoppingCart class being resolved in a number of different controllers just fine.Why can't Laravel resolve it during my tests?I refered to this post as well but still didn't have any luck.

2016-11-17 14:27:28Z

I'm trying to write a test class for a shopping cart. Here is what I have: ShoppingCartTest.phpHowever, when I run phpunit, it seems like Laravel is unable to resolve my ShoppingCartClass.Here is the error:I have my ShoppingCart class being resolved in a number of different controllers just fine.Why can't Laravel resolve it during my tests?I refered to this post as well but still didn't have any luck.I figured it out. Here is the updated class.Thanks to @edcs for guiding me in the right direction.

You need to use a setUp function and not __construct as the app instance hasn't been created yet.If you want to use __construct you have to use the same constructor of PHPUnit\Framework\TestCase and remember to call the parent method if you don't want to break anythingHowever the proper way would be to use the method setUpBeforeClass() if you want to execute your init code once or setUp() if you want to execute the init code before each test contained in your class.

Check PHPUnit documentation for more details.

How to change mail configuration before sending a mail in the controller using Laravel?

jibe

[How to change mail configuration before sending a mail in the controller using Laravel?](https://stackoverflow.com/questions/23438342/how-to-change-mail-configuration-before-sending-a-mail-in-the-controller-using-l)

I'm using Laravel 4, I would like to change the mail configuration (like driver/host/port/...) in the controller as I would like to save profiles in databases with different mail configuration. This is the basic send mail using configuration from config/mail.phpI've tried to put something like but it didn't workThanks for your support!Jean

2014-05-02 23:15:36Z

I'm using Laravel 4, I would like to change the mail configuration (like driver/host/port/...) in the controller as I would like to save profiles in databases with different mail configuration. This is the basic send mail using configuration from config/mail.phpI've tried to put something like but it didn't workThanks for your support!JeanYou can set/change any configuration on the fly using Config::set:So, to set/change the port in mail.php you may try this:Update: A hack for saving the config at runtime.The selected answer didn't work for me, I needed to add the following for the changes to be registered.I know is kind of late but an approach could be providing a swift mailer to the laravel mailer.

How to delete record in laravel 5.3 using ajax request?

Ayaz Shah

[How to delete record in laravel 5.3 using ajax request?](https://stackoverflow.com/questions/39350918/how-to-delete-record-in-laravel-5-3-using-ajax-request)

I'm trying to delete record using ajax in laravel 5.3, i know this is one of the common question and there is already lots of online solutions and tutorials available about this topic. I tried some of them but most of giving me same error NetworkError: 405 Method Not Allowed. I tried to do this task by different angle but i'm stuck and could not found where i'm wrong, that's why i added this question for guideline.I'm trying following script for deleting the record.Controller.phpRoutes.phpIn ViewApp.jsWhen i'm click on delete button it returning me error NetworkError: 405 Method Not Allowed in console. Without ajax same delete function is working properly. Can anyone guide me where i'm wrong that i can fix the issue, i would like to appreciate if someone guide me regarding this. Thank You..

2016-09-06 13:58:32Z

I'm trying to delete record using ajax in laravel 5.3, i know this is one of the common question and there is already lots of online solutions and tutorials available about this topic. I tried some of them but most of giving me same error NetworkError: 405 Method Not Allowed. I tried to do this task by different angle but i'm stuck and could not found where i'm wrong, that's why i added this question for guideline.I'm trying following script for deleting the record.Controller.phpRoutes.phpIn ViewApp.jsWhen i'm click on delete button it returning me error NetworkError: 405 Method Not Allowed in console. Without ajax same delete function is working properly. Can anyone guide me where i'm wrong that i can fix the issue, i would like to appreciate if someone guide me regarding this. Thank You..Instead of using Route::get use Route::delete.In addition to that change the type: 'Put' to type: 'DELETE' in the ajax call.P.S. This codecan be written as:Or even shorter:Keep in mind that ->delete() will fire an event while ::destroy() will not.Make sure to add this in the meta tag of your viewIn your Routes, do thisIn your controller, do thisorMake sure to check that the user who is deleting the account actually owns the account a.k.a run authorization test.Since it's a delete request, you would require to send the csrf_token along with your ajax header as the official site states.

https://laravel.com/docs/5.5/csrf#csrf-x-csrf-tokenMake sure to add this before the ajax call Now send the requestI hope this helps.});i'm resuming a working flow of deletion, with a request VERB. Hope it helpsIn the form (with blade):Route:ProductController:In the redirect part, i'm going back to my list page (admin.products) with a success notifier. The route would be:So you can complete the flow.

issue with dropping foreign key

Jimmyt1988

[issue with dropping foreign key](https://stackoverflow.com/questions/26628176/issue-with-dropping-foreign-key)

My foreign key relates to its own table. This was to produce posts with hierarchy.Now when I try and drop the column in the database, it gives me this error:This is the code:The only way I seem to be able to do it, is to goto phpmyadmin and remove the foreign key itself. and then drop the column.

2014-10-29 10:37:40Z

My foreign key relates to its own table. This was to produce posts with hierarchy.Now when I try and drop the column in the database, it gives me this error:This is the code:The only way I seem to be able to do it, is to goto phpmyadmin and remove the foreign key itself. and then drop the column.Just figured this out for my own project. When you are dropping a foreign key, you need to concatenate the table name and the columns in the constraint then suffix the name with "_foreign"http://laravel.com/docs/5.1/migrations#foreign-key-constraintsHere’s how to do it:1) Log in to your database and lookup the name of the foreign key relationship. If you use phpmyadmin, go to the table, click the「Structure」tab, click the link「Relation View」and wait a few seconds for it to load. Search for the field「Constraint name」. In my example this is:「contribution_copyright_id_foreign」2) Go to the Laravel migration script (or create one). The trick is to first drop the foreign key relationship and then drop the column.If you want to remove a table where a foreign key is present, you also first have to drop the foreign key relationship.copied from hereHope it help someoneTry placing "_foreign" on the end of the column name. For example:To check the name of the foreign key , first backup your database to .sqlthere you will see the name of your foreign key like this :in my case is laravel 5.4,

it start by this format : tablename_columnname_foreignso in your laravel (here i try to drop foreign key from employee table)

New to Laravel PHP framework. Routes other than「/」doesn't work

Rafael Adel

[New to Laravel PHP framework. Routes other than「/」doesn't work](https://stackoverflow.com/questions/18491760/new-to-laravel-php-framework-routes-other-than-doesnt-work)

I'm a beginner at Lavarel framework. I know about MVC structure, Since I've used it before inside ASP.net, But using Laravel is quite confusing to me.I've installed Laravel inside photozoom directory using:Here's my app/routes.php : When i run http://localhost/photozoom/public/users, I get 404 Not Found error. But when i try http://localhost/photozoom/public/, The route for / is invoked and the corresponding view is called.I even tried to create a view for the users route. Using Laravel documentation. I've created two files :layout.blade.php : users.blade.php :But still, When i call http://localhost/photozoom/public/users I get 404 Not Found error.Here's my public/.htaccess file:I'm using PHP 5.5, Apache 2.4.6 .Any help would be appreciated.SOLVED

After enabling mod_rewrite, I had to enable AllowOverride too.

2013-08-28 15:10:55Z

I'm a beginner at Lavarel framework. I know about MVC structure, Since I've used it before inside ASP.net, But using Laravel is quite confusing to me.I've installed Laravel inside photozoom directory using:Here's my app/routes.php : When i run http://localhost/photozoom/public/users, I get 404 Not Found error. But when i try http://localhost/photozoom/public/, The route for / is invoked and the corresponding view is called.I even tried to create a view for the users route. Using Laravel documentation. I've created two files :layout.blade.php : users.blade.php :But still, When i call http://localhost/photozoom/public/users I get 404 Not Found error.Here's my public/.htaccess file:I'm using PHP 5.5, Apache 2.4.6 .Any help would be appreciated.SOLVED

After enabling mod_rewrite, I had to enable AllowOverride too.Try http://localhost/photozoom/public/index.php/users for now. And then enable pretty URLs.The .htaccess file in the /public directory enables pretty URLs.

In order for the .htaccess file to do its work:For example:There are two AllowOverride in the httpd.conf file.andif you're running windows 10 then you just need to do one thing simple as enough.create new folder in c:/wamp64/www/ and

copy your all file from laravel folder and paste in folder which you just created thats my solution.

Laravel - Paginate and get()

Bajongskie

[Laravel - Paginate and get()](https://stackoverflow.com/questions/19616720/laravel-paginate-and-get)

With the code below, what I wanted was paginate the query I created. But, when I try to add paginate after get, it throws an error. I wanted to remain get since I want to limit to columns that was set on $fields.

What would should be the better idea to paginate this thing? or what's a good substitute for get and limit the columns?What I tried:Part of my controller:}

2013-10-27 09:50:09Z

With the code below, what I wanted was paginate the query I created. But, when I try to add paginate after get, it throws an error. I wanted to remain get since I want to limit to columns that was set on $fields.

What would should be the better idea to paginate this thing? or what's a good substitute for get and limit the columns?What I tried:Part of my controller:}If you look at the method signature you will see that paginate receives a second argument, $columns. So your solution would be to useFurthermore, you can clean up your controller by changing things slightly:

laravel4 composer install got proc_open not available error

Felix

[laravel4 composer install got proc_open not available error](https://stackoverflow.com/questions/19911737/laravel4-composer-install-got-proc-open-not-available-error)

Now I am trying to use composer to install my php package but I got this error message:

$ composer installedit :after enable the proc_open function I got this error and also set my php memory_limit to 384M :

2013-11-11 16:56:10Z

Now I am trying to use composer to install my php package but I got this error message:

$ composer installedit :after enable the proc_open function I got this error and also set my php memory_limit to 384M :You should use php-cli to by-pass disable_functions temporarily.Edit your php.ini file and search for the lineIt should be disabled there and you must enabled it. This a security precaution.

laravel 5.4 : Laravelcollective/html v5.3.0 requires illuminate/view 5.3.*

Gammer

[laravel 5.4 : Laravelcollective/html v5.3.0 requires illuminate/view 5.3.*](https://stackoverflow.com/questions/41845042/laravel-5-4-laravelcollective-html-v5-3-0-requires-illuminate-view-5-3)

I was using Laravelcollective/html v5.3.0 with laravel 5.3. Now i am using laravel 5.4. I have forms which are using Laravelcollective/html v5.3.0.The composer require laravelcollective/html gives me the following error:When gonna laravel 5.4 support Laravelcollective/html ?

2017-01-25 06:41:36Z

I was using Laravelcollective/html v5.3.0 with laravel 5.3. Now i am using laravel 5.4. I have forms which are using Laravelcollective/html v5.3.0.The composer require laravelcollective/html gives me the following error:When gonna laravel 5.4 support Laravelcollective/html ?Update:The Laravelcollective/html has been updated to Laravel 5.4 but there is no any changes in the documentation till now.

If you want to see the pull request it is right here:https://github.com/LaravelCollective/html/pull/276https://github.com/LaravelCollective/html/pull/284Just use:Or,If you don't want to specify the version and get the same latest version of LaravelCollective.Older Issue:Laravelcollective/html v5.3.0 requires Laravel 5.3 and not yet supports Laravel 5.4.The laravelcollective/html v5.4 is under open issue:https://github.com/LaravelCollective/html/pull/276It could be merged any time.Just have an eye on it.Edit: Alternatively you could use maddhatter's git repository as he had done some changes that is not yet provided in git@github.com:st3f/html.git repository.Just add it into your composer.jsonand runOr, if you don't need those changes you could follow Cerlin Boss answerhttps://stackoverflow.com/a/41845331/3887342NOTE: This answer was posted when laravelcollective/html was not supporting laravel 5.4For dev purpose you can use the origin repo from the pull request for 5.4Configure the repoTo add this automatically without manually editing the composer.json

run,Require the dev-master as it has the changes for 5.4Once the original repo author releases the support for 5.4, just remove the vcs repo reference and change the dev-master to 5.4

On server my application is looking for uppercase table name instead of lowercase

Alexander Solonik

[On server my application is looking for uppercase table name instead of lowercase](https://stackoverflow.com/questions/41967746/on-server-my-application-is-looking-for-uppercase-table-name-instead-of-lowercas)

I have this table on my local xampp , the table name is tags , this works perfectly fine on my local system, but when I upload this table to my server I get the following error:The tables I have under the table peckinga_blog are the following:As you can see tags is one of them , Also for the tags table I have the following migrations in my laravel application:Now why am I getting this this error in spite of my database clearly being available ? What can I do so that my server will look for the database tags instead of Tags ?

2017-01-31 21:24:26Z

I have this table on my local xampp , the table name is tags , this works perfectly fine on my local system, but when I upload this table to my server I get the following error:The tables I have under the table peckinga_blog are the following:As you can see tags is one of them , Also for the tags table I have the following migrations in my laravel application:Now why am I getting this this error in spite of my database clearly being available ? What can I do so that my server will look for the database tags instead of Tags ?Database and table names are not case sensitive in Windows, and case sensitive in most varieties of Unix or Linux. Table names in MySQL are file system entries, so they are case insensitive if the underlying file system is.Although after applying the migration, it should work But in case if it is not working and you want both statements i.e. lower case and upper case name in table to succeed, you need to put the following line in your /etc/my.cnf or wherever you keep your MySQL configuration.Doctrine generated capital/CamelCase table names and MySQL stored them as lowercase!Or Be sure to add the system variable to [mysqld] section of the configuration file.For more information you can check the MySQL Reference Link.I had the following line in my code:worked perfectly locally on my windows XAMPP, but needed to change it to:to work on my server.the case sensitivity depends on your underlying filesystem, which explains the discrepancy between your local and production machine.since this is a common problem, I'd recommend to use lowercase allover as a convention. change your Tags to tags in your migrations and also in your model and you should be good to go.if you need to rename your table, rename it first to something_else, and than again to tags.

Sanitize user input in laravel

warmspringwinds

[Sanitize user input in laravel](https://stackoverflow.com/questions/12813424/sanitize-user-input-in-laravel)

I've got a simple question:

When is it best to sanitize user input?

And which one of these is considered the best practice:For example use HTML::entities() and save result to database.

Or by using HTML methods in the views because in this case laravel by default uses HTML::entities().

Or maybe by using the both.EDIT: I found interesting example http://forums.laravel.com/viewtopic.php?id=1789. Are there other ways to solve this? 

2012-10-10 06:40:39Z

I've got a simple question:

When is it best to sanitize user input?

And which one of these is considered the best practice:For example use HTML::entities() and save result to database.

Or by using HTML methods in the views because in this case laravel by default uses HTML::entities().

Or maybe by using the both.EDIT: I found interesting example http://forums.laravel.com/viewtopic.php?id=1789. Are there other ways to solve this? I would say you need both locations but for different reasons. When data comes in you should validate the data according to the domain, and reject requests that do not comply. As an example, there is no point in allowing a tag (or text for that matter) if you expect a number. For a parameter representing.a year, you may even want to check that it is within some range.

Sanitization kicks in for free text fields. You can still do simple validation for unexpected characters like 0-bytes. IMHO it's best to store raw through safe sql (parameterized queries) and then correctly encode for output. There are two reasons. The first is that if your sanitizer has a bug, what do you do with all the data in your database? Resanitizing can have unwanted consequences. Secondly you want to do contextual escaping, for whichever output you are using (JSON, HTML, HTML attributes etc.)I have a full article on input filtering in Laravel, you might find it useful http://usman.it/xss-filter-laravel/, here is the excerpt from this article:You can do a global XSS clean yourself, if you don’t have a library to write common methods you may need frequently then I ask you to create a new library Common in application/library. Put this two methods in your Common library:Then put this code in the beginning of your before filter (in application/routes.php):I just found this question. Another way to do it is to enclose dynamic output in triple brackets like this {{{ $var }}} and blade will escape the string for you. That way you can keep the potentially dangerous characters in case they are important somewhere else in the code and display them as escaped strings. It depends on the user input. If you're generally going to be outputting code they may provide (for example maybe it's a site that provides code snippets), then you'd sanitize on output. It depends on the context. If you're asking for a username, and they're entering HTML tags, your validation should be picking this up and going "no, this is not cool, man!"If it's like the example I stated earlier (code snippets), then let it through as RAW (but be sure to make sure your database doesn't break), and sanitize on output. When using PHP, you can use htmlentities($string).i'd found this because i was worried about xss in laravel, so this is the packages gvlatkoit is easy: To Clear Inputs = $cleaned = Xss::clean(Input::get('comment');To Use in views = $cleaned = Xss::clean(Input::file('profile'), TRUE);

Select, where JSON Array contains

Elwin

[Select, where JSON Array contains](https://stackoverflow.com/questions/46055223/select-where-json-array-contains)

So in Laravel 5 there's the handy thing called JSON Where Clauses using MySQL's new ability to store and fetch JSON stored in a column:would return all rows, where colors in the column meta would be set to red.Now let's say colors is not a string, but an array containing multiple colors (colors => ['red', 'blue', 'green']).  What would be an efficient way to retrieve all rows, where colors contains e.g. the value red?

2017-09-05 12:39:43Z

So in Laravel 5 there's the handy thing called JSON Where Clauses using MySQL's new ability to store and fetch JSON stored in a column:would return all rows, where colors in the column meta would be set to red.Now let's say colors is not a string, but an array containing multiple colors (colors => ['red', 'blue', 'green']).  What would be an efficient way to retrieve all rows, where colors contains e.g. the value red?JSON_CONTAINS() does exactly what you're looking for:  Currently, Laravel's query builder does not provide a corresponding API. There's an open internals proposal for it though. In the meantime, you can execute a raw query:  Which would return all users that have "red" in their meta->colors JSON field. Note that the -> operator requires MySQL 5.7.9+.You can also call the whereRaw() directly on an Eloquent model.  As of the 5.6 release, Laravel's query builder contains a new whereJsonContains method.I think a way would be using the like operator:However, this would only work if the values never contain the character " and the delimiters wouldn't change.An update for this answer, according to MySQL or MariaDb, the correct syntax must be JSON_CONTAINS(@json, 'red', '$.colors'), and is necessary to use JSON_EXTRACT.Remember to use double quotes in value sentence.

JSON_CONTAINS(JSON_EXTRACT(meta, '$.colors'), '"red"')The whereIn method verifies that a given column's value is contained within the given array.

Try this:More about Laravel's whereIn.

How can I add external class in Laravel 5

Hamed Kamrava

[How can I add external class in Laravel 5](https://stackoverflow.com/questions/28816707/how-can-i-add-external-class-in-laravel-5)

There is a class in app/Libraries/TestClass.php with following content:Now, I would like to call getInfo() method from this external class in my Controller.How can I do such thing?

2015-03-02 18:17:30Z

There is a class in app/Libraries/TestClass.php with following content:Now, I would like to call getInfo() method from this external class in my Controller.How can I do such thing?First you should make sure that this class is in the right namespace. The correct namespace here would be:Then you can just use it like any other class:Don't forget the import at the top of the class you want to use it in:In case you don't have control over the namespace or don't want to change it, add an entry to classmap in your composer.json:Then run composer dump-autoload. After that you'll be able to use it the same way as above except with a different (or no) namespace.

How to get name of requested controller and action in middleware Laravel

Deejay

[How to get name of requested controller and action in middleware Laravel](https://stackoverflow.com/questions/30442746/how-to-get-name-of-requested-controller-and-action-in-middleware-laravel)

I am new to Laravel, and i want to get name of requested controller and action in beforefilter middelware.Thanks,

DJ

2015-05-25 16:52:38Z

I am new to Laravel, and i want to get name of requested controller and action in beforefilter middelware.Thanks,

DJLaravel 5.6:Laravel 5.5 and lower:You can retrieve the current action name with Route::currentRouteAction(). Unfortunately, this method will return a fully namespaced class name. So you will get something like:Then just separate method name and controller name:

Laravel command - Only optional argument

TheNiceGuy

[Laravel command - Only optional argument](https://stackoverflow.com/questions/46670304/laravel-command-only-optional-argument)

I have a command with this signatureAnd execute this:For some reason that results in this exceptionWhy? I want that this command can either be executed as php artisan order:check or with an optional order id php artisan order:check --order X

2017-10-10 15:16:03Z

I have a command with this signatureAnd execute this:For some reason that results in this exceptionWhy? I want that this command can either be executed as php artisan order:check or with an optional order id php artisan order:check --order XThe {--order} option (without an = sign) declares a switch option, which takes no arguments. If the switch option is present, its value equals true, and, when absent, false (--help is like a switch—no argument needed).When we provide an argument on the command line for this option, the console framework cannot match the input to an option with an argument, so it throws the error as shown in the question.To allow the option to accept an argument, change the command's $signature to: Note the addition of the equal sign after --order. This tells the framework that the --order option requires an argument—the command will throw an exception if the user doesn't provide one.If we want our command to accept an option with or without an argument, we can use a similar syntax to provide a default value: ...but this doesn't seem useful for this particular case.After we set this up, we can call the command, passing an argument for --order. The framework supports both formats:...and then use the value of order in our command: 

How to inject multiple classes that share the same interface in Laravel 4

bitinn

[How to inject multiple classes that share the same interface in Laravel 4](https://stackoverflow.com/questions/19365138/how-to-inject-multiple-classes-that-share-the-same-interface-in-laravel-4)

Say I have an interface CrawlerInterface with implementation PageCrawler and FeedCrawler; if we happen to need both classes in a controller, how can that be achieved with constructor injection?Previously we use a central ServiceProvider to register (i.e. App::bind) such classes, but in most cases we only have 1 implementation of an interface, so said problem hasn't occured to us yet.PS: I also wonder if this problem suggests we should split the controller.Updates:Thanks for the comments and response, to explain, said interface has only one public method: crawl($uri), and both page/feed crawler implements it as given a resource identifier, return resource.My follow up question:Say we are in a calculator scenario where Addition, Subtraction and Multiplication share the same interface Operation, which has only 1 public method run, at some point we will still encounter this problem right? How do we handle situation like these in general with ServiceProvider?

2013-10-14 16:48:29Z

Say I have an interface CrawlerInterface with implementation PageCrawler and FeedCrawler; if we happen to need both classes in a controller, how can that be achieved with constructor injection?Previously we use a central ServiceProvider to register (i.e. App::bind) such classes, but in most cases we only have 1 implementation of an interface, so said problem hasn't occured to us yet.PS: I also wonder if this problem suggests we should split the controller.Updates:Thanks for the comments and response, to explain, said interface has only one public method: crawl($uri), and both page/feed crawler implements it as given a resource identifier, return resource.My follow up question:Say we are in a calculator scenario where Addition, Subtraction and Multiplication share the same interface Operation, which has only 1 public method run, at some point we will still encounter this problem right? How do we handle situation like these in general with ServiceProvider?If each crawler exists for a different reason, you can use arbitrary names for your instances, for example:For the controller:Your controller code would then use each crawler differently:If you just have a list of crawlers where each is used for the same thing, you probably want to do something like:In your controller, you'll get a list of "crawlers" by configuring it like so:Your controller code could be something like this:Ok lets assume you have a CrawlerControlleran interface and concrete implementations of that intefrace called PageCrawler and FeedCrawlerYou would inject the dependencies by writing a service locator likeBut as suggested by others you should rethink your logic, use it only if this kind

of architecture is unavoidableI think that the interface won't help you in this case. By doing:You need to choose one:orAnd then Laravel will inject it:To have both you have 2 options-Have 2 different interfaces-Inject the implementations directly:But I also think that, if you need something like this, you better rethink your logic.

Use other column values for Eloquent update

lesssugar

[Use other column values for Eloquent update](https://stackoverflow.com/questions/31118045/use-other-column-values-for-eloquent-update)

I would like to perform an UPDATE using Eloquent, that will set column_c value using values of column_a and column_b of the same table. Basically, something like this:where $this->column_a and $this->column_b would be the actual values from the current row.MySQL equivalent:Note: The code above is just an example to show the idea. It's not the actual implementation (which would be creating a DB redundancy).How do I perform such update in Laravel 5.1? I would really like to avoid a foreach.

2015-06-29 14:17:36Z

I would like to perform an UPDATE using Eloquent, that will set column_c value using values of column_a and column_b of the same table. Basically, something like this:where $this->column_a and $this->column_b would be the actual values from the current row.MySQL equivalent:Note: The code above is just an example to show the idea. It's not the actual implementation (which would be creating a DB redundancy).How do I perform such update in Laravel 5.1? I would really like to avoid a foreach.Maybe DB::raw can help. This will allow you to use any standard sql query to combine your data:You could use an override.. Somthing like this:Edit:

This might help you as well:

   laravel model callbacks after save, before save, etc

How do I set laravel test to go to site name instead of localhost

Rockwell Rice

[How do I set laravel test to go to site name instead of localhost](https://stackoverflow.com/questions/33547952/how-do-i-set-laravel-test-to-go-to-site-name-instead-of-localhost)

I am trying to write some tests for an application.  I have the server set up on MAMP going to dev.myappnamehere.com.When I run a test (based off of Laracasts Integrated) it fails because it is looking for the routeBut what it needs to go to is How can I change that so it does not default to looking for the localhost and instead goes to the correct path?I attempted to change this in the test but got nowhere and I was unable to located an answer through googling.

2015-11-05 15:02:37Z

I am trying to write some tests for an application.  I have the server set up on MAMP going to dev.myappnamehere.com.When I run a test (based off of Laracasts Integrated) it fails because it is looking for the routeBut what it needs to go to is How can I change that so it does not default to looking for the localhost and instead goes to the correct path?I attempted to change this in the test but got nowhere and I was unable to located an answer through googling.From Laravel 5.4 the $baseUrl method doesn't seem to work anymoreAlso, trying to set the url dinamically with \Config:set('app.url', 'http://dev.myappnamehere') doesn't work either, as it seems that Laravel caches the root urlA way to set a custom root url is:So shortly after I asked I stumbled on the answer.  In there is a function called which sets the url it looks for.  Once I changed that it looked in the correct spot.  That file was part of the laracast testing that I loaded in.For Laravel 5,

In the tests directory there should be a file called TestCase.php. In that file is a property $baseUrl. Update the value to your desired url. For example change toChange the APP_URL in your .env file from localhost to your desired URL.Ex:

APP_URL=http://myproject.testMost likely you need to change a domain root in your existing request(). testThe below instead

Difference between get() and all() in laravel

Muhammad Raheel

[Difference between get() and all() in laravel](https://stackoverflow.com/questions/15362252/difference-between-get-and-all-in-laravel)

What is difference between these two in laravelAndAnd which one i should prefer.

2013-03-12 13:12:14Z

What is difference between these two in laravelAndAnd which one i should prefer.Taken from the laravel source:So all() calls get() and returns it's contents along with query(), and file() the $_FILES superglobal.Preference will obviously depend on circumstance. I personally choose to use Input::get($key, $default) as I usually know what I am after.From the Laravel Manual: http://laravel.com/docs/inputRetrieve a value from the input array:Note: The "get" method is used for all request types (GET, POST, PUT, and DELETE), not just GET requests.Retrieve all input from the input array:Retrieve all input including the $_FILES array:By default, null will be returned if the input item does not exist. However, you may pass a different default value as a second parameter to the method:

Laravel - Checking passwords before manually logging in

Silverfall05

[Laravel - Checking passwords before manually logging in](https://stackoverflow.com/questions/20783790/laravel-checking-passwords-before-manually-logging-in)

I'm getting problem with manually logging in users using Auth::loginUsingId

. Before I do that I need to check if password matches and there is my problem. Password comparision is always returning false;That's how I save password to DB:And that's how I try to compare these two passwordsAnd this is returning false, and I don't know where the problem is.EDIT:

In DB field varchar is 70 char long, hash is 60 characters longOk I've noticed: that every time Hash::make gives another string from my password. How it's even possible? I mean how then Auth::attempt works?

2013-12-26 11:11:15Z

I'm getting problem with manually logging in users using Auth::loginUsingId

. Before I do that I need to check if password matches and there is my problem. Password comparision is always returning false;That's how I save password to DB:And that's how I try to compare these two passwordsAnd this is returning false, and I don't know where the problem is.EDIT:

In DB field varchar is 70 char long, hash is 60 characters longOk I've noticed: that every time Hash::make gives another string from my password. How it's even possible? I mean how then Auth::attempt works?Try the following:

Laravel 5.4 - How to use multiple error messages for the same custom validation rule

Marc

[Laravel 5.4 - How to use multiple error messages for the same custom validation rule](https://stackoverflow.com/questions/44696091/laravel-5-4-how-to-use-multiple-error-messages-for-the-same-custom-validation)

In order to reuse code, I created my own validator rule in a file named ValidatorServiceProvider :And I use this rule like this :But, I want to set different error messages for each case, something like this : But I don't figure out how to achieve this without doing 2 differents rules ...

Of course it could work with multiple rules but it will also perform multiple SQL queries, and I really want to avoid that.

Also, keep in mind that in real case I could have more than 2 validations like theses in a single rule.Does anyone have an idea ?=====

EDIT 1 :Actually, I think that I want something that works in a similar way than the beetween or size rules.

They represent one single rule, but provide multiple error messages :Laravel checks if the value represents a numeric, a file, a string or an array ; and gets the right error message to use.

How do we achieve this kind of thing with custom rule ?

2017-06-22 09:57:07Z

In order to reuse code, I created my own validator rule in a file named ValidatorServiceProvider :And I use this rule like this :But, I want to set different error messages for each case, something like this : But I don't figure out how to achieve this without doing 2 differents rules ...

Of course it could work with multiple rules but it will also perform multiple SQL queries, and I really want to avoid that.

Also, keep in mind that in real case I could have more than 2 validations like theses in a single rule.Does anyone have an idea ?=====

EDIT 1 :Actually, I think that I want something that works in a similar way than the beetween or size rules.

They represent one single rule, but provide multiple error messages :Laravel checks if the value represents a numeric, a file, a string or an array ; and gets the right error message to use.

How do we achieve this kind of thing with custom rule ?Unfortunately Laravel doesn't currently provide a concrete way to add and call your validation rule directly from your attribute params array. But that's does not exclude a potential and friendly solution based on Trait and Request usage.Please find below my solution for example.First thing is to wait for the form to be processed to handle the form request ourselve with an abstract class. What you need to do is to get the current Validator instance and prevent it from doing further validations if there's any relevant error. Otherwise, you'll store the validator instance and call your custom user validation rule function that you'll create later :The next step is to create your Trait which will provide the way to validate your inputs thanks to the current validator instance and handle the correct error message you want to display :Finally, do not forget to extend your MyCustomFormRequest. For example, after your php artisan make:request CreateUserRequest, here's the easy way to do so :I hope that you'll find your way in what I suggest.Poor handling of custom validation rules is why I ditched laravel (well, it was one of many reasons, but it was the straw that broke the camel's back, so to speak).  But anyway, I have a three part answer for you: a reason why you don't want to do this in this specific case, a quick general overview of the mess you have to deal with, and then the answer to your question in case you still want to do it. Important security concernBest security practices for managing logins dictate that you should always return one generic error message for login problems.  The quintessential counter-example would be if you returned "That email is not registered with our system" for an email-not-found and "Wrong password" for a correct email with the wrong password.  In the case where you give separate validation messages, you give potential attackers additional information about how to more effectively direct their attacks.  As a result, all login-related issues should return a generic validation message, regardless of the underlying cause, something to the effect of "Invalid email/password combination".  The same is true for password recovery forms, which often say something like, "Password recovery instructions have been sent to that email, if it is present in our system".  Otherwise you give attackers (and others) a way to know what email addresses are registered with your system, and that can expose additional attack vectors.  So in this particular case, one validation message is what you want.The trouble with laravelThe issue you are running into is that laravel validators simply return true or false to denote whether or not the rule is met.  Error messages are handled separately.  You specifically cannot specify the validator error message from inside your validator logic.  I know.  It's ridiculous, and poorly planned.  All you can do is return true or false.  You don't have access to anything else to help you, so your pseudo code isn't going to do it.The (ugly) answerThe simplest way to create your own validation messages is to create your own validator.  That looks something like this (inside your controller):You would still have to create your validator on boot (your Valiator::Extend call.  Then you can specify the $rules normally by passing them in to your custom validator.  Finally, you can specify your messages.  Something like this, overall (inside your controller):(I don't remember if you have to specify each rule in your $messages array.  I don't think so).  Of course, even this isn't very awesome, because what you pass for $messages is simply an array of strings (and that is all it is allowed to be).  As a result, you still can't have this error message easily change according to user input.  This all happens before your validator runs too.  Your goal is to have the validation message change depending on the validation results, however laravel forces you to build the messages first.  As a result, to really do what you want to do, you have to adjust the actual flow of the system, which isn't very awesome.A solution would be to have a method in your controller that calculates whether or not your custom validation rule is met.  It would do this before you make your validator so that you can send an appropriate message to the validator you build.  Then, when you create the validation rule, you can also bind it to the results of your validation calculator, so long as you move your rule definition inside of your controller.  You just have to make sure and not accidentally call things out of order.  You also have to keep in mind that this requires moving your validation logic outside of the validators, which is fairly hacky.  Unfortunately, I'm 95% sure there really isn't any other way to do this.I've got some example code below.  It definitely has some draw backs: your rule is no longer global (it is defined in the controller), the validation logic moves out of the validator (which violates the principle of least astonishment), and you will have to come up with an in-object caching scheme (which isn't hard) to make sure you don't execute your query twice, since the validation logic is called twice.  To reiterate, it is definitely hacky, but I'm fairly certain that this is the only way to do what you want to do with laravel.  There might be better ways to organize this, but this should at least give you an idea of what you need to make happen.Also, it is worth a quick note that this implementation relies on $this support for closures, which (I believe) was added in PHP 5.4.  If you are on an old version of PHP you'll have to provide $this to the closure with use.Edit to rantWhat it really boils down to is that the laravel validation system is designed to be very granular.  Each validation rule is specifically only supposed to validate one thing.  As a result, the validation message for a given validator should never have to be changed, hence why $messages (when you build your own validator) only accepts plain strings.In general granularity is a good thing in application design, and something that proper implementation of SOLID principles strive for.  However, this particular implementation drives me crazy.  My general programming philosophy is that a good implementation should make the most common uses-cases very easy, and then get out of your way for the less-common use-cases.  In this cases the architecture of laravel makes the most common use-cases easy but the less common use-cases almost impossible.  I'm not okay with that trade off.  My general impression of Laravel was that it works great as long as you need to do things the laravel way, but if you have to step out of the box for any reason it is going to actively make your life more difficult.  In your case the best answer is to probably just step right back inside that box, i.e. make two validators even if it means making a redundant query.  The actual impact on your application performance likely will not matter at all, but the hit you will take to your long-term maintainability to get laravel to behave the way you want it will be quite large.Alternatively to the other proposals, I think you could also call Validator::replacer('yourRule', function()) in addition to Validator::extend('yourRule', function(...)) and keep track of what causes validation failures in the service provider class you're extending the validator from. This way, you are be able to completely replace the default error message with another one.According to docs, replacer() is meant for making placeholder replacements in the error message before it is being returned, so while this is not strictly that case, it is close enough. Of course, it's kind of an ugly(ish) workaround, but it will probably work (at least it seems to work for me, at a first glance).One thing to keep in mind though is that you'll probably have to keep track of these failure causes in an array if you want to avoid automatically returning same message for all fields that failed your custom validation rule.Where have you found the error messages for the size validation?I looked up the validation rules in the

Illuminate\Validation\ConcernsValidatesAttributes trait and all functions return a bool value (also the size validation).What you have found belongs to this part:In this case it's only for formatting the the output by setting a lowerRule value, that laravel handles in special cases, like the size validation:So as long as validation rules have to return a bool value there is no way to return more than one error message. Otherwise you have to rewrite some party of the validation rules.An approach for your problem with the validation you could use the exists validation:So you would need 2 exists validation rules. I would suggest to use the existing one from laravel to check if the email is set and a custom one to check if the account is validated.

Laravel passport installation error

Arafath

[Laravel passport installation error](https://stackoverflow.com/questions/41886595/laravel-passport-installation-error)

I've just downloaded the latest laravel 5.3 and I'm trying to install passport, but I'm getting the following composer error:Composer .json file 

http://pastebin.com/ne4RkL96

2017-01-27 03:33:20Z

I've just downloaded the latest laravel 5.3 and I'm trying to install passport, but I'm getting the following composer error:Composer .json file 

http://pastebin.com/ne4RkL96It happens, because after releasing Laravel 5.4, this package also had been updated to v 2.0 and requires Laravel 5.4. But you are using Laravel 5.3. Try to install earlier version:Also, you can learn about the versions of this package here:Laravel PassportIn line with Rashad's answer as it helped me out, you need a version of passport less than major version 2. This can be accomplished with several version strings ^v1, v1.x, >= 1 < 2 and several other combinations.I used this: php composer.phar require laravel/passport ^v1 and it worked awesomely.For Laravel 5.3. In your composer.json file put "laravel/passport": "~1.0" and  run "composer update" command.

Laravel 5 SwiftMailer's Send: how to get error code

user1506104

[Laravel 5 SwiftMailer's Send: how to get error code](https://stackoverflow.com/questions/45819536/laravel-5-swiftmailers-send-how-to-get-error-code)

Good day guys,I am sending email similar to this: Laravel 5: Sending Email. This is how I do it:Now, if the $ret_status is 'sent_failed', I want to know what happened. How do I do it? How can I see the message from the mail server?Here is my .env file:UPDATE:Looks like the approach above is Laravel 4. If you know how to get the error code using Laravel 5+, I can consider it as the correct answer.

2017-08-22 13:50:32Z

Good day guys,I am sending email similar to this: Laravel 5: Sending Email. This is how I do it:Now, if the $ret_status is 'sent_failed', I want to know what happened. How do I do it? How can I see the message from the mail server?Here is my .env file:UPDATE:Looks like the approach above is Laravel 4. If you know how to get the error code using Laravel 5+, I can consider it as the correct answer.You can use try catch for that, also you mistaken that use $email, $email_from, $email_name, $subject without passing into function scope.Added failure printing for email address to check email fail for which address.Checking Mail::failures() immediately after Mail::send() will return an array of failed email addresses you tried to send an email to.However, as far as I know you cannot get the exact error on failure using Mail facade. For that, you need to set the debug true on your .env and check on Laravel log.here is a working example:and the dd() result:

Laravel Eloquent - Using pivot table's id as a foreign key in another table

Tornike

[Laravel Eloquent - Using pivot table's id as a foreign key in another table](https://stackoverflow.com/questions/26238639/laravel-eloquent-using-pivot-tables-id-as-a-foreign-key-in-another-table)

I need to use pivot table's id as a foreign key in another table.for example i have following tables:so when user says I am going to that place, I have a new entry in place_user table and start to log the route he takes to get there. So for each place_user entry i have many entries in routes table.what is the correct way of doing this kind of relationship using eloquent? Should I create a model for the pivot table?I have tried to solve my problem by the following solution but no luck: https://github.com/laravel/framework/issues/2093#issuecomment-39154456 and posted a comment there https://github.com/laravel/framework/issues/2093#issuecomment-58187802any suggestions will be appreciated.

2014-10-07 14:39:19Z

I need to use pivot table's id as a foreign key in another table.for example i have following tables:so when user says I am going to that place, I have a new entry in place_user table and start to log the route he takes to get there. So for each place_user entry i have many entries in routes table.what is the correct way of doing this kind of relationship using eloquent? Should I create a model for the pivot table?I have tried to solve my problem by the following solution but no luck: https://github.com/laravel/framework/issues/2093#issuecomment-39154456 and posted a comment there https://github.com/laravel/framework/issues/2093#issuecomment-58187802any suggestions will be appreciated.After lots of searching and trying different solutions I came up with the following solution:User Model:Place Model:PlaceUser Model:I have Changed name route to footprint to avoid problems with route class included in laravel.Footprint Model:In the end I get structure where I can make different queries like:hope this helps

Language Translation popup is missing on DOM ready in browser: Laravel 5.2

Pankaj

[Language Translation popup is missing on DOM ready in browser: Laravel 5.2](https://stackoverflow.com/questions/36851759/language-translation-popup-is-missing-on-dom-ready-in-browser-laravel-5-2)

I have below code in my controller.Definition of method to fetch data is below.In English language file I have below code.In French language file I have below code.In View file I have below code.Normally when we visit a website that isn't the default language set in our browser we see a notification to translate the page on page load. See the screenshot below:However, this is not happening for my website. Although I can see the French language, the translate notification is not popping up so that I can translate it in English. Why?

2016-04-25 21:52:48Z

I have below code in my controller.Definition of method to fetch data is below.In English language file I have below code.In French language file I have below code.In View file I have below code.Normally when we visit a website that isn't the default language set in our browser we see a notification to translate the page on page load. See the screenshot below:However, this is not happening for my website. Although I can see the French language, the translate notification is not popping up so that I can translate it in English. Why?Chrome translation does not change your template variables or tells your website it should display another language. It uses google translate to translate it (in other words: it would not look up the english language file on your server to translate "F Country" to "E Country", but would translate "F Country" with google translate).To get the message, your site has to contain french words. Try replacing "F Country" in your language file with an actual french word (or maybe a whole sentence), or just put some french content on your test page.If you don't get the message, check your chrome settings ("Offer page translation when a webpage is not in ..."), or if you disabled it for your site.Then check if your site metadata contains <meta name=」google」value=」notranslate」>, it will disable the message for your site.Your trans(...) can be used to translate your site on your end: You can e.g. set the local language (session) variable by a button "I'm french" to let the user change it, by using the browsers language settings or by some other mean - but this has nothing to do with chrome translate and especially would work on other browsers too.Update since you asked what the language files are for: They are used when you parse your files (e.g. when you create the page the user requests); it makes your code (which is usually language indepentent) and content manageable: to add or edit a language, you don't have to change the coding-files and risk destroying something, you can just change app()->setLocale at one point.  But this parsing is done before the content gets to the user: so basically you either send that specific sentence in french or in english to the user, but not both. You can of course use app()->setLocale with a variable that is specific to the user (or "session"). In some function that the user can call (e.g. the action of some form) useThis will set a session-variable, and you can use this variable from now on to set the language you use to parse your files (on your end!) not with a fixed value, but the session-variable viaSo again: you still send your content in just one language to the user, but you or the user can choose which one it should be. Setting the active language always needs to be done before you parse a request (e.g. put it in a middlewareclass that runs (be)for every request). You can set the session-variable by the browser language settings, the url (e.g. depending on entering mysite.com or fr.mysite.com or mysite.fr you can just set the value of the language variable) and about 404 other possibilities.Google uses various parts of a site to determine the language and (probably) offer a translation hint for that.The following things you can try to make sure that they are correctly set and hope, Chrome is considering these:There is no 100% guide by Google and also no 100% certainty that Google Chrome detects the correct language. Laravel resource lang has nothing related to translate in browser. Request contains locale and laravel can respect that via resource-lang. As a result laravel will present text in clients browser local settings via the code you wrote.

More info here content negotiationWhy dont you have a dropdown select btn with defined languages ?

You can use this library : https://github.com/ruyadorno/dom-i18n to get it working

How do you find the underlying class behind a Laravel facade?

the_velour_fog

[How do you find the underlying class behind a Laravel facade?](https://stackoverflow.com/questions/29736616/how-do-you-find-the-underlying-class-behind-a-laravel-facade)

For example - this function uses a facade:It turns out the underlying class that actually supplies File::get is Illuminate\Filesystem\FilesystemI looked at the Laravel 4.2 documentation - thats the version Im using - and also the api reference but I couldn't find anything that would explain how to someone who didn't know in advance how to find the "real" class to a facade.  this tutorial on Laravel facades gives a method of doing it which involvesThis is a good demonstration of whats going on, but I wouldn't want to do this regularly.  My question is, knowing that the "facaded classes" you use in your app dont necessarily have a the same name or some convention to help you search the filesystem,  how can someone - who doesn't know in advance what the underlying class is - find the underlying class for a laravel facade? 

2015-04-19 22:26:48Z

For example - this function uses a facade:It turns out the underlying class that actually supplies File::get is Illuminate\Filesystem\FilesystemI looked at the Laravel 4.2 documentation - thats the version Im using - and also the api reference but I couldn't find anything that would explain how to someone who didn't know in advance how to find the "real" class to a facade.  this tutorial on Laravel facades gives a method of doing it which involvesThis is a good demonstration of whats going on, but I wouldn't want to do this regularly.  My question is, knowing that the "facaded classes" you use in your app dont necessarily have a the same name or some convention to help you search the filesystem,  how can someone - who doesn't know in advance what the underlying class is - find the underlying class for a laravel facade? This is a nice resource: https://laravel.com/docs/facades#facade-class-reference other than that make sure to install some kind of intellisense plugin for whatever editor you happen to be using. Most of them allow you to Ctrl+Right-Click on a class/method and go to the definition.It seems that you can use getFacadeRoot(). For example, to find out what's behind the Mail facade:

Single Laravel Route for multiple controllers

omer Farooq

[Single Laravel Route for multiple controllers](https://stackoverflow.com/questions/31368433/single-laravel-route-for-multiple-controllers)

I am creating a project where i have multiple user types, eg. superadmin, admin, managers etc. Once the user is authenticated, the system checks the user type and sends him to the respective controller. The middle ware for this is working fine.So when manager goes to http://example.com/dashboard he will see the managers dashboard while when admin goes to the same link he can see the admin dashboard. The below route groups work fine individually but when placed together only the last one works.I know we can rename the routes like superadmin/dashboard and admin/dashboard but i was wondering if there is any other way to achieve the clean route. Does anyone know of any anywork arounds ? BTW i am using LARAVEL 5.1Any help is appreciated :)

2015-07-12 13:46:49Z

I am creating a project where i have multiple user types, eg. superadmin, admin, managers etc. Once the user is authenticated, the system checks the user type and sends him to the respective controller. The middle ware for this is working fine.So when manager goes to http://example.com/dashboard he will see the managers dashboard while when admin goes to the same link he can see the admin dashboard. The below route groups work fine individually but when placed together only the last one works.I know we can rename the routes like superadmin/dashboard and admin/dashboard but i was wondering if there is any other way to achieve the clean route. Does anyone know of any anywork arounds ? BTW i am using LARAVEL 5.1Any help is appreciated :)The best solution I can think is to create one controller that manages all the pages for the users. example in routes.php file:your PagesController.php file:You can do this with a Before Middleware that overrides the route action's namespace, uses and controller attributes:This way you have to register each route only once without the final namespace prefix:The middleware will convert 'dashboard@index' to 'Admin\dashboard@index' or 'SuperAdmin\dashboard@index' depending on current user's role attribute as well as apply the role specific middleware.

How to automatically enable php extensions in Homestead on vagrant up

Wesley Smith

[How to automatically enable php extensions in Homestead on vagrant up](https://stackoverflow.com/questions/40641526/how-to-automatically-enable-php-extensions-in-homestead-on-vagrant-up)

Im using Laravel 5.3 in Homestead with Vagrant  1.8.7 running on VirtualBox. I have need to enable some php extensions.I know that I could ssh into the box and edit the php.ini to enable the extension but this seems like a very anti-vagrant way to do this.I want to tell Vagrant to provision the box with specific php extensions enabled so that I can simply call vagrant up --provision and the box will be ready to go (kinda the point of vagrant right?)So, How can we automatically enable php extensions in Homestead on vagrant up?

2016-11-16 20:17:32Z

Im using Laravel 5.3 in Homestead with Vagrant  1.8.7 running on VirtualBox. I have need to enable some php extensions.I know that I could ssh into the box and edit the php.ini to enable the extension but this seems like a very anti-vagrant way to do this.I want to tell Vagrant to provision the box with specific php extensions enabled so that I can simply call vagrant up --provision and the box will be ready to go (kinda the point of vagrant right?)So, How can we automatically enable php extensions in Homestead on vagrant up?After some tinkering, the below is what I came up with. I make no assurances that this is the right way to do it only that, in my case, it seems to be working:Find the after.sh that was generated when you installed homestead. For me, on Mac El Capitain, the file is created at ~/.homestead/after.sh, I imagine there is a .bat in a similar location on windows.Do not make the mistake of editing ~/Homestead/src/stubs/after.sh, thats the template file from the homestead installation, not your actual generated copy.Add the below lines to after.sh (this is my whole file, only the first 5 comment lines were in the default file):If you dont psychically know the exact name for the extension you need (I didnt) you can use sudo apt-cache search php7-* or similar to list the available onesNow, if you have homestead up, in the terminal, cd to your Homestead dir, for me cd ~/Homestead and then run vagrant destroyWhile inside /Homestead run vagrant up --provisionTo check that the extensions installed correctly, while inside /Homestead run these two commands:vagrant sshphp -r "print_r(get_loaded_extensions());"My output (33 and 61 were added):Like I stated at the beginning, I cant say this is the right way, but it's working for me so far.you should first log onto Homestead server using ssh ( probably you know this already - "vagrant ssh").then go to "/etc/php/7.0/fpm/" 

there is also for cli on this location  "/etc/php/7.0/cli/"

edit it with "sudo vi php.ini" ( esc and :wq to save changes ). then you should restart nginx: "sudo nginx -s reload"and after that, restart php-fpm: "sudo service php7.0-fpm restart" if you are not sure if it is php 5.x or 7.x on your homestead, use "find / -name php.ini" to find php.ini, you will probably get 2 or 3 results. In case there's still a need for this :=> https://guides.wp-bullet.com/install-apcu-object-cache-for-php7-for-wordpress-ubuntu-16-04/=> Run the 3 first commands :Or simply add to after.sh: 

Laravel download file from php output buffer VS. private storage folder | security

Roman

[Laravel download file from php output buffer VS. private storage folder | security](https://stackoverflow.com/questions/57923991/laravel-download-file-from-php-output-buffer-vs-private-storage-folder-securi)

A user can download query results in CSV format. The file is small (a few KB), but the contents are important.The first approach is to use php output buffer php://:The second approach is to create a new folder in laravels storage system and set it to private and download the file from there. You could even delete the file after the download:Here is the create/download code:This return will instantly delete the file after the download:What would be more secure? What is the better approach? I am currently leaning towards the second approach with the storage.

2019-09-13 12:51:25Z

A user can download query results in CSV format. The file is small (a few KB), but the contents are important.The first approach is to use php output buffer php://:The second approach is to create a new folder in laravels storage system and set it to private and download the file from there. You could even delete the file after the download:Here is the create/download code:This return will instantly delete the file after the download:What would be more secure? What is the better approach? I am currently leaning towards the second approach with the storage.Option 1Reasons:If you were dealing with files that are tens/hundreds of MB, I'd be thinking differently...Let's think about all options,Option 1 is good solution because you are not storing the file. It will be more secure than others. But timeout can be a problem at high traffic.Option 2 also good solution with delete. But you need to create files with unique names so you can use parallel downloads.Option 3 is like option 2 but if you are using laravel don't use it. (And think about 2 people are downloading at the same time)After this explanation, you need to work on option 1 to make it more secure if you are using one server. But if you are using microservices you need work on option 2. I can suggest one more thing to make it secure. Create a unique hashed URL. For example, use timestamp and hash it with laravel and check them before URL. So people can't download again from download history. https://example.com/download?hash={crypt(timestamp+1min)}If it is not downloaded in 1 min URL will be expired.I think the reply depends on the current architecture and the size of file to download(1)st approach is applicable when: Reasons:.

.

.(2)nd approach is applicable when: Reasons:Still, I consider expiration time instead or additionally to the downloading fact -- the download process can fail, or the file is lost (ensure 1+ hour availability) or vice versa the user will try to download it only after 1 year or never -- why should you keep this file for more than N days?I think first optionis more secure then other where you're not storing file anywhere.

Can you reload Boris in Laravel 4.1 without having to exit?

Dave

[Can you reload Boris in Laravel 4.1 without having to exit?](https://stackoverflow.com/questions/20590171/can-you-reload-boris-in-laravel-4-1-without-having-to-exit)

While using php artisan tinker, I changed some class files in my project. Is there a way to reload the REPL without having to type exit and php artisan tinker again?

2013-12-15 01:11:40Z

While using php artisan tinker, I changed some class files in my project. Is there a way to reload the REPL without having to type exit and php artisan tinker again?If the sequence CTRL+d, up, enter is too long for you, you could file a feature request with laravel, but last time I checked you couldn't Redefine Class Methods or Class , so I think isn't a trivial thing to do.If tinkering is all you do you could make it even shorter starting your tinker session withNow just the CTRL+d will reload the tinker session.And if that is too much to type you could define a Terminal/iTerm Profile with this command:

PHP $_COOKIE is not entirely populated

stevendesu

[PHP $_COOKIE is not entirely populated](https://stackoverflow.com/questions/32428076/php-cookie-is-not-entirely-populated)

I've spent a little while trying to trace the root cause of a particular Laravel bug since the original GitHub issue was closed without resolution.After some time of experimenting I discovered that the session was being regenerated because the laravel_session cookie was set to null. Tracing this back as far as possible, I found that in index.php -- before Laravel ever loads -- the value of $_COOKIE is corrupt... sometimesAbout 90% of the time when I make a call to my app, my cookies look like so:But then 10% of the time, it looks like so:Using a web proxy (Charles) to monitor network traffic, the issue is not on my end -- the full cookie string is being sent, but the server is only seeing a partial message (the laravel_session cookie gets cut off)Every time the issue occurs, it gets cut off at the exact same spot: 678 bytes after the start of the cookie string (1435 bytes into the raw HTTP request text). Strangely the request body is transmitted with no harm, and this comes after the cookie string in the raw HTTP request, so it's not a matter of the TCP connection failing out.I'm using PHP's built-in development server (php -S 0.0.0.0:80). I tried using Apache to see if it resolves the issue and while it seems like the cookie string always comes across correctly with Apache, I've got another error where PHP utterly crashes and burns upon hitting a file_put_contents call. I have the following code:Which is returning only Writing... (LOCK_EX: 2)<br />\nNone of "Done.", "WHAT", or "Failed?" are displayed.Looking as ps all to see if the server was hanging, I don't even see the Apache process. However I know Apache is running because if I stop Apache (sudo apachectl stop) I stop getting any response from the serverI'm really not sure what's going on (why Apache is failing or why the PHP built-in server is cutting off my $_COOKIE variable).As a final note, I've already checked the permissions on the file I'm attempting to write to:So it's not that.Per @Siguza's suggestion, I tried adding another cookie to see what would happen. Upon first inspection it looked like there was some very strange behavior going on when I ran dd( $request->cookies ) before decryption:SuccessFailureStrangely the new cookie I added (yetAnotherCookie) is entirely gone while the laravel session still gets truncated. Inspecting the HTTP request, I noticed that yetAnotherCookie was appended at the end, so truncating the whole string would reasonably remove it from the list:PHPSESSID=k8qvmt8ccbhcqepbn7mib8kra6; __unam=bc7c68-14f8d12a5ef-43097c02-217; __utma=152883115.857409601.1438038184.1440976773.1441571912.15; __utmb=152883115.4.9.1441572254693; __utmc=152883115; __utmz=152883115.1435960225.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); XSRF-TOKEN=eyJpdiI6ImVqcW1cL09cL3oyQ0ZIcFBiQTRmZXFKUT09IiwidmFsdWUiOiJEbzV0NHcraGNmd3BMb0hibG5uNm9UTnhvNlV4bVRCVWRHOWFBM3VrOG0wZ2Z2NmF5QnpuNFh6a1dYdmhcL2pmWUtIb2lsOGdBS29xV0hvNnFOQktxR2c9PSIsIm1hYyI6IjRjMjU4ZWYxMTJkZTQ1NTU2YWQ3M2EwZjAzZDQwNDI4YzNmOTJjYTVhZTUzZTg4MzFmNTUxZDFkMTljNDBjZjkifQ%3D%3D; laravel_session=eyJpdiI6IkRkcGNLRE9KK3hkOFRNdzFXQzQreWc9PSIsInZhbHVlIjoiQm1qN2lNa2pTQTE2ZTQxUzJxbExGYnhheFhjUkQwMEpybEQ3XC9cL0pDMzA1MXdEeHF3a09qbnRKTjdPMzRKdjdBeFFNQ1hkamw1THFQanlnUURoRjJndz09IiwibWFjIjoiYTkzNjdmYjYyYTMzODM2MmY2MjQyNzZhNDQ1YjY2NzQ3OTFiZjVjODIyZmYzYmE3YjhlNGM1ZjQ2NTk1MTczNyJ9; yetAnotherCookie=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789I cleared all of my cookies for the domain and tried again:SuccessFailureOnly yetAnotherCookie was truncated this time, not laravel_session. Looking at the HTTP request again, this cookie has made its way to the end of the list again despite being set first (I guess Chrome alphabetized the list of cookies?) only now the full list was shorter:__unam=bc7c68-14f8d12a5ef-43097c02-217; XSRF-TOKEN=eyJpdiI6ImV6aklvVVNwZHdCMThON1hQOW9rcmc9PSIsInZhbHVlIjoiWlY1aGdQamJ1Y2FQTGxTUDZTTmxPK2xLZm5xZG15enlVXC95RXhRMHNqbm9udkp5T3NnR3FBQ0dxRWEzYTdIVUFveHA1TTZkV2lTcGlcL1wvalQzQ09QbUE9PSIsIm1hYyI6IjYyMzM5MGM4MjYxNzYzNmI5NGYyZDFmMTU3M2M4NTA5NzBlYjZlMGZmMmViM2QzNjlhZjZmNTdlMmE4ZmRjMmUifQ%3D%3D; laravel_session=eyJpdiI6Illzd2xnalRXVzhKaVI0blRQUUtiNXc9PSIsInZhbHVlIjoiKzVaQVR0cHNqbDZEcGd5UG9POWFhbFdyYzhaTDNqb1FOQ2xmcEFYVUZUZTJkNUZSYzNRUlhCajJhNHBNK3VXd2gxYlwvUWtiTEE0bk5lVmp0d2lcL3pkQT09IiwibWFjIjoiNjA5MDU2ODViYTQ4YmM0YjlmYWVmOWY1NzliY2Y3YjdhYjMzYTA0MWU4ZjMwODg0N2E5NGI2N2U2ZDc3MTIwNSJ9; yetAnotherCookie=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789It cut off at 685 bytes this time instead of the 678 from earlier. Curiouser and curiouser.Here's another odd one. I tried hitting a slightly different endpoint. Instead of www.mywebsite.com/api/employees/1, I pinged www.mywebsite.com/api/employees/10This time one additional letter was removed from the cookie string. This prompted me to look at the entire raw HTTP request one more. Exactly 1435 bytes into the raw HTTP request is when the cookie string got cut off.So I performed one more experiment: I sent a huge custom header using the following javascript from the browserI also modified the return value slightly because Laravel's dd() function wraps the return value in a lot of HTML that would make it hard to interpret in the console. With the really long header in place, I got the following after a few attempts:This was actually 1460 bytes into the raw request... I'm not sure how to interpret the fact that it behaved differently, but this is suggesting some weird 1450-ish byte limit before PHP's built-in server craps out on the HTTP request.Attempted to upgrade PHP to 5.6First apt-get failed me. apt-get install --only-upgrade php5 just installed a slightly newer 5.5.9Then I downloaded the source from php.net and attempted to build from source. Per the INSTALL instructions, you should run ./configure before running make and make install, so I tried it out. After a short while I got the following:I tried updating this with apt-get install libxml2 and got the following:Since ./configure failed me and I can't upgrade libxml2, I tried just installing:It's possible I'm just incompetent as a server admin, but I don't know how to install PHP 5.6 without a helpful MSI file

2015-09-06 20:39:28Z

I've spent a little while trying to trace the root cause of a particular Laravel bug since the original GitHub issue was closed without resolution.After some time of experimenting I discovered that the session was being regenerated because the laravel_session cookie was set to null. Tracing this back as far as possible, I found that in index.php -- before Laravel ever loads -- the value of $_COOKIE is corrupt... sometimesAbout 90% of the time when I make a call to my app, my cookies look like so:But then 10% of the time, it looks like so:Using a web proxy (Charles) to monitor network traffic, the issue is not on my end -- the full cookie string is being sent, but the server is only seeing a partial message (the laravel_session cookie gets cut off)Every time the issue occurs, it gets cut off at the exact same spot: 678 bytes after the start of the cookie string (1435 bytes into the raw HTTP request text). Strangely the request body is transmitted with no harm, and this comes after the cookie string in the raw HTTP request, so it's not a matter of the TCP connection failing out.I'm using PHP's built-in development server (php -S 0.0.0.0:80). I tried using Apache to see if it resolves the issue and while it seems like the cookie string always comes across correctly with Apache, I've got another error where PHP utterly crashes and burns upon hitting a file_put_contents call. I have the following code:Which is returning only Writing... (LOCK_EX: 2)<br />\nNone of "Done.", "WHAT", or "Failed?" are displayed.Looking as ps all to see if the server was hanging, I don't even see the Apache process. However I know Apache is running because if I stop Apache (sudo apachectl stop) I stop getting any response from the serverI'm really not sure what's going on (why Apache is failing or why the PHP built-in server is cutting off my $_COOKIE variable).As a final note, I've already checked the permissions on the file I'm attempting to write to:So it's not that.Per @Siguza's suggestion, I tried adding another cookie to see what would happen. Upon first inspection it looked like there was some very strange behavior going on when I ran dd( $request->cookies ) before decryption:SuccessFailureStrangely the new cookie I added (yetAnotherCookie) is entirely gone while the laravel session still gets truncated. Inspecting the HTTP request, I noticed that yetAnotherCookie was appended at the end, so truncating the whole string would reasonably remove it from the list:PHPSESSID=k8qvmt8ccbhcqepbn7mib8kra6; __unam=bc7c68-14f8d12a5ef-43097c02-217; __utma=152883115.857409601.1438038184.1440976773.1441571912.15; __utmb=152883115.4.9.1441572254693; __utmc=152883115; __utmz=152883115.1435960225.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); XSRF-TOKEN=eyJpdiI6ImVqcW1cL09cL3oyQ0ZIcFBiQTRmZXFKUT09IiwidmFsdWUiOiJEbzV0NHcraGNmd3BMb0hibG5uNm9UTnhvNlV4bVRCVWRHOWFBM3VrOG0wZ2Z2NmF5QnpuNFh6a1dYdmhcL2pmWUtIb2lsOGdBS29xV0hvNnFOQktxR2c9PSIsIm1hYyI6IjRjMjU4ZWYxMTJkZTQ1NTU2YWQ3M2EwZjAzZDQwNDI4YzNmOTJjYTVhZTUzZTg4MzFmNTUxZDFkMTljNDBjZjkifQ%3D%3D; laravel_session=eyJpdiI6IkRkcGNLRE9KK3hkOFRNdzFXQzQreWc9PSIsInZhbHVlIjoiQm1qN2lNa2pTQTE2ZTQxUzJxbExGYnhheFhjUkQwMEpybEQ3XC9cL0pDMzA1MXdEeHF3a09qbnRKTjdPMzRKdjdBeFFNQ1hkamw1THFQanlnUURoRjJndz09IiwibWFjIjoiYTkzNjdmYjYyYTMzODM2MmY2MjQyNzZhNDQ1YjY2NzQ3OTFiZjVjODIyZmYzYmE3YjhlNGM1ZjQ2NTk1MTczNyJ9; yetAnotherCookie=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789I cleared all of my cookies for the domain and tried again:SuccessFailureOnly yetAnotherCookie was truncated this time, not laravel_session. Looking at the HTTP request again, this cookie has made its way to the end of the list again despite being set first (I guess Chrome alphabetized the list of cookies?) only now the full list was shorter:__unam=bc7c68-14f8d12a5ef-43097c02-217; XSRF-TOKEN=eyJpdiI6ImV6aklvVVNwZHdCMThON1hQOW9rcmc9PSIsInZhbHVlIjoiWlY1aGdQamJ1Y2FQTGxTUDZTTmxPK2xLZm5xZG15enlVXC95RXhRMHNqbm9udkp5T3NnR3FBQ0dxRWEzYTdIVUFveHA1TTZkV2lTcGlcL1wvalQzQ09QbUE9PSIsIm1hYyI6IjYyMzM5MGM4MjYxNzYzNmI5NGYyZDFmMTU3M2M4NTA5NzBlYjZlMGZmMmViM2QzNjlhZjZmNTdlMmE4ZmRjMmUifQ%3D%3D; laravel_session=eyJpdiI6Illzd2xnalRXVzhKaVI0blRQUUtiNXc9PSIsInZhbHVlIjoiKzVaQVR0cHNqbDZEcGd5UG9POWFhbFdyYzhaTDNqb1FOQ2xmcEFYVUZUZTJkNUZSYzNRUlhCajJhNHBNK3VXd2gxYlwvUWtiTEE0bk5lVmp0d2lcL3pkQT09IiwibWFjIjoiNjA5MDU2ODViYTQ4YmM0YjlmYWVmOWY1NzliY2Y3YjdhYjMzYTA0MWU4ZjMwODg0N2E5NGI2N2U2ZDc3MTIwNSJ9; yetAnotherCookie=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789It cut off at 685 bytes this time instead of the 678 from earlier. Curiouser and curiouser.Here's another odd one. I tried hitting a slightly different endpoint. Instead of www.mywebsite.com/api/employees/1, I pinged www.mywebsite.com/api/employees/10This time one additional letter was removed from the cookie string. This prompted me to look at the entire raw HTTP request one more. Exactly 1435 bytes into the raw HTTP request is when the cookie string got cut off.So I performed one more experiment: I sent a huge custom header using the following javascript from the browserI also modified the return value slightly because Laravel's dd() function wraps the return value in a lot of HTML that would make it hard to interpret in the console. With the really long header in place, I got the following after a few attempts:This was actually 1460 bytes into the raw request... I'm not sure how to interpret the fact that it behaved differently, but this is suggesting some weird 1450-ish byte limit before PHP's built-in server craps out on the HTTP request.Attempted to upgrade PHP to 5.6First apt-get failed me. apt-get install --only-upgrade php5 just installed a slightly newer 5.5.9Then I downloaded the source from php.net and attempted to build from source. Per the INSTALL instructions, you should run ./configure before running make and make install, so I tried it out. After a short while I got the following:I tried updating this with apt-get install libxml2 and got the following:Since ./configure failed me and I can't upgrade libxml2, I tried just installing:It's possible I'm just incompetent as a server admin, but I don't know how to install PHP 5.6 without a helpful MSI fileCongrats, you found a PHP bug; I've just reported it.You can't do anything about it now, except waiting for a fix.As I noted inside the bug report, the cause really is that the headers are so large, thus the browser splitting it up into multiple TCP packets… and the HTTP parser in sapi/cli/php_http_parser.c currently does not seem to back up the buffer with the header value in case it needs to wait for the next packet and merging it with the next packet later. Hence, it ends up to be truncated.As code tells sometimes more than text: a simple reproduce case: http://git.php.net/?p=php-src.git;a=commitdiff;h=37d814b84cff3678a2e1d56ea9d3ba3c35082e13

Model relationships in Laravel 5.3

Detryer

[Model relationships in Laravel 5.3](https://stackoverflow.com/questions/42020559/model-relationships-in-laravel-5-3)

I've got MySQL tables for site cart:Class Cart, which contains goods:Class Good, which can be Detail or Appliance and relative to cart by cart_id:Detail class:And i need to get all appliances and details in cart. How can i do it by using ORM?

2017-02-03 09:10:58Z

I've got MySQL tables for site cart:Class Cart, which contains goods:Class Good, which can be Detail or Appliance and relative to cart by cart_id:Detail class:And i need to get all appliances and details in cart. How can i do it by using ORM?Use nested eager loading. Assuming that relationship method names are cartGoods, details and appliances, that details are details of a cart and that you've defined the relationships right:Try this:Method 1: If you have a $cart model instanceMethod 2: If you need all appliances and details from cart by card IDI've done this, problem was in model name, i was writing it to DB like Detail and Appliance, but i was need to useIn AppServiceProvider class.

How to test POST routes in Laravel

Martyn

[How to test POST routes in Laravel](https://stackoverflow.com/questions/28790348/how-to-test-post-routes-in-laravel)

I'm doing the following to test a POST call to Laravel. I'm expecting that POST to questions, in accordance with my routes, will be dispatches as the store action method. This works in the browser.My test:However, I tells me that the redirect doesn't match. Also, I can see that it isn't going to the store action method at all. I want to know what action method it is going to, and why it isn't going to the store method (if I look at route:list I can see there is a POST questions/ route that should go to questions.store; this also works in the browser, but not in my tests). Also, am I writing the call correctly for this resource? I added the token here as it was throwing an exception as it should, in some tests I will let the token check pass.

2015-03-01 05:12:24Z

I'm doing the following to test a POST call to Laravel. I'm expecting that POST to questions, in accordance with my routes, will be dispatches as the store action method. This works in the browser.My test:However, I tells me that the redirect doesn't match. Also, I can see that it isn't going to the store action method at all. I want to know what action method it is going to, and why it isn't going to the store method (if I look at route:list I can see there is a POST questions/ route that should go to questions.store; this also works in the browser, but not in my tests). Also, am I writing the call correctly for this resource? I added the token here as it was throwing an exception as it should, in some tests I will let the token check pass.You could try this:The most recommended way to test your routes is to check for 200 response. This is very helpful when you have multiple tests, like you are checking all of your post routes at once.To do so, just use:I use in order to assert validation works. But to use this, you must start from the page that is going to send the post request. Like this:Then if you want to test that the errors also being displayed correctly back. Run again above test with some changes as per below:My guess is that if you dont start with the page to show the error, (the create / update page where you put the form), chain of session during the process will miss some important keys.I was getting a TokenMismatchException and this fixed it, maybe it helps you tooLaravel Unit cases without middleware

Extending core Laravel 5 functionality

Marcin Nabiałek

[Extending core Laravel 5 functionality](https://stackoverflow.com/questions/29084661/extending-core-laravel-5-functionality)

The question is quite simple - is it possible to extend Laravel 5 functionality in any smart way or you need to copy sometimes a lot of code/classes just to achieve what you want.Because it's quite broad, I'll give you 2 examples.1) I would like to change urls for edit and create for \Illuminate\Routing\ResourceRegistrar. At the moment the only way I found to achieve that is: extending main Illuminate Application to pass own RoutingServiceProvider, then extend Router, then extend Illuminate\Routing\ResourceRegistrar and finally in bootstrap/app.php use our extended Application class. Quite a lot of modifications just to change 2 lines. Many methods are in fact duplicated just to pass our custom class which code is exact the same except it uses class from other namespace2) Other similar change - set custom paths for cached config - you need to again extend  Application to override method getCachedConfigPath and then make a change in bootstrap/app.phpSo the question is - is it the way that some modifications need to be done or maybe the same (for example those 2 above) could be achieved somehow easier not extending core Application class and making so many changes?

2015-03-16 18:48:21Z

The question is quite simple - is it possible to extend Laravel 5 functionality in any smart way or you need to copy sometimes a lot of code/classes just to achieve what you want.Because it's quite broad, I'll give you 2 examples.1) I would like to change urls for edit and create for \Illuminate\Routing\ResourceRegistrar. At the moment the only way I found to achieve that is: extending main Illuminate Application to pass own RoutingServiceProvider, then extend Router, then extend Illuminate\Routing\ResourceRegistrar and finally in bootstrap/app.php use our extended Application class. Quite a lot of modifications just to change 2 lines. Many methods are in fact duplicated just to pass our custom class which code is exact the same except it uses class from other namespace2) Other similar change - set custom paths for cached config - you need to again extend  Application to override method getCachedConfigPath and then make a change in bootstrap/app.phpSo the question is - is it the way that some modifications need to be done or maybe the same (for example those 2 above) could be achieved somehow easier not extending core Application class and making so many changes?You should be able to overwrite the core ResourceRegistrar by binding your own implementation to the service container:Let MyResourceRegistrar extend the core ResourceRegistrar and you should be able to overwrite the edit and create methods:

vagrant homestead can't access host(laravel 5.2)

YaSh Chaudhary

[vagrant homestead can't access host(laravel 5.2)](https://stackoverflow.com/questions/38726056/vagrant-homestead-cant-access-hostlaravel-5-2)

When I goto my host ao.dev:8000 or ao.dev, "this site can't be reached,ao.dev refused to connect" is displayed.My yaml file:also i've my view file:i've checked:I've run vagrant up command by going to Homestead directory .Also see: https://stackoverflow.com/questions/38801375/vagrant-up-not-forwarding-all-portshomesteadlaravel-5-2windows-10

2016-08-02 16:37:14Z

When I goto my host ao.dev:8000 or ao.dev, "this site can't be reached,ao.dev refused to connect" is displayed.My yaml file:also i've my view file:i've checked:I've run vagrant up command by going to Homestead directory .Also see: https://stackoverflow.com/questions/38801375/vagrant-up-not-forwarding-all-portshomesteadlaravel-5-2windows-10Actually I was using WAMP before installing homestead.

So I uninstalled both i.e. wamp and homestead setup including vagrant and virtual box.

Then I installed homestead setup again and it worked.

I dont know the logic behind but maybe wamp and homestead were conflicting.

It worked so I posted the answer.What I needed to do to get my local Laravel up and running:Additionally:Here is an example Homestead.yaml file from one of my own projects:Notice how my paths are double-quoted (to: "/home/vagrant/example")? In your code above, these paths are not double-quoted as they should be.I also recommend after you fix your configuration that you completely destroy and re-create your VM by running:vagrant destroy -f && vagrant upIn your Laravel project root directory.Your Vagrant VM machine is up but you can't reach to the machine.Can you paste your hosts file on your host machine?Can you paste the output of a "nmap 192.168.10.10" from your host machine?Can you paste "ls /etc/nginx/sites-enabled/ -la" on your Vagrant VM machine?I had the same problem, I installed and run fiddler and it was enough to solve it.

delete confirmation in laravel

yudijohn

[delete confirmation in laravel](https://stackoverflow.com/questions/32984859/delete-confirmation-in-laravel)

I have the following code:How to add a confirmation on delete each data?

2015-10-07 06:04:46Z

I have the following code:How to add a confirmation on delete each data?I prefer a more easier way, just add onclick="return confirm('Are you sure?')", as bellow:If this is your link:Use this Javascript:Note: the <a> needs the delete in class.

This solution uses Unobtrusive JavaScript and should work with IE 9 or newer.With brexis/laravel-data-method package, you can specify appropriate HTTP method and a confirmation text.This is helpful if you have this for example into your routes file:If this is your link:Route:Use this Javascript:Note: the <a> needs the delete in class.

This solution uses Unobtrusive JavaScript and should work with IE 9 or newer.index.blade.phpI used pure PHP Form, the method DELETE has to be passed as hidden on the submit page action, so I catch it trough javascript and I get the confirmation alert.

How to change / Custom password field name for Laravel 4 and Laravel 5 user authentication [duplicate]

Marcin Nabiałek

[How to change / Custom password field name for Laravel 4 and Laravel 5 user authentication [duplicate]](https://stackoverflow.com/questions/26073309/how-to-change-custom-password-field-name-for-laravel-4-and-laravel-5-user-auth)

I would like to change password field in database when using Laravel authentication. I want my column in users table has name passwd and not password. I tried to run something like this:but it doesn't work. I also tried to add in User model the following function:but it also changes nothing. User is still not being authenticated. Is it possible in Laravel to change password field name in database ?

2014-09-27 09:41:23Z

I would like to change password field in database when using Laravel authentication. I want my column in users table has name passwd and not password. I tried to run something like this:but it doesn't work. I also tried to add in User model the following function:but it also changes nothing. User is still not being authenticated. Is it possible in Laravel to change password field name in database ?You can change easy all other fields in database and use them for authentication. The only problem is with password field.In fact password field is in some way hard coded in Laravel (but not the way many think) so you cannot just pass array as you passed in your question.By default if you pass array to attempt (and probably other Auth functions like validate or once) if you do it this way:default Eloquent driver will run the following query:After getting this data from database it will compare password you gave with password property for User object that was created.But if you simply use:the following query will be run:and no user will be found in database (in passwd you store hashed password). This is because Eloquent removes from query password but use any other data to run query. Also if you try here to use 'passwd' => Hash:make($data['password']) although user will be found, comparing password won't work.Solution is quite easy. You need to run Auth::attempt like this:As you see you still pass password as key (although this column doesn't exits in users table)  because only this way Eloquent driver won't use it for building query.Now in User model (app/models/User.php) file you need to add the following function:As you see you use here the column that really exists in database: passwd. Using it this way you can have column with password named anything you want and you can still use default Eloquent driver for it.I've created very simple test for it.You just need to replace your app/routes.php file with the following:This solution was tested in Larave 4.2.9 (everything as above) and also in Laravel 5. In Laravel5 everything works the same but you need of course edit files in different paths:

Using Laravel 5 with AngularJS blade tag conflict

imperium2335

[Using Laravel 5 with AngularJS blade tag conflict](https://stackoverflow.com/questions/28548694/using-laravel-5-with-angularjs-blade-tag-conflict)

I am trying to setup Angular with Laravel 5.I have tried doing in appServiceProvider:With:But I'm getting:

2015-02-16 19:14:01Z

I am trying to setup Angular with Laravel 5.I have tried doing in appServiceProvider:With:But I'm getting:When doing changes that have to do with Blade (Extending Blade, changing the tags etc) always make sure to delete the cached views.They're located in storage/framework/views.Just delete all files (except the .gitignore)If you want something a bit more practical you can create a command to do that. Like this oneThe easiest way to do this is to simply use @ in front of your Angular code:sourceWhile adding @ in front of the braces does still work, Laravel has also included another handy blade utility that lets you mark an entire block as-is:Particularly helpful if you're not doing much with the Blade template renderingElse you modify angular syntax...

how to check if a user email already exist

ballerz

[how to check if a user email already exist](https://stackoverflow.com/questions/17799148/how-to-check-if-a-user-email-already-exist)

In laravel, when a new user is registering to my site and the email they use already exist in the database. how can tell the user that the email already exist ?. I am new to laravel framework. A sample code would be nice too.

2013-07-22 23:29:10Z

In laravel, when a new user is registering to my site and the email they use already exist in the database. how can tell the user that the email already exist ?. I am new to laravel framework. A sample code would be nice too.The validation feature built into Laravel lets you check lots of things, including if a value already exists in the database. Here's an overly simplified version of what you need. In reality you'd probably want to redirect back to the view with the form and show some error messages.);Laravel has built-in human readable error messages for all its validation. You can get an array of the these messages via: $validator->messages();You can learn more about validation and what all you can do with it in the Laravel Docs.Basic Usage Of Unique RuleSpecifying A Custom Column NameForcing A Unique Rule To Ignore A Given IDAdding Additional Where ClausesYou may also specify more conditions that will be added as "where" clauses to the query:The above is from the documentation of LaravelYou could add:You can add more rules to the $rules like:It will automatically produce the error messagesand add:to the model User.phpThen in the function you're using to register, you could add:The great resource is only Laravel Documentation @ 

enter link description hereI also did like below when integrating user management system

Syntax error or access violation: 1115 Unknown character set: utf8mb4

Alexu

[Syntax error or access violation: 1115 Unknown character set: utf8mb4](https://stackoverflow.com/questions/41835923/syntax-error-or-access-violation-1115-unknown-character-set-utf8mb4)

I am migrating my classes but I am getting this error in laravel.How do I resolve this error?

2017-01-24 18:05:55Z

I am migrating my classes but I am getting this error in laravel.How do I resolve this error?Go to config/database.php and replace these two lines with these'charset' => 'utf8',

            'collation' => 'utf8_unicode_ci',Go to config/database.php and replace these lines. That's it

Adding a new config file in Laravel 5 not working

geoffs3310

[Adding a new config file in Laravel 5 not working](https://stackoverflow.com/questions/28794861/adding-a-new-config-file-in-laravel-5-not-working)

I want a new config file in my Laravel 5 app to store all my constants in. After looking around the net I found the recommended solution seems to be to create a new config file that returns an array of key value pairs and then use that. So I created the following file:Then in one of my controllers I try to access one of these values like so:I just get the following error:Do I have to do something else to get it to work?

2015-03-01 14:47:46Z

I want a new config file in my Laravel 5 app to store all my constants in. After looking around the net I found the recommended solution seems to be to create a new config file that returns an array of key value pairs and then use that. So I created the following file:Then in one of my controllers I try to access one of these values like so:I just get the following error:Do I have to do something else to get it to work?In Laravel 5, to avoid this kind of headache, you can use the config helper function to get a config item, like this : config('constants.ADMIN_EMAIL')Nice and easy ;)The Config class is an alias in the global namespace. To reference it from inside the controller (which is in the App\Http\Controllers namespace) you have to prepend it with a backslash:Or add a use statement above the controller class:As an alternative you might also want to use dependency injection to access the config. That would look somewhat like this:As @Bernig suggests you can also simply use the new config() helper function:I met the same issue today, and I find an elegant solution: 

add the config/your_new_config.php to ConfigServiceProvider, like this:The reason is well explained in the function's comments

file_put_contents , failed to open stream: No such file or directory Laravel [duplicate]

Wahid Nahiyan

[file_put_contents , failed to open stream: No such file or directory Laravel [duplicate]](https://stackoverflow.com/questions/32126122/file-put-contents-failed-to-open-stream-no-such-file-or-directory-laravel)

I just want to run my client's project in to my local and having this problem.ErrorException in compiled.php line 6301: file_put_contents(C:\xampp\htdocs\tiger\storage/framework/views/111182673e168569a2371e23629d9c08): failed to open stream: No such file or directoryit is something like permission issue .. and i am windows user don't know how to figure it ... experts can u help me ? Thanks in Advance.

2015-08-20 18:52:36Z

I just want to run my client's project in to my local and having this problem.ErrorException in compiled.php line 6301: file_put_contents(C:\xampp\htdocs\tiger\storage/framework/views/111182673e168569a2371e23629d9c08): failed to open stream: No such file or directoryit is something like permission issue .. and i am windows user don't know how to figure it ... experts can u help me ? Thanks in Advance.In case anyone here is using Homestead like me, you can run into the same issue using PHPUnit. When you run php artisan config:cache, Laravel hardcodes some paths in the cache. If you run it on your Homestead VM, it uses those paths. If you run it from your workstation, it uses those paths. You should make your cache from the Homestead VM and then execute your tests from there as well to avoid cache problems.You can tell when the cache needs to be cleared by looking at the file path that PHPUnit tries to use. If it's not a valid path on the machine you're running the command from, you need to rebuild your cache.I had the same exact problem, try thisThis solves the problemThis code clear the cache and delete cache files.Inside the folder C:\xampp\htdocs\tiger\storage/framework/views

make a file named 111182673e168569a2371e23629d9c08now refresh your browser 

this should solve your problem in window 

for linux users you should provide permission to for this file

Laravel s3 multiple buckets

Leandro Ferreira

[Laravel s3 multiple buckets](https://stackoverflow.com/questions/35225836/laravel-s3-multiple-buckets)

My Laravel application needs to manipulate files present in multiple buckets simultaneously into a single session. So, I couldn't find a way to change several times the current bucket, since my .env file is like this:I found somewhere that I could do this:but It works only once. What I need is something like:Where /bucket-name/ could be any bucket that I already create. What can I do? Thanks a lot!

2016-02-05 13:49:31Z

My Laravel application needs to manipulate files present in multiple buckets simultaneously into a single session. So, I couldn't find a way to change several times the current bucket, since my .env file is like this:I found somewhere that I could do this:but It works only once. What I need is something like:Where /bucket-name/ could be any bucket that I already create. What can I do? Thanks a lot!You are correct in that  Config::set(); only works once per request. My estimation is that this is done intentionally to stop the kind of thing you are attempting to do in your code example.In config/filesystems.php you can list any number of "disks". These are locations of your file repositories. It looks like so:The solution is to create a new disk of the extra buckets you want to use. Treat your buckets like different disks.Note: The user that the S3_Key belongs to needs to have permissions to perform your required actions on the S3 buckets you are setting up as additional 'disks'.Then whenever you want to access the bucket of your choice call it like so:If you have dynamic buckets you also can create a new instance like this:You can add the buckets to the filesystems config like so:Then you can access the server using the following:

Laravel 5 Carbon global Locale

Mathieu Urstein

[Laravel 5 Carbon global Locale](https://stackoverflow.com/questions/32549845/laravel-5-carbon-global-locale)

I'm trying to set the same global locale of laravel which is :to work with Carbon.It seems like you can do it by using either :or So I have tried using middleware or providers but was not successful.(why is this not a default feature of laravel?)

2015-09-13 12:49:42Z

I'm trying to set the same global locale of laravel which is :to work with Carbon.It seems like you can do it by using either :or So I have tried using middleware or providers but was not successful.(why is this not a default feature of laravel?)So this is my bad, Carbon is actually using the phpthemethod is only for themethod.

Notice that the php setlocale() reference to the locale stored on your OS

to choose one of the installed one useon your consolesecondly, you have to usemethod instead ofmethodand lastly all the usefull methods likeare not being localizedand lastly you have to use these parsing lettershttp://php.net/manual/en/function.strftime.phpI configured it in the AppServiceProvider.in AppServiceProviderthen to make locale output do something like thisFor more information about converting localize dates you can see on below link

https://carbon.nesbot.com/docs/#api-localization

Laravel Homestead

AxlSmith

[Laravel Homestead](https://stackoverflow.com/questions/23709039/laravel-homestead)

I'm trying to get Laravel Homestead up and running. I believe I did everything as manual says. When I run vagrant up -command I get following error on OS X 10.9: My Homestead.yaml file is following:And this is what I get while executing vagrant up:

2014-05-17 08:04:25Z

I'm trying to get Laravel Homestead up and running. I believe I did everything as manual says. When I run vagrant up -command I get following error on OS X 10.9: My Homestead.yaml file is following:And this is what I get while executing vagrant up:Map your projects directory to something else than /home/vagrant:This should fix your problem and you probably don't want your vagrant's config files (.ssh, .bashrc, etc) synced back to your local projects directory anyway.Also your keys property should be set to private key, not public.If you look at original Homestead.yaml again, you'll see that:authorize needs your public key (id_rsa.pub)keys needs your privte key (id_rsa)keys should be:keys: - /Users/foo/.ssh/id_rsa

not 

keys: - /Users/foo/.ssh/id_rsa.pubHomestead is just an implementation of vagrant.Try:If this still doesn't work, tryA little suggestion here based on my own learning experience. Homestead provides a nice and neat way for beginners to work on Laravel Framework in no time. However, I think the vagrant settings and weird environment is not straight forward to me. I believe everyone has to work with the real Server and Laravel environment eventually. Therefore, I decided to give up homestead and simply install Ubuntu on VirtualBox. Then, I followed official instructions here and installed my Laravel pretty easily. Just for your information. Just go straight to the real Laravel system instead of Homestead.

laravel 5.1 not seeing changes to Job file without VM restart

Nicekiwi

[laravel 5.1 not seeing changes to Job file without VM restart](https://stackoverflow.com/questions/30881324/laravel-5-1-not-seeing-changes-to-job-file-without-vm-restart)

I have created a new Job in a laravel 5.1 app, running in Homestead VM. I've set it to be queued and have code in the handle method.The handle() method previous expected a param to be passed, but is no longer required and I've removed the param form the handle method. However, when the queue runs the job I get an error saying:line 31 of that file is:Its not longer expecting any parameters, unless there's a default one that's not documented. Now ANY changes I make, including comments out ALL content in the Job file are not seen when I run the queue. I will still get the same error.Ive tried restarting nginx, php5-fpm, supervisor, beanstalkd, and running: artisan cache:clear, artisan clear-compiled, artisan optimize, composer dumpautoload. Nothing works. The only way I get get laravel to see any updated to the Job file is to restart the VM. vagrant halt, then vagrant up.The job is triggered in a console command like this:  Here is the full code of the SpecialJob.php file:http://laravel.io/bin/qQQ3M#5I tried created another new Job and tested, I get the same result. All other non-job files update instantly, no issue. Its just the Job files. Like an old copy is being cached somewhere I can't find. 

2015-06-17 02:25:36Z

I have created a new Job in a laravel 5.1 app, running in Homestead VM. I've set it to be queued and have code in the handle method.The handle() method previous expected a param to be passed, but is no longer required and I've removed the param form the handle method. However, when the queue runs the job I get an error saying:line 31 of that file is:Its not longer expecting any parameters, unless there's a default one that's not documented. Now ANY changes I make, including comments out ALL content in the Job file are not seen when I run the queue. I will still get the same error.Ive tried restarting nginx, php5-fpm, supervisor, beanstalkd, and running: artisan cache:clear, artisan clear-compiled, artisan optimize, composer dumpautoload. Nothing works. The only way I get get laravel to see any updated to the Job file is to restart the VM. vagrant halt, then vagrant up.The job is triggered in a console command like this:  Here is the full code of the SpecialJob.php file:http://laravel.io/bin/qQQ3M#5I tried created another new Job and tested, I get the same result. All other non-job files update instantly, no issue. Its just the Job files. Like an old copy is being cached somewhere I can't find. When running the queue worker as a daemon, you must tell the worker to restart after a code change.

Laravel 5 echo out session variable containing html in blade

Webtect

[Laravel 5 echo out session variable containing html in blade](https://stackoverflow.com/questions/32172241/laravel-5-echo-out-session-variable-containing-html-in-blade)

I did a redirect in laravel:$returnData is a string that contains a bootstrap info div with the result from the controller. Almost everything is working except when the page loads again it shows the html on the page as if it were text, brackets and everything. If I use this:Then it shows is as pure text. If I change it toIt works fine. Im ok keeping it like this but I would rather utilize Blade / Laravel as its supposed to be used so I was wondering if there is a way to have the @if statement show the rendered html and not the text version?

2015-08-23 22:38:59Z

I did a redirect in laravel:$returnData is a string that contains a bootstrap info div with the result from the controller. Almost everything is working except when the page loads again it shows the html on the page as if it were text, brackets and everything. If I use this:Then it shows is as pure text. If I change it toIt works fine. Im ok keeping it like this but I would rather utilize Blade / Laravel as its supposed to be used so I was wondering if there is a way to have the @if statement show the rendered html and not the text version?I would recommend returning just the error message then in your view create the div. So if you were to change the layout of the view, you would it in one place. hope this help. To show the rendered HTML you should use {!! $variable->coontent !!} in your view, and this gonna convert your HTML text to render May this example will help you.

Try this Try changing your blade code to following.

Laravel dynamic page title in navbar-brand

nclsvh

[Laravel dynamic page title in navbar-brand](https://stackoverflow.com/questions/34497428/laravel-dynamic-page-title-in-navbar-brand)

I have layouts.app.blade.php where I have my <html> and <body> tags and also the <nav>.

In the <body> I yield content for every page, so they basically extend this app.blade.php.

All basic Laravel stuff so now I have this:  And I would like to use this <a class="navbar-brand"> to display my pagetitle. So this means it has to change for each template that is loaded (with @yield('content')) in this 'parent.blade.php'.How would I do this using Laravel 5.2?Many thanks

2015-12-28 16:51:20Z

I have layouts.app.blade.php where I have my <html> and <body> tags and also the <nav>.

In the <body> I yield content for every page, so they basically extend this app.blade.php.

All basic Laravel stuff so now I have this:  And I would like to use this <a class="navbar-brand"> to display my pagetitle. So this means it has to change for each template that is loaded (with @yield('content')) in this 'parent.blade.php'.How would I do this using Laravel 5.2?Many thanksIf this is your master page title belowthen your page title can be changed in your blade page like belowMore information can be found here Laravel DocsYou can pass it to a view for exampleControllerViewor php7Blade view like this-instead of-And now in your view you can use:

After upgrading Laravel from 5.6 to 6.0, Call to undefined str_random() function not working

Vishal Srivastava

[After upgrading Laravel from 5.6 to 6.0, Call to undefined str_random() function not working](https://stackoverflow.com/questions/58163406/after-upgrading-laravel-from-5-6-to-6-0-call-to-undefined-str-random-function)

I have upgraded Laravel from 5.6 to 6.0. Previously, default helper functions were running fine on the controllers, but now it says "undefined." In my controller, I have used the following.I am getting the following error.I have also used the random() function, and it's saying the same thing.Can somebody please guide me on what to do?.I have run commands like:But I get the same error.

2019-09-30 07:36:50Z

I have upgraded Laravel from 5.6 to 6.0. Previously, default helper functions were running fine on the controllers, but now it says "undefined." In my controller, I have used the following.I am getting the following error.I have also used the random() function, and it's saying the same thing.Can somebody please guide me on what to do?.I have run commands like:But I get the same error.In Laravel 6 All str_ and array_ helpers have been moved to the new laravel/helpers Composer package and removed from the framework. If desired, you may update all calls to these helpers to use the Illuminate\Support\Str and Illuminate\Support\Arr classes. Alternatively, you can add the new laravel/helpers package to your application to continue using these helpers:If don't want to add Package then Used Str And Arr Classes.For Example :https://laravel.com/docs/master/helpers#method-str-randomAdd the following string library.now you can use it as below.alternatively, install the following package.

Trying to get key in a foreach loop to work using blade

Artful_dodger

[Trying to get key in a foreach loop to work using blade](https://stackoverflow.com/questions/33641912/trying-to-get-key-in-a-foreach-loop-to-work-using-blade)

if I use {{$node[0]->url}} then Laravel's templating engine dislays the correct result but I can not figure out how to display all using the @for $i=0 within a @foreach loop this is what I have in my routes fileand this is what I have tried in my view filesorry here is the complete print_r result

2015-11-10 23:55:13Z

if I use {{$node[0]->url}} then Laravel's templating engine dislays the correct result but I can not figure out how to display all using the @for $i=0 within a @foreach loop this is what I have in my routes fileand this is what I have tried in my view filesorry here is the complete print_r resultThe simple answer is that foreach in Blade works the same as a regular PHP foreach. You should be able to do something like:If you need access to the array key value for each node:However, I think the problem may not be with your Blade syntax, but with the way you created your input variables. Given the way you created $oReturn in the code above, it won't have the properties you appear to be expecting. To illustrate, here's a simplified version of what you appear to be creating:would return:So when you do @foreach ($oReturn as $node) the value of $node would be the entry[] array, which has a single element, that is an array of nodes. It is not clear from your input that these nodes even have url elements. If you did want to loop through the nodes you'd have to do something like:Does this make sense? I think you need to rethink your creation of $oReturn.Given feedback below and the output of your print_r statement above, the following should work:The (string) casts the result of $node->url to string. Otherwise PHP may treat it as some kind of object. SimpleXMLElement can be weird.

Laravel eloquent model how to get data from relationship's table

Ajeesh

[Laravel eloquent model how to get data from relationship's table](https://stackoverflow.com/questions/34082264/laravel-eloquent-model-how-to-get-data-from-relationships-table)

I am developing a laravel application which has the following eloquent modelsI have a controller 'ProductController' where the following code is availableI am exposing RESTfull API which will allow my users to get all product details (including skus, shipping types etc..).Suppose if I have an API GET : /productsThe code which fetches all the product details will be some what the followingNow my question is , is this logic proper? In this case all the logics are in the controller since im using eloquent models I have a model for each table and the relationships are defined in it. Is there a way I can get all the details of a product/associated model (Products details (in table 1)+ Sku details (in table 2)) rather than using the belowI am pretty new to laravel development and eloquent models. I will be using repository pattern for the development and in that case where does the aboe logic (Product+Sku combining) resides.Please help out.

2015-12-04 06:32:31Z

I am developing a laravel application which has the following eloquent modelsI have a controller 'ProductController' where the following code is availableI am exposing RESTfull API which will allow my users to get all product details (including skus, shipping types etc..).Suppose if I have an API GET : /productsThe code which fetches all the product details will be some what the followingNow my question is , is this logic proper? In this case all the logics are in the controller since im using eloquent models I have a model for each table and the relationships are defined in it. Is there a way I can get all the details of a product/associated model (Products details (in table 1)+ Sku details (in table 2)) rather than using the belowI am pretty new to laravel development and eloquent models. I will be using repository pattern for the development and in that case where does the aboe logic (Product+Sku combining) resides.Please help out.Yes, you can get the details of the products and skus without making one additional query per product using eager loading 

 ( this is referred as the typical N+1 query problem where N is the number of the products ) Suppose the relation between your Product and Sku models model is:ProductTo fetch the products data along with the sku data you can use the with method. In your controller:ControllerThen, in your views, you can get the info this way:ViewFor the repository question: if you want to use a repository you can place the eloquent-access part of your code inside the repository. So, for example you could have this method inside the repository:ProductRepositorythen you can use your repository in your controller:ControllerIf I understand your question correctly, you can use eager loading.This will give you an array of products that have a skus array in each product object.If the repository pattern is used, do it like this.You can try this:This will give you the exact result in the object form.

Laravel - Set global variable from settings table

Caio Kawasaki

[Laravel - Set global variable from settings table](https://stackoverflow.com/questions/34126578/laravel-set-global-variable-from-settings-table)

I'm trying to store all my settings from my settings table into a global variable, but I'm stucked now(I have no idea what's the next step), this is my actual model and seeder:model - Settings.phpseeder - SettingsTableSeeder.phpHow can I store all the data inside the settings table and make then acessible from blade, or any controller or view?Now, my question is, how can i update a single or multiple value(s) from a form?I have set this up:My route:My Admin\AdminConfiguracoesController:My SettingRepository:My blade form:But things does not work. How can I update the values into the table?

2015-12-07 04:41:55Z

I'm trying to store all my settings from my settings table into a global variable, but I'm stucked now(I have no idea what's the next step), this is my actual model and seeder:model - Settings.phpseeder - SettingsTableSeeder.phpHow can I store all the data inside the settings table and make then acessible from blade, or any controller or view?Now, my question is, how can i update a single or multiple value(s) from a form?I have set this up:My route:My Admin\AdminConfiguracoesController:My SettingRepository:My blade form:But things does not work. How can I update the values into the table?See improved answer in Update 2I would add a dedicated Service Provider for this. It will read all your settings stored in the database and add them to Laravels config. This way there is only one database request for the settings and you can access the configuration in all controllers and views like this: Step 1: Create the Service Provider.You can create the Service Provider with artisan:php artisan make:provider SettingsServiceProviderThis will create the file app/Providers/SettingsServiceProvider.php.Step 2: Add this to the boot-method of the provider you have just created:From the Laravel Docs:http://laravel.com/docs/5.1/providers#the-boot-methodStep 3: Register the provider in your App.Add this line to the providers array in config/app.php:And that's it. Happy coding!Update: I want to add that the boot-method supports dependency injection. So instead of hard coding \App\Setting, you could inject a repository / an interface that is bound to the repository, which is great for testing.Update 2: As Jeemusu mentioned in his comment, the app will query the database on every request. In order to hinder that, you can cache the settings. There are basically two ways you can do that.To make thinks more fault tolerant, I'd use the second option. Caches can be cleared unintentionally. The first option will fail on fresh installations as long as the admin did not set the settings or you reinstall after a server crash.For the second option, change the Service Providers boot-method:Now you only have to make the cache forget the settings key after the admin updates the settings:To avoid querying the database on each request, you should save the settings to a config file each time they are changed by the admin/user. The above will create a Laraval compatible config file that essentially just returns an array of key => values. The generated file will look something like this.Any php file in the /config directory will be auto-included by Laravel and the array variables accessible to your application via the config() helper:You can store the data in the database just like you do it normally in Laravel. \App\Setting::create(), \App\Setting::new() and other methods.For using the values in blade, you can do {{\App\Setting::where('name','title')->pluck('value')}}And, you can also use scopes for this.then you could use \App\Setting::for('title')->pluck('value')

find in set in laravel ? example

Ravi Kadia

[find in set in laravel ? example](https://stackoverflow.com/questions/35594450/find-in-set-in-laravel-example)

I am new in laravel. My query is i need to find out value from comma separated field. Here is my table:tags_valueThis is my SQL query:but it's not working.Please help me to solve this problem.

Thanks in advance.

2016-02-24 06:03:39Z

I am new in laravel. My query is i need to find out value from comma separated field. Here is my table:tags_valueThis is my SQL query:but it's not working.Please help me to solve this problem.

Thanks in advance.You need to escape the call to FIND_IN_SET() using quotes:If you want to parameterize the column for which you search in FIND_IN_SET, then you can try something like this:Try this : 

Laravel: Enable Sentry user account be used in multiple computers

enchance

[Laravel: Enable Sentry user account be used in multiple computers](https://stackoverflow.com/questions/17393833/laravel-enable-sentry-user-account-be-used-in-multiple-computers)

While using Sentry in L4, is it possible to make an account be used in multiple computers at the same time? Right now, Sentry logs out the user the moment the same account is used in another computer.Right now I'm trying for that not to happen and keep both users logged in at the same time. I know that it's a security feature when a user gets logged out, but my project's circumstances aren't what you'd call normal.

2013-06-30 19:01:30Z

While using Sentry in L4, is it possible to make an account be used in multiple computers at the same time? Right now, Sentry logs out the user the moment the same account is used in another computer.Right now I'm trying for that not to happen and keep both users logged in at the same time. I know that it's a security feature when a user gets logged out, but my project's circumstances aren't what you'd call normal.Extension to Nico Kaag's answer and implementation of spamoom's comment:/app/config/packages/cartalyst/sentry/config.php/app/models/User.php

It is possible, but not supported by Sentry itself.

To do this, you have to change some core code in Sentry, or find a way to override the User class that's in the Sentry code.The function you need to adjust is "GetPresistCode()" in the User model, which can be found in:And this is how the function should look like (not tested):I have to say that I highly recommend you don't change the code in Sentry, and that you find another way around, but that might be really hard.

laravel orderByRaw() on the query builder

Amir

[laravel orderByRaw() on the query builder](https://stackoverflow.com/questions/20065972/laravel-orderbyraw-on-the-query-builder)

there is no way to make such a query(with the binding) using the Laravel query builder right now:this will order the results by relevance, If we had(which we don't now!) orderByRaw then the above query would be:I opened this issue but It didn't get anywhere:

https://github.com/laravel/framework/issues/2134any suggestion?

2013-11-19 07:49:54Z

there is no way to make such a query(with the binding) using the Laravel query builder right now:this will order the results by relevance, If we had(which we don't now!) orderByRaw then the above query would be:I opened this issue but It didn't get anywhere:

https://github.com/laravel/framework/issues/2134any suggestion?Using Eloquent you can do the following:The same would work with the Query Builder, but then you have to do a little rewriting.

Laravel「undefined method Illuminate\Database\Query\Builder::attach()」

glasstree

[Laravel「undefined method Illuminate\Database\Query\Builder::attach()」](https://stackoverflow.com/questions/22495130/laravel-undefined-method-illuminate-database-query-builderattach)

I'm trying to associate related models during database seeding in Laravel 4. According to the documentation here, I can do it like this:So, in my database seed I'm running:The packages items have already been seeded at this point, and they seed without problems. The above code gives this from Artisan though:Someone here seems to think that the attach() method doesn't actually exist and the docs are wrong, but I find that hard to believe.TL;DR What is the correct way to create many-to-many relationships in Eloquent?

2014-03-19 02:37:32Z

I'm trying to associate related models during database seeding in Laravel 4. According to the documentation here, I can do it like this:So, in my database seed I'm running:The packages items have already been seeded at this point, and they seed without problems. The above code gives this from Artisan though:Someone here seems to think that the attach() method doesn't actually exist and the docs are wrong, but I find that hard to believe.TL;DR What is the correct way to create many-to-many relationships in Eloquent?The function items() in your Package model has to return a BelongsToMany relationship in order to use attach().

Using Laravel Socialite with an API?

Rob

[Using Laravel Socialite with an API?](https://stackoverflow.com/questions/35966605/using-laravel-socialite-with-an-api)

I'm trying to use Laravel Socialite package over an api. I try to pass the code into my api to fetch the user but it keeps giving me an error:Since I'm doing the request over an API, I take the following steps.Send a request to api for the url to fetch the code:Then make a request with the above fetched url, which redirects with the code parameter.Send the code to the api and fetch the user:This is where it crashes. I'm not sure why. I've used the package before and it works fine when I just have an app that reloads the page. But when I send it to an api (on a different domain) it crashes. I'm thinking there is some issue with how the code is generated. Is there anyway to fix this?

2016-03-13 04:47:02Z

I'm trying to use Laravel Socialite package over an api. I try to pass the code into my api to fetch the user but it keeps giving me an error:Since I'm doing the request over an API, I take the following steps.Send a request to api for the url to fetch the code:Then make a request with the above fetched url, which redirects with the code parameter.Send the code to the api and fetch the user:This is where it crashes. I'm not sure why. I've used the package before and it works fine when I just have an app that reloads the page. But when I send it to an api (on a different domain) it crashes. I'm thinking there is some issue with how the code is generated. Is there anyway to fix this?Just found my answer. Need to use stateless in both calls:Hope this helps someone.I made SocialController.php and url (POST request) /api/social-login which accepts provider and access_token.SocialAccount here is a laravel model where you'll provider and provider_user_id and local database user id. Below is the example of social_accounts tableAnd in SocialController :EDIT:I have created package for the same https://packagist.org/packages/pimplesushant/laravelsocialiteapi

Artisan Call output in Controller?

user1469734

[Artisan Call output in Controller?](https://stackoverflow.com/questions/37726558/artisan-call-output-in-controller)

I have a complex Artisan Command that I wanna call in my Controller also. That works. Except that it return an Exitcode instead of output.I want the output of the command. How to do that? The last line of my Artisan command has a return on the last line that should be returned.. How?

2016-06-09 12:52:19Z

I have a complex Artisan Command that I wanna call in my Controller also. That works. Except that it return an Exitcode instead of output.I want the output of the command. How to do that? The last line of my Artisan command has a return on the last line that should be returned.. How?Some off commands can not run with php artisan in controller you need to run them with shellThis is the list of commands and api:gen and passport install just will run with shell from /bootstrap folder !code to output inspire phrases instead of exit code

Laravel using where clause on a withCount method

slapbot

[Laravel using where clause on a withCount method](https://stackoverflow.com/questions/39930975/laravel-using-where-clause-on-a-withcount-method)

I am trying to do a where clause on withCount method of laravel's eloquent query builder using this piece of code.and this code is giving me this error.So from what I can guess is that upvotes_count isn't selected and hence the column is not being found, BUT if I execute this piece of code.Then I am getting this output.Which basically means that upvotes_count is being selected, hence i am really confused about how to solve this problem.(More options that I tried so far are given below with the respective error associated to it.)error.code.ANDerror.I just want to use where clause on a count() method which is in a relationship with a parent model.

2016-10-08 09:49:51Z

I am trying to do a where clause on withCount method of laravel's eloquent query builder using this piece of code.and this code is giving me this error.So from what I can guess is that upvotes_count isn't selected and hence the column is not being found, BUT if I execute this piece of code.Then I am getting this output.Which basically means that upvotes_count is being selected, hence i am really confused about how to solve this problem.(More options that I tried so far are given below with the respective error associated to it.)error.code.ANDerror.I just want to use where clause on a count() method which is in a relationship with a parent model.You can achieve requested result by using:I'm not sure if this was implemented after your question, but you can now do it like thisI ran into the same problem, and tried the same things you did.  I'm guessing there is a way to replicate the SQL generated by the withCounts call but add a way to make xxx_counts available to a where clause, but I just filtered the resulting collection instead.If you need to select only rows that the counter is greater than or equal to 1 you can try the follow code:I don't know if this is the best solution but it's an alternative. Another alternative would be get the posts and use array filter as mentioned in a comment above.another good way to do this

we can filter that separately and even assign an alias to that column nameNow in blade you can do I think using has() is the best solution:You could also use a filter:You could also disable strict mode in config/database.php (probably not a good idea)You could also try to add a groupBy clause (using having in strict mode), but this will likely require you to include every column in your table (due to 'ONLY_FULL_GROUP_BY'), which could break things if you ever add another column to your table, and probably won't work anyway because I think you need to include 'upvotes_count' in the groupBy and it seems to be a non grouping field.

how to show 500 internal Server error page in laravel 5.2?

kunal

[how to show 500 internal Server error page in laravel 5.2?](https://stackoverflow.com/questions/41216672/how-to-show-500-internal-server-error-page-in-laravel-5-2)

I want to show the page 500 internal server error Page. when user had syntax error mistake in project can anyone help me? if i do some mistake in syntax i want to show that particular blade. 

2016-12-19 06:09:46Z

I want to show the page 500 internal server error Page. when user had syntax error mistake in project can anyone help me? if i do some mistake in syntax i want to show that particular blade. You need to create handler to catching FatalErrorExceptions in your handler like below code:Handler

In app/Exceptions/Handler.php View

See resources/views/errors/500.blade.php. If not exist then create it.You can get more detailed OR other ways from Laravel 5 custom error view for 500 In your resources/views/errors  folder create a file named 500.blade.php.The problem is that Laravel will only do this automatic rendering of error pages for exceptions that are instances of HttpException. Unfortunately when your server throws an error (method does not exist, variable undefined, etc) it actually throws a FatalErrorException. As such, it is uncaught, and trickles down to the SymfonyDisplayer() which either gives you the trace (debug true) or ugly one-liner 'Whoops, looks like something went wrong' (debug false).To solve this you have add this to your render method to app/Exceptions/HandlerDocsMy solution is simple, just replace your render() method in Exceptions\Handler.php file with:It will show 500 page if app in production environment. You will need to have 500.blade.php view in your resources/views/errors folder.Like @Amit said So my solution is to replace whatever exception that is not HttpException by a HttpException.in app\Exceptions\Handler create the following method:it will override the one in the parent class (Illuminate\Foundation\Exceptions\Handler) that displays the whoops page.In Laravel 5.4, you could override prepareException function in your app\Exception\Handler.php:

Laravel 4 route with unlimited number of parameters

David Maksimov

[Laravel 4 route with unlimited number of parameters](https://stackoverflow.com/questions/21522677/laravel-4-route-with-unlimited-number-of-parameters)

I'm trying to create a dynamic route for an unlimited number of URL levels.Here's my current routeThis works for the first level. So a URL like something.com/foo/ would work. But if I had something like something.com/foo/bar/ it wouldn't catch that URL. I need it to match unlimited levels. That way in my controller it'll get me a variable of whatever the entire link is.I know I could doBut that just seems like an overkill. Is there a better way to do this so it'll match to the end of the URL?Thanks.

2014-02-03 08:30:04Z

I'm trying to create a dynamic route for an unlimited number of URL levels.Here's my current routeThis works for the first level. So a URL like something.com/foo/ would work. But if I had something like something.com/foo/bar/ it wouldn't catch that URL. I need it to match unlimited levels. That way in my controller it'll get me a variable of whatever the entire link is.I know I could doBut that just seems like an overkill. Is there a better way to do this so it'll match to the end of the URL?Thanks.You can try something like this: Remember to put the above on the very end (bottom) of routes.php file as it is like a 'catch all' route, so you have to have all the 'more specific' routes defined first. This approach should let you use unlimited amount of params, so this is what you seem to need. @Fusion

https://laravel.com/docs/5.4/routing You may constrain the format of your route parameters using the where method on a route instance. The where method accepts the name of the parameter and a regular expression defining how the parameter should be constrained. so {id} is a route parameter , and ->where('id', '[0-9]+') is a regex expression for this parameter. If u need to use more than parameters you can do something like this : 

Laravel 5.1 - How to set a message on progress bar

Christopher

[Laravel 5.1 - How to set a message on progress bar](https://stackoverflow.com/questions/32015511/laravel-5-1-how-to-set-a-message-on-progress-bar)

I'm trying the same example as provided on Laravel docs:And this works well. I want to customize the progress bar (see this) but $this->output->setMessage('xpto'); gives:

2015-08-14 17:19:19Z

I'm trying the same example as provided on Laravel docs:And this works well. I want to customize the progress bar (see this) but $this->output->setMessage('xpto'); gives:The $this->output object is a instance of Symfony's Symfony\Component\Console\Style\SymfonyStyle, which provides the methods progressStart(), progressAdvance() and progressFinish().The progressStart() method dynamically creates an instance of Symfony\Component\Console\Helper\ProgressBar object and appends it to your output object, so you can manipulate it using progressAdvance() and progressFinish().Unfortunatelly, Symfony guys decided to keep both $progressBar property and getProgressBar() method as private, so you can't access the actual ProgressBar instance directly via your output object if you used progressStart() to start it.createProgressBar() to the rescue!However, there's a cool undocumented method called createProgressBar($max) that returns you a shiny brand new ProgressBar object that you can play with.So, you can just do:And do whatever you want with it using the Symfony's docs page you provided. For example:Hope it helps. ;)

Laravel Collection keys modification

pavon147

[Laravel Collection keys modification](https://stackoverflow.com/questions/40568745/laravel-collection-keys-modification)

I use filter method from Collection class to remove some objects from collection. But after that operation, sometimes objects with keys eg. 1, 4, 5 left. I would like to always have elements with order 0, 1, 2, 3 etc. after filter action.Is there any elegant way to do it without rewriting table to a new one?Thanks!

2016-11-12 23:11:42Z

I use filter method from Collection class to remove some objects from collection. But after that operation, sometimes objects with keys eg. 1, 4, 5 left. I would like to always have elements with order 0, 1, 2, 3 etc. after filter action.Is there any elegant way to do it without rewriting table to a new one?Thanks!You can use Laravel Collection's values() method to make the the keys of a collection in a serialized order like this:Hope this helps!

How do Laravel migrations work?

Recur

[How do Laravel migrations work?](https://stackoverflow.com/questions/30220377/how-do-laravel-migrations-work)

I'm totally new to this type of framework. I've come from barebones PHP development and I can't seem to find an easy to understand guide what migrations actually do.I'm trying to create a project that already has an existing database. I've used this: https://github.com/Xethron/migrations-generator[1] but making changes to the schema via the migrations seems to spit out errors which means I have no idea what I'm doing.I really need a simple run down of what migrations actually do, how they affect the database and anything else you think would help an absolute beginner.

2015-05-13 16:23:19Z

I'm totally new to this type of framework. I've come from barebones PHP development and I can't seem to find an easy to understand guide what migrations actually do.I'm trying to create a project that already has an existing database. I've used this: https://github.com/Xethron/migrations-generator[1] but making changes to the schema via the migrations seems to spit out errors which means I have no idea what I'm doing.I really need a simple run down of what migrations actually do, how they affect the database and anything else you think would help an absolute beginner.Migrations are a type of version control for your database. They allow a team to modify the database schema and stay up to date on the current schema state. Migrations are typically paired with the Schema Builder to easily manage your application's schema.With migrations you don't need to create table in phpMyAdmin, you can do it in Laravel. Here is an example to create a user table:I this code we create table with fields like "name", "lastname"... we said in our Laravel code they are string type when migration is done we have complete table in databese with this fields.Run a migration to create tableTo create a migration, you may use the make:migration command on the Artisan CLI (artisan command line interface):orRun a migration to alter tableWhen you need to do some changes in database table example: add field vote to user table you can do like this in your Laravel code without touching SQL codeRollback the last migration operationIf you make mistake and did something wrong you can always rollback to return database in previous state.Rollback all migrationsRollback all migrations and run them all againOne of best advantage of migrations are creating database without touching SQL code. You can make whole database with relationship in PHP code then migrate it into MySQL, PL/SQL, MSSQL or any other database.Also I recommend the free Laravel 5 fundamental series, in episode 7 you can hear more about migrations.A simple explanation of migrations:They're a versioning system for your database scheme.Imagine you're setting up a new application. The first thing you do is create a table (call it mytable) with a couple of columns. This will be your first migration. You run the migration (php artisan migrate) when you start working on your application and voila! You have a new table in your database.Some time later, you decide that you need a new column in your table. You create a migration (php artisan make:migration in Laravel 5) and a new migration file is created for you. You update the code in that migration, run php artisan migrate again, and you have a new column in your table.Ok, that's the basic idea behind migrations. But there's more...Suppose, later on, you realize that you messed up when you created that last migration. You've already run it, so your database has changed. How to you fix it? Well, if you wrote your migration correctly and implemented the down method, you can just do php artisan migrate:rollback and it will rollback the migration.How does Laravel do this? By keeping track of your migrations in a special database table. The php artisan migrate:install command will set things up for you so Laravel can manage these migrations.Over time, as your application grows, you will add more and more migrations. Laravel gives you a way to step forward and back through your migrations as needed to ensure your database is at whatever state you need it to be as you're working.Check out the list of artisan commands with php artisan. You can also request help on a particular command with php artisan help <command>.Imagine you are working on a project with other developers.  As developers are adding more and more features, they are also required to add more and more tables, columns, remove columns, change column data types, etc...This can very quickly and easily get out of control.  If you missed some SQL from one developer, another developer's SQL may not work correctly.  It also potentially becomes a huge time waster trying to sort through a bunch of sql files trying to figure out which ones you've missed.  It's only a matter of time till everyone on the development team is working with different databases or god forbid, someone breaks the production database.  With migrations, you just need to run php artisan migrate in the command line and all changes to the database will be taken care of for you.This is basically why migrations are useful I'm not going to go into the basics of how they work because Kryten has a pretty good write-up here already.

Safely edit a third party composer (vendor) package in Laravel & prevent losing customized changes on release of a new version of the package

TimothyBuktu

[Safely edit a third party composer (vendor) package in Laravel & prevent losing customized changes on release of a new version of the package](https://stackoverflow.com/questions/31080696/safely-edit-a-third-party-composer-vendor-package-in-laravel-prevent-losing)

I want to edit a package I pulled from composer in my Laravel 5 project, however i believe that if I ran composer update and a new version of this package has been released, I will lose all of my changes. How should I go about editing the package? Is there a way to copy package out of the vendor directory so I can use it somewhere else in my project?

2015-06-26 19:23:19Z

I want to edit a package I pulled from composer in my Laravel 5 project, however i believe that if I ran composer update and a new version of this package has been released, I will lose all of my changes. How should I go about editing the package? Is there a way to copy package out of the vendor directory so I can use it somewhere else in my project?It actually isn't safe to edit composer packages, for the very reason you point out.What I do is extends the classes that I want/need to change.I have done it here with the Filesystem class. It doesn't ensure that it won't break, but it does let you update without overwriting your changes.config/app.phpMyApp\Filesystem\FilesystemServiceProvider.phpThe simple, fast and safe method:first remove it from require and then add it to autoloadPlease do not forget to runAlternative for step 3.There is also a new alternative if you're using latest version of composer.Add this to you composer.jsonAnd then modify the version of package to dev-masterFinallyIf you want to make changes to a class of a package you have toif you want to keep your changes AND update the package from the original repo at the same time, you can fork this package and point composer to pull from your fork, not the original repo.update your composer.json file as follows:Note that you don't change the require statement except to specify your bugfix branch. You still reference the upstream package (laravelcollective/html), not your personal fork (MyGithub/html). also, note that dev- is automatically added so branch name is bugfix not dev-bugfix. if you named your branch as dev-bugfix you will require it as dev-dev-bugfix.

Session data not preserved after redirection

Drown

[Session data not preserved after redirection](https://stackoverflow.com/questions/34438852/session-data-not-preserved-after-redirection)

I'm trying to implement some custom flash messages and I'm having some issues with the session data being destroyed after a redirect.Here's how I create my flash messages : Here's the declaration of the flash() function : And here is how I'm checking the session/displaying the flash messages, using SweetAlerts. This code is included at the bottom of the main layout file that I'm extending in all my Blade templates.The code above will work if I call the flash() function before displaying a view, like so : However, it will not work if I call it before doing a redirect to another page, like so : Why is the session data lost on redirect? How can I make it persists so that I can display my flash message?

2015-12-23 15:27:56Z

I'm trying to implement some custom flash messages and I'm having some issues with the session data being destroyed after a redirect.Here's how I create my flash messages : Here's the declaration of the flash() function : And here is how I'm checking the session/displaying the flash messages, using SweetAlerts. This code is included at the bottom of the main layout file that I'm extending in all my Blade templates.The code above will work if I call the flash() function before displaying a view, like so : However, it will not work if I call it before doing a redirect to another page, like so : Why is the session data lost on redirect? How can I make it persists so that I can display my flash message?I found out that it is necessary to apply the web middleware on all routes. Drown has mentioned to do so, but since March 23st 2016, Taylor Otwell changed the default RouteServiceProvider at https://github.com/laravel/laravel/commit/5c30c98db96459b4cc878d085490e4677b0b67edBy that change the web middleware is applied automatically to all routes. If you now apply it again in your routes.php, you will see that web appears twice on the route list (php artisan route:list). This exactly makes the flash data discard.Also see: https://laracasts.com/discuss/channels/laravel/session-flash-message-not-working-after-redirect-route/replies/159117It turns out that with Laravel 5.2, the routes have to be wrapped in the web middleware for the session to work properly. This fixed it : With Laravel 5.2.34, all routes are using web middleware by default.Therefore, change this:To this:And then in your controller you could use:The issue i had was Session::save() preventing swal from showing after redirect.Redirect with flash data is done like this:In early Laravel 5.2 versions, all of your Flash and Session data are stored only if your routes are inside web middleware group.As of Laravel 5.2.34, all routes are using web middleware by default. If you will put them into middleware web group again, you will apply web middleware on your routes twice - such routes will be unable to preserve Flash or Session data.Please check APP/kernel.php\Illuminate\Session\Middleware\StartSession::class,is define multiple timesYou can comment any one or delete it. We need to define one time only.have you tired using "redirect with"https://laravel.com/docs/5.2/responses#redirecting-with-flashed-session-dataCheck your App\Kernel.php file. 

There may be multiple lines of \Illuminate\Session\Middleware\StartSession::class,

Comment one from $middlewareGroups.Additional to @Harry Bosh answer,In Laravel there an issue when Session::save() happen inside the middleware,

this make _flash session gone after redirection happenthis can be fix by using alternative : 

Laravel: How to access session value in AppServiceProvider?

Qazi

[Laravel: How to access session value in AppServiceProvider?](https://stackoverflow.com/questions/35314031/laravel-how-to-access-session-value-in-appserviceprovider)

Is there any way available to access Session values in AppServiceProvider? I would like to share session value globally in all views.

2016-02-10 11:32:02Z

Is there any way available to access Session values in AppServiceProvider? I would like to share session value globally in all views.You can't read session directly from a service provider: in Laravel the session is handled by StartSession middleware that executes after all the service providers boot phaseIf you want to share a session variable with all view, you can use a view composer from your service provider:The callback passed as the second argument to the composer will be called when the view will be rendered, so the StartSession will be already executed at that pointThe following works for me on Laravel 5.2, is it causing errors on your app?AppServiceProvider.phphome.blade.phpShows "en_US" in the browser.

String as Primary Key in Laravel migration

DGeo

[String as Primary Key in Laravel migration](https://stackoverflow.com/questions/44229280/string-as-primary-key-in-laravel-migration)

I've had to change a table in my database so that the primary key isn't the standard increments.Here's the migration,However, MySQL keeps returning with,I've tried leaving the normal increments id in there and modifying the table in a different migration but the same thing happens.Any ideas of what I'm doing wrong?Laveral Version 5.4.23

2017-05-28 15:56:57Z

I've had to change a table in my database so that the primary key isn't the standard increments.Here's the migration,However, MySQL keeps returning with,I've tried leaving the normal increments id in there and modifying the table in a different migration but the same thing happens.Any ideas of what I'm doing wrong?Laveral Version 5.4.23Change it to string.

Only User Model is saving with empty Values to database

Viral Solani

[Only User Model is saving with empty Values to database](https://stackoverflow.com/questions/43249062/only-user-model-is-saving-with-empty-values-to-database)

In Laravel 5.4 when I try to save User model to the database the values are not saved. I've set the fillable property as well.It was working in Laravel 5.3. This issue is coming after upgrading the application into Laravel 5.4.Below is a User model.Please note the issue is with User Model only.I'm saving User as below.Then the create method of BaseModel will be called and below is the code of it.

2017-04-06 07:55:20Z

In Laravel 5.4 when I try to save User model to the database the values are not saved. I've set the fillable property as well.It was working in Laravel 5.3. This issue is coming after upgrading the application into Laravel 5.4.Below is a User model.Please note the issue is with User Model only.I'm saving User as below.Then the create method of BaseModel will be called and below is the code of it.The reason is most probably the new middleware in Laravel 5.4 called "Request Sanitization Middleware" as explained in https://laravel.com/docs/5.4/releases.Disable \Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull::class, in app/Http/kernel.php and see what you get. You can also check in /config/database.php and your mysql connection settings: 'strict' => true, if so, set to false. A good practice is using the model for user input. In this case, instead of $user = $this->model->create(...) populate you model with 

$user = new \App\User($input) and update your values from there, f.ex. 

$user->confirmation_code = md5(uniqid(mt_rand(), true)); and 

$user->password = bcrypt($user->password);If fields are nullable, indicate as such in your migration file, f.ex. $table->string('all')->nullable();If done just run $user->save();From 5.4 the create() function is not more defined in Illuminate\Database\Eloquent\Model:Is handled as dinamic method call, that is by calling one of these functions (dependig on if it's called statically or not):In the Illuminate\Database\Eloquent\Model class.Now I dont have all your code but, IMHO, I will try to change this line in your BaseModel class:to this:or, even better for me, to this:Sowhere users() is your public function but I don't know what is $this in your case but should be the model as in the example from documentation.Why you're not using resource controllers? Or if you need to populate the db use a seeder

I think It will be more easy to manage.So 2 things i can think off1st there is no need to use  protected $guarded = []; and protected $fillable = [];Guarded will assume everything is fillable if its not in here and fillable will assume everything is guarded unless in here.To quote the docs2nd to rule out any of the $this->model stuff try instantiate the class first and save themGuys I'm able to resolve issue by using Fill() method.Also By mistake I've added Construction on CanResetPassword Trait which causing issue as well. So If i remove that everything will work as before as well.Yes, you can't use __construct method in Traits.Please Refer PHP.net for more details about trait, they said "Using AS on a __construct method (and maybe other magic methods) is really, really bad."You can use trait like following way.I have created "userRelation" Trait which contains few useful code to re-use.Please refer following link for more details - http://php.net/manual/en/language.oop5.traits.phpPlease try it and let me know if it won't work.

Thanks

Sorting Laravel Collection via Array of ID's

Matthew Brown

[Sorting Laravel Collection via Array of ID's](https://stackoverflow.com/questions/28118361/sorting-laravel-collection-via-array-of-ids)

Is it possible to order a relationship collection using a separate array of ID's while still accessing through the relationship?The setup is Checklist has many ChecklistItems, and I access this relationship the normal way:Now the desired order of $item exists as a property on $list under the attribute $list->item_order, it is just an array of $item ID's in the users desired order, specific to the $list being iterated.Is there a feasible way to order the $items attached to the $list based on the item_order array that the $list model has?(I can't just add a 'order' column to the 'item' table, b/c order changes based on specific 'list' relationship).Thanks for any help!

2015-01-23 20:39:39Z

Is it possible to order a relationship collection using a separate array of ID's while still accessing through the relationship?The setup is Checklist has many ChecklistItems, and I access this relationship the normal way:Now the desired order of $item exists as a property on $list under the attribute $list->item_order, it is just an array of $item ID's in the users desired order, specific to the $list being iterated.Is there a feasible way to order the $items attached to the $list based on the item_order array that the $list model has?(I can't just add a 'order' column to the 'item' table, b/c order changes based on specific 'list' relationship).Thanks for any help!You can do this:Also you could add an attribute accessor to your model which does the sameUsage:If you need this sort of functionality in multiple places I suggest you create your own Collection class:Then, to actually use that class override newCollection() in your model. In this case it would be in the ChecklistItems class:You can try setting up a relationship that returns the results in the order for which you're looking. You should still be able to eager load the relationship, and have the results in the specified order. This is all assuming the item_order field is a comma separated string list of ids.Or, if you don't want to hardcode the tables/fields:Now, you can:Just a warning: this is fairly experimental code. It looks to work with the tiny amount of test data I have available to me, but I have not done anything like this in a production environment. Also, this is only tested on a HasMany relationship. If you try this exact code on a BelongsToMany or anything like that, you'll have issues.

Use of undefined constant MCRYPT_RIJNDAEL_128 - assumed 'MCRYPT_RIJNDAEL_128'

Philip

[Use of undefined constant MCRYPT_RIJNDAEL_128 - assumed 'MCRYPT_RIJNDAEL_128'](https://stackoverflow.com/questions/29993399/use-of-undefined-constant-mcrypt-rijndael-128-assumed-mcrypt-rijndael-128)

I have successfully installed Laravel, but after running php artisan serve and going to localhost:8000 I get this error:I have checked phpinfo() on localhost:8888 and it says that mcrypt is properly installed. However the only thing I can think of is that maybe my path is wrong?in my .bash_profile I haveEvery time I try to run Laravel commands I have to type this in the terminal:I am running on a Mac. Is there a simple way I can set up my bash_profile so that I can consistently change between localhost addresses and still have all the proper PHP functions working?

2015-05-01 19:06:00Z

I have successfully installed Laravel, but after running php artisan serve and going to localhost:8000 I get this error:I have checked phpinfo() on localhost:8888 and it says that mcrypt is properly installed. However the only thing I can think of is that maybe my path is wrong?in my .bash_profile I haveEvery time I try to run Laravel commands I have to type this in the terminal:I am running on a Mac. Is there a simple way I can set up my bash_profile so that I can consistently change between localhost addresses and still have all the proper PHP functions working?This problem relative to the PHP extensions loader.

You no need to use laravel command at all after successful installation.

Laravel framework need Mcrypt Library for the security module and encrypt some of configure file.The things that you need is theses steps.then configure make and install it.More simple way on ubuntuNote: if you don't have "/etc/php5/conf.d" just skip that step and it will work ok check http://php.net/manual/en/mcrypt.installation.php For Mac users's specially - install it using Home BrewI’ve installed an empty Laravel installation and got the following error message when navigating to http://localhost/kanban/public/:Notice: Use of undefined constant MCRYPT_RIJNDAEL_128 – assumed ‘MCRYPT_RIJNDAEL_128′ in /Library/WebServer/Documents/xxx/config/app.php on line 83Googling for this error message return many tutorials on how to install mcrypt on Mac OS X (whether building it from source or using Homebrew). The problem was that both the mcrypt and the php55-mcrypt packages were properly installed:Mcrypt was also properly loaded by PHP:for more details refer this link - http://benohead.com/mac-os-x-php-notice-use-undefined-constant-mcrypt_rijndael_128/If you are seeing this on ubuntu or other flavors of *nix , it might help to do the following:I just adjusted the .bash_profile in MacOS and it worked:I also had this problem in trying to deploy a Laravel to Apache on Mac OS Sierra. I eventually found this post that gave step-by-step instructions to resolve this issue. These instructions assume that you have Homebrew installed; if you don't have it installed, then paste the following into a Terminal window to install it:Here is the relevant steps pasted from the post given above:Step 1: Install autoconf and mcryptI used homebrew to install autoconf and mcrypt, which is as easy as:If this does not work for you, or you don't want to use homebrew, then check out this tutorial.Step 2: Build the PHP extensionTo build the PHP extension you will need the PHP 5.4.17 source code that is available for download here and extract it:Then build the extension using the following commands:Step 3: Enable the extensionAll that is left is to enable the extension by editing /etc/php.ini. If this file is not present, copy /etc/php.ini.default and rename it:Edit the /etc/php.ini file and add the following:Step 4: Restart apache

Now just restart apache and you're done!ADDITIONAL NOTES AND CLARIFICATIONI did encounter two issues with following these steps:So I didto determine the version number and then changed the download to match that version number. In my case the PHP version was 5.6.28 and so I needed to download the PHP source fromApplying the information from this answer changed the step 2 listed above and replaced the sudo make install with the following:Take note that because of this change, step 4 above also needs to changed to include the path to mcrypt.so. So the following must go in the php.ini:I use nginx and php-fpm, and already did apt-get install php5-mcrypt, and moved the mcrypt.ini file to mods-available. I had to do sudo service php5-fpm restart before it actually worked.

Multiple Policies for a Model in Laravel

AshMenhennett

[Multiple Policies for a Model in Laravel](https://stackoverflow.com/questions/41604230/multiple-policies-for-a-model-in-laravel)

Does Laravel allow us to add multiple Policies for a Model? I.e. consider App\Providers\ASuthServiceProvider's $policies property:I haven't tested it in an application, because even if it worked, I would be here asking a similar question, regarding whether this is considered bad practise or prone to unexpected behaviour.The alternative I have is a very messy Policy, containing policies relating to several controllers, named in camel case:etc. etc.

2017-01-12 02:37:23Z

Does Laravel allow us to add multiple Policies for a Model? I.e. consider App\Providers\ASuthServiceProvider's $policies property:I haven't tested it in an application, because even if it worked, I would be here asking a similar question, regarding whether this is considered bad practise or prone to unexpected behaviour.The alternative I have is a very messy Policy, containing policies relating to several controllers, named in camel case:etc. etc.The $policies variable uses the model as key and as value a policy. Keys are unique so you can only set one policy per model. However you can use a policy on multiple models.In your case the App\Policies\AnotherPolicy is the only one which will be used. Also assigning multiple models the same policy really depends on what you want to do. Basically you do not want messy or gross code. So if you create a policy for two models and the policy code becomes too large, it is time to consider if creating another policy would make the code simpler/less gross.You could use traits to separate the logic for your policy.You would create a base TeamPolicy and then multiple traits with the various methods that you would want within the base class.

Default values for Laravel 5.4+ blades new components?

Chris

[Default values for Laravel 5.4+ blades new components?](https://stackoverflow.com/questions/42966549/default-values-for-laravel-5-4-blades-new-components)

Laravel 5.4+ allows for components of the following structure:Which are called like:Is there a shorthand or blade marker to set default values for the variables passed in?For example, in the above, if I don't pass in "type" I get a undefined variable error. I could do something like:But the above feels verbose, especially if the variable is used in multiple spots. 

2017-03-23 03:07:34Z

Laravel 5.4+ allows for components of the following structure:Which are called like:Is there a shorthand or blade marker to set default values for the variables passed in?For example, in the above, if I don't pass in "type" I get a undefined variable error. I could do something like:But the above feels verbose, especially if the variable is used in multiple spots. I don't think it does. Having said that blade has the or operator that wraps the isset() call (see docs).If you're running php 7 this is a case for the Null coalescing operator.Both will make your call site tider.

Laravel timestamps to show milliseconds

raphadko

[Laravel timestamps to show milliseconds](https://stackoverflow.com/questions/31227069/laravel-timestamps-to-show-milliseconds)

I need to store updated_at timestamp with high precision on a laravel application, using the format "m-d-Y H:i:s.u" (including milisseconds)According to laravel documentation, I can customize the date format by setting the $dateFormat property on a class, but...The main problem is that Laravel's schema builder adds a column of type timestamp in the database when I use $table->nullableTimestamps() And according to mysql documentation, columns of type TIMESTAMP only allow the precision up to seconds..Any ideas on how I could achieve that?

2015-07-05 04:11:07Z

I need to store updated_at timestamp with high precision on a laravel application, using the format "m-d-Y H:i:s.u" (including milisseconds)According to laravel documentation, I can customize the date format by setting the $dateFormat property on a class, but...The main problem is that Laravel's schema builder adds a column of type timestamp in the database when I use $table->nullableTimestamps() And according to mysql documentation, columns of type TIMESTAMP only allow the precision up to seconds..Any ideas on how I could achieve that?You can't because the PHP PDO driver doesn't support fractional seconds in timestamps. A work around is to select the timestamp as a string instead so the PDO driver doesn't know its really a timestamp, simply by doing $query->selectRaw(DB::raw("CONCAT(my_date_column) as my_date_column")) however this means you can't use the default select for all fields so querying becomes a real pain. Also you need to override getDateFormat on the model.Finally in your migration rather than nullableTimestamps, outside of the Schema callback do:Note this example was for 3 decimal places however you can have up to 6 if you like, by changing the 3 to a 6 in two places, in the alter table and in the sprintf and also adjusting the multiplier * 1000 to 1000000 for 6.Hopefully some day PHP PDO will be updated to fix this, but its been over 5 years and nothings changed so I don't have my hopes up. In case you are interested in the details, see this bug report:

http://grokbase.com/t/php/php-bugs/11524dvh68/php-bug-bug-54648-new-pdo-forces-format-of-datetime-fields

I found that link in this other answer which might help you more understand the issue:

https://stackoverflow.com/a/22990991/259521PHP is really showing its age lately, and I would consider this issue one of my reasons for considering moving to the more modern Node.js.Based on malhal's answer, I was able to get fractional timestamp reading to work here.  Pasting the answer here for convenience:There is a lot going on here because it gets the query with scopes applied and then adds a select for the updated_at column to the end, which overwrites any previously loaded updated_at column later while Laravel hydrates the Model from the query. For being an ugly hack, it worked surprisingly well the very first time.Timestamps are stored internally as Carbon in Laravel:Output:Also be sure to run a migration to convert your columns to fractional timestamps. Microsecond precision raises the size of timestamps from 4 bytes to 7 bytes but this is 2017, don't let saving a byte or two by choosing millisecond precision cost you a fortune later when you find yourself serving stale cache entries:Sadly I haven't found a way to modify the migration schema timestamps() function to do this.

How to make routes in Laravel case insensitive?

Nishant Srivastava

[How to make routes in Laravel case insensitive?](https://stackoverflow.com/questions/31964973/how-to-make-routes-in-laravel-case-insensitive)

I have a project in laravel and there are many routes in that project.But i just discovered that the routes are all case sensitive, means 

/advertiser/reports is different than /advertiser/Reports . So what i want is both the routes should redirect to same view. Currently 

/advertiser/Reports gives RouteNotFound Exception.I have read about the Route::pattern() way of doing it but since there are many routes i'll have to put in a lot of efforts for that. So, what i want is a better way of doing it, if there is any.

2015-08-12 12:16:25Z

I have a project in laravel and there are many routes in that project.But i just discovered that the routes are all case sensitive, means 

/advertiser/reports is different than /advertiser/Reports . So what i want is both the routes should redirect to same view. Currently 

/advertiser/Reports gives RouteNotFound Exception.I have read about the Route::pattern() way of doing it but since there are many routes i'll have to put in a lot of efforts for that. So, what i want is a better way of doing it, if there is any.In order to make routes case-insensitive you'll need to modify the way routes are matched with the URLs. In Laravel, it all happens in UriValidator object so you'll need to create your own validator.Luckily, like most tasks in Laravel, it's not really complicated.First, create the new validator class - the only difference between this one and the original is that you'll append the i modifier at the end of regular expression for the compiled route to switch enable case-insensitive matching.Secondly, you need to update the list of matchers that are used to match URL to a route and replace the original UriValidator with yours.In order to do that, add the following at the top of your routes.php file:This will remove the original validator and add yours to the list of validators.Keep in mind that this code has not been tested by running. Let me know if there are any typos or something doesn't work as expected. I'll be more than happy to get that working for you :)I know this is an old question but I came across this same problem and I just want to share my solution.On method render(...) at Exceptions/Handler.php, catch 404 exceptions and validate the case of the URL then redirect like this: That's it.I wrote a gist which does this: https://gist.github.com/samthomson/f670f9735d200773e543Edit your app/filters.php to check for uppercase characters in the route and redirect them to a converted route.

Testing listeners with Queue::fake()

Denis Priebe

[Testing listeners with Queue::fake()](https://stackoverflow.com/questions/48083893/testing-listeners-with-queuefake)

My Laravel 5.5 application has a Product model. The Product model has a dispatchesEvents property that looks like this:I also have a listener that is called CreateProductInMagento which is mapped to the ProductCreated event in the EventServiceProvider. This listener implements the ShouldQueue interface.When a product is created, the ProductCreated event is fired and the CreateProductInMagento listener is pushed to the queue and is run.I am now trying to write a test for all of this. Here is what I have:But I get a The expected [App\Listeners\Magento\Product\CreateProductInMagento] job was not pushed. error message.How do I test queueable listeners using Laravel's Queue::fake() method?

2018-01-03 19:25:45Z

My Laravel 5.5 application has a Product model. The Product model has a dispatchesEvents property that looks like this:I also have a listener that is called CreateProductInMagento which is mapped to the ProductCreated event in the EventServiceProvider. This listener implements the ShouldQueue interface.When a product is created, the ProductCreated event is fired and the CreateProductInMagento listener is pushed to the queue and is run.I am now trying to write a test for all of this. Here is what I have:But I get a The expected [App\Listeners\Magento\Product\CreateProductInMagento] job was not pushed. error message.How do I test queueable listeners using Laravel's Queue::fake() method?The problem here is that the listener is not the job pushed to the queue. Instead, there's a Illuminate\Events\CallQueuedListener job that is queued and will in turn call the appropriate listener when resolved.So you could do your assertion like this:Running artisan queue:work won't solve the issue because when testing, Laravel is configured to use the sync driver, which just runs jobs synchronously in your tests. I am not sure why the job is not being pushed, though I would guess it has to do with Laravel handling events differently in tests. Regardless, there is a better approach you can take to writing your tests that should both fix the issue and make your code more extendable.In your ProductTest, rather than testing that a_created_product_is_pushed_to_the_queue_so_it_can_be_added_to_magento, you should simply test that the event is fired. Your ProductTest doesn't care what the ProductCreated event is; that is the job of a ProductCreatedTest. So, you can use Event Faking to change your test a bit:Then, create a new ProductCreatedTest to unit test your ProductCreated event. This is where you should place the assertion that a job is pushed to the queue:This has the added benefit of making your code easier to change in the future, as your tests now more closely follow the practice of only testing the class they are responsible for. Additionally, it should solve the issue you're having where the events fired from a model aren't queuing up your jobs. 

Laravel: Permission denied in laravel Blade File

alvincrespo

[Laravel: Permission denied in laravel Blade File](https://stackoverflow.com/questions/10840088/laravel-permission-denied-in-laravel-blade-file)

I have the following issue when trying to install Laravel http://laravel.comAny help, would be greatly appreciated.

2012-05-31 19:31:43Z

I have the following issue when trying to install Laravel http://laravel.comAny help, would be greatly appreciated.I would check that the permissions on:Allow your application to write to this directory.Assuming you are on a linux box you could run ls -l to see what the permissions are, and if it is set to read only, change the permissions with chmod.As you can see in the very good documentation under install, you have to make the directory storage/views writeable.http://laravel.com/docs/install#installationcheck the permissions of /storage directory in the laravel installation. The views directory must have write permisison for the webserver that is it.

Using multiple where clauses with laravel query builder

Dan Hastings

[Using multiple where clauses with laravel query builder](https://stackoverflow.com/questions/29342028/using-multiple-where-clauses-with-laravel-query-builder)

I'm having a lot of trouble converting the following SQL query to work with Laravel's query builder.This query works fine, but I can't get the same results when using Laravel's query builder. I have the following code so far. It is not working correctly at all. I'm thinking the issue could lie with the orWhere part because it seems to be returning results that don't match any of the other where clauses.

2015-03-30 08:55:58Z

I'm having a lot of trouble converting the following SQL query to work with Laravel's query builder.This query works fine, but I can't get the same results when using Laravel's query builder. I have the following code so far. It is not working correctly at all. I'm thinking the issue could lie with the orWhere part because it seems to be returning results that don't match any of the other where clauses.You want to use advanced where with parameter grouping:

Laravel 5.1 loading relationship data into selected row

V4n1ll4

[Laravel 5.1 loading relationship data into selected row](https://stackoverflow.com/questions/35271896/laravel-5-1-loading-relationship-data-into-selected-row)

I have a timesheet table and a user table in my database.  The following relationship is setup on the timesheet model.The above means I can get user data when I select timesheets from the database by using something like:This will load the user object in the result and if converted to an array will look like so;However, I only need first_name and last_name from the user table.  Is there a way to merge/flatten the user array with the timesheet so that it looks like this instead;I have tried to use eager loading like so;However, it results in the following output;

2016-02-08 14:21:42Z

I have a timesheet table and a user table in my database.  The following relationship is setup on the timesheet model.The above means I can get user data when I select timesheets from the database by using something like:This will load the user object in the result and if converted to an array will look like so;However, I only need first_name and last_name from the user table.  Is there a way to merge/flatten the user array with the timesheet so that it looks like this instead;I have tried to use eager loading like so;However, it results in the following output;The reason why the user relationship is null in your second example is because in order for Eloquent relationships to work, it needs the keys that tie the relationships. In other words...In order for your query to work, you need to adjust it like this:With that out of the way, if you want a flattened result, I think it's best to use joins rather than eager loading because of the nature of eager loading.This assumes that your table names are users and timesheets.Have you tried to get a listor if you wanted to perform a selectUpdate

You can also perform eager loading to eager load related objects. Here is an example Please let me know if that helps. Laravel models have a way to modify data before getting/setting an attribute. You can actually add the attributes to the model by defining a getter function. This will let you reference the user names in the same way you would the user_id or status. These functions are also great for changing date formats for a view or sanitizing form input.That's exactly what a join do. From the documentationIf you want to be more selective on your fields, you can choose what you select;As other have suggested, it might be better to use the DB query builder such asIn this case it's better to use Raw SQL or Query builder. 

Because relations made for using database data as an relational objects. 

What is the significance of Application key in a Laravel Application?

Shobi

[What is the significance of Application key in a Laravel Application?](https://stackoverflow.com/questions/49445420/what-is-the-significance-of-application-key-in-a-laravel-application)

from laravel docs What I know about application key is: If the application key is not set, generally I do get an exception. 

2018-03-23 08:37:27Z

from laravel docs What I know about application key is: If the application key is not set, generally I do get an exception. As we can see its used in EncryptionServiceProvider:So every component that uses encryption: session, encryption (user scope), csrf token benefit from the app_key.Rest of the questions can be answered by "how encryption" (AES) works, just open up Encrypter.php, and confirm that Laravel uses AES under the hood and encodes the result to base64.Further more we can see how its all done by using tinker:After decoding the result we get (you can try decode your own cookie with session):to understand above json (iv, value, mac) you need to understand AES:

Call to undefined function Illuminate\Filesystem\finfo_file()

haakym

[Call to undefined function Illuminate\Filesystem\finfo_file()](https://stackoverflow.com/questions/44929092/call-to-undefined-function-illuminate-filesystem-finfo-file)

I have the following error showing up in my laravel.log file on a website I have running. How can I pin down where the error originates from? As the stack trace is so short I am unsure where to start.I've ran a search on the site's folder using sublime's global search for when finfo_file() is used and I've used it in a helper in a test...Currently, my tests are all passing.Any ideas?

2017-07-05 14:30:23Z

I have the following error showing up in my laravel.log file on a website I have running. How can I pin down where the error originates from? As the stack trace is so short I am unsure where to start.I've ran a search on the site's folder using sublime's global search for when finfo_file() is used and I've used it in a helper in a test...Currently, my tests are all passing.Any ideas?When you are managing the server yourself you should runfrom the commandline and edit php.ini (probably located at /etc/php.ini)to contain the linedon't forget to restart the web server. Depending on your os and web stack this is something likeWhen using a shared hosting, you probably have an option in the webinterface to enable it from there. For example in directadminAdvanced features > Select PHP version And thenTick the checkbox next to fileinfoDon't forget to click saveYou are supposed to activate finfo_file() [check this link]As Michael Hamisi said, it's a method that is declared by a PECL PHP Extension named fileinfo that is commonly present on PHP installations.it is used in Laravel to get information about files especially in upload cases.you should check that the extension is enabled on your installations.

usually, when you do composer install, an error will be triggered telling you to activated the missing extension. You need to enable fileinfo extension.please refer to this : https://stackoverflow.com/a/24565508/7171624As others have already pointed out how to fix the error itself I'm going to answer your question about how you can find out where the error originates from.The error message tells us that you are not calling finfo_file() directly but that you are calling a method of Illuminate/Filesystem/Filesystem which uses it at line 254. So you need to search for where you are using this method from Illuminate/Filesystem/Filesystem.If you are not using this method directly you could be using it indirectly through a dependency of yours. In this case you would need to search in your vendor directory for the usage of the method from Illuminate/Filesystem/Filesystem.

Laravel: How to add a composite key (2 or more columns) as the $primaryKey in the related model?

Amr

[Laravel: How to add a composite key (2 or more columns) as the $primaryKey in the related model?](https://stackoverflow.com/questions/30427868/laravel-how-to-add-a-composite-key-2-or-more-columns-as-the-primarykey-in-th)

Name of the primary key column in any model in Laravel framework is idAnd I know I can change that default name like this:My question is: What if I have a composite key (2 or more columns) in the table, how do I add them as the $primaryKey? And do I really have to define them?

2015-05-24 20:14:09Z

Name of the primary key column in any model in Laravel framework is idAnd I know I can change that default name like this:My question is: What if I have a composite key (2 or more columns) in the table, how do I add them as the $primaryKey? And do I really have to define them?From the Laravel docs:Edit: I misunderstood the question. This thread might provide some answers: http://forumsarchive.laravel.io/viewtopic.php?pid=34475Specifically overriding the find() method.

What problems could I meet with Laravel 4 on PHP 5.3.3?

Alexandre Butynski

[What problems could I meet with Laravel 4 on PHP 5.3.3?](https://stackoverflow.com/questions/17062182/what-problems-could-i-meet-with-laravel-4-on-php-5-3-3)

I know that the Laravel 4 requirements are PHP >= 5.3.7 but my client must recent application server only has PHP 5.3.3. Yes, three years old version...I need more arguments to explain the situation and find a solution with him (no move, upgrade or cloud hosting).The questions are the following :[EDIT] What I know about my client configuration is : Red Hat Enterprise Linux 6.3 on VMWare virtual machine with Apache 2.2 and PHP 5.3.3.

2013-06-12 09:35:59Z

I know that the Laravel 4 requirements are PHP >= 5.3.7 but my client must recent application server only has PHP 5.3.3. Yes, three years old version...I need more arguments to explain the situation and find a solution with him (no move, upgrade or cloud hosting).The questions are the following :[EDIT] What I know about my client configuration is : Red Hat Enterprise Linux 6.3 on VMWare virtual machine with Apache 2.2 and PHP 5.3.3.Laravel 4 requires PHP 5.3.7 due to using the bcrypt algorithm when hashing passwords, which received a huge bugfix at that version.Have a look at this article for bringing the requirement of PHP for Laravel 4 down to 5.3.2: http://laravel.io/topic/39/laravel-4-easily-extendedEDIT: here is an archived version of the linked article, as the original appears to be down:

https://web.archive.org/web/20130805153640/http://laravel.io/topic/39/laravel-4-easily-extendedNOTE: some PHP versions of 5.3.3 on certain distros do have the bcrypt algorithm fix backported into them, such as RedHat. You can read on how you can test if the distro you are using is one of them here; if it is, your distro supports the fix, and in turn supports Laravel 4 out of the box.I had an experience with a remote webhost that offers several versions of php, and somehow, was set to an older default version of php.For example, I could not figure out why my migrations would not run - artisan commands failed for no apparent reason, when a nearly identical local setup worked.  Come to find out that my root folder was set to 5.2 something.  A quick chat session with the webhost guys, and they showed me how to fix.  Presto- migrations work.Much of the rest of my application worked, but the artisan functionality is a no-can-do-without for me.  Hope that helps.Also, the built-in php development web server is handy - starts with 5.4.EDIT: Here is a little more ammo for you: another specific issue I encountered:So there you have it: Entrust is one specific example of a package you cannot use without 5.4....I hope that helps someone!UPDATE: July 2013, per php.net : Please Note: This will be the last regular release of the PHP 5.3 series. All users of PHP are encouraged to upgrade to PHP 5.4 or PHP 5.5. The PHP 5.3 series will receive only security fixes for the next year.

Laravel - Reusable resource controller

Caio Kawasaki

[Laravel - Reusable resource controller](https://stackoverflow.com/questions/50182156/laravel-reusable-resource-controller)

I am modifying the CMS that I use in my projects, and recently I decided to create a controller for default actions BaseController, where all other controllers will extend this controller BaseController.The problem is: I wrote the BaseController using the Form Requests of the UserController and I have no idea how to leave these Request dynamic so that I can implement them from other controllers.Here is my default controller:Any idea how to solve this?

2018-05-04 19:48:44Z

I am modifying the CMS that I use in my projects, and recently I decided to create a controller for default actions BaseController, where all other controllers will extend this controller BaseController.The problem is: I wrote the BaseController using the Form Requests of the UserController and I have no idea how to leave these Request dynamic so that I can implement them from other controllers.Here is my default controller:Any idea how to solve this?After the comments I could understand better.

I had the same issue here and that's my workaroundShort answer:Bindings.One Route::model.And one Simple Binding for each Form Request type, using Interfaces for the Method Injection in the Controller.Long answer applied to your example:Models binding in routes/web.php:Requests bindings in the Controller Base:And the Example Controller:So the Requests interfaces would look something like:And you should use it as an interface in your Form Requests:Opinionated alternative answer:General controller base:Resource Controller Base:Resource controller for Example model:English Language file in resources/lang/en/resource.php:Portuguese Language file in resources/lang/pt/resource.php:Web Routes in routes/web.php:Request interfaces (for binding):Same for App\Http\Requests\UpdateRequestInterface and App\Http\Requests\StatusRequestInterface...Example Form Request:Same for App\Http\Requests\Example\UpdateRequest and App\Http\Requests\Example\StatusRequest...Documentation applied for this reply:Notice: This reply is for Laravel 5.6. Some code used in this reply is not supported in previews versions. If you want it for a specific version, let me know and I will try to adapt it.Any CustomFormRequest that you will use, will be an instance of FormRequest.. a class that in turn extends the Request class. So in your BaseController do this:Then in your child Controllers:}Give it a try.

Laravel 5 losing sessions and .env configuration values in AJAX-intensive applications

JustAMartin

[Laravel 5 losing sessions and .env configuration values in AJAX-intensive applications](https://stackoverflow.com/questions/31295126/laravel-5-losing-sessions-and-env-configuration-values-in-ajax-intensive-applic)

I am using Laravel 5 (to be specific,  "laravel/framework" version is "v5.0.27"), with session driver = 'file'.I'm developing on Windows 7 64 bit machine.I noticed that sometimes (once a week or so) I get unexpectedly and randomly logged out. Sometimes this happens even immediately after I log in. I have added log messages to my auth logic code, but the log code was not triggered. Laravel behaved as if it has completely lost the session file.Another, more serious issue, was that sometimes after debugging sessions (using xdebug and Netbeans) Laravel started losing also other files - .env settings, some debugbar JS files etc. The error log had messages like:This clearly signals that .env file was not read by Laravel, so it is using default settings:Losing files happened rarely, maybe once a month or so, and it always happened after debugging sessions. I always had to restart Apache to make it work again.To stress-test the system and reproduce the issues reliably, I used a quick hack in my Angular controller:It is just a basic data request from Angular to Laravel.And that was it - now I could reproduce the session losing and .env losing in 3 minutes or less.I have developed AJAX-intensive web applications earlier on the same PC with the same Apache+PHP, but without Laravel, without .env, and I hadn't noticed such issues before.While debugging through code, I found out that Laravel is not using PHP built-in sessions at all, but has implemented their own files-based session. Obviously, it  does not provide the same reliability as default PHP sessions and I'm not sure why.Of course, in real life scenarios my app won't be that AJAX-intensive, but in my experiences on some occasions it is enough with just two simultaneous AJAX requests to lose the session.I have seen some related bug reports on Laravel for various session issues. I haven't yet seen anything about dot-env, though, but it seems suffering from the same issue.My guess is that Laravel does not use file locks and waiting, thus if a file cannot be read for some reason (maybe locked by some parallel process or Apache) then Laravel just gives up and returns whatever it can.Is there any good solution to this? Maybe it is specific to Windows and the problems will go away on a Linux machine?Curious, why Laravel (or Symfony) developers haven't fixed their session file driver yet. I know that locking/waiting would slow it down, but it would be great to at least have some option to turn on "reliable sessions".Meanwhile I'll try to step through Laravel code and see if I can invent some "quick&dirty" fix, but it would be much better to have some reliable and "best practices" solution.The issue turned to be not related to locking files. I found the Laravel bug report for .env issue, which lead me to a linked report for Dotenv project which, in turn, says that it is a core PHP issue. What disturbs me is that Dotenv devs say that Dotenv was never meant to be used for production, but Laravel seems to rely upon Dotenv.In https://github.com/laravel/framework/pull/8187 there seems to be a solution which should work in one direction but some commenter says that in their case the issue was the opposite. Someone called crynobone gave a clever code snippet to try:There appeared another suggestion to use "makeMutable()" on both Dotenv and Laravel Githubs, but commenters report that this might break tests. So I tried the crynobone's code but it did not work for me. While debugging, I found out that in my case when things break down for concurrent requests, the $key cannot be found nor in getenv(), nor in $_ENV and not even in $_SERVER.

The only thing that worked (quick&dirty experminet) was to add:static::$cached[$name] = $value;to Dotenv class and then in helpers.php env() method I see that:is always good, even when $_ENV and getenv both give nothing.Although Dotenv was not meant for production, I don't want to change our deployment and configuration workflow.Next I'll have to investigate the session issues...Related Laravel bug reports (some even from version 4. and it seems, not fixed):

https://github.com/laravel/framework/issues/4576https://github.com/laravel/framework/issues/5416https://github.com/laravel/framework/issues/8172and an old article which sheds some light on what's going on (at least with session issues):

http://thwartedefforts.org/2006/11/11/race-conditions-with-ajax-and-php-sessions/

2015-07-08 14:05:43Z

I am using Laravel 5 (to be specific,  "laravel/framework" version is "v5.0.27"), with session driver = 'file'.I'm developing on Windows 7 64 bit machine.I noticed that sometimes (once a week or so) I get unexpectedly and randomly logged out. Sometimes this happens even immediately after I log in. I have added log messages to my auth logic code, but the log code was not triggered. Laravel behaved as if it has completely lost the session file.Another, more serious issue, was that sometimes after debugging sessions (using xdebug and Netbeans) Laravel started losing also other files - .env settings, some debugbar JS files etc. The error log had messages like:This clearly signals that .env file was not read by Laravel, so it is using default settings:Losing files happened rarely, maybe once a month or so, and it always happened after debugging sessions. I always had to restart Apache to make it work again.To stress-test the system and reproduce the issues reliably, I used a quick hack in my Angular controller:It is just a basic data request from Angular to Laravel.And that was it - now I could reproduce the session losing and .env losing in 3 minutes or less.I have developed AJAX-intensive web applications earlier on the same PC with the same Apache+PHP, but without Laravel, without .env, and I hadn't noticed such issues before.While debugging through code, I found out that Laravel is not using PHP built-in sessions at all, but has implemented their own files-based session. Obviously, it  does not provide the same reliability as default PHP sessions and I'm not sure why.Of course, in real life scenarios my app won't be that AJAX-intensive, but in my experiences on some occasions it is enough with just two simultaneous AJAX requests to lose the session.I have seen some related bug reports on Laravel for various session issues. I haven't yet seen anything about dot-env, though, but it seems suffering from the same issue.My guess is that Laravel does not use file locks and waiting, thus if a file cannot be read for some reason (maybe locked by some parallel process or Apache) then Laravel just gives up and returns whatever it can.Is there any good solution to this? Maybe it is specific to Windows and the problems will go away on a Linux machine?Curious, why Laravel (or Symfony) developers haven't fixed their session file driver yet. I know that locking/waiting would slow it down, but it would be great to at least have some option to turn on "reliable sessions".Meanwhile I'll try to step through Laravel code and see if I can invent some "quick&dirty" fix, but it would be much better to have some reliable and "best practices" solution.The issue turned to be not related to locking files. I found the Laravel bug report for .env issue, which lead me to a linked report for Dotenv project which, in turn, says that it is a core PHP issue. What disturbs me is that Dotenv devs say that Dotenv was never meant to be used for production, but Laravel seems to rely upon Dotenv.In https://github.com/laravel/framework/pull/8187 there seems to be a solution which should work in one direction but some commenter says that in their case the issue was the opposite. Someone called crynobone gave a clever code snippet to try:There appeared another suggestion to use "makeMutable()" on both Dotenv and Laravel Githubs, but commenters report that this might break tests. So I tried the crynobone's code but it did not work for me. While debugging, I found out that in my case when things break down for concurrent requests, the $key cannot be found nor in getenv(), nor in $_ENV and not even in $_SERVER.

The only thing that worked (quick&dirty experminet) was to add:static::$cached[$name] = $value;to Dotenv class and then in helpers.php env() method I see that:is always good, even when $_ENV and getenv both give nothing.Although Dotenv was not meant for production, I don't want to change our deployment and configuration workflow.Next I'll have to investigate the session issues...Related Laravel bug reports (some even from version 4. and it seems, not fixed):

https://github.com/laravel/framework/issues/4576https://github.com/laravel/framework/issues/5416https://github.com/laravel/framework/issues/8172and an old article which sheds some light on what's going on (at least with session issues):

http://thwartedefforts.org/2006/11/11/race-conditions-with-ajax-and-php-sessions/My personal opinion that using .env to configure Laravel is a bad decision. Having .php files that contained key:value style of configuration was much better.However, the problem you are experiencing is not PHP's fault, nor Apache's - it's most likely Windows issue.A few other things: Apache contains a module that allows PHP binary to be integrated into Apache's process or thread, called mod_php - the issue with this is that PHP is not only slow, but getting another binary integrated into an existing one is super tricky and things might be missed. PHP also must be built with thread-safety in this case. If it's not, then weird bugs can (and will) occur.To circumvent the problem of tricky integration of one program into another, we can avoid this completely and we can have .php served over FastCGI protocol. This means that the web server (Apache or Nginx) will take the HTTP request and pass it to another "web" server. In our case, this will be PHP FastCGI Process Manager or PHP-FPM.PHP-FPM is preferred way of serving .php pages - not only because it's faster (much, much faster than integrating via mod_php), but you can easily scale your HTTP frontend and have multiple machines serve .php pages, allowing you to easily horizontally scale your HTTP frontend.However, PHP-FPM is something called a supervisor process and it relies on process control. As far as I'm aware, Windows do not support process control in the way *nix does, therefore php-fpm is unavailable for Windows (in case I am wrong here, please correct me).What does all of this mean for you? It means that you should use software that's designed to play nicely with what you want to do.

This is the logic that should be followed:Now, this process while great, comes with a few issues and one huge problem here is how PHP deals with sessions. A default PHP session is a file stored somewhere on the server. This means that if you have 2 physical machines serving your php-fpm, you're going to have problems with sessions. This is where Laravel does something great - it lets you use encrypted cookie based sessions. It comes with limitations (you can't store resources in those sessions and you have a size limit), but a correctly built app wouldn't store too much info in a session in the first place. There are, of course, multiple ways of dealing with sessions, but in my opinion the encrypted cookie is super, super trivial to use and powerful. When such a cookie is used, it's the client who carries the session information and any machine that contains decryption key can read this session, which means that you can easily scale your setup to multiple servers - all they have to do is have access to same decryption key (it's the APP_KEY in the .env). Basically you need to copy the same Laravel installation to machines that you wish to serve your project.The way I would deal with the issue that you have while developing is the following:Now what you gain via this process is this: you don't pollute your Windows machine with a program that listens on ports 80 / 443, when you're done working you can just shut the VM down without losing work, you can also easily simulate how your website would behave on an actual production machine and you wouldn't have surprises such as "it works on my dev machine but it doesn't work on my production machine" because you'd have the same software for both purposes.These are my opinions, they are not all cold-facts and what I wrote here should be taken with a grain of salt. If you think what I wrote might help you, then please try to approach the problem that way. If not, well, no hard feelings and I wish you good luck with your projects.After two days of intensive debugging I have some workarounds which might be useful to others:Here is my patch for Dotenv 1.1.0 and Laravel 5.0.27 to fix .env issues:

https://gist.github.com/progmars/db5b8e2331e8723dd637And here is my workaround patch to make session issues much less frequent (or fix them completely, if you don't write to session yourself on every request):

https://gist.github.com/progmars/960b848170ff4ecd580aI tested them with Laravel 5.0.27 and Dotenv 1.1.0.Also recently recreated patches for Laravel 5.1.1 and Dotenv 1.1.1:

https://gist.github.com/progmars/e750f46c8c12e21a10ea

https://gist.github.com/progmars/76598c982179bc335ebbMake sure you add to your config/session.php for this patch to become effective.All the patches should be applied to vendor folder each time it gets recreated.Also you might want to separate the session patch out because you update session.php just once, but the other parts of the patch should be applied to vendor folder each time it gets recreated before deployment.Be warned: "It works on my machine". I really hope Laravel and Dotenv developers will come up with something better, but meanwhile I can live with these fixes.

laravel 5.2 Insert login session data to database on custom auth

Hassaan

[laravel 5.2 Insert login session data to database on custom auth](https://stackoverflow.com/questions/48140332/laravel-5-2-insert-login-session-data-to-database-on-custom-auth)

I have a custom auth login in laravel 5.2, my config for custom login isI have two auth controllers, One is laravel AuthController and other is ProviderAuthController. I have set SESSION_DRIVER=database in my env and also created a session table in my database I am getting sessions from web login but problem is that I am not able to get sessions on provider login. Is there any workaround to insert session on provider login.There is nothing in my app service providerThe route for my providerAuthcontroller are

    Route::group(['prefix' => 'provider'], function(){

2018-01-07 18:37:13Z

I have a custom auth login in laravel 5.2, my config for custom login isI have two auth controllers, One is laravel AuthController and other is ProviderAuthController. I have set SESSION_DRIVER=database in my env and also created a session table in my database I am getting sessions from web login but problem is that I am not able to get sessions on provider login. Is there any workaround to insert session on provider login.There is nothing in my app service providerThe route for my providerAuthcontroller are

    Route::group(['prefix' => 'provider'], function(){Its supposed to happen in the middlewares, not in the providers.andAlso check laravel lifecycle.I used this code to get session(just doing R&D that time). I think this  could work for you well.

Laravel 5.1 to 5.2 composer update error

Zarathuztra

[Laravel 5.1 to 5.2 composer update error](https://stackoverflow.com/questions/34455132/laravel-5-1-to-5-2-composer-update-error)

Whenever I try to run composer update I now receive an error with a root cause of the followingCall to undefined method Illuminate\Bus\Dispatcher::mapUsing()I can confirm Laravel 5.2 is properly installed, as are all other dependencies. This only happens when php artisan clear-compiled is run.I've also updated my base controller based on a suggestion from a few hours ago in the Laracasts forumBut I still receive the errorUPDATE: This happens whenever the application is bootstrapped at all. My app won't even run now.UPDATE 2, full stack trace:

2015-12-24 15:51:50Z

Whenever I try to run composer update I now receive an error with a root cause of the followingCall to undefined method Illuminate\Bus\Dispatcher::mapUsing()I can confirm Laravel 5.2 is properly installed, as are all other dependencies. This only happens when php artisan clear-compiled is run.I've also updated my base controller based on a suggestion from a few hours ago in the Laracasts forumBut I still receive the errorUPDATE: This happens whenever the application is bootstrapped at all. My app won't even run now.UPDATE 2, full stack trace:From the Laravel 5.2 Upgrade GuideThere is no longer support for non self handling commands which is what the mapper would be for; mapping commands to handlers.Check Service ProvidersCheck any service providers you have registered to make sure they aren't calling that method on dispatcher. If still having that issue, you can try checking any package service providers to make sure they aren't calling that method.

Auth::user()->username and similar are very slow

TheNiceGuy

[Auth::user()->username and similar are very slow](https://stackoverflow.com/questions/34773687/authuser-username-and-similar-are-very-slow)

I am having a werid issue. My Laravel 5 application is very slow, it take 1-3 seconds to completely load, that is something that is not tolerable.After hours of debugging, I found out that the issue is Auth::user(), more specifically when you try to access something like Auth::user()->username.What I noticed: Auth::user()->id is blazing fast, while Auth::user()->username takes 1-3 seconds. It does also not to appear to have something todo with the mySQL server, as the exact same queries are being executed, no matter if I use ->id or ->username.It is not only that slow when using ->username but it appears to be that slow for alsmost everything besides ->id, also when accessing roles like Auth::user()->roles.In case it matters, I am using Entrust for the permission/role management. User Model:Even if I remove the Entrust Service Provider and therefore also the EntrustUserTrait, it is still as slow as before.SHOW CREATE TABLE users as requestedAny idea why this is happening? Thanks!

2016-01-13 17:55:15Z

I am having a werid issue. My Laravel 5 application is very slow, it take 1-3 seconds to completely load, that is something that is not tolerable.After hours of debugging, I found out that the issue is Auth::user(), more specifically when you try to access something like Auth::user()->username.What I noticed: Auth::user()->id is blazing fast, while Auth::user()->username takes 1-3 seconds. It does also not to appear to have something todo with the mySQL server, as the exact same queries are being executed, no matter if I use ->id or ->username.It is not only that slow when using ->username but it appears to be that slow for alsmost everything besides ->id, also when accessing roles like Auth::user()->roles.In case it matters, I am using Entrust for the permission/role management. User Model:Even if I remove the Entrust Service Provider and therefore also the EntrustUserTrait, it is still as slow as before.SHOW CREATE TABLE users as requestedAny idea why this is happening? Thanks!Use xdebug to generate a profile of the execution. Then download that file and open it in Wincachegrind or Kcachegrind (depending on what OS you're running on your desktop)In those programs you can drill down and see what's taking the extra time by double-clicking and looking at the columns to see how much time something has taken.The Auth facade returns an object of class Illuminate\Auth\Guard, normally it it caches the entire object you request.   Could it be that somewhere in your application the facade has been overwritten extended to a version that only caches the id instead of all the properties?You might want to make the inital query for the user into User::with('personalData','banned') in your inital load so it will fetch all your relevant data.Basically make sure all your fields get eager loaded on the first query for the user.It's very strange only the user id is loaded, it's as if your user object gets instantiated with the id, but doesn't execute the query till you request it.Use a cache technology if you have big data and performance issue linking this,  like memcache table!Use method instead of Facade.

reCaptcha v3 handle score callback

Victordb

[reCaptcha v3 handle score callback](https://stackoverflow.com/questions/52334269/recaptcha-v3-handle-score-callback)

I followed recaptcha v3 example and managed to make it return a callback with a score for a page, similar with their demo.What I don't understand is how to handle the score that is returned.I understand that the success is based on the treshold. Using the github package the backend verification is returning json (fail or success) back to the frontend.Am I supposed to handle the fail or success in the front end using javascript? What if the browser has the javascript disabled?I was thinking to use the recaptcha v3 on all the pages and block the users considered bots for an amount of time.I am using laravel but I can't figure out how to handle the verification in the middleware, or somewhere else, in order to block the users if they don't have a token (javascript is disabled) or they are considered bots.

2018-09-14 14:42:29Z

I followed recaptcha v3 example and managed to make it return a callback with a score for a page, similar with their demo.What I don't understand is how to handle the score that is returned.I understand that the success is based on the treshold. Using the github package the backend verification is returning json (fail or success) back to the frontend.Am I supposed to handle the fail or success in the front end using javascript? What if the browser has the javascript disabled?I was thinking to use the recaptcha v3 on all the pages and block the users considered bots for an amount of time.I am using laravel but I can't figure out how to handle the verification in the middleware, or somewhere else, in order to block the users if they don't have a token (javascript is disabled) or they are considered bots.reCAPTCHA token should be validated server side. First of all, attach generated token into your form:Then when you capture the input on you controller, you can use a custom form request:g-recaptcha-response field is required so if users disable JS they will get an error when form input is validated.Next for g-recaptcha-response we apply a custom validation rule: RecaptchaV3.Here's my implementation:Next, in your controller use the above form request:Hope this helps.Unfortunately, recaptcha v3 does not have challenge methods, which means we need to handle the score threshold in our own server side. The best solution would be that apply both v2 and v3 together, e.g. if v3 fails threshold, then it pops up v2 challenge. The official site suggests to use 2-way authentication e.g. SMS. However, I don't think 70% of people would do it.I have created a composer package for Laravel framework which supports score settings. You can check the source code in github recaptcha:You can do score comparison for your own score handler.The basic usage would be like:If JavaScript is disabled, reCAPTCHA doesn't work anyway and most form submissions will/should fail if bot protection is critical to you.As for the score that V3 returns, it is entirely up to you how you handle it.Generally this is handled on form validations. The with V3 you could require the g-response value to be greater than 0.8 or something to your liking. Exact implementation varies greatly by how your app is structured.From the docs:

reCAPTCHA v3 returns a score (1.0 is very likely a good interaction, 0.0 is very likely a bot). Based on the score, you can take variable action in the context of your site.

How to use token authentication in laravel web page

Rishi Raut

[How to use token authentication in laravel web page](https://stackoverflow.com/questions/45386587/how-to-use-token-authentication-in-laravel-web-page)

I am trying to use JWT for laravel web page instead of session. so I made some changes.Now I am getting error How to fix this and start token authentication for laravel web page(blades not API).

2017-07-29 07:23:19Z

I am trying to use JWT for laravel web page instead of session. so I made some changes.Now I am getting error How to fix this and start token authentication for laravel web page(blades not API).I'm also using jwt protecting our api. You should change your config like below:Make sure the jwt library installed correctly: I found the solution here : https://github.com/tymondesigns/jwt-auth/issues/860In /routes/api.php - added a few basic authentication routesIn /app/http/Controller/auth/LoginController.phpand then override methods in login contollerAdding middleware AddTokenRegister middleware in Kernel.phpI think you can try this :EDITYou can find some help from the step by step example. In this example you need to focus on how to configure and use that token base authentication. Hope this help you well. Please refer this link. If you are using api as default then laravel authentication will throw an error. Laravel uses default Session based authentication out of the box with the default scaffolding users-view-controller that you already have. You have additional means of adding your own custom guard in the doc, so you can make use of the guard as needed.Therefore as @KevinPatel suggested, revert back to the default configuration, then in your route: group the route you want to be under JWT authentication, add the JWTMiddleware, in this case you have to update the controller responsible for your authentication to use the JWTAuth instead of the default auth. You should check this answer if you need to understand it better check this answer on LaracastsOne recommended way to incorporate the JWTAuth is to go for Dingo API (of course you are not building api, but) because Dingo already added some flesh to the authentication and other routes management - so things are pretty easy to use and configure

Calling .jar files from PHP - Stanford NLP - Could not find or load main java class

Diego Vidal

[Calling .jar files from PHP - Stanford NLP - Could not find or load main java class](https://stackoverflow.com/questions/39306031/calling-jar-files-from-php-stanford-nlp-could-not-find-or-load-main-java-cl)

I've got a project that is using this package agentile/PHP-Stanford-NLP (PHP interface to Stanford NLP Tools (POS Tagger, NER, Parser) which calls a few .jar files. Everything is working ok on localhost (MAMP) but when I deployed it to laravel forge it is not working anymore. I installed JRE/JDK, Oracle JDK, Oracle JDK 8 in my server.This is the piece of code I use to call the java files:This is the piece of code where the error comes from:https://github.com/agentile/PHP-Stanford-NLP/blob/51f99f1aaa1c3d5822fe634346b2b4b33a7a6223/src/StanfordNLP/Parser.php#L90This is the error:EDITED:This is the $cmd output from localhost:This is the $cmd output from production:

2016-09-03 10:45:08Z

I've got a project that is using this package agentile/PHP-Stanford-NLP (PHP interface to Stanford NLP Tools (POS Tagger, NER, Parser) which calls a few .jar files. Everything is working ok on localhost (MAMP) but when I deployed it to laravel forge it is not working anymore. I installed JRE/JDK, Oracle JDK, Oracle JDK 8 in my server.This is the piece of code I use to call the java files:This is the piece of code where the error comes from:https://github.com/agentile/PHP-Stanford-NLP/blob/51f99f1aaa1c3d5822fe634346b2b4b33a7a6223/src/StanfordNLP/Parser.php#L90This is the error:EDITED:This is the $cmd output from localhost:This is the $cmd output from production:The error message you posted:indicates that your class could be found by the java command. Which means your class is not in the classpath.The class edu.stanford.nlp.parser.lexparser.LexicalizedParser should be inside stanford-parser.jar which you are manually including in the classpath.In this scenario (since you said in the comments that the file actually exists) there are two main reasons that could cause the problem:The first cause is unlikely if you uploaded the files with the same user with which you are running the process, in any case it is easy to check and fix.The second cause can be solved by downloading a clean version and replacing the current one. You can download the new version from Maven Central and replace the one in your server using the following command:There can be two issues1) Please check if the paths /home/forge/mydomainname.com/public/lib /home/forge/mydomainname.com/public/ and corresponding jar files are present.

2) Check the access for all these files (is the access on these files same as your MAMP?)?

Laravel Auth::attempt() returns false

Programming_Duders

[Laravel Auth::attempt() returns false](https://stackoverflow.com/questions/41342907/laravel-authattempt-returns-false)

I am a home hobbyist and am studying Laravel, currently in version 5.3. I am using a Mac, neither homestead nor vagrant.  I'm currently working on a website that uses a login and a register system to create users.I've used php artisan migrate to manipulate my database locally.

As listed below, it has three fields, namely:I have a User model (users.php):And also, a UserController class (UserController.php):  As you can see, I am using bcrypt() as my hashing method.However, this problem is, it will always result to a failure.

I have checked the following links:P.S. These links seem very hard to follow as I do not utilize the Input class.

2016-12-27 09:56:51Z

I am a home hobbyist and am studying Laravel, currently in version 5.3. I am using a Mac, neither homestead nor vagrant.  I'm currently working on a website that uses a login and a register system to create users.I've used php artisan migrate to manipulate my database locally.

As listed below, it has three fields, namely:I have a User model (users.php):And also, a UserController class (UserController.php):  As you can see, I am using bcrypt() as my hashing method.However, this problem is, it will always result to a failure.

I have checked the following links:P.S. These links seem very hard to follow as I do not utilize the Input class.The problem is with the way you're redirecting the user to login route after the registration. You're falsely assuming that the $request data will be accompanied with the redirect.  Let's assume this scenario: A request gets dispatched to the postRegister method with name, email and password fields. The controller creates the user and saves it into the database. Then it redirects the user, who is not yet authenticated, to the login route. The postLogin method gets triggered, but this time with no request data. As a result, Auth::attempt($credentials) fails and you get that nasty Failure on screen.  If you add a dd($credentials) right after you create the array, you'll see that it has no values:  It will return something like this:  You cannot redirect with custom request data (unless with querystring which is part of the URL), not matter what. It's not how HTTP works. Request data aside, you can't even redirect with custom headers.  Now that you know what's the root of your problem, let's see what are the options to fix it.  In case you want to preserve this structure, you need to flash the request data of postRegister() into the session (which is persistent between requests) and then retrieve it in the postLogin() method using Session facade, session() helper or the actual Illuminate\Session\SessionManager class.  Here's what I mean:

(I slightly modified your code; dropped extra variables, made it a lil bit cleaner, etc.)I strongly recommend you against using this approach. This way the implementation of postLogin() method which is supposed to be responsible to login users gets coupled with session data which is not good. This way, you're not able to use postLogin independently from the postRegister.This is a slightly better solution; If you decided that you need to log in the user right after the registration, why not just doing that?  Note that Laravel's own authentication controller does it automatically.  By the way, here's what I mean:

(Ideally this should be broken down into multiple methods, just like Laravel's own authentication controller. But it's just an example to get you started.)But still, it's far from perfect! There are many other ways to tackle this. One could be using events, throwing exceptions on failure and redirecting using custom exceptions. But I'm not gonna explore them as there's already a solution perfectly designed for this.  If you want to write your own authentication controller, that's fine. You'll learn a lot along the way. But I strongly suggest reading Laravel's own authentication code, especially RegistersUsers and AuthenticatesUsers traits in order to learn from it. And one more note; you don't need that Illuminate\Auth\Authenticatable trait in your User model as it's already extending Authenticatable which use that trait.You should hash your password everytime you insert a row bcrypt(pass). Auth::attempt assumes that the password being retrieved from the database is hashedAuth::attempt uses \Hash::make($someString) to generate the hash. You should use this as well in order to generate same hashes from same strings (I assume the seed is different than with bcrypt() function).So change this line:To:

Mouse Hover in VueJS component implementation in Laravel

Albert Ruelan

[Mouse Hover in VueJS component implementation in Laravel](https://stackoverflow.com/questions/58025504/mouse-hover-in-vuejs-component-implementation-in-laravel)

My Mouse hover is not working when I am using it on Laravel.My Vue file is stored in resources/js/Dashboard.vueWhat I tried so far is to change v-on:mouseover with @mouseover but it still not working.The Result is that when I hover the button it doesn't change texts.What am I doing wrong and how can I fix it?Below, the content of my Dashboard.vue file;Here, the content of my Blade.php file;To take a close look and reproduce locally, below is the package.json file;Edit added my app.js

2019-09-20 09:23:03Z

My Mouse hover is not working when I am using it on Laravel.My Vue file is stored in resources/js/Dashboard.vueWhat I tried so far is to change v-on:mouseover with @mouseover but it still not working.The Result is that when I hover the button it doesn't change texts.What am I doing wrong and how can I fix it?Below, the content of my Dashboard.vue file;Here, the content of my Blade.php file;To take a close look and reproduce locally, below is the package.json file;Edit added my app.jsTry adding these to prevent default event and propagationThe code works, When i run on my system it works.I tried it on JSFiddle.Neat. Looks like as the button changes size during the animation, the mouse goes in and out of hover state because the edge is moving.I added a div around each button, and attached the hover triggers to the divs instead of the buttons

https://jsfiddle.net/jmbldwn/kbswLpto/5/In your Dashboard.vue file, try to change below:Into:(maybe an object works better for you)The answer is that i should put in resources/views/layouts/app.blade.php instead of putting it in my other view file such as those i manually created. For those wondering where in app.blade.php should i put the code above.Put it at the end of the body tagFor example in app.blade.php

How to make MySQL driver for HHVM return IDs as integers?

mauvm

[How to make MySQL driver for HHVM return IDs as integers?](https://stackoverflow.com/questions/26801856/how-to-make-mysql-driver-for-hhvm-return-ids-as-integers)

I noticed that my Laravel API does not return entity identifiers (the primary keys) as integers.In Api\PostController.php::show():Which returns something like:This messes up my table sorting (because IDs will be sorted as string: 1, 10, 11, 2 etc.).Dumping the entity itselfs also shows that the id attribute is a string.As mentioned here the probable cause is that the MySQL driver does not return values in the appropriate type.I'm using HHVM 3.3.1 on a Ubuntu 14.04 server. Is there any way I can use a native MySQL library (like php5-mysqlnd) for HHVM?I could use Laravel model accessors to solve the problem. But that is more of a hack IMO.Please help!References:EDIT: I have verified that it's not the ORM layer of Laravel. The PDO instance already returns IDs as strings.

2014-11-07 13:02:57Z

I noticed that my Laravel API does not return entity identifiers (the primary keys) as integers.In Api\PostController.php::show():Which returns something like:This messes up my table sorting (because IDs will be sorted as string: 1, 10, 11, 2 etc.).Dumping the entity itselfs also shows that the id attribute is a string.As mentioned here the probable cause is that the MySQL driver does not return values in the appropriate type.I'm using HHVM 3.3.1 on a Ubuntu 14.04 server. Is there any way I can use a native MySQL library (like php5-mysqlnd) for HHVM?I could use Laravel model accessors to solve the problem. But that is more of a hack IMO.Please help!References:EDIT: I have verified that it's not the ORM layer of Laravel. The PDO instance already returns IDs as strings.Create an accessor for the id in your Post class.You need to set typed_results in your /etc/hhvm/php.ini file.hhvm.mysql.typed_results = trueI don't have HHVM set up to test, but the fix in PHP would be to disable PDO::ATTR_EMULATE_PREPARES. For example, in your database config file, add:

Laravel Socialite + Making API calls after login

joepferguson

[Laravel Socialite + Making API calls after login](https://stackoverflow.com/questions/30586966/laravel-socialite-making-api-calls-after-login)

Laravel 5, Socialite, and google/apiclient packages.Source code: https://github.com/svpernova09/meatingsI have socialite working fine with Google for logging users in.I'm trying to make an API call in a different method to fetch Calendar events as the logged in user. I'm getting stuck with what tokens to use where.The error I'm getting is:My method:The Laravel output is:$user-code looks like: 4/hfPzDrOHyaEv3asdfadsfasdfDw72nXIl0rt2boUpGj7hM.Um5wPgCeasdfasdfafd1t6qxkmwIAny guidance would be great. I'm not getting anywhere with the google guides.

2015-06-02 03:47:07Z

Laravel 5, Socialite, and google/apiclient packages.Source code: https://github.com/svpernova09/meatingsI have socialite working fine with Google for logging users in.I'm trying to make an API call in a different method to fetch Calendar events as the logged in user. I'm getting stuck with what tokens to use where.The error I'm getting is:My method:The Laravel output is:$user-code looks like: 4/hfPzDrOHyaEv3asdfadsfasdfDw72nXIl0rt2boUpGj7hM.Um5wPgCeasdfasdfafd1t6qxkmwIAny guidance would be great. I'm not getting anywhere with the google guides.Calendar uses a different scope than social login. You have to ask for permission again. You can check the documentation of the Calendar API and try it out on Google Playground.Also Google returns "Code was already redeemed." because you already have an access token for the public information of the user with your code.

Wordpress Subscriptions in laravel (corcel)

Ivan Bravo Carlos

[Wordpress Subscriptions in laravel (corcel)](https://stackoverflow.com/questions/31485273/wordpress-subscriptions-in-laravel-corcel)

I have 2 projects, one in Wordpress, and the other one in Laravel 4.2.Recently i had to merge both projects into one Laravel 4.2 App using jgrossi/corcel. This was my only option.Everything works fantastic! I can even post directly into Wordpress without logging into Wordpress to get posts, comments, etc.But there is something I can't figure out. Wordpress is using Jetpack for subscribers. The laravel app needs a field to add more subscribers. I have very little experience in Wordpress.Is it possible to add subscribers from outside Wordpress directly into the database? If not, is there a way to use a Jetpack plugin outside of Wordpress?

2015-07-17 21:52:09Z

I have 2 projects, one in Wordpress, and the other one in Laravel 4.2.Recently i had to merge both projects into one Laravel 4.2 App using jgrossi/corcel. This was my only option.Everything works fantastic! I can even post directly into Wordpress without logging into Wordpress to get posts, comments, etc.But there is something I can't figure out. Wordpress is using Jetpack for subscribers. The laravel app needs a field to add more subscribers. I have very little experience in Wordpress.Is it possible to add subscribers from outside Wordpress directly into the database? If not, is there a way to use a Jetpack plugin outside of Wordpress?Yes you can add new users in database with subscribers role.Wordpress stores the users data in wp_users table and its meta info in wp_usermeta. So follow the following stepsSo you added a new user with subscriber role.

How to select all column name from a table in laravel?

Heng Sopheak

[How to select all column name from a table in laravel?](https://stackoverflow.com/questions/37157270/how-to-select-all-column-name-from-a-table-in-laravel)

I have tried to get all column names from a table TellerFunction:

2016-05-11 08:40:20Z

I have tried to get all column names from a table TellerFunction:You can get all columns name by simply doing that...Get Table Name From ModelGet Table Column Name From ModelNow you will get all columns of "products" table and if you need it in controller then you can get it by following way :Just in-case if you have multiple databases connections, try following:Add in the top of your php scriptRetrieve anywhere in your codeWith Database Connection    Without Database Connection    As of Laravel 6.x this works: The hint here is just to go around eloquent (which should just provide a simple way to do this, but clearly does not) and grab the PDO object and then use the answer from the same question for straight PDO accessThis will also work when there is no database selected by replacing 'Teller' with databasename.TellerHTH,-ftYou only need extract the keys from the query responseTo get all raws from table:This method will return the value of the column directly:Refer:You could simply write:If you have a Teller model you can also use Teller::all();UpdateTo get all column name you can run SHOW FIELDS TellerYou can use this

Laravel 5 syntax error, unexpected 'extends' (T_EXTENDS)

Santosh Achari

[Laravel 5 syntax error, unexpected 'extends' (T_EXTENDS)](https://stackoverflow.com/questions/30631635/laravel-5-syntax-error-unexpected-extends-t-extends)

This is the code in my controller: My App.blade.phpAnd index.blade.phpThis is the error that I get: Please help.Solution listed below. While the issue is silly, and easy to fix - it's hard to find a straight answer via Google Search. Hence keeping this question. 

2015-06-03 22:07:16Z

This is the code in my controller: My App.blade.phpAnd index.blade.phpThis is the error that I get: Please help.Solution listed below. While the issue is silly, and easy to fix - it's hard to find a straight answer via Google Search. Hence keeping this question. The <?php ?> Tags are not required in .blade.php files. Remove them and it works. (The blade syntax need not be in php tags. You can however, include PHP code in  tags.)The <?php ?> tags are not required in your laravel blade file saved with extension .blade.php laravel templating engine automatically parse blade commands from these files.But if you want to include php code in your blade file which is not part of blade engine commands then you will have to use <?php ?> tags.I know this is a bit old but the issue was clearly missed.In your index.blade.php file your missing the closing php tag "?>".The blade sytanx @extends, @section etc... should be in your html on the outside of any php code block.When you use @extends, it must be the first piece of code in your blade file.A blank space or an empty new line before @extends will also throw an error.

Laravel - where less/greater than date syntax

Selim

[Laravel - where less/greater than date syntax](https://stackoverflow.com/questions/41180569/laravel-where-less-greater-than-date-syntax)

This is not showing the correct count. What is the correct syntax ?

2016-12-16 08:59:18Z

This is not showing the correct count. What is the correct syntax ?Use a Carbon instance:Use DB::raw:We can also try this one. It works for me.

save image in public folder instead storage laravel 5

siros

[save image in public folder instead storage laravel 5](https://stackoverflow.com/questions/42562203/save-image-in-public-folder-instead-storage-laravel-5)

i wanna save my avatar at "Public" folder and ther retrieve.ok. i can save it but in "storage/app" folder instead "public"my friend told me go to "config/filesystem.php" and edit it ,so i did it like thisstill no change.here my simple codesRoute :ControllerView:How Can save my image (and file in future) at public folder instead storage?

2017-03-02 17:37:39Z

i wanna save my avatar at "Public" folder and ther retrieve.ok. i can save it but in "storage/app" folder instead "public"my friend told me go to "config/filesystem.php" and edit it ,so i did it like thisstill no change.here my simple codesRoute :ControllerView:How Can save my image (and file in future) at public folder instead storage?In config/filesystems.php, you could do this...

change the root element in public and you can access it by You can pass disk option to method of \Illuminate\Http\UploadedFile class:or you can create new Filesystem disk and you can save it to that disk.You can create a new storage disc in config/filesystems.php:in controller:You'll need to link your storage directory to your public folder with:Once you've done that, to display it in the view you can do:Or in your case:

How to get the day after tomorrow in PHP using DateTime?

Pat841

[How to get the day after tomorrow in PHP using DateTime?](https://stackoverflow.com/questions/18238394/how-to-get-the-day-after-tomorrow-in-php-using-datetime)

I have an Eloquent query that  currently looks like this:Which works fine, my question is, how do I go about formatting it like so:Meaning I am trying to find the results whose dates are between tomorrow and the day after tomorrow. Any help would be greatly appreciated.

2013-08-14 17:29:27Z

I have an Eloquent query that  currently looks like this:Which works fine, my question is, how do I go about formatting it like so:Meaning I am trying to find the results whose dates are between tomorrow and the day after tomorrow. Any help would be greatly appreciated.If you want to get the day after tomorrow you can use:You can find more information in the manual page 'Relative time formats'new \DateTime('tomorrow + 1day') It's OK if you are not interested in hours and minutes.. It's gives you always midnigth but $dayAfterTomorrow = (new \DateTime())->add(new \DateInterval('P2D'));gives you exactly 2 days from now and hours and minutes are keptThe day after tomorrow is two days from now, so this will work:-See it working

Laravel: Generate random unique token

user5486944

[Laravel: Generate random unique token](https://stackoverflow.com/questions/33334927/laravel-generate-random-unique-token)

I have a table in my database called keys that has this structure:Every time a user logs into my site, I need to generate a new token_id and token_key set for that user. How can I generate a random token for both the token_id and the token_key while keeping the two values unique?For example, if:Meaning:There can be no other row in the table with that combination of tokens. How can I do this?

2015-10-25 20:48:29Z

I have a table in my database called keys that has this structure:Every time a user logs into my site, I need to generate a new token_id and token_key set for that user. How can I generate a random token for both the token_id and the token_key while keeping the two values unique?For example, if:Meaning:There can be no other row in the table with that combination of tokens. How can I do this?I'd avoid including an extra package for a case like this one. Something like:...should do. Replace model name with yours, if different from 'User', and use your or suggested functions for creating random strings.In terms of generating the tokens, you could use one of Laravel's Helper Functions; str_random().This will generate a random string of a specified length, e.g str_random(16) will generate a random string of 16 characters (upper case, lower case, and numbers).Depending on how you are using the tokens, do they really need to be completely unique? Given that they will match to a user, or I assume you may be using the token_id and then verifying this against the token_key does it really matter if there is a double up of one of them? - although the chances of this are extremely small!However, if you do need them to be truly unique you can always use a validator with the unique constraint. Using this package you could also test that the two of them are unique too with unique_with. And then if the validator fails then it generates a new token as needed.Based off your examples, you would be using str_random(16) for token_id and str_random(30) for the token_key.You can use a dependency to do this. Dirape laravel-tokenRun the commandIn your controller useYou can use it like this:Following @ivanhoe suggestion... this is what I came up with:-

Laravel - DecryptException: 'The MAC is invalid'

user7346035

[Laravel - DecryptException: 'The MAC is invalid'](https://stackoverflow.com/questions/46070732/laravel-decryptexception-the-mac-is-invalid)

In laravel for registration I'm using encrypt algorithm for password instead of inbuilt bcrypt function in Laravel because to get password and send it to mail when password is forgot.But decrypt it is showing a error like This , when I run this code it is working on local but server itself it is not working below i have mentioned the code , can anyone please help

2017-09-06 08:51:41Z

In laravel for registration I'm using encrypt algorithm for password instead of inbuilt bcrypt function in Laravel because to get password and send it to mail when password is forgot.But decrypt it is showing a error like This , when I run this code it is working on local but server itself it is not working below i have mentioned the code , can anyone please helpThe problem is you generated a new APP_KEY, then if you try to decrypt the old encrypted data it will show the DecryptException: The MAC is invalid.If you want to decrypt the old data you need to restore your old APP_KEY.After realizing that, now, adding a new problem there, if you stored new data with another APP_KEY or another encryption method you have a problem on the data because they are mixed on the table.In case you don't know when do you started with the new encrypt method or differentiate the new encrypted entries, the fastest solution would be reset all the passwords with the new encrypt method.You can learn more about how Laravel encryption works on the official Laravel docs.To avoid this, use a custom key instead. The default key is APP_KEY, but you can provide one so your decrypt is not linked with new or old APP_KEY.

I use the following code to resolve it, and it worked in different APP_KEYs.Important for key length : if $cipher == 'AES-128-CBC' use $length === 16, if $cipher == 'AES-256-CBC' use $length === 32). Check in config/app.cipher which cipher your app uses.I copied the APP_KEY from the environment it was working dev to the production and the issue was solved. you may want to try it.If you have imported DB form one environment to another, most likely you will face this error. Its recommended to have same APP_KEY as data source application in order to fix bug.

Laravel4 duplicate / copy table row

kilrizzy

[Laravel4 duplicate / copy table row](https://stackoverflow.com/questions/18322214/laravel4-duplicate-copy-table-row)

I'm sure there has to be a quicker way to do the following. I wasn't able to find anything about how to save a laravel modal object as a new row without overwriting the existing item. Essentially, a simpler of my existing code:Instead, copying everything but the id of the row:

2013-08-19 20:08:16Z

I'm sure there has to be a quicker way to do the following. I wasn't able to find anything about how to save a laravel modal object as a new row without overwriting the existing item. Essentially, a simpler of my existing code:Instead, copying everything but the id of the row:You can try

Replacement for File::mime() in Laravel 4 (to get mime type from file extension)

mtmacdonald

[Replacement for File::mime() in Laravel 4 (to get mime type from file extension)](https://stackoverflow.com/questions/19681854/replacement-for-filemime-in-laravel-4-to-get-mime-type-from-file-extension)

Laravel 3 had a File::mime() method which made it easy to get a file's mime type from its extension:On upgrading to Laravel 4 I get an error:Call to undefined method Illuminate\Filesystem\Filesystem::mime()I also can't see any mention of mime types in the Filesystem API docs.What's the recommended way to get a file's mime type in Laravel 4 (please note this is not a user-uploaded file)?

2013-10-30 12:09:25Z

Laravel 3 had a File::mime() method which made it easy to get a file's mime type from its extension:On upgrading to Laravel 4 I get an error:Call to undefined method Illuminate\Filesystem\Filesystem::mime()I also can't see any mention of mime types in the Filesystem API docs.What's the recommended way to get a file's mime type in Laravel 4 (please note this is not a user-uploaded file)?One solution I've found is to use the Symfony HttpFoundation File class (which is already included as a dependency in Laravel 4):And in fact the File class uses the Symfony MimeTypeGuesser class so this also works:But unfortunately I'm getting unexpected results: I'm getting text/plain instead of text/css when passing a path to a css file.IF you had just uploaded the file you can use:  You can see more here! I hope it be for some help! :DEDIT:

Input::file is some kind of extention from File, so you may use File::get('file')->getMimeType(); also. Didn't test, but MUST work.After reading that:I decided instead to port Laravel 3's implementation of File::mime() into a helper library within my Laravel 4 application. The Laravel 3 implementation just reads the MIME types from a config lookup array, based on file extension.Solution:It turned out that Symfony ExtensionGuesser and MimeTypeGuesser use unreliable FileInfo class. For that reason validation of mimes return unpredictable results and can not be used with files uploads in a proper way (it returns text/plain mime for js, xls, po etc.).I've found very simple solution for this problem.Instead of I split that into two different parts and now my validation looks like this:I simply try to verify that extension of the file is present and that it is listed in my in rule. That works, however, solution is not perfect.Ref: https://github.com/illuminate/filesystem/blob/master/Filesystem.php#L194

Clear Laravel's orderBy

Rafael Sierra

[Clear Laravel's orderBy](https://stackoverflow.com/questions/26869897/clear-laravels-orderby)

I have a generic function which gives me generic querysets, something like:This function is used everywhere my project, but in a specific point I need to use this queryset but changing the ORDER BY, much like this:If I run this code, the ORDER BY will just append onto the previous and generate an invalid query, since the "somefield" is not on the SELECTed fields. i.e.: How do I clear the orderBy so I can just reuse querysets?

2014-11-11 16:40:35Z

I have a generic function which gives me generic querysets, something like:This function is used everywhere my project, but in a specific point I need to use this queryset but changing the ORDER BY, much like this:If I run this code, the ORDER BY will just append onto the previous and generate an invalid query, since the "somefield" is not on the SELECTed fields. i.e.: How do I clear the orderBy so I can just reuse querysets?I agree there should be a clearOrderBy() method added to the query builder. However because the registry of orderbys is a public property on Illuminate\Database\Query\Builder you actually can clear it yourself today. The trick is getting access to the base query object:At other times, for example when manipulating a relation query, you need to get to access the base query (Illuminate\Database\Query\Query). So for example:Thats it. I plan to submit a PR for a clearOrderBy() as well.Why not "genericise" your queryset?Then you can useHere is a simple solution , tiny package you can use it by simply calling ->clearOrdersBy()

https://github.com/phpfalcon/laravel-clear-orders-by

No table name set on execute migration in Lumen

henriale

[No table name set on execute migration in Lumen](https://stackoverflow.com/questions/32879392/no-table-name-set-on-execute-migration-in-lumen)

I'm facing this error when attempting to run the migration in Lumen Framework:$ php artisan migrate:installAnd now I have no idea what's going on.Note that the table that is not being created is the one which controls the migrations at all.

2015-10-01 04:19:56Z

I'm facing this error when attempting to run the migration in Lumen Framework:$ php artisan migrate:installAnd now I have no idea what's going on.Note that the table that is not being created is the one which controls the migrations at all.I found the solution myself!Just add the name of the table on database config array and it's done!'migrations' => 'migrations',

Laravel get intended url

Adams.H

[Laravel get intended url](https://stackoverflow.com/questions/21499444/laravel-get-intended-url)

I use a common httpRequest to login, so I could use Redirect::intended(); to lead the user to a url before them being lead to the login page.  That all works well.Now I've changed login to ajax request I can only redirect the url in javascript now. So I've to pass the intended url to front end then do the window.location=urlThe problem is I can't get the intended/original url. Can any kind laravel expert help me out ?

2014-02-01 14:45:26Z

I use a common httpRequest to login, so I could use Redirect::intended(); to lead the user to a url before them being lead to the login page.  That all works well.Now I've changed login to ajax request I can only redirect the url in javascript now. So I've to pass the intended url to front end then do the window.location=urlThe problem is I can't get the intended/original url. Can any kind laravel expert help me out ?In your controller action use:$url = Redirect::intended( ... )->getTargetUrl();(Where ... is the fallback url)Then return it in the JSON response, and use window.location or other to do the redirect.When you are showing the form foe log in, you can grab the intended url from session if available and pass it to the view then redirect using window.location.So. how to grab the intended url ?Here, first argument is intended url if available in the session and default is set to home page using url('/') helper method, so the $intended_url will always contain a url, intended or defaulr. Then when you are loading the view, pass the $intended_url using this:Then use it from the view like:Alternatively, you may setup a View Composer so whenever the login view/form is displayed the intended url will be available in that view and you can do it using this:Here, login is the view name for login page, if this is something else in your case then change it to the appropriate name of your login view. You can keep this code in your app/start folder inside the 'global.php' file or keep it in a separate file and include this fie inside global.php file using this (at the end):Assumed that, file name would be view_composer.php, present in the app/start folder.In Laravel 5.7: I am using the following approach with a custom login controller and middleware for Laravel 5.7, but I hope that works in any of laravel 5 versions

Trying to understand why Laravel's many static methods is not considered bad practice [closed]

Lisa Miskovsky

[Trying to understand why Laravel's many static methods is not considered bad practice [closed]](https://stackoverflow.com/questions/15080612/trying-to-understand-why-laravels-many-static-methods-is-not-considered-bad-pra)

I'm pretty confused.I've asked a few developers on Reddit to review my codes. It looks like this.So it loads register.php, replaces {error_message} with translation. (Sorry, this username is in use. Please pick another.)They said using too many static calls is a bad practise. Yet they suggest Laravel framework, which completely gets rid of $this and uses static calls.Can someone explain me how come if this is bad practise, Laravel being a classy framework?

2013-02-26 03:02:06Z

I'm pretty confused.I've asked a few developers on Reddit to review my codes. It looks like this.So it loads register.php, replaces {error_message} with translation. (Sorry, this username is in use. Please pick another.)They said using too many static calls is a bad practise. Yet they suggest Laravel framework, which completely gets rid of $this and uses static calls.Can someone explain me how come if this is bad practise, Laravel being a classy framework?Static state is omnipresent and entirely destroys testability since you can't just reset the state. Additionally, anything could affect the state in ways that other aspects of the code can't predict, resulting in the potential for wildly unpredictable behavior.Laravel 4 prevents this by using static 'facades'. These facades are "syntactic short-hand for IoC resolution". They provide both syntactic sugar and prevent tightly coupled code.The classes that are resolved by the facades can be changed and allow you to inject mock systems or whatever you wish. Of course, this doesn't really solve the other aspect of static access.. Which is that you can't just inject different functionality. But, with Laravel applications you generally don't have facade use within your domain. It's more for the web transport layer, where it's very helpful since the web transport layer is already tightly coupled with your framework, this just makes good use of that fact by creating something sort of akin to a DSL for that layer of your application.I repeat, please consider not using facades deep in your domain layer.

Problems installing laravel with composer [duplicate]

matt

[Problems installing laravel with composer [duplicate]](https://stackoverflow.com/questions/28332103/problems-installing-laravel-with-composer)

Problem: I'm wanting to explore laravel 5, and failing miserably at installing it. I'm using this guide: http://laravel.com/docs/5.0 and need someone to help me understand the instructions.Background and What I've TriedI'm running Mac OSX 10.10.2 (Yosemite) and MAMP. So far, I've downloaded Composer to my home folder using terminal. There is just a composer.phar file sitting there.When I run:I get the message:I assume that is ok because when I run the following in terminal, I get the composer logo and a list of optionsI'm not 100% sure what the following means, from the Laravel Docs:Because I can't figure it out, the following steps throw errors, such as: I've been going through a few forums, and it's suggested that I need to update my PHP.ini file - this seems more related to Composer install, and not specifically Laravel. Because composer is working, this seems to be a dead end.Ideally, I want to install Laravel 5 to the directory because Composer.phar is in my home folder, I think the command should be:or just As mentioned, it just (correctly) throws errors. Question:

If anyone can help solve my total user error, by explaining what "Make sure to place the ~/.composer/vendor/bin directory in your PATH so the laravel executable can be located by your system." means to a n00b, that'd be really appreciated.Many thanks!

2015-02-04 21:47:20Z

Problem: I'm wanting to explore laravel 5, and failing miserably at installing it. I'm using this guide: http://laravel.com/docs/5.0 and need someone to help me understand the instructions.Background and What I've TriedI'm running Mac OSX 10.10.2 (Yosemite) and MAMP. So far, I've downloaded Composer to my home folder using terminal. There is just a composer.phar file sitting there.When I run:I get the message:I assume that is ok because when I run the following in terminal, I get the composer logo and a list of optionsI'm not 100% sure what the following means, from the Laravel Docs:Because I can't figure it out, the following steps throw errors, such as: I've been going through a few forums, and it's suggested that I need to update my PHP.ini file - this seems more related to Composer install, and not specifically Laravel. Because composer is working, this seems to be a dead end.Ideally, I want to install Laravel 5 to the directory because Composer.phar is in my home folder, I think the command should be:or just As mentioned, it just (correctly) throws errors. Question:

If anyone can help solve my total user error, by explaining what "Make sure to place the ~/.composer/vendor/bin directory in your PATH so the laravel executable can be located by your system." means to a n00b, that'd be really appreciated.Many thanks!Laravel is a PHP framework (makes writing PHP applications easy)Composer is a PHP package and dependency manager. (makes installing and updating third party code libraries easy)When you runYou're using composer to install the laravel/installer=~1.1 package into composer's "global" project folder (usually ~/.composer).  This is what installed the command line program named laravel.The command line program named laravel is a shell script for installing the PHP framework (Also named Laravel).Your "Unix Path" is a list of folders where a command line script will search for an executable.  Usually is has folders like /usr/bin, /usr/local/bin, etc.  This is why when you run ls, you're actually running /usr/bin/ls -- the shell knows to check each folder in the path for a location.  You can view your current path by typingSo, the problem is composer installed the laravel command line program to a folder that's not in your unix path.  You need to add this folder to your unix path.  You can do this by running the following (assuming you're using bash, which is OS X's default shell)If you run that, you should be able to run the laravel command line program and continue your installation. Most people add this to their .bash_profile or .bashrc files.  The Unix Stack Exchange has a lot of good information if you're interested in learning how to do this. You can add the directory to the PATH variable by editing /etc/paths.

Here's a tutorial on how to do that.Just add a line with:Then the laravel new command should work fineIf everything fails you can still use the composer create-project command to make a new laravel instance:I added C:\Users\Leon\AppData\Roaming\Composer\vendor\bin instead of ~/.composer/vendor/bin to the Path variable.  Here is instructions on changing the path variable on Windows 10:

http://windowsitpro.com/systems-management/how-can-i-add-new-folder-my-system-path

Apply Middleware to all routes except `setup/*` in Laravel 5.4

Andy Holmes

[Apply Middleware to all routes except `setup/*` in Laravel 5.4](https://stackoverflow.com/questions/43135138/apply-middleware-to-all-routes-except-setup-in-laravel-5-4)

I'm experimenting with Middleware in my Laravel application. I currently have it set up to run on every route for an authenticated user, however, I want it to ignore any requests that begin with the setup URI.Here is what my CheckOnboarding middleware method looks like:This is being used in my routes like this:Now, if I go to /home or /account I get redirected to /setup as you would expect. This originally caused a redirect loop error hence why & $request->path() != 'setup' is in the Middleware.I feel like this is a really clunky way of doing it, and obviously doesn't match anything after setup like the setup/settings route I have created.Is there a better way to have this Middleware run on all routes for a user, but also set certain routes that should be exempt from this check? 

2017-03-31 07:37:46Z

I'm experimenting with Middleware in my Laravel application. I currently have it set up to run on every route for an authenticated user, however, I want it to ignore any requests that begin with the setup URI.Here is what my CheckOnboarding middleware method looks like:This is being used in my routes like this:Now, if I go to /home or /account I get redirected to /setup as you would expect. This originally caused a redirect loop error hence why & $request->path() != 'setup' is in the Middleware.I feel like this is a really clunky way of doing it, and obviously doesn't match anything after setup like the setup/settings route I have created.Is there a better way to have this Middleware run on all routes for a user, but also set certain routes that should be exempt from this check? There's nothing wrong with what you're doing, however, I would suggest splitting your route groups up instead i.e.:Alternatively, have a parent group for your auth:This will also mean you can remove the extra condition in your middleware:Hope this helps!You can utilize the Controller class for this with pretty spectacular results. If you create a __construct function inside of HTTP/Controllers/Controller.php then you can declare middleware to run on every controller action and even declare exceptions as needed.Be careful not to put any of the standard index, store, update, destroy functions in the exception or you'll open up potential security issues. Routes on which you dont want the middleware to run , simply put them outside of the function:

Laravel 4 validator for password field in edit account

Mwirabua Tim

[Laravel 4 validator for password field in edit account](https://stackoverflow.com/questions/17899755/laravel-4-validator-for-password-field-in-edit-account)

I need to check if a user has posted the same password as the one in the database. Field for old password is 'oldpass'. The custom validator i created is called 'passcheck'. It should fail or pass accordingly.My UsersController code below doesnt work. What could have I have done wrong? 

2013-07-27 16:02:33Z

I need to check if a user has posted the same password as the one in the database. Field for old password is 'oldpass'. The custom validator i created is called 'passcheck'. It should fail or pass accordingly.My UsersController code below doesnt work. What could have I have done wrong? You should use something like this,So, you have to get the record using username or any other field and then check the password.@lucasmichot offered even shorter solution:I would make it like this:This validator rule will make database query to check current user's passwordYou can make it even shorter and save query:Please dont tie your rule to an Html element. Use the parameters Laravel provides to create your custom rules. This would be (asuming that you have a user authenticated):

Laravel returning children of parents in same table

Randy Rankin

[Laravel returning children of parents in same table](https://stackoverflow.com/questions/32122849/laravel-returning-children-of-parents-in-same-table)

Using Laravel 5.1, I am trying to create a menu list from a MySQL categories table. My service provider returns data, but I don't understand how to create the child categories in a foreach loop. When I perform the loop, only the last row of the child query is returned. Any guidance would be appreciated.categories TableDesired ResultviewComposerServiceProvider.phpheader view

2015-08-20 15:52:46Z

Using Laravel 5.1, I am trying to create a menu list from a MySQL categories table. My service provider returns data, but I don't understand how to create the child categories in a foreach loop. When I perform the loop, only the last row of the child query is returned. Any guidance would be appreciated.categories TableDesired ResultviewComposerServiceProvider.phpheader viewFirst of all, what you are doing is inefficient. Your view iterates through all subcategories for every parent category. If you defined relations properly and made use of Eloquent's eager loading, you could fetch and access child categories in easier way.Start with defining relations:Once you have the relations defined properly, you can fetch whole category tree like below:The second composer won't be needed, as parent categories already contain children.Now, you only need to display the categories in your view:I've found the solution myself.

I have to iterate through the results to get access to the member variable.

How to get view data during unit testing in Laravel

Claire

[How to get view data during unit testing in Laravel](https://stackoverflow.com/questions/21139026/how-to-get-view-data-during-unit-testing-in-laravel)

I would like to check the array given to a view in a controller function has certain key value pairs.  How do I do this using phpunit testing?

2014-01-15 13:42:21Z

I would like to check the array given to a view in a controller function has certain key value pairs.  How do I do this using phpunit testing?I found a better way to do it.  I wrote a function in the TestCase which returns the array I want from the view data.So to get a value from the $data object I simply use $user = $this->getResponseData($response, 'user');Inside a test case use: $data = $this->response->getOriginalContent()->getData();Example:Example dumping data so you can see what in data(array) passed to view:Should get something back like what's in image:I managed it by doing it in a messy way. I used assertViewHas:So looking at how assertViewHas is implemented HERE it looks like, what the method does, is access the view's data after this call:In your code, the line:essentially returns the same thing as the line above it, namely a \Illuminate\Http\Response (which extends the symfony component \HttpFoundation\Response)So, inside the assertViewHas function it looks like laravel accesses the data using $response->$key, so I would try to access the clients and 'content' variables through the $response object.If that doesn't work try searching around the TestCase file in the Laravel framework ... I'm sure the answer is in there somewhere. Also try to dump the $response object and see what it looks like, there should be some clues there.The first thing I would try, though, is accessing your data through the $response object.You can access data in  the response and it can be checked..This worked for me:And from there you can check the contents of the message box for whatever error you might want verify.Looking for something like this in 2019, I got:

$response->getData()->data[0]->...my propertiesStill looking for a simpler way to access it.

Laravel validate error

Vitalii

[Laravel validate error](https://stackoverflow.com/questions/24328850/laravel-validate-error)

This is the errorThis is my codeWhat can this be?

2014-06-20 13:49:25Z

This is the errorThis is my codeWhat can this be?I believe that you probably have in your file.  (Your IDE probably thought it was being helpful.)  To use the static :: call, Validator should be aliased to Illuminate\Support\Facades\Validator. (The \app\config\app.php file does this for you by default.)Chances are good that changing the use statement to will fix things.Can you plz go to your app/config/app.php and check whether 

    'Illuminate\Validation\ValidationServiceProvider' 

is available or not.If not then just add this line and check if the problem is solved or not.

Hope it will help you.

Laravel Eloquent, select only rows where the relation exists

Kenyon

[Laravel Eloquent, select only rows where the relation exists](https://stackoverflow.com/questions/31598949/laravel-eloquent-select-only-rows-where-the-relation-exists)

I am trying to select from a table, but I only want to select things that have an existing relationship.For example, if I have Users and Comments, and Users haveMany Comments, I want to do something like:So, I only want to select Users that have at least 1 Comment, and paginate the result of that query. Is there any way to do this?

2015-07-23 22:11:20Z

I am trying to select from a table, but I only want to select things that have an existing relationship.For example, if I have Users and Comments, and Users haveMany Comments, I want to do something like:So, I only want to select Users that have at least 1 Comment, and paginate the result of that query. Is there any way to do this?According to Laravel's Eloquent documentation for querying relations (look for the "Querying Relationship Existence" subheading), this should work:Flip your thinking upside down and I think that you can do it.You may not need the groupBy() but that should get you started towards a way to do it.Then you should be able to iterate through each like so:

LARAVEL: Get an array of scheduled tasks for output in admin dashboard

John Mellor

[LARAVEL: Get an array of scheduled tasks for output in admin dashboard](https://stackoverflow.com/questions/35559769/laravel-get-an-array-of-scheduled-tasks-for-output-in-admin-dashboard)

Using the Laravel task scheduler I have created a number of tasks in Kernel.phpe.g:I would like to display the list of scheduled commands and there frequency (as well as last/next run time, which I can log myself using the before/after functions).However i'm stuck at the first hurdle. What i'm not sure how to do is get an array of the scheduled tasks that have been defined in Kernel.phpSimplified Question: How can I get an array of the scheduled tasks in Laravel?

2016-02-22 17:15:26Z

Using the Laravel task scheduler I have created a number of tasks in Kernel.phpe.g:I would like to display the list of scheduled commands and there frequency (as well as last/next run time, which I can log myself using the before/after functions).However i'm stuck at the first hurdle. What i'm not sure how to do is get an array of the scheduled tasks that have been defined in Kernel.phpSimplified Question: How can I get an array of the scheduled tasks in Laravel?There's actually no support out of the box for this, unfortunately. What you'll have to do is extend the artisan schedule command and add a list feature. Thankfully there's a simple class you can run:This will provide you with a php artisan schedule:list.  Now that's not exactly what you need, but then you can easily get this list from within your Laravel stack by executing:And that will provide you with a list of the schedule commands.Of course, don't forget to inject the Facade: use Illuminate\Support\Facades\Artisan;As your not running through the console you need to invoke the schedule method on the Kernel in your controller... (don't forget to make the schedule method public instead of protected).I was having the task to stop/enable and edit the frequency of the scheduled tasks from the admin dashboard. So I foreach them in Kernel.php and capture the output in function.Hope this help you.

Laravel 4 : How are Facades resolved?

theUnknown777

[Laravel 4 : How are Facades resolved?](https://stackoverflow.com/questions/20311336/laravel-4-how-are-facades-resolved)

I've kind of looking at what's going on Laravel 4 facades under the hood.Let's take this Facade as an example:If i'm not mistaken, the step by step (oversimplified) invocation would be:What I'am confused about is in the commented line below of the method File::resolveFacadeInstance() below:My questions are:

2013-12-01 10:51:56Z

I've kind of looking at what's going on Laravel 4 facades under the hood.Let's take this Facade as an example:If i'm not mistaken, the step by step (oversimplified) invocation would be:What I'am confused about is in the commented line below of the method File::resolveFacadeInstance() below:My questions are:I'll try to describe in short :So, you already know that resolveFacadeInstance method is called via __callStatic method of Facade class and component's Facade (i.e. File extends Facade) extends this Facade class.During the boot-up process of the framework, from public/index.php following line starts the execution of bootstrap/start.php fileSo, in this (bootstrap/start.php) file you can see some code likeIn this code snippet, require $framework.'/Illuminate/Foundation/start.php'; line starts the execution of Foundation/start.php file and in this file you may see something like thisThis (given above) line sets application instanse to $app property in the Facade classThen in the Foundation/start.php file at the bottom, you can see something like thisIn this code snippet given above, all the core components registered by the framework and as you know that, every component has a service provider class (i.e. FilesystemServiceProvider) and in every service provider class there is a method register which is (for FilesystemServiceProvider)Well, in this case $this->app['files'] setting (return new Filesystem) an anonymous function, which returns the filesystem when gets executedto $app['files'] so, when you call the File::get(), it finally calls the anonymous function and in this case, the following lineCalls the function for static::$app['file']; and this function returns the instance but before returning, it stores the instance in the $resolvedInstance variable, so, next time it can return the instance from the variable without calling the anonymous function again. 

So, it looks like that, static::$resolvedInstance[$name] = static::$app[$name]; calls the anonymous function which returns the instance and this function was registered earlier, when the app was started through boot up process.Important :Application extends Container and Container extends ArrayAccess class and that's why, a property of the $app object could be (accessed) set/get using array notation.I've tried to give you an idea but you have to look in to the code, step by step, you won't get it only reading/tracking the code once.

Laravel 4: Adding where clause to a join condition

user9507

[Laravel 4: Adding where clause to a join condition](https://stackoverflow.com/questions/20880151/laravel-4-adding-where-clause-to-a-join-condition)

It says in the laravel docs that it is possible to add where clause on a join, but whenever I try in my code using the where clause, I get the error: Call to undefined method Illuminate\Database\Query\JoinClause::where(). Anyone knows how to add where clause in a join clause?Laravel Website Example:Code I'm trying to implement:

2014-01-02 09:48:21Z

It says in the laravel docs that it is possible to add where clause on a join, but whenever I try in my code using the where clause, I get the error: Call to undefined method Illuminate\Database\Query\JoinClause::where(). Anyone knows how to add where clause in a join clause?Laravel Website Example:Code I'm trying to implement:if you want add more condition on a join add more $join->on or $join->orOn.if you want to add a condition to your first select, add it outside join function.Updated

In Laravel 4.0 which I think you use, you can't use where inside your join closure, but since Laravel 4.1 and above you can have where conditions after your join condition. I couldn't find documentation for Laravel 4.1 but this is the #join documentation for L4.2 and abovePlease Check Below AnswerTry This solutionYou are calling $current_date but you decarle $dateI don't know if this solve the problem, try it ;)You are sure that you are working with laravel 4.1? I think you are using laravel 4.0 instead of 4.1. Look in your composer.json file. https://laravel.com/docs/5.6/queries please check this link

Get rows where created date is older than 14 days

nielsv

[Get rows where created date is older than 14 days](https://stackoverflow.com/questions/34138194/get-rows-where-created-date-is-older-than-14-days)

This is the case:In my database I have a table deployments. The rows in the table also have a field created_at. Now I would like to select all rows where the created_date is older than 14 days. But I'm stuck on how to do this with Carbon. My query now looks like this:Can anyone help me with this?

2015-12-07 16:17:00Z

This is the case:In my database I have a table deployments. The rows in the table also have a field created_at. Now I would like to select all rows where the created_date is older than 14 days. But I'm stuck on how to do this with Carbon. My query now looks like this:Can anyone help me with this?You can use the subDays() method:You can use Carbon::now()->subDays(14)You can read more about Carbon its feature here Carbon Documentation

Laravel 5.2 login session not persisting

Nauphal

[Laravel 5.2 login session not persisting](https://stackoverflow.com/questions/34529146/laravel-5-2-login-session-not-persisting)

I have been implementing a simple authentication system on Laravel 5.2 using Sentinel. So, the above code outputs Login success after the authentication code. But, the login status is not getting persisted to other requests. ie: if I check the authentication status from other requests, it is saying that I am not logged in!I have even tried to implement a defaut laravel authencation using \Auth::attempt. But, that also giving the same thing.Any help on this is greatly appreciated.

2015-12-30 11:58:24Z

I have been implementing a simple authentication system on Laravel 5.2 using Sentinel. So, the above code outputs Login success after the authentication code. But, the login status is not getting persisted to other requests. ie: if I check the authentication status from other requests, it is saying that I am not logged in!I have even tried to implement a defaut laravel authencation using \Auth::attempt. But, that also giving the same thing.Any help on this is greatly appreciated.In Laravel 5.2 you need to apply web group middlewere to all your routes you wan't to make sessions work. This is the major change from Laravel 5.1.Please look at https://laravel.com/docs/5.2/routing#basic-routingThe default routes.php file looks like this at the moment:EDITYou can look also directly at https://github.com/laravel/laravel/blob/master/app/Http/Kernel.php into middlewareGroups property to know which middlewares are fired for web group middleware

Multiple Projects using single laravel instance

kanchan

[Multiple Projects using single laravel instance](https://stackoverflow.com/questions/22555094/multiple-projects-using-single-laravel-instance)

I am new to Laravel. As per my research on this framework I find it quite useful for my projects. However I am facing difficulty in customizing it to use a single instance of Laravel framework for multiple projects. I do not want to follow the multi site approach as available in Laravel i.e., using directory structure in models and controllers for projects because I won't be able to push my project related changes in a single step in Git.I want something like this.i.e., New project must have its own app directory and is able to use model functions from common project.This will ease my task and would be very useful for my upcoming projects.

If someone could help me with this I'll really appreciate.

2014-03-21 09:40:22Z

I am new to Laravel. As per my research on this framework I find it quite useful for my projects. However I am facing difficulty in customizing it to use a single instance of Laravel framework for multiple projects. I do not want to follow the multi site approach as available in Laravel i.e., using directory structure in models and controllers for projects because I won't be able to push my project related changes in a single step in Git.I want something like this.i.e., New project must have its own app directory and is able to use model functions from common project.This will ease my task and would be very useful for my upcoming projects.

If someone could help me with this I'll really appreciate.Create PSR-4 autoloading entries to separate your projects files by namespace:Everything common you put in Core, everything non-common in the related project files. Now you just have to create your files in theirs respective folders and namespace them:This is a BaseController in Core, used by all your controllers:This is a BaseController of the Main application using your Core Controller:And this is a HomeController of the Main application using your its Base Controller, as they are in the same namespace you don't even need to import the file:Every single class file in Laravel can be organized this way, even your views, so you can have those files:Then your routes could be separated (organized) and prefixed by namespace:Giving those urls:And pointing actions to those controller actions:There's not really a question here to be answered, but in general terms what you want to do is very feasible.You could create a directory under the apps folder for each project and namespace each of the classes in the structure you create below it. You'd then use PSR (ideally PSR-4) autoloading to make these classes accessible.You'd put the routes for each project in their own routes file and then include them through the main routes file, or you could create a service provider for each project, add it your app config file and use that to load the routes for that project.HOWEVER, all that said, this isn't what I would do. You haven't said why you want to structure your projects this way, so you may have a perfectly good reason, but personally I prefer to put common libraries into their own packages (helps to ensure clear boundaries and clean apis) and use Composer to pull them into each project.

Laravel: Escape「LIKE」clause?

mpen

[Laravel: Escape「LIKE」clause?](https://stackoverflow.com/questions/22749182/laravel-escape-like-clause)

How can I escape a LIKE clause in Laravel/Eloquent? e.g.,If $search contains a % or _ they need to be escaped.

2014-03-30 20:09:13Z

How can I escape a LIKE clause in Laravel/Eloquent? e.g.,If $search contains a % or _ they need to be escaped.The other answer forgets about escaping the escape character itself, here is a more robust solution:Temporary solution:referenceI was hoping for something database-agnostic and more robust. I think you can change the escape char in MySQL, although I don't know why you would.

How do I perform Laravel Artisan migrations on AWS Elastic Beanstalk?

oskarth

[How do I perform Laravel Artisan migrations on AWS Elastic Beanstalk?](https://stackoverflow.com/questions/22974516/how-do-i-perform-laravel-artisan-migrations-on-aws-elastic-beanstalk)

I have a Laravel installation and have set up three environments with their own corresponding config directories:I use php artisan migrate:make create_users_table etc as described here to create database migrations.In my local environment I use Vagrant and a simple MySQL server setup, and on staging & production I use AWS RDS.To configure database access for the staging environment I have a app/config/staging/database.php file with settings like this:I use git to deploy the app with git aws.push as described here.The question is: How do I run the migration on my staging (and later production) EBS server when deploying?

2014-04-09 21:42:58Z

I have a Laravel installation and have set up three environments with their own corresponding config directories:I use php artisan migrate:make create_users_table etc as described here to create database migrations.In my local environment I use Vagrant and a simple MySQL server setup, and on staging & production I use AWS RDS.To configure database access for the staging environment I have a app/config/staging/database.php file with settings like this:I use git to deploy the app with git aws.push as described here.The question is: How do I run the migration on my staging (and later production) EBS server when deploying?I solved it by creating a new directory in the root of my project named .ebextensions. In that directory I created a script file my-scripts.config:The file my-scripts.config gets executed when EBS deploys, is a YAML file and looks like this:Add the directory and file to git, commit, and run git aws.push and it will migrate.Explanations on how stuff in .ebextensions works can be found here.The path /var/app/ondeck is where your application lives when your script runs, it will afterwards be copied into /var/app/current.The artisan option --env=staging is useful for telling artisan what environment it should run in, so that it can find the correct database settings from app/config/staging/database.phpIf you need a quick and dirty way to log why the migrate command fails you might want to try out something like "php /var/app/ondeck/artisan --env=staging migrate > /tmp/artisan-migrate.log" so that you can log into your ec2 instance and check the log.

Laravel custom validation - get parameters

Rajesh Kumar

[Laravel custom validation - get parameters](https://stackoverflow.com/questions/30296615/laravel-custom-validation-get-parameters)

I want to get the parameter passed in the validation rule.For certain validation rules that I have created, I'm able to get the parameter from the validation rule, but for few rules it's not getting the parameters.In model I'm using the following code:In ValidatorServiceProvider I'm using the following code:But here I'm not able to get the sponsor id using the following:

2015-05-18 06:42:46Z

I want to get the parameter passed in the validation rule.For certain validation rules that I have created, I'm able to get the parameter from the validation rule, but for few rules it's not getting the parameters.In model I'm using the following code:In ValidatorServiceProvider I'm using the following code:But here I'm not able to get the sponsor id using the following:As a 4th the whole validator is passed to the closure you define with extends. You can use that to get the all data which is validated:By the way I'm using array_get here to avoid any errors if the passed input name doesn't exist.http://laravel.com/docs/5.0/validation#custom-validation-rulesWhy Input::get( $parameters ); then? you should check $parameters contents.Edit. 

Ok I figured out what are you trying to do. You are not going to read anything from input if the value you are trying to get is not being submitted. Take a look to You then will find that is working in places where sponsor_id was submited.

Laravel: How to include file from Vendor folder in Laravel

Growlithe

[Laravel: How to include file from Vendor folder in Laravel](https://stackoverflow.com/questions/21671816/laravel-how-to-include-file-from-vendor-folder-in-laravel)

I am trying to include the YouTube Analytics Service of Google but I can not  access it through the Vendor folder.It is not working, because it defaults to the App folder. How can I get out of the App folder and into the Vendor folder (where the YouTube Analytics file is at)?The error is {

2014-02-10 08:03:06Z

I am trying to include the YouTube Analytics Service of Google but I can not  access it through the Vendor folder.It is not working, because it defaults to the App folder. How can I get out of the App folder and into the Vendor folder (where the YouTube Analytics file is at)?The error is {From where do you want to include that file ?Place a reference to your file in composer.json autoload object:Run composer dumpautoload, and you'll have your file :)Actually you have in the helpers function the path so basically the function base_path give the direction to the root of your project soShould be the route to your vendor folder.You can se all the documentation in

Helper Functions LaravelBe sure that you are seeing the documentation of the laravel version that you are using (I put the link for the 4.2 version).This question was asked a long time ago and the answers reflect that.  Most the time now all you need to do is import it using the "use" statement if you installed it with composer.  Composer will already reference all the important directories.It should be something like this, but it will vary depending on the project.That could include a base class as well as some exception classes.Usually most packages if compliant with modern composer and php standards work in this fashion.

whereBetween Dates in laravel 4 eloquent

Md. Sahadat Hossain

[whereBetween Dates in laravel 4 eloquent](https://stackoverflow.com/questions/26082043/wherebetween-dates-in-laravel-4-eloquent)

I have a query like thatNow how I can convert this query in laravel 4. I use Eloquent

2014-09-28 05:45:09Z

I have a query like thatNow how I can convert this query in laravel 4. I use Eloquentmaybe you can try thisIn your example, you're checking both from_date and to_date for the same range of dates...if this will always be the case, you can make this query a bit more "eloquent":In the SpPrice.php model:Then, to call this method from a controller:You can use whereRaw() to add a raw where clause to the query, for example:Or maybe you can use DB::raw() as first argument of whereBetween(), but I'm not sure if it's possible, in that case you can use orWhere() with a closure to write a more readable code, for example:But I'm not quite sure if this works, give it a try.

Traits with PHP and Laravel

whoacowboy

[Traits with PHP and Laravel](https://stackoverflow.com/questions/30922175/traits-with-php-and-laravel)

I am using Laravel 5.1 and would like to access an array on the Model from the Trait when the Model before the model uses the appends array. I would like to add certain items to the appends array if it exists from my trait. I don't want to edit the model in order to achieve this. Are traits actually usable in this scenario or should I use inheritance?Here is how my current setup works.TraitModelWhat I would like to do is something to achieve the same effect as extending a class. I have a few similar traits, so using inheritance gets somewhat ugly.I have seen some workarounds for this, but none of them seem better/cleaner than just adding the item to the array manually. Any ideas are appreciated.UpdateI discovered this way of accomplishing what I need for one trait, but it only works for one trait and I don't see an advantage of using this over inheritance.traitHow I am currently handling my Model, for what it is worth. model

2015-06-18 17:42:43Z

I am using Laravel 5.1 and would like to access an array on the Model from the Trait when the Model before the model uses the appends array. I would like to add certain items to the appends array if it exists from my trait. I don't want to edit the model in order to achieve this. Are traits actually usable in this scenario or should I use inheritance?Here is how my current setup works.TraitModelWhat I would like to do is something to achieve the same effect as extending a class. I have a few similar traits, so using inheritance gets somewhat ugly.I have seen some workarounds for this, but none of them seem better/cleaner than just adding the item to the array manually. Any ideas are appreciated.UpdateI discovered this way of accomplishing what I need for one trait, but it only works for one trait and I don't see an advantage of using this over inheritance.traitHow I am currently handling my Model, for what it is worth. modelTraits are sometimes described as "compiler-assisted copy-and-paste"; the result of using a Trait can always be written out as a valid class in its own right. There is therefore no notion of parent in a Trait, because once the Trait has been applied, its methods are indistinguishable from those defined in the class itself, or imported from other Traits at the same time.Similarly, as the PHP docs say:As such, they are not very suitable for situations where you want to mix in multiple variants of the same piece of behaviour, because there is no way for base functionality and mixed in functionality to talk to each other in a generic way.In my understanding the problem you're actually trying to solve is this:One approach would be to continue to use Traits, and use Reflection to dynamically discover which methods have been added. However, beware that Reflection has a reputation for being rather slow.To do this, we first implement a constructor with a loop which we can hook into just by naming a method in a particular way. This can be placed into a Trait of its own (alternatively, you could sub-class the Eloquent Model class with your own enhanced version):Then any number of Traits implementing differently named extraConstruct methods:Finally, we mix in all the traits into a plain model, and check the result:We can set the initial content of $appends inside the decorated model itself, and it will replace the BaseModel definition, but not interrupt the other Traits:However, if you over-ride the constructor at the same time as mixing in the AppendingGlue, you do need to do a bit of extra work, as discussed in this previous answer. It's similar to calling parent::__construct in an inheritance situation, but you have to alias the trait's constructor in order to access it:This can be avoided by inheriting from a class which either exists instead of the AppendingGlue trait, or already uses it:Here's a live demo of all of that put together.I thought I'd add an update for 2019 since this was one of the first discussions that popped up when trying to do a similar thing.  I'm using Laravel 5.7 and nowadays Laravel will do the reflection that IMSoP mentioned.After the trait has been booted, Laravel will then call initializeTraitName() on the constructed object (where TraitName is the full name of the trait).To add extra items to $appends from a trait, you could simply do this...KISS:I don't see any reason why you should use trait when your are simply appending attributes. I would only recommend using trait without a constructor like you were doing, only if you model is getting pretty bulky and you wish to slim down things.Please also note this not the correct way of appending attributeYou could do this:Appends attribute names should the snake_case of its method NameEdited: The idea behind appends is to dynamically add fields that doesn't exist in your database table to your model so after you can do like:

Laravel 5 Class admin does not exist

Djordje Vanjek

[Laravel 5 Class admin does not exist](https://stackoverflow.com/questions/29363811/laravel-5-class-admin-does-not-exist)

Having problem with Laravel 5 and this admin class, the thing is that everything worked on localhost and now after I deployed it on server (made ton of fixes but didn't touched this) it doesn't work.The Error is coming out when I go to the page '/moderate' which should be visible just by the admin.Error:AdminController location(App/Http/Controllers/):Routes:

2015-03-31 08:16:37Z

Having problem with Laravel 5 and this admin class, the thing is that everything worked on localhost and now after I deployed it on server (made ton of fixes but didn't touched this) it doesn't work.The Error is coming out when I go to the page '/moderate' which should be visible just by the admin.Error:AdminController location(App/Http/Controllers/):Routes:Fixed!Forgot to sync Kernel.phpAdditional infoapp/Htpp/Kernel.php not console/Kernel.php

Converting a laravel application to lumen

Bill Garrison

[Converting a laravel application to lumen](https://stackoverflow.com/questions/33811475/converting-a-laravel-application-to-lumen)

So, I have been building a laravel 5.1 API and after months of work on it it dawned on me that I should have been using Lumen all along. Is there a way to convert a laravel app to a lumen app?

2015-11-19 18:19:03Z

So, I have been building a laravel 5.1 API and after months of work on it it dawned on me that I should have been using Lumen all along. Is there a way to convert a laravel app to a lumen app?Lumen is essentially a stripped down version of Laravel. The application structure is the same, so as far as that goes it should be safe to create a new Lumen app and copy the app directory from your Laravel app.However, for performance reasons, Lumen does not have all the Laravel goodies working out of the box, and some are not there at all. So depending on how you've implemented you're Laravel app, here's a few things that you might need to change in order to migrate your app:I've probably not covered everything, but this is to offer an idea on what you should be looking out for. All those things can be enabled, but the performance benefits Lumen brings are mostly because those things are disabled to get rid of that overhead, so try to modify your application wherever possible to make use of what Lumen offers by default.Assuming everything you are using is in the Lumen documentation and actually available to Lumen, you should be able to create a new Lumen project and drop your app folder from Laravel into the new Lumen project.

PUT/PATCH request with postman returns status code 0 in Laravel

sesc360

[PUT/PATCH request with postman returns status code 0 in Laravel](https://stackoverflow.com/questions/30775428/put-patch-request-with-postman-returns-status-code-0-in-laravel)

I have written some REST API Methods, including one for updating a DB entry:The Route is defined as:A Request is being handled by:But when I use postman and try to update the existing DB entry and I fill in the owner and street variable to be sent in POSTMAN as requested, I get the message: "Could not get any response. Returns Status Code 0"All the other methods work fine. Is the definition of my routing not correct?Update

When I send the data as x-www-form-urlencodedit works! When I send them as form-data it brings up the error message.

2015-06-11 08:24:51Z

I have written some REST API Methods, including one for updating a DB entry:The Route is defined as:A Request is being handled by:But when I use postman and try to update the existing DB entry and I fill in the owner and street variable to be sent in POSTMAN as requested, I get the message: "Could not get any response. Returns Status Code 0"All the other methods work fine. Is the definition of my routing not correct?Update

When I send the data as x-www-form-urlencodedit works! When I send them as form-data it brings up the error message.It looks like in Postman you should point that the data you send is x-www-url-formurlencoded.In Postman

Returning multiple variables with view::share( ) - Laravel 5.1

senty

[Returning multiple variables with view::share( ) - Laravel 5.1](https://stackoverflow.com/questions/32939485/returning-multiple-variables-with-viewshare-laravel-5-1)

I want to return multiple variable to my view.This code works fine, however how can if I also want to share $needToBePassed, what should I do?Is rewriting it is a good practice?

2015-10-04 23:34:43Z

I want to return multiple variable to my view.This code works fine, however how can if I also want to share $needToBePassed, what should I do?Is rewriting it is a good practice?You can pass an array of data, I know the question is already answered, but maybe I can still help a few people by adding this solution. This way you don't have to change all your views.I was looking for a way to solve this issue without changes all my views.

Laravel /broadcasting/auth Always Fails With 403 Error

user2321275

[Laravel /broadcasting/auth Always Fails With 403 Error](https://stackoverflow.com/questions/41728930/laravel-broadcasting-auth-always-fails-with-403-error)

I have recently delved into Laravel 5.3's Laravel-Echo and Pusher combination. I have successfully set up public channels and moved on to private ones. I am having trouble with Laravel returning a 403 from the /broadcasting/auth route, no matter what I do to try to authorize the action (up to and including using a simple return true statement). Can anyone tell me what I am doing wrong?App/Providers/BroadcastServiceProvider.php:

    

resources/assets/js/booststrap.js:I can see the event and it's payload in my Pusher debug console, it is simply failing once it hits the auth route.

2017-01-18 20:33:07Z

I have recently delved into Laravel 5.3's Laravel-Echo and Pusher combination. I have successfully set up public channels and moved on to private ones. I am having trouble with Laravel returning a 403 from the /broadcasting/auth route, no matter what I do to try to authorize the action (up to and including using a simple return true statement). Can anyone tell me what I am doing wrong?App/Providers/BroadcastServiceProvider.php:

    

resources/assets/js/booststrap.js:I can see the event and it's payload in my Pusher debug console, it is simply failing once it hits the auth route.Error 403 /broadcasting/auth with Laravel version > 5.3 & Pusher, you need change your code in resources/assets/js/bootstrap.js withAnd in app/Providers/BroadcastServiceProvider.php change bywithorit worked for me, and hope it help you.What worked for me was to use the method private of the Laravel Echo package:

https://laravel.com/docs/5.3/notifications#listening-for-notificationsI solve it by creating channel route. Create your Authorizing Channels in routes->channels.phpSee Documentation : https://laravel.com/docs/5.4/broadcasting#authorizing-channelsthanks I paired socket.io with redis and also had a problem with 403 error, even though there weren't any authentication middlewares over /broadcasting/auth route. Only after whatching laracasts lesson I figured out that just channel authorization is not enough, there always should be user and no matter how you authenticate and obtain user, using default laravel auth or some token algorithm - jwt or anything else.Authenticated user is automatically resolved and passed as first parameter to  to closures functions in routes/channels.php file, so you can check channel availability for currently logged in user

Check how you are authorising your channel. Depending on your setup this might help. Update your BroadcastServiceProvider with the following:Adds in the Auth API middleware for use with Laravel Passport.In my case the problem was a wrong user id:This can happen if you are no longer logged in. Make sure you are actually logged into the Laravel app and that your current session hasn't expired.I logged back in and it worked for me.In case, someone comes in the latest Laravel 5.7 with the same issues, the good solution worked for me is to check authentication in each channel before returning or on the return like below.This way it works with any channel broadcasting any event including users.I hope it may help someone else.

How to debug Laravel error 500 with no logs, no information

Gauthier

[How to debug Laravel error 500 with no logs, no information](https://stackoverflow.com/questions/44921945/how-to-debug-laravel-error-500-with-no-logs-no-information)

I'm working on an existing Laravel application in order to develop new feature but after installing the app on my computer, I have an error 500 and no clue to resolve it.In my app.php file I have set : But still I have no information, no logs are generated in storage/logs . I have no idea of what could be the problem.The previous developer was on windows and I'm working on Linux but I'm not sure this is revelant.EDIT:I also have those variable in my config/app.php

2017-07-05 09:17:01Z

I'm working on an existing Laravel application in order to develop new feature but after installing the app on my computer, I have an error 500 and no clue to resolve it.In my app.php file I have set : But still I have no information, no logs are generated in storage/logs . I have no idea of what could be the problem.The previous developer was on windows and I'm working on Linux but I'm not sure this is revelant.EDIT:I also have those variable in my config/app.phpNext to looking into your .env file, make sure permissions are correctly set (and good practice to create the storage/logs folder(s) manually - at least on windows that causes problems).Some PHP exceptions are not possible to catch, so Laravel cant handle them. For example syntax errors, or maximum memory limit errors.Ref.: http://php.net/manual/en/function.set-error-handler.phpI tried to everything to find out the issue like enabling error reporting to report all like :Also i tried to add my custom error handler as well but nothing worked for me. So finally i found the actual issue in php error log file in apache error logs folder (Applications/MAMP/logs as am using Mac).

Debug iconv_strlen error - PHP 5.5

Gravy

[Debug iconv_strlen error - PHP 5.5](https://stackoverflow.com/questions/22492776/debug-iconv-strlen-error-php-5-5)

I am trying to export a document to PDF using Laravel & DomPDF. This works on my mac, but not on staging or live server. Error as follows:I have no idea what this means, and cannot find any solutions.iconv_strlen(): Wrong charset, conversion from8bit//IGNORE' to UCS-4LE' is not allowedI have tried adding the following to .htaccessI have tried adding the following to the top of the view which I am trying to generate the pdf for:If you need any further information to assist me in debugging, please ask in comments.

2014-03-18 22:54:22Z

I am trying to export a document to PDF using Laravel & DomPDF. This works on my mac, but not on staging or live server. Error as follows:I have no idea what this means, and cannot find any solutions.iconv_strlen(): Wrong charset, conversion from8bit//IGNORE' to UCS-4LE' is not allowedI have tried adding the following to .htaccessI have tried adding the following to the top of the view which I am trying to generate the pdf for:If you need any further information to assist me in debugging, please ask in comments.Problem solved. Thanks BrianS. This was solved by re-installing mbstring. BrianS's solution does indeed solve the issue, but I thought it'd be interesting to explain what caused the original problem.In the latest release of dompdf,

the Cpdf class

contains about 30 calls to mb_strlen() with the $encoding parameter set to '8bit', which is a

valid encoding for mb_strlen().Laravel's composer.json

requires patchwork/utf8. It provides the mb_strlen() shim

which calls iconv_strlen().PHP usually uses either glibc or libiconv for its iconv module.

For both libraries, the list of supported encodings can be

displayed using iconv --list.Neither of those libraries support an encoding called '8bit', which is why iconv_strlen()

throws that error:Installing the mbstring PHP module causes mb_strlen() to be executed natively,

so the shim isn't used and the error doesn't occur.@rofavadeka One solution is to create a

fork of the

dompdf repo, and replace every use of

'8bit' encoding with a different 8-bit encoding which is supported by

mb_strlen(), glibc and libiconv.I've written a script to determine which encodings are suitable.

Here's the output of the script for

glibc and

libiconv.

The suitable encodings are:I was getting that error in Hash:make() during seeding my DB for testing.Enabling php_mbstring in php-cli.ini caused it.In Windows the solution is: remove the semicolon before If you are using WHM then you can use EasyApache to rebuild.  Once you get the modules options after selecting your version of PHP select the "Exhaustive Options List" button.  Then ctrl+f "mbstring" and it should come up.  Mark the check box and rebuild.  It should work.If you are on wamp or some custom stack, remember that the php in your wamp may be using a custom php_something.ini for the apache use, due to which even if the wamp GUI is showing that mbstring is on(uncommented) still its quiet possible that that same line is commented out(disabled/off) inside the actual php.ini file (True Story).Solution:-

Just navigate toIn this directory you shall find various .ini files named slightly differently, Mine was using php_uwamp.ini for the stack but for the CLI,  php was using the adjacent file named php.ini.This had me pulling hairs for quiet long, thought it might help someone.

One-to-many then eager load an array with Laravel Eloquent ORM

drew schmaltz

[One-to-many then eager load an array with Laravel Eloquent ORM](https://stackoverflow.com/questions/14288065/one-to-many-then-eager-load-an-array-with-laravel-eloquent-orm)

With Laravel and the eloquent ORM, I want to create an array or object of all posts and corresponding comments that belong to a specific user (the logged in one).  The result will then be used with Response::eloquent(); to return JSON.Basically in pseudo-code:orI have my database setup per the usual with a user's table, comments table and posts table.  The comments table has a post_id and the posts table has a user_id.The long way of doing this without Laravel would be something like:But I want to accomplish it with Laravel's Eloquent ORM.

2013-01-11 23:02:31Z

With Laravel and the eloquent ORM, I want to create an array or object of all posts and corresponding comments that belong to a specific user (the logged in one).  The result will then be used with Response::eloquent(); to return JSON.Basically in pseudo-code:orI have my database setup per the usual with a user's table, comments table and posts table.  The comments table has a post_id and the posts table has a user_id.The long way of doing this without Laravel would be something like:But I want to accomplish it with Laravel's Eloquent ORM.It looks like you don't even need a nested eager load, you just need to modify the query that with returns, so:You can daisy chain most of the methods in the Eloquent system, generally they're just returning a Fluent query object.(I haven't tested it but I'm fairly certain that'll work. Also, you can't do it on ::all() because that calls ->get() for you. You have to dig in the source code to find this, I don't think the Eloquent documentation mentions that's what it's doing.)Also the Eager Loading Documentation covers nested eager loading, so you could load all users, with their posts, with the comments:

Role based permission to Laravel

UselesssCat

[Role based permission to Laravel](https://stackoverflow.com/questions/47821342/role-based-permission-to-laravel)

I am trying to do a role based permission control in a Laravel application. I want to check what actions can some user do, but i can't figure out how to implement gates and policies in my model (the permission description is in the database and are booleans asociated to a table that stores the resource's ids). This is the database model that im using:I would like to know if laravel gates is useful in my case, and how can i implement it, if not, how to make a basic middleware that take care of permission control to protect routes (or controllers).In the table resource i have a uuid that identifies the resources, the alias is the name of the resource and has dot notation values of actions or context of the resource (eg. 'mysystem.users.create', 'mysystem.roles.delete', 'mysystem.users.images.view'). The policy tables has a boolean 'allow' field that describes the permission of users.Thanks in advance.

2017-12-14 20:13:34Z

I am trying to do a role based permission control in a Laravel application. I want to check what actions can some user do, but i can't figure out how to implement gates and policies in my model (the permission description is in the database and are booleans asociated to a table that stores the resource's ids). This is the database model that im using:I would like to know if laravel gates is useful in my case, and how can i implement it, if not, how to make a basic middleware that take care of permission control to protect routes (or controllers).In the table resource i have a uuid that identifies the resources, the alias is the name of the resource and has dot notation values of actions or context of the resource (eg. 'mysystem.users.create', 'mysystem.roles.delete', 'mysystem.users.images.view'). The policy tables has a boolean 'allow' field that describes the permission of users.Thanks in advance.This is the way that I implement role based permissions in Laravel using Policies.Users can have multiple roles.

Roles have associated permissions.

Each permission allows a specific action on a specific model.Roles tablePermissions tablePermission Role Pivot TableRole User Pivot TableUserRolePermissionA policy is required for each model.  Here is an example policy for a model item.  The policy defines the 'rules' for the four actions 'view, create, update, delete.Register each policy in AuthServiceProvider.phpIn each controller, refer to the corresponding authorisation action from the policy.For example, in the index method of ItemController:In your views, you can check if the user has a specific role:or if a specific permission is required:Answer for your Question:how to make a basic middleware that take care of permission control to protect routes (or controllers)?.Just an Example:

Here is the simple role middleware for your routes

AdminRoleAfter defining this middleware

Update your kernel.php file as And to use this route middleware:

There are different way to use route middleware but following is one exampleNote: There are some tools and libraries for roles and permission on laravel but above is the example of creating basic route middle-ware.Because the laravel model did not fit my database so much, I did almost everything again. This is a functional draft in which some functions are missing, the code is not optimized and it may be a bit dirty, but here it is:proyect/app/Components/Contracts/Gate.php This interface is used to create singleton in AuthServiceProvider.proyect/app/Components/Security/Gate.php This file loads the permissions from the database. This could be improved a lot :(proyect/app/Traits/Security/AuthorizesRequests.php This file is added to controller. Allows to use $this->authorize('stuff'); in a controller when is added.proyect/app/Providers/AuthServiceProvider.php This file is the same that can be found on proyect/vendor/laravel/framework/src/Illuminate/Auth/AuthServiceProvider.php, but i changed some parts to add new classe. Here are the important methods:proyect /app/Http/Middleware/AuthorizeRequest.php This file is used to allow add the 'can' middleware to routes, eg: Route::get('users/', 'Security\UserController@index')->name('users.index')->middleware('can:inet.user.list');but you must overwrite the default value in proyect/app/Http/Kernel.php:To use @can('inet.user.list') in a blade template you have to add this lines to proyect/app/Providers/AppServiceProvider.php:User model at proyect/app/Models/Security/User.phpGroup model at proyect/app/Models/Security/Group.php THis is the same than Role, change only namesResource Model proyect/app/Models/Security/Resource.phpThere are a lot of things that I have not put here, but this is what I have so farThe problem i find with trying to combine permissions from a db with policies is when it comes to the ownership of a record.Ultimately in our code we would like to check access to a resource using permission only. This is because as the list of roles grows we don't want to have to keep adding checks for these roles to the codebase.If we have a users table we may want 'admin' (role) to be able to update all user records but a 'basic' user to only be able to update their own user record. We would like to be able to control this access SOLELY using the database.However, if you have an 'update_user' permission then do you give it to both roles?

If you don't give it to the basic user role then the request won't get as far as the policy to check ownership.Hence, you cannot revoke access for a basic user to update their record from the db alone.

Also the meaning of 'update_user' in the permissions table now implies the ability to update ANY user.SOLUTION?Add extra permissions to cater for the case where a user owns the record.So you could have permissions to 'update_user' AND 'update_own_user'.The 'admin' user would have the first permission whilst the 'basic' user would have the second one.Then in the policy we check for the  'update_user' permission first and if it's not present we check for the 'update_own_user'.If the 'update_own_user' permission is present then we check ownership. Otherwise we return false.The solution will work but it seems ugly to have to have manage 'own' permissions in the db.

Retrieving GET and POST data inside controller in Laravel 4

Jan

[Retrieving GET and POST data inside controller in Laravel 4](https://stackoverflow.com/questions/18761555/retrieving-get-and-post-data-inside-controller-in-laravel-4)

I've been searching the web for how to get POST data inside the controller, so far I have found two solutions: Input::get() and $_POST.The comment for Input::get() reads:What is this "named" source they refer to? What is it I should use instead of Input::get() ?

2013-09-12 10:18:42Z

I've been searching the web for how to get POST data inside the controller, so far I have found two solutions: Input::get() and $_POST.The comment for Input::get() reads:What is this "named" source they refer to? What is it I should use instead of Input::get() ?The documentation shows you can retrieve an input value for any HTTP verb by using  Input::get().TO get all the inputs use Input::all() method.

To check if specific column exists use Input::has('column_name') eg.Input::has('name').

To retrieve column value use Input::get('column_name') eg. Input::get('name').You can get a parameter from url using :-if you want to get GET parameter using :-if you want to get POST parameter using :-

How to Migrate and seed before the full test suite in Laravel with in memory database?

Franklin Rivero

[How to Migrate and seed before the full test suite in Laravel with in memory database?](https://stackoverflow.com/questions/38573830/how-to-migrate-and-seed-before-the-full-test-suite-in-laravel-with-in-memory-dat)

I'm trying to set up the test environment in my Laravel project.

I'm using http://packalyst.com/packages/package/mayconbordin/l5-fixtures with json for the seeding with a sqlite in memory database and calling:in my setUp function but this is executed before every single test which it can grow to thousands in this project.I tried the setUpBeforeClass but it didn't work. 

I think there because the createApplication method is called in every test and that reset the whole application and also wasn't loading the fixtures from the json probably for the same reason.

2016-07-25 17:16:23Z

I'm trying to set up the test environment in my Laravel project.

I'm using http://packalyst.com/packages/package/mayconbordin/l5-fixtures with json for the seeding with a sqlite in memory database and calling:in my setUp function but this is executed before every single test which it can grow to thousands in this project.I tried the setUpBeforeClass but it didn't work. 

I think there because the createApplication method is called in every test and that reset the whole application and also wasn't loading the fixtures from the json probably for the same reason.This is how I did it in case someone else is struggling with the same, I created a base testClase class that inherits from Laravel's and did this:I overwrote the createApplication() and tearDown() methods. I changed the first one to use the same $app configuration and remove the part of the teardown() where it flush $this->app.Every other of my test has to inherit from this TestClass and that's it.Everything else didn't work. This works even with in memory database, it's 100s times faster. if you are dealing with user session, once you log the user in you will have to log him out in tear down, otherwise the user will be logged in because the app environment is never reconstructed or you can dd something like this to refresh the application every time you want:And add this to the tearDown() before the $this->setUphasRun = false;:The main approach in the above solutions is to run all migrations for all tests. I prefer an approach to specify which migrations and seeds should run for each test. It may be more worthwhile on big projects as this can reduce timings for tests by about 70% (using the sqlite in-memory DB as already explained above). For small projects, it's maybe a bit too much faffing about. But anyway...Use these in TestCase:Then call migrate() and seed as required in individual tests, eg:create file in your project testrunner with this content (also prepare  .env.testing file with testing environment variables) :And give permission to execute by command chmod +x testrunner and execute it by ./testrunner. Thats all :)How about setting up the database using a migration and seeds and then using database transcations? (https://laravel.com/docs/5.1/testing#resetting-the-database-after-each-test)I wanted to be able to set up my test database via artisan like this:As you can guess, I'm using mysql, but I don't see why this shouldn't work for sqlite.

This is how I do it.config/database.phpFirst add the test database info to your config/database.php file, under your current database info.If you do it like this, don't forget to add DB_TEST_DATABASE to your  .env file:phpunit.xmlAny values set in the phpunit.xml file, under  overwrite values given in the .env file. So we tell phpunit to use the "mysql_testing" database connection instead of the "mysql" database connection.Test classMy test classes look like this:Here the database is reset before every test, which is why I prefer Option 1. But you might be able to get it to work the way you like.I tried this once before, and it might work for you.tests/TestCase.php

Extend the test case, to load a new .env file, .env.testing.env.testingCreate this new .env file and add in the database detailsIn the test class:Use PDO to drop and recreate the database - easier than trying to truncate everything.

Then use artisan to migrate and seed the database.

Object of class Carbon\Carbon could not be converted to int

Patrick

[Object of class Carbon\Carbon could not be converted to int](https://stackoverflow.com/questions/41454800/object-of-class-carbon-carbon-could-not-be-converted-to-int)

I have already search for this, and i did find some topics discussing this problem, however none of which I felt like was the way I want to go, so therefore I hope to get a better sugestion here.I want to get a timestamp from when a user was last updated.If i run this, it gives me this errorThis is because it returns a Carbon instance in Laravel 5.2, and I only need the timestamp.How do i fetch the "date" from the carbon instance, so I only get 2017-01-04 00:35:38 - I have no idea where .000000 comes from, as this doesn't show up in the database. In the MySQL database, it simply shows 2016-07-20 20:23:07 as of type timestamp.Hope for some pointers and suggestions

2017-01-04 01:18:00Z

I have already search for this, and i did find some topics discussing this problem, however none of which I felt like was the way I want to go, so therefore I hope to get a better sugestion here.I want to get a timestamp from when a user was last updated.If i run this, it gives me this errorThis is because it returns a Carbon instance in Laravel 5.2, and I only need the timestamp.How do i fetch the "date" from the carbon instance, so I only get 2017-01-04 00:35:38 - I have no idea where .000000 comes from, as this doesn't show up in the database. In the MySQL database, it simply shows 2016-07-20 20:23:07 as of type timestamp.Hope for some pointers and suggestionsThe Carbon object has a toDateTimeString method you can use:It will give you the value 2017-01-04 00:35:38 as a string.While using Carbon library to perform multiple action using date.Example :Right now what you are doing.Suggest : 

Laravel 5 not getting any error logs

SamXronn

[Laravel 5 not getting any error logs](https://stackoverflow.com/questions/36113032/laravel-5-not-getting-any-error-logs)

I installed Laravel 5 on a new VPS, I was running everything fine but I noticed I wasn't getting any Laravel errors the system would only fire a server 500 error at me which is no help when debugging my code. When I looked in the laravel storage/log it was empty which was strange because I had set the correct file permissions of 777. So how do I get laravel logs? Why aren't they being written to my storage/log file.

2016-03-20 11:16:52Z

I installed Laravel 5 on a new VPS, I was running everything fine but I noticed I wasn't getting any Laravel errors the system would only fire a server 500 error at me which is no help when debugging my code. When I looked in the laravel storage/log it was empty which was strange because I had set the correct file permissions of 777. So how do I get laravel logs? Why aren't they being written to my storage/log file.If you've set your file permissions correctly on the /storage file directory and you're running on a VPS no shared hosting you might want to check your apache log, inside var/log/apache2/error.logHere you might just see a line that read something along the lines of /var/www/html/storage/logs/laravel.log" could not be opened: failed to open stream: Permission deniedWell this is strange because you have the correct file permissions... Let's start by SSH'ing into your VPS head to the directory where laravel is installed normally cd /var/www/htmlIn here if you run ls -l You should get some results similar to this image below:

Notice how we've been accessing the site as the root user, this is our problem and we can confirm this by running ps aux | grep apache2You can see here apache2 is running as the user www-data, which is normal for apache. Which means when our laravel installation trys to move files either using ->move() or just trying to write the log file it fails as the www-data user doesn't have permission. So you can change to this www-data user by running: chown -R www-data:www-data * (shorthand for same user/group chown -R www-data. *)Now if you run ls -l in your www/html directory you should see root user changed to www-data:This means were now editing the files as the www-data user which has permission, so any changes you make via SFTP should reflect this user change. Fixed! Edit - This is the first time I answered my own question hopefully it's okay.

Laravel 5.1 hasManyThrough relationships and pivot table

V4n1ll4

[Laravel 5.1 hasManyThrough relationships and pivot table](https://stackoverflow.com/questions/36596068/laravel-5-1-hasmanythrough-relationships-and-pivot-table)

I have the following models / tables setup in my application;timesheetusersupervisor_userUsers get "assigned" to supervisors via the supervisor_user pivot table.I have the following relationship setup on the User model, which gets supervisor users.I want to setup another relationship which gets a list of timesheets "assigned" to a supervisor.  I'm guessing with hasManyThrough relationship...but not exactly how to write the code for it.How can I achieve what I need?

2016-04-13 10:47:48Z

I have the following models / tables setup in my application;timesheetusersupervisor_userUsers get "assigned" to supervisors via the supervisor_user pivot table.I have the following relationship setup on the User model, which gets supervisor users.I want to setup another relationship which gets a list of timesheets "assigned" to a supervisor.  I'm guessing with hasManyThrough relationship...but not exactly how to write the code for it.How can I achieve what I need?In your Role model make a method:In your User model make a method:And then make a call:Yes, you are right you can achieve timesheets for supervisor using two methods. Either use join query, that is joining multiple tables and finding the timesheets or  using hasManyThrough. The Easy way:  because you have user_id in supervisor table and I assume that is the user that belongs to the given supervisor.  We can simply compare supervisor_users.user_id with timesheets.user_id. This should do the trick. If you need to add where or select clause then add before get() thing.The faster way :

If you check the laravel documentation, for hasmanythrough, you would probably have a case where its one to many and again one to many. So like: country has many users and users have many posts. In this if we do hasmanythrough we can pull posts that belongs to country. And for you what I see is, A single supervisor has many users and a user has many timesheet. Please correct me here if I am wrong my solution is based on that,  so I will help u get timesheets for a given supervisor. Inshort all the timesheets that belong to a user which is again belonged to a given supervisor. You will have all the timesheets for all the users for a given supervisor. Here argument one is the final table from which you want data to be. And argument two is your intermediate table we passing through. You can add third and fourth argument if you like for Id's.

Now simply try :

    $supervisor_timesheet = $Supervisor_user->timesheets

Clarify how to setup a one-to-many relationship in Laravel's Eloquent ORM

eimajenthat

[Clarify how to setup a one-to-many relationship in Laravel's Eloquent ORM](https://stackoverflow.com/questions/16869249/clarify-how-to-setup-a-one-to-many-relationship-in-laravels-eloquent-orm)

Okay, I'm working through the Laravel 4 docs to setup a one-to-many relationship between two models.  Obviously, one side should use hasMany().  But for the other side, should I use hasOne or belongsTo?  Does it matter?  What's difference?  Why do both exist?I had thought hasOne would be for one-to-one relationships, and belongsTo would be for the one side of one-to-many.  But in the docs, for inserting a related model here:http://laravel.com/docs/eloquent#inserting-related-modelsthey are using save() which seems to only be present in hasOne and hasMany relationships, not in belongsTo.  It looks like belongsTo uses associate() for the same purpose:https://github.com/laravel/framework/blob/master/src/Illuminate/Database/Eloquent/Relations/BelongsTo.php#L188Maybe I just need some general background on when to use belongsTo vs. hasOne, and why belongsTo uses associate() while hasOne uses save().EDIT: I guess my point of confusion was that in the docs (http://laravel.com/docs/eloquent#inserting-related-models), they used:where I would have used:Is there an advantage to one way or the other?  Or is it just a question of what makes sense in the context?

2013-06-01 04:58:32Z

Okay, I'm working through the Laravel 4 docs to setup a one-to-many relationship between two models.  Obviously, one side should use hasMany().  But for the other side, should I use hasOne or belongsTo?  Does it matter?  What's difference?  Why do both exist?I had thought hasOne would be for one-to-one relationships, and belongsTo would be for the one side of one-to-many.  But in the docs, for inserting a related model here:http://laravel.com/docs/eloquent#inserting-related-modelsthey are using save() which seems to only be present in hasOne and hasMany relationships, not in belongsTo.  It looks like belongsTo uses associate() for the same purpose:https://github.com/laravel/framework/blob/master/src/Illuminate/Database/Eloquent/Relations/BelongsTo.php#L188Maybe I just need some general background on when to use belongsTo vs. hasOne, and why belongsTo uses associate() while hasOne uses save().EDIT: I guess my point of confusion was that in the docs (http://laravel.com/docs/eloquent#inserting-related-models), they used:where I would have used:Is there an advantage to one way or the other?  Or is it just a question of what makes sense in the context?Please refer to the laravel docs on the one to many relationship between posts and comments http://laravel.com/docs/eloquent#relationships. (Where one post has many comments and a comment belongs to a post).The tables for posts and comments be as followsPosts Table

id | title | bodyComments Table

id | comment | post_idThe database table that contains a foreign key belongs to a record in the other table, therefore, in the comments model you must specify that comments belongs to posts. You are correct that the hasOne relationship only applies to one to one relationships.Here is a blog post with laravel 3 code which gives an explanation into how eloquent relationship methods work.http://laravel.io/topic/14/how-eloquent-relationship-methods-work

Passing cookies from browser to Guzzle 6 client

Thelonias

[Passing cookies from browser to Guzzle 6 client](https://stackoverflow.com/questions/31882080/passing-cookies-from-browser-to-guzzle-6-client)

I have a PHP webapp that makes requests to another PHP API. I use Guzzle to make the http requests, passing the $_COOKIES array to $options['cookies']. I do this because the API uses the same Laravel session as the frontend application. I recently upgraded to Guzzle 6 and I can no longer pass $_COOKIES to the $options['cookies'] (I get an error about needing to assign a CookieJar). My question is, how can I hand off whatever cookies I have present in the browser to my Guzzle 6 client instance so that they are included in the request to my API?

2015-08-07 16:01:02Z

I have a PHP webapp that makes requests to another PHP API. I use Guzzle to make the http requests, passing the $_COOKIES array to $options['cookies']. I do this because the API uses the same Laravel session as the frontend application. I recently upgraded to Guzzle 6 and I can no longer pass $_COOKIES to the $options['cookies'] (I get an error about needing to assign a CookieJar). My question is, how can I hand off whatever cookies I have present in the browser to my Guzzle 6 client instance so that they are included in the request to my API?Try something like:and here's how to get them out again:I think you can simplify this now with CookieJar::fromArray:

What is the real difference between Laravel's session() and request()->session()?

Oluwatobi Samuel Omisakin

[What is the real difference between Laravel's session() and request()->session()?](https://stackoverflow.com/questions/45059458/what-is-the-real-difference-between-laravels-session-and-request-session)

I am working on a Laravel(5.2) project that heavily relies on session, quite new though but I was just curious what difference global session() and Http request()->session() has apart from the fact that they have different means of accessing and writing into session?Here are the few information I have about this from laravel 5.4 doc,Unfortunately, this does not really make me understand the difference. I have as well googled and stackoverflowed perhaps I could find an answer to no avail. Example is laravel difference of session::flash and request->session->flash but I am not so comfortable with the answerWhat is the real difference they have in managing session data? I wouldn't mind a reference to a documentation where this is or even if I have to dig into laravel core.Thanks

2017-07-12 13:44:31Z

I am working on a Laravel(5.2) project that heavily relies on session, quite new though but I was just curious what difference global session() and Http request()->session() has apart from the fact that they have different means of accessing and writing into session?Here are the few information I have about this from laravel 5.4 doc,Unfortunately, this does not really make me understand the difference. I have as well googled and stackoverflowed perhaps I could find an answer to no avail. Example is laravel difference of session::flash and request->session->flash but I am not so comfortable with the answerWhat is the real difference they have in managing session data? I wouldn't mind a reference to a documentation where this is or even if I have to dig into laravel core.Thankssession() is a helper that gives you a faster access to request()->session()Note that request() is also a helper that gives you a faster access to the request object.There are no differences, it's just a shortcut.i think this would help you:

$request->session() and session() both are same thing.There are two primary ways of working with session data in Laravel: the global function in session() helper and via a $request instance.you can use it like thisUnfortunately the best answer has already been given by the Laravel note; and I can only attest to that for now cos I have noticed such situation once. I couldn't understand why global session('key') refuse to echo the value of $request->session()->put('key', 'value') within the same method. Hopefully I'd come across the situation again just for proof but the last response I'd want to give you is: "There are no differences, it's just a shortcut." Cos just like the docs mentioned, there's difference notable in practice

how to detach one instance from multiple in a laravel | Eloquent pivot table?

KernelCurry

[how to detach one instance from multiple in a laravel | Eloquent pivot table?](https://stackoverflow.com/questions/21149164/how-to-detach-one-instance-from-multiple-in-a-laravel-eloquent-pivot-table)

Pivot Table: 'bonus_circle' has the ability to have multiple items with the same circle_id and bonus_id. In other words There can be multiple of the same bonuses associated with the same circle.  Using $circle->bonuses()->detach($id) removes ALL of the instances.  I need it to only detach ONE instance. Does anyone know a work around for this?

2014-01-15 22:01:20Z

Pivot Table: 'bonus_circle' has the ability to have multiple items with the same circle_id and bonus_id. In other words There can be multiple of the same bonuses associated with the same circle.  Using $circle->bonuses()->detach($id) removes ALL of the instances.  I need it to only detach ONE instance. Does anyone know a work around for this?I searched for over a week for the answer to this. I can't use your code as an example because there's not quite enough there for me to go on, but I'll use my code to show you the answer I received from Kindari (thank you) in Laravel IRC chat.I have users, roles, and accounts. A user can have one role on one or more accounts. My role_user_account table has role_id, user_id, account_id. I needed to remove a user's role where account_id = x But I found that detach() was removing ALL account roles for the user.What didn't work:What does work:Raw Query works for now, but if anyone can answer this i would appreciate it.I had the same problem. Got around it using this.

@extends('layout') laravel. Blade Template System seems like Not working

Luillyfe

[@extends('layout') laravel. Blade Template System seems like Not working](https://stackoverflow.com/questions/21458885/extendslayout-laravel-blade-template-system-seems-like-not-working)

I tried to use the laravel's template system: blade but seems like not working when using the code below in the file users.blade.php:and browser,

2014-01-30 14:16:45Z

I tried to use the laravel's template system: blade but seems like not working when using the code below in the file users.blade.php:and browser,That should work if you have a template file at /app/views/layout.blade.php that containsThen in your /app/views/user.blade.php, the contentIf you call return View::make('user') you should have the compiled contentI hope that helps clarify things for you. If not, can you provide your template file locations and the relevant content?Just remove the extra space or anything before @extends('yourlayoutfile').It should be the first thing to be rendered in the file.I was facing the same problem and tried many things.Suddenly I found a single space at the starting of the file before @extends.Removed the space and is working fine.Thanks.Format:---Edit----If this didnt work then try :Copy all the content in the file and then delete the file.Create a new file and save it as filename.blade.phpOnly after saving the file paste the content into the page.

Save the changes and run it.This works.Thank you.Where is your layout?If its in app/views/layouts, then it should be(assuming the name is index.blade.php)ex: @extends('layouts.foo') equals a file in app/views/layouts/ called either foo.blade.php or foo.php. (depending if you use blade)I have the same problem. What is did is:

1. in routes.php that

AboutController is a controller file AboutController.php in app/controllers

index is a function inside that controller.2.Create AboutController.php in app/controllersYou can look at this reference: Defining A Layout On A ControllerBy default,Laravel has a layouts folder inside views folder, i.e. app/views/layouts and in this folder you keep your layout files, i.e. app/views/layouts/index.master.php and if you have something similar then you should use something like this:This will inherit/use the master.blade.php file (as layout) from layouts folder, here, layouts.master means layouts/master.blade.php.In your master.blade.php file you mast have thisSo, data/content from the view between @section('content') and @stop will be dumped in the place of @yield('content') of your layout.You can use any name for your layout file, if it's layouts/main.blade.php then you should uselet's say you have 'master.blade.php' and 'index.blade.php'. 

and both of files are in views->home directory. when you want to use @extends in 'index.blade.php' by calling 'master.blad.php' , you should write in index.blade.php file this statment:notSimply save your source using encoding UTF-8 without signature.

Laravel 5: allow user to edit post if he's the owner of the post or the owner of the forum category

Halnex

[Laravel 5: allow user to edit post if he's the owner of the post or the owner of the forum category](https://stackoverflow.com/questions/32951025/laravel-5-allow-user-to-edit-post-if-hes-the-owner-of-the-post-or-the-owner-of)

So far I was able to allow the user to edit his own posts but whenever I through the if he's owner of the subreddit/category condition, it stops working altogether.I have these 3 tableThis is the edit() method in PostsController.phpAnd this is the viewThis works fine, it only checks if the logged in user_id is the same as the posts's user_id and updating goes through.But if I added if(Auth::id() == $subreddit->user_id) it stops working. It displays the "Edit" link on the view on all the posts but clicking on any of them gives me the validation error You cannot do that even for posts that I own.So how can I check if the users is the owner of the article OR the owner of the category to display and allow EDIT?Updated method with $subreddit->user_idViewThis will allow me to edit my own posts but will still give me the validation error You cannot do that on posts in my own forum category/subreddit.This is the Gate policies that I've tried but it also didn't workPostsController.phpViewWith the above code, I am finally able to edit posts if 'update-post' is true but I cannot check if mod-update-post is also true, I keep receiving the validation error You cannot do thisdd($subreddit) inside edit() method shows an empty array. https://cryptbin.com/x6V6wX#26810f755a62f6c8837c0c0fe0371dcfEDIT: I think I've solved it. I used $post->subreddit->user->id instead of $subreddit->user_id because that was returning null. And now it all seems to work based on if posts belongs to user or user is forum owner.But the edit link on the view still shows whether or not I have access. I am unable to double check for update-post and mod-update-post simultaneously. and using @can('update-post', $post) only works once, I cannot double check that.

2015-10-05 14:26:57Z

So far I was able to allow the user to edit his own posts but whenever I through the if he's owner of the subreddit/category condition, it stops working altogether.I have these 3 tableThis is the edit() method in PostsController.phpAnd this is the viewThis works fine, it only checks if the logged in user_id is the same as the posts's user_id and updating goes through.But if I added if(Auth::id() == $subreddit->user_id) it stops working. It displays the "Edit" link on the view on all the posts but clicking on any of them gives me the validation error You cannot do that even for posts that I own.So how can I check if the users is the owner of the article OR the owner of the category to display and allow EDIT?Updated method with $subreddit->user_idViewThis will allow me to edit my own posts but will still give me the validation error You cannot do that on posts in my own forum category/subreddit.This is the Gate policies that I've tried but it also didn't workPostsController.phpViewWith the above code, I am finally able to edit posts if 'update-post' is true but I cannot check if mod-update-post is also true, I keep receiving the validation error You cannot do thisdd($subreddit) inside edit() method shows an empty array. https://cryptbin.com/x6V6wX#26810f755a62f6c8837c0c0fe0371dcfEDIT: I think I've solved it. I used $post->subreddit->user->id instead of $subreddit->user_id because that was returning null. And now it all seems to work based on if posts belongs to user or user is forum owner.But the edit link on the view still shows whether or not I have access. I am unable to double check for update-post and mod-update-post simultaneously. and using @can('update-post', $post) only works once, I cannot double check that.Use Laravel’s new authorization component.EDIT: I think you’re misunderstanding how authorization should be used. It should be used to check if the current user can perform an action (or not). Therefore, you don’t want to be defining multiple methods for different users types.Take editing a post for example. There’s the name of your authorization check: @can('edit', $post). You don’t need to define a different one for regular users, and another for moderators. Just add the logic to your edit post method:As you can see, I’m doing the different checks in the same method, so in your Blade template you can just do this:Hope this clears things up.Alternative technique (maybe a little bit simpler) is described here:https://laracasts.com/discuss/channels/laravel/dont-allow-user-to-change-others-postsSo the idea is to implement a subclass of Request, where you can implement validation rules, and where you can also implement an 'authorize' method.

How to call a trait method with alias

Jammer

[How to call a trait method with alias](https://stackoverflow.com/questions/34363431/how-to-call-a-trait-method-with-alias)

I'm trying to place a trait inside a class called Page. I also need to rename a trait function so that it doesn't clash with an existing class function. I thought I did all this successfully however I get an error that points to the wrong location?!Call to undefined function App\Pages\Models\myTraitDefaultScope()I've also tried: MyTrait\defaultScope($query) instead of trying to rename the conflicting function. But I then get the following error:Call to undefined function App\MyTrait\defaultScope()Below is the trait and class contained in separate files..I'm not all that awesome at this so please don't shoot if I've got something badly wrong :)  

2015-12-18 20:26:29Z

I'm trying to place a trait inside a class called Page. I also need to rename a trait function so that it doesn't clash with an existing class function. I thought I did all this successfully however I get an error that points to the wrong location?!Call to undefined function App\Pages\Models\myTraitDefaultScope()I've also tried: MyTrait\defaultScope($query) instead of trying to rename the conflicting function. But I then get the following error:Call to undefined function App\MyTrait\defaultScope()Below is the trait and class contained in separate files..I'm not all that awesome at this so please don't shoot if I've got something badly wrong :)  When you 'use' a trait in your class, the class inherits all the methods and properties of the trait, like if it was extending an abstract class or an interfaceSo, this method of MyTrait:will be inherited by your Page class As you have aliased this method as: myTraitDefaultScope, to call the method you should call it in the same way you would call every other method of the  Page class:As you're using trait. So it points to the current or parent class. Thus, calling any method should be like $this->method($params); syntax. 

Laravel 5.4 OAuth with Dingo internal requests

Squiggs.

[Laravel 5.4 OAuth with Dingo internal requests](https://stackoverflow.com/questions/47383367/laravel-5-4-oauth-with-dingo-internal-requests)

I am using Laravel 5.4 with Dingo API, and I'm trying to get Laravel's OAuth 2.0 (Passport) to work with Internal Dingo requests. Previously, I was using JWT, but now I wish to use OAuth. This is my previous dispatcher code which passes along the required token to perform the authentication on an internal request.Now that I'm using OAuth to authenticate, my JavaScript code manages to get authentication simply by passing a cookie using this method in the JavaScript, which works perfectly.Now I need to modify the getDispatcher() method to get the OAuth token on an "internal request" within Dingo. Does anyone have any tips on how to do this? In theory I could create a personal access token for every user but this seems like overkill just for an internal request. Any advice or approaches appreciated.  How can I get the OAuth token without going through the complete OAuth flow, or alternatively, how can I turn off authentication just for internal requests.Update based on answer below:'api.auth' on its own on the route (just Dingo) and the internal request works. auth:api (Passport) + api.auth and I get the method not allowed on internal requests this comes back as JSON. {"message":"405 Method Not Allowed"} now when trying to call an internal POST request. (It looks like a 301 redirect to the login page occurs when trying to POST to these routes, and in turn causes the API path to turn into a GET somehow thus throwing the 405 error).API requests via Postman work in the inverse capacity. Can't find a user when both active (['middleware' => ['auth:api','api.auth'])  when (auth:api just Passport) active it works fine. 

2017-11-20 00:01:43Z

I am using Laravel 5.4 with Dingo API, and I'm trying to get Laravel's OAuth 2.0 (Passport) to work with Internal Dingo requests. Previously, I was using JWT, but now I wish to use OAuth. This is my previous dispatcher code which passes along the required token to perform the authentication on an internal request.Now that I'm using OAuth to authenticate, my JavaScript code manages to get authentication simply by passing a cookie using this method in the JavaScript, which works perfectly.Now I need to modify the getDispatcher() method to get the OAuth token on an "internal request" within Dingo. Does anyone have any tips on how to do this? In theory I could create a personal access token for every user but this seems like overkill just for an internal request. Any advice or approaches appreciated.  How can I get the OAuth token without going through the complete OAuth flow, or alternatively, how can I turn off authentication just for internal requests.Update based on answer below:'api.auth' on its own on the route (just Dingo) and the internal request works. auth:api (Passport) + api.auth and I get the method not allowed on internal requests this comes back as JSON. {"message":"405 Method Not Allowed"} now when trying to call an internal POST request. (It looks like a 301 redirect to the login page occurs when trying to POST to these routes, and in turn causes the API path to turn into a GET somehow thus throwing the 405 error).API requests via Postman work in the inverse capacity. Can't find a user when both active (['middleware' => ['auth:api','api.auth'])  when (auth:api just Passport) active it works fine. If I read the question correctly, it looks like we're trying to use two authentication providers—Dingo's and Passport—at the same time. Correct me if I misunderstand, but it doesn't seem like we actually need to use both in this project. For most applications, we can perform authentication using Passport, and simply pass the result to Dingo. We achieve this by creating a custom authentication provider that bridges Dingo with the authentication performed by Passport: As we can see, the Dingo auth provider shown above just hooks into the Laravel auth system to forward the User when authenticated. The 'api' guard specified in the constructor should match the guard configured for Passport (we usually add an 'api' entry to the 'guards' array in config/auth.php):Then, we need to register the custom provider with Dingo in config/api.php:Now we can declare protected routes that use both the Passport auth middleware (auth:api) and the Dingo auth middleware (api.auth): We can create a middleware group in app/Http/Kernel.php that combines these if desired: By the time the application needs to call the internal API, the client should already be authenticated because typical Laravel applications handle authentication in the middleware stack. As you know, we can simply pass on the authenticated User to a Dingo endpoint if needed:...but this shouldn't be necessary with the auth provider shown above. Dingo will resolve the authenticated user from Passport's auth guard.Here's a sample project that combines these concepts.When we use the CreateFreshApiToken middleware, Laravel generates an encrypted JWT on-the-fly. We can create one of these tokens manually:We can see this isn't a standard OAuth access token—Passport only uses these for web requests. Alternatively, we can fetch this value from the cookie passed back from JavaScript: However, we shouldn't need this token if we integrate Dingo with Passport as described above.

Laravel Multi Insert issue with quotes in value

Awais Qarni

[Laravel Multi Insert issue with quotes in value](https://stackoverflow.com/questions/39634178/laravel-multi-insert-issue-with-quotes-in-value)

I need to insert a large set of records in to a database table. I am getting the data from a CSV file. I thought about using a multi-insert statement for good performance. So I did something similar to the following:But in doing so I always see the error:I have debugged it by printing the query and I observed that by doing so, Laravel doesn't take care of single quotes or double quotes in the description value, as it automatically does while usiung $model::save();. The printed query version breaks if the description value has single quotes ' or double quotes " in it. But if I do some thing likeIt runs successfully without generating any error. Can anybody let me know how to correct this problem?

2016-09-22 08:40:13Z

I need to insert a large set of records in to a database table. I am getting the data from a CSV file. I thought about using a multi-insert statement for good performance. So I did something similar to the following:But in doing so I always see the error:I have debugged it by printing the query and I observed that by doing so, Laravel doesn't take care of single quotes or double quotes in the description value, as it automatically does while usiung $model::save();. The printed query version breaks if the description value has single quotes ' or double quotes " in it. But if I do some thing likeIt runs successfully without generating any error. Can anybody let me know how to correct this problem?Its due to large set of data nothing wrong with quotes problem. When you are trying to insert all rows at once using multi-insert, the dataset becomes too heavy. Either you need to increase the max_allowed_packet or you need to do in chunks. 

You can use chunk for that.

suppose you want to insert 100 elements at a time. you can do something like that.Hope this will help :)How much records are your trying to bulk insert? 

Can you try with just two? 

Can you try to make severals bulk inserts (like 100 by 100).Usually, the error Mysql has gone away means that the database server killed the query because it was waiting for too much data (your query is too big).You can usually set a higher value to max_allowed_packet var in my.conf to allow you to send more data at once.

Laravel echo server not working in production server

z0mbieKale

[Laravel echo server not working in production server](https://stackoverflow.com/questions/51944819/laravel-echo-server-not-working-in-production-server)

I am having problem with socket.io as a broadcaster with laravel echo.What have I tried:I can see users connecting within the logs:My queue is running and is logging all the events properly.I can see redis my events and database notifications perfectly in the redis console.But no events are broadcasted and I am not seeing them in the laravel-echo-server console. Everything is working in my localhost, but not in the production and I losing my mind.Here's my laravel echo JS:On my user model I have defined this:And in my channels I have this:This is my echo server config where all the paths are correct. I tested the same file on my localhost and everything is working:My redis log shows this when published a database notificationThis is my notification

2018-08-21 08:42:06Z

I am having problem with socket.io as a broadcaster with laravel echo.What have I tried:I can see users connecting within the logs:My queue is running and is logging all the events properly.I can see redis my events and database notifications perfectly in the redis console.But no events are broadcasted and I am not seeing them in the laravel-echo-server console. Everything is working in my localhost, but not in the production and I losing my mind.Here's my laravel echo JS:On my user model I have defined this:And in my channels I have this:This is my echo server config where all the paths are correct. I tested the same file on my localhost and everything is working:My redis log shows this when published a database notificationThis is my notificationAs I see you use 'https' protocol in prodaction server, so you need to define 'sslCertPath' and 'sslKeyPath':From docsRunning with SSLIf you are seeing users joining the channels, then it is most likely set up correctly. You just need to broadcast a notification for your console.log(notification) call to work, since you are specifically calling the notification function on the user channel. See https://laravel.com/docs/5.6/broadcasting#notifications for more details.Broadcast with notification:Then when you are ready to broadcast your message, just notify the user:Edit:Also, make sure you have the Notifiable trait in your user model:

Laravel 5 Call to undefined method Illuminate\Database\Query\Builder::method()

Liam

[Laravel 5 Call to undefined method Illuminate\Database\Query\Builder::method()](https://stackoverflow.com/questions/30325169/laravel-5-call-to-undefined-method-illuminate-database-query-buildermethod)

I have projects which hasMany users, and users belongsTo a project.I want to count the total amount of users a project has so I need to link them.This way I'm getting a Call to undefined method Illuminate\Database\Query\Builder::user() error. What am I doing wrong?Controller:}Model user:Model project:HTML/Blade:

2015-05-19 12:06:14Z

I have projects which hasMany users, and users belongsTo a project.I want to count the total amount of users a project has so I need to link them.This way I'm getting a Call to undefined method Illuminate\Database\Query\Builder::user() error. What am I doing wrong?Controller:}Model user:Model project:HTML/Blade:You have to provide the method name that defines the relationship.I mean users not user

Upgrading Laravel 5.0 to Laravel 5.1 Commands to Jobs

user391986

[Upgrading Laravel 5.0 to Laravel 5.1 Commands to Jobs](https://stackoverflow.com/questions/30767884/upgrading-laravel-5-0-to-laravel-5-1-commands-to-jobs)

Laravel 5.1 is renaming Commands to Jobs and Events to Listeners.

http://laravel.com/docs/5.1/releases#laravel-5.1I was using Commands and Command Handlers in Laravel 5.0 like so.app\Commands\MyCommandapp\Handlers\Commands\MyCommandI don't see how I'm supposed to implement the handler in Laravel 5.1? 

2015-06-10 21:47:13Z

Laravel 5.1 is renaming Commands to Jobs and Events to Listeners.

http://laravel.com/docs/5.1/releases#laravel-5.1I was using Commands and Command Handlers in Laravel 5.0 like so.app\Commands\MyCommandapp\Handlers\Commands\MyCommandI don't see how I'm supposed to implement the handler in Laravel 5.1? From the 5.1 release notes:In case you want to upgrade, you just have to rename your folder and change the namespace (Laravel uses PSR-4 autoloader in version 5, so the folder structure corresponds to the namespace of your files). However if your project is quite large I do not recommend you that, since as the documentation states this is not required step for the upgrade your code will work just fine in 5.1. It is more like a cosmetic change.

Testing a Laravel 5 route with an exists rule via Codeception

John Dorean

[Testing a Laravel 5 route with an exists rule via Codeception](https://stackoverflow.com/questions/33085786/testing-a-laravel-5-route-with-an-exists-rule-via-codeception)

I'm writing tests for my Laravel application using the Codeception library. I'm using the Laravel5 module, and have it configured with cleanup which means that all tests will run inside a database transaction, so that my testing database doesn't get filled with test data.One of the endpoints I'm testing has the following validation rules set against it via Form Requests:The test that I've written to POST to this endpoint is as follows:This test always fails. After investigating, I can see that it fails because the request is failing validation due to the exists:users,id rule. If I change the Codeception settings to not execute tests inside a transaction, Laravel's validator can successfully see the existence of the two user's that I created at the start of my test and the test passes.So, my question is, is there any way that I can maintain the behaviour of wrapping each of my tests in a database transaction, and have Laravel's validator be able to see the records that I create in my tests?

2015-10-12 16:21:15Z

I'm writing tests for my Laravel application using the Codeception library. I'm using the Laravel5 module, and have it configured with cleanup which means that all tests will run inside a database transaction, so that my testing database doesn't get filled with test data.One of the endpoints I'm testing has the following validation rules set against it via Form Requests:The test that I've written to POST to this endpoint is as follows:This test always fails. After investigating, I can see that it fails because the request is failing validation due to the exists:users,id rule. If I change the Codeception settings to not execute tests inside a transaction, Laravel's validator can successfully see the existence of the two user's that I created at the start of my test and the test passes.So, my question is, is there any way that I can maintain the behaviour of wrapping each of my tests in a database transaction, and have Laravel's validator be able to see the records that I create in my tests?The problem is, that if the transaction is not commited, the original data in the database tables is not affected. So within the transaction, you create two users, but there is no commit statement that would persist that to your database. Hence the laravel validation rule 'exists' cannot find them ( that rule makes a database request to find particular user_id ). So in your case the users have to exist before testing. I would recommend to use Migrations instead. Resetting Database after each testCreate your tables with database migrations and seeds and roll them back after tests have finished. Quote:Why are you sending $users[0]->id in the request url and then 'user_id' => $users[1]->id in the parameters?Could this be your problem? Could this be the reason you are failing the validation?

