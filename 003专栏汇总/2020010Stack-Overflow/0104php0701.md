[Best solution to protect PHP code without encryption](https://stackoverflow.com/questions/336057/best-solution-to-protect-php-code-without-encryption)

First of all, I'm not looking for miracle... I know how PHP works and that there's not really way to hide my code from the clients without using encryption. But that comes with the cost of an extension to be installed on the running server.I'm looking for something different though... I'm not looking to encrypt my code or even obfuscate it. There are many PHP scripts without encrypted/obfuscated code but they are commercial applications. For instance, vBulletin and/or IP.Board forum applications.I just want to know what approach do these guys use for their applications...I'm also open to any other suggestions.Please note that I'm a single person and not working for a company. My product is also very specific, it won't sell that much. I just want you guys to know that I can't afford to consult a legal professional either to sue someone or prepare a commercial license. I'm just looking for a simple way to protect my simple product, if it's indeed possible, somehow...

2008-12-03 02:11:30Z

First of all, I'm not looking for miracle... I know how PHP works and that there's not really way to hide my code from the clients without using encryption. But that comes with the cost of an extension to be installed on the running server.I'm looking for something different though... I'm not looking to encrypt my code or even obfuscate it. There are many PHP scripts without encrypted/obfuscated code but they are commercial applications. For instance, vBulletin and/or IP.Board forum applications.I just want to know what approach do these guys use for their applications...I'm also open to any other suggestions.Please note that I'm a single person and not working for a company. My product is also very specific, it won't sell that much. I just want you guys to know that I can't afford to consult a legal professional either to sue someone or prepare a commercial license. I'm just looking for a simple way to protect my simple product, if it's indeed possible, somehow...Obfuscating things can only inconvenience your legitimate, law-abiding customers, while the people who would would rip you off are not your target paying customers anyway.  (edited out other thoughts about obfuscation)Another suggestion for protecting your software:  create a business model in which the code is an incomplete part of the value of your offering.  For example, sell product licenses along with access to some data you manage on your site, or license the product on a subscription model or with customer support.Designing a EULA is a legal matter, not a coding matter.  You can start by reading some EULA text for products and websites you use.  You might find some interesting details!Creating a proprietary license is is highly flexible, and probably a subject beyond the intended scope of StackOverflow, since it's not strictly about coding.Some parts of a EULA that come to mind:You should consult a legal professional to prepare a commercial EULA.edit: If this project can't justify the expense of a lawyer, check out these resources:You need to consider your objectives:1) Are you trying to prevent people from reading/modifying your code?  If yes, you'll need an obfuscation/encryption tool.  I've used Zend Guard with good success.2) Are you trying to prevent unauthorized redistribution of your code??  A EULA/proprietary license will give you the legal power to prevent that, but won't actually stop it.  An key/activation scheme will allow you to actively monitor usage, but can be removed unless you also encrypt your code.  Zend Guard also has capabilities to lock a particular script to a particular customer machine and/or create time limited versions of the code if that's what you want to do.I'm not familiar with vBulletin and the like, but they'd either need to encrypt/obfuscate or trust their users to do the right thing.  In the latter case they have the protection of having a EULA which prohibits the behaviors they find undesirable, and the legal system to back up breaches of the EULA.  If you're not prepared/able to take legal action to protect your software and you don't want to encrypt/obfuscate, your options are a) Release it with a EULA so you're have a legal option if you ever need it and hope for the best, or b) consider whether an open source license might be more appropriate and just allow redistribution.You could use a php compiler:RoadsendphcI have not looked at the VBulletin source code in some time, but the way they used to do it around 2003 was to embed a call to their server inside the code. IIRC, it was on a really long code line (like 200-300+ chars long) and was broken up over several string concatenations and such. It did nothing "bad" if you pirated it - the forum still worked 100%. But your server's IP was logged along with other info and they used that to investigate and take legal action. Your license number was embedded in this call, so they could easily track how many IPs/websites a given licensed copy was running on.If you can't create a "cloud app" that you host yourself and they access via the Web, then you could look into creating a virtual appliance using a virtual server (from VMWare, Parallels, Sun, etc) and install a "lite" version of Linux on that. Put your PHP code in the virtual environment and install the virtual machine on their server. Make sure to create a way to prevent loading into root. Of course, this would involve physically visiting the client yourself.They distribute their software under a proprietary license. The law protects their rights and prevents their customers from redistributing the source, though there is no actual difficulty doing so.But as you might be well aware, copyright infringement (piracy) of software products is a pretty common phenomenon.in my opinion is, but just in case if your php code program is written for standalone model... best solutions is c) You could wrap the php in a container like Phalanger (.NET). as everyone knows it's bind tightly to the system especially if your program is intended for windows users. you just can make your own protection algorithm in windows programming language like .NET/VB/C# or whatever you know in .NET prog.lang.family sets.The only way to really protect your php-applications from other, is to not share the source code. If you post you code somewhere online, or send it to you customers by some medium, other people than you have access to the code.You could add an unique watermark to every single copy of your code. That way you can trace leaks back to a singe customer. (But will that help you, since the code already are outside of your control?)Most code I see comes with a licence and maybe a warranty. A line at the top of the script telling people not to alter the script, will maybe be enought. Self; when I find non-open source code, I won't use it in my projects. Maybe I'm a bit dupe, but I expect ppl not to use my none-OSS code!Zend Guard does not support php 5.5 and is easy to reverse, go for http://www.ioncube.com for obfuscation. http://wwww.phplicengine.com can license the scripts remotely or locally.See our SD PHP Obfuscator.   Handles huge systems of PHP files.  No runtime requirements on PHP server.  No extra runtime overhead.[EDIT May 2016] A recent answer noted that Zend does not handle PHP5.5.  The SD PHP Obfuscator does.So let me see, we want to show adam and eve there's some forbidden fruit in a tree, adn we 'd  like a way to prevent them from eating... How about having an angel with a flaming sword?

How to structure a modular app in Laravel 5?

imperium2335

[How to structure a modular app in Laravel 5?](https://stackoverflow.com/questions/28485690/how-to-structure-a-modular-app-in-laravel-5)

I would like to divide my application in modules. For instance, there would be a "core" modules that contains the basic login functionality, app layout/formatting (CSS etc), user management and a diary.Later on I may create other modules like a contact manager that can easily be added or removed from the application.There would be some logic in the apps navigation for determining which modules are present and to show/hide the links to them.How can I do this in terms of directory structure, namespaces and anything else that's needed?I am looking at creolab/laravel-modules but it states that it is for Laravel 4. Can I still use it with 5 in exactly the same way?The documentation says to place models, controllers and views within each module directory, but how does this work with routes? Ideally I would like each module to have its own routes.php file. How will all of this work with the stuff in the http and the resources directory?I was thinking of something like this:But I have no idea how I would get it to work.I have just tried the tutorial here:http://creolab.hr/2013/05/modules-in-laravel-4/With no extra libraries etc, just pure Laravel 5.I seem to have hit a brick wall with an error message:Regarding the following:What is causing this and how can I fix it?Got my head around this a bit more now. Got my package/module routes and views working which is great:

I have one last question, how would I load all my controllers from inside my package, much like how the loadViewsFrom() method works?

2015-02-12 19:04:03Z

I would like to divide my application in modules. For instance, there would be a "core" modules that contains the basic login functionality, app layout/formatting (CSS etc), user management and a diary.Later on I may create other modules like a contact manager that can easily be added or removed from the application.There would be some logic in the apps navigation for determining which modules are present and to show/hide the links to them.How can I do this in terms of directory structure, namespaces and anything else that's needed?I am looking at creolab/laravel-modules but it states that it is for Laravel 4. Can I still use it with 5 in exactly the same way?The documentation says to place models, controllers and views within each module directory, but how does this work with routes? Ideally I would like each module to have its own routes.php file. How will all of this work with the stuff in the http and the resources directory?I was thinking of something like this:But I have no idea how I would get it to work.I have just tried the tutorial here:http://creolab.hr/2013/05/modules-in-laravel-4/With no extra libraries etc, just pure Laravel 5.I seem to have hit a brick wall with an error message:Regarding the following:What is causing this and how can I fix it?Got my head around this a bit more now. Got my package/module routes and views working which is great:

I have one last question, how would I load all my controllers from inside my package, much like how the loadViewsFrom() method works?I seem to have figured it all out.I'll post it here in case it helps other beginners, it was just about getting the namespaces right.In my composer.json I have:My directory and files ended up like this:I got my Core module router.php to work by wrapping my controllers for that module in a group specifying the namespace:I imagine when I come to doing my models for the package it will be a similar case of getting the namespaces right.Thanks for all your help and patience!Solution:Similarly, you can create multiple modulesNote : You can add your module name whichever you have created. Here there are modules.A little late, but if you want to use modules in your future projects, i've written a module generator. It generates modules via php artisan make:module name You can also just drop some modules in the app/Modules folder and they are ready to use/work.

Take a look. Save some time ;)l5-modularYou can also use pingpong-labsdocumentations Here.Here is an example.You can just install and check the process.Note: I am not advertising. Just checked that cms built on Laravel with module support. So thought that might be helpful for you and others.Kundan roy: I liked your solution but I copied your code from StackOverflow, I had to change the quotes and semi-quotes to get it working - I think SOF replace these. Also changed Dir for base_path() to be more inline with Laravel's (new) format.pingpong/modules is a laravel package which created to manage your large laravel app using modules. Module is like a laravel package for easy structure, it have some views, controllers or models. It's working in both Laravel 4 and Laravel 5.To install through composer, simply put the following in your composer.json file:And then run composer install to fetch the package.To create a new module you can simply run :php artisan module:make <module-name> - Required. The name of module will be created.

Create a new modulephp artisan module:make BlogCreate multiple modulesphp artisan module:make Blog User Authfor more visit: https://github.com/pingpong-labs/modules

PHP: What does __('Some text') do?

Svish

[PHP: What does __('Some text') do?](https://stackoverflow.com/questions/2427204/php-what-does-some-text-do)

Reading about Kohana templates and saw something I've never seen before:What does __('Text') mean? What is it? What does it do?

2010-03-11 17:26:26Z

Reading about Kohana templates and saw something I've never seen before:What does __('Text') mean? What is it? What does it do?In Kohana (version 3) the function is defined in system/base.php and is a convenience function to aid (as the other answers have mentioned) internationalization.  You provide a string (with, optionally, some placeholders to substitute values into the finished text) which is then interpreted and, if required, a translation is returned.Contrary to assumptions in other answers, this does not use gettext.A very basic example would be (this particular string is already translated into English, Spanish and French in Kohana):The double '__' is used for Localization in CakePHP (and possible other frameworks)http://book.cakephp.org/view/163/Localization-in-CakePHPIt's string gettext ( string $message ):  http://php.net/manual/en/function.gettext.phpThe __() is just an alias for it.  So __("some text") is equivalent to gettext("some text")edit: Actually if it's two underscores than it isn't gettext().  The alias for gettext() is one underscore.Second edit: It looks like __() might be another alias for gettext().  With a slightly different meaning from _().  See here: http://groups.google.com/group/cake-php/browse_thread/thread/9f501e31a4d4130d?pli=1Third and final edit: Here's an article explaining it in more detail.  Looks like it isn't a built in function, but rather something that is commonly added in a lot of frameworks.  It is essentially an alias of gettext - it performs the same function.  However, it isn't a direct alias (I don't think).  It is implemented in and is specific to the framework.  It searches for and returns a localization or translation of the string it is given.  For more, see this blog post: http://www.eatmybusiness.com/food/2007/04/13/what-on-earth-does-a-double-underscore-then-parenthesis-mean-in-php-__/7/See http://kohanaframework.org/3.2/guide/api/I18n for details.It means someone created a function named __ (That's two underscores next to one another.)My guess is it defined somewhere in the Kohana documentation.

Connection pooling in PHP

The Chairman

[Connection pooling in PHP](https://stackoverflow.com/questions/39753/connection-pooling-in-php)

Is it possible to cache database connections when using PHP like you would in a J2EE container?  If so, how?

2008-09-02 15:11:50Z

Is it possible to cache database connections when using PHP like you would in a J2EE container?  If so, how?There is no connection pooling in php.

mysql_pconnect and connection pooling are two different things.

There are many problems connected with mysql_pconnect and first you should read the manual and carefully use it, but this is not connection pooling.Connection pooling is a technique where the application server manages the connections. When the application needs a connection it asks the application server for it and the application server returns one of the pooled connections if there is one free.We can do connection scaling in php for that please go through following link: http://www.oracle.com/technetwork/articles/dsl/white-php-part1-355135.htmlSo no connection pooling in php.As Julio said apache releases all resources when the request ends for the current reques. You can use mysql_pconnect but you are limited with that function and you must be very careful. Other choice is to use singleton pattern, but none of this is pooling.This is a good article: https://blogs.oracle.com/opal/highly-scalable-connection-pooling-in-phpAlso read this one http://www.apache2.es/2.2.2/mod/mod_dbd.htmlPersistent connections are nothing like connection pooling. A persistent connection in php will only be reused if you make multiple db connects within the same request/script execution context. In most typical web dev scenarios you'll max out your connections way faster if you use mysql_pconnect because your script will have no way to get a reference to any open connections on your next request. The best way to use db connections in php is to make a singleton instance of a db object so that the connection is reused within the context of your script execution. This still incurs at least 1 db connect per request, but it's better than making multiple db connects per reqeust. There is no real db connection pooling in php due to the nature of php. Php is not an application server that can sit there in between requests and manage references to a pool of open connections, at least not without some kind of major hack. I think  in theory you could write an app server in php and run it as a commandline script that would just sit there in the background and keep a bunch of db connections open and pass references to them to your other scripts, but I don't know if that would be possible in practice, how you'd pass the references from your commandline script to other scripts, and I sort of doubt it would perform well even if you could pull it off. Anyway that's mostly speculation.  I did just notice the link someone else posted to an apache module to allow connection pooling for prefork servers such as php. Looks interesting:

https://github.com/junamai2000/mod_namy_pool#readmeI suppose you're using mod_php, right?When a PHP file finishes executing all it's state is killed so there's no way (in PHP code) to do connection pooling. Instead you have to rely on extensions.You can mysql_pconnect so that your connections won't get closed after the page finishes, that way they get reused in the next request.This might be all that you need but this isn't the same as connection pooling as there's no way to specify the number of connections to maintain opened.Cheers.You can use MySQLi.For more info, scroll down to Connection pooling section @ http://www.php.net/manual/en/mysqli.quickstart.connections.php#example-1622Note that Connection pooling is also dependent on your server (i.e. Apache httpd) and its configuration.Connection pooling works at MySQL server side like this.So the connection pooling option is actually available at MySQL server side. At PHP code end there is no option. mysql_pconnect() is just a wrapper that inform PHP to not send connection close request signal at the end of script run. You cannot instantiate connection pools manually.But you can use the "built in" connection pooling with the mysql_pconnect function.I would like to suggest PDO::ATTR_PERSISTENTPersistent connections are links that do not close when the execution of your script ends. When a persistent connection is requested, PHP checks if there's already an identical persistent connection (that remained open from earlier) - and if it exists, it uses it. If it does not exist, it creates the link.If an unused persistent connection for a given combination of "host, username, password, socket, port and default database can not be found" in the open connection pool, then only mysqli opens a new connection otherwise it would reuse already open available persistent connections, which is in a way similar to the concept of connection pooling. The use of persistent connections can be enabled and disabled using the PHP directive mysqli.allow_persistent. The total number of connections opened by a script can be limited with mysqli.max_links (this may be interesting to you to address max_user_connections issue hitting hosting server's limit). The maximum number of persistent connections per PHP process can be restricted with mysqli.max_persistent. In wider programming context, it's a task of web/app server however in this context, it's being handled by mysqli directive of PHP itself in a way supporting connection re-usability. You may also implement a singleton class to get a static instance of connection to reuse just like in Java. Just want to remind that java also doesn't support connection pooling as part of its standard JDBC, they're being different module/layers on top of JDBC drivers.Coming to PHP, the good thing is that for the common databases in the PHP echosystem it does support Persistent Database Connections which persists the connection for 500 requests (config of max_requests in php.ini) and this avoids creating a new connection in each request. So check it out in docs in detail, it solves most of your challenges. Please note that PHP is not so much sophisticated in terms of extensive multi-threading mechanism and concurrent processing together with powerful asynchronous event handling, when compared to strictly object oriented Java. So in a way it is very less effective for PHP to have such in-built mechanism like pooling.

Can I「Mock」time in PHPUnit?

Narcissus

[Can I「Mock」time in PHPUnit?](https://stackoverflow.com/questions/2371854/can-i-mock-time-in-phpunit)

... not knowing if 'mock' is the right word.Anyway, I have an inherited code-base that I'm trying to write some tests for that are time-based. Trying not to be too vague, the code is related to looking at the history of an item and determining if that item has now based a time threshold.At some point I also need to test adding something to that history and checking that the threshold is now changed (and, obviously, correct).The problem that I'm hitting is that part of the code I'm testing is using calls to time() and so I'm finding it really hard to know exactly what the threshold time should be, based on the fact that I'm not quite sure exactly when that time() function is going to be called.So my question is basically this: is there some way for me to 'override' the time() call, or somehow 'mock out' the time, such that my tests are working in a 'known time'?Or do I just have to accept the fact that I'm going to have to do something in the code that I'm testing, to somehow allow me to force it to use a particular time if need be? Either way, are there any 'common practices' for developing time-sensitive functionality that is test friendly?Edit:

Part of my problem, too, is the fact that the time that things occurred in history affect the threshold. Here's an example of part of my problem...Imagine you have a banana and you're trying to work out when it needs to be eaten by. Let's say that it will expire within 3 days, unless it was sprayed with some chemical, in which case we add 4 days to the expiry, from the time the spray was applied. Then, we can add another 3 months to it by freezing it, but if it's been frozen then we only have 1 day to use it after it thaws.All of these rules are dictated by historical timings. I agree that I could use the Dominik's suggestion of testing within a few seconds, but what of my historical data? Should I just 'create' that on the fly?As you may or may not be able to tell, I'm still trying to get a hang of all of this 'testing' concept ;)

2010-03-03 14:02:22Z

... not knowing if 'mock' is the right word.Anyway, I have an inherited code-base that I'm trying to write some tests for that are time-based. Trying not to be too vague, the code is related to looking at the history of an item and determining if that item has now based a time threshold.At some point I also need to test adding something to that history and checking that the threshold is now changed (and, obviously, correct).The problem that I'm hitting is that part of the code I'm testing is using calls to time() and so I'm finding it really hard to know exactly what the threshold time should be, based on the fact that I'm not quite sure exactly when that time() function is going to be called.So my question is basically this: is there some way for me to 'override' the time() call, or somehow 'mock out' the time, such that my tests are working in a 'known time'?Or do I just have to accept the fact that I'm going to have to do something in the code that I'm testing, to somehow allow me to force it to use a particular time if need be? Either way, are there any 'common practices' for developing time-sensitive functionality that is test friendly?Edit:

Part of my problem, too, is the fact that the time that things occurred in history affect the threshold. Here's an example of part of my problem...Imagine you have a banana and you're trying to work out when it needs to be eaten by. Let's say that it will expire within 3 days, unless it was sprayed with some chemical, in which case we add 4 days to the expiry, from the time the spray was applied. Then, we can add another 3 months to it by freezing it, but if it's been frozen then we only have 1 day to use it after it thaws.All of these rules are dictated by historical timings. I agree that I could use the Dominik's suggestion of testing within a few seconds, but what of my historical data? Should I just 'create' that on the fly?As you may or may not be able to tell, I'm still trying to get a hang of all of this 'testing' concept ;)I recently came up with another solution that is great if you are using PHP 5.3 namespaces. You can implement a new time() function inside your current namespace and create a shared resource where you set the return value in your tests. Then any unqualified call to time() will use your new function.For further reading I described it in detail in my blogYou can mock time for test using Clock from ouzo-goodies.In code use simply:Then in tests:I had to simulate a particular request in future and past date in the app itself (not in Unit Tests). Hence all calls to \DateTime::now() should return the date that was previously set throughout the app.I decided to go with this library https://github.com/rezzza/TimeTraveler, since I can mock the dates without altering all the codes.For those of you working with symfony (>= 2.8): Symfony's PHPUnit Bridge includes a ClockMock feature that overrides the built-in methods time, microtime, sleep and usleep.See: http://symfony.com/doc/2.8/components/phpunit_bridge.html#clock-mockingPersonally, I keep using time() in the tested functions/methods. In your test code, just make sure to not test for equality with time(), but simply for a time difference of less than 1 or 2 (depending on how much time the function takes to execute)You can overide php's time() function using the runkit extension. Make sure you set runkit.internal_overide to OnUsing [runkit][1] extension:You can even test the mock like this:In most cases this will do. It has some advantages:It's using phpunit, but you can addapt it to any other testing framework, you just need function that works like assertContains() from phpunit.1) Add below function to your test class or bootstrap. Default tolerance for time is 2 secs. You can change it by passing 3rd argument to assertTimeEquals or modify function args.2) Testing example:assertTimeEquals() will check if array of (189, 190, 191) contains 189. This test should be passed for correct working function IF executing test function takes less then 2 seconds.It's not perfect and super-accurate, but it's very simple and in many cases it's enough to test what you want to test.Simplest solution would be to override PHP time() function and replace it with your own version. However, you cannot replace built-in PHP functions easily (see here). Short of that, the only way is to abstract time() call to some class/function of your own that would return the time you need for testing.Alternatively, you could run the test system (operating system) in a virtual machine and change the time of the entire virtual computer.Here's an addition to fab's post. I did the namespace based override using an eval. This way, I can just run it for tests and not the rest of my code. I run a function similar to:then pass in timeOverrides(array(...)) in the test setup so that my tests only have to keep track of what namespaces time() is called in.

Failed to connect to mailserver at「localhost」port 25

Loolooii

[Failed to connect to mailserver at「localhost」port 25](https://stackoverflow.com/questions/4532486/failed-to-connect-to-mailserver-at-localhost-port-25)

I keep getting this error when I try to send an e-mail in PHP:my php.ini looks like this:I'm using my laptop as a server.. What am I doing wrong? Thanks.

2010-12-26 02:10:08Z

I keep getting this error when I try to send an e-mail in PHP:my php.ini looks like this:I'm using my laptop as a server.. What am I doing wrong? Thanks.You need to be running a mail server locally.

If this is Unix, enable sendmail

If this is Windows  install the Simple Mail Transfer Server (not sure if the name is correct) component of IIs.  E.g. for windows 2003 follow this: http://msdn.microsoft.com/en-us/library/8b83ac7t.aspxFor sending mails using php  mail function is used.

But mail function requires SMTP server for sending emails.

we need to mention SMTP host and SMTP port in php.ini file.

Upon successful configuration of SMTP server mails will be sent successfully sent through php scripts.On windows, nearly all AMPP (Apache,MySQL,PHP,PHPmyAdmin) packages don't include a mail server (but nearly all naked linuxes do have!). So, when using PHP under windows, you need to setup a mail server!Imo the best and most simple tool ist this: http://smtp4dev.codeplex.com/SMTP4Dev is a simple one-file mail server tool that does collect the mails it send (so it does not really sends mail, it just keeps them for development). Perfect tool.If you are running your application just on localhost and it is not yet live, I believe it is very difficult to send mail using this.Once you put your application online, I believe that this problem should be automatically solved. But i think ini_set() helps you to change the values in php.ini during run time. First of all, you aren't forced to use an SMTP on your localhost, if you change that localhost entry into the DNS name of the MTA from your ISP provider (who will let you relay mail) it will work right away, so no messing about with your own email service.  Just try to use your providers SMTP servers, it will work right away.PHP mail function can send email in 2 scenarios:a. Try to send email via unix sendmail program

At linux it will exec program "sendmail", put all params to sendmail and that all.ORb. Connect to mail server (using smtp protocol and host/port/username/pass from php.ini) and try to send email. If php unable to connect to email server it will give warning (and you see such workning in your logs)

To solve it, install smtp server on your local machine or use any available server. How to setup / configure smtp you can find on php.netChange SMTP=localhost to SMTP=smtp.gmail.com

Resize iframe height according to content height in it

chinmay

[Resize iframe height according to content height in it](https://stackoverflow.com/questions/525992/resize-iframe-height-according-to-content-height-in-it)

I am opening my blog page in my website. The problem is I can give a width to an iframe but the height should be dynamic so that there is no scrollbar in the iframe, and it looks like a single page...I have tried various JavaScript code to calculate the height of the content but all of them give an access denied permission error and is of no use.Can we use Ajax to calculate height or maybe using PHP?

2009-02-08 16:36:24Z

I am opening my blog page in my website. The problem is I can give a width to an iframe but the height should be dynamic so that there is no scrollbar in the iframe, and it looks like a single page...I have tried various JavaScript code to calculate the height of the content but all of them give an access denied permission error and is of no use.Can we use Ajax to calculate height or maybe using PHP?To directly answer your two subquestions: No, you cannot do this with Ajax, nor can you calculate it with PHP.What I have done in the past is use a trigger from the iframe'd page in window.onload (NOT domready, as it can take a while for images to load) to pass the page's body height to the parent.Then the parent.resizeIframe looks like this:Et voila, you have a robust resizer that triggers once the page is fully rendered with no nasty contentdocument vs contentWindow fiddling :)Sure, now people will see your iframe at default height first, but this can be easily handled by hiding your iframe at first and just showing a 'loading' image. Then, when the resizeIframe function kicks in, put two extra lines in there that will hide the loading image, and show the iframe for that faux Ajax look.Of course, this only works from the same domain, so you may want to have a proxy PHP script to embed this stuff, and once you go there, you might as well just embed your blog's RSS feed directly into your site with PHP.You can do this with JavaScript.Fitting IFRAME contents is kind of an easy thing to find on Google. Here's one solution:This of course doesn't solve the cross-domain problem you are having... Setting document.domain might help if these sites are in the same place. I don't think there is a solution if you are iframe-ing random sites.Here's my solution to the problem using MooTools which works in Firefox 3.6, Safari 4.0.4 and Internet Explorer 7: Style the "loading" class to show an Ajax loading graphic in the middle of the iframe container. Then for browsers other than Internet Explorer, it will display the full height IFRAME once the loading of its content is complete and remove the loading graphic.Below is my onload event handler.I use an IFRAME within a jQuery UI dialog. Different usages will need some adjustments.

This seems to do the trick for me (for now) in Internet Explorer 8 and Firefox 3.5.

It might need some extra tweaking, but the general idea should be clear.@SchizoDuckie's answer is very elegant and lightweight, but due to Webkit's lack of implementation for scrollHeight (see here), does not work on Webkit-based browsers (Safari, Chrome, various and sundry mobile platforms).For this basic idea to work on Webkit along with Gecko and Trident browsers, one need only replacewith So long as everything is on the same domain, this works quite well.I just spent the better part of 3 days wrestling with this. I'm working on an application that loads other applications into itself while maintaining a fixed header and a fixed footer. Here's what I've come up with. (I also used EasyXDM, with success, but pulled it out later to use this solution.)Make sure to run this code AFTER the <iframe> exists in the DOM. Put it into the page that pulls in the iframe (the parent).The trick is to acquire all the necessary iframe events from an external script. For instance, you have a script which creates the iFrame using document.createElement; in this same script you temporarily have access to the contents of the iFrame.This works because dFrame stays in scope in those functions, giving you access to the external iFrame element from within the scope of the frame, allowing you to see the actual document height and expand it as necessary. This example will work in firefox but nowhere else; I could give you the workarounds, but you can figure out the rest ;)Try this, you can change for even when you want. this example use jQuery.Try using scrolling=no attribute on the iframe tag. Mozilla also has an overflow-x and overflow-y CSS property you may look into.In terms of the height, you could also try height=100% on the iframe tag.

Convert time in HH:MM:SS format to seconds only?

Ryan

[Convert time in HH:MM:SS format to seconds only?](https://stackoverflow.com/questions/4834202/convert-time-in-hhmmss-format-to-seconds-only)

How to turn time in format HH:MM:SS into a flat seconds number?P.S. Time could be sometimes in format MM:SS only.

2011-01-29 00:04:19Z

How to turn time in format HH:MM:SS into a flat seconds number?P.S. Time could be sometimes in format MM:SS only.No need to explode anything:And if you don't want to use regular expressions:I think the easiest method would be to use strtotime() function:demoFunction date_parse() can also be used for parsing date and time:demoIf you will parse format MM:SS with strtotime() or date_parse() it will fail (date_parse() is used in strtotime() and DateTime), because when you input format like xx:yy parser assumes it is HH:MM and not MM:SS. I would suggest checking format, and prepend 00: if you only have MM:SS.demo strtotime() demo date_parse() If you have hours more than 24, then you can use next function (it will work for MM:SS and HH:MM:SS format):demoIn pseudocode:Try this:You can use the strtotime function to return the number of seconds from today 00:00:00.Simple

Get interval seconds between two datetime in PHP?

Misier

[Get interval seconds between two datetime in PHP?](https://stackoverflow.com/questions/1519228/get-interval-seconds-between-two-datetime-in-php)

2009-10-05 18:11:082009-10-05 18:07:13This should generate 235,how to do it ?

2009-10-05 10:12:45Z

2009-10-05 18:11:082009-10-05 18:07:13This should generate 235,how to do it ?You can use strtotime() to do that:A similar approach is possible with DateTime objects, e.g.With DateTime objects, you can do it like this:PHP Date Time reference is helpful for things like this: PHP Date Time Functionsstrtotime() is probably the best way.Because of unix epoch limitations, you could have problems compairing dates before 1970 and after 2038. I choose to loose precision (=don't look at the single second) but avoid to pass trough unix epoch conversions (getTimestamp). It depends on what you are doing to do...In my case, using 365 instead (12*30) and "30" as mean month lenght, reduced the error in an usable output.Note that the error could be 0, if "mean" quantities are intended for diff. The PHP docs don't speaks about this...

In a bad case, error could be:I prefer to suppose that somebody decided to consider "m" as 30 days and "y" as 365, charging "d" with the difference when "diff" walk trough non-30-days months...If somebody knows something more about this and can provide official documentation, is welcome!If you need the real local time difference and want to work with getTimestamp, you must take DST switches during the calculated period into account. Therefore, the local offset to UTC must be included in the equation.Take, for instance, the following dates:$start is "2018-02-01 11:00:00" in UTC, while $end is "2018-04-01 10:00:00" in UTC. Note that, while the time of day is the same in the Berlin timezone, it is different in UTC. The UTC offset is one hour in $start and 2 hours in $end. Keep in mind that getTimestamp always returns UTC! Therefore you must subtract the offset from the timestamp when looking for the actual local difference.A simple and exact solution (exemplifying Nilz11's comment):

How to Merge Two Eloquent Collections?

Martyn

[How to Merge Two Eloquent Collections?](https://stackoverflow.com/questions/30522528/how-to-merge-two-eloquent-collections)

I have a questions table and a tags table. I want to fetch all questions from tags of a given question. So, for example, I may have the tags "Travel," "Trains" and "Culture" attached to a given question. I want to be able to fetch all questions for those three tags. The tricky, so it seems, is that questions and tags relationship is a many-to-many defined in Eloquent as belongsToMany.I thought about trying to merge the questions Collections as below:It doesn't seem to work though. Doesn't seem to merge anything. Am I attempting this correctly? Also, is there perhaps a better way to fetch a row of rows in a many-to-many relationship in Eloquent?

2015-05-29 06:25:24Z

I have a questions table and a tags table. I want to fetch all questions from tags of a given question. So, for example, I may have the tags "Travel," "Trains" and "Culture" attached to a given question. I want to be able to fetch all questions for those three tags. The tricky, so it seems, is that questions and tags relationship is a many-to-many defined in Eloquent as belongsToMany.I thought about trying to merge the questions Collections as below:It doesn't seem to work though. Doesn't seem to merge anything. Am I attempting this correctly? Also, is there perhaps a better way to fetch a row of rows in a many-to-many relationship in Eloquent?The merge method returns the merged collection, it doesn't mutate the original collection, thus you need to do the followingApplying the example to your codeThe merge() method on the Collection does not modify the collection on which it was called. It returns a new collection with the new data merged in. You would need:However, I think you're tackling the problem from the wrong angle.Since you're looking for questions that meet a certain criteria, it would probably be easier to query in that manner. The has() and whereHas() methods are used to generate a query based on the existence of a related record.If you were just looking for questions that have any tag, you would use the has() method. Since you're looking for questions with a specific tag, you would use the whereHas() to add the condition.So, if you want all the questions that have at least one tag with either 'Travel', 'Trains', or 'Culture', your query would look like:If you wanted all questions that had all three of those tags, your query would look like:Merge two different eloquent collections into one and some objects happen to have the same id, one will overwrite the other. Use push() method instead or rethink your approach to the problem to avoid that.

Refer to webAll do not work for me on eloquent collections, laravel eloquent collections use the key from the items I think which causes merging issues, you need to get the first collection back as an array, put that into a fresh collection and then push the others into the new collection;In order to combine two eloquent collections we can use union. 

Here is official docs: https://laravel.com/docs/5.8/queries#unions. 

For example:  (imagine we have two users)

How to get address location from latitude and longitude in Google Map.? [closed]

Boris Kuzevanov

[How to get address location from latitude and longitude in Google Map.? [closed]](https://stackoverflow.com/questions/19511597/how-to-get-address-location-from-latitude-and-longitude-in-google-map)

So I have latitude and longitude Like 44.4647452 and 7.3553838. I need to get address like: Milan, Italy, str. Kennedy 89. How I can do it?

2013-10-22 07:25:04Z

So I have latitude and longitude Like 44.4647452 and 7.3553838. I need to get address like: Milan, Italy, str. Kennedy 89. How I can do it?Simply pass latitude, longitude and your Google API Key to the following query string, you will get a json array, fetch your city from there.https://maps.googleapis.com/maps/api/geocode/json?latlng=44.4647452,7.3553838&key=YOUR_API_KEYNote: Ensure that no space exists between the latitude and longitude values when passed in the latlng parameter.Click here to get an API keyWhat your looking for is Reverse Geo Coding. Have a look at this example here. https://developers.google.com/maps/documentation/javascript/examples/geocoding-reverseYou have to make one ajax call to get the required result, in this case you can use Google API to get the sameBuild this kind of url and replace the lat long with the one you want to. do the call and response will be in JSON, parse the JSON and you will get the complete address up to street level

PHP Array to JSON Array using json_encode();

Ryan Brodie

[PHP Array to JSON Array using json_encode();](https://stackoverflow.com/questions/11722059/php-array-to-json-array-using-json-encode)

I've encoded an Array I've made using the inbuilt json_encode(); function. I need it in the format of an Array of Arrays like so:However, it is returning as:How can I remove these row numbers without using any Regex trickery?

2012-07-30 12:55:52Z

I've encoded an Array I've made using the inbuilt json_encode(); function. I need it in the format of an Array of Arrays like so:However, it is returning as:How can I remove these row numbers without using any Regex trickery?If the array keys in your PHP array are not consecutive numbers, json_encode() must make the other construct an object since JavaScript arrays are always consecutively numerically indexed.Use array_values() on the outer structure in PHP to discard the original array keys and replace them with zero-based consecutive numbering:json_encode() function will help you to encode array to JSON in php. if you will use just json_encode function directly without any specific option, it will return an array.

Like mention above questionSince you are trying to convert Array to JSON, Then I would suggest to use JSON_FORCE_OBJECT as additional option(parameters) in json_encode, Like belowI want to add to Michael Berkowski's answer that this can also happen if the array's order is reversed, in which case it's a bit trickier to observe the issue, because in the json object, the order will be ordered ascending.For example:Will return:So the solution in this case, is to use array_reverse before encoding it to jsonA common use of JSON is to read data from a web server, and display the data in a web page.This chapter will teach you how to exchange JSON data between the client and a PHP server.PHP has some built-in functions to handle JSON.Objects in PHP can be converted into JSON by using the PHP function json_encode():If you don't specify indexes on your initial array, you get the regular numric ones.  Arrays must have some form of unique index

How can I validate regex?

Ross McFarlane

[How can I validate regex?](https://stackoverflow.com/questions/4440626/how-can-i-validate-regex)

I'd like to test the validity of a regular expression in PHP, preferably before it's used. Is the only way to do this actually trying a preg_match() and seeing if it returns FALSE?Is there a simpler/proper way to test for a valid regular expression?

2010-12-14 15:17:21Z

I'd like to test the validity of a regular expression in PHP, preferably before it's used. Is the only way to do this actually trying a preg_match() and seeing if it returns FALSE?Is there a simpler/proper way to test for a valid regular expression?As the user pozs said, also consider putting @ in front of preg_match() (@preg_match()) in a testing environment to prevent warnings or notices.To validate a RegExp just run it against null (no need to know the data you want to test against upfront). If it returns explicit false (=== false), it's broken. Otherwise it's valid though it need not match anything.So there's no need to write your own RegExp validator. It's wasted time...I created a simple function that can be called to checking pregYou can call this function using the follow code :Alternative - Regular Expression Online TesterIf you want to dynamically test a regex preg_match(...) === false seems to be your only option. PHP doesn't have a mechanism for compiling regular expressions before they are used.Also you may find preg_last_error an useful function.On the other hand if you have a regex and just want to know if it's valid before using it there are a bunch of tools available out there. I found rubular.com to be pleasant to use.You can check to see if it is a syntactically correct regex with this nightmare of a regex, if your engine supports recursion (PHP should).You cannot, however algorithmically tell if it will give the results you want without running it. From: Is there a regular expression to detect a valid regular expression?Without actually executing the regex you have no way to be sure if it's be valid. I've recently implemented a similar RegexValidator for Zend Framework. Works just fine.You can validate your regular expression with a regular expression and up to a certain limit. Checkout this stack overflow answer for more info.Note: a "recursive regular expression" is not a regular expression, and this extended version of regex doesn't match extended regexes.A better option is to use preg_match and match against NULL as @Claudrian saidSo in summary, for all those coming to this question you can validate regular expressions in PHP with a function like this.Which can be used like this.I am not sure if it supports PCRE, but there is a Chrome extension over at https://chrome.google.com/webstore/detail/cmmblmkfaijaadfjapjddbeaoffeccib called RegExp Tester. I have not used it as yet myself so I cannot vouch for it, but perhaps it could be of use? I'd be inclined to set up a number of unit tests for your regex. This way not only would you be able to ensure that the regex is indeed valid but also effective at matching.I find using TDD is an effective way to develop regex and means that extending it in the future is simplified as you already have all of your test cases available.The answer to this question has a great answer on setting up your unit tests.You should try to match the regular expression against NULL. If the result is FALSE (=== FALSE), there was an error.In PHP >= 5.5, you can use the following to automatically get the built-in error message, without needing to define your own function to get it:According to the PCRE reference, there is no such way to test validity of an expression, before it's used. But i think, if someone use an invalid expression, it's a design error in that application, not a run-time one, so you should be fine.

Laravel: Using try…catch with DB::transaction()

enchance

[Laravel: Using try…catch with DB::transaction()](https://stackoverflow.com/questions/22906844/laravel-using-try-catch-with-dbtransaction)

We all use DB::transaction() for multiple insert queries. In doing so, should a try...catch be placed inside it or wrapping it? Is it even necessary to include a try...catch when a transaction will automatically fail if something goes wrong?Sample try...catch wrapping a transaction:The opposite, a DB::transaction() wrapping a try...catch:Or simply a transaction w/o a try...catch

2014-04-07 08:09:13Z

We all use DB::transaction() for multiple insert queries. In doing so, should a try...catch be placed inside it or wrapping it? Is it even necessary to include a try...catch when a transaction will automatically fail if something goes wrong?Sample try...catch wrapping a transaction:The opposite, a DB::transaction() wrapping a try...catch:Or simply a transaction w/o a try...catchIn the case you need to manually 'exit' a transaction through code (be it through an exception or simply checking an error state) you shouldn't use DB::transaction() but instead wrap your code in DB::beginTransaction and DB::commit/DB::rollback():See the transaction docs.If you use PHP7, use Throwable in catch for catching user exceptions and fatal errors.For example:If your code must be compartable with PHP5, use Exception and Throwable:You could wrapping the transaction over try..catch or even reverse them,

here my example code I used to in laravel 5,, if you look deep inside DB:transaction() in Illuminate\Database\Connection that the same like you write manual transaction.Laravel Transactionso you could write your code like this, and handle your exception like throw message back into your form via flash or redirect to another page. REMEMBER return inside closure is returned in transaction() so if you return redirect()->back() it won't redirect immediately, because the it returned at variable which handle the transaction.Wrap Transactionthen the alternative is throw boolean variable and handle redirect outside transaction function or if your need to retrieve why transaction failed you can get it from $e->getMessage() inside catch(Exception $e){...} I've decided to give an answer to this question because I think it can be solved using a simpler syntax than the convoluted try-catch block. The Laravel documentation is pretty brief on this subject.Instead of using try-catch, you can just use the DB::transaction(){...} wrapper like this:You should then see that the User and the Log record cannot exist without eachother.Some notes on the implementation above:Tested on Laravel 5.8

How to install Laravel 5.0

Webnet

[How to install Laravel 5.0](https://stackoverflow.com/questions/25948560/how-to-install-laravel-5-0)

I'm having trouble getting a test instance of Laravel 5.0 up and running so I can assist with this transition.1) Creating a new app from https://github.com/laravel/laravel/tree/develop leads to the following error when running composer install.Am I completely missing something?UPDATE: This question/answer was only relevant when Laravel 5 was in the development stage.  You should now reference the Laravel Documentation for how to install Laravel

2014-09-20 12:02:49Z

I'm having trouble getting a test instance of Laravel 5.0 up and running so I can assist with this transition.1) Creating a new app from https://github.com/laravel/laravel/tree/develop leads to the following error when running composer install.Am I completely missing something?UPDATE: This question/answer was only relevant when Laravel 5 was in the development stage.  You should now reference the Laravel Documentation for how to install LaravelAs Laravel 5 is already final release, to install it, you should run in your console. test-laravel-5-project is the name of your project you can call it anyway you want - for example myblog, myapp etc. Laravel files will be put inside this directoryYou can also use alternative method usingand then runningFor detailed info you should look at official Laravel installation notesThe below answer is being kept only for historical reasons and it was valid when Laravel 5 still was in its development stages. You should now only use the method mentioned aboveI've just tested this and there are two ways of installing Laravel 5:One-step methodYou just run:and composer will create the whole directory structure. In above command test-laravel-5-project is your project name - you can of course name it as you want (composer will create directory with this name and put all Laravel5 files inside this directory)Multi-step methodUsing both methods when you run URL for your project in the browser (for example http://localhost/projects/test-laravel-5-project/public depending on your webserver settings ) you will get standard Laravel website You have arrived.Both methods should work well. Give either one a try, whichever works best for you.Go to CLI and enter following command line. make sure composer is already installed.$composer create-project laravel/laravel <yourdirectryname> dev-develop

It will ask you a question about removing .git files enter Y then.

change the directory to  $cd <yourdirectoryname>

then enter following command$ php artisan -Vyou will be able to see following message.Laravel Framework version 5.0-dev

means you have installed laravel 5 successfully!Run this command from where you want to store your projectRemember, it will download the latest version of laravel application from git.if you are using linux then give permission to bootstrap/cache and storage by running the command chmod 777 -R <dir name> from root of your laravel projectFirst you need to install laravel globally in your system by this commandcomposer global require laravel/installer

then you can install laravel by three ways, 

1) Go to laravel github Reqosritory and download it's zip, and second it get ssh or Https url and install it from CMD or Git bash

 2) open Git bash just write laravel new there, this will download the latest laravel verision

3) open cmd or git bash and write there.

composer create-project --prefer-dist laravel/laravel blog

if you want to install some old version then you can write the mention the version in last.

composer create-project --prefer-dist laravel/laravel blog 5.2.*

how to upload file using curl with php [closed]

Hadidi44

[how to upload file using curl with php [closed]](https://stackoverflow.com/questions/15200632/how-to-upload-file-using-curl-with-php)

I want to know how to upload file using cURL or anything else in PHP. I have searched in google many times but no results.In other words, the user sees a file upload button on a form, the form gets posted to my php script, then my php script needs to re-post it to another script (eg on another server).I have this code to receive the file and upload itcode : I want the code to send the file to receiver file.

2013-03-04 11:36:25Z

I want to know how to upload file using cURL or anything else in PHP. I have searched in google many times but no results.In other words, the user sees a file upload button on a form, the form gets posted to my php script, then my php script needs to re-post it to another script (eg on another server).I have this code to receive the file and upload itcode : I want the code to send the file to receiver file.Use:You can also refer: http://blog.derakkilgo.com/2009/06/07/send-a-file-via-post-with-curl-and-php/Important hint for PHP 5.5+:Now we should use https://wiki.php.net/rfc/curl-file-upload but if you still want to use this deprecated approach then you need to set curl_setopt($ch, CURLOPT_SAFE_UPLOAD, false);

Does $_SERVER['HTTP_X_REQUESTED_WITH'] exist in PHP or not?

Hank

[Does $_SERVER['HTTP_X_REQUESTED_WITH'] exist in PHP or not?](https://stackoverflow.com/questions/2579254/does-serverhttp-x-requested-with-exist-in-php-or-not)

All over the Internet, included even here at Stack Overflow, people state that a good way to check if a request is AJAX or not is to do the following:However, I don't see $_SERVER['HTTP_X_REQUESTED_WITH'] in the official PHP documentationAnd when I try to do the following:Nothing is outputted.Am I doing something wrong? Because I'd really like to be able to use $_SERVER['HTTP_X_REQUESTED_WITH'] if it's available.

2010-04-05 15:38:39Z

All over the Internet, included even here at Stack Overflow, people state that a good way to check if a request is AJAX or not is to do the following:However, I don't see $_SERVER['HTTP_X_REQUESTED_WITH'] in the official PHP documentationAnd when I try to do the following:Nothing is outputted.Am I doing something wrong? Because I'd really like to be able to use $_SERVER['HTTP_X_REQUESTED_WITH'] if it's available.The variables in $_SERVER are not really part of PHP, which is why you won't find them in the PHP documentation. They are prepared by the Web server which passes them on to the scripting language.As far as I know, the X-Requested-With is sent by the Ajax functions of most major Frameworks but not all (Dojo, for example, added it only two years ago: #5801). As such, and taking into considerations @bobince' comments, it's safe to say it's not generally a 100% reliable method to determine whether a request is an AJAX request or not. The only 100% secure way is to send a pre-defined flag (e.g. a GET variable) along with the request and for the receiving page to check for the presence of that flag. don't forget that you can easily spoof any header with cURL like so$_SERVER keys that start with HTTP_ are generated from HTTP request headers. In this case, the X-Requested-With header.This header is a standardization-in-progress from all of the AJAX libraries out there.It won't be documented in the php documentation per-se, but rather in the different AJAX libraries that set this header. Common libraries do sent this header: jQuery, Mojo, Prototype, ...Usually these library will set the header using Here's a quick function with example usage:What'd you expect from such a code? Assume you're running it directly from the browser, not using AJAX request. So, how come this header could be set?Well the Answer to the Ultimate Question of Life, the Universe, and Everything - an HTTP sniffer! Get yourself one and forget of printing $_SERVER variable. Firebug has one, or you may want to use Fiddler HTTP proxy or LiveHTTPHeaders Mozilla plugin. I'm bored to make links but it easily googled. So, with HTTP sniffer you can be sure of any HTTP header ever.Note that you can't prevent any "direct access" by using XHR, as every HTTP request to your server is already "direct".You can also blame some browser bugs - see this question and its solution for FirefoxFirefox does not preserve custom headers during Ajax request redirect: an ASP.NET MVC solutionIE also having caching issue which is more serious then detection of request method.You anyway needs to add cache busters to avoid caching, so why not use another flag to specify the ajax call - or more better you can use different URL like http://ajax.mysite.com/endpoint/sevice?params The best solution to make sure if an HTTP request is truly sent via AJAX is using SESSION checking , you send session_id in a get parameter and you check this session if it's allowed or not ! I agree Pekka. There is no reliable native method between front side and back side that can auto-detect if a client is really calling an endpoint using AJAX.For my own use, I have few main ways to check if a client is requesting one of my endpoint:

__construct() vs SameAsClassName() for constructor in PHP

Newtang

[__construct() vs SameAsClassName() for constructor in PHP](https://stackoverflow.com/questions/217618/construct-vs-sameasclassname-for-constructor-in-php)

Is there any advantage to using __construct() instead of the class's name for a constructor in PHP?Example (__construct):Example (named):Having the __construct method (first example) is possible since PHP 5.Having a method with the same name as the class as constructor (second example) is possible from PHP version 4 until version 7.

2008-10-20 05:52:58Z

Is there any advantage to using __construct() instead of the class's name for a constructor in PHP?Example (__construct):Example (named):Having the __construct method (first example) is possible since PHP 5.Having a method with the same name as the class as constructor (second example) is possible from PHP version 4 until version 7.I agree with gizmo, the advantage is so you don't have to rename it if you rename your class.  DRY.Similarly, if you have a child class you can call to call the parent constructor.  If further down the track you change the class the child class inherits from, you don't have to change the construct call to the parent.It seems like a small thing, but missing changing the constructor call name to your parents classes could create subtle (and not so subtle) bugs.For example, if you inserted a class into your heirachy, but forgot to change the constructor calls, you could started calling constructors of grandparents instead of parents.  This could often cause undesirable results which might be difficult to notice.Also note thatSource: http://php.net/manual/en/language.oop5.decon.php__construct was introduced in PHP5. It is the way you are supposed to do it now. I am not aware of any advantages per se, though.From the PHP manual:If you're on PHP5 I would recommend using __construct to avoid making PHP look elsewhere.The main advantage I see for __construct, is that you don't have to rename your constructor if you change your class name.Today, the accepted answer is obsolete.Renaming classes is bad practice: you have to remember what and where to rename everytime you upgrade to newer version. Sometimes (like using Reflection or complex dependence structure) it can be impossible without radical refactoring. And this is accidental complexity you want to avoid. That's why namespaces were introduced into PHP. Java, C++ or C# don't use __construct, they use named constructor and there's no issue with them.ExampleNote that named constructors are not deprecated (PHP 5.5 today). However, you can't predict that your class won't be used in namespace, therefore __construct should be preffered.Clarification about the bad practice mentioned above (for Dennis)Somewhere in your code you could use ReflectionClass::getName(); when you rename the class, you need to remember where you used Reflection and check if the getName() result is still consistent in your app. The more you need to remember something specific, the more likely something is forgotten which results in bugs in the app.The parents can't have control about all the classes in the world which depends on them. If allow_url_include is enabled, some other web might be using the class from your server, which may crash if you rename some class. It is even worse in compiled languages mentioned above: the library can be copied and bundled in other code.There is no reason why to rename class:In PHP classes in namespace, the method with the same name should be avoided anyway: intuitively it should produce an object created the class; if it does something else, why to give it the same name? It should be a constructor and nothing else. The main issue is that the behavior of such a method depends on namespace usage.There is no issue with __construct constructors in PHP. But it wasn't the smartest idea to alter the named constructors.The best advantage of using __contruct() instead of ClassName() is when extending classes. It is much easier to call parent::__construct() instead of parent::ClassName(), as it is reusable among classes and the parent can be changed easily.In your example Foo::Foo is sometimes called a PHP 4 or old-style constructor because it comes from the days of PHP 4:PHP 4 constructors will be deprecated but not removed in PHP 7. They will be no longer be considered as constructors in any situation in PHP 8. Future compatibility is definitely a big reason to not use this feature.In PHP 5 the advantage would be that performance would be better.  It will look for a constructor by the name of __construct first and if it doesn't find that, it will look for constructors by the name of className.  So if it finds a constructor by the name __construct it does not need to search for a constructor by the name className.Well it has been a few years since this question was asked, but I think I have to answer this one still, because things has changed and for readers in the future I want to keep the information up to date!So in php-7 they will remove the option to create the constructor as a function with the same name as the class. If you still do it you will get a E_DEPRECATED. You can read more about this proposal (the proposal is accepted) here:

 https://wiki.php.net/rfc/remove_php4_constructorsAnd a quote from there:Also you won't get a E_STRICT in php-7 if you define a method with the same name as the class AND a __construct().You can see this also here:So I would recommend you to use __construct(), since you will have less issues with this in the future.Forward compatibility. There's always a chance that legacy code that's left in the language for backwards compatibility's sake will be removed in a future version.If there is methods __construct and SameAsClassName method then __construct will be executed, SameAsClassName method will be skipped.I think that the main reason is that is the language convention.

You don't need to force a language to act like someone else.I mean, in Objective-C you prefix the constructors with -init, for example. You can make your own constructor using your class name but why? Are ther some reason to use this schema instead of the language convention?

PHP Create and Save a txt file to root directory

Satch3000

[PHP Create and Save a txt file to root directory](https://stackoverflow.com/questions/9265274/php-create-and-save-a-txt-file-to-root-directory)

I am trying to create and save a file to the root directory of my site, but I don't know where its creating the file as I cannot see any. And, I need the file to be overwritten every time, if possible.Here is my code:How can I set it to save on the root?

2012-02-13 17:45:29Z

I am trying to create and save a file to the root directory of my site, but I don't know where its creating the file as I cannot see any. And, I need the file to be overwritten every time, if possible.Here is my code:How can I set it to save on the root?It's creating the file in the same directory as your script.  Try this instead.If you are running PHP on Apache then you can use the enviroment variable called DOCUMENT_ROOT. This means that the path is dynamic, and can be moved between servers without messing about with the code.fopen() will open a resource in the same directory as the file executing the command.  In other words, if you're just running the file ~/test.php, your script will create ~/myText.txt.This can get a little confusing if you're using any URL rewriting (such as in an MVC framework) as it will likely create the new file in whatever the directory contains the root index.php file.Also, you must have correct permissions set and may want to test before writing to the file.  The following would help you debug:

PHP Mess Detector for Eclipse

Ilia Shakitko

[PHP Mess Detector for Eclipse](https://stackoverflow.com/questions/14705389/php-mess-detector-for-eclipse)

I have the PTI Eclipse plugin installed.There is a possibility to change PDepend, CodeSniffer and UnitTestWhen I try right-clicking on any file I have a Mess Detector option as well but nothing happens when I click it. And after searching all configuration options, I and can't find any settings for PHPMD.Does anyone know how to solve it?

2013-02-05 10:32:51Z

I have the PTI Eclipse plugin installed.There is a possibility to change PDepend, CodeSniffer and UnitTestWhen I try right-clicking on any file I have a Mess Detector option as well but nothing happens when I click it. And after searching all configuration options, I and can't find any settings for PHPMD.Does anyone know how to solve it?Old question but since there still seems to be interest in it... I just installed the PTI plugin and there was no mention of PHPMD so I wonder where you get the "Mess Detection" menu item from?For me actually nothing of PTI works with Eclipse Kepler SR2. Whatever I try just nothing happens.I'd recommend you MakeGood for running PHPUnit tests in Eclipse and setting up Jenkins (including PHPMD) for your project, it takes a bit time to set up but once it is running it is just great: Template for Jenkins Jobs for PHP ProjectsWhen PHPMD runs, it first searches for a default PHP executable which must exist, and this is not set in "PHP Tools" but in "PHP":But if you had not done this, you would have gotten an error.At this point PHPMD runs, and places its output in the PHPMD view (not in the Console view), which is usually displayed at the bottom. If it does not appear at all, it might have been closed or ignored. So:Another thing that may happen is that PHPMD detects nothing (the view appears but it is empty). In that case you can check the Console view to see what happened. Otherwise, you could try and modify the phpmd.php script which is run by PTI so that it logs what it's doing (you might for example wrap the main routine in a try/catch), either to stdout or by opening a temporary file somewhere on your system.

Output an Image in PHP

steven

[Output an Image in PHP](https://stackoverflow.com/questions/1851849/output-an-image-in-php)

I have an image $file ( eg ../image.jpg )which has a mime type $typeHow can I output it to the browser?

2009-12-05 10:42:44Z

I have an image $file ( eg ../image.jpg )which has a mime type $typeHow can I output it to the browser?If you have the liberty to configure your webserver yourself, tools like mod_xsendfile (for Apache) are considerably better than reading and printing the file in PHP. Your PHP code would look like this:mod_xsendfile picks up the X-Sendfile header and sends the file to the browser itself. This can make a real difference in performance, especially for big files. Most of the proposed solutions read the whole file into memory and then print it out. That's OK for a 20kbyte image file, but if you have a 200 MByte TIFF file, you're bound to get problems.http://php.net/manual/en/function.fpassthru.phpTry this:For the next guy or gal hitting this problem, here's what worked for me:You need all of that, and only that. If your mimetype varies, have a look at PHP's mime_content_type($filepath)This is works for me! I have test it on code igniter. if i use readfile, the image won't display. Sometimes only display jpg, sometimes only big file. But after i changed it to "file_get_contents" , I get the flavour, and works!!

this is the screenshoot:

Screenshot of "secure image" from database That's the short version. There's a few extra little things you can do to make things nicer, but that'll work for you.You can use header to send the right Content-type :And readfile to output the content of the image :

And maybe (probably not necessary, but, just in case) you'll have to send the Content-Length header too :

Note : make sure you don't output anything else than your image data (no white space, for instance), or it will no longer be a valid image.You can use finfo (PHP 5.3+) to get the right MIME type.PS: You don't have to specify Content-Length, Apache will do it for you.(Expanding on the accepted answer...)  I needed to:  I accomplished this by creating a "secondary" .htaccess file in the sub-folder where the images are located.

The file contains only one line:  In the same folder, I placed the two 'original' image files (we'll call them orig.jpg and orig.gif), as well as two variations of the [simplified] script below (saved as myimage.jpg and myimage.gif)...The images render (or animate) normally and can be called in any of the normal ways for images (like an <img> tag), and will save a record of the visiting IP, while invisible to the user.The first step is retrieve the image from a particular location and then store it on to a variable for that purpose we use the functio file_get_contents() with the destination as the parameter. 

Next we set the content type of the output page as image type using the header file.

Finally we print the retrieved file using echo. 

500 Internal Server Error for php file not for html [duplicate]

KarSho

[500 Internal Server Error for php file not for html [duplicate]](https://stackoverflow.com/questions/17693391/500-internal-server-error-for-php-file-not-for-html)

My site having 4-5 static pages only. index.html & index.php both are there. index.html is working fine. If I change to index.php, it's giving 500 Internal Server Error. I don't know where is my mistake?Note: 

If I use .htaccess file with php_flag display_errors 1,It's showing Additionally, a 500 Internal Server Error error was encountered while trying to use an ErrorDocument to handle the request.If I use .htaccess file with empty,It's showing Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.And if I give ../contact-us.php, it's showing correctly.Thanks... 

2013-07-17 07:10:10Z

My site having 4-5 static pages only. index.html & index.php both are there. index.html is working fine. If I change to index.php, it's giving 500 Internal Server Error. I don't know where is my mistake?Note: 

If I use .htaccess file with php_flag display_errors 1,It's showing Additionally, a 500 Internal Server Error error was encountered while trying to use an ErrorDocument to handle the request.If I use .htaccess file with empty,It's showing Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.And if I give ../contact-us.php, it's showing correctly.Thanks... 500 Internal Server Error is shown if your php code has fatal errors but error displaying is switched off. You may try this to see the error itself instead of 500 error page:In your php file:In .htaccess file:A PHP file must have permissions set to 644. Any folder containing PHP files and PHP access (to upload files, for example) must have permissions set to 755. PHP will run a 500 error when dealing with any file or folder that has permissions set to 777!I know this question is old, however I ran into this problem on Windows 8.1 while trying to use .htaccess files for rewriting. My solution was simple, I forgot to modify the following line in httpd.conftoRestarted the apache monitor, now all works well. Just posting this as an answer because someone in the future may run across the same issue with a simple fix.Good luck!I was having this problem because I was trying to connect to MySQL but I didn't have the required package. I figured it out because of @Amadan's comment to check the error log. In my case, I was having the error: Call to undefined function mysql_connect()If your PHP file has any code to connect with a My-SQL db then you might need to install php5-mysql first. I was getting this error because I hadn't installed it. All my file permissions were good. In Ubuntu, you can install it by the following command:sudo apt-get install php5-mysqlIt was changing the line endings (from Windows CRLF to Unix LF) in the .htaccess file that fixed it for me.Google guides me here but it didn't fix mine, this is a very general question and there are various causes, so I post my problem and solution here for reference in case anyone might read this later.Another possible cause of 500 error is syntax error in header(...) function, like this one:Be aware there should be space between server protocol and status code, so it should be:So I suggest check your http header call if you have it in your code.

where can I find the php.ini for php-cli

Elzo Valugi

[where can I find the php.ini for php-cli](https://stackoverflow.com/questions/3057110/where-can-i-find-the-php-ini-for-php-cli)

It appears that the php command line is using a different php.ini from the main php interpreter. I am using Ubuntu 10.4. My problem is that in the main php.ini I have included an extra path for an external library, but in the cli version this is not present, and so I have a path inclusion error.thanks

2010-06-16 20:55:52Z

It appears that the php command line is using a different php.ini from the main php interpreter. I am using Ubuntu 10.4. My problem is that in the main php.ini I have included an extra path for an external library, but in the cli version this is not present, and so I have a path inclusion error.thanksJust ask PHP:$ php -i |grep php\.iniBetter yet:

$ php --iniThis will also show all extra *.ini files loaded (usually hanging around in some conf.d dir in debian):Note that this was about php-cli, php-cgi does not have this afaik.At my last job, I got in the habit of specifying my ini file on every execution... You can find php.ini using the below command. in LINUXor/etc/php5/cli/php.iniInteresting in windows is that in both tests (on apache with phpinfo() and in cli with php --ini), the configuration file path is c:\windows. More info hereI had the same problem. Simply check owner and permissions from every files in /etc/php5/conf.d/. It has to be owned by root and readeable by anymone.

php: catch exception and continue execution, is it possible?

Kirzilla

[php: catch exception and continue execution, is it possible?](https://stackoverflow.com/questions/2132759/php-catch-exception-and-continue-execution-is-it-possible)

Is it possible to catch exception and continue execution of script?

2010-01-25 14:07:28Z

Is it possible to catch exception and continue execution of script?Sure, just catch the exception where you want to continue execution...Of course this has the problem of silently dropping what could be a very important error. SomeOperation() may fail causing other subtle, difficult to figure out problems, but you would never know if you silently drop the exception.Yes but it depends what you want to execute:E.g.c() will always be executed. But if a() throws an exception, b() is not executed.Only put the stuff in to the try block that is depended on each other. E.g. b depends on some result of a it makes no sense to put b after the try-catch block.Sure:You might want to go have a read of the PHP documentation on Exceptions.Yes.however note that php also has error codes separate from exceptions, a legacy holdover from before php had oop primitives. Most library builtins still raise error codes, not exceptions. To ignore an error code call the function prefixed with @:use the new interface Throwable Another angle on this is returning an Exception, NOT throwing one, from the processing code.I needed to do this with a templating framework I'm writing. If the user attempts to access a property that doesn't exist on the data, I return the error from deep within the processing function, rather than throwing it.Then, in the calling code, I can decide whether to throw this returned error, causing the try() to catch(), or just continue:The result of this is I still get the context of the original error, even though it was thrown at the top.Another option might be to return a custom NullObject or a UnknownProperty object and compare against that before deciding to trip the catch(), but as you can re-throw errors anyway, and if you're fully in control of the overall structure, I think this is a neat way round the issue of not being able to continue try/catches.An old question, but one I had in the past when coming away from VBA scipts to php, where you could us "GoTo" to re-enter a loop "On Error" with a "Resume" and away it went still processing the function.

In php, after a bit of trial and error, I now use nested try{} catch{} for critical versus non critical processes, or even for interdependent class calls so I can trace my way back to the start of the error.

e.g. if function b is dependant on function a, but function c is a nice to have but should not stop the process, and I still want to know the outcomes of all 3 regardless, here's what I do:Now I can loop through my result array for each key and assess the outcomes.

If there is a critical failure for a() or b().

I still have a point of reference on how far it got before a critical failure occurred within the $resultArr and if the exception handler is set correctly, I know if it was a() or b() that failed.

If c() fails, loop keeps going. If c() failed at various points, with a bit of extra post loop logic I can even find out if c() worked or had an error on each iteration by interrogating $resultArr[$key][2].

Run process with realtime output in PHP

Maksim Vi.

[Run process with realtime output in PHP](https://stackoverflow.com/questions/1281140/run-process-with-realtime-output-in-php)

I am trying to run a process on a web page that will return its output in realtime. For example if I run 'ping' process it should update my page every time it returns a new line (right now, when I use exec(command, output) I am forced to use -c option and wait until process finishes to see the output on my web page). Is it possible to do this in php?I am also wondering what is a correct way to kill this kind of process when someone is leaving the page. In case of 'ping' process I am still able to see the process running in the system monitor (what makes sense).

2009-08-15 04:23:42Z

I am trying to run a process on a web page that will return its output in realtime. For example if I run 'ping' process it should update my page every time it returns a new line (right now, when I use exec(command, output) I am forced to use -c option and wait until process finishes to see the output on my web page). Is it possible to do this in php?I am also wondering what is a correct way to kill this kind of process when someone is leaving the page. In case of 'ping' process I am still able to see the process running in the system monitor (what makes sense).This worked for me:This is a nice way to show real time output of your shell commands:You will need this function to prevent output buffering:It doesn't work on every server I have tried it on though, I wish I could offer advice on what to look for in your php configuration to determine whether or not you should pull your hair out trying to get this type of behavior to work on your server!  Anyone else know?Here's a dummy example in plain PHP:I hope this helps others who have googled their way here.A better solution to this old problem using modern HTML5 Server Side Events is described here:http://www.w3schools.com/html/html5_serversentevents.aspExample:http://sink.agiletoolkit.org/realtime/consoleCode: https://github.com/atk4/sink/blob/master/admin/page/realtime/console.php#L40 (Implemented as a module in Agile Toolkit framework)For command-line usage:If you're trying to run a file, you may need to give it execute permissions first:Checked all answers, nothing works...Found solution HereIt works on windows (i think this answer is helpful for users searching over there)try this (tested on Windows machine + wamp server)I've tried various PHP execution commands on Windows and found that they differ quite a lot.The best (easiest) approach is:So in your C++ program you do something like (again, for other solutions see printf flushing problem):In PHP you do something like:First check whether flush() works for you. If it does, good, if it doesn't it probably means the web server is buffering for some reason, for example mod_gzip is enabled.For something like ping, the easiest technique is to loop within PHP, running "ping -c 1" multiple times, and calling flush() after each output. Assuming PHP is configured to abort when the HTTP connection is closed by the user (which is usually the default, or you can call ignore_user_abort(false) to make sure), then you don't need to worry about run-away ping processes either.If it's really necessary that you only run the child process once and display its output continuously, that may be more difficult -- you'd probably have to run it in the background, redirect output to a stream, and then have PHP echo that stream back to the user, interspersed with regular flush() calls.If you're looking to run system commands via PHP look into, the exec documentation.I wouldn't recommend doing this on a high traffic site though, forking a process for each request is quite a hefty process. Some programs provide the option of writing their process id to a file such that you could check for, and terminate the process at will, but for commands like ping, I'm not sure that's possible, check the man pages.You may be better served by simply opening a socket on the port you expect to be listening (IE: port 80 for HTTP) on the remote host, that way you know everything is going well in userland, as well as on the network.If you're attempting to output binary data look into php's header function, and ensure you set the proper content-type, and content-disposition. Review the documentation, for more information on using/disabling the output buffer.Try changing the php.ini file set "output_buffering = Off". You should be able to get the real time output on the page 

Use system command instead of exec.. system command will flush the outputwhy not just pipe the output into a log file and then use that file to return content to the client. not quite real time but perhaps good enough?

Using Composer's Autoload

Chris R

[Using Composer's Autoload](https://stackoverflow.com/questions/12818690/using-composers-autoload)

I have been looking around the net with no luck on this issue. I am using composer's autoload with this code in my composer.json:But I need to autoload at a higher level than the vendor folder.Doing something like this does not work:Does anyone know a fix or how I can do this?

2012-10-10 11:53:55Z

I have been looking around the net with no luck on this issue. I am using composer's autoload with this code in my composer.json:But I need to autoload at a higher level than the vendor folder.Doing something like this does not work:Does anyone know a fix or how I can do this?Every package should be responsible for autoloading itself, what are you trying to achieve with autoloading classes that are out of the package you define?One workaround if it's for your application itself is to add a namespace to the loader instance, something like this:The composer documentation states that:Assuming your "src" dir resides at the same level as "vendor" dir:the following config is absolutely correct:but you must re-update/install dependencies to make it work for you, i.e. run:This command will get the latest versions of the dependencies and update the file "vendor/composer/autoload_namespaces.php" to match your configuration.Also as noted by @Dom, you can use composer dump-autoload to update the autoloader without having to go through an update.There also other ways to use the composer autoload features. Ways that can be useful to load packages without namespaces or packages that come with a custom autoload function.For example if you want to include a single file that contains an autoload function as well you can use the "files" directive as follows:And inside the Swagger.php file we got:https://getcomposer.org/doc/04-schema.md#filesOtherwise you may want to use a classmap reference:https://getcomposer.org/doc/04-schema.md#classmapNote: during your tests remember to launch the composer dump-autoload command or you won't see any change!Happy autoloading =)In my opinion, Sergiy's answer should be the selected answer for the given question. I'm sharing my understanding.I was looking to autoload my package files using composer which I have under the dir structure given below.I'm using psr-4 autoloading specification.Had to add below lines to the project's composer.json. I intend to place my class files inside src/App , src/Test and library directory.This is pretty much self explaining. OrgName\AppType\AppName is my intended namespace prefix.

e.g for class User in src/App/Controller/Provider/User.php -Also notice "src/App", "src/Test" .. are from your web-root that is where your composer.json is.

Nothing to do with the vendor dir. take a look at vendor/autoload.php Now if composer is installed properly all that is required is

#composer updateAfter composer update my classes loaded successfully.

What I observed is that composer is adding a line in vendor/composer/autoload_psr4.phpThis is how composer maps.

For psr-0 mapping is in vendor/composer/autoload_classmap.phpJust create a symlink in your src folder for the namespace pointing to the folder containing your classes...Your autoload in composer will look the same...And your AppName namespaced classes will start a directory up from your current working directory in a src folder now... that should work.The autoload config does start below the vendor dir. So you might want change the vendor dir, e.g.Or isn't this possible in your project?

How do I enable --enable-soap in php on linux?

netrox

[How do I enable --enable-soap in php on linux?](https://stackoverflow.com/questions/11584426/how-do-i-enable-enable-soap-in-php-on-linux)

That's much the question. I have PHP 5.2.9 on Apache and I cannot upgrade PHP. Is there a way for me to enable SOAP in PHP 5.2.9? The PHP manual did not help at all when it said, "To enable SOAP support, configure PHP with --enable-soap ."  How do I configure? 

2012-07-20 17:46:22Z

That's much the question. I have PHP 5.2.9 on Apache and I cannot upgrade PHP. Is there a way for me to enable SOAP in PHP 5.2.9? The PHP manual did not help at all when it said, "To enable SOAP support, configure PHP with --enable-soap ."  How do I configure? Getting SOAP working usually does not require compiling PHP from source. I would recommend trying that only as a last option.For good measure, check to see what your phpinfo says, if anything, about SOAP extensions:to ensure that it is the PHP extension that is missing.Assuming you do not see anything about SOAP in the phpinfo, see what PHP SOAP packages might be available to you.In Ubuntu/Debian you can search with:or in RHEL/Fedora you can search with:There are usually two PHP SOAP packages available to you, usually php-soap and php-nusoap. php-soap is typically what you get with configuring PHP with --enable-soap.In Ubuntu/Debian you can install with:Or in RHEL/Fedora you can install with:After the installation, you might need to place an ini file and restart Apache.In case that you have Ubuntu in your machine, the following steps will help you: As far as your question goes: no, if activating from .ini is not enough and you can't upgrade PHP, there's not much you can do. Some modules, but not all, can be added without recompilation (zypper install php5-soap, yum install php-soap). If it is not enough, try installing some PEAR class for interpreted SOAP support (NuSOAP, etc.).In general, the double-dash --switches are designed to be used when recompiling PHP from scratch.You would download the PHP source package (as a compressed .tgz tarball, say), expand it somewhere and then, e.g. under Linux, run the configure scriptThe configure command used by your PHP may be shown with phpinfo(). Repeating it identical should give you an exact copy of the PHP you now have installed. Adding --enable-soap will then enable SOAP in addition to everything else.That said, if you aren't familiar with PHP recompilation, don't do it. It also requires several ancillary libraries that you might, or might not, have available - freetype, gd, libjpeg, XML, expat, and so on and so forth (it's not enough they are installed; they must be a developer version, i.e. with headers and so on; in most distributions, having libjpeg installed might not be enough, and you might need libjpeg-dev also).I have to keep a separate virtual machine with everything installed for my recompilation purposes.

php exec command (or similar) to not wait for result

greg

[php exec command (or similar) to not wait for result](https://stackoverflow.com/questions/3819398/php-exec-command-or-similar-to-not-wait-for-result)

I have a command I want to run, but I do not want PHP to sit and wait for the result.Is it possible to have PHP not wait for the result.. i.e. just kick it off and move along to the next command.I cant find anything, and not sure its even possible.  The best I could find was someone making a CRON job to start in a minute.

2010-09-29 06:52:53Z

I have a command I want to run, but I do not want PHP to sit and wait for the result.Is it possible to have PHP not wait for the result.. i.e. just kick it off and move along to the next command.I cant find anything, and not sure its even possible.  The best I could find was someone making a CRON job to start in a minute.From the documentation:You can run the command in the background by adding a & at the end of it as:But doing this alone will hang your script because:So you can redirect the stdout of the command to a file, if you want to see it later or to /dev/null if you want to discard it as:This uses wget to notify a URL of something without waiting.This uses ls to update a log without waiting.the nohup allows your_command to continue even though the process that launched may terminate first.  If it does, the the SIGNUP signal will be sent to your_command causing it to terminate (unless it catches that signal and ignores it).There are two possible ways to implement it.

The easiest way is direct result to dev/nullBut in case you have any other operations to be performed you may consider ignore_user_abort

In this case the script will be running even after you close connection.I know this question has been answered but the answers i found here didn't work for my scenario ( or for Windows ).I am using windows 10 laptop with PHP 7.2 in Xampp v3.2.4.This worked perfectly for me.I hope it will help someone with windows. Cheers.

How to to send mail using gmail in Laravel?

SRENG Khorn

[How to to send mail using gmail in Laravel?](https://stackoverflow.com/questions/32515245/how-to-to-send-mail-using-gmail-in-laravel)

I try again and again to test sending an email from localhost but I still cannot. I don't know anymore how to do it. I try search to find solution but I cannot find one. I edited config/mail.php: and I edited .env file like this already:It still produced error like this:

2015-09-11 04:03:16Z

I try again and again to test sending an email from localhost but I still cannot. I don't know anymore how to do it. I try search to find solution but I cannot find one. I edited config/mail.php: and I edited .env file like this already:It still produced error like this:

first login to your gmail account and under My account > Sign In And Security > Sign In to google, enable two step verification, then you can generate app password, and you can use that app password in .env file.Your .env file will then look something like thisDon't forget to run php artisan config:cache after you make changes in your .env file.Try using sendmail instead of smtp driver (according to these recommendations: http://code.tutsplus.com/tutorials/sending-emails-with-laravel-4-gmail--net-36105)All you have to do is just edit in you.env file, that's it.  for app password goto 

https://support.google.com/accounts/answer/185833?hl=enand genearate your app pasword and save for future use. because once you generate app password you cannot re-edit password or change same app password.(you can create multiple app password)This is working sample that i have tried :Open your mail.php under config folder then fill with this option :Open your .env file under root project. Also edit this file following above

option suchAfter that clear your config by running this command Restart your local serverTry visit your route with controller contains mail function at first

time it still error Authentication Required. You need to login via

your gmail account to authorize untrusted connection. Visit this link

to authorizeif you still could be able to send mail after setting all configs right and get forbidden or timeout errors you could set the allow less secure apps to access your account in gmail. you can follow how to hereyour MAIL_PASSWORD=must a APPpasword 

after change the .env stop the server then clear configuratios cahce php artisan config:cahce and start the server againreference

Cannot send message without a sender address in laravel 5.2 I have set .env and mail.php bothIf you're developing on an XAMPP, then you'll need an SMTP service to send the email. Try using a MailGun account. It's free and easy to use.The problem for me is that for some reason the username/password came NULL from mail config. 

To check that before sending a email check with the follow code:If your username/password came nulled just set with: in bluehost i could not reset password; with this driver worked:If you are using email password then you should replace it with app password.for setting APP password you need to enable the 2 step authentication before setting password which can be disabled later.Also make sure that you have allowed less secure app in setting section.For additional info you can follow how to hereWorking for me after trying various combinations.It is necessary to generate application password https://myaccount.google.com/security and us it as MAIL_PASSWORD environment variable. I found about about this by checking error code from google server, which was use-full and lead me to this webpage.You can also try adding to laravel these 2 lines:After this run this comand to flush mail cache config:MAIL_DRIVER=smtp 

MAIL_HOST=smtp.gmail.com

MAIL_PORT=587

MAIL_USERNAME=yourmail@gmail.com

MAIL_PASSWORD=yourpassword

MAIL_ENCRYPTION=tls

MAIL_FROM_NAME='Name'allow less secure apps to access your account in the Gmail security setting.Just change MAIL_ENCRYPTION=null to MAIL_ENCRYPTION=tlsAnd run this command "php artisan config:cache"

PHPUnit best practices to organize tests

enricog

[PHPUnit best practices to organize tests](https://stackoverflow.com/questions/8313283/phpunit-best-practices-to-organize-tests)

I am currently going to start from scratch with the phpunit tests for a project. So I was looking into some projects (like Zend) to see how they are doing things and how they organizing their tests.Most things are pretty clear, only thing I have some problems with is how to organize the test suites properly.

Zend has an AllTests.php from which loads others test suites.

Tough looking at the class it is useing PHPUnit_Framework_TestSuite to create a suite object and then add the other suites to it, but if I look in the PHPUnit docs for organizing tests in PHPUnit versions after 3.4 there is only a description for XML or FileHierarchy. The one using classes to organize the tests was removed.

I haven't found anything that this method is deprecated and projects like Zend are still using it.But if it is deprecated, how would I be able to organize tests in the same structure with the xml configuration? Executing all tests is no problem, but how would I organize the tests (in the xml) if I only wanted to execute a few tests. Maybe creating several xmls where I only specify a few tests/test suites to be run?  So if I would want to only test module1 and module2 of the application, would I have an extra xml for each and defining test suites only for those modules (classes used by the module) in it. And also one that defines a test suite for all tests?  Or would it be better to use the @group annotation on the specific tests to mark them to be for module1 or module2?  Thanks in advance for pointing me to some best practices.

2011-11-29 15:22:49Z

I am currently going to start from scratch with the phpunit tests for a project. So I was looking into some projects (like Zend) to see how they are doing things and how they organizing their tests.Most things are pretty clear, only thing I have some problems with is how to organize the test suites properly.

Zend has an AllTests.php from which loads others test suites.

Tough looking at the class it is useing PHPUnit_Framework_TestSuite to create a suite object and then add the other suites to it, but if I look in the PHPUnit docs for organizing tests in PHPUnit versions after 3.4 there is only a description for XML or FileHierarchy. The one using classes to organize the tests was removed.

I haven't found anything that this method is deprecated and projects like Zend are still using it.But if it is deprecated, how would I be able to organize tests in the same structure with the xml configuration? Executing all tests is no problem, but how would I organize the tests (in the xml) if I only wanted to execute a few tests. Maybe creating several xmls where I only specify a few tests/test suites to be run?  So if I would want to only test module1 and module2 of the application, would I have an extra xml for each and defining test suites only for those modules (classes used by the module) in it. And also one that defines a test suite for all tests?  Or would it be better to use the @group annotation on the specific tests to mark them to be for module1 or module2?  Thanks in advance for pointing me to some best practices.I'll start of by linking to the manual and then going into what I've seen and heard in the field.Organizing phpunit test suitesMy recommended approach is combining the file system with an xml config.with a phpunit.xml with a simple:you can split the testsuites if you want to but thats a project to project choice.Running phpunit will then execute ALL tests and running phpunit tests/unit/module1 will run all tests of module1.The most common approach here is to mirror your source/ directory structure in your tests/unit/ folder structure.You have one TestClass per ProductionClass anyways so it's a good approach in my book.It's not going to work anyways if you have more than one test class in one file so avoid that pitfall.It just makes writing the test more verbose as you need an additional use statement so I'd say the testClass should go in the same namespace as the production class but that is nothing PHPUnit forces you to do. I've just found it to be easier with no drawbacks.For example phpunit --filter Factory executes all FactoryTests while phpunit tests/unit/logger/ executes everything logging related.You can use @group tags for something like issue numbers, stories or something but for "modules" I'd use the folder layout.It can be useful to create multiple xml files if you want to have:As it is related to starting a new project with tests:You don't need any sort of auto loading for your tests. PHPUnit will take care of that.Use the <phpunit bootstrap="file"> attribute to specify your test bootstrap. tests/bootstrap.php is a nice place to put it. There you can set up your applications autoloader and so on (or call your applications bootstrap for that matter).Basic Directory Structure:I have been experimenting with keeping the test code right next to the code being tested, literally in the same directory with a slightly different file name from the file with the code it is testing. So far I am liking this approach. The idea is you don't have to spend time and energy keeping the directory structure in sync between your code and your test code. So if you change the name of the directory the code is in, you don't then also need to go and find and change the directory name for the test code. This also causes you to spend less time looking for the test code that goes with some code as it is right there next to it. This even makes it less of a hassle to create the file with the test code to begin with because you don't have to first find the directory with the tests, possibly create a new directory to match the one you are creating tests for, and then create the test file. You just create the test file right there.One huge advantage of this is it means the other employees (not you because you would never do this) will be less likely to avoid writing test code to begin with because it is just too much work. Even as they add methods to existing classes they will be less likely to not feel like adding tests to the existing test code, because of the low friction of finding the test code.One disadvantage is this makes it harder to release your production code without the tests accompanying it. Although if you use strict naming conventions it still might be possible. For example, I have been using ClassName.php, ClassNameUnitTest.php, and ClassNameIntegrationTest.php. When I want to run all the unit tests, there is a suite that looks for files ending in UnitTest.php. The integration test suite works similarly. If I wanted to, I could use a similar technique to prevent the tests from getting released to production.Another disadvantage of this approach is when you are just looking for actual code, not test code, it takes a little more effort to differentiate between the two. But I feel this is actually a good thing as it forces us to feel the pain of the reality that test code is code too, it adds its' own maintenance costs, and is just as vitally a part of the code as anything else, not just something off to the side somewhere.One test class per class:This is far from experimental for most programmers, but it is for me. I am experimenting with only having one test class per class being tested. In the past I had an entire directory for each class being tested and then I had several classes inside that directory. Each test class setup the class being tested in a certain way, and then had a bunch of methods each one with a different assertion made. But then I started noticing certain conditions I would get these objects into had stuff in common with other conditions it got into from other test classes. The duplication become too much to handle, so I started creating abstractions to remove it. The test code became very difficult to understand and maintain. I realized this, but I couldn't see an alternative that made sense to me. Just having one test class per class seemed like it would not be able to test nearly enough situations without becoming overwhelming to have all that test code inside one test class. Now I have a different perspective on it. Even if I was right, this is a huge dampener on other programmers, and myself, wanting to write and maintain the tests. Now I am experimenting with forcing myself to have one test class per class being tested. If I run into too many things to test in that one test class, I am experimenting with seeing this as an indication that the class being tested is doing too much, and should be broken up into multiple classes. For removing duplication I am trying to stick to simpler abstractions as much as possible that allows everything to exist in one readable test class.UPDATE

I am still using and liking this approach, but I have found a very good technique for reducing the amount of test code and the amount of duplication. It is important to write reusable assertion methods inside the test class itself that gets heavily used by the test methods in that class. It helps me to come up with the right types of assertion methods if I think of them as internal DSLs (something Uncle Bob promotes, well actually he promotes actually making internal DSLs). Sometimes you can take this DSL concept even further (actually make a DSL) by accepting a string parameter that has a simple value that refers to what kind of test you are trying to perform. For example, one time I made a reusable asssertion method that accepted a $left, $comparesAs, and a $right parameter. This made the tests very short and readable as the code read something like $this->assertCmp('a', '<', 'b').Honestly, I can't emphasize that point enough, it is the entire foundation of making writing tests something that is sustainable (that you and the other programmers want to keep doing). It makes it possible for the value that tests add to more than what they take away. The point is not that you need to use that exact technique, the point is you need to use some kind of reusable abstractions that allow you to write short and readable tests. It might seem like I'm getting off topic from the question, but I'm really not. If you don't do this, you will eventually fall into the trap of needing to create multiple test classes per class being tested, and things really break down from there.

PHP - Using PDO with IN clause array

iRector

[PHP - Using PDO with IN clause array](https://stackoverflow.com/questions/14767530/php-using-pdo-with-in-clause-array)

I'm using PDO to execute a statement with an IN clause that uses an array for it's values:

The above code works perfectly fine, but my question is why this doesn't:This code will return the item who's my_value equals the first item in the $in_array (1), but not the remaining items in the array (2, and 3).

2013-02-08 07:18:07Z

I'm using PDO to execute a statement with an IN clause that uses an array for it's values:

The above code works perfectly fine, but my question is why this doesn't:This code will return the item who's my_value equals the first item in the $in_array (1), but not the remaining items in the array (2, and 3).PDO is not good with such things. You need to create a string with question marks dynamically and insert into query.In case there are other placeholders in the query, you could use the following approach (the code is taken from my PDO tutorial):You could use array_merge() function to join all the variables into a single array, adding your other variables in the form of arrays, in the order they appear in your query:In case you are using named placeholders, the code would be a little more complex, as you have to create a sequence of the named placeholders, e.g. :id0,:id1,:id2. So the code would be:Luckily, for the named placeholders we don't have to follow the strict order, so we can merge our arrays in any order.Variable substitution in PDO prepared statements doesn't support arrays.  It's one for one.  You can get around that problem by generating the number of placeholders you need based on the length of the array.  As PDO doesn't seem to provide a good solution, you might as well consider using DBAL, which mostly follows PDO's API, but also adds some useful features http://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/data-retrieval-and-manipulation.html#list-of-parameters-conversionThere are probably some other packages out there that don't add complexity and don't obscure the interaction with the database (like most ORM do), but at the same time make small typical tasks bit easier. As I understand it it is because PDO will treat the $in_values contents as a single item and will quite it accordingly.  PDO will see 1,2,3 as a single string so the query will look something like SELECT * FROM table WHERE my_value IN ("1,2,3")You may think that changing the implode to have quotes and commas will fix it, but it will not.  PDO will see the quotes and change how it quotes the string.As to why your query matches the first value, I have no explanation.I've just come up against this problem and coded a small wrapper.  It's not the prettiest or best code I'm sure, but it might help somebody so here it is:E.g, passing these in:Becomes:It's not bulletproof, but as a sole dev for my needs it does the job fine, so far anyway.Here is a solution for unnamed placeholders (?). If you pass $sql with question mark like "A=? AND B IN(?) " and $args where some of the elements are arrays like [1, [1,2,3]] it will return SQL string with appropriate number of placeholders - "A=? AND B IN(?,?,?)". 

It needs $args parameter only to find which element is array and how many placeholders it needs.

You can find the small PDO extension class with this method that will run your query:

https://github.com/vicF/pdo/blob/master/src/PDO.phpAn alternative version of PHP Delusions (@your-common-sense) using closures:

Can I call curl_setopt with CURLOPT_HTTPHEADER multiple times to set multiple headers?

hakre

[Can I call curl_setopt with CURLOPT_HTTPHEADER multiple times to set multiple headers?](https://stackoverflow.com/questions/15134575/can-i-call-curl-setopt-with-curlopt-httpheader-multiple-times-to-set-multiple-he)

Can I call curl_setopt with CURLOPT_HTTPHEADER multiple times to set multiple headers?

2013-02-28 11:38:25Z

Can I call curl_setopt with CURLOPT_HTTPHEADER multiple times to set multiple headers?Following what curl does internally for the request (via the method outlined in this answer to "Php - Debugging Curl") answers the question: No, it is not possible to use the curl_setopt call with CURLOPT_HTTPHEADER. The second call will overwrite the headers of the first call.Instead the function needs to be called once with all headers:Related (but different) questions are:Other type of format : 

Who Add「_」Single Underscore Query Parameter?

ZZ Coder

[Who Add「_」Single Underscore Query Parameter?](https://stackoverflow.com/questions/3687729/who-add-single-underscore-query-parameter)

I have a PHP server running on Apache, I get lots of request looks like this,The _ parameter is mysteriously added to the request. I am trying to find out who is doing that.There is a NetScaler running in front of Apache.

2010-09-10 19:32:35Z

I have a PHP server running on Apache, I get lots of request looks like this,The _ parameter is mysteriously added to the request. I am trying to find out who is doing that.There is a NetScaler running in front of Apache.jQuery adds a parameter like that to get around IE's caching.edit:

it only adds it for get requests, and only if the option cache is false:It could be the JQuery CacheBuster parameter.Resources :Probably it's a dummy parameter added by the reverse proxy to force non-cached content to be served.1283458471913 is a unix timestamp in ms, probably a bot/proxy making sure that they get a fresh page and not a cached version.  Could also be jQuery which would cause this for AJAX request of you have the nocache attribute set to true.

How to create new property dynamically

Alex

[How to create new property dynamically](https://stackoverflow.com/questions/8707235/how-to-create-new-property-dynamically)

How can I create a property from a given argument inside a object's method?And I want to be able to access the property like:Also is it possible that I could make the property public/protected/private ? I know that in this case it should be public, but I may want to add some magik methods to get protected properties and stuff :)do you think it's a good idea?

2012-01-03 02:15:46Z

How can I create a property from a given argument inside a object's method?And I want to be able to access the property like:Also is it possible that I could make the property public/protected/private ? I know that in this case it should be public, but I may want to add some magik methods to get protected properties and stuff :)do you think it's a good idea?There are two methods to doing it.One, you can directly create property dynamically from outside the class:Or if you wish to create property through your createProperty method:Property overloading is very slow. If you can, try to avoid it. Also important is to implement the other two magic methods:__isset();

__unset();If you don't want to find some common mistakes later on when using these object "attributes"Here are some examples:http://www.php.net/manual/en/language.oop5.overloading.php#language.oop5.overloading.membersEDITED after Alex comment:You can check yourself the differences in time between both solutions (change $REPEAT_PLEASE)The following example is for those who do not want to declare an entire class.Use the syntax: $object->{$property}

              where $property is a string variable and 

              $object can be this if it is inside the class or any instance objectLive example:  http://sandbox.onlinephpfunctions.com/code/108f0ca2bef5cf4af8225d6a6ff11dfd0741757fResult: 50

How to get exact browser name and version?

Awan

[How to get exact browser name and version?](https://stackoverflow.com/questions/8754080/how-to-get-exact-browser-name-and-version)

I have tried some solutions but I am unable to get exact name and version:I am trying following code:Output of above code:But I am using:So I can find in Chrome/11.0.696.68 in output string but it is also showing some other browsers names that is confusing to extract exact browser name/version from string.

2012-01-06 06:09:34Z

I have tried some solutions but I am unable to get exact name and version:I am trying following code:Output of above code:But I am using:So I can find in Chrome/11.0.696.68 in output string but it is also showing some other browsers names that is confusing to extract exact browser name/version from string.Use get_browser()From Manual:Will return:this JavaScript give you the browser name and the version,Got an awesome function here.I would like to suggest you this amazing class. This worked very well for me.http://chrisschuld.com/projects/browser-php-detecting-a-users-browser-from-php.html/I am publishing the code I used with the copyright notice of original author. You can get latest code from the link above.Use get_browser() function.It can give you output like this:This is my code, and it works very well without any conflict:Use 51Degrees.com device detection solution to detect browser name, vendor and version.First, follow the 4-step guide to incorporate device detector in to your project. When I say incorporate I mean download archive with PHP code and database file, extract them and include 2 files. That's all there is to do to incorporate.Once that's done you can use the following properties to get browser information:

$_51d['BrowserName'] - Gives you the name of the browser (Safari, Molto, Motorola, MStarBrowser etc).

$_51d['BrowserVendor'] - Gives you the company who created browser.

$_51d['BrowserVersion'] - Version number of the browser

CodeIgniter - how to catch DB errors?

StackOverflowNewbie

[CodeIgniter - how to catch DB errors?](https://stackoverflow.com/questions/7843406/codeigniter-how-to-catch-db-errors)

Is there a way to make CI throw an exception when it encounters a DB error instead of displaying a message like:NOTE: I only want this to happen in one controller. In the other controllers, I'm happy for it to display the DB error messages.

2011-10-20 23:22:21Z

Is there a way to make CI throw an exception when it encounters a DB error instead of displaying a message like:NOTE: I only want this to happen in one controller. In the other controllers, I'm happy for it to display the DB error messages.Try these CI functionsUPDATEFunctions are deprecated, use "error()" instead:Maybe this:In Codeigniter 3.0 (CI3), all you have to do is $this->db->error()You must turn debug off for database in config/database.php -> It is better for your website security. I know this thread is old, but just in case there's someone else having this issue. This is a trick I used without touching the CI db classes. Leave your debug on and in your error view file, throw an exception.So in you db config, you have : Then in your db error view file, mine is in application/errors/error_db.php replace all content with the following:Since the view file will be called, the error will always get thrown as an exception, you may later add different views for different environment.I have created an simple library for that: The example query:And I can catch it this way in my controller:an example that worked for me:BestPut this code in a file called MY_Exceptions.php in application/core folder:It will make all the Code Igniter errors to be treated as Exception (CiError). Then, turn all your database debug on:Use itIt is better for finding error.After completing your site.

Close the error messages 

using itYou will change it in your config folder's database.php Disable debugging of errors.If one uses PDO, additional to all the answers above.I log my errors silently as belowIn sybase_driver.phpAdd and modify the following methods in the same sybase_driver.php fileImplement in the function of a controller.In the log you can check the codes and messages sent by the database server.

Get first element in PHP stdObject

Drew Baker

[Get first element in PHP stdObject](https://stackoverflow.com/questions/9474446/get-first-element-in-php-stdobject)

I have an object (stored as $videos) that looks like thisI want to get the ID of just that first element, without having to loop over it.If it were an array, I would do this:It used to work as this:But now I get an error "Cannot use object of type stdClass as array..." on the line shown above. Possibly due to a PHP upgrade.So how do I get to that first ID without looping? Is it possible?Thanks!

2012-02-28 00:10:58Z

I have an object (stored as $videos) that looks like thisI want to get the ID of just that first element, without having to loop over it.If it were an array, I would do this:It used to work as this:But now I get an error "Cannot use object of type stdClass as array..." on the line shown above. Possibly due to a PHP upgrade.So how do I get to that first ID without looping? Is it possible?Thanks!Update 2019Simply iterate its using {}Example:This way your object is not destroyed and you can easily iterate through object.For PHP 5.6 and below use thisBoth array() and the stdClass objects can be accessed using the 

current() key() next() prev() reset() end() 

functions.So, if your object looks likeThen you can just do;If you need the key for some reason, you can do;Hope that works for you. :-)

No errors, even in super-strict mode, on PHP 5.4Correct:much easier:$videos->{0}->id worked for me.Since $videos and {0} both are objects, so we have to access id with  $videos->{0}->id. The curly braces are required around 0, as omitting the braces will produce a syntax error : unexpected '0', expecting identifier or variable or '{' or '$'.I'm using PHP 5.4.3.In my case, neither $videos{0}->id and $videos{0}['id'] worked and shows error : Cannot use object of type stdClass as array.You could loop on the object maybe and break in the first loop...

Something likePlaying with Php interactive shell, Php 7:Only current is working with object.

Laravel update model with unique validation rule for attribute

Tom Macdonald

[Laravel update model with unique validation rule for attribute](https://stackoverflow.com/questions/22405762/laravel-update-model-with-unique-validation-rule-for-attribute)

I have a laravel User model which has a unique validation rule on username and email. In my Repository, when I update the model, I revalidate the fields, so as to not  have a problem with required rule validation:This fails in testing with Is there a way of fixing this elegantly?

2014-03-14 13:01:37Z

I have a laravel User model which has a unique validation rule on username and email. In my Repository, when I update the model, I revalidate the fields, so as to not  have a problem with required rule validation:This fails in testing with Is there a way of fixing this elegantly?Append the id of the instance currently being updated to the validator.If updating, force the unique rule to ignore a given id:If creating, proceed as usual:Another elegant way...In your model, create a static function:Validation on create:Validation on update:Validation on update, with some additional rules:Nice.Working within my question:is what I did, based on the accepted answer above.EDIT: With Form Requests, everything is made simpler:You just need to pass the UpdateUserRequest to your update method, and be sure to POST the model id.Unique Validation With Different Column ID In LaravelLaravel 5 compatible and generic way:I just had the same problem and solved it in a generic way. If you create an item it uses the default rules, if you update an item it will check your rules for  :unique and insert an exclude automatically (if needed).Create a BaseModel class and let all your models inherit from it:You now define your rules in your model like you are used to:And validate them in your Controller. If the model does not validate, it will automatically redirect back to the form with the corresponding validation errors. If no validation errors occurred it will continue to execute the code after it.That's it! :) Note that on creation we call Role::getRules() and on edit we call $role->getUpdateRules().I have BaseModel class, so I needed something more generic.In user class let's suppose I need only email and name to be validated:I tested this with phpunit and works fine. I hope will help someone, even if for getting a better idea. Thanks for sharing yours as well.

(tested on Laravel 5.0)A simple example for roles update.or what you could do in your Form Request is (for Laravel 5.3+)i've done it in Laravel 5.6 and it worked.I am calling different validation classes for Store and Update. In my case I don't want to update every fields, so I have baseRules for common fields for Create and Edit. Add extra validation classes for each. I hope my example is helpful. I am using Laravel 4.Model: Controller:

Store method:Update method:I had the same problem.

What I've done: add in my view hidden field with id of a model and in validator check the unique, only if I've get some id from view.You can trying code bellowIf you have another column which is being used as foreign key or index then you have to specify that as well in the rule like this.For a custom FormRequest and Laravel 5.7+ you can get the id of your updated model like this:Laravel 5.8 simple and easyyou can do this all in a form request with quite nicely. . . first make a field by which you can pass the id (invisible) in the normal edit form. i.e., ...

Then be sure to add the Rule class to your form request like so:... Add the Unique rule ignoring the current id like so:... Finally type hint the form request in the update method the same as you would the store method, like so: This way you won't repeat code unnecessarily :-)

What is the best way to validate a credit card in PHP?

Joe Lencioni

[What is the best way to validate a credit card in PHP?](https://stackoverflow.com/questions/174730/what-is-the-best-way-to-validate-a-credit-card-in-php)

Given a credit card number and no additional information, what is the best way in PHP to determine whether or not it is a valid number?Right now I need something that will work with American Express, Discover, MasterCard, and Visa, but it might be helpful if it will also work with other types.

2008-10-06 15:21:39Z

Given a credit card number and no additional information, what is the best way in PHP to determine whether or not it is a valid number?Right now I need something that will work with American Express, Discover, MasterCard, and Visa, but it might be helpful if it will also work with other types.There are three parts to the validation of the card number:Most cards use the Luhn algorithm for checksums:Luhn Algorithm described on WikipediaThere are links to many implementations on the Wikipedia link, including PHP:From 10 regular expressions you can't live without in PHP:Sample input:This gives usIt's probably better NOT to validate in code at your end. Send the card info right over to your payment gateway and then deal with their response. It helps them detect fraud if you don't do anything like Luhn checking first -- let them see the failed attempts.PHP CodeUsageMore theoric information can be found here:Credit Card Validation - Check DigitsChecksumWe can use the following to validate the credit card. It works perfectly for me.The luhn algorithm is a checksum that can used to validate the format of a lot of credit card formats (and also Canadian social insurance numbers...)The wikipedia article also links to many different implementations; here's a PHP one:http://planzero.org/code/bits/viewcode.php?src=luhn_check.phpsThere is a PEAR package which handles the validation of many financial numbers, also credit card validation: http://pear.php.net/package/Validate_Finance_CreditCardBy the way, here are some Test Credit Card Account Numbers by PayPal.Just throwing in some further code snippets that others may find useful (not PHP code).PYTHON (single line code; probably not that efficient)To validate:To return the required check digit:MySQL FunctionsFunctions "ccc" and "ccd" (credit-card-check and credit-card-digit)Note that the "ccc" function has an additional check where if the calculated sum is 0, the returned result will always be FALSE, so an all zero CC number will never validate as being correct (under normal behaviour, it would validate correctly). This feature can be added/removed as required; maybe useful, depending on specific requirements.Functions can then be used directly in SQL queries:This is only to make sure that the numbers are valid using some basic RegEX patterns.Note, this does not check to see if the numbers are in-use by someone.http://www.roscripts.com/How_to_validate_credit_card_numbers-106.html

Check if cookies are enabled

steveo225

[Check if cookies are enabled](https://stackoverflow.com/questions/6663859/check-if-cookies-are-enabled)

I am working on a page that requires javascript and sessions. I already have code to warn the user if javascript is disabled. Now, I want to handle the case where cookies are disabled, as the session id is stored in cookies.I have thought of just a couple ideas:What is the best way to approach this? ThanksEDITBased on the articles linked, I came up with my own approach and thought I would share, somebody else might be able to use it, maybe I will get a few critiques. (Assumes your PHP session stores in a cookie named PHPSESSID)

2011-07-12 12:02:34Z

I am working on a page that requires javascript and sessions. I already have code to warn the user if javascript is disabled. Now, I want to handle the case where cookies are disabled, as the session id is stored in cookies.I have thought of just a couple ideas:What is the best way to approach this? ThanksEDITBased on the articles linked, I came up with my own approach and thought I would share, somebody else might be able to use it, maybe I will get a few critiques. (Assumes your PHP session stores in a cookie named PHPSESSID)In JavaScript you simple test for the cookieEnabled property, which is supported in all major browsers. If you deal with an older browser, you can set a cookie and check if it exists. (borrowed from Modernizer):In PHP it is rather "complicated" since you have to refresh the page or redirect to another script. Here I will use two scripts:somescript.phpcheck.phpBut to check whether cookies are enabled using isset($_COOKIE["cookie"]) you have to refresh.

Im doing it ths way (with sessions based on cookies :)Answer on an old question, this new post is posted on April the 4th 2013To complete the answer of @misza, here a advanced method to check if cookies are enabled without page reloading. The problem with @misza is that it not always work when the php ini setting session.use_cookies is not true. Also the solution does not check if a session is already started.I made this function and test it many times with in different situations and does the job very well.Usage:Important note:

The function temporarily modify the ini setting of PHP when it not has the correct setting and restore it when it was not enabled. This is only to test if cookies are enabled. It can get go wrong when you start a session and the php ini setting session.use_cookies has an incorrect value. To be sure that the session is working correctly, check and/or set it before start a session, for example:You cannot in the same page's loading set and check if cookies is set you must perform reload page: A transparent, clean and simple approach, checking cookies availability with PHP and taking advantage of AJAX transparent redirection, hence not triggering a page reload. It doesn't require sessions either.Client-side code (JavaScript)(JQuery AJAX call can be replaced with pure JavaScript AJAX call)Server-side code (PHP)First time the script is called, the cookie is set and the script tells the browser to redirect to itself. The browser does it transparently. No page reload takes place because it's done within an AJAX call scope.The second time, when called by redirection, if the cookie is received, the script responds an HTTP 200 (with string "true"), hence the showCookiesMessage function is called.If the script is called for the second time (identified by the "reload" parameter) and the cookie is not received, it responds an HTTP 200 with string "false" -and the showCookiesMessage function gets called.You can make an Ajax Call (Note: This solution requires JQuery):example.phpajax.phpAs result an alert box appears which shows wheter cookies are enabled or not. Of course you don't have to show an alert box, from here you can take other steps to deal with deactivated cookies.JavaScriptYou could create a cookie using JavaScript and check if it exists:Or you could use a jQuery Cookie pluginPhpNot sure if the Php will work as I'm unable to test it.it is easy to detect whether the cookies is enabled:if you can get the cookie you set, the cookie is enabled, otherwise not.BTW: it is a bad idea to Embedding the session id in the links and forms, it is bad for SEO.

In my opinion, it is not very common that people dont want to enable cookies.Here is a very useful and lightweight javascript plugin to accomplish this: js-cookieWorks in all browsers, accepts any character.Cookies are Client-side and cannot be tested properly using PHP.

That's the baseline and every solution is a wrap-around for this problem.Meaning if you are looking a solution for your cookie problem, you are on the wrong way. Don'y use PHP, use a client language like Javascript.Can you use cookies using PHP? Yes, but you have to reload to make the settings to PHP 'visible'.For instance: Is a test possible to see if the browser can set Cookies with plain PHP'. The only correct answer is 'NO'.  Can you read an already set Cookie: 'YES' use the predefined $_COOKIE (A copy of the settings before you started PHP-App).

How to view query error in PDO PHP

TPSstar

[How to view query error in PDO PHP](https://stackoverflow.com/questions/8776344/how-to-view-query-error-in-pdo-php)

How can I check the mysql error for the query in above case? 

2012-01-08 08:41:15Z

How can I check the mysql error for the query in above case? You need to set the error mode attribute PDO::ATTR_ERRMODE to PDO::ERRMODE_EXCEPTION.

And since you expect the exception to be thrown by the prepare() method you should disable the PDO::ATTR_EMULATE_PREPARES* feature. Otherwise the MySQL server doesn't "see" the statement until it's executed.prints (in my case)see http://wezfurlong.org/blog/2006/apr/using-pdo-mysql/

EMULATE_PREPARES=true seems to be the default setting for the pdo_mysql driver right now.

The query cache thing has been fixed/change since then and with the mysqlnd driver I hadn't problems with EMULATE_PREPARES=false (though I'm only a php hobbyist, don't take my word on it...)*) and then there's PDO::MYSQL_ATTR_DIRECT_QUERY - I must admit that I don't understand the interaction of those two attributes (yet?), so I set them both, likeI'm using this without any additional settings:I'm guessing that your complaint is that the exception is not firing. PDO is most likely configured to not throw exceptions. Enable them with this:a quick way to see your errors whilst testing:/* Provoke an error -- the BONES table does not exist */outputthis work for me if you get this error:Fatal error: Call to undefined method mysqli::error()https://stackoverflow.com/a/32045823

Get the Year/Month/Day from a datetime in php?

Anon

[Get the Year/Month/Day from a datetime in php?](https://stackoverflow.com/questions/7247259/get-the-year-month-day-from-a-datetime-in-php)

I used date('w', timestamp) and date('w', timestamp) to know the day, date('n', timestamp) for months, etc.Now I'm using datetime and I'd like to know what are the equivalent functions to get a day, a month, etc from a datetime.PS: I know I could use UNIX_TIMESTAMP() in a SQL query but I prefer avoiding timestamps using in my code.

2011-08-30 17:26:18Z

I used date('w', timestamp) and date('w', timestamp) to know the day, date('n', timestamp) for months, etc.Now I'm using datetime and I'd like to know what are the equivalent functions to get a day, a month, etc from a datetime.PS: I know I could use UNIX_TIMESTAMP() in a SQL query but I prefer avoiding timestamps using in my code.Use DateTime with DateTime::format()Check out the manual: http://www.php.net/manual/en/datetime.format.phpWill output: 2000-01-01 00:00:00

How to join three table by laravel eloquent model

Nay

[How to join three table by laravel eloquent model](https://stackoverflow.com/questions/29165410/how-to-join-three-table-by-laravel-eloquent-model)

I have three tableI want to show articles with their category name instead of category_id and user_name instead of user_id

I try like these query It is work!But I want to do by Eloquent way. Please, how could I do?

2015-03-20 11:24:19Z

I have three tableI want to show articles with their category name instead of category_id and user_name instead of user_id

I try like these query It is work!But I want to do by Eloquent way. Please, how could I do?With Eloquent its very easy to retrieve relational data. Checkout the following example with your scenario in Laravel 5.We have three models:1) Article (belongs to user and category)2) Category (has many articles)3) User (has many articles)1) Article.php 2) Category.php 3) User.phpYou need to understand your database relation and setup in models. User has many articles. Category has many articles. Articles belong to user and category. Once you setup the relationships in Laravel, it becomes easy to retrieve the related information.For example, if you want to retrieve an article by using the user and category, you would need to write:and you can use this like so:In another case, you might need to retrieve all the articles within a category, or retrieve all of a specific user`s articles. You can write it like this:You can learn more at http://laravel.com/docs/5.0/eloquent Try: 

How to Block 100,000+ Individual IP addresses

Baba

[How to Block 100,000+ Individual IP addresses](https://stackoverflow.com/questions/15579620/how-to-block-100-000-individual-ip-addresses)

IntroductionHow do you Block large number of IP address from your web application/server. Obviously that can easily be done in PHP or any programming language Or Using htaccessThe issues Stupid Idea Question Finally My approach might be totally wrong ... all I want is a visible solution since spammers and botnets are on the rise ...  Please this has nothing to do with DOS attack its a simple ... get lost responseUpdate

2013-03-22 20:49:54Z

IntroductionHow do you Block large number of IP address from your web application/server. Obviously that can easily be done in PHP or any programming language Or Using htaccessThe issues Stupid Idea Question Finally My approach might be totally wrong ... all I want is a visible solution since spammers and botnets are on the rise ...  Please this has nothing to do with DOS attack its a simple ... get lost responseUpdateSomething that you can try is keeping a list of the IP addresses you want to block in a text file or convert it to a dbm hash file, then use mod_rewrite's RewriteMap. You'd have to set this up in your server/vhost config. You cannot initialize a map in an htaccess file.The /path/to/deny_ips.txt file would look something like this:Essentially, an IP that you want to deny and a space then a "1". Any IP in this text file will cause the server to return a 403 Forbidden. To speed things up a bit you can use the httxt2dbm to generate a dbm hash and then you'd define the mapping as so:I'm not sure what the performance hit is for using mod_rewrite like this with a lot of IPs, but a quick benchmark test on apache 2.2 running on a 3Ghz i686 under linux, the difference between 5 IPs in the list versus 102418 is negligible. According to ab's output, they're nearly identical.Addressing specific questions:Using a rewrite map, you can use the "prg" map type to run an external program for a mapping type. You can then write a perl, php, etc. script to talk to a database in order to look up an IP address. Also note that caveats listed under "Caution". You'd then use this map like you would any other map (RewriteCond ${deny_ips:%{REMOTE_ADDR}|0} !=0). This would essentially create a bottleneck for all requests. Not the best solution for talking to a database.In apache 2.4 though, there is a dbd/fastdbd map type, which allows you to create queries through mod_dbd. This is a much better option and the mod_dbd module manages connections to the database, pools connections, etc. So the map definition would look something like:Assuming you have a table "deny_ips" with 2 columns "source" (the IP address) and "active" (1 for active, 0 for inactive). If you are storing all of the blocked IPs in the database, it's a matter of managing the contents of your database table. If you are using the dbm map type, I know at least perl has a DBI for managing dbm files, so you can use that to add/remove IP entries from the deny list. I've never used it before so I can't really say much about it. Managing a flat text file is going to be a lot trickier, especially if you plan on removing entries, and not just append to it. Outside of using a database and apache 2.4's mod_dbd, I don't think any of these solutions are out of the box or production ready. It's going to require custom work.For IPtables, there is a perl interface that's marked as Beta, but I've never used it before. There's libiptc but according to netfilter's faq:So I don't know how viable a libiptc solution is if there's no API stability.ANOTHER PERSPECTIVEHello. You can check if an address is blocked or not, via accessing two bytes in two data chunks each 8KB long. Yes, I am serious... Please be patient because it takes a little bit long to explain it.THE THEORYAn IP address is an address, actually a 4 byte number. The question is, what if we make it to address bit positions?.The answer: Well ok, we will have of addressing space and that will take of allocation. Ouch! But do not worry, we are not going to block everything in the ipverse and 512MB is an exaggeration. This can open us a path to the solution. The Lilliputian CaseThink of a Lilliputian world which there exists only ip addresses from 0 to 65535. So addresses are like 0.1 or 42.42 up to 255.255.Now King of this world wants to block several L-IP (lilliput ip) addresses.First he builds a virtual 2D bit map which is 256 * 256 bits long that takes up :He decides to block that nasty "revolution" site which he hates because he is the king, the address is 56.28 for instance.He opens the map file, accesses 1795th byte and sets the bit 4 (by an | 16), then writes it back to mark the site as blocked.When his script sees the 56.28, it does the same calculation and looks at the bit, and if it is set, blocks the address.Now what is the moral of the story? Well we can use this lilliputian structure.THE PRACTICEThe Real World CaseWe can apply the Lilliputian case to real world with a "use it when you need" approach since allocating a 512MB file is not a good choice.Think of a database table named BLOCKS with entries like that:And another table with just one entry with the structure below named BASENow lets say you have an incoming address 56.28.10.2Script accesses BASE table and gets the Map. It looks up the higher order IP numbers 56.28:Looks at byte 1795 bit 4 in the Map.If bit is not set no further operation is needed meaning there is no blocked ip address in range 56.28.0.0 - 56.28.255.255 .If bit is set then the script accesses the BLOCKS table. The higher order IP numbers were 56.28 which gives 14364 so the script queries the BLOCKS table with index IpHead = 14364. Fetches the record. The record should exist since it is marked at BASE. Script does the calculation for lower order IP addressThen it checks if address is blocked by looking at bit 2 of byte 320 of field Map.Job done!Q1: Why do we use BASE at all, we could directly query BLOCKS with 14364.A1: Yes we could but BASE map lookup will be faster then BTREE search of any database server.Q2: What is the EntryCount field in BLOCKS table for?A2: It is the count of ip addresses blocked in the map field at the same record.

        So if we unblock ip's and EntryCount reaches 0 that BLOCKS record becomes

        unnecessary. It can be erased and the corresponding bit on BASE map will be unset.IMHO this approach will be lightning fast. Also for the blob allocation is 8K per record. Since db servers keep blobs in seperate files, file systems with 4K, 8K or multiples of 4K paging will react fast.In case blocked addresses are too dispersedWell that is a concern, which will make the database BLOCKS table to grow unnecessarily.But for such cases the alternative is to use a 256*256*256 bit cube which is 16777216 bits long, equaling to 2097152 bytes = 2MB. For our previous example Higher Ip resolving is :So BASE will become a 2MB file instead of a db table record, which will be opened (fopen etc.) and bit will be addressed via seeking (like fseek, never read whole file contents, unnecessary) then access the BLOCKS table with structure below:Here is the php example code for block checking of bitplane-bitplane (8K 8K) version:Side Note: This script can be optimized further via elimination of several calls etc..

           But written like this for keeping it easy to understand.I hope this helps.If you have questions on the details, I will be happy to answer.You need to do this with an external firewall, not in PHP.  I recommend pfSense or PF.  I have used it before and it is very easy to use, very intuitive, and extremely powerful.  It is the choice of the best sys-admins.  I run it on FreeBSD, but it works great on OpenBSD as well.  I am a Linux guy so it pains me to say this, but don't try to run it on Linux.  BSD is easy, and you can figure it out quickly.An awesome feature for pfSense is the ability to configure using scripts and restricting the configuration access to a single network interface (so that only things on the LAN can configure it).  It also has a couple of ID10T level features to keep you from cutting off your own access accidentally.You should also be aware that many spammers can switch IPs quickly using things like Tor.  To fix this you should include in your block list the addresses that are known tor exit nodes (this list is available from various places).Block the traffic before it reaches the www server using iptables and ipset.Catch the blacklisted IP traffic in the filter table of the INPUT chain assuming your web server is on the same machine. If you are blocking IPs on a router you will want the FORWARD chain.First create the ipset:IPs can be added via:Add the ipset match rule to your iptables (DROP all packets match to ipset):This will stop the blacklisted traffic before the www server.Edit: I had a chance to look up the default maximum size and it is 65536 so you will need to adjust this to support 100000+ entries:You can also tweak the hash size:ipset create ip_blacklist hash:ip maxelem 120000 hashsize 16384 (Must be a power of 2)My experience is ipset lookup has negligible effect on my system (~45000 entries).  There are a number of test cases on the net.  Memory for the set is a limiting factor.If you want a way to add / remove via code take a look at denyhosts. You could either maintain the IP list via code or patch the source to read from whatever location you want.There is a project with netfilter for that called ipset so you can add or remove ip to a list and you just have to create a rule against this listhttp://ipset.netfilter.org/If you're blocking IPs, you really should be doing this at the firewall level (you don't want users from unwelcome IP addresses getting very far into your system). Thus, I suggest writing a bash script that queries the database and modifies your firewall configuration file accordingly (this assumes that you want a solution which utilizes IP addresses stored in your web database -- there very well might be a better place to store such information).EDIT: If you wanted to add IP addresses to the blacklist at the PHP level, as @Populus suggested, here is the manual on how to use system calls in PHP: http://php.net/manual/en/function.system.phpAnd here are the commands you would need to use to add an ip address to your blacklist if you're using iptables: http://www.cyberciti.biz/faq/linux-iptables-drop/I know a way

its by php.

as you mentioned in the very beginig of this question.I read thing you have wrote. but just wait a minute.

why you want to do this.is not important.but why with this situation.

I mean why would you want to avoid accessing php because of its speed or just because of preventing and because its so hard to call the function in all pages?

if the only reason of avoiding some ip from accessing php is.avoiding theme to see contents.

so I got an idea and I.suggest you this way.

using one entry point.I have worked with this solution.first with a simple htaccess you send all requests to one page called entry point.(like index.php)

with a simple rewriting rule i'll give it to you.

so when the user requestshtaccess will execute something like the following without changing the url. so the user would not feel anything.so every request became one request with different $_GET['r'] params. so for evey request we will have index.php executed. and now we can do somthing like this in index.phpits so simple.and its real one is so complicated.but the main idea is the same.

what do you think?It seems that most of us agree to block at the firewall level.You could have a program that listens to your website for ips to block and generates a script:script would look something like this (where [an] is an alphanumeric value and [ip] is the ip you block):Then you load this script to another program that executes remote telnet or ssh calls to your FW CLI.Don't forget to logout and maybe every 100 ips you copy the running config to start config. I don't know but you may want to know now what are the limitations for your firewall.Best,Do a geo-lookup on the IPs in your list.  My own experience has shown most malicious (i.e. spam) connections have originated from China.  If you find the same to be the case for you, and you have no specific need to serve China, see if you can efficiently block the entire country at the firewall level.IMHO, there are several angles from which this question can be consideredConsidering the above option, the only relevant questions are:The .htaccess would be my second choice.

Download files in laravel using Response::download

star18bit

[Download files in laravel using Response::download](https://stackoverflow.com/questions/20415444/download-files-in-laravel-using-responsedownload)

In Laravel application I'm trying to achieve a button inside view that can allow user to download file without navigating to any other view or route

Now I have two issues: 

(1) below function throwing (2) Download button should not navigate user to anywhere and rather just download files on a same view, My current settings, routing a view to '/download'Here is how Im trying to achieve: Button:Route :Controller :

2013-12-06 03:33:22Z

In Laravel application I'm trying to achieve a button inside view that can allow user to download file without navigating to any other view or route

Now I have two issues: 

(1) below function throwing (2) Download button should not navigate user to anywhere and rather just download files on a same view, My current settings, routing a view to '/download'Here is how Im trying to achieve: Button:Route :Controller :Try this."./download/info.pdf"will not work as you have to give full physical path.Update 20/05/2016Laravel 5, 5.1, 5.2 or 5.* users can use the following method instead of Response facade. However, my previous answer will work for both Laravel 4 or 5. (the $header array structure change to associative array =>- the colon after 'Content-Type' was deleted - if we don't do those changes then headers will be added in wrong way: the name of header wil be number started from 0,1,...)File downloads are super simple in Laravel 5.As @Ashwani mentioned Laravel 5 allows file downloads with response()->download() to return file for download. We no longer need to mess with any headers. To return a file we simply:from within the controller.Reusable Download Route/ControllerNow let's make a reusable file download route and controller so we can server up any file in our public/files directory.Create the controller:Create the route in app/Http/routes.php:Make download method in app/Http/Controllers/DownloadsController:Now simply drops some files in the public/files directory and you can server them up by linking to /download/filename.ext:If you pulled in Laravel Collective's Html package you can use the Html facade:In the accepted answer, for Laravel 4 the headers array is constructed incorrectly. Use:Quite a few of these solutions suggest referencing the public_path() of the Laravel application in order to locate the file. Sometimes you'll want to control access to the file or offer real-time monitoring of the file. In this case, you'll want to keep the directory private and limit access by a method in a controller class. The following method should help with this:There are other paths that you could use as well, described on

Laravel's helper functions documentationWhile using laravel 5 use this code as you don`t need headers.return response()->download($pathToFile); .If you are using Fileentry you can use below function for downloading.// Try this to download any file. laravel 5.*// you need to use facade "use Illuminate\Http\Response;" I think that you can use With this you be sure that is a pdf.This is html part  This is Route :This is function : If you want to use the JavaScript download functionality then you can also doAlso remember to paste the info.pdf file in your public directory of your projectyou can use simply inside your controller:

return response()->download($filePath);

Happy coding :)

Why is $a + ++$a == 2?

Naftali aka Neal

[Why is $a + ++$a == 2?](https://stackoverflow.com/questions/9709818/why-is-a-a-2)

If I try this:I get this output:Demo: http://codepad.org/ncVuJtJuI expect to get this as an output:But why isn't that the output?

2012-03-14 20:31:24Z

If I try this:I get this output:Demo: http://codepad.org/ncVuJtJuI expect to get this as an output:But why isn't that the output?All the answers explaining why you get 2 and not 1 are actually wrong. According to the PHP documentation, mixing + and ++ in this manner is undefined behavior, so you could get either 1 or 2. Switching to a different version of PHP may change the result you get, and it would be just as valid.See example 1, which says: Notes:Also relevant: On this bug report regarding another expression with undefined results, a PHP developer says: "We make no guarantee about the order of evaluation [...], just as C doesn't. Can you point to any place on the documentation where it's stated that the first operand is evaluated first?"A preincrement operator "++" takes place before the rest of the expression it's in evaluates.  So it is actually:Why do you expect something else?In PHP:Operator precedence visualized:Evaluation sequence visualized:Or written out:The moment the sum operation is performed, $a is already 1 because ++$a has been already evaluated. The ++ operator is evaluated before the + operator.For the fun:Results in 2, too. However if you compare it as an expression, it's not equal:Where asis "equal".See Also:My Evaluation Order in PHP blog post explain this in detail, but here is the basic idea:++ is the higher precedence operator, so it gets applied first.So now l = 1.So 1 + 1 = 2.When you do your ++$l (preincrement), it will be done before your addition -> check operator precedence). 

So, the value of $l will be 1 before your addition :So your answer will be 2.But when you do :So your answer will be 1.This behaviour can be confirmed by inspecting how PHP compiles your script, for example:Compiles into the following opcodes, which are then executed:This translates to the following equivalent script:ConclusionBy the time $a is evaluated as the left hand expression of $a + (++$a), it has already been incremented, because ++$a was evaluated first.Obviously, this behaviour should not be relied upon; in any language for that matter.Check the increment operator manual: http://www.php.net/manual/en/language.operators.increment.phpOr see this codepad: http://codepad.org/Y3CnhiLxOutputs: As you may know we have two increment operator, one is pre-increment and second is post-increment. Pre-increment increase the value of integer before it use in expression, on the other hand post increment increase value of number after it used in expression.suppose you have variable $a and variable $b as below$a=0;$b=++$a gives the value of b=1while$b=$a++ gives the value b=0The output of your code varies with PHP version as seen hereIn the above case the left hand side of + operator is evaluated first (0, 1, +).In the above case the right hand side of + operator is evaluated first (1, 1, +).This is in accordance with interjay's answer that in PHP there is no guarantee about the order of evaluation of sub-expresions. The assumption that the output could be 1, 1 is correct, so are that answers that claim that the output could be 1, 2.First obvious part is that ++ have higher priority than +.Second part is that php engine doesn't store value from first operand into another anonymous variable. So $l + ++$l is not an qeuivalent forAs mentioned before there is a difference in x++ and ++x. You can interpret it in the way thatincrements after the semicolon andincrements on evaluation of the expressionSo it seems that your expression is evaluated from right to leftAll statements are executed from right to left.

So the value is first incremented than the value of your variable is = 1 so 1+1=2

php array group

Red

[php array group](https://stackoverflow.com/questions/12706359/php-array-group)

I have the following array How can I group the array by id? Is there any native php functions are available to do this?If I foreach the above then I will get a duplicate one, how can I avoid that?On the above example id have 2 items, so its need to be inside of the id.EDIT : EVERYTHING WORKS FINE : BUT IS THERE ANY WAY TO ACHIEVE THE SAME WITH ONE FOREACH ?

2012-10-03 10:14:11Z

I have the following array How can I group the array by id? Is there any native php functions are available to do this?If I foreach the above then I will get a duplicate one, how can I avoid that?On the above example id have 2 items, so its need to be inside of the id.EDIT : EVERYTHING WORKS FINE : BUT IS THERE ANY WAY TO ACHIEVE THE SAME WITH ONE FOREACH ?There is no native one, just use a loop.You can try the following:Output:In a more functional programming style, you could use array_reduceI just threw this together, inspired by .NET LINQAnd voila you getI needed such function too. I created this one, you pass which column you want to group by:This array_group_by function achieves what you are looking for:It even supports multi-level groupings:Expanding on @baba's answer, which I like, but creates a more complex three level deep multi-dimensional (array(array(array))):Will output:96 has a part no. of reterty and shipping number of 212755-196 has a part no. of dftgtryh and shipping number of 212755-1It's trivial to do with LINQ, which is implemented in PHP in several libraries, including YaLinqo*. It allows performing SQL-like queries on arrays and objects. The groubBy function is designed specifically for grouping, you just need to specify the field you want to group by:Where '$v["id"]' is a shorthand for function ($v) { return $v["id"]; } which this library supports.The result will be exactly like in the accepted answer, just with less code.* developed by me1. GROUP BY one keyThis function works as GROUP BY for array, but with one important limitation: Only one grouping "column" ($identifier) is possible.2. Detecting the unique rows for a table (twodimensional array)This function is for filtering "rows". If we say, a twodimensional array is a table, then its each element is a row. So, we can remove the duplicated rows with this function. Two rows (elements of the first dimension) are equal, if all their columns (elements of the second dimension) are equal. To the comparsion of "column" values applies: If a value is of a simple type, the value itself will be use on comparing; otherwise its type (array, object, resource, unknown type) will be used.The strategy is simple: Make from the original array a shallow array, where the elements are imploded "columns" of the original array; then apply array_unique(...) on it; and as last use the detected IDs for filtering of the original array.It's also possible to improve the comparing, detecting the "column" value's class, if its type is object.The $implodeSeparator should be more or less complex, z.B. spl_object_hash($this).3. Detecting the rows with unique identifier columns for a table (twodimensional array)This solution relies on the 2nd one. Now the complete "row" doesn't need to be unique. Two "rows" (elements of the first dimension) are equal now, if all relevant "fields" (elements of the second dimension) of the one "row" are equal to the according "fields" (elements with the same key).The "relevant" "fields" are the "fields" (elements of the second dimension), which have key, that equals to one of the elements of the passed "identifiers".$arr = Data Araay;$fldName = Group By Colum Name;This should group an associative array

Ejm Group By CountryCheck indexed function from Nspl:}Try this function I think this works better in PHP 5.5+

Laravel - Pass more than one variable to view

pjmil

[Laravel - Pass more than one variable to view](https://stackoverflow.com/questions/20110757/laravel-pass-more-than-one-variable-to-view)

I have this site and one of its pages creates a simple list of people from the database. I need to add one specific person to a variable I can access.How do I modify the return $view->with('persons', $persons); line to also pass the $ms variable to the view? 

2013-11-21 01:31:00Z

I have this site and one of its pages creates a simple list of people from the database. I need to add one specific person to a variable I can access.How do I modify the return $view->with('persons', $persons); line to also pass the $ms variable to the view? Just pass it as an array:Or chain them, like @Antonio mentioned.This is how you do it:You can also use compact():Or do it in one line:Or even send it as an array:But, in this case, you would have to access them this way:Passing multiple variables to a Laravel viewRead here about Passing Data to Views in LaravelCame across a similar problem, but if you do not necessarily want to return a view with view file, you can do this:This Answer seems to be bit helpful while declaring the large numbe of variable in the function Laravel 5.7.*For Example When you see the last line of the returns it not looking goodSo As You see all the variables as declared as array of $viewShareVars and Accessed in Viewthe native php function get_defined_vars() get all the defined variables from the function and array_keys will grab the variable namesso in your view you can access all the declared variable inside the functionas {{$todayPostActive}}Please try this,For passing multiple array data from controller to view, try it. It is working. In this example, I am passing subject details from a table and subject details contain category id, the details like name if category id is fetched from another table category.Its simple :)

Can you store a function in a PHP array?

Kirk Ouimet

[Can you store a function in a PHP array?](https://stackoverflow.com/questions/1499862/can-you-store-a-function-in-a-php-array)

e.g.:Is this possible? What's the best alternative?

2009-09-30 18:25:02Z

e.g.:Is this possible? What's the best alternative?The recommended way to do this is with an anonymous function:If you want to store a function that has already been declared then you can simply refer to it by name as a string:In ancient versions of PHP (<5.3) anonymous functions are not supported and you may need to resort to using  create_function (deprecated since PHP 7.2):All of these methods are listed in the documentation under the callable pseudo-type.Whichever you choose, the function can either be called directly (PHP ≥5.4) or with call_user_func/call_user_func_array:Since PHP "5.3.0 Anonymous functions become available", example of usage:note that this is much faster than using old create_function...REFERENCES:To follow up on Alex Barrett's post,  create_function()  returns a value that you can actually use to call the function, thusly:Because I could...Expanding on Alex Barrett's post.I will be working on further refining this idea, maybe even to something like an external static class, possibly using the '...' token to allow variable length arguments.In the following example I have used the keyword 'array' for clarity however square brackets would also be fine. The layout shown which employs an init function is intended to demonstrate organization for more complex code.Ok, refined down to one line now as...Can be used to overload any function, not just constructors.By using closure we can store a function in a array. Basically a closure is a function that can be created without a specified name - an anonymous function. 

Unsetting array values in a foreach loop [duplicate]

Matt

[Unsetting array values in a foreach loop [duplicate]](https://stackoverflow.com/questions/2008866/unsetting-array-values-in-a-foreach-loop)

I have a foreach loop set up to go through my array, check for a certain link, and if it finds it removes that link from the array.My code:But it doesn't remove the array entires. It's probably something to do with $images[$image], as that's not the key of the array entry, only the content? Is there a way to do this without incorporating a counter?Thanks.EDIT: Thanks guys, but now I have another problem where the array entries don't actually get deleted.My new code:$images is actuallty a two-dimensional array now hence why I need $images[1]. I have checked and it successfully goes around the array elements, and some elements do actually have some of those URLs in that I wish to delete, but they're not getting deleted. This is my $images array:Thanks!

2010-01-05 20:31:37Z

I have a foreach loop set up to go through my array, check for a certain link, and if it finds it removes that link from the array.My code:But it doesn't remove the array entires. It's probably something to do with $images[$image], as that's not the key of the array entry, only the content? Is there a way to do this without incorporating a counter?Thanks.EDIT: Thanks guys, but now I have another problem where the array entries don't actually get deleted.My new code:$images is actuallty a two-dimensional array now hence why I need $images[1]. I have checked and it successfully goes around the array elements, and some elements do actually have some of those URLs in that I wish to delete, but they're not getting deleted. This is my $images array:Thanks!Try that:Normally, foreach operates on a copy of your array so any changes you make, are made to that copy and don't affect the actual array.So you need to unset the values via $images[$key];The reference on &$image prevents the loop from creating a copy of the array which would waste memory.To answer the initial question (after your edit), you need to unset($images[1][$key]);Now some more infos how PHP works:

You can safely unset elements of the array in foreach loop, and it doesn't matter if you have & or not for the array item. See this code:This prints:So as you can see, if you unset correct thing within the foreach loop, everything works fine.You can use the index of the array element to remove it from the array, the next time you use the $list variable, you will see that the array is changed.Try something like this$image is in your case the value of the item and not the key. Use the following syntax to get the key too:Now you can delete the item with unset($images[$key]).You would also need a after each unset to not skip an element/Because when you unset $item[45], the next element in the for-loop should be $item[45] -  which was [46] before unsetting. If you would not do this, you'd always skip an element after unsetting.One solution would be to use the key of your items to remove them -- you can both the keys and the values, when looping using foreach.For instance :Will give you this array, in the end :

Which means that, in your case, something like this should do the trick :!!foreach($images as $key=>$imagecause $image is the value, so $images[$image] make no sense.Sorry for the late response, I recently had the same problem with PHP and found out that when working with arrays that do not use $key => $value structure, when using the foreach loop you actual copy the value of the position on the loop variable, in this case $image. Try using this code and it will fix your problem.

How to pass extra variables in URL with WordPress

Chuck D

[How to pass extra variables in URL with WordPress](https://stackoverflow.com/questions/4586835/how-to-pass-extra-variables-in-url-with-wordpress)

I am having trouble trying to pass an extra variable in the url to my WordPress installation. For example /news?c=123For some reason, it works only on the website root www.example.com?c=123 but it does not work if the url contains any more information www.example.com/news?c=123. I have the following code in my functions.php file in the theme directory.Any Ideas?

2011-01-03 17:44:38Z

I am having trouble trying to pass an extra variable in the url to my WordPress installation. For example /news?c=123For some reason, it works only on the website root www.example.com?c=123 but it does not work if the url contains any more information www.example.com/news?c=123. I have the following code in my functions.php file in the theme directory.Any Ideas?There are quite few solutions to tackle this issue. First you can go for a plugin if you want:Or code manually, check out this post:Also check out:To make the round trip "The WordPress Way" on the "front-end" (doesn't work in the context of wp-admin), you need to use 3 WordPress functions: Note: there's no need to even touch the superglobals ($_GET) if you do it this way.On the page where you need to create the link / set the query variable:if it's a link back to this page, just adding the query variable<a href="<?php echo esc_url( add_query_arg( 'c', $my_value_for_c ) )?>">if it's a link to some other page<a href="<?php echo esc_url( add_query_arg( 'c', $my_value_for_c, site_url( '/some_other_page/' ) ) )?>">In your functions.php, or some plugin file or custom class (front-end only):On the page / function where you wish to retrieve and work with the query var set in your URL:$my_c = get_query_var( 'c' );On the back end we don't ever run wp(), so the main WP Query does not get run. As a result, there are no query vars and the query_vars hook is not run.In this case, you'll need to revert to the more standard approach of examining your $_GET superglobal. The best way to do this is probably:$my_c = filter_input( INPUT_GET, "c", FILTER_SANITIZE_STRING );though in a pinch you could do the tried and true$my_c = isset( $_GET['c'] ? $_GET['c'] : "";or some variant thereof.add following code in function.phpthen you will b able to use $_GET['var1']Since this is a frequently visited post i thought to post my solution in case it helps anyone. In WordPress along with using query vars you can change permalinks too like thisFor this you have to add these lines of code in functions.php or your plugin base file.From shankhan's anwerAnd additionally this snipped to add custom rewriting rules.For the case where you need to add rewrite rules for a specifc page you can use that page slug to write a rewrite rule for that specific page. Like in the question OP has asked aboutWe can change it to the desired behaviour by adding a little modification to our previous function.Hoping that it becomes useful for someone.You can add any page inplace of "news". One issue you might run into is is_home() returns true when a registered query_var is present in the home URL. For example, if http://example.com displays a static page instead of the blog, http://example.com/?c=123 will return the blog. See https://core.trac.wordpress.org/ticket/25143 and https://wordpress.org/support/topic/adding-query-var-makes-front-page-missing/ for more info on this.What you can do (if you're not attempting to affect the query) is use add_rewrite_endpoint(). It should be run during the init action as it affects the rewrite rules. Eg.This should give you access to $_GET['c'] when the url contains more information like www.example.com/news?c=123.Remember to flush your rewrite rules after adding/modifying this.This was the only way I could get this to workhttp://codex.wordpress.org/Function_Reference/add_query_argto add parameter to post urls (to perma-links), i use this:output:http://yoursite.com/pagename?my_pid=12345678

Get first 100 characters from string, respecting full words

JoshFinnie

[Get first 100 characters from string, respecting full words](https://stackoverflow.com/questions/972010/get-first-100-characters-from-string-respecting-full-words)

I have asked a similar question here before, but I need to know if this little tweak is possible.  I want to shorten a string to 100 characters and use $small = substr($big, 0, 100); to do so.  However, this just takes the first 100 characters and doesn't care whether it breaks up a word or not.Is there any way to take up to the first 100 characters of a string but make sure you don't break a word?Example:Is there a way to do this using PHP?

2009-06-09 19:22:07Z

I have asked a similar question here before, but I need to know if this little tweak is possible.  I want to shorten a string to 100 characters and use $small = substr($big, 0, 100); to do so.  However, this just takes the first 100 characters and doesn't care whether it breaks up a word or not.Is there any way to take up to the first 100 characters of a string but make sure you don't break a word?Example:Is there a way to do this using PHP?All you need to do is use:Yes, there is.  This is a function I borrowed from a user on a different forums a a few years back, so I can't take credit for it.Note that it automatically adds ellipses, if you don't want that just use '\\1' as the second parameter for the preg_replace call.If you define words as "sequences of characters delimited by space"... Use strrpos() to find the last space in the string, shorten to that position, trim the result.Sure. The easiest is probably to write a wrapper around preg_match:EDIT : Updated to not ALWAYS include a space as the last character in the stringThis is my approach, based on amir's answer, but it doesn't let any word make the string longer than the limit, by using strrpos() with a negative offset.Simple but works. I'm using the same syntax as in Laravel's str_limit() helper function, in case you want to use it on a non-Laravel project.This function shortens a string by adding "..." at a word boundary whenever possible. The returned string will have a maximum length of $len including "...".Examples outputs:This works fine for me, I use it in my scriptgood luckHere is great solution with dotts at the end with full wordsInput:

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Output:

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip...The problem with accepted answer is that result string goes over the the limit, i.e. it can exceed 100 chars since strpos will look after the offset and so your length will always be a over your limit. If the last word is long, like squirreled then the length of your result will be 111 (to give you an idea).A better solution is to use wordwrap function:This way you can be sure the string is truncated under your limit (and never goes over)P.S. This is particularly useful if you plan to store the truncated string in your database with a fixed-with column like VARCHAR(50), etc. P.P.S. Note the special delimiter in wordwrap. This is to make sure that your string is truncated correctly even when it contains newlines (otherwise it will truncate at first newline which you don't want).This did it for me...Here's my solution:In your case it would be (example):Example:I apologize for resurrecting this question but I stumbled upon this thread and found a small issue.  For anyone wanting a character limit that will remove words that would go above your given limit, the above answers work great.  In my specific case, I like to display a word if the limit falls in the middle of said word.  I decided to share my solution in case anyone else is looking for this functionality and needs to include words instead of trimming them out.Examples:Here is another way you can do that.ORThis is also multibyte safe and also works even if there are not spaces, in which case it will just simply return first 100 characters. 

It takes the first 100 characters and then searches from the end till the nearest word delimiter.Another a simpler way I do.wordwrap formats string according to limit, seprates them with \n

 so we have lines smaller than 50, ords are not seprated

explodes seprates string according to \n

 so we have array corresponding to lines

list gathers first element.please rep  Evert, since I cant comment or rep.here is sample runYet another answer!  I wasn't completely satisfied with other answers, and wanted a 'hard cutoff' (guaranteed word break before $max_characters, if possible), so here's my function to contribute!## Get first limited character from a string ##    

Get parent directory of running script

Tatu Ulmanen

[Get parent directory of running script](https://stackoverflow.com/questions/1882044/get-parent-directory-of-running-script)

In PHP, what would be the cleanest way to get the parent directory of the current running script relative to the www root? Assume I have:Or just:And I need to get /relative/path/to/ with slashes properly inserted. What would you suggest? A one liner is preferred.EDITI need to get a path relative to the www root, dirname(__FILE__) gives me an absolute path in the filesystem so that won't work. $_SERVER['SCRIPT_NAME'] on the other hand 'starts' at the www root.

2009-12-10 16:08:05Z

In PHP, what would be the cleanest way to get the parent directory of the current running script relative to the www root? Assume I have:Or just:And I need to get /relative/path/to/ with slashes properly inserted. What would you suggest? A one liner is preferred.EDITI need to get a path relative to the www root, dirname(__FILE__) gives me an absolute path in the filesystem so that won't work. $_SERVER['SCRIPT_NAME'] on the other hand 'starts' at the www root.If your script is located in /var/www/dir/index.php then the following would return:orThis is a technique used in many frameworks to determine relative paths from the app_root.File structure:index.php is my dispatcher/boostrap file that all requests are routed to:library.php is some file located an extra directory down and I need to determine the path relative to the app root (/var/www/).There's probably a better way to calculate the relative path then str_replace() but you get the idea.As of PHP 5.3.0 you can use __DIR__ for this purpose.See PHP Magic constants.If I properly understood your question, supposing your running script is This would give you the parent directory of your running script relative to the document www:If you want the parent directory of your running script relative to server root:To get the parentdir of the current script.Fugly, but this will do it:I Hope this will help you.Output : Here is what I use since I am not running > 5.2Double dirname with file as suggested by @mike b for the parent directory, and current directory is found by just using that syntax once.Note this function only returns the NAME, slashes have to be added afterwards.Try this. Works on both windows or linux server..str_replace('\\','/',dirname(dirname(__FILE__)))This is also a possible solutionThis is a function that I use. Created it once so I always have this functionality:I hope this will helpGot it myself, it's a bit kludgy but it works:So if I have /path/to/folder/index.php, this results in /path/to/.

How can I disable PHP's「easter egg」URLs?

Wesley Murch

[How can I disable PHP's「easter egg」URLs?](https://stackoverflow.com/questions/10458610/how-can-i-disable-phps-easter-egg-urls)

I recently found out about the so-called "easter egg URLs" in PHP:Others include:I was shocked to discover that this does work on a lot of websites, including my own. I think this is idiotic and want to disable it, but from what I hear the only way to do it is in php.ini with expose_php = Off, and it can't be set at runtime with ini_set().I don't have direct access to php.ini on the live server. I have, however, figured out how to unset the X-Powered-By header by using Header unset X-Powered-By in .htaccess, or header('X-Powered-By: ') in the PHP code.Is there any other way I can disable these "easter eggs", or do I have to get this setting changed in the main php.ini (and is that indeed the correct/only way to disable these URLs)?

2012-05-05 03:34:24Z

I recently found out about the so-called "easter egg URLs" in PHP:Others include:I was shocked to discover that this does work on a lot of websites, including my own. I think this is idiotic and want to disable it, but from what I hear the only way to do it is in php.ini with expose_php = Off, and it can't be set at runtime with ini_set().I don't have direct access to php.ini on the live server. I have, however, figured out how to unset the X-Powered-By header by using Header unset X-Powered-By in .htaccess, or header('X-Powered-By: ') in the PHP code.Is there any other way I can disable these "easter eggs", or do I have to get this setting changed in the main php.ini (and is that indeed the correct/only way to disable these URLs)?A quick HTACCESS global rewrite could regex the exact string right out of every URL thus getting rid of the only fun part of PHP without touching the ini file nor needing a function at the beginning of every file.Haven't tested this yet, but this should work:Of course, just copy the last 2 lines for each of the other possible queries, or write a more generic regex. I'm not good with regex. :)This version covers all of the easter egg fun and was found here:in php.iniThis will effectively remove the easter eggsUpdate: This is removed in PHP 5.5, note how these links no longer work on php.nethttp://phpsadness.com/sad/11Not sure about your case, but it's work for my site. Hope, it will work for your site as well as.Of course, just copy the last 2 lines for each of the other possible queries or write a more generic regex. I'm not good with regex. :)

Why does PHP store uploaded files in a temporary location and what is the benefit?

Jai Shree Ganesh

[Why does PHP store uploaded files in a temporary location and what is the benefit?](https://stackoverflow.com/questions/48819619/why-does-php-store-uploaded-files-in-a-temporary-location-and-what-is-the-benefi)

Okay I'm totally new in this field and going through some tutorials and I found that while uploading files in PHP it stores them in a temporary location. Now why doesn't PHP allow uploading files directly to the desired location? Why they are stored in a temporary location with a .tmp extension and what benefit do we get from this strategy?

2018-02-16 03:23:13Z

Okay I'm totally new in this field and going through some tutorials and I found that while uploading files in PHP it stores them in a temporary location. Now why doesn't PHP allow uploading files directly to the desired location? Why they are stored in a temporary location with a .tmp extension and what benefit do we get from this strategy?Good question. The short answer is that PHP must process the entire HTTP request - filling out $_POST with data, and $_FILES as needed - before giving control to your script. Since your script doesn't gain control until after the processing, there's no way to tell PHP where to put that file data.But why does PHP do it this way? Well, let's look at an HTTP POST with file data:Notice that the contents of the request are a multi-part encoded document, with form fields interspersed among file data. In this particular example, the form field occurs before the file data. However, it's possible - indeed likely - that form data occurs after file data.So, in order to guarantee that PHP can give you all the $_POST data, PHP must process the entire request. So it might as well complete the $_FILES super-global while it's there.Now, PHP could keep this file data in memory, but this might really be a bad idea. Think about what would happen if PHP needed to store a 100 MiB file a user uploaded. Suddenly, you've got a 100 MiB increase in the RSS of your Apache process, which is really not too good - Apache might be ulimited to not have that much space, or Apache might get swapped: to your users anguish. So, PHP does the next best thing: put this received file in a temporary file.You might ask why PHP can't be told what file to put the incoming file data first, so you didn't have to move it. Well, that's a bootstrapping problem: PHP hasn't handed control over to the script yet, so the script can't tell PHP where to put the file. Thus, PHP does the best it can: put the file data into a temporary file.Now, you can keep this file data in a RAM disk, for speed if you want. This is a good approach if you don't mind the infrastructure cost (eg, maintaining the RAM disk setup). But note this isn't like PHP holding it in RAM itself: in that scenario, the PHP container process (usually Apache or some other web server) must have the heap to hold the file (which it might not). In this scenario, the RAM disk is managed by the kernel.From What is the benefit of writing to a temp location, And then copying it to the intended destination?:Two additional reasons:

What are the best practices for avoiding xss attacks in a PHP site

Rik Heywood

[What are the best practices for avoiding xss attacks in a PHP site](https://stackoverflow.com/questions/71328/what-are-the-best-practices-for-avoiding-xss-attacks-in-a-php-site)

I have PHP configured so that magic quotes are on and register globals are off.I do my best to always call htmlentities() for anything I am outputing that is derived from user input.I also occasionally seach my database for common things used in xss attached such as...What else should I be doing and how can I make sure that the things I am trying to do are always done.

2008-09-16 11:20:02Z

I have PHP configured so that magic quotes are on and register globals are off.I do my best to always call htmlentities() for anything I am outputing that is derived from user input.I also occasionally seach my database for common things used in xss attached such as...What else should I be doing and how can I make sure that the things I am trying to do are always done.Escaping input is not the best you can do for successful XSS prevention. Also output must be escaped. If you use Smarty template engine, you may use |escape:'htmlall' modifier to convert all sensitive characters to HTML entities (I use own |e modifier which is alias to the above).My approach to input/output security is:I'm of the opinion that one shouldn't escape anything during input, only on output. Since (most of the time) you can not assume that you know where that data is going. Example, if you have form that takes data that later on appears in an email that you send out, you need different escaping (otherwise a malicious user could rewrite your email-headers). In other words, you can only escape at the very last moment the data is "leaving" your application:To go short:Esp #3 will occur if you escape data at the input layer (or you need to de-escape it again, etc).PS: I'll second the advice for not using magic_quotes, those are pure evil!There are a lot of ways to do XSS (See http://ha.ckers.org/xss.html) and it's very hard to catch.I personally delegate this to the current framework I'm using (Code Igniter for example). While not perfect, it might catch more than my hand made routines ever do.This is a great question.First, don't escape text on input except to make it safe for storage (such as being put into a database). The reason for this is you want to keep what was input so you can contextually present it in different ways and places. Making changes here can compromise your later presentation.When you go to present your data filter out what shouldn't be there. For example, if there isn't a reason for javascript to be there search for it and remove it. An easy way to do that is to use the strip_tags function and only present the html tags you are allowing.Next, take what you have and pass it thought htmlentities or htmlspecialchars to change what's there to ascii characters. Do this based on context and what you want to get out.I'd, also, suggest turning off Magic Quotes. It is has been removed from PHP 6 and is considered bad practice to use it. Details at http://us3.php.net/magic_quotesFor more details check out http://ha.ckers.org/xss.htmlThis isn't a complete answer but, hopefully enough to help you get started.See Joel's essay on Making Code Look Wrong for help with this I rely on PHPTAL for that.Unlike Smarty and plain PHP, it escapes all output by default. This is a big win for security, because your site won't become vurnelable if you forget htmlspecialchars() or |escape somewhere.XSS is HTML-specific attack, so HTML output is the right place to prevent it. You should not try pre-filtering data in the database, because you could need to output data to another medium which doesn't accept HTML, but has its own risks.Template library. Or at least, that is what template libraries should do.

To prevent XSS all output should be encoded. This is not the task of the main application / control logic, it should solely be handled by the output methods.If you sprinkle htmlentities() thorughout your code, the overall design is wrong. And as you suggest, you might miss one or two spots.

That's why the only solution is rigorous html encoding -> when output vars get written into a html/xml stream.Unfortunately, most php template libraries only add their own template syntax, but don't concern themselves with output encoding, or localization, or html validation, or anything important. Maybe someone else knows a proper template library for php?Escaping all user input is enough for most sites. Also make sure that session IDs don't end up in the URL so they can't be stolen from the Referer link to another site. Additionally, if you allow your users to submit links, make sure no javascript: protocol links are allowed; these would execute a script as soon as the user clicks on the link.If you are concerned about XSS attacks, encoding your output strings to HTML is the solution. If you remember to encode every single output character to HTML format, there is no way to execute a successful XSS attack.Read more:

Sanitizing user data: How and where to do itPersonally, I would disable magic_quotes. In PHP5+ it is disabled by default and it is better to code as if it is not there at all as it does not escape everything and it will be removed from PHP6.Next, depending on what type of user data you are filtering will dictate what to do next e.g. if it is just text e.g. a name, then strip_tags(trim(stripslashes())); it or to check for ranges use regular expressions.If you expect a certain range of values, create an array of the valid values and only allow those values through (in_array($userData, array(...))).If you are checking numbers use is_numeric to enforce whole numbers or cast to a specific type, that should prevent people trying to send strings in stead.If you have PHP5.2+ then consider looking at filter() and making use of that extension which can filter various data types including email addresses. Documentation is not particularly good, but is improving.If you have to handle HTML then you should consider something like PHP Input Filter or HTML Purifier. HTML Purifier will also validate HTML for conformance. I am not sure if Input Filter is still being developed. Both will allow you to define a set of tags that can be used and what attributes are allowed.Whatever you decide upon, always remember, never ever trust anything coming into your PHP script from a user (including yourself!).All of these answers are great, but fundamentally, the solution to XSS will be to stop generating HTML documents by string manipulation.Filtering input is always a good idea for any application.Escaping your output using htmlentities() and friends should work as long as it's used properly, but this is the HTML equivalent of creating a SQL query by concatenating strings with mysql_real_escape_string($var) - it should work, but fewer things can validate your work, so to speak, compared to an approach like using parameterized queries.The long-term solution should be for applications to construct the page internally, perhaps using a standard interface like the DOM, and then to use a library (like libxml) to handle the serialization to XHTML/HTML/etc.  Of course, we're a long ways away from that being popular and fast enough, but in the meantime we have to build our HTML documents via string operations, and that's inherently more risky.I find that using this function helps to strip out a lot of possible xss attacks:

http://www.codebelay.com/killxss.phps「Magic quotes」is a palliative remedy for some of the worst XSS flaws which works by escaping everything on input, something that's wrong by design. The only case where one would want to use it is when you absolutely must use an existing PHP application known to be written carelessly with regard to XSS. (In this case you're in a serious trouble even with「magic quotes」.) When developing your own application, you should disable「magic quotes」and follow XSS-safe practices instead.XSS, a cross-site scripting vulnerability, occurs when an application includes strings from external sources (user input, fetched from other websites, etc) in its [X]HTML, CSS, ECMAscript or other browser-parsed output without proper escaping, hoping that special characters like less-than (in [X]HTML), single or double quotes (ECMAscript) will never appear. The proper solution to it is to always escape strings according to the rules of the output language: using entities in [X]HTML, backslashes in ECMAscript etc.Because it can be hard to keep track of what is untrusted and has to be escaped, it's a good idea to always escape everything that is a「text string」as opposed to「text with markup」in a language like HTML. Some programming environments make it easier by introducing several incompatible string types:「string」(normal text),「HTML string」(HTML markup) and so on. That way, a direct implicit conversion from「string」to「HTML string」would be impossible, and the only way a string could become HTML markup is by passing it through an escaping function.「Register globals」, though disabling it is definitely a good idea, deals with a problem entirely different from XSS.Make you any session cookies (or all cookies) you use HttpOnly. Most browsers will hide the cookie value from JavaScript in that case. User could still manually copy cookies, but this helps prevent direct script access. StackOverflow had this problem durning beta. This isn't a solution, just another brick in the wall You should at least validate all data going into the database. And try to validate all data leaving the database too.mysql_real_escape_string is good to prevent SQL injection, but XSS is trickier.

You should preg_match, stip_tags, or htmlentities where possible!The best current method for preventing XSS in a PHP application is HTML Purifier (http://htmlpurifier.org/).  One minor drawback to it is that it's a rather large library and is best used with an op code cache like APC.  You would use this in any place where untrusted content is being outputted to the screen. It is much more thorough that htmlentities, htmlspecialchars, filter_input, filter_var, strip_tags, etc.Use an existing user-input sanitization library to clean all user-input. Unless you put a lot of effort into it, implementing it yourself will never work as well.I find the best way is using a class that allows you to bind your code so you never have to worry about manually escaping your data.It is difficult to implement a thorough sql injection/xss injection prevention on a site that doesn't cause false alarms. In a CMS the end user might want to use <script> or <object> that links to items from another site. I recommend having all users install FireFox with NoScript ;-)

Need an array-like structure in PHP with minimal memory usage

Alexander Tobias Bockstaller

[Need an array-like structure in PHP with minimal memory usage](https://stackoverflow.com/questions/21333474/need-an-array-like-structure-in-php-with-minimal-memory-usage)

In my PHP script I need to create an array of >600k integers. Unfortunately my webservers memory_limit is set to 32M so when initializing the array the script aborts with message I am aware of the fact, that PHP does not store the array values as plain integers, but rather as zvalues which are much bigger than the plain integer value (8 bytes on my 64-bit system). I wrote a small script to estimate how much memory each array entry uses and it turns out, that it's pretty exactly 128 bytes. 128!!! I'd need >73M just to store the array. Unfortunately the webserver is not under my control so I cannot increase the memory_limit.My question is, is there any possibility in PHP to create an array-like structure that uses less memory. I don't need this structure to be associative (plain index-access is sufficient). It also does not need to have dynamic resizing - I know exactly how big the array will be. Also, all elements would be of the same type. Just like a good old C-array.Edit:

So deceze's solution works out-of-the-box with 32-bit integers. But even if you're on a 64-bit system, pack() does not seem to support 64-bit integers. In order to use 64-bit integers in my array I applied some bit-manipulation. Perhaps the below snippets will be of help for someone:

2014-01-24 13:05:41Z

In my PHP script I need to create an array of >600k integers. Unfortunately my webservers memory_limit is set to 32M so when initializing the array the script aborts with message I am aware of the fact, that PHP does not store the array values as plain integers, but rather as zvalues which are much bigger than the plain integer value (8 bytes on my 64-bit system). I wrote a small script to estimate how much memory each array entry uses and it turns out, that it's pretty exactly 128 bytes. 128!!! I'd need >73M just to store the array. Unfortunately the webserver is not under my control so I cannot increase the memory_limit.My question is, is there any possibility in PHP to create an array-like structure that uses less memory. I don't need this structure to be associative (plain index-access is sufficient). It also does not need to have dynamic resizing - I know exactly how big the array will be. Also, all elements would be of the same type. Just like a good old C-array.Edit:

So deceze's solution works out-of-the-box with 32-bit integers. But even if you're on a 64-bit system, pack() does not seem to support 64-bit integers. In order to use 64-bit integers in my array I applied some bit-manipulation. Perhaps the below snippets will be of help for someone:The most memory efficient you'll get is probably by storing everything in a string, packed in binary, and use manual indexing to it.This can be feasible if the "array" initialisation can be done in one fell swoop and you're just reading from the structure. If you need a lot of appending to the string, this becomes extremely inefficient. Even this can be done using a resource handle though:This is very efficient. You can then read this buffer back into a variable and use it as string, or you can continue to work with the resource and fseek.A PHP Judy Array will use significantly less memory than a standard PHP array, and an SplFixedArray.I quote "An array with 1 million entries using regular PHP array data structure takes 200MB. SplFixedArray uses around 90 megabytes. Judy uses 8 megs. Tradeoff is in performance, Judy takes about double the time of regular php array implementation."You could use an object if possible. These often use less memory than array's.

Also SplFixedArray is an good option.But it really depends on the implementation that you need to do. If you need an function to return an array and are using PHP 5.5. You could use the generator yield to stream the array back.You can try to use a SplFixedArray, it's faster and take less memory (the doc comment say ~30% less). Test here and here.Use a string - that's what I'd do. Store it in a string on fixed offsets (16 or 20 digits should do it I guess?) and use substr to get the one needed. Blazing fast write / read, super easy, and 600.000 integers will only take ~12M to store.base_convert() - if you need something more compact but with minimum effort, convert your integers to base-36 instead of base-10; in this case, a 14-digit number would be stored in 9 alphanumeric characters. You'll need to make 2 pieces of 64-bit ints, but I'm sure that's not a problem. (I'd split them to 9-digit chunks where conversion gives you a 6-char version.)pack()/unpack() - binary packing is the same thing with a bit more efficiency. Use it if nothing else works; split your numbers to make them fit to two 32-bit pieces.600K is a lot of elements.  If you are open to alternative methods, I personally would use a database for that.  Then use standard sql/nosql select syntax to pull things out.  Perhaps memcache or redis if you have an easy host for that, such as garantiadata.com.  Maybe APC.  Depending on how you are generate the integers, you could potentially use PHP's generators, assuming you are traversing the array and doing something with individual values.I took the answer by @deceze and wrapped it in a class that can handle 32-bit integers.  It is append-only, but you can still use it as a simple, memory-optimized PHP Array, Queue, or Heap.  AppendItem and ItemAt are both O(1), and it has no memory overhead.  I added currentPosition/currentSize to avoid unnecessary fseek function calls.  If you need to cap memory usage and switch to a temporary file automatically, use php://temp instead.

php.ini & SMTP= - how do you pass username & password

Charles Faiga

[php.ini & SMTP= - how do you pass username & password](https://stackoverflow.com/questions/112190/php-ini-smtp-how-do-you-pass-username-password)

My ISP account requires that I send a username & password for outbound SMTP mail. How do I get PHP to use this when executing php.mail()? The php.ini file only contains entries for the server (SMTP= ) and From: (sendmail_from= ).

2008-09-21 21:11:35Z

My ISP account requires that I send a username & password for outbound SMTP mail. How do I get PHP to use this when executing php.mail()? The php.ini file only contains entries for the server (SMTP= ) and From: (sendmail_from= ).PHP mail() command does not support authentication. Your options:I apply following details on php.ini file. its works fine.These details are same as on outlook settings.Use Fake sendmail for Windows to send mail. PHP does have authentication on the mail-command!The following is working for me on WAMPSERVER (windows, php 5.2.17)php.iniI prefer the PHPMailer tool as it doesn't require PEAR. But either way, you have a misunderstanding: you don't want a PHP-server-wide setting for the SMTP user and password. This should be a per-app (or per-page) setting. If you want to use the same account across different PHP pages, add it to some kind of settings.php file.Now PHP will run mail as usual with the sendmail -t -i command and Postfix will intercept it and relay it to your SMTP server that you provided.After working all day on this, I finally found a solution. Here's how I send from Windows XP with WAMP.Reference:These answers are outdated and depreciated.

Best practice..The next on your sendmail.php file just require the following This can be configure how ever you like..Use Mail::factory in the Mail PEAR package. Example."SMTP = localhost","smtp_port = 25","; sendmail_path = ".Credit: How to configure WAMP (localhost) to send email using Gmail?

Breaking the nested loop [duplicate]

user1355300

[Breaking the nested loop [duplicate]](https://stackoverflow.com/questions/11609532/breaking-the-nested-loop)

I'm having problem with nested loop. I have multiple number of posts, and each post has multiple number of images. I want to get total of 5 images from all posts. So I am using nested loop to get the images, and want to break the loop when the number reaches to 5. The following code will return the images, but does not seem to break the loop.

2012-07-23 09:12:32Z

I'm having problem with nested loop. I have multiple number of posts, and each post has multiple number of images. I want to get total of 5 images from all posts. So I am using nested loop to get the images, and want to break the loop when the number reaches to 5. The following code will return the images, but does not seem to break the loop.

Unlike other languages such as C/C++, in PHP you can use the optional param of break like this:In this case if you have two loops such that:break 2 will skip both while loops.Doc: http://php.net/manual/en/control-structures.break.phpThis makes jumping over nested loops more readable than for example using goto of other languagesUse a while loop

Remove all non-alphanumeric characters using preg_replace

lisovaccaro

[Remove all non-alphanumeric characters using preg_replace](https://stackoverflow.com/questions/11321048/remove-all-non-alphanumeric-characters-using-preg-replace)

How can I remove all non alphanumeric characters from a string in PHP?This is the code, that I'm currently using:It only replaces blank spaces.

2012-07-04 00:38:25Z

How can I remove all non alphanumeric characters from a string in PHP?This is the code, that I'm currently using:It only replaces blank spaces.At first take this is how I'd do itHope this helps!Not sure why no-one else has suggested this, but this seems to be the simplest regex:You can see it in action here, too: http://phpfiddle.org/lite/code/0sg-314You can use,You can use for unicode characters,Seems to work, actually the example was in PHP documentation on preg_replace

base_url() function not working in codeigniter

Sanks R

[base_url() function not working in codeigniter](https://stackoverflow.com/questions/6449386/base-url-function-not-working-in-codeigniter)

In my web application using codeigniter. I am trying to use base_url() function but it shows empty results. I have also used autoload helper through autoload file, but then too it doesn't seem to work. Also I had defined base constants but all in vain.

2011-06-23 04:36:54Z

In my web application using codeigniter. I am trying to use base_url() function but it shows empty results. I have also used autoload helper through autoload file, but then too it doesn't seem to work. Also I had defined base constants but all in vain.In order to use base_url(), you must first have the URL Helper loaded. This can be done either in application/config/autoload.php (on or around line 67):Or, manually:Once it's loaded, be sure to keep in mind that base_url() doesn't implicitly print or echo out anything, rather it returns the value to be printed:Remember also that the value returned is the site's base url as provided in the config file. CodeIgniter will accomodate an empty value in the config file as well:If you want to use base_url(), so we need to load url helper.Then you can user base_url() anywhere in controller or view.Check if you have something configured inside the config file /application/config/config.php e.g.I think you haven't edited codeigniter files to enable base_url(). you try to assign it in url_helper.php you also can do the same config/autoload.php file. you can add this code in your autoload.phpThan You will be able to ue base_url() like thisFirst of all load URL helper. you can load in  "config/autoload.php" file and add following code 

$autoload['helper'] = array('url');or in controller add following code then go to config.php in cofig folder and sethope this will help

thanksFirst of all you must load the url helper file to your projectThen you will get base_url by Read more about base_url hereIf you don't want to use the url helper, you can get the same results by using the following variable:It will return the base url for you with no extra steps required.Load url helper in controller $this->load->helper('url'); Anything if you use directly in the Codeigniter framework directly, like base_url(), uri_string(), or word_limiter(), All of these are coming from some sort of Helper function of framework.While some of Helpers may be available globally to use just like log_message() which are extremely useful everywhere, rest of the Helpers are optional and use case varies application to application. base_url() is a function defined in url helper of the Framework.You can learn more about helper in Codeigniter user guide's helper section.You can use base_url() function once your current class have access to it, for which you needs to load it first.You can use this line anywhere in the application before using the base_url() function.If you need to use it frequently, I will suggest adding this function in config/autoload.php in the autoload helpers section.Also, make sure you have well defined base_url value in your config/config.php file.This will be the first configuration you will see,You can check quickly byReference: https://codeigniter.com/user_guide/helpers/url_helper.htmlQuestion -I wanted to load my css file but it was not working even though i autoload and manual laod why ? i found the solution =>

here is my solution :

application>config>config.php 

$config['base_url'] = 'http://localhost/CodeIgniter/';    //paste the link to base url question explanation:" >

i had my bootstrap.min.css file inside assets/css folder where assets is root directory which i was created.But it was not working even though when i loaded ?

1.               $autoload['helper'] = array('url');

2.               $this->load->helper('url'); in my controllar then i go to my I encountered with this issue spending couple of hours, however solved it in different ways. You can see, I have just created an assets folder outside application folder. Finally I linked my style sheet in the page header section. Folder structure are below images.

Before action this you should include url helper file either in your controller class method/__constructor files or by in autoload.php file. Also change $config['base_url'] = 'http://yoursiteurl'; in the following file application/config/config.phpIf you include it in controller class method/__constructor then it look likeor If you load in autoload file then it would looks likeFinally, add your stylesheet file.

You can link a style sheet by different ways, include it in your inside   section-><link rel="stylesheet" href="<?php echo base_url();?>assets/css/style.css" type="text/css" />-> or -> orfinally I get more reliable code cleaner concept. Just create a config file, named styles.php in you application/config/styles.php folder.

 Then add some links in styles.php file looks like belowcall/add this config to your controller class method looks like belowPass this data in your header template looks like below.And finally add or  link your css file looks like below.

Laravel Escaping All HTML in Blade Template

Dr.Neo

[Laravel Escaping All HTML in Blade Template](https://stackoverflow.com/questions/26023823/laravel-escaping-all-html-in-blade-template)

I'm building a small CMS in Laravel and I tried to show the content (which is stored in the DB). It is showing the HTML tags instead of executing them. Its like there is an auto html_entity_decode for all printed data.I tried to print the content using the curly brace.and triple curly brace.And they give the same result. I need to execute those HTML tags instead of escaping them.

2014-09-24 18:21:02Z

I'm building a small CMS in Laravel and I tried to show the content (which is stored in the DB). It is showing the HTML tags instead of executing them. Its like there is an auto html_entity_decode for all printed data.I tried to print the content using the curly brace.and triple curly brace.And they give the same result. I need to execute those HTML tags instead of escaping them.Change your syntax from {{ }} to {!! !!}.As The Alpha said in a comment above (not an answer so I thought I'd post), in Laravel 5, the {{ }} (previously non-escaped output syntax) has changed to {!! !!}. Replace {{ }}  with {!! !!} and it should work.use this tag {!! description text !!}Include the content in {!  !} .I had the same issue. Thanks for the answers above, I solved my issue. If there are people facing the same problem, here is two way to solve it:I hope it helps.There is no problem with displaying HTML code in blade templates.For test, you can add to routes.php only one route:and in hello.blade.php file:For the following code you will get output as on imageSo probably page_desc in your case is not what you expect. But as you see it can be potential dangerous if someone uses for example '` tag so you should probably in your route before assigning to blade template filter some tagsEDITI've also tested it with putting the same code into database:Output is exactly the same in this caseEdit2I also don't know if Pages is your model or it's a vendor model. For example it can have accessor inside:and then when you get page_desc attribute you will get modified page_desc with htmlspecialchars. So if you are sure that data in database is with raw html (not escaped) you should look at this Pages class{{html_entity_decode ($post->content())}} saved the issue for me with Laravel 4.0. Now My HTML content is interpreted as it should. 

Is there a Twig shorthand syntax for outputting conditional text

Justin

[Is there a Twig shorthand syntax for outputting conditional text](https://stackoverflow.com/questions/13336090/is-there-a-twig-shorthand-syntax-for-outputting-conditional-text)

Is there a shorter syntax in Twig to output a conditional string of text?Traditional php is even easier than this:

2012-11-11 22:23:28Z

Is there a shorter syntax in Twig to output a conditional string of text?Traditional php is even easier than this:This should work:Also, this is called the ternary operator. It's kind of hidden in the documenation: twig docs: operatorsFrom their documentation the basic structure is:If you need to compare the value is equal to something you can do :You can use the Elvis Operator inside twig :The null-coalescing operator also working, like:

How to check if class exists within a namespace?

Taruo Gene

[How to check if class exists within a namespace?](https://stackoverflow.com/questions/22407370/how-to-check-if-class-exists-within-a-namespace)

I've got this:Well... this behaviour is quite irrational (creating objects of classes that according to PHP do not exist). Is there any way to check if a class exist under given namespace?

2014-03-14 14:09:41Z

I've got this:Well... this behaviour is quite irrational (creating objects of classes that according to PHP do not exist). Is there any way to check if a class exist under given namespace?In order to check class you must specify it with namespace, full path:and-i.e. you must specify full path to class. You defined it in your namespace and not in global context. However, if you do import the class within the namespace like you do in your sample, you can reference it via imported name and without namespace, but that does not allow you to do that within dynamic constructions and in particular, in-line strings that forms class name. For example, all following will fail:and so on. The issue lies within the mechanics of working for imported aliases. So when working with such constructions, you have to specify full path:The issue (as mentioned in the class_exists() manual page user notes) is that aliases aren't taken into account whenever a class name is given as a string. This also affects other functions that take a class name, such as is_a(). Consequently, if you give the class name in a string, you must include the full namespace (e.g. '\XXX\Driver\Driver', 'XXX\\Driver\\Driver').PHP 5.5 introduced the class constant for just this purpose:

How do I escape only single quotes?

Andrew

[How do I escape only single quotes?](https://stackoverflow.com/questions/6269188/how-do-i-escape-only-single-quotes)

I am writing some JavaScript code that uses a string rendered with PHP. How can I escape single quotes (and only single quotes) in my PHP string?

2011-06-07 17:26:42Z

I am writing some JavaScript code that uses a string rendered with PHP. How can I escape single quotes (and only single quotes) in my PHP string?Quite simply: echo str_replace('\'', '\\\'', $myString);

However, I'd suggest use of JSON and json_encode() function as it will be more reliable (quotes new lines for instance):If you want to escape characters with a \, you have addcslashes(). For example, if you want to escape only single quotes like the question, you can do:And if you want to escape ', ", \, and nul (the byte null), you can use addslashes():In some cases, I just convert it into ENTITIES:On the HTML page, the visual output is the same:However, it is sanitized in source.To replace only single quotes, use this simple statement:Use the native function htmlspecialchars. It will escape from all special character. If you want to escape from a quote specifically, use with ENT_COMPAT or ENT_QUOTES. Here is the example:The output would be like this:Read more in PHP htmlspecialchars() Function You can use the addcslashes function to get this done like so:After a long time fighting with this problem, I think I have found a better solution.The combination of two functions makes it possible to escape a string to use as HTML.One, to escape double quote if you use the string inside a JavaScript function call; and a second one to escape the single quote, avoiding those simple quotes that go around the argument.Solution:Solve:Here is how I did it. Silly, but simple.I was working on outputting HTML that called JavaScript code to show a picture...I am not sure what exactly you are doing with your data, but you could always try:I use this whenever strings are sent to a database for storage.%27 is the encoding for the ' character, and it also helps to prevent disruption of GET requests if a single ' character is contained in a string sent to your server.  I would replace ' with %27 in both JavaScript and PHP just in case someone tries to manually send some data to your PHP function.To make it prettier to your end user, just run an inverse replace function for all data you get back from your server and replace all %27 substrings with '.Happy injection avoiding!I wrote the following function. It replaces the following:Single quote ['] with a slash and a single quote [\'].Backslash [\] with two backslashes [\\]You can modify it to add or remove character replacements in the $replacements array. For example, to replace \r\n, it becomes "\r\n" => "\r\n" and "\n" => "\n".The neat feature about strtr is that it will prefer long replacements.Example, "Cool\r\nFeature" will escape \r\n rather than escaping \n along.

Convert a string to JSON object php

user2363025

[Convert a string to JSON object php](https://stackoverflow.com/questions/17488207/convert-a-string-to-json-object-php)

I have the following result from an sql query:It is currently a string in php, is there an easy way to convert this to a JSON object (I know it's already in JSON form). I need it to be an object so I can add an extra item/element/object like what coords already isEDIT: SORRY GUYS, I PASTED AN OLD/WRONG STRING!

2013-07-05 11:49:32Z

I have the following result from an sql query:It is currently a string in php, is there an easy way to convert this to a JSON object (I know it's already in JSON form). I need it to be an object so I can add an extra item/element/object like what coords already isEDIT: SORRY GUYS, I PASTED AN OLD/WRONG STRING!What @deceze said is correct, it seems that your JSON is malformed, try this:Use json_decode to convert String into Object (stdClass) or array: http://php.net/manual/en/function.json-decode.php[edited]I did not understand what do you mean by "an official JSON object", but suppose you want to add content to json via PHP and then converts it right back to JSON?assuming you have the following variable:You should convert it to Object (stdClass):$manage = json_decode($data);But working with stdClass is more complicated than PHP-Array, then try this (use second param with true):$manage = json_decode($data, true);This way you can use array functions: http://php.net/manual/en/function.array.phpadding an item:remove first item:any chance you want to save to json to a database or a file:I hope I have understood your question.Good luck.To convert a valid JSON string back, you can use the json_decode() method.To convert it back to an object use this method:And to convert it to a associative array, set the second parameter to true:By the way to convert your mentioned string back to either of those, you should have a valid JSON string. To achieve it, you should do the following:And you will have a valid JSON String.. Here is your JSON String I converted to a valid one: http://pastebin.com/R16NVerwyou can use this for examplebut validate the Json before. You can validate from http://jsonviewer.stack.hu/Try with json_encode().And look again Valid JSON

Best method of including views within views in CodeIgniter

David

[Best method of including views within views in CodeIgniter](https://stackoverflow.com/questions/15221371/best-method-of-including-views-within-views-in-codeigniter)

I'm starting a large codeigniter project and would like to try to create some reusable 'mini' views for snippets of content like loops of data which may be displayed on different pages/controllers.Is it better to call the views from within the main controller's view? If so, how? Or should I call the 'mini view' from the controller and thus pass the view's code to the main view?

2013-03-05 10:23:55Z

I'm starting a large codeigniter project and would like to try to create some reusable 'mini' views for snippets of content like loops of data which may be displayed on different pages/controllers.Is it better to call the views from within the main controller's view? If so, how? Or should I call the 'mini view' from the controller and thus pass the view's code to the main view?Views within other views are called Nested views.

There are two ways of including nested views in CodeIgniter:Load the view in advance and pass to the other view. First put this in the controller:Then put <?=$menu?> in your view at the point you want the menu to appear.First put this in the controller:Then put this in the /application/views/home.php view:About best method, I prefer the 1st method over 2nd one, because by using 1st method I don't have to mix up code, it is not like include php. Although indirectly both are same, the 1st method is clearer & cleaner than 2nd one!Honestly I prefer to do this by having template views then loading that with the necessary data from the controller, it means a lot less repeated code and follows the DRY concept better than loading views from views. Especially for things like headers, footers and menus.So my template view would look something like this:template.phpThen in my controller I pass the data required to the template like this:There are a number of benefits to doing it this way. First is I can have multiple templates, for example I have, in my case, two main ones, one for full page views without a sidebar and one for pages with a sidebar, I also call an if statement to decide which header to include, the regular one or the one with the admin menu in it.Yes I could include the header, sidebar and footer in every main view page, but that ends up in a ton of duplicate code. And what happens if for example I want all my pages to have something new, some other small snippet? Using templates I add the snippet to the appropriate template and it's done. Going the other route I find every page and add the snippet view there, it's the equivalent to having CSS in the page in my opinion, wasteful and not ultimately maintainable.METHOD 1I use this method into my view to insert the include view where I want METHOD 2or in the controller you can load more than a view like this:No one method is better than the other, it depends if you have to pass some data (in this case use method2) or if you want to include a view in a specific part of your main view (in this case is better to use method1)METHOD 3Passing data to your include view by your main viewinto your controller:in your viewIf you want to pass entire data to your include view you can do in this way:

in your controller:in your viewThis a simple way of including views within views.there is no need to load views in advance.just pass view path to other view.In your controller use this:and in main_template_view you can include other views :In my opinion for solve in more efficient way this problem I have done so:You create a new helper (in application/helpers) with name (es. common_helpers.php, the underscore is important). In this file, you put all the functions for example build pieces of html in common.In your controller you call only one view in respect of MVC and call the functions from your custom helper.controller 

PHP cURL HTTP PUT

user601513

[PHP cURL HTTP PUT](https://stackoverflow.com/questions/5043525/php-curl-http-put)

I am trying to create a HTTP PUT request with cURL and I can't make it work. I've read many tutorials but none of them actually worked. Here's my current code:I've also tried using PHP PEAR but got the same result. The problem is that the repository says that no metadata has been set. I really need help! Thanks!

2011-02-18 15:59:54Z

I am trying to create a HTTP PUT request with cURL and I can't make it work. I've read many tutorials but none of them actually worked. Here's my current code:I've also tried using PHP PEAR but got the same result. The problem is that the repository says that no metadata has been set. I really need help! Thanks!Just been doing that myself today... here is code I have working for me...src: http://www.lornajane.net/posts/2009/putting-data-fields-with-php-curlUsing Postman for Chrome, selecting CODE you get this...  And worksIn a POST method, you can put an array. However, in a PUT method, you should use http_build_query to build the params like this:You have mixed 2 standard.The error is in $header = "Content-Type: multipart/form-data; boundary='123456f'";The function http_build_query($filedata) is only for "Content-Type: application/x-www-form-urlencoded", or none.

PHP how to import all classes from another namespace

Rob

[PHP how to import all classes from another namespace](https://stackoverflow.com/questions/7121682/php-how-to-import-all-classes-from-another-namespace)

I'm implementing namespaces in my existing project. I found that you can use the keyword 'use' to import classes into your namespace. My question is, can I also import all the classes from 1 namespace into another. Example:Update for PHP 7+A new feature in PHP 7 is grouped declarations. This doesn't make it as easy as using 1 'use statement' for all the classes in a given namespace, but makes it somewhat easier...Example code:See also: https://secure.php.net/manual/en/migration70.new-features.php#migration70.new-features.group-use-declarations

2011-08-19 12:37:42Z

I'm implementing namespaces in my existing project. I found that you can use the keyword 'use' to import classes into your namespace. My question is, can I also import all the classes from 1 namespace into another. Example:Update for PHP 7+A new feature in PHP 7 is grouped declarations. This doesn't make it as easy as using 1 'use statement' for all the classes in a given namespace, but makes it somewhat easier...Example code:See also: https://secure.php.net/manual/en/migration70.new-features.php#migration70.new-features.group-use-declarationsThis is not possible in PHP.All you can do is:You can use the "as" for shortening and aliasing long namespacescomposer.json  }  index.php  

PHP Configuration: It is not safe to rely on the system's timezone settings [duplicate]

Ole Media

[PHP Configuration: It is not safe to rely on the system's timezone settings [duplicate]](https://stackoverflow.com/questions/2213608/php-configuration-it-is-not-safe-to-rely-on-the-systems-timezone-settings)

Here a weird one. 

I just upgrade to php 5.3.0 and since the upgrade I'm getting the following warning:After looking in various forums, everybody says that to solve the problem, all you have to do is edit the date zone in the php.ini and restart Apache.It did not work for me. I tried  Restarted apache after I made the change.Since I still have the older version of php install, I even made sure that I'm editing the php.ini that the current version of php uses at the time to load /usr/local/php5/lib/php.iniStill getting the warning. Any suggestions? Thanks for taking the time.

2010-02-06 15:31:53Z

Here a weird one. 

I just upgrade to php 5.3.0 and since the upgrade I'm getting the following warning:After looking in various forums, everybody says that to solve the problem, all you have to do is edit the date zone in the php.ini and restart Apache.It did not work for me. I tried  Restarted apache after I made the change.Since I still have the older version of php install, I even made sure that I'm editing the php.ini that the current version of php uses at the time to load /usr/local/php5/lib/php.iniStill getting the warning. Any suggestions? Thanks for taking the time.Tchalvak, who commented on the original question, hit the nail on the head for me. I've been editing (I use Debian):...which had the correct timezone for me and was the only .ini file being loaded with date.timezone within it, but I was receiving the above error when I ran a script through Bash. I had no idea that I should have been editing:as well. (Well, for me it was 'as well', for you it might be different of course, but I'm going to keep my Apache and CLI versions of php.ini synchronised now).Did you try to set timezone by func:

http://pl.php.net/manual/en/function.date-default-timezone-set.phpI happened to have to set up Apache & PHP on two laptops recently. After much weeping and gnashing of teeth, I noticed in phpinfo's output that (for whatever reason: not paying attention during PHP install, bad installer) Apache expected php.ini to be somewhere where it wasn't. Two choices: ... and restart Apache. Timezone settings should be recognized at that point.Open your .htaccess file , add this line to the file, save, and try again :This works for me.try this, it works for me.In the actual file that was complaining. Check for syntax errors in the php.ini file, specially before the Date paramaters, that prevent the file from being parsed correctly.Please modify your index.php as follows:Obviously I'm a little out of season on this question but for the benefit of the next sufferer: I just had this problem and in my case (in contrast to OP who tried the same without success) the fix was to revise php.ini, changing to That is adding the underscore.I modified /etc/php.ini [Date]

; Defines the default timezone used by the date functions

; http://php.net/date.timezone

date.timezone =('Asia/kolkata')and now working fine.Vipin PalYou may have forgot to remove the semicolon to uncomment that line. For the date.timezone = "US/Central" line, be sure that there's no semicolon in front of that line. I found, bizarrely, that I could fix the errors by placing the timezone declaration at the TOP of my php.ini file. It was already in my php.ini. Twice, actually. And I was pulling my hair out because everyone was saying there must be another ini being loaded... There wasn't.Hope this can save someone else the time/hair loss.also you can try this

What does @ mean in PHP? [duplicate]

FlyingCat

[What does @ mean in PHP? [duplicate]](https://stackoverflow.com/questions/3621215/what-does-mean-in-php)

I was wondering what @ means in PHP language. I have seen people using Not sure why. Could someone explain it for me?

2010-09-01 18:54:40Z

I was wondering what @ means in PHP language. I have seen people using Not sure why. Could someone explain it for me?The @ operator tells PHP to suppress error messages, so that they will not be shown.For instance, using:would result in a warning being shown, telling you that the MySQL query is invalid, whilewould not.Note, however, that this is very bad programming practice as it does not make error disappear, it just hides them, and it makes debugging a heck of a lot worse since you can't see what's actually wrong with your code.Instead of using @, you should disable error_reporting and display_errors just display_errors in php.iniThe @ sign tells PHP to ignore error messages.PHP Error Control OperatorsIt's an error control operator.The @ is a way to tell that you don't want to print error messages. It's a bad practice because you might have an error and never see it because you just "hid" it.Resources :@ Operator = Indicates that if there is any kind of error occur, then don't display the message in the user's browser. There are people who test this and didn't see the difference even they put the @ or not they still don't see any error in the browser, well just to add up, the reason why this happen is because of the setting in the php.ini file for error output is turn off.Different hosting company have different setting so to make sure that you don't want to see any ugly script error for the users or hackers(for them to give a clue to infiltrate you site) you can always use the @ operator.Hope this help.

php.ini: which one?

HappyDeveloper

[php.ini: which one?](https://stackoverflow.com/questions/10665783/php-ini-which-one)

I moved from my old apache to nginx and php 5.3.10. And when I tried to modify php.ini to suit my needs, I found there are 3 of them:Which one should I edit?

2012-05-19 13:57:10Z

I moved from my old apache to nginx and php 5.3.10. And when I tried to modify php.ini to suit my needs, I found there are 3 of them:Which one should I edit?Generally speaking, the cli/php.ini file is used when the PHP binary is called from the command-line.

You can check that running php --ini from the command-line.fpm/php.ini will be used when PHP is run as FPM -- which is the case with an nginx installation.

And you can check that calling phpinfo() from a php page served by your webserver.cgi/php.ini, in your situation, will most likely not be used.

Using two distinct php.ini files (one for CLI, and the other one to serve pages from your webserver) is done quite often, and has one main advantages : it allows you to have different configuration values in each case.Typically, in the php.ini file that's used by the web-server, you'll specify a rather short max_execution_time : web pages should be served fast, and if a page needs more than a few dozen seconds (30 seconds, by default), it's probably because of a bug -- and the page's generation should be stopped.

On the other hand, you can have pretty long scripts launched from your crontab (or by hand), which means the php.ini file that will be used is the one in cli/. For those scripts, you'll specify a much longer max_execution_time in cli/php.ini than you did in fpm/php.ini.max_execution_time is a common example ; you could do the same with several other configuration directives, of course.Although Pascal's answer was detailed and informative it failed to mention some key information in the assumption that everyone knows how to use phpinfo()For those that don't:Navigate to your webservers root folder such as /var/www/Within this folder create a text file called info.phpEdit the file and type phpinfo()Navigate to the file such as: http://www.example.com/info.phpHere you will see the php.ini path under Loaded Configuration File:Make sure you delete info.php when you are done.It really depends on the situation, for me its in fpm as I'm using PHP5-FPM. A solution to your problem could be a universal php.ini and then using a symbolic link created like:Then any modifications you make will be in one general .ini file.

This is probably not really the best solution though, you might want to look into modifying some configuration so that you literally use one file, on one location. Not multiple locations hacked together.You can find what is the php.ini file used:Next, you can find the information in the Loaded Configuration file (so here it's /user/local/etc/php/php.ini)Sometimes, you have indicated (none), in this case you just have to put your custom php.ini that you can find here: http://git.php.net/?p=php-src.git;a=blob;f=php.ini-production;hb=HEADI hope this answer will help.

Can I parameterize the table name in a prepared statement?

GK1667

[Can I parameterize the table name in a prepared statement?](https://stackoverflow.com/questions/11312737/can-i-parameterize-the-table-name-in-a-prepared-statement)

I've used the mysqli_stmt_bind_param function several times. However, if I separate variables that I'm trying to protect against SQL injection I run into errors.Here's some code sample:Is it possible to somehow replace the .$new_table. concatenation with another question mark statement, make another bind parameter statement, or add onto the existing one to protect against SQL injection?Like this or some form of this:

2012-07-03 14:09:51Z

I've used the mysqli_stmt_bind_param function several times. However, if I separate variables that I'm trying to protect against SQL injection I run into errors.Here's some code sample:Is it possible to somehow replace the .$new_table. concatenation with another question mark statement, make another bind parameter statement, or add onto the existing one to protect against SQL injection?Like this or some form of this:Short answer to your question is "no".In the strictest sense, at the database level, prepared statements only allow parameters to be bound for "values" bits of the SQL statement.One way of thinking of this is "things that can be substituted at runtime execution of the statement without altering its meaning". The table name(s) is not one of those runtime values, as it determines the validity of the SQL statement itself (ie, what column names are valid) and changing it at execution time would potentially alter whether the SQL statement was valid.At a slightly higher level, even in database interfaces that emulate prepared statement parameter substitution rather than actually send prepared statements to the database, such as PDO, which could conceivably allow you to use a placeholder anywhere (since the placeholder gets replaced before being sent to the database in those systems), the value of the table placeholder would be a string, and enclosed as such within the SQL sent to the database, so SELECT * FROM ? with mytable as the param would actually end up sending SELECT * FROM 'mytable' to the database, which is invalid SQL.Your best bet is just to continue with but you absolutely should have a white-list of tables that you check against first if that $mytable is coming from user input.(Late answer, consult my side note).The same rule applies when trying to create a "database".You cannot use a prepared statement to bind a database.I.e.:will not work. Use a safelist instead.Side note: I added this answer (as a community wiki) because it often used to close questions with, where some people posted questions similar to this in trying to bind a database and not a table and/or column.

Making PHP var_dump() values display one line per value

user1320318

[Making PHP var_dump() values display one line per value](https://stackoverflow.com/questions/10116063/making-php-var-dump-values-display-one-line-per-value)

When I echo var_dump($_variable), I get one long, wrapping line with all varable's and values likeIs there a way I can make each value display on its own line for ease of reading? Something like this:

2012-04-12 00:59:38Z

When I echo var_dump($_variable), I get one long, wrapping line with all varable's and values likeIs there a way I can make each value display on its own line for ease of reading? Something like this:Yes, try wrapping it with <pre>, e.g.:I usually have  a nice function to handle output of an array, just to pretty it up a bit when debugging.Then just call itOr if you have an editor like that saves snippets so you can access them quicker instead of creating a function for each project you build or each page that requires just a quick test.For print_r:For var_dump():I use the above with PHP Storm. I have set it as a pr tab command.I've also researched this issue and not found the right answer.  This doesn't work for me:This will not provide a nice display of the array for me, with line breaks (I'm using Firefox 31.3.0)However, after some experimentation, this solved the problem (notice the php is closed at first):This solves the problem and displays a nice, easy-to-read array for me on my browser.  You see how the  tags are not wrapped in PHP; only the echo var_dump part is.If you got XDebug installed, you can use it's var_dump replacement. Quoting:You will likely want to tweak a few of the following settings:But keep in mind that XDebug will significantly slow down your code, even when it's just loaded. It's not advisable to run in on production servers. But hey, you are not var_dumping on production servers anyway, are you?var_export will give you a nice output. Examples from the docs:Will output:For me the right answer was Since var_dump($var) and var_export($var) do not return a string, you have to use var_export($var, true) to force var_export to return the result as a value.You can press Ctrl+U to view the source code. Most Browsers will prettify the output there.var_dump is the ugliest way to debug.Use output buffers: http://php.net/manual/de/function.ob-start.phpYet another option would be to use Output buffering and convert all the newlines in the dump to <br> elements, e.g.For devs needing something that works in the view source and the CLI, especially useful when debugging unit tests.Yields:Personally I like the replacement function provided by Symfony's var dumper componentInstall with composer require symfony/var-dumper and just use dump($var)It takes care of the rest. I believe there's also a bit of JS injected there to allow you to interact with the output a bit.  Wrap it in <pre> tags to preserve formatting.I really love var_export(). If you like copy/paste-able code, try:Or even something like this for color syntax highlighting:I did a similar solution. I've created a snippet to replace 'vardump' with this:Ps: I'm repeating the data with the last var_dump to get the filename and lineSo this:

Became this:

Let me know if this will help you.I didn't wanna stop using var_dump($variable);die(); and using pre tags and loops seems overkill to me, so since I am looking at the dump in a browser, I just right click the page and choose Inspect (I use Chrome). The Elements section of the Developer Tools show the variable in a very readable format.

Lumen: get URL parameter in a Blade view

Andrea

[Lumen: get URL parameter in a Blade view](https://stackoverflow.com/questions/31324801/lumen-get-url-parameter-in-a-blade-view)

I'm trying to get a url parameter from a view file.I have this url:and a view file named example.blade.php.From the controller I can get the parameter a with $request->input('a'). Is there a way to get such parameter from the view (without having to pass it from the controller to the view)? 

2015-07-09 17:51:52Z

I'm trying to get a url parameter from a view file.I have this url:and a view file named example.blade.php.From the controller I can get the parameter a with $request->input('a'). Is there a way to get such parameter from the view (without having to pass it from the controller to the view)? This works well:Where a is the url parameter.See more here: http://blog.netgloo.com/2015/07/17/lumen-getting-current-url-parameter-within-a-blade-view/The shortest way i have usedMore simple in Laravel 5.7 and 5.8Given your URL:The best way that I have found to get the value for 'a' and display it on the page is to use the following:However, if you want to use it within an if statement, you could use:Hope that helps someone! :) This works fine for me:Ex: to get pagination param on blade view: Laravel 5.8 You can publicly expose Input facade via an alias in config/app.php:And access url $_GET parameter values using the facade directly inside Blade view/template:As per official 5.8 docs:DocsLaravel 5.6:

How do I dynamically write a PHP object property name?

user658182

[How do I dynamically write a PHP object property name?](https://stackoverflow.com/questions/12571197/how-do-i-dynamically-write-a-php-object-property-name)

I have object properties in my code that look like this:The problem is I have 100s of field names and need to write the property name dynamically. Otherwise, the object name and the keys for the property will always be the same. So I tried:Hoping that the name of the property would dynamically be changed and access the correct values. But, I keep getting 'undefined property $field in stdClass::$field;More or less I am trying dynamically write the php before it executes so that it can output the proper values. Thoughts on how to approach this?

2012-09-24 19:03:56Z

I have object properties in my code that look like this:The problem is I have 100s of field names and need to write the property name dynamically. Otherwise, the object name and the keys for the property will always be the same. So I tried:Hoping that the name of the property would dynamically be changed and access the correct values. But, I keep getting 'undefined property $field in stdClass::$field;More or less I am trying dynamically write the php before it executes so that it can output the proper values. Thoughts on how to approach this?PHP 7 introduced changes to how indirect variables and properties are handled at the parser level (see the corresponding RFC for more details). This brings actual behavior closer to expected, and means that in this case $obj->$field[0] will produce the expected result.In cases where the (now improved) default behavior is undesired, curly braces can still be used to override it as shown below.Write the access like this:This "enclose with braces" trick is useful in PHP whenever there is ambiguity due to variable variables.Consider the initial code $obj->$field[0] -- does this mean "access the property whose name is given in $field[0]", or "access the element with key 0 of the property whose name is given in $field"? The braces allow you to be explicit.I think you are looking for variable-variable type notation which, when accessing values from other arrays/objects, is best achieved using curly bracket syntax like this:The magic method __get is you friend:Usage:Explanation: All your field data is stored in a array. As you access $myobj->myprop that property obviously does not exists in the class. That is where __get is called. __get looks up the name in the field array and returns the correct value.aboulfazl, since PHP 5.3.3 methods with the same name as the class won't be treated as constructor!This works but wasn't ask by the topic owner, Jon gives the awnser!I worked on some code that used dynamically created object properties. I thought that using dynamically created object properties was pretty cool (true, in my opinion). However, my program took 7 seconds to run. I removed the dynamic object properties and replaced them object properties declared as part of each class (public in this case). CPU time went from over 7 seconds to 0.177 seconds. That's pretty substantial.It is possible that I was doing something wrong in the way I was using dynamic object properties. It is also possible that my configuration is broken in some way. Of course, I should say that I have a very plain vanilla PHP configuration on my machine.today i face that challenge. I ended up with that style of developmentThe best way you can use instance of PHP default class Object to dynamically assign properties to it With Inheritance.

for Example:Now AnyProperty is Dynamically Declared.

How to strip trailing zeros in PHP

nhunston

[How to strip trailing zeros in PHP](https://stackoverflow.com/questions/5149129/how-to-strip-trailing-zeros-in-php)

Hi could anyone give me an explanation (and maybe an example) as to how would I go about stripping the trailing zeros from a number using PHP.For example: Would be turned in to:I am trying to strip the zeros to make it more readable. I tried using str_replace() but this replaced the zeros inside the number too (doh).Thanks =D

2011-03-01 00:13:09Z

Hi could anyone give me an explanation (and maybe an example) as to how would I go about stripping the trailing zeros from a number using PHP.For example: Would be turned in to:I am trying to strip the zeros to make it more readable. I tried using str_replace() but this replaced the zeros inside the number too (doh).Thanks =DForget all the rtrims, and regular expressions, coordinates are floats and should be treated as floats, just prepend the variable with (float) to cast it from a string to a float:output:The actual result you have are floats but passed to you as strings due to the HTTP Protocol, it's good to turn them back into thier natural form to do calculations etc on.Test case: http://codepad.org/TVb2Xyy3Note: Regarding the comment about floating point precision in PHP, see this: https://stackoverflow.com/a/3726761/353790Try with rtrim:If you have a decimal number terminating in 0's (e.g. 123.000), you may also want to remove the decimal separator, which may be different depending on the used locale. To remove it reliably, you may do the following:This of course is not a bullet-proof solution, and may not be the best one. If you have a number like 12300.00, it won't remove the trailing 0's from the integer part, but you can adapt it to your specific need.You'll run into a lot of trouble if you try trimming or other string manipulations. Try this way.Outputs:You can also use floatval(val);.results in Most of these solutions will trim significant digits in numbers such as "100" (no trailing decimal). Here's a simple solution that doesn't have this problem:I think that covers all the different scenarios.If you want to strip the excess zeros away from the end but only to a certain decimal place, this is a useful expression to do just that (for example 0.30000 will show 0.30 and 0.0003000 will show 0.0003).Of course the {2} controls the decimal place limit.In my case, I did the following, extending other answers here:Because I also had to remove the decimal if a whole number was being shown As an example, this will show the following numbers AsRather than Which, to me, is not showing them correctly.Latest edit also stops numbers such as "100" from being rtrim'ed to 1, by only trimming the rightmost 0's if a decimal is encountered.Trims trailing zeroes, but only after the decimal place -- we wouldn't want to convert 100 -> 1, for example. It will also strip the period if only zeros follow it.If you want a solution that accepts a minimum and maximum amount of decimal places, this should work:This is hard coded to use the US locale, but should be easily adjusted for other locales.You should use the round function which is more able to manipulate numbers than a replace.For me, I need a further solution to convert exponential values and simple numbers like 10000 to the last non-zero significant digit You can use rtrim() ( http://www.php.net/manual/en/function.rtrim.php ):Just make sure that there will be a decimal point.hmm, interesting.  I have used this: This removes trailing 0s from the number AFTER the first decimal point.  Otherwise a number like 100 becomes 1.Since I was doing a comparison, using the float technique caused problems.  Hope this helps?preg_replace will do the trick:

enable cors in .htaccess

Devin Crossman

[enable cors in .htaccess](https://stackoverflow.com/questions/14467673/enable-cors-in-htaccess)

I have created a basic RESTful service with the SLIM PHP framework and now I'm trying to wire it up so that I can access the service from an Angular.js project. I have read that Angular supports CORS out of the box and all I needed to do was add this line: Header set Access-Control-Allow-Origin "*" to my .htaccess file. I've done this and my REST application is still working (no 500 internal server error from a bad .htaccess) but when I try to test it from test-cors.org it is throwing an error.My .htaccess file looks like thisIs there something else I need to add to my .htaccess to get this to work properly or is there another way to enable CORS on my server?

2013-01-22 20:45:28Z

I have created a basic RESTful service with the SLIM PHP framework and now I'm trying to wire it up so that I can access the service from an Angular.js project. I have read that Angular supports CORS out of the box and all I needed to do was add this line: Header set Access-Control-Allow-Origin "*" to my .htaccess file. I've done this and my REST application is still working (no 500 internal server error from a bad .htaccess) but when I try to test it from test-cors.org it is throwing an error.My .htaccess file looks like thisIs there something else I need to add to my .htaccess to get this to work properly or is there another way to enable CORS on my server?Since I had everything being forwarded to index.php anyway I thought I would try setting the headers in PHP instead of the .htaccess file and it worked! YAY! Here's what I added to index.php for anyone else having this problem.credit goes to slashingweapon for his answer on this questionBecause I'm using Slim I added this route so that OPTIONS requests get a HTTP 200 responseShould't the .htaccess use add instead of set?This is what worked for me:It's look like you are using an old version of slim(2.x). You can just add following lines to .htaccess and don't need to do anything in PHP scripts.As in this answer Custom HTTP Header for a specific file you can use <File> to enable CORS for a single file with this code:Thanks to Devin, I figured out the solution for my SLIM application with multi domain access. In htaccess: in index.phpI tried @abimelex solution, but in Slim 3.0, mapping the OPTIONS requests goes like:https://www.slimframework.com/docs/objects/router.html#options-route

SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax — PHP — PDO [duplicate]

willium

[SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax — PHP — PDO [duplicate]](https://stackoverflow.com/questions/4544051/sqlstate42000-syntax-error-or-access-violation-1064-you-have-an-error-in-you)

I've looked through all the other StackOverflow (and google) posts with the same problem, but none seemed to address my problem.I am using PDO and PHP.My code:and the first print_r giveswhich is expected (none are null)but it outputs the errorNo idea how to fix this. any ideas?

2010-12-28 06:13:22Z

I've looked through all the other StackOverflow (and google) posts with the same problem, but none seemed to address my problem.I am using PDO and PHP.My code:and the first print_r giveswhich is expected (none are null)but it outputs the errorNo idea how to fix this. any ideas?from is a keyword in SQL. You may not used it as a column name without quoting it. In MySQL, things like column names are quoted using backticks, i.e. `from`.Personally, I wouldn't bother; I'd just rename the column.PS. as pointed out in the comments, to is another SQL keyword so it needs to be quoted, too. Conveniently, the folks at drupal.org maintain a list of reserved words in SQL.I've got this exact error, but in my case I was binding values for the LIMIT clause without specifying the type. I'm just dropping this here in case somebody gets this error for the same reason. Without specifying the type LIMIT :limit OFFSET :offset; resulted in LIMIT '10' OFFSET '1'; instead of LIMIT 10 OFFSET 1;. What helps to correct that is the following:Same pdo error in sql query while trying to insert into database value from multidimential array:Extracting array arr[$s][a] from sql query, using instead variable containing it fixes the problem.   Add backtick i.e. " ` " properly. Write your getTable name and column name between backtick.

How to include WordPress functions in custom .php file?

Sziro

[How to include WordPress functions in custom .php file?](https://stackoverflow.com/questions/15304926/how-to-include-wordpress-functions-in-custom-php-file)

How can I include WordPress functions in a custom .php file?In detail: I have a directory under my theme (Constructor) named reports. These contain .php files that generate reports from data from the site with DOMPDF for downloading. For these I would like to use functions that the WordPress engine provides, for example get_the_author_meta( 'user_firstname', $user_id ). If I use these i get (naturally) the following error:I was lead to believe that I need to include wp-blog-header.php . I use require_once("../../../../wp-blog-header.php"); . With this I get the following 404 error:(The require points to the correct path. If I fiddle with it, I get Warning: require_once(../../../wp-blog-header.php): failed to open stream... So the path must be correct.)Is there something I overlook? Why can't I include this wp file? What is the correct method to include the wp functions? Thanks for the help, Sziro

2013-03-08 23:14:20Z

How can I include WordPress functions in a custom .php file?In detail: I have a directory under my theme (Constructor) named reports. These contain .php files that generate reports from data from the site with DOMPDF for downloading. For these I would like to use functions that the WordPress engine provides, for example get_the_author_meta( 'user_firstname', $user_id ). If I use these i get (naturally) the following error:I was lead to believe that I need to include wp-blog-header.php . I use require_once("../../../../wp-blog-header.php"); . With this I get the following 404 error:(The require points to the correct path. If I fiddle with it, I get Warning: require_once(../../../wp-blog-header.php): failed to open stream... So the path must be correct.)Is there something I overlook? Why can't I include this wp file? What is the correct method to include the wp functions? Thanks for the help, SziroYou're on the right track.  Try this instead:To use wp functions in custom .php files, you must include wp-load.php in your file.

You can do so by adding the following line:If WordPress is in the document root add instead:Well if someone has newer PHP versions installed (ver >= 5.5.x) then they can also try the below code in the root script in WordPress website directory itself:OrI guess this is a more direct and clean approach and doesn't involve manually adding slashes and changing diretories by ...Hope this helps someone.This is better way to include a file in WordPress.External files can easily access the WordPress functions. You just need to include the file wp-load.php in your external file.

The wp-load.php file is located in root of your WordPress installation.

Example: Suppose your file is test.php located at root directory of WordPress installation.Source: How to access WordPress functions in external file

Get only specific attributes with from Laravel Collection

preyz

[Get only specific attributes with from Laravel Collection](https://stackoverflow.com/questions/38412091/get-only-specific-attributes-with-from-laravel-collection)

I've been reviewing the documentation and API for Laravel Collections, but don't seem to find what I am looking for:I would like to retrieve an array with model data from a collection, but only get specified attributes.I.e. something like Users::toArray('id','name','email'), where the collection in fact holds all attributes for the users, because they are used elsewhere, but in this specific place I need an array with userdata, and only the specified attributes.There does not seem to be a helper for this in Laravel? - How can I do this the easiest way?

2016-07-16 14:18:14Z

I've been reviewing the documentation and API for Laravel Collections, but don't seem to find what I am looking for:I would like to retrieve an array with model data from a collection, but only get specified attributes.I.e. something like Users::toArray('id','name','email'), where the collection in fact holds all attributes for the users, because they are used elsewhere, but in this specific place I need an array with userdata, and only the specified attributes.There does not seem to be a helper for this in Laravel? - How can I do this the easiest way?You can do this using a combination of existing Collection methods. It may be a little hard to follow at first, but it should be easy enough to break down.ExplanationFirst, the map() method basically just iterates through the Collection, and passes each item in the Collection to the passed in callback. The value returned from each call of the callback builds the new Collection generated by the map() method.collect($user->toArray()) is just building a new, temporary Collection out of the Users attributes.->only(['id', 'name', 'email']) reduces the temporary Collection down to only those attributes specified.->all() turns the temporary Collection back into a plain array.Put it all together and you get "For each user in the users collection, return an array of just the id, name, and email attributes."Laravel 5.5 added an only method on the Model, which basically does the same thing as the collect($user->toArray())->only([...])->all(), so this can be slightly simplified in 5.5+ to:If you combine this with the "higher order messaging" for collections introduced in Laravel 5.4, it can be simplified even further:use User::get(['id', 'name', 'email']), it will return you a collection with the specified columns and if you want to make it an array, just use toArray() after the get() method like so:User::get(['id', 'name', 'email'])->toArray() Most of the times, you won't need to convert the collection to an array because collections are actually arrays on steroids and you have easy-to-use methods to manipulate the collection.I have now come up with an own solution to this:1. Created a general function to extract specific attributes from arraysThe function below extract only specific attributes from an associative array, or an array of associative arrays (the last is what you get when doing $collection->toArray() in Laravel).It can be used like this:I am using the following functions:This solution does not focus on performance implications on looping through the collections in large datasets.2. Implement the above via a custom collection i LaravelSince I would like to be able to simply do $collection->extract('id','url'); on any collection object, I have implemented a custom collection class.First I created a general Model, which extends the Eloquent model, but uses a different collection class. All you models need to extend this custom model, and not the Eloquent Model then.Secondly I created the following custom collection class:Lastly, all models should then extend your custom model instead, like such:Now the functions from no. 1 above are neatly used by the collection to make the $collection->extract() method available.I had a similar issue where I needed to select values from a large array, but I wanted the resulting collection to only contain values of a single value.pluck() could be used for this purpose (if only 1 key item is required)you could also use reduce(). Something like this with reduce:this is a follow up on the patricus [answer][1] above but for nested arrays:Method below also works.this seems to work, but not sure if it's optimized for performance or not.$request->user()->get(['id'])->groupBy('id')->keys()->all();output:References: https://laravel.com/docs/5.8/queries#retrieving-results (search for pluck)

Magento - Quote/order product item attribute based on user input

Vitamin

[Magento - Quote/order product item attribute based on user input](https://stackoverflow.com/questions/9412074/magento-quote-order-product-item-attribute-based-on-user-input)

SummaryI want to create a product attribute that is not saved to products, or displayed on the product edit page like ordinary product attributes. Instead I want it to be saved to order/quote items and displayed on orders, invoices and such. It should also be configurable by the customer in the frontend before adding a product to the cart.DetailsMy questionsUpdate 1I've discovered that I can run this code on a catalog/product model (and probably sales/quote_item as well) during events such as sales_quote_item_qty_set_afterIn this way I was able to retrieve my custom, customer supplied, data from my <input> on the product page.I suspect this info_buyRequest is saved with the quote and order items. If so, this partially solved my problems 1 and 2. However, I still dont know where it's suitable to run this code, and I dont know how to display it on the backend order/quote/report pages. Also I belive since this is stored as a serialized value in the database, it will be most difficult to get quote/order item collections based on my custom data.

2012-02-23 11:23:38Z

SummaryI want to create a product attribute that is not saved to products, or displayed on the product edit page like ordinary product attributes. Instead I want it to be saved to order/quote items and displayed on orders, invoices and such. It should also be configurable by the customer in the frontend before adding a product to the cart.DetailsMy questionsUpdate 1I've discovered that I can run this code on a catalog/product model (and probably sales/quote_item as well) during events such as sales_quote_item_qty_set_afterIn this way I was able to retrieve my custom, customer supplied, data from my <input> on the product page.I suspect this info_buyRequest is saved with the quote and order items. If so, this partially solved my problems 1 and 2. However, I still dont know where it's suitable to run this code, and I dont know how to display it on the backend order/quote/report pages. Also I belive since this is stored as a serialized value in the database, it will be most difficult to get quote/order item collections based on my custom data.Magento provides a capability for adding options that aren't product attributes or product custom options. They are set on the product and quote items with the option code additional_options.There are two steps you need to take, each can be handled via an event observer. If you want the additional options to carry through reordering, you will need also observe a third event.The first step is to add the event observer to set the additional options on the loaded product before it is added to the cart. One option is to use the catalog_product_load_after event.

In the event observer you can add additional checks the requested page is indeed an add to cart action. The main point of this observer method is to add the selection of your special options to the additional_options option on the product model.

The additional options will be moved from the product to the quote item automatically. With this observer in place, your options will appear in the cart and the checkout review.In order to have them persist, one additional observer is needed (only since Magento 1.5).

Here we move the option from the quote item to the order item.

From this point on the additional options will be visible in the customer order history in the frontend and the order emails, as well as in the admin interface order view, invoices, shipments, creditmemos and PDFs.In order to carry the oprions over to the new order during a reorder, you need to take care to copy them over. Here is one possibility using the checkout_cart_product_add_after event.

The parsing of the extra options and building the additional options array should be moved into a separate function to avoid code duplication, but for this example I'll leave the required logic for each method in place for clarity.

There is no mechanism in place to translate these option labels or values. Here are a few ideas that might be useful in that regard.  In a quote_item_load_after event observer, get the additional options array and set $option['print_value'] = $helper->__($option['value']);. If print_value is set, Magento will use that for rendering the display.

The same can be done with order items.  There is no such thing as a print_label, but you could set a custom index (label_source maybe) and set the label on the fly using that as the source, e.g. $option['label'] = $helper->__($option['label_source']);.Beyond that you would probably have to resort to modifying the templates (grep for getItemOptions()), or overriding the block classes (grep additional_options).It is possible to add custom fields to the Quote item.  How to add custom fields for Order Line Items in Magento to get started.  I've used these instruction recently to add a custom fields to a Magento Quote Item and the concept is fine, but there are a few practices in that article that are not great.  Things I'd do differently:Generally it's best to avoid modifying the Magento core, and apply your customisations via a module as it makes upgrades easier/possible in the future.  If you've not created your own extension before moduleCreator can help you generate the necessary boilerplate.My Solution in Magento 1.8Set option to quote itemAccess option from QuoteItemTransfer option to OrderItemRegister for event sales_convert_quote_item_to_order_itemAccess option from OrderItem

what means new static? [duplicate]

Hello

[what means new static? [duplicate]](https://stackoverflow.com/questions/15898843/what-means-new-static)

I saw in some frameworks this line of code:how do you understand the new static?

2013-04-09 09:55:20Z

I saw in some frameworks this line of code:how do you understand the new static?When you write new self() inside a class's member function, you get an instance of that class. That's the magic of the self keyword.So:You get a Foo even if the static qualifier you used was for a derived class:If you want to enable polymorphism (in a sense), and have PHP take notice of the qualifier you used, you can swap the self keyword for the static keyword:This is made possible by the PHP feature known as late static binding; don't confuse it for other, more conventional uses of the keyword static.

http_build_query() without url encoding

bgcode

[http_build_query() without url encoding](https://stackoverflow.com/questions/6132721/http-build-query-without-url-encoding)

Is there a way to use http_build_query() without having it URL encode according to some RFC standard?Why I don't want to URL encode everything: I'm querying the Ebay API.. They honestly insist on parameter names not being URL encoded, as far as commas in parentheses.  E.g. DomainName(0) is a parameter, and the query fails if those parens are encoded.

2011-05-26 01:14:12Z

Is there a way to use http_build_query() without having it URL encode according to some RFC standard?Why I don't want to URL encode everything: I'm querying the Ebay API.. They honestly insist on parameter names not being URL encoded, as far as commas in parentheses.  E.g. DomainName(0) is a parameter, and the query fails if those parens are encoded.You can use urldecode() function on a result string which you get from http_build_query()Nope, it appears to always want to encode (which it should, it is meant to URL encode when building a list of params for a URL).You could make your own...CodePad.PHP 5.3.1 (Buggy Behavior)

http_build_query DOES escape the '&' ampersand character that joins the parameters. Example: user_id=1&amp;setting_id=2.PHP 5.4+

http_build_query DOES NOT escape the '&' ampersand character that joins the parameters. Example: user_id=1&setting_id=2Example:Option #1: Write a wrapper function:Option #2: Ditch the http_build_query function and write your own.You might want to try their JSON API instead. I tried to get a working sample, but I don't have an app name so I can't verify the result. Here's the code:You'll need to to fill $appName with whatever the name of the app is. Also the X-EBAY-SOA-OPERATION-NAME will need to be set to the actual call, and the JSON modified if the call is different.http_build_query() is INVALID without urlencoding. Maybe you accidentally double-encode it?

For example, try to build http query for this array:Without encoding, you would getWhen properly encoded, you would getwhich is correct. If you skip encoding, be sure to avoid URL injection attacks.You can use urldecode().

Or use http_build_query with the $arg_separator argument.the output of the above isnumeric_prefix: if the array indexes are numbers, this string is added as prefix in each index. In this case the 'test_0=bar'.arg_separator : is used to separate arguments. If non is given php use the arg_separator.output difined in php.iniSee php http_build_querymy take on alex's answer but is fasterThis could also workI tried do this recently https://gist.github.com/marcocesarato/4293986fe93139f04d8269aa3fbd47e9 the difference is that this function is array recursive and compatible with PHP4. You can manage here the urlencodeI was trying to create a GET string to attach it to the end of a url like this -which prints outBut my api didn't like the numbers in the square brackets, so I found a regular expression that removes the numbers - The final code, and the result - Prints out -include[]=enrollments&include[]=current_grading_period_scores&enrollment_type[]=studentIf someone knows of a better regex let me know, I'm kind of a noob with it.

Base64 Encoding Image

UnkwnTech

[Base64 Encoding Image](https://stackoverflow.com/questions/35879/base64-encoding-image)

I am building an open search add-on for Firefox/IE and the image needs to be Base64 Encoded so how can I base 64 encode the favicon I have?I am only familiar with PHP

2008-08-30 11:01:31Z

I am building an open search add-on for Firefox/IE and the image needs to be Base64 Encoded so how can I base 64 encode the favicon I have?I am only familiar with PHPAs far as I remember there is an xml element for the image data. You can use this website to encode a file (use the upload field). Then just copy and paste the data to the XML element.You could also use PHP to do this like so:Use Mozilla's guide for help on creating OpenSearch plugins. For example, the icon element is used like this:Where imageData is your base64 data.My synopsis of rfc2397 is:Once you've got your base64 encoded image data put it inside the <Image></Image> tags prefixed with "data:{mimetype};base64," this is similar to the prefixing done in the parenthesis of url() definition in CSS or in the quoted value of the src attribute of the img tag in [X]HTML. You can test the data url in firefox by putting the data:image/... line into the URL field and pressing enter, it should show your image.For actually encoding I think we need to go over all your options, not just PHP,

because there's so many ways to base64 encode something.A note on mime-types:

I would prefer you use one of image/png image/jpeg or image/gif as I can't find the popular image/x-icon. Should that be image/vnd.microsoft.icon?

Also the other formats are much shorter.compare 265 bytes vs 1150 bytes:Check the following exampleGoogle led me to this solution (base64_encode). Hope this helps!

Is it possible to overload operators in PHP?

chadgh

[Is it possible to overload operators in PHP?](https://stackoverflow.com/questions/787692/is-it-possible-to-overload-operators-in-php)

Specifically, I would like to create an Array class and would like to overload the [] operator.

2009-04-24 21:46:53Z

Specifically, I would like to create an Array class and would like to overload the [] operator.If you are using PHP5 (and you should be), take a look at the SPL ArrayObject classes. The documentation isn't too good, but I think if you extend ArrayObject, you'd have your "fake" array.EDIT: Here's my quick example; I'm afraid I don't have a valuable use case though:Actually, the optimal solution is to implement the four methods of the ArrayAccess interface:

http://php.net/manual/en/class.arrayaccess.phpIf you would also like to use your object in the context of 'foreach', you'd have to implement the 'Iterator' interface:

http://www.php.net/manual/en/class.iterator.phpPHP's concept of overloading and operators (see Overloading, and Array Operators) is not like C++'s concept. I don't believe it is possible to overload operators such as +, -, [], etc.Possible SolutionsFor a simple and clean solution in PHP 5.0+, you need to implements the ArrayAccess interface and override functions offsetGet, offsetSet, offsetExists and offsetUnset. You can now use the object like an array.Example:It appears not to be a feature of the language, see this bug.  However, it looks like there's a package that lets you do some sort of overloading. Put simply, no; and I'd suggest that if you think you need C++-style overloading, you may need to rethink the solution to your problem.  Or maybe consider not using PHP.To paraphrase Jamie Zawinski, "You have a problem and think, 'I know!  I'll use operator overloading!'  Now you have two problems."

PHPUnit: How do I create a function to be called once for all my tests?

snakile

[PHPUnit: How do I create a function to be called once for all my tests?](https://stackoverflow.com/questions/7158930/phpunit-how-do-i-create-a-function-to-be-called-once-for-all-my-tests)

I have a PHPUnit test case class (consisting of some test functions). I would like to write a oneTimeSetUp() function to be called once for all my tests in the class (unlike the standard setUp() function which is called once for each test in the class). In other words, I'm looking for a PHPUnit equivalent to the JUnit @BeforeClass annotation.Same question with a oneTimeTearDown() function.Is it possible to do so in PHPUnit?

2011-08-23 09:34:06Z

I have a PHPUnit test case class (consisting of some test functions). I would like to write a oneTimeSetUp() function to be called once for all my tests in the class (unlike the standard setUp() function which is called once for each test in the class). In other words, I'm looking for a PHPUnit equivalent to the JUnit @BeforeClass annotation.Same question with a oneTimeTearDown() function.Is it possible to do so in PHPUnit?Take a look at setUpBeforeClass() from section 6 of the PHPUnit documentation.For the one time tearDown you should use tearDownAfterClass();.Both this methods should be defined in your class as static methods.I came to this page with the same question, however the accepted answer is ran on all classes, and for me was not the correct answer.If you are like me, your first "Integration test" is to clear out the DB, and run migrations. This gets yourself at a database baseline for all test. I am constantly changing migration files at this point, so setting up the baseline is truly part of all tests.The migration takes a while, so I do not want it run on all tests.Then I needed to build up the database testing each piece. I need to write an order test, but first I need to create some products and test that, then I need to test an import fuction.So, what I did is SUPER easy, but not explained extremely well on the internet. I created a simple test to setup the database. Then in your phpspec.xml file add a testsuite....And  in the the SystemSetupTest.php ....Then execute it like: phpunit --testsuite ProductsIn the end, its a ton easier. It will allow me to build up my system correctly.Additionally I am using laravel 5. When using setUpBeforeClass() I end up with bootstrap issues, which I am sure I can fix, but the method I use above works perfect. setUpBeforeClass() is the way to do this if all of your tests are literally contained within a single class.However, your question sort of implies that you may be using your test class as a base class for multiple test classes. In that case setUpBeforeClass will be run before each one. If you only want to run it once you could guard it with a static variable:A final option might be a test listener.The bootstrap option can be used on these cases.You can call it from the command lineOr put it in the XML file, like this:Expanding on accepted answer:None of the setUpBeforeClass(), tearDownAfterClass(), @beforeClass, @afterClass runs in the object context (static methods). You can work around that restriction by guarding any @before code with a static property instead, like so:It can't be used for @after, however, because there's no way of saying when the last test was called.

how to import .sql file in mysql database using php

msalman

[how to import .sql file in mysql database using php](https://stackoverflow.com/questions/19751354/how-to-import-sql-file-in-mysql-database-using-php)

how to import .sql file in mysql database using php how can i do this please help me to fix this issue thanksthis code showing this error..i am using this code

2013-11-03 09:06:34Z

how to import .sql file in mysql database using php how can i do this please help me to fix this issue thanksthis code showing this error..i am using this codeI Have got another way to do this, Try thisThis is working for me, Good Luckthe answer from Raj is useful, but (because of file($filename))

it will fail if your mysql-dump not fits in memory If you are on shared hosting and there are limitations like 30 MB and 12s Script runtime and you have to restore a x00MB mysql dump, you can use this script:it will walk the dumpfile query for query, if the script execution deadline is near, it saves the current fileposition in a tmp file and a automatic browser reload will continue this process again and again ...

If an error occurs, the reload will stop and an the error is shown ...if you comeback from lunch your db will be restored ;-)the noLimitDumpRestore.php:

    

You can use the mysqli multi_query function as below:It's worth mentioning the Adminer script.  It's a database managemenet tool in a single file.  Simply drop the php file onto your server via FTP or otherwise and you have a full GUI where you can import a database, run sql commands etc. Nice!Grain Script is superb and save my day. Meanwhile mysql is depreciated and I rewrote Grain answer using PDO.I have Test your code, this error shows when you already have the DB imported or with some tables with the same name, also the Array error that shows is because you add in in the exec parenthesis, here is the fixed version: Here's a simple solutionDefinitely working on my end. Worth a try.I use this code and RUN SUCCESS FULL:Solution special charsI Thing you can Try this Code, It's Run for my Case:I use this and it works for meI think this is the shortest code

PHP file_get_contents very slow when using full url

ecurbh

[PHP file_get_contents very slow when using full url](https://stackoverflow.com/questions/3629504/php-file-get-contents-very-slow-when-using-full-url)

I am working with a script (that I did not create originally) that generates a pdf file from an HTML page. The problem is that it is now taking a very long time, like 1-2 minutes, to process. Supposedly this was working fine originally, but has slowed down within the past couple of weeks.The script calls file_get_contents on a php script, which then outputs the result into an HTML file on the server, and runs the pdf generator app on that file.I seem to have narrowed down the problem to the file_get_contents call on a full url, rather than a local path.When I useit processes almost instantaneously. However, if I use the full urlit takes anywhere from 30-90 seconds to process.It's not limited to our server, it is slow when accessing any external url, such as http://www.google.com. I believe the script calls the full url because there are query string variables that are necessary that don't work if you call the file locally.I also tried fopen, readfile, and curl, and they were all similarly slow. Any ideas on where to look to fix this?

2010-09-02 17:16:50Z

I am working with a script (that I did not create originally) that generates a pdf file from an HTML page. The problem is that it is now taking a very long time, like 1-2 minutes, to process. Supposedly this was working fine originally, but has slowed down within the past couple of weeks.The script calls file_get_contents on a php script, which then outputs the result into an HTML file on the server, and runs the pdf generator app on that file.I seem to have narrowed down the problem to the file_get_contents call on a full url, rather than a local path.When I useit processes almost instantaneously. However, if I use the full urlit takes anywhere from 30-90 seconds to process.It's not limited to our server, it is slow when accessing any external url, such as http://www.google.com. I believe the script calls the full url because there are query string variables that are necessary that don't work if you call the file locally.I also tried fopen, readfile, and curl, and they were all similarly slow. Any ideas on where to look to fix this?I had a hard time figuring out the cause of the slowness of file_get_contents scripts.By analyzing it with Wireshark, the issue (in my case and probably yours too) was that the remote web server DIDN'T CLOSE THE TCP CONNECTION UNTIL 15 SECONDS (i.e. "keep-alive").Indeed, file_get_contents doesn't send a "connection" HTTP header, so the remote web server considers by default that's it's a keep-alive connection and doesn't close the TCP stream until 15 seconds (It might not be a standard value - depends on the server conf).A normal browser would consider the page is fully loaded if the HTTP payload length reaches the length specified in the response Content-Length HTTP header. File_get_contents doesn't do this and that's a shame.SOLUTIONSO, if you want to know the solution, here it is:The thing is just to tell the remote web server to close the connection when the download is complete, as file_get_contents isn't intelligent enough to do it by itself using the response Content-Length HTTP header.I would use curl() to fetch external content, as this is much quicker than the file_get_contents method. Not sure if this will solve the issue, but worth a shot.Also note that your servers speed will effect the time it takes to retrieve the file. Here is an example of usage:Sometimes, it's because the DNS is too slow on your server, try this:replaceasI had the same issue, The only thing that worked for me is setting timeout in $options array.Can you try fetching that url, on the server, from the command line? curl or wget come to mind. If those retrieve the URL at a normal speed, then it's not a network problem and most likely something in the apache/php setup.Time: 50976 ms (avaerage time in total 5 attempts)Time: 46679 ms (avaerage time in total 5 attempts)Note: request.php is used to fetch some data from mysql database.I have a huge data passed by API, I'm using file_get_contents to read the data, but it took around 60 seconds. However, using KrisWebDev's solution it took around 25 seconds.What I would also consider with Curl is that you can "thread" the requests. This has helped me immensely as I do not have access to a version of PHP that allows threading at the moment .   For example, I was getting 7 images from a remote server using file_get_contents and it was taking 2-5 seconds per request. This process alone was adding 30seconds or something to the process, while the user waited for the PDF to be generated.  This literally reduced the time to about 1 image.  Another example, I verify 36 urls in the time it took before to do one. I think you get the point. :-)Then check over the results:then close file:I know that is old question but I found it today and answers didn't work for me. I didn't see anyone saying that max connections per IP may be set to 1. That way you are doing API request and API is doing another request because you use full url. That's why loading directly from disc works. For me that fixed a problem:

laravel 5.5 The page has expired due to inactivity. Please refresh and try again

Svetlozar

[laravel 5.5 The page has expired due to inactivity. Please refresh and try again](https://stackoverflow.com/questions/46149561/laravel-5-5-the-page-has-expired-due-to-inactivity-please-refresh-and-try-again)

I'm new with Laravel and I have a problem which I don't understand.

I have а log form in my project and my method is POST. When I try a request the result is: But if I change the method to GET, It works fine. Can someone tell me why is that and how to fix it? because of course I need  POST method.

2017-09-11 06:36:36Z

I'm new with Laravel and I have a problem which I don't understand.

I have а log form in my project and my method is POST. When I try a request the result is: But if I change the method to GET, It works fine. Can someone tell me why is that and how to fix it? because of course I need  POST method.This problem comes from the CSRF token verification which fails. So either you're not posting one or you're posting an incorrect one.The reason it works for GET is that for a GET route in Laravel, there is no CSRF token posted.You can either post a CSRF token in your form by calling:Or exclude your route (NOT RECOMMENDED DUE TO SECURITY) in app/Http/Middleware/VerifyCsrfToken.php:In my case, I've got the same error message and then figured out that I've missed to add csrf_token for the form field. Then add the csrf_token.Using form helper that will be,Or without form helper that will be,If that doesn't work, then-Refresh the browser cache and now it might work, thanks.Update For Laravel 5.6  Laravel integrates new @csrf instead of {{ csrf_field() }}. That looks more nice now.Anytime you define an HTML form in your application, you should include a hidden CSRF token field in the form so that the CSRF protection middleware can validate the request. You may use the csrf_field helper to generate the token field:It doesn't work, then Refresh the browser cache and now it might work, For more details open link  :- CSRF Protection in Laravel 5.5UPDATE:With Laravel 5.6 using Blades templates, it's pretty easy.For more details open link :- CSRF Protection in Laravel 5.6This happens because you are using the default CSRV middleware from Laravel's installation. To solve, remove this line from your Kernel.php:This is fine if you are build an API. However, if you are building a website this is a security verification, so be aware of its risks.Verify that your config/session.php file contains this line Then remove the SESSION_DOMAIN line in your .env filei had same problem. use 'clear browsing data' in chrome. maybe solve your problem.In my case , I added ob_start(); at the top of my index.php on server and everything seems to be working fine.Place {{csrf_field()}} Into your form tagTried different solutions to solve the problem for several weeks without success.The problem I was facing was caused by upgrading from laravel 5.0 to 5.5 and forgot to update config/session.phpIf anyone is facing the problem, try to update the config/session.php to match the version on Laravel you are runningFirst, include csrf in your form.if the problem didn't solve, then use ob_start(); at the very start of index.php.I had the same problem, I have tried many solutions. but none worked for me. then I found out that for some reason I was using this in my .env file:SESSION_DOMAIN= myapp.meand as soon as I put it back to null, everything worked just fine.Just place this code inside the form I was facing the same error so i just removed this line from my .env fileSESSION_DRIVER=yourwebsite.comif your config is set: SESSION_DRIVER=file you have to check if your session directory is writable. Check storage/framework/sessionStill anyone have this problem, use following code inside your form as below.Just add @csrf inside your form tag.Or you can include csrf_token in the header to send it with every request.if you need to change form action with Javascript you will have the same problem 1.first you need to use  instead of {!!Form::open() !!} {!! close() !!} in laravel

2.second you most begin your action with https://www.example.com +your RouteDo not Forget www in your url!!!If you have already included the CSRF token in your form. Then you are getting the error page possibly because of cache data in your form. Open your terminal/command prompt and run these commands in your project root.Also try to clear the browser cache along with running these commands.Excluding URIs From CSRF Protection:Sometimes you may wish to exclude a set of URIs from CSRF protection. For example, if you are using Stripe to process payments and are utilizing their webhook system, you will need to exclude your Stripe webhook handler route from CSRF protection since Stripe will not know what CSRF token to send to your routes.Typically, you should place these kinds of routes outside of the web middleware group that the  RouteServiceProvider applies to all routes in the routes/web.php file. However, you may also exclude the routes by adding their URIs to the $except property of the VerifyCsrfToken middleware:In my case the same problem was caused because I forgot to add > at the end of my hidden input field, like so: <input type="hidden" name="_token" value="{{ Session::token() }}" So, I fixed it by adding it:It's Funny  but it works for me. i realised this is Caused because of default HTML TAG in laravel code. 

Use    /* */   or  {{-- --}}  insteadOr Try to Remove Recently Html Coment in you code...

Or change Html Comment to Php Comment...

