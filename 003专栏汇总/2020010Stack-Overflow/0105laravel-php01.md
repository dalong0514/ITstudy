## 01. How Do I Get the Query Builder to Output Its Raw SQL Query as a String?

meiryo

[How Do I Get the Query Builder to Output Its Raw SQL Query as a String?](https://stackoverflow.com/questions/18236294/how-do-i-get-the-query-builder-to-output-its-raw-sql-query-as-a-string)

Given the following code:I want to get the raw SQL query string that the database query builder above will generate. In this example, it would be SELECT * FROM users.How do I do this?

2013-08-14 15:43:54Z

Given the following code:I want to get the raw SQL query string that the database query builder above will generate. In this example, it would be SELECT * FROM users.How do I do this?To output to the screen the last queries ran you can use this:I believe the most recent queries will be at the bottom of the array.You will have something like that:(Thanks to Joshua's comment below.)Use the toSql() method on a QueryBuilder instance.DB::table('users')->toSql() would return:This is easier than wiring up an event listener, and also lets you check what the query will actually look like at any point while you're building it.DB::QueryLog() only work after you execute the query $builder->get(). if you want to get the query before execute the query you can use $builder->toSql() method. this is the example how to get the sql and bind it:OR just make your query error like calling for unexist table or column, u will see the generated query in exception XDYou can listen to the 'illuminate.query' event. Before the query add the following event listener:This will print out something like:If you are trying to get the Log using Illuminate without Laravel use:You could also nock up a quick function like so:EDITupdated versions seem to have query logging disabled by default (the above returns an empty array). To turn back on, when initialising the Capsule Manager, grab an instance of the connection and call the enableQueryLog methodEDIT AGAINTaking the actual question into consideration, you could actually do the following to convert the current single query instead of all previous queries:There is a method in eloquent for getting query string. toSql()in our case,returnis the exact solution that return the SQL query string..Hope this helpful...If you use laravel 5.1 and MySQL you can use this function made by me:As an input parameter you can use either of theseFirst You will need to enable the query log by calling:after queries using the DB facade you can write:the output will like below:This is the far best solution I can suggest to any one for debug-ing eloquent last query or final query  although this has been discussed as well:Simply you can do following stuff using toSql() method,If it's not working you can set-up the thing from laravel documentation.Another way to do it isDB::getQueryLog()but if it's returns an empty array then by default it's disabled visit this,just enable with DB::enableQueryLog() and it will work :)for more info visit Github Issue to know more about it.Hope it helps :)A 'macroable' replacement to get the SQL query with the bindings.E.g. Eloquent Builder (Laravel 5.1 - 5.3)use debugbar package From laravel 5.2 and onward. you can use DB::listen to get executed queries.Or if you want to debug a single Builder instance then you can use toSql method.The most easiest way is to make deliberate mistake. For example, I want to see the full SQL query of the following relation:I just to make a column to be not found, here I choose created_at and I changed it to created_ats by adding trailing s to be:So, the debuger will return the following error:The above error message returns the full SQL query with the mistakeNow, just remove the extra s from created_at and test this SQL as you like in any SQL editor such as phpMyAdmin SQL editor!This is the function, I placed in my base model class. Simply pass the query builder object into it and the SQL string will be returned.For laravel 5.5.XIf you would like to receive each SQL query executed by your application, you may use the listen method. This method is useful for logging queries or debugging. You may register your query listener in a service provider:SourceAs of Laravel 5.8.15 the query builder now has dd and dump methods so you can doAdd this function to your application and simply call.Output: "select * from user where lang = 'en' and status = '1' order by updated_at desc limit 25 offset 0"Print last queryIn my opinion, this will be the best approach as a beginner:This is also depicted here.

https://stackoverflow.com/a/59207557/9573341You can use this package for get all the queries which are executing when you load your pageIf you are not using Laravel but using Eloquent package then:

you can use clockworkbut works also in firefoxI've created some simple functions to get the SQL and bindings from some queries.Usage:As much as I love this framework, I hate when it acts like crap.DB::enableQueryLog() is totally useless. DB::listen is equally useless. It showed part of the query when I said $query->count(), but if I do $query->get(), it has nothing to say.The only solution that appears to work consistently is to intentionally put some syntax or other error in the ORM parameters, like an nonexistent column/table name, run your code on the command line while in debug mode, and it will spit out the SQL error with the full frickin' query finally. Otherwise, hopefully the error appears in the log file if ran from the web server.Try this:Note: get() has been replaced with toSql() to display the raw SQL query.If you are using tinker and want to log the SQL query formed you can doMy way of doing this, based on the log view, only needs to modify the file app/Providers/AppServiceProvider.php:

No Application Encryption Key Has Been Specified

Carlos F

[No Application Encryption Key Has Been Specified](https://stackoverflow.com/questions/44839648/no-application-encryption-key-has-been-specified)

I'm new to Laravel and I'm trying to use the Artisan command...It displays...However, it won't automatically launch and when I manually enter http://127.0.0.1:8000 it shows this error:Any ideas? I'm using Laravel framework 5.5-dev.

2017-06-30 06:06:47Z

I'm new to Laravel and I'm trying to use the Artisan command...It displays...However, it won't automatically launch and when I manually enter http://127.0.0.1:8000 it shows this error:Any ideas? I'm using Laravel framework 5.5-dev.From Encryption - Laravel - The PHP Framework For Web Artisans:I found that using this complex internet query in google.com: "laravel add encrption key" (Yes, it worked even with the typo!)In my case, I also needed to reset the cached config files:Open command prompt in the root folder of your project and run below command:It will generate Application Key for your application.You can find the generated application key(APP_KEY) in .env file.Simply run this command: cp .env.example .env if there is no .env file present.

php artisan key:generate command works for me. It generates the encryption keyI actually had to add a .env file to my project and then copy the contents of .env.example so that the key:generate would work. Not sure why a .env file was not created when I started the project.worked for me, but it had to be done in a command prompt on Windows.Doing it inside the terminal in PHPStorm didn't worked.A common issue you might experience when working on a Laravel application is the exception:You'll often run into this when you pull down an existing Laravel application, where you copy the .env.example file to .env but don't set a value for the APP_KEY variable.At the command line, issue the following Artisan command to generate a key:This will generate a random key for APP_KEY, After completion of .env edit please enter this command in your terminal for clear cache:php artisan config:cacheAlso, If you are using the PHP's default web server (eg. php artisan serve) you need to restart the server changing your .env file values. now you will not get to see this error message.Follow this steps:Okay, I'll write another instruction, because didn't find the clear answer here. So if you faced such problems, follow this:That's it.You can generate Application Encryption Key using this command:Then, create a cache file for faster configuration loading using this command:Or, serve the application on the PHP development server using this command:That's it!If you git clone some project then this kind of issue may usually occur.Open command prompt in the root folder of your project and run Then and ThenIf you're getting the same error after having key-value, then just copy the APP_KEY value from .env file and paste it to config/app.php with 'key' => 'YOUR KEY',and then again runI ran into this issue when I manually copied the contents of my Laravel project (say sites/oldname) into a new directory on my Mac (say, sites/newname).  Since I was manually dragging and droppping, it didn't grab the hidden files, namely, '.env'.

When I looked more closely at sites/oldname I saw .editorconfig, .env, .env.example, .gitatrributes, .styleci.yml, etc.The error went away once I copied the hidden files to the new directory.So, "No Application Encryption Key Has Been Specified" is Laravel speak for "your .env file is missing."I had to restart my queue worker using php artisan queue:restart after running php artisan key:generate to get jobs working.simply runits worked for meIn my case, while cloning the project from git there was no .envfile. So I copy the .env file from the source project and paste in my current project and change its configuration of database and it run successfully. 

Laravel Checking If a Record Exists

Ben

[Laravel Checking If a Record Exists](https://stackoverflow.com/questions/27095090/laravel-checking-if-a-record-exists)

I am new to Laravel. Please excuse the newbie question but how do I find if a record exists?What can I do here to see if $user has a record?

2014-11-23 22:24:42Z

I am new to Laravel. Please excuse the newbie question but how do I find if a record exists?What can I do here to see if $user has a record?It depends if you want to work with the user afterwards or only check if one exists.If you want to use the user object if it exists:And if you only want to checkOr even nicerOne of the best solution is to use the firstOrNew or firstOrCreate method. The documentation has more details on both.Eloquent uses collections. 

See the following link: https://laravel.com/docs/5.4/eloquent-collectionsUse first(), not count() if you only need to check for existence.first() is faster because it checks for a single match whereas count() counts all matches.Laravel 5.6.26v to find the existing record through primary key ( email or id ) then include " use DB " and table name user become plural using the above query like user to usersThis will check if requested email exist in the user table:In your Controller In your View - Display Already Exist Message would work with try/catch ->get() would still return an empty arrayIn laravel eloquent, has default exists() method, refer followed example.if(User::where('id', $user_id )->exists()){

 // your code...

}It's simple to get to know if there are any records or not you can use laravel validation .But this code is also good:This will check if particular email address exist in the table:Checking for null within if statement prevents Laravel from returning 404 immediately after the query is over.It seems like it runs double query if the user is found, but I can't seem to find any other reliable solution.can be written as This will return true or false without assigning a temporary variable if that is all you are using $user for in the original statement.I think below way is the simplest way to achieving same :Created below method (for myself) to check if the given record id exists on Db table or not.Home It helps!The Easiest Way to do Laravel 6 or on the top: Write the table name, then give where clause condition for instance where('id', $request->id)The efficient way to check if the record exists you must use is_null method to check against the query.The code below might be helpful:Shortest working options:here is a link to something l think can assist

https://laraveldaily.com/dont-check-record-exists-methods-orcreate-ornew/this is simple code to check email is exist or not in database

How to Set Variables in a Laravel Blade Template

duality_

[How to Set Variables in a Laravel Blade Template](https://stackoverflow.com/questions/13002626/how-to-set-variables-in-a-laravel-blade-template)

I'm reading the Laravel Blade documentation and I can't figure out how to assign variables inside a template for use later. I can't do {{ $old_section = "whatever" }} because that will echo "whatever" and I don't want that.I understand that I can do <?php $old_section = "whatever"; ?>, but that's not elegant.Is there a better, elegant way to do that in a Blade template?

2012-10-21 22:02:08Z

I'm reading the Laravel Blade documentation and I can't figure out how to assign variables inside a template for use later. I can't do {{ $old_section = "whatever" }} because that will echo "whatever" and I don't want that.I understand that I can do <?php $old_section = "whatever"; ?>, but that's not elegant.Is there a better, elegant way to do that in a Blade template?It is discouraged to do in a view so there is no blade tag for it.

If you do want to do this in your blade view, you can either just open a php tag as you wrote it or register a new blade tag. Just an example:LARAVEL 5.5 AND UPThe @php blade directive no longer accepts inline tags. Instead, use the full form of the directive:LARAVEL 5.2 AND UPYou can just use:Or you can use it in a block statement:LARAVEL 5Extend Blade like this:Then do one of the following:Quick solution: If you are lazy, just put the code in the boot() function of the AppServiceProvider.php.Nicer solution:

Create an own service provider. See https://stackoverflow.com/a/28641054/2169147 on how to extend blade in Laravel 5. It's a bit more work this way, but a good exercise on how to use Providers :)LARAVEL 4You can just put the above code on the bottom of app/start/global.php (or any other place if you feel that is better).After the above changes, you can use:to define a variable.In laravel-4, you can use the template comment syntax to define/set variables.Comment syntax is  {{-- anything here is comment --}} and it is rendered by blade engine as<?php /* anything here is comment */ ?>so with little trick we can use it to define variables, for examplewill be rendered by bladeas 

    <?php /* */$i=0;/* */ ?> which sets the variable for us. 

Without changing any line of code.There is a simple workaround that doesn't require you to change any code, and it works in Laravel 4 just as well.You just use an assignment operator (=) in the expression passed to an @if statement, instead of (for instance) an operator such as ==.Then you can use it anywhere you can use any other variableThe only downside is your assignment will look like a mistake to someone not aware that you're doing this as a workaround.Ya'll are making it too complicated. Just use plain php donesies.(or https://github.com/alexdover/blade-set looks pretty straighforward too)We're all kinda "hacking" the system by setting variables in views, so why make the "hack" more complicated then it needs to be?Tested in Laravel 4.Another benefit is that syntax highlighting works properly (I was using comment hack before and it was awful to read)You Can Set Variables In The Blade Templating Engine The Following Ways:

1. General PHP Block

Setting Variable: <?php $hello = "Hello World!"; ?>

Output: {{$hello}}

2. Blade PHP Block

Setting Variable: @php $hello = "Hello World!"; @endphp

Output: {{$hello}}Since Laravel 5.2.23, you have the @php Blade directive, which you can use inline or as block statement:orYou can set a variable in the view file, but it will be printed just as you set it. Anyway, there is a workaround. You can set the variable inside an unused section. Example:Then {{ $yourVar }} will print Your value anywhere you want it to, but you don't get the output when you save the variable.EDIT: naming the section is required otherwise an exception will be thrown.In Laravel 4:If you wanted the variable accessible in all your views, not just your template, View::share is a great method (more info on this blog).Just add the following in app/controllers/BaseController.phpand now $myvar will be available to all your views -- including your template. I used this to set environment specific asset URLs for my images.And suddenly nothing will appear.

From my experience, if you have to do something like this prepare the html in a model's method or do some reorganizing of your code in to arrays or something.  There is never just 1 way.I'm going to extend the answer given by @Pim.Add this to the boot method of your AppServiceProviderThis way you don't expose the ability to write any php expression.You can use this directive like:In Laravel 5.1, 5.2:https://laravel.com/docs/5.2/views#sharing-data-with-all-viewsEdit file: /app/Providers/AppServiceProvider.phpYou may use the package I have published: https://github.com/sineld/bladesetThen you easily set your variable:As for my elegant way is like the followingAnd just echo your $old_section variable.I don't think that you can - but then again, this kind of logic should probably be handled in your controller and passed into the view already set.If you have PHP 7.0:The simple and most effective way is with assignment inside brackets.The rule is simple: Do you use your variable more than once? Then declare it the first time it's used within brackets, keep calm and carry on.And yes, I know about @forelse, this is just a demo.Since your variables are now declared as and when they are used, there is no need for any blade workarounds.Assign variable to the blade template, Here are the solutionsWe can use <?php ?> tag in blade pageORWe can use the blade comment with special syntax Hacking comments is not a very readable way to do it. Also editors will color it as a comment and someone may miss it when looking through the code.Try something like this:It will compile into:...and do the assignment and not echo anything.It's better to practice to define variable in Controller and then pass to view using compact() or ->with() method.Otherwise #TLGreg gave best answer.There is a very good extention for Blade radic/blade-extensions. After you add it you can use @set(variable_name, variable_value)laravel 5 you can easily do this . see below I was looking for a way to assign a value to a key and use it many times in my view. For this case, you can use @section{"key", "value"} in the first place and then call @yield{"key"} to output the value in other places in your view or its child.In my opinion it would be better to keep the logic in the controller and pass it to the view to use. This can be done one of two ways using the 'View::make' method. I am currently using Laravel 3 but I am pretty sure that it is the same way in Laravel 4.orThe 'with' method is chainable. You would then use the above like so:More information here:http://three.laravel.com/docs/viewshttp://codehappy.daylerees.com/using-controllersI had a similar question and found what I think to be the correct solution with View ComposersView Composers allow you to set variables every time a certain view is called, and they can be specific views, or entire view templates. Anyway, I know it's not a direct answer to the question (and 2 years too late) but it seems like a more graceful solution than setting variables within a view with blade.works in all versions of blade.You can extend blade by using the extend method as shown below..after that initialize variables as follows.In laravel document https://laravel.com/docs/5.8/blade#php

You can do this way:

Laravel - Eloquent or Fluent random row

DigitalWM

[Laravel - Eloquent or Fluent random row](https://stackoverflow.com/questions/13917558/laravel-eloquent-or-fluent-random-row)

How can I select a random row using Eloquent or Fluent in Laravel framework?I know that by using SQL, you can do order by RAND(). However, I would like to get the random row without doing a count on the number of records prior to the initial query.Any ideas?

2012-12-17 15:59:25Z

How can I select a random row using Eloquent or Fluent in Laravel framework?I know that by using SQL, you can do order by RAND(). However, I would like to get the random row without doing a count on the number of records prior to the initial query.Any ideas?Laravel >= 5.2:oror to get the Specific number of recordsLaravel 4.2.7 - 5.1:Laravel 4.0 - 4.2.6:Laravel 3:Check this article on MySQL random rows. Laravel 5.2 supports this, for older version, there is no better solution then using RAW Queries.edit 1: As mentioned by Double Gras, orderBy() doesn't allow anything else then ASC or DESC since this change. I updated my answer accordingly.edit 2: Laravel 5.2 finally implements a wrapper function for this. It's called inRandomOrder().This works just fine,you can also change argument in random function to get more than one record.Note: not recommended if you have huge data as this will fetch all rows first and then returns random value.tl;dr: It's nowadays implemented into Laravel, see "edit 3" below.Sadly, as of today there are some caveats with the ->orderBy(DB::raw('RAND()')) proposed solution:

edit: Now you can use the orderByRaw() method: ->orderByRaw('RAND()'). However this is still not DB-agnostic.FWIW, CodeIgniter implements a special RANDOM sorting direction, which is replaced with the correct grammar when building query. Also it seems to be fairly easy to implement. Looks like we have a candidate for improving Laravel :)update: here is the issue about this on GitHub, and my pending pull request.

edit 2: Let's cut the chase. Since Laravel 5.1.18 you can add macros to the query builder:Usage:

edit 3: Finally! Since Laravel 5.2.33 (changelog, PR #13642) you can use the native method inRandomOrder():In Laravel 4 and 5 the order_by is replaced by orderBySo, it should be:You can use:You can also use order_by method with fluent and eloquent like as:This is a little bit weird usage, but works.Edit: As @Alex said, this usage is cleaner and also works:For Laravel 5.2 >=use the Eloquent method:     The inRandomOrder method may be used to sort the query results randomly. For example, you may use this method to fetch a random user:from docs: https://laravel.com/docs/5.2/queries#ordering-grouping-limit-and-offsetUse Laravel function  At your model add this:then at route/controllerThere is also whereRaw('RAND()') which does the same, you can then chain ->get() or ->first() or even go crazy and add ->paginate(int).You can easily Use this command:// Question : name of Model

// take 10 rows from DB In shuffle records...I prefer to specify first or fail:Laravel has a built-in method to shuffle the order of the results.Here is a quote from the documentation:The shuffle method randomly shuffles the items in the collection:You can see the documentation here.I have table with thousands of records, so I need something fast. This is my code for pseudo random row:

Laravel 5 – Remove Public from URL

user1537360

[Laravel 5 – Remove Public from URL](https://stackoverflow.com/questions/28364496/laravel-5-remove-public-from-url)

I know this is a very popular question but I haven't been able to find a working solution for Laravel 5. I've been trying to migrate from Codeigniter for a long time, but this convoluted installation process keeps putting me off.I don't want to run a VM, this just seems awkward when switching between projects.I don't want to set my document root to the public folder, this is also awkward when switching between projects.I've tried the .htaccess mod_rewrite methodThis just gives me a Laravel NotFoundHttpException in compiled.php line 7610.When I tried L4 a while ago, I used the method of moving the contents of the public folder into the root. The structure of L5 is quite different and following the same steps completely broke Laravel (the server would only return a blank page).Is there a decent method of removing 'public' in a development environment that:Thanks** I'm using MAMP and PHP 5.6.2

2015-02-06 11:13:39Z

I know this is a very popular question but I haven't been able to find a working solution for Laravel 5. I've been trying to migrate from Codeigniter for a long time, but this convoluted installation process keeps putting me off.I don't want to run a VM, this just seems awkward when switching between projects.I don't want to set my document root to the public folder, this is also awkward when switching between projects.I've tried the .htaccess mod_rewrite methodThis just gives me a Laravel NotFoundHttpException in compiled.php line 7610.When I tried L4 a while ago, I used the method of moving the contents of the public folder into the root. The structure of L5 is quite different and following the same steps completely broke Laravel (the server would only return a blank page).Is there a decent method of removing 'public' in a development environment that:Thanks** I'm using MAMP and PHP 5.6.2That's it!I have solved the issue using 2 answers:In Laravel 5.5 create .htacess file in your root directory and placed the following code:- Reference LinkYOU REALLY SHOULD NOT rename server.php in your Laravel root folder to index.php

and copy the .htaccess file from the /public directory to your Laravel root folder!!!This way everyone can access some of your files (.env for example). Try it yourself. You don't want that!Instead, you should create an .htaccess file in your root like this:This will silently rewrite all your base URIs to the /public folder. Even all Headers, for example the HTTP Authorization Header, and all optional URI parameters will silently be passed on to the /public folder as well.That's allEasy way to remove public from laravel 5 url.

You just need to cut index.php and .htaccess from public directory and paste it in the root directory,thats all

and replace two lines in index.php asNote: The above method is just for the beginners as they might be facing problem in setting up virtual host and The best solution is to setup virtual host on local machine and point it to the public directory of the project.@rimon.ekjon said:That's working for me.

But all resource files in /public directory couldn't find and request urls didn't work, because I used asset() helper.I changed /Illuminate/Foundation/helpers.php/asset() function as follows:Now everything works :)Thank you @rimon.ekjon and all of you.Just create .htaccess file at root and add these lines to itThat's it!The above code works on the root public_html folder. Having said that your core laravel file should be inside the public_html folder, if your directory looks like public_html/laravelapp/public and if you put the above code inside laravelapp it won't work. Therefore you must copy all your core files into public_html and put the .htaccess file there .If you want to keep the code in a subdirectory then you can create a subdomain then this code will work for that also.Create .htaccess file in root directory and place code something like below.1) I haven't found a working method for moving the public directory in L5.  While you can modify some things in the bootstrap index.php, it appears several helper functions are based on the assumption of that public directory being there.  In all honestly you really shouldn't be moving the public directory.2) If your using MAMP then you should be creating new vhosts for each project, each serving that projects public directory.  Once created you access each project by your defined server name like this :It's possible to remove public url in laravel5. Follow these steps:step 1.copy all file from public and paste on root directorystep 2.open index.php file

   replace withto and to And remove all cache and cookies.Let's say you placed all the other files and directories in a folder named 'locale'.Just go to index.php and find these two lines:and change them to this:BEST Approach:

I will not recommend removing public, instead on local computer create a virtual host point to public directory and on remote hosting change public to public_html and point your domain to this directory. Reason, your whole laravel code will be secure because its one level down to your public directory :) I just rename server.php to index.php and it worksThis work well for all laravel version...Here is my Directory Structure,Follow these easy stepsto  andtotoand that's it, now try http:// localhost/laravel/Here is the Best and shortest solution that works for me as of may, 2018

for Laravel 5.5I would like to add to @Humble Learner and note that the proper location to "fix" the url path for assets is /Illuminate/Routing/UrlGenerator.php/asset().Update the method to match:This will fix scripts, styles and image paths. Anything for asset paths. 4 best ways to remove public from the URL.If you used any other trick to remove the public from the URL like changes the name of server.php to index.php and changing into the core file path. Clearly, don't do that. Then why Laravel not giving the solution like this because it's not a proper way to do that.By adding a .htaccess file into the root, You can access the website without publicI am giving demo here for the Window operating system. But I will try to define a step so that anyone can easily follow the step. You can also research on google for the same for the particular operating system.Step 1: Go to C:\Windows\system32\drivers\etc\ open the "hosts" file in Administrator mode.Step 2: Add the following code to it. Here, I am giving you a demo of projectname.local domain name demo, you can specify any as you like. Just make it constant at every place.Step 3: Now go to, C:\xampp\apache\conf\extra for xampp users and for the wamp user "C:\wamp\bin\apache\Apache2.4.4\conf\extra" and open "httpd-vhosts.conf" file. Now add the following code into it.Notes: Change the Document root as per your project also add domain name as you define into the "hosts" file.Step 4: Last but the important step is to restart your Xampp or Wamp and access the url like http://projectname.local and your Laravel will respond without public URL.If you are working in local then you don't need to do anything just need to run the following command from your terminal or command line tool. After that, you can access your website by provided URL by the command line.If you are willing to run your project on particular IP then you need to run following command. If you are working on LAN then if you want to allow other people to access your website from local then you just need to check your IP address using command line by running "ipconfig" after getting your IP address run following the command.If you are willing to run your project on a particular IP with particular port then you need to the following command.After completion of the project you need to host the project on the server, then you just need to set the document root on your domain to the public folder. Check the below screenshot.As per screenshot if you don't have any project folder into the public_html then you just need to set your document root like "public_html/public".For XAMPP user to remove public from url without touching laravel default filesystem is to set a Virtual Host for your application to do this jsut follow these steps127.0.0.1       localhostThe original article can be found hereThere is always a reason to have a public folder in the Laravel setup, all public related stuffs should be present inside the public folder, Just write rewrite condition in the .htaccess file and install rewrite module and enable the rewrite module, the problem which adds public in the route will get solved.After having installed Laravel for the first time, I faced the renowned "public folder problem" and I came up with this solution that, in my personal opinion, is "cleaner" then the others I found on the Web.Everything can be done just editing the .htaccess using mod_rewrite and four simple rules.I commented everything, so it should be clear (I hope) also to those who have never used mod_rewrite (not that I'm an expert, all the opposite). Also, to understand the rules, it must be clear that, in Laravel, if Bill connects to https://example.com, https://example.com/index.php is loaded. This file just contains the command header("refresh: 5; https://example.com/public/"), which sends the request to https://example.com/public/index.php. This second index.php is responsible to load the controller and other stuff.The following rule (originally in public/.htaccess) can be deleted. The same rule, in fact, is explicited in a more detailed way in the last two rules.EDIT: I missed Abhinav Saraswat's solution and his answer should be the accepted one. Just one, simple and clear rule that redirects all the traffic to the public folder without modifying any file.Firstly you can use this stepssource: https://stackoverflow.com/a/28735930after you follow these steps then you need to change all css and script path, but this will be tiring.Solution Proposal :simply you can make minor change the helpers::asset function.For this:Activate the mod_rewrite module withand restart the apacheTo use mod_rewrite from within .htaccess files (which is a very common use case), edit the default VirtualHost withBelow "DocumentRoot /var/www/html" add the following lines:Restart the server again:I know that are are a lot of solution for this issue. The best and the easiest solution is to add .htaccess file in the root directory.I tried the answers that we provided for this issue however I faced some issues with auth:api guard in Laravel.Here's the updated solution:Create the .htaccess file in your root directory and add this code. And everything goes rightI have read some article before and it's working fine but really don't know is safe or notEdit the index.phptoEven if i do not recommend putting Laravel on the root folder there are some cases when it could not be avoided;

for those cases the above methods do not work for assets so i made a quick fix changing the htaccess:

after copying server.php to index.php edit the .htaccess file like so:This was a quick fix i had to make so anyone is welcome to upgrade it.Problem is if you type /public and it will still be available in the url, therefor i created a fix which should be placed in the public/index.phpthis peace of code will remove public from the url and will give a 404 and then redirects to the url without the publicAnother method that I use is to create a symbolic link (in Linux, don't know about Win) using the ln command in htdocs or www i.e. ln projectname/public project

The site is thus accessible via localhost/projectYou can remove public keyword from url using various methods.1) If you are using dedicated hosting and you have root access then You can remove public keyword from url using Virtual Host. You should give DocumentRoot path with public. So this will start index from public directory and remove it from url.2) If you dont have root access of your hosting then you should genarate a new .htaccess file in your root directory and put the code as belowYou can get more reference here.I found the most working solution to this problem. Just edit your .htaccess in the root folder and write the following code. Nothing else requiredi have try some solution here and found htaccess that work for laravel 5.2, like this :when you have another file or folder to forbidden just add You don't need to do much, just create a .htaccess file on the root directory and paste/save the below;Please add these line into your root htaccess folder, which does the job

Differences and Similarities Between Lumen and Laravel

Ranjit Karki

[Differences and Similarities Between Lumen and Laravel](https://stackoverflow.com/questions/29647960/differences-and-similarities-between-lumen-and-laravel)

I read the documentation and it seems Lumen is Laravel with less features. I must be missing something.

I am looking for a comparison table of the components and features of both Laravel and Lumen. Does anyone know the differences?

2015-04-15 10:35:56Z

I read the documentation and it seems Lumen is Laravel with less features. I must be missing something.

I am looking for a comparison table of the components and features of both Laravel and Lumen. Does anyone know the differences?With the latest version of Lumen (5.2) the Microframework focuses on Stateless APIs.

The documentation states:Lumen is all about speed. It's faster and can handle more requests per second than Laravel.Laravel is a framework that glues together a lot of components (3rd party and Laravels own components). Now Lumen makes use of a lot of the same components, but strips down the bootstrapping process to a minimum. You could say it is a "different glue", the components (and therefore a lot of the features) are mostly the same.The performance improvement is achieved by taking away some of the flexibility of the framework in terms of configuration and altering the default boot process.  Besides that, more features are disabled by default and have to be activated before they can be used. As an example: Facades (like DB::table())

You first need to uncomment this line in bootstrap/app.php to enable them:The same goes for Dotenv environment files and Eloquent.For routing Lumen uses nikic/FastRoute instead of symfonys router because it performs a lot better and gives the micro-framework another big boost.Other than that pretty much everything is the same as in Laravel.Good reads on LumenLumen is not designed to replace Laravel, rather, it is a more specialized (and stripped-down) framework designed for micro-services and APIs. It took away unneeded features for an API such as HTTP sessions and cookies, and also limited the number of configuration options. Out-of-the-box, Lumen sacrified the flexibility of Laravel for speed.However, you can add Laravel components to Lumen to extend it, so it can be used for more than just micro-services and API. However, if your goal is to extend Lumen to become a website, you might as well use Laravel instead.They also have different use cases. Lumen and Laravel are meant to work together. For APIs and services are frequently get called, use Lumen. For user-facing applications, use Laravel.This answer is taken from a blog post I wrote that explains the difference between Lumen and Laravel.Quote from Matt Stauffer You can read more hereLumen microframework is a lightweight version of Laravel full-stack framework. Lumen use the Laravel syntax and components, and can be 'upgrade' easily to Laravel.Lumen is a more specialized (and stripped-down) framework designed for Microservices development and API development. So, some of the features in Laravel such as HTTP sessions, cookies, and templating are not needed and Lumen takes them away, keeping what's essential - routing, logging, caching, queues, validation, error handling and a couple of others.Why Lumen ? Lumen is a framework to build APIs, which will essentially serve JSON responses for your requests. That's it.These kinds of applications are known as web services in general. As of Lumen 5.2 update, it doesn't support laravel views, sessions etc... for that you will have to upgrade to full laravel framework.Some components of the Laravel framework is swapped with other packages in favour of performance. check them here Example scenarios where we can consider LumenThe main difference between laravel and lumen is, Laravel can have artisan commands, which lumen doesn't have.

Disable Laravel's Eloquent timestamps

projectxmatt

[Disable Laravel's Eloquent timestamps](https://stackoverflow.com/questions/19937565/disable-laravels-eloquent-timestamps)

I'm in the process of converting one of our web applications from CodeIgniter to Laravel. However at this moment we don't want to add the updated_at / created_at fields to all of our tables as we have a logging class that does all this in more depth for us already. I'm aware I can set $timestamps = false; in:However I'd rather not change a core file for Laravel, or have everyone of my models have that at the top. Is there any way to disable this elsewhere for all models?

2013-11-12 18:54:09Z

I'm in the process of converting one of our web applications from CodeIgniter to Laravel. However at this moment we don't want to add the updated_at / created_at fields to all of our tables as we have a logging class that does all this in more depth for us already. I'm aware I can set $timestamps = false; in:However I'd rather not change a core file for Laravel, or have everyone of my models have that at the top. Is there any way to disable this elsewhere for all models?You either have to declare public $timestamps = false; in every model, or create a BaseModel, define it there, and have all your models extend it instead of eloquent.  Just bare in mind pivot tables MUST have timestamps if you're using Eloquent.Update: Note that timestamps are no longer REQUIRED in pivot tables after Laravel v3.Update: You can also disable timestamps by removing $table->timestamps() from your migration.Simply add this line to your Model:public $timestamps = false;Example:If you only need to only to disable updating updated_at just add this method to your model.This will override the parent setUpdatedAtAttribute() method. created_at will work as usual.

Same way you can write a method to disable updating created_at only.If you are using 5.5.x:And for 'created_at' field, you can use:Make sure you are on the newest version.

(This was broken in Laravel 5.5.0 and fixed again in 5.5.5).Eloquent Model:Or Simply try thisIn case you want to remove timestamps from existing model, as mentioned before, place this in your Model:Also create a migration with following code in the up() method and run it:You can use $table->timestamps() in your down() method to allow rolling back.just declare the public timestamps variable in your Model to false and everything will work great.public $timestamps = false;

 Add this line into your model:Override the functions setUpdatedAt() and getUpdatedAtColumn() in your modelYou can temporarily disable timestamps

Laravel: Get base url

Inigo

[Laravel: Get base url](https://stackoverflow.com/questions/23059918/laravel-get-base-url)

Simple question, but the answer seems quite hard to come by. In Codeigniter, I could load the url helper and then simply doto get my site's URL. Is there an equivalent in Laravel?

2014-04-14 12:19:23Z

Simple question, but the answer seems quite hard to come by. In Codeigniter, I could load the url helper and then simply doto get my site's URL. Is there an equivalent in Laravel?You can use the URL facade which lets you do calls to the URL generatorSo you can do:You can also use the application container:Or inject the UrlGenerator:Laravel < 5.2Laravel >= 5.2Hope this helps youFor Laravel 5 I normally use:I'm of the understanding that using the url() function is calling the same Facade as URL::to() Updates from 2018 Laravel release(5.7) documentation with some more url() functions and it's usage.1. Accessing The Base URL2. Accessing The Current URL3. URLs For Named Routes4. URLs To Assets(Public)5. File URLsEach of these methods may also be accessed via the URL facade:How to  call these Helper functions from blade Template(Views) with usage.To get it to work with non-pretty URLs I had to do:Laravel provides bunch of helper functions and for your requirement you can simply use url() function of Laravel Helpers but in case of Laravel 5.2 you will have to use url('/')here is the list of all other helper functions of LaravelThis:And this:both displayed the home url in my case :)Another possibility: {{ URL::route('index') }}You can also use URL::to('/') to display image in Laravel. Please see below:Assume that, your image is stored under "public/images".I used this and it worked for me in Laravel 5.3.18:IMPORTANT NOTE: This will only work when you have already removed "public" from your URL. To do this, you may check out this helpful tutorial.By the way, if your route has a name like:You can use the route() function like this:Other useful functions:https://github.com/laravel/framework/blob/5.4/src/Illuminate/Foundation/helpers.phpTo just get the app url, that you configured you can use :You can use facades or helper function as per following.Check this -This is working for me and I hope it will work for you.I found an other way to just get the base url to to display the value of environment variable APP_URLwhich will display the base url like http://domains_your//yours_website. beware it assumes that you had set the environment variable in .env file (that is present in the root folder).you can get it from Request, at laravel 5

What are the Differences Between「php artisan dump-autoload」and「composer dump-autoload」?

Naing Lin Aung

[What are the Differences Between「php artisan dump-autoload」and「composer dump-autoload」?](https://stackoverflow.com/questions/20274082/what-are-the-differences-between-php-artisan-dump-autoload-and-composer-dump)

I am pretty new to Laravel 4 and Composer. While I do Laravel 4 tutorials, I couldn't understand the difference between those two commands; php artisan dump-autoload and composer dump-autoload What's the difference between them? 

2013-11-28 20:10:21Z

I am pretty new to Laravel 4 and Composer. While I do Laravel 4 tutorials, I couldn't understand the difference between those two commands; php artisan dump-autoload and composer dump-autoload What's the difference between them? Laravel's Autoload is a bit different:1) It will in fact use Composer for some stuff2) It will call Composer with the optimize flag3) It will 'recompile' loads of files creating the huge bootstrap/compiled.php4) And also will find all of your Workbench packages and composer dump-autoload them, one by one.php artisan dump-autoload was deprecated on Laravel 5, so you need to use composer dump-autoload

How to Get the Query Executed in Laravel 5? DB::getQueryLog() Returning Empty Array

Arsen

[How to Get the Query Executed in Laravel 5? DB::getQueryLog() Returning Empty Array](https://stackoverflow.com/questions/27753868/how-to-get-the-query-executed-in-laravel-5-dbgetquerylog-returning-empty-ar)

I'm trying to view the log for a query, but DB::getQueryLog() is just returning an empty array:ResultHow can I view the log for this query?

2015-01-03 10:30:06Z

I'm trying to view the log for a query, but DB::getQueryLog() is just returning an empty array:ResultHow can I view the log for this query?By default, the query log is disabled in Laravel 5:

https://github.com/laravel/framework/commit/e0abfe5c49d225567cb4dfd56df9ef05cc297448You will need to enable the query log by calling:or register an event listener:If you have more than one DB connection you must specify which connection to logTo enables query log for my_connection:To get query log for my_connection:For an HTTP request lifecycle, you can enable query log in the handle method of some BeforeAnyDbQueryMiddleware middleware and then retrieve the executed queries in the terminate method of the same middleware.A middleware's chain will not run for artisan commands, so for CLI execution you can enable query log in the artisan.start event listener.For example you can put it in the bootstrap/app.php fileLaravel keeps all queries in memory. So in some cases, such as when inserting a large number of rows, or having a long running job with a lot of queries, this can cause the application to use excess memory. In most cases you will need the query log only for debugging, and if that is the case I would recommend you enable it only for development.ReferencesIf all you really care about is the actual query (the last one run) for quick debugging purposes:do a print_r() on $laQuery[0] to get the full query, including the bindings. (the $lcWhatYouWant variable above will have the variables replaced with ??)If you're using something other than the main mysql connection, you'll need to use these instead:(with your connection name where "mysql2" is)Put this on routes.php file:Submitted by msurguy, source code in this page. You will find this fix-code for laravel 5.2 in comments.You need to first enable query loggingThen you can get query logs by simply:It would be better if you enable query logging before application starts, which you can do in a BeforeMiddleware and then retrieve the executed queries in AfterMiddleware. Apparently with Laravel 5.2, the closure in DB::listen only receives a single parameter.So, if you want to use DB::listen in Laravel 5.2, you should do something like:For laravel 5.8 you just add dd or dump.Ex:orreference:

https://laravel.com/docs/5.8/queries#debuggingUse toSql() instead of get() like so:(Laravel 5.2) I find the simplest way is just to add one code line to monitor the sql queries:In continuing of the Apparently with Laravel 5.2, the closure in DB::listen only receives a single parameter... response above : you can put this code into the Middleware script and use it in the routes.Additionally:This code is for:Here is the code, which is based on @milz 's answer:The core is the if(stripos... line, which prevents the recursion of inserting the insert into log sql statement into database.I think the answer located in this article:

https://arjunphp.com/laravel-5-5-log-eloquent-queries/is fast and simple to achieve query logging. You just have to add to the AppServiceProvider in the boot method a callback to listen to DB queries:Suppose you want to print the SQL query of the following statements.You just need to do as follows:This will print the last executed query in Laravel.For laravel 5 and onwards using only DB::getQueryLog() , will not do.

BY default in this the value of change it to in the below file for logging query.And then we can use the DB::getQueryLog() where you want to print the query.

Doing HTTP requests FROM Laravel to an external API

Chilion

[Doing HTTP requests FROM Laravel to an external API](https://stackoverflow.com/questions/22355828/doing-http-requests-from-laravel-to-an-external-api)

What I want is get an object from an API with a HTTP (eg, jQuery's AJAX) request to an external api. How do I start? I did research on Mr Google but I can't find anything helping.Im starting to wonder is this is even possible?

In this post Laravel 4 make post request from controller to external url with data it looks like it can be done. But there's no example nor any source where to find some documentation.Please help me out?

2014-03-12 15:14:20Z

What I want is get an object from an API with a HTTP (eg, jQuery's AJAX) request to an external api. How do I start? I did research on Mr Google but I can't find anything helping.Im starting to wonder is this is even possible?

In this post Laravel 4 make post request from controller to external url with data it looks like it can be done. But there's no example nor any source where to find some documentation.Please help me out?Based upon an answer of a similar question here:

https://stackoverflow.com/a/22695523/1412268Take a look at GuzzleWe can use package Guzzle in Laravel, it is a PHP HTTP client to send HTTP requests.You can install Guzzle through composerOr you can specify Guzzle as a dependency in your project's existing composer.jsonExample code in laravel 5 using Guzzle as shown below,You just want to call an external URL and use the results? PHP does this out of the box, if we're talking about a simple GET request to something serving JSON:If you want to do a post request, it's a little harder but there's loads of examples how to do this with curl. So I guess the question is; what exactly do you want?Updated on March 21 2019Add GuzzleHttp package using composer require guzzlehttp/guzzle:~6.3.3Or you can specify Guzzle as a dependency in your project's composer.jsonInclude below line in the top of the class where you are calling the APIAdd below code for making the request Definitively, for any PHP project, you may want to use GuzzleHTTP for sending requests.

Guzzle has very nice documentation you can check here.

I just want to say that, you probably want to centralize the usage of the Client class of Guzzle in any component of your Laravel project (for example a trait) instead of being creating Client instances on several controllers and components of Laravel (as many articles and replies suggest).I created a trait you can try to use, which allows you to send requests from any component of your Laravel project, just using it and calling to makeRequest.Notice this trait can even handle files sending.If you want more details about this trait and some other stuff to integrate this trait to Laravel, check this article. Additionally, if interested in this topic or need major assistance, you can take my course which guides you in the whole process.I hope it helps all of you.Best wishes :)You can use Httpful :Website : http://phphttpclient.com/Github : https://github.com/nategood/httpful

What does「Mass Assignment」mean in Laravel?

Chen-Tsu Lin

[What does「Mass Assignment」mean in Laravel?](https://stackoverflow.com/questions/22279435/what-does-mass-assignment-mean-in-laravel)

When I went through Laravel Document about Eloquent ORM topic part, I got a new term Mass Assignment.Document show How to do Mass Assignment and the fillable or guarded properties settings. But after went through that, I didn't have a clearly understand about Mass Assignment and how it works.In my past experience in CodeIgniter, I also didn't hear about this term.Does anyone have a simple explanation about that?

2014-03-09 07:14:28Z

When I went through Laravel Document about Eloquent ORM topic part, I got a new term Mass Assignment.Document show How to do Mass Assignment and the fillable or guarded properties settings. But after went through that, I didn't have a clearly understand about Mass Assignment and how it works.In my past experience in CodeIgniter, I also didn't hear about this term.Does anyone have a simple explanation about that?Mass assignment is when you send an array to the model creation, basically setting a bunch of fields on the model in a single go, rather than one by one, something like:(This is instead of explicitly setting each value on the model separately.) You can use fillable to protect which fields you want this to actually allow for updating.You can also block all fields from being mass-assignable by doing this:Let's say in your user table you have a field that is user_type and that can have values of user / adminObviously, you don't want users to be able to update this value. In theory, if you used the above code, someone could inject into a form a new field for user_type and send 'admin' along with the other form data, and easily switch their account to an admin account... bad news.By adding:You are ensuring that only those values can be updated using mass assignmentTo be able to update the user_type value, you need to explicitly set it on the model and save it, like this:Mass assignment is a process of sending an array of data that will be saved to the specified model at once. In general, you don’t need to save data on your model on one by one basis, but rather in a single process.Mass assignment is good, but there are certain security problems behind it. What if someone passes a value to the model and without protection they can definitely modify all fields including the ID. That’s not good.Let's say you have 'students' table, with fields "student_type, first_name, last_name」. You may want to mass assign "first_name, last_name" but you want to protect student_type from being directly changed. That’s where fillable and guarded take place.Fillable lets you specify which fields are mass-assignable in your model, you can do it by adding the special variable $fillable to the model. So in the model:the 'student_type' are not included, which means they are exempted.Guarded is the reverse of fillable. If fillable specifies which fields to be mass assigned, guarded specifies which fields are not mass assignable. So in the model:you should use either $fillable or $guarded - not both.For more details open link:- Mass AssignmentMass assignment means you are filling a row with more than one column using an array of data. (somewhat of a shortcut instead of manually building the array) using Input::all(). Technically just from the top of my head. Fillable means what columns in the table are allowed to be inserted, guarded means the model can't insert to that particular column.Notice that when you try to do a mass assignment with like, insert to a column named "secret", and you have specified that it is guarded, you can try to insert to it via the model, but it will never really get inserted into the database. This is for security, and protection on your table when using the model. Mass assignment seems to be just a notice or warning that you didn't tell the model which are fillable and guarded and makes it vulnerable to some kind of attacks.UPDATEFor Laravel 5.x+ you can refer to the latest doc mass assignmentORA well detailed explanation on when to use fillable or guardedThis is when an array of data received is saved at once in a model.Because of the security issues with this method in laravel, it's recommended you define the fields you wish the requested data to populate on the Model.You can use the $fillable variable to define the fields you want to populate on the database table.E.gWhen laravel detects you are mass assigning data, it forces you to define the fields you want to mass assign in the model class.Someone can easily pass unwanted data into an html form to your database.

Bulk Insertion in Laravel using eloquent ORM

phoenixwizard

[Bulk Insertion in Laravel using eloquent ORM](https://stackoverflow.com/questions/12702812/bulk-insertion-in-laravel-using-eloquent-orm)

How can we perform bulk database insertions in Laravel using Eloquent ORM?I want to accomplish this in Laravel: https://stackoverflow.com/a/10615821/600516

but I am getting the following error.

2012-10-03 06:16:16Z

How can we perform bulk database insertions in Laravel using Eloquent ORM?I want to accomplish this in Laravel: https://stackoverflow.com/a/10615821/600516

but I am getting the following error.You can just use Eloquent::insert().For example:We can update GTF answer to update timestamps easilyUpdate:

to simplify the date we can use carbon as @Pedro Moreira suggested UPDATE2: for laravel 5 , use updated_at instead of modified_atTo whoever is reading this, check out createMany() method.This is how you do it in more Eloquent way, I searched many times for it, finally used custom timestamps like below:Eloquent::insert is the proper solution but it wont update the timestamps, so you can do something like belowThe idea is to add created_at and updated_at on whole array before doing insertFrom Laravel 5.7 with Illuminate\Database\Query\Builder you can use insertUsing method.UserSubscription is my model name.

This will return "true" if insert successfully else "false".Maybe a more Laravel way to solve this problem is to use a collection and loop it inserting with the model taking advantage of the timestamps.EDIT:Sorry for my misunderstanding. For bulk inserting this could help and maybe with this you can make good seeders and optimize them a bit.For category relations insertion I came across the same problem and had no idea, except that in my eloquent model I used Self() to have an instance of the same class in foreach to record multiple saves and grabing ids.without "$obj = new Self()" it only saves single record (when $obj was $this)Problem solved... Alter table for migrateSolution:

PHP Composer update「cannot allocate memory」error (using Laravel 4)

ericbae

[PHP Composer update「cannot allocate memory」error (using Laravel 4)](https://stackoverflow.com/questions/18116261/php-composer-update-cannot-allocate-memory-error-using-laravel-4)

I just can't solve this one.I'm on Linode 1G RAM basic plan. Trying to install a package via Composer and it's not letting me. My memory limit is set to "-1" on PHP.iniIs there anything else I can do to get this installed?

2013-08-08 00:58:48Z

I just can't solve this one.I'm on Linode 1G RAM basic plan. Trying to install a package via Composer and it's not letting me. My memory limit is set to "-1" on PHP.iniIs there anything else I can do to get this installed?A bit old but just in case someone new is looking for a solution, updating your PHP version can fix the issue.Also you should be committing your composer.lock file and doing a composer install on a production environment which is less resource intensive.More details here:

https://github.com/composer/composer/issues/1898#issuecomment-23453850Looks like you runs out of swap memory,

try thisas mentioned by @BlackBurn027 on comments below, this solution was described in hereAs composer troubleshooting guide here

This could be happening because the VPS runs out of memory and has no Swap space enabled.To enable the swap you can use for example:I have faced the same issue. I am on a AWS Free Microinstance which has less memory. I always try one of the below options and it always works (Before all this please check if you have the latest version of composer installed)or remove the contents of the vendor folder and try composer update.The second option tries to update all the components, if there is no update, it picks up the package from the cache else picks up from the distNote: Please change the memory limit as per your choice.or Create a swap partition and try. Swap partition is the portion of the hard drive that linux uses as virtual memory when it runs out of physical memory. It's similar to the windows swap file only instead of using an actual file, linux uses a partition on the hard drive instead.Hope this helpsEasy, type this commands:rm -rf vendor/rm -rf composer.lockphp composer install --prefer-distShould work for low memory machinesI had a same issue on vagrant. I fixed it by allcate more memory.Here are the steps to fix the problem:

(instant fast SWAP file allocation method used)Server SWAP Setup (Ubuntu 16.04 SWAP to Fix Out of Memory Errors)Check if you have swap already, memory and disk size:Make swap file: (change 1G to 4G if you want 4GB SWAP memory)Check swap file:Assign Swap File:Check if swap OK, memory and disk size:Attach Swap File on System Restart:Adjust Swap File Settings:      SWAP File Priority: (0-100% => 0: Don't put to swap,  100: Put on SWAP and free the RAM)Remove inode from cache: (100: system removes inode information from the cache too quickly)Try that:Here is the workaround that I found that works for me every time:I tried by just deleting the vendor folder and composer.lock file and then i run the command composer clear-cache and then composer install. So it working without any error.you can use the following to check your free (swap) memoryTo enable the swap you can use for example:Try it's basically raising the swap memorysudo /bin/dd if=/dev/zero of=/var/swap.1 bs=1M count=1024 && sudo /sbin/mkswap /var/swap.1 && sudo /sbin/swapon /var/swap.1This seems to be a recurring issue with 1GB and smaller server instances. Apart from trying to shutdown processes and tweak swap settings, you could install on a local machine and upload.Try this:This work for me on Centos 6Sometimes by self-updating composer it solves the problemCheersI get into this situation most of the times so normally i used to follow the step of setting the swap memory.But now i found a simple alternate trick which worked for me.Run

    composer update --no-dev Other than composer updateI solved the same problem in Vagrant.

I increased the value of memory_limit

and delete composer cache: sudo rm -R ~/.composer

and finally vagrant reload.I increased the PHP memory_limit from the default 128M to 512M and restart the server. That solved the problem.have same problem with php composer.phar update on my 512mb hosting.solved with php composer.phar installMake a swap and run composer command again. I hope it'll work for you.I had a similar issue on the cheapest server (512MB RAM) hosted with DigitalOcean, and I was also running Jenkins CI on the same server. After I stopped the Jenkins instance the composer install command worked (well, to a point, it failed with the mcrypt extension missing besides already being installed!).Maybe if you have another app running on the server, maybe its worth trying to stop it and re-running the command.Please disable js bundling and increase memory. That should fix it. I fixed mine by disabling js bundling.ThanksIn my case I tried everything that was listed above. I was using Laravel and Vagrant with 4GB of memory and a swap, with memory limit set to -1. I deleted the vendor/ and tried other PHP-versions. Finally, I managed it to work by runningAnd then composer install worked again as usual.edit php.ini file and increase memory_limit value. will solve this issue.Update memory on Server and require '4G' Change 4GB Ram [try to change server type or add more ram]2 Files We need to editon command and edit "memory_limit 756M」to 4GPhp ini on php 7.0memory_limit = 128M to 4G#AWS #AMAZONLINUX #MAGENTO2 #PHP7.0

Automatically deleting related rows in Laravel (Eloquent ORM)

Martti Laine

[Automatically deleting related rows in Laravel (Eloquent ORM)](https://stackoverflow.com/questions/14174070/automatically-deleting-related-rows-in-laravel-eloquent-orm)

When I delete a row using this syntax:Is there a way to attach a callback of sorts, so that it would e.g. do this automatically:Preferably inside the model-class.

2013-01-05 16:55:28Z

When I delete a row using this syntax:Is there a way to attach a callback of sorts, so that it would e.g. do this automatically:Preferably inside the model-class.I believe this is a perfect use-case for Eloquent events (http://laravel.com/docs/eloquent#model-events). You can use the "deleting" event to do the cleanup:

You should probably also put the whole thing inside a transaction, to ensure the referential integrity..You can actually set this up in your migrations:$table->foreign('user_id')->references('id')->on('users')->onDelete('cascade');Source: http://laravel.com/docs/5.1/migrations#foreign-key-constraintsYou can delete all related photos before actually deleting the user.Hope it helps.Relation in User model:Delete record and related:There are 3 approaches to solving this:1. Using Eloquent Events On Model Boot (ref: https://laravel.com/docs/5.7/eloquent#events)2. Using Eloquent Event Observers (ref: https://laravel.com/docs/5.7/eloquent#observers)In your AppServiceProvider, register the observer like so:Next, add an Observer class like so:3. Using Foreign Key Constraints (ref: https://laravel.com/docs/5.7/migrations#foreign-key-constraints)As of Laravel 5.2, the documentation states that these kinds of event handlers should be registered in the AppServiceProvider:I even suppose to move them to separate classes instead of closures for better application structure.It is better if you override the delete method for this. That way, you can incorporate DB transactions within the delete method itself. If you use the event way, you will have to cover your call of delete method with a DB transaction every time you call it.In your User model.In my case it was pretty simple because my database tables are InnoDB with foreign keys with Cascade on Delete. So in this case if your photos table contains a foreign key reference for the user than all you have to do is to delete the hotel and the cleanup will be done by the Data Base, the data base will delete all the photos records from the data base.I would iterate through the collection detaching everything before deleting the object itself.here's an example:I know it is not automatic but it is very simple.Another simple approach would be to provide the model with a method. Like this:Then you can simply call this where you need:Or you can do this if you wanted, just another option:Note if you are not using the default laravel db connection then you need to do the following:To elaborate on the selected answer, if your relationships also have child relationships that must be deleted, you have to retrieve all child relationship records first, then call the delete() method so their delete events are fired properly as well.You can do this easily with higher order messages.You can also improve performance by querying only the relationships ID column:yeah, but as @supersan stated upper in a comment, if you delete() on a QueryBuilder, the model event will not be fired, because we are not loading the model itself, then calling delete() on that model.The events are fired only if we use the delete function on a Model Instance.So, this beeing said:in order to delete the post tags when deleting the user, we would have to iterate over $user->posts and calling $post->delete()foreach($user->posts as $post) { $post->delete(); } -> this will fire the deleting event on PostVS$user->posts()->delete() -> this will not fire the deleting event on post because we do not actually load the Post Model (we only run a SQL like: DELETE * from posts where user_id = $user->id and thus, the Post model is not even loaded)You can use this method as an alternative.What will happen is that we take all the tables associated with the users table and delete the related data using looping

laravel 5.3 new Auth::routes()

g1eny0ung

[laravel 5.3 new Auth::routes()](https://stackoverflow.com/questions/39196968/laravel-5-3-new-authroutes)

Recently I start to use laravel 5.3 to write a blog, but I have a question after run php artisan make:authwhen I run this, it will generate routes in my web.phpthis is the code in it:Then I run php artisan route:list, I find lots of actions, like LoginController@login...But I didn't find these actions in my App\Http\Controllers\Auth, where are these?And also what is the Auth::routes() stand for, I can't find the routes about Auth.I need someone help, thank you to answer my question

2016-08-29 00:13:57Z

Recently I start to use laravel 5.3 to write a blog, but I have a question after run php artisan make:authwhen I run this, it will generate routes in my web.phpthis is the code in it:Then I run php artisan route:list, I find lots of actions, like LoginController@login...But I didn't find these actions in my App\Http\Controllers\Auth, where are these?And also what is the Auth::routes() stand for, I can't find the routes about Auth.I need someone help, thank you to answer my questionAuth::routes() is just a helper class that helps you generate all the routes required for user authentication. You can browse the code here https://github.com/laravel/framework/blob/5.3/src/Illuminate/Routing/Router.php instead.Here are the routesAuth routes for Laravel 5.3 instead Auth::routes().

I hope it helps...So if you change some names of these routes, remember to also change in views the actions of the posts!Here's Laravel 5.7, Laravel 5.8, and Laravel 6.0 (one minor bc change in 6.0 to the email verification route) including verification routes, if you want to include those as well.You can verify these routes here:For Laravel 5.5.xfunction call order:it's route like this:This worked for me with Laravel 5.6.In the file web.php, just replace:By:And remove the Register link in the two files below:I'm surprised nobody mentioned the command php artisan route:list, which gives a list of all registered app routes (including Auth::routes() and Passport::routes() if registered)the loginuser class uses a trait called AuthenticatesUsersif you open that trait you will see the functions (this applies for other controllers)

Illuminate\Foundation\Auth\AuthenticatesUsers;here is the trait code https://github.com/laravel/framework/blob/5.1/src/Illuminate/Foundation/Auth/AuthenticatesUsers.phpsorry for the bad format, im using my phonealso Auth::routes() it just calls a function that returns the auth routes thats it (i think)If you are searching these same routes for laravel 7 version you'll find it here Vendor/laravel/ui/src/AuthRouteMethods.php

Cannot create cache directory .. or directory is not writable. Proceeding without cache in Laravel

Karthik

[Cannot create cache directory .. or directory is not writable. Proceeding without cache in Laravel](https://stackoverflow.com/questions/35874482/cannot-create-cache-directory-or-directory-is-not-writable-proceeding-withou)

I Created one New Laravel Project. When I go to Terminal to install Composer Display Following Error. Cannot create cache directory /home/w3cert/.composer/cache/repo/https---packagist.org/, or directory is not writable. Proceeding without cache.I am using Ubuntu Os

2016-03-08 17:52:40Z

I Created one New Laravel Project. When I go to Terminal to install Composer Display Following Error. Cannot create cache directory /home/w3cert/.composer/cache/repo/https---packagist.org/, or directory is not writable. Proceeding without cache.I am using Ubuntu OsChange the group permission for the folderand the Files folder tooI'm assuming w3cert is your username, if not change the 4th parameter to your username.If the problem still persists tryNow, there is a chance that you won't be able to create your app directory, if that happens do the same for your html folder or the folder you are trying to create your laravel project in.Hope this helps.When you installed composer pretty sure you used $ sudo command because of that the ~/.composer folder was created by the root.Run this to fix the issue:I had the same problem today. Try it!Give full access of .composer to user.or user-name is your system user-name.to get user-name type "whoami" in terminal:

Laravel 5 - redirect to HTTPS

NightMICU

[Laravel 5 - redirect to HTTPS](https://stackoverflow.com/questions/28402726/laravel-5-redirect-to-https)

Working on my first Laravel 5 project and not sure where or how to place logic to force HTTPS on my app. The clincher here is that there are many domains pointing to the app and only two out of three use SSL (the third is a fallback domain, long story). So I'd like to handle this in my app's logic rather than .htaccess.In Laravel 4.2 I accomplished the redirect with this code, located in filters.php:I'm thinking Middleware is where something like this should be implemented but I cannot quite figure this out using it.Thanks!UPDATEIf you are using Cloudflare like I am, this is accomplished by adding a new Page Rule in your control panel. 

2015-02-09 04:14:43Z

Working on my first Laravel 5 project and not sure where or how to place logic to force HTTPS on my app. The clincher here is that there are many domains pointing to the app and only two out of three use SSL (the third is a fallback domain, long story). So I'd like to handle this in my app's logic rather than .htaccess.In Laravel 4.2 I accomplished the redirect with this code, located in filters.php:I'm thinking Middleware is where something like this should be implemented but I cannot quite figure this out using it.Thanks!UPDATEIf you are using Cloudflare like I am, this is accomplished by adding a new Page Rule in your control panel. You can make it works with a Middleware class. Let me give you an idea.Then, apply this middleware to every request adding setting the rule at Kernel.php file, like so:At sample above, the middleware will redirect every request to https if:I am using this code in production environment with a WildCard SSL and the code works correctly. If  I remove && App::environment() === 'production' and test it in localhost, the redirection also works. So, having or not a installed SSL is not the problem. Looks like you need to keep a very hard attention to your Cloudflare layer in order to get redirected to Https protocol.Thanks to @Adam Link's suggestion: it is likely caused by the headers that Cloudflare is passing. CloudFlare likely hits your server via HTTP and passes a X-Forwarded-Proto header that declares it is forwarding a HTTPS request. You need add another line in your Middleware that say......to trust the headers CloudFlare is sending. This will stop the redirect loopJust need to add the middleware class into web group in kernel.php file:An other option that worked for me, in AppServiceProvider place this code in the boot method:The function written before forceScheme('https') was wrong, its forceSchemeAlternatively, If you are using Apache then you can use .htaccess file to enforce your URLs to use https prefix. On Laravel 5.4, I added the following lines to my .htaccess file and it worked for me.for laravel 5.4 use this format to get https redirect instead of .htaccessSimilar to manix's answer but in one place. Middleware to force HTTPS

This is for Larave 5.2.x and greater. If you want to have an option to serve some content over HTTPS and others over HTTP here is a solution that worked for me. You may wonder, why would someone want to serve only some content over HTTPS? Why not serve everything over HTTPS? Although, it's totally fine to serve the whole site over HTTPS, severing everything over HTTPS has an additional overhead on your server. Remember encryption doesn't come cheap. The slight overhead also has an impact on your app response time. You could argue that commodity hardware is cheap and the impact is negligible but I digress :) I don't like the idea of serving marketing content big pages with images etc over https. So here it goes. It's similar to what others have suggest above using middleware but it's a full solution that allows you to toggle back and forth between HTTP/HTTPS.First create a middleware. This is what your middleware should look like. Note that I'm not filtering based on environment because I have HTTPS setup for both local dev and production so there is not need to. Add the following to your routeMiddleware \App\Http\Kernel.php so that you can pick and choose which route group should force SSL.Next, I'd like to secure two basic groups login/signup etc and everything else behind Auth middleware.Confirm that your middlewares are applied to your routes properly from console.Now you have secured all the forms or sensitive areas of your application, the key now is to use your view template to define your secure and public (non https) links. Based on the example above you would render your secure links as follows - Non secure links can be rendered as What this does is renders a fully qualified URL such as https://yourhost/login  and http://yourhost/aboutusIf you were not render fully qualified URL with http and use a relative link url('/aboutus') then https would persists after a user visits a secure site.Hope this helps!What about just using .htaccess file to achieve https redirect? This should be placed in project root (not in public folder). Your server needs to be configured to point at project root directory. I use this for laravel 5.4 (latest version as of writing this answer) but it should continue to work for feature versions even if laravel change or removes some functionality.You can use RewriteRule to force ssl in .htaccess same folder with your index.php

Please add as picture attach, add it before all rule others

in IndexController.php putin AppServiceProvider.php put}In AppServiceProvider.php every redirect will be go to url https and for http request we need once redirect

so in IndexController.php Just we need do once redirect The answers above didn't work for me, but it appears that Deniz Turan rewrote the .htaccess in a way that works with Heroku's load balancer here:

https://www.jcore.com/2017/01/29/force-https-on-heroku-using-htaccess/If you're using CloudFlare, you can just create a Page Rule to always use HTTPS:

This will redirect every http:// request to https://In addition to that, you would also have to add something like this to your \app\Providers\AppServiceProvider.php boot() function:This would ensure that every link / path in your app is using https:// instead of http://.I'm adding this alternative as I suffered a lot with this issue. I tried all different ways and nothing worked. So, I came up with a workaround for it. It might not be the best solution but it does work -production <- It should be replaced with the APP_ENV value in your .env fileA little different approach, tested in Laravel 5.7PS. Code updated based on @matthias-lill's comments.Here's how to do it on HerokuTo force SSL on your dynos but not locally, add to end of your .htaccess in public/:You can test this out on your local machine with:That sets the header X-forwarded to the form it will take on heroku.i.e. it simulates how a heroku dyno will see a request.You'll get this response on your local machine:That is a redirect. That is what heroku is going to give back to a client if you set the .htaccess as above.  But it doesn't happen on your local machine because X-forwarded won't be set (we faked it with curl above to see what was happening).For Laravel 5.6, I had to change condition a little to make it work.from:To: This worked out for me.

I made a custom php code to force redirect it to https.

Just include this code on the header.phpI am using in Laravel 5.6.28 next middleware:The easiest way would be at the application level. In the file add the following:and in the boot() method add the following:This should redirect all request to https at the application level.( Note: this has been tested with laravel 5.5 LTS ) 

Laravel blank white screen

Mico

[Laravel blank white screen](https://stackoverflow.com/questions/20678360/laravel-blank-white-screen)

My laravel site was working before,  I recently upgraded to Apache 2.4 and PHP 5.5.7.Now I'm getting a white blank screen when I go to laravel.mydomain.com, nothing in apache error logs, routes and etc. should be fine as it worked before..htaccess is loading as I get a 500 when I insert an invalid line to /var/sites/laravel/public/.htaccess.Heres my .htaccess:Heres my virtual host directive:And apachectl -S

2013-12-19 09:54:38Z

My laravel site was working before,  I recently upgraded to Apache 2.4 and PHP 5.5.7.Now I'm getting a white blank screen when I go to laravel.mydomain.com, nothing in apache error logs, routes and etc. should be fine as it worked before..htaccess is loading as I get a 500 when I insert an invalid line to /var/sites/laravel/public/.htaccess.Heres my .htaccess:Heres my virtual host directive:And apachectl -SDoes this answer describe or help your situation? Upgrading to Apache 2.4 come with some changes in Apache configuration. Are you checking Laravel's logs or Apache's logs?Since upgrading to Laravel 4.1, I've had white screen "errors" (WSOD) when the application could not write to the log location. I've always solved this by making the app/storage directory writable by Apache (either group writable to "www-data", "apache" or world-writable - that depends on your server setup.On Ubuntu/Debian servers, your PHP may be running as user "www-data". On CentOS/RedHat/Fedora servers, you PHP may be running as user "apache".Make sure your files are owned by the user that is running PHP:An update to fideloper's answer for Laravel 5 and its new file structure is:Try this, in the public/index.php pageThe following steps solved blank white screen problem on my Laravel 5.This will generate the encryption key and update the value of APP_KEY in .env fileThis should solve the problem. If the problem still exists, then update config/app.php with the new key generated from the above artisan key generate command:for anyone who get blank page even after making storage accessible for displaying errors put these two lines at first lines of public/index.php to see what is happening at least. for me this error was there :Class 'PDO' not found in /var/www/***/config/database.php on line 16 When I was new to Linux.I usually found this error with my Laravel Project.

White errors means error, It may have some permission issue or error.You just have to follow two steps, and will work like champ :)(1) Give the permission. Run these command from root directory of your project(2) If you cloned the project or pulled from github then run(3) Configure your .env file properly, and your project will work.I was struggling with a similar issue on a CentOS server. Using php artisan serv and accessing it through port 8000 on the local machine worked fine but could not get my remote machines to load a particular view. I could return strings fine, and some views were loading. Chased my tail on permissions for a while before I finally realized it was an SELinux issue. I just set it from enforce to permissive and it worked. Hope that helps someone else out there that may be encountering the same issue. In my case , I have installed laravel many times, and I am sure that the folder write permission has been correctly given.Like most of the answers above :The mistake is that my nginx configuration comes from the official documentation.I only modified the domain name after copying ，then I got a blank page.

I tried restarting nginx and php-fpm,but not work for me.Finally, I added this line configuration to solve the problem.I hope I can help others.I have also one more option why blank page issue may occur. If you are on production mode and if you cached your config files by php artisan (config:cache), try to delete cache file executing:or delete it manualy (bootstrap/cache/config.php)Running this command solved it for me:I guess a blank error page was some how cached. Had to clear the caches.I have some issues to setup it in a Vagrant machine. Whats really works for me was execute a:chmod -R o+w app/storage/ from inside the Vagrant machine.Reference: https://laracasts.com/lessons/vagrant-and-laravelAnother thing that may cause the WSOD is missing the 'return' keyword, as in:return View::make('yourview');as opposed to View::make('yourview');Sometimes it's because laravel 5.1 require PHP >= 5.5.9. Update php will solve the problem.Strange for me, but in my case I had to clear the laravel's cache to solve the issue.I also faced same issue after doing composer updateI tried installing composer required monolog/monolog too but didn't work.Then I removed the /vendor directory and ran composer install and worked as per normal. basically it must have reverted my monolog and other stable packages version back to previous. so better not to composer updatewhat I noticed comparing both the /vendor folders and found those classes files under /vendor/monolog/monolog/src/Handler were missing after composer updated.There might be a lot of reasons behind the blank screen without errors.

I have faced this problem many times whenever I want to upload laravel project in shared hosting.Reason: Incorrect PHP VersionIn my case, issue was because of incorrect php version. I had php 7.1 version in local computer where as in shared hosting cpanel, there was php 5.6 version. Switching up the version from 5.6 to 7.1 worked for me.You can change php version in cpanel from multiphp manager available in cpanel home page.Other problem with the same behavior is use Laravel 3 with PHP 5.5.x. You have to change some laravel function's name "yield() because is a reserved word in php 5.5 Reason can be Middleware if you forget to put following code to the end of handle functionI was also getting same error when I start first time on laravel + Ubuntu 14.04

I just right click on bootstrap and storage folder >>> properties >>>permission>> Others Access >>> change it to "Create and delete files" Change permission for enclosed files Thank you Got this from the Laravel forums, but if you recently upgraded Laravel versions AND PHP versions AND are running nginx, make sure you have changed your nginx configuration file to reflect the new PHP version. For instance:In your nginx site config file (here: /etc/nginx/sites-available), changefastcgi_pass unix:/var/run/php5-fpm.sock;tofastcgi_pass unix:/var/run/php/php5.6-fpm.sock;I have same issue. I already change chmod folder for Storage folder. fill database settings in .env, but didn't fix the problem.

I used Laravel 5.5 and I used PHP 5.6, to fix it I went to (cpanel->PHP Selector) and I changed to PHP 7.1 And the issue is done.On normal cases errors should be logged UnlessScript can't write to log fileOr error occurred on higher level check app server logs like Appache || NginxOr it's resources limits 

Like PHP ini settingsOr OS limit's and so on In addition to Permission problems in storage and cache folder and php version issues, there could be another reasons to display blank page without any error message.For example, I had a redeclare error message without any log and with blank white page.

There was a conflict between my own helper function and a vendor function.I suggest as a starting point, run artisan commands. for example:If there was a problem, it will prompted in terminal and you've got a Clue and you can google for the solution.Blank screen also happens when your Laravel app tries to display too much information and PHP limits kick in (for example displaying tens of thousands of database records on a single page). The worst part is, you won't see any errors in the Laravel logs. You probably won't see any errors in the PHP FPM logs as well. You might find errors in your http server logs, for example nginx throws something like FastCGI sent in stderr: "PHP message: PHP Fatal error:  Allowed memory size of XXX bytes exhausted.Short tip: add ->limit(1000) where 1000 is your limit, on your query object.I hit this problem when I tried to run a Laravel 5.8 app on my server, uploading from local development using Vagrant Homestead. After a while I figured out that the dev subdomain on the live server I was running was somehow set to PHP 5.6.cPanel > MultiPHP Manager > Set to PHP 7.2fixed this for me. Hope this might help someone.use this .htaccess to solveFacing the blank screen in Laravel 5.8. Every thing seems fine with both storage and bootstrap folder given 777 rights. On It shows the problem it was the White spaces in App Name of .env filein my case, the BLANK WHITE SCREEN issue was as simple as a typo or wrong character on the env file.

I was implementing socialite, so when I was setting up the .env credentials for Google+ like this:But, the .env file can't use the '+' sign, so I have to make this correction:I hope this help you find a dumb error...Sometimes in route.php you may havewritten beforeIt can be empty method Controller::show() when you begin to develop your controller from scratch. In this case you will get empty blank page when requesting /add url. It happens because the request was handled by /{id} route, and its method returns nothing.Just try to place /add route before /{id}In my case, restarting apache fixed the problem.

for Ubuntu / Debian:

How to disable registration new users in Laravel 5

Milad Rahimi

[How to disable registration new users in Laravel 5](https://stackoverflow.com/questions/29183348/how-to-disable-registration-new-users-in-laravel-5)

I'm using Laravel v5. I'm trying to make a single-user admin panel. It needs only one user. I have already registered that user manually and now I want to disable registration for new users. Of course, I need the login form to work. How can I do that?

2015-03-21 13:37:49Z

I'm using Laravel v5. I'm trying to make a single-user admin panel. It needs only one user. I have already registered that user manually and now I want to disable registration for new users. Of course, I need the login form to work. How can I do that?Laravel 5.7 introduced the following functionality:The currently possible options here are:For older Laravel versions just override showRegistrationForm() and register() methods inIf you're using Laravel 5.2 and you installed the auth related functionality with php artisan make:auth then your app/Http/routes.php file will include all auth-related routes by simply calling Route::auth(). The auth() method can be found in vendor/laravel/framework/src/Illuminate/Routing/Router.php. So if you want to do as some people suggest here and disable registration by removing unwanted routes (probably a good idea) then you have to copy the routes you still want from the auth() method and put them in app/Http/routes.php (replacing the call to Route::auth()). So for instance:If you're using lower version than 5.2 then it's probably different, I remember things changed quite a bit since 5.0, at some point artisan make:auth was even removed IIRC.This might be new in 5.7, but there is now an options array to the auth method. Simply changingtoin your routes file after running php artisan make:auth will disable user registration.For Laravel 5.3 and 5.4, here is the proper way to do it:You have to change:toin app/Http/Controller/Auth/RegisterController.phpAs of Laravel 5.7 you can pass an array of options to Auth::routes(). You can then disable the register routes with:You can see how this works from the source code: src/Illuminate/Routing/Router.php.In laravel 5.3 don't have AuthController.

to disable register route you should change in constructor of RegisterController like this:You can change form:to:Note: for use Redirect  don't forget to  user Redirect; 

So user access to https://host_name/register it's redirect to "/".When we use php artisan make:auth it's added Auth::route(); 

automatically.

Please Override Route in /routes/web.php.

You can change it's like this:

* you need to comment this line: Auth::routes();Thanks! I hope it's can solve your problems.Overwriting the getRegister and postRegister is tricky - if you are using git there is a high possibility that .gitignore is set to ignore framework files which will lead to the outcome that registration will still be possible in your production environment (if laravel is installed via composer for example)Another possibility is using routes.php and adding this line:This way the framework files are left alone and any request will still be redirected away from the Frameworks register module.The AuthController.php @limonte has overridden is in App\Http\Controllers\Auth, not in the vendor directory, so Git doesn't ignore this change.I have added this functions: and it works correctly.LAravel 5.6Heres my solution as of 5.4:Notice I've commented out Auth::routes() and the two registration routes.Important: you must also make sure you remove all instances of route('register') in your app.blade layout, or Laravel will throw an error.The following method works great:Copy all the routes from /vendor/laravel/framework/src/Illuminate/Routing/Router.php and paste it into web.php and comment out or delete Auth::routes().Then setup a conditional to enable and disable registration from .env.

Duplicate the 503.blade.php file in views/errors and create a 403 forbidden or whatever you like.Add ALLOW_USER_REGISTRATION= to .env and control user registration by setting its value to true or false.Now you have full control of routes and Vendor files remain untouched.web.phpThis is a combination of some previous answers notably Rafal G. and Daniel Centore. On laravel 5.6 and above you can edit in web.php file and you can make it true if you change your mind, i see it easy this way In routes.php, just add the following:Then you can selectively control whether registration is allowed or not in you .env file.I had to use:Using Redirect::to() gave me an error:You can find all routes which are registered through Auth::routes() in the class \Illuminate\Routing\Router in the method auth()it looks like this:Just copy the routes that you want/need and you are fine!In laravel 5.3, you should override the default showRegistrationForm() by including the code below into the RegisterController.php file in app\Http\Controllers\Authsince you don't want to allow registration, it's better to just throw 404 error so the intruder knows he is lost. And when you are ready for registraation in your app, uncomment //return view('auth.register'); then comment abort(404);\\\\\\\\\\\\\\\\\\\\JUST AN FYI///////////////////////////////If you need to use multiple authentication like create auth for users, members, students, admin, etc. then i advise you checkout this hesto/multi-auth its an awesome package for unlimited auths in L5 apps.You can read more abouth the Auth methodology and its associated file in this writeup.In Laravel 5.5I was trying to accomplish the same problem in Laravel 5.5. Instead of using Auth::routes() in the web.php routes file, I only included the login/logout routes:This has been mentioned in earlier comments but I would like to clarify that there are multiple ways to access the auth routes in your web.php file in Laravel ^5.7. depending on your version it might look a little different but they achieve the same result.First optionSecond optionIn order not too change the code as it is, just create a middleware to detect if the request url is url('register'), then redirect to 404 or do wherever.In Laravel 5.5Working on a similar issue and setting the middleware argument from guest to 'auth' seemed like a more elegant solution. Edit File: app->http->Controllers->Auth->RegisterController.phpI could be wrong though...but it seems more slick than editing the routing with more lines and less shity than simply redirecting the page...at least in this instance, wanting to lock down the registration for guests.I guess this would rather be a better solution.Override the following methods as below mentioned in App\Http\Controller\Auth\RegisterController.phpIn Laravel 5.5 is very simple, if you are using CRUD route system.Go to app/http/controllers/RegisterController  there is namespace: Illuminate\Foundation\Auth\RegistersUserYou need to go to the RegistersUser: Illuminate\Foundation\Auth\RegistersUserThere is the method call showRegistrationForm change this: return view('auth.login'); for this: return redirect()->route('auth.login'); and remove from you blade page route call register. It may look like that:I found this to be the easiest solution in laravel 5.6! It redirects anyone who tries to go to yoursite.com/register to yoursite.comroutes/web.phpAll I did was replace register blade code with login blade code. That way register still goes to login.resources/views/auth/register.blade.php is replaced with resources/views/auth/login.blade.phpFor Laravel 5.6+, paste the below methods in app\Http\Controller\Auth\RegisterControllerNow you're overriding those methods in RegistersUser trait, whenever you change your mind remove these methods. You may also comment the register links in welcome.blade.php and login.blade.php views.addat the top of the file

Laravel Eloquent Sum of relation's column

theAdmiral

[Laravel Eloquent Sum of relation's column](https://stackoverflow.com/questions/21679678/laravel-eloquent-sum-of-relations-column)

I've been working on a shoppingcart application and now I've come to the following issue..There is a User, a Product and a Cart object.

 - The Cart table only contains the following columns: "id", "user_id", "product_id" and timestamps.

 - The UserModel "hasMany" Carts (because a user can store multiple products).

 - The CartModel "belongsTo" a User and CartModel "hasMany" Products.  Now to calculate the total products I can just call: Auth::user()->cart()->count().  My question is: How can I get the SUM() of prices (a column of product) of the products in cart by this User?

I would like to accomplish this with Eloquent and not by using a query (mainly because I believe it is a lot cleaner).

2014-02-10 14:20:58Z

I've been working on a shoppingcart application and now I've come to the following issue..There is a User, a Product and a Cart object.

 - The Cart table only contains the following columns: "id", "user_id", "product_id" and timestamps.

 - The UserModel "hasMany" Carts (because a user can store multiple products).

 - The CartModel "belongsTo" a User and CartModel "hasMany" Products.  Now to calculate the total products I can just call: Auth::user()->cart()->count().  My question is: How can I get the SUM() of prices (a column of product) of the products in cart by this User?

I would like to accomplish this with Eloquent and not by using a query (mainly because I believe it is a lot cleaner).The documentation is a little light for some of the Collection methods but all the query builder aggregates are seemingly available besides avg() that can be found at http://laravel.com/docs/queries#aggregates.this is not your answer but is for those come here searching solution for another problem. 

I wanted to get sum of a column of related table conditionally. 

In my database Deals has many Activities 

I wanted to get the sum of the "amount_total" from Activities table where activities.deal_id = deal.id and activities.status = paid

so i did this. it returnsin Deals attribute.This it now the sum  which i wanted to get not the count. I tried doing something similar, which took me a lot of time before I could figure out the collect() function. So you can have something this way:collect($items)->sum('amount'); This will give you the sum total of all the items.Also using query builderTo get summation of all rate value inside table rates.To get summation of user products.

Laravel Schema onDelete set null

M K

[Laravel Schema onDelete set null](https://stackoverflow.com/questions/20869072/laravel-schema-ondelete-set-null)

Can't figure out how to set proper onDelete constraint on a table in Laravel. (I'm working with SqLite)I have 3 migrations, creating the gallery table:Creating the pictures table:Linking gallery table to a picture:I do not receive any errors. Also, even the "cascade" option doesn't work (only on the gallery table). Deleting a gallery deletes all pictures. But deleting the cover picture, wont delete the gallery (for test purposes).Since even the "cascade" is not triggered, I "set null" is not the problem.EDIT (workaround):After reading this article I've changed my schema a bit. Now, the pictures table contains an "is_cover" cell, that indicates whether this picture is a cover on its album or not. A solution to the original problem is still highly appreciated! 

2014-01-01 13:23:42Z

Can't figure out how to set proper onDelete constraint on a table in Laravel. (I'm working with SqLite)I have 3 migrations, creating the gallery table:Creating the pictures table:Linking gallery table to a picture:I do not receive any errors. Also, even the "cascade" option doesn't work (only on the gallery table). Deleting a gallery deletes all pictures. But deleting the cover picture, wont delete the gallery (for test purposes).Since even the "cascade" is not triggered, I "set null" is not the problem.EDIT (workaround):After reading this article I've changed my schema a bit. Now, the pictures table contains an "is_cover" cell, that indicates whether this picture is a cover on its album or not. A solution to the original problem is still highly appreciated! If you want to set null on delete: First make sure you set the foreign key field as nullable:According tohttp://dev.mysql.com/doc/refman/5.6/en/innodb-foreign-key-constraints.html$table->onDelete('set null') should work prehaps tryIf there are any errors, would also be helpfulUsing Laravel 4.2 on MySQL 5.5 with InnoDB, onDelete('set null') works.

Can I Install Laravel without using Composer?

ryanwinchester

[Can I Install Laravel without using Composer?](https://stackoverflow.com/questions/15940140/can-i-install-laravel-without-using-composer)

I'd like to know if I can install or use the Laravel PHP framework on any web server without using Composer (PHP package/dependency manager) every time?I would like to be able to drop my app on to any web server (like a shared server without access to the command line).If I run composer install the first time (locally), then all the dependencies should be present, correct?Then, I should be able to drop it onto any server with all of the files (including the vendor directory)?

2013-04-11 03:18:56Z

I'd like to know if I can install or use the Laravel PHP framework on any web server without using Composer (PHP package/dependency manager) every time?I would like to be able to drop my app on to any web server (like a shared server without access to the command line).If I run composer install the first time (locally), then all the dependencies should be present, correct?Then, I should be able to drop it onto any server with all of the files (including the vendor directory)?If you really wanted to, you could do all the work that Composer does manually, but you definitely should not. Installing Composer is easy, it's just a matter of getting the composer.phar file and running commands on it.You do not need to run Composer on your server as well as locally, once you run composer install or composer update your project will have all its dependencies available and you can just upload it straight to your server.You cannot install laravel local without composer in your project.On this site you can download everything what you can download also with the composer build tool. But you do not need a composer installation. Of course laravel is also present there: https://php-download.com/package/laravel/laravelIf you have shared server and you are not able to install composer and run cmd to install a new package or update an existing package. You can one thing by installing composer on your local machine and install(ex composer require package/name) or update(ex composer update package/name) all the packages, then upload your vendor directory on the server with your code. it will work for you same as in your local environment.NOTE: I strongly recommend that you should use the Laravel with the composer, it is an important part of laravel and you can try to convince your client to provide a server that supports laravel. Please check the link below and you can find the server requirements. https://laravel.com/docs/5.5#installationIf you don't want to use composer on server then you will have to run composer install/update and download all the libraries locally and then manually upload all those files on the server i.e. Vendor Directory.In-Case of shared hosting where you can't connect to server with shh there you might have to do that but it will take lot of time to upload all the files on server so I would recommend that you should composer and then download the libraries through composer install/update.Yes, you can install all project dependencies via composer in your localhost first, and then transfer all the files via FTP to your actual website.Just download the zip file from github and upload to your htdoc and voilà it will work for you

How to query between two dates using Laravel and Eloquent?

wobsoriano

[How to query between two dates using Laravel and Eloquent?](https://stackoverflow.com/questions/33361628/how-to-query-between-two-dates-using-laravel-and-eloquent)

I'm trying to create a report page that shows reports from a specific date to a specific date. Here's my current code:What this does in plain SQL is select * from table where reservation_from = $now. I have this query here but I don't know how to convert it to eloquent query.How can I convert the code above to eloquent query? Thank you in advance.

2015-10-27 06:56:04Z

I'm trying to create a report page that shows reports from a specific date to a specific date. Here's my current code:What this does in plain SQL is select * from table where reservation_from = $now. I have this query here but I don't know how to convert it to eloquent query.How can I convert the code above to eloquent query? Thank you in advance.The whereBetween method verifies that a column's value is between

two values.In some cases you need to add date range dynamically. Based on @Anovative's comment you can do this:If you would like to add more condition then you can use orWhereBetween. If you would like to exclude a date interval then you can use whereNotBetween.Other useful where clauses: whereIn, whereNotIn, whereNull, whereNotNull, whereDate, whereMonth, whereDay, whereYear, whereTime, whereColumn, whereExists, whereRaw.Laravel docs about Where Clauses.Another option if your field is datetime instead of date (although it works for both cases):The following should work:If you want to check if current date exist in between two dates in db:

=>here the query will get the application list if employe's application from and to date is exist in todays date.Try this:    Since you are fetching based on a single column value you can simplify your query likewise:Retrieve based on condition: laravel docsHope this helped.If you need to have in when a datetime field should be like this.I know this might be an old question but I just found myself in a situation where I had to implement this feature in a Laravel 5.7 app. Below is what worked from me.You will also need to use CarbonAnd I have created the model scopeMore about scopes:Code:And in the controller, add the Carbon Library to top ORTo get the last 10 days record from nowTo get the last 30 days record from now

Laravel - Session store not set on request

mattrick

[Laravel - Session store not set on request](https://stackoverflow.com/questions/34449770/laravel-session-store-not-set-on-request)

I recently created a new Laravel project and was following along the guide on Authentication. When I visit either my login or register route, I get the following error:I haven't edited any core Laravel files, I've only created the views and added the routes to my routes.php fileI don't have much experience with Laravel, so please excuse my ignorance. I'm aware that there is another question asking this same thing, but neither of the answers seem to work for me. Thanks for reading!Edit:Here's my register.blade.php as requested.

2015-12-24 08:42:04Z

I recently created a new Laravel project and was following along the guide on Authentication. When I visit either my login or register route, I get the following error:I haven't edited any core Laravel files, I've only created the views and added the routes to my routes.php fileI don't have much experience with Laravel, so please excuse my ignorance. I'm aware that there is another question asking this same thing, but neither of the answers seem to work for me. Thanks for reading!Edit:Here's my register.blade.php as requested.You'll need to use the web middleware if you need session state, CSRF protection, and more.If adding your routes inside the web middleware doesn't work for any reason then try adding this to $middleware into Kernel.phpIn my case (using Laravel 5.3) adding only the following 2 middleware allowed me to access session data in my API routes:Whole declaration ($middlewareGroups in Kernel.php):If Cas Bloem's answer does not apply (i.e. you've definitely got the web middleware on the applicable route), you might want to check the order of middlewares in your HTTP Kernel.The default order in Kernel.php is this:Note that VerifyCsrfToken comes after StartSession. If you've got these in a different order, the dependency between them can also lead to the Session store not set on request. exception. A problem can be that you try to access you session inside of your controller's  __constructor() function.From Laravel 5.3+ this is not possible anymore because it is not intended to work anyway, as stated in the upgrade guide.For more background information also read Taylor his response.WorkaroundIf you still want to use this, you can dynamically create a middleware and run it in the constructor, as described in the upgrade guide:Laravel [5.4]My solution was to use global session helper:

session()Its functionality is a little bit harder than $request->session().writing:pushing:retrieving:In my case I added the following 4 lines to $middlewareGroups (in app/Http/Kernel.php):IMPORTANT: The 4 new lines must be added BEFORE 'throttle' and 'bindings'!Otherwise a "CSRF token not match" error will rise. I've struggled in this for several hours just to find the order is important.This allowed me to access session in my API. I also added VerifyCsrfToken as when cookies/sessions are involved, CSRF needs to be taken care of.in my case it was just to put 

return ; 

at the end of function where  i have set session If you are using CSRF enter 'before'=>'csrf'In your case

Route::get('auth/login', ['before'=>'csrf','uses' => 'Auth\AuthController@getLogin', 'as' => 'login']);For more details view Laravel 5 Documentation Security Protecting RoutesDo you can use ->stateless() before the ->redirect().

Then you dont need the session anymore.It's not on the laravel documentation, I have been an hour to achieve this:My session didn't persist until i used the "save" method...Laravel 5.3+  web middleware group is automatically applied to your routes/web.php file by the RouteServiceProvider. Unless you modify kernel $middlewareGroups array in an unsupported order, probably you are trying to inject requests as a regular dependency from the constructor.Use request asinstead of 

How to validate array in Laravel?

Darama

[How to validate array in Laravel?](https://stackoverflow.com/questions/42258185/how-to-validate-array-in-laravel)

I try to validate array POST in Laravel:I send empty POST and get this if ($validator->fails()) {} as False. It means that validation is true, but it is not.How to validate array in Laravel? When I submit form with input name="name[]"

2017-02-15 19:15:03Z

I try to validate array POST in Laravel:I send empty POST and get this if ($validator->fails()) {} as False. It means that validation is true, but it is not.How to validate array in Laravel? When I submit form with input name="name[]"Asterisk symbol (*) means that you want to check VALUES in the array, not the actual array.In the example above:EDIT: Since Laravel 5.5 you can call validate() method directly on Request object like so:I have this array as my request data from a HTML+Vue.js data grid/table:And use this to validate which works properly:The recommended way to write validation and authorization logic is to put that logic in separate request classes. This way your controller code will remain clean.You can create a request class by executing php artisan make:request SomeRequest.In each request class's rules() method define your validation rules:In your controller write your route function like this:Each request class comes with pre- and post-validation hooks/methods which can be customized based on business logic and special cases in order to modify the normal behavior of request class.You may create parent request classes for similar types of requests (e.g. web and api) requests and then encapsulate some common request logic in these parent classes.You have to loop over the input array and add rules for each input as described here: Loop Over RulesHere is a some code for ya:Little bit more complex data, mix of @Laran's and @Nisal Gunawardana's answersThe validation rule will be

How Can I Remove「public/index.php」in the URL Generated Laravel?

TuGordoBello

[How Can I Remove「public/index.php」in the URL Generated Laravel?](https://stackoverflow.com/questions/23837933/how-can-i-remove-public-index-php-in-the-url-generated-laravel)

I need to remove  index.php or public/index.php from the generated URL in Laravel; commonly path is localhost/public/index.php/someWordForRoute, It should be something like localhost/someWordForRoute..htaccessapp/config/app.phpHow can I change that?

2014-05-23 20:33:00Z

I need to remove  index.php or public/index.php from the generated URL in Laravel; commonly path is localhost/public/index.php/someWordForRoute, It should be something like localhost/someWordForRoute..htaccessapp/config/app.phpHow can I change that?If it isn't already there, create an .htaccess file in the Laravel root directory.

Create a .htaccess file your Laravel root directory if it does not exists already. (Normally it is under your public_html folder)Edit the .htaccess file so that it contains the following code:Now you should be able to access the website without the "/public/index.php/" part.Make a new folder in your root directory and move all the files and folder except public folder. You can call it anything you want. I'll use "laravel_code".Next, move everything out of the public directory and into the root folder. It should result in something somewhat similar to this:

After that, all we have to do is edit the locations in the laravel_code/bootstrap/paths.php file and the index.php file.In laravel_code/bootstrap/paths.php find the following line of code:And change them to:In index.php, find these lines:And change them to:Source: How to remove /public/ from URL in LaravelI tried this on Laravel 4.2Rename the server.php in the your Laravel root folder to index.php and copy the .htaccess file from /public directory to your Laravel root folder.I hope it worksDon't get confused with other option the snippet below I am using and will be useful for you too.

Put the below htacces in your root.Go to your public directory and put another htaccess file with the code snippet belowIts working... !!!Laravel Uses below .htaccessHERE ARE SIMPLE STEPS TO REMOVE PUBLIC IN URL (Laravel 5)1: Copy all files form public folder and past them in laravel root folder2: Open index.php and  change FromToAnd ToIn laravel 4  path 2 is $app = require_once __DIR__.'/bootstrap/start.php'; instead of $app = require_once __DIR__.'/bootstrap/app.php';/app.phpThat is it.1) Check whether mod_rewrite is enabled. Go to /etc/apache2/mods-enabled directory and see whether the rewrite.load is available. If not, enable it using the command sudo a2enmod rewrite.It will enable the rewrite module. If its already enabled, it will show the message Module rewrite already enabled.

2)Create a virtual host for public directory so that instead of giving http://localhost/public/index.php we will be able to use like that http://example.com/index.php. [hence public folder name will be hidded]

3)Then create a .htaccess which will hide the index.php from your url which shoul be inside the root directory (public folder)This likely has very little to do with Laravel and everything to do with your Apache configs.Do you have access to your Apache server config? If so, check this out, from the docs:The reason why I mention this first is because it is best to get rid of .htaccess completely if you can,and use a Directory tag inside a VirtualHost tag. That being said, the rest of this is going to assume you are sticking with the .htaccess route for whatever reason.To break this down, a couple things could be happening:Hope this helps. I've named some of the most common issues but there are several others that could be more mundane or unique. Another suggestion on a dev server? Re-install Apache. If possible, do so from a different source with a good tutorial.For Laravel 4 & 5:   That's it !! :)Laravel ships with a pretty URL .htaccess already... you should be good to go out of the box...

http://laravel.com/docs/installation#pretty-urlsMake sure mod_rewrite is enabled and that your home path is set to the public directory of your application.You have to perform following steps to do this, which are as followsAlso make sure the Rewrite Engline is turned on after editing the .htaccess fileuse this in .htaccess and restart the serverHope this helps like it did for me.I just installed Laravel 5 for a project and there is a file in the root called server.php. Change it to index.php and it works or type in terminal:Rename the server.php in the your Laravel root folder to index.php and copy the .htaccess file from /public directory to your Laravel root folder.It Works and Its 100%  SECUREhttps://medium.com/@matteovirgilio/laravel-5-how-to-change-the-public-folder-and-secure-private-files-on-shared-hosting-a8e2e5b9b25fIf you use IIS Windows Server add web.config file in root folder and put the below code  : and if you use .htaccess  use this one : As per Laravel 5.3 the above things will not work properly, but please be calm and follow below steps:Step 1. Go to inside of laravel project

Step 2. Make one random directory/folder eg. laravelcode

Step 3. Move all the folder and files(Except public folder)

Step 4. Move all the folder and files which are inside the public folder to the laravel project

Step 5. Now inside the laravel project there is index.php file, please open that and change the folder paths for bootstrap as per new path like previously it was "require DIR.'/../bootstrap/autoload.php';" now it will become to "require DIR.'/laravelcode/bootstrap/autoload.php';"That's it just run your url without public and index.php like below

http://localhost/blog/

Laravel csrf token mismatch for ajax POST Request

Ashish Singh

[Laravel csrf token mismatch for ajax POST Request](https://stackoverflow.com/questions/32738763/laravel-csrf-token-mismatch-for-ajax-post-request)

I am trying to delete data from database via ajax.HTML:My ajax code:This is my query to fetch data from database...But when i click on Delete link data not deleted and show csrf_token mismatch...

2015-09-23 11:47:59Z

I am trying to delete data from database via ajax.HTML:My ajax code:This is my query to fetch data from database...But when i click on Delete link data not deleted and show csrf_token mismatch...You have to add data in your ajax request. I hope so it will be work.The best way to solve this problem "X-CSRF-TOKEN" is to add the following code to your main layout, and continue making your ajax calls normally:In headerIn scriptI think is better put the token in the form, and get this token by idAnd the JQUery : this way, your JS don't need to be in your blade files.I just added headers: in ajax call:in view:ajax function: in controller:in routes.phpIf you are using template files, than you can put your meta tag in the head section (or whatever you name it) which contain your meta tags.Next thing, you need to put the headers attribute to your ajax(in my example, I am using datatable with server-side processing:Here is the full datatable ajax example:After doing this, you should get 200 status for your ajax request.Know that there is an X-XSRF-TOKEN cookie that is set for convenience. Framework like Angular and others set it by default. Check this in the doc https://laravel.com/docs/5.7/csrf#csrf-x-xsrf-token

You may like to use it.The best way is to use the meta, case the cookies are deactivated.Here the recommended meta way (you can put the field any way, but meta is quiet nice):Note the use of decodeURIComponent(), it's decode from uri format which is used to store the cookie. [otherwise you will get an invalid payload exception in laravel].Here the section about the csrf cookie in the doc to check :

https://laravel.com/docs/5.7/csrf#csrf-x-csrf-tokenAlso here how laravel (bootstrap.js) is setting it for axios by default:you can go check resources/js/bootstrap.js.And here read cookie function:if you are using jQuery to send AJAX Posts, add this code to all views:Laravel adds a XSRF cookie to all requests, and we automatically append it to all AJAX requests just before submit.You may replace getCookie function if there is another function or jQuery plugin to do the same thing.Add an id to the meta element that holds the tokenAnd then you can get it in your JavascriptFor Laravel 5.8, setting the csrf meta tag for your layout and setting the request header for csrf in ajax settings won't work if you are using ajax to submit a form that already includes a _token input field generated by the Laravel blade templating engine. You must include the already generated csrf token from the form with your ajax request because the server would be expecting it and not the one in your meta tag. For instance, this is how the _token input field generated by Blade looks like:You then submit your form with ajax like this:The csrf token in the meta header is only useful when you are submitting a form without a Blade generated _token input field.I actually had this error and could not find a solution. I actually ended up not doing an ajax request. I don't know if this issue was due to this being  sub domain on my server or what. Here's my jquery.So I actually set up an anchor to go to my API rather than doing a post request, which is what I figure most applications do.You should include a hidden CSRF (cross site request forgery) token field in the form so that the CSRF protection middleware can validate the request.Laravel automatically generates a CSRF "token" for each active user session managed by the application. This token is used to verify that the authenticated user is the one actually makin gthe requests to the application.So when doing ajax requests, you'll need to pass the csrf token via data parameter. Here's the sample code.

Laravel Request::all() Should Not Be Called Statically

Moose

[Laravel Request::all() Should Not Be Called Statically](https://stackoverflow.com/questions/28573860/laravel-requestall-should-not-be-called-statically)

In Laravel, I'm trying to call $input = Request::all(); on a store() method in my controller, but I'm getting the following error:Any help figuring out the best way to correct this? (I'm following a Laracast)

2015-02-18 00:31:44Z

In Laravel, I'm trying to call $input = Request::all(); on a store() method in my controller, but I'm getting the following error:Any help figuring out the best way to correct this? (I'm following a Laracast)The error message is due to the call not going through the Request facade.ChangeToand it should start working.In the config/app.php file, you can find a list of the class aliases.  There, you will see that the base class Request has been aliased to the Illuminate\Support\Facades\Request class.  Because of this, to use the Request facade in a namespaced file, you need to specify to use the base class: use Request;.Since this question seems to get some traffic, I wanted to update the answer a little bit since Laravel 5 was officially released.While the above is still technically correct and will work, the use Illuminate\Http\Request; statement is included in the new Controller template to help push developers in the direction of using dependency injection versus relying on the Facade.When injecting the Request object into the constructor (or methods, as available in Laravel 5), it is the Illuminate\Http\Request object that should be injected, and not the Request facade.So, instead of changing the Controller template to work with the Request facade, it is better recommended to work with the given Controller template and move towards using dependency injection (via constructor or methods).Example via methodExample via constructorInject the request object into the controller using Laravel's magic injection and then access the function non-statically. Laravel will automatically inject concrete dependencies into autoloaded classesuse the request() helper instead. You don't have to worry about use statements and thus this sort of problem wont happen again.simpleThe facade is another Request class, access it with the full path:From laravel 5 you can also access it through the request() function:I thought it would be useful for future visitors to provide a bit of an explanation on what is happening here.Laravel's Illuminate\Http\Request class has a method named all (in fact the all method is defined in a trait that the Request class uses, called Illuminate\Http\Concerns\InteractsWithInput). The signature of the all method at the time of writing looks like this:This method is not defined as static and so when you try to call the method in a static context, i.e. Illuminate\Http\Request::all() you will get the error displayed in OP's question. The all method is an instance method and deals with information that is present in an instance of the Request class, so calling it in this way makes no sense.A facade in Laravel provides developers with a convenient way of accessing objects in the IoC container, and calling methods on those objects. A developer can call a method "statically" on a facade like Request::all(), but the actual method call on the real Illuminate\Http\Request object is not static.A facade works like a proxy - it refers to an object in the IoC container and passes the static method call onto that object (non-statically). For instance, take the Illuminate\Support\Facades\Request facade, this is what it looks like:Under the hood, the base Illuminate\Support\Facades\Facade class uses some PHP magic, namely the __callStatic method to:This is why, as @patricus pointed out in his answer above, by changing the use/import statement to refer to the facade, the error is no longer there, because as far as PHP is concerned, all has been correctly called on an instance of Illuminate\Http\Request.Aliasing is another feature that Laravel provides for convenience. It works by effectively creating alias classes that point to facades in the root namespace. If you take a look at your config/app.php file, under the aliases key, you will find a long list of mappings of strings to facade classes. For example:Laravel creates these alias classes for you, based on your configuration and this allows you to utilise classes available in the root namespace (as referred to by the string keys of the aliases config) as if you're using the facade itself:While facades and aliasing are still provided in Laravel, it is possible and usually encouraged to go down the dependency injection route. For example, using constructor injection to achieve the same result:There are a number of benefits to this approach but in my personal opinion the greatest pro for dependency injection is that it makes your code way easier to test. By declaring the dependencies of your classes as constructor or method arguments, it becomes very easy to mock out those dependencies and unit test your class in isolation.is same in context sayingalso it happens when you import following library to api.php file.

this happens by some IDE's suggestion to import it for not finding the Route Class.just remove it and everything going to work fine.update:seems if you add this library it wont lead to errorI was facing this problem even with use Illuminate\Http\Request; line at the top of my controller. Kept pulling my hair till I realized that I was doing $request::ip() instead of $request->ip(). Can happen to you if you didn't sleep all night and are looking at the code at 6am with half-opened eyes.Hope this helps someone down the road.i make it work with a scope definitionpublic function pagar(\Illuminate\Http\Request $request)

    {

        //

Installing specific laravel version with composer create-project

user1995781

[Installing specific laravel version with composer create-project](https://stackoverflow.com/questions/23754260/installing-specific-laravel-version-with-composer-create-project)

The fastest and simplest way of installing Laravel is via composer command. From the laravel docs (http://laravel.com/docs/quick), it shows that we can install it with this:But, when you run the above command, it will grab the latest version of Laravel. How can I control it if I want to install latest version of 4.0.x? Or, 4.1.x when 4.2 is out?

2014-05-20 08:08:30Z

The fastest and simplest way of installing Laravel is via composer command. From the laravel docs (http://laravel.com/docs/quick), it shows that we can install it with this:But, when you run the above command, it will grab the latest version of Laravel. How can I control it if I want to install latest version of 4.0.x? Or, 4.1.x when 4.2 is out?From the composer help create-project commandThis command works:This works with the * notation.Have a look:Laravel 4.2 DocumentationSyntax (Via Composer):Example:Where 4.2 is your version of laravel.Note: It will take the latest version of Laravel automatically If you will not provide any version.Try via Composer Create-ProjectYou may also install Laravel by issuing the Composer create-project command in your terminal:And then you probably need to install all of vendor packages, soTo install specific version of laravel try this & simply command on terminal If you want to use a stable version of your preferred Laravel version of choice, use:That will pick out the most recent or best update of version 5.5.* (5.5.28)

Laravel: Where to store global arrays data and constants?

Marco Madueño Mejía

[Laravel: Where to store global arrays data and constants?](https://stackoverflow.com/questions/26854030/laravel-where-to-store-global-arrays-data-and-constants)

I just started working with Laravel. I need to rewrite a whole system I made some years ago, using Laravel 4 as base framework. In my old system, I used to have a constant.php file with some constants declared, and a globals.php file which contained lots of array sets (for example, categories statuses, type of events, langs, etc.). By doing so, I could use something likeanywhere in my app.My question is, how can I store that info in the so called "laravel way". I tried using some sort of object to store this info, setting this as a service and creating for it a facade:app/libraries/Project/Constants.phpapp/libraries/Project/ConstantsServiceProvider.phpapp/libraries/Project/ConstantsFacade.phpcomposer.jsonand so I access that property as PJ\Constants::$langs.This works, but I doubt it is the most efficient or correct way of doing it. I mean, is it the right way to "propagate" a variable by creating a whole Service Provider and facades and all such stuff? Or where should I put this data?Thanks for any advice.EDIT # 01Data I want to pass to all controllers and views can be directly set in script, like in the example at the beginning of my post, but it can also be generated dynamically, from a database for example. This data could be a list of categories. I need them in all views to generate a navigation bar, but I also need them to define some routing patterns (like /category/subcategory/product), and also to parse some info in several controllers (Like get info from the category that holds X product). My array is something  like:Just as an example. Index is the id of the category, and the Value is info associated with the category.I need this array, also, available in all Controllers and Views. So, should I save it as a Config variable? How else could I store these data; what would be the best and semantically correct way?

2014-11-10 22:16:05Z

I just started working with Laravel. I need to rewrite a whole system I made some years ago, using Laravel 4 as base framework. In my old system, I used to have a constant.php file with some constants declared, and a globals.php file which contained lots of array sets (for example, categories statuses, type of events, langs, etc.). By doing so, I could use something likeanywhere in my app.My question is, how can I store that info in the so called "laravel way". I tried using some sort of object to store this info, setting this as a service and creating for it a facade:app/libraries/Project/Constants.phpapp/libraries/Project/ConstantsServiceProvider.phpapp/libraries/Project/ConstantsFacade.phpcomposer.jsonand so I access that property as PJ\Constants::$langs.This works, but I doubt it is the most efficient or correct way of doing it. I mean, is it the right way to "propagate" a variable by creating a whole Service Provider and facades and all such stuff? Or where should I put this data?Thanks for any advice.EDIT # 01Data I want to pass to all controllers and views can be directly set in script, like in the example at the beginning of my post, but it can also be generated dynamically, from a database for example. This data could be a list of categories. I need them in all views to generate a navigation bar, but I also need them to define some routing patterns (like /category/subcategory/product), and also to parse some info in several controllers (Like get info from the category that holds X product). My array is something  like:Just as an example. Index is the id of the category, and the Value is info associated with the category.I need this array, also, available in all Controllers and Views. So, should I save it as a Config variable? How else could I store these data; what would be the best and semantically correct way?For most constants used globally across the application, storing them in config files is sufficient. It is also pretty simpleCreate a new file in the app/config directory. Let's call it constants.phpIn there you have to return an array of config values.And you can access them as followsAnd you can set them as wellNote that the values you set will not persist. They are only available for the current request.The config is probably not the right place to store information generated from the database. You could just use an Eloquent Model like:And query all categoriesIf the whole Model thing for some reason isn't working out you can start thinking about creating your own class and a facade. Or you could just create a class with all static variables and methods and then use it without the facade stuff.For ConstantsCreate constants.php file in the config directory:-You can use them like:-For Static ArraysCreate static_arrays.php file in the config directory:-You can use it like:-Note: Laravel includes all config files automatically, so no need of manual include :)app/constants.phpcomposer.json

add file location at autoload in composer.json Before this change can take effect, you must run the following command in Terminal to regenerate Laravel’s autoload files:For global constants in Laravel 5, I don't like calling Config for them. I define them in Route group like this:Just to add to the above answer you will have to include the config class before you could start using it in Laravel 5.3I think the best way is to use localization.Create a new file messages.php in resources/lang/en (en because that is what is set in my config/app 'locale'=>'en') 

return an array of all your values  to retrieve for laravel 5.3 and beloworfor 5.4 uselaravel 5.0 localizationorlaravel 5.4 localizationAtleast in Laravel 5.4, in your constructor you can create them;Then you can call them like this in your methods;Especially useful for static methods in the Model, etc... Reference on Laracasts.com https://laracasts.com/discuss/channels/general-discussion/class-apphttpcontrollersconfig-not-found

Switch in Laravel 5 - Blade

ventaquil

[Switch in Laravel 5 - Blade](https://stackoverflow.com/questions/29897508/switch-in-laravel-5-blade)

How can I use switch in blade templates? When I used:in result I see this text as plaintext. I prefer to use switch in few piece of code because it's more clean for me than when I using if.But if it's not possible just write it.

2015-04-27 13:42:58Z

How can I use switch in blade templates? When I used:in result I see this text as plaintext. I prefer to use switch in few piece of code because it's more clean for me than when I using if.But if it's not possible just write it.Updated 2020 AnswerSince Laravel 5.5 the @switch is built into the Blade. Use it as shown below.Older AnswerUnfortunately Laravel Blade does not have switch statement. You can use Laravel if else approach or use use plain PHP switch. You can use plain PHP in blade templates like in any other PHP application. Starting from Laravel 5.2 and up use @php statement.Option 1:You can just add these code in AppServiceProvider class boot method.then you can use as:Enjoy It~IN LARAVEL 5.2 AND UP:Write your usual code between the opening and closing PHP statements.In Laravel 5.1, this works in a Blade:This is now built in Laravel 5.5 

https://laravel.com/docs/5.5/blade#switch-statementsYou can extend blade like so:You can then use the following:However do note the warnings in : http://php.net/manual/en/control-structures.alternative-syntax.phpIf there is any whitespace between the switch(): and the first case then the whole code block will fail. That is a PHP limitation rather than a blade limitation. You may be able to bypass it by forcing the normal syntax e.g.:But this feels a bit wrong. To overcome the space in 'switch ()', you can use code :When you start using switch statements within your views, that usually indicate that you can further re-factor your code. Business logic is not meant for views, I would rather suggest you to do the switch statement within your controller and then pass the switch statements outcome to the view. 

Dropping column with foreign key Laravel error: General error: 1025 Error on rename

Latheesan

[Dropping column with foreign key Laravel error: General error: 1025 Error on rename](https://stackoverflow.com/questions/27175808/dropping-column-with-foreign-key-laravel-error-general-error-1025-error-on-ren)

I've created a table using migration like this:I need to change this table and drop the foreign key reference & column pick_detail_id and add a new varchar column called sku after pick_id column.So, I've created another migration, which looks like this:When I run this migration, I get the following error:When I try to reverse this migration by running php artisan migrate:rollback command, I get a Rolled back message, but it's not actually doing anything in the database.Any idea what might be wrong? How do you drop a column that has a foreign key reference?

2014-11-27 17:03:42Z

I've created a table using migration like this:I need to change this table and drop the foreign key reference & column pick_detail_id and add a new varchar column called sku after pick_id column.So, I've created another migration, which looks like this:When I run this migration, I get the following error:When I try to reverse this migration by running php artisan migrate:rollback command, I get a Rolled back message, but it's not actually doing anything in the database.Any idea what might be wrong? How do you drop a column that has a foreign key reference?You can use this:If you take a peak at dropForeign source, it will build the foreign key index name for you if you pass the column name as an array.It turns out; when you create a foreign key like this:Laravel uniquely names the foreign key reference like this:Therefore, when you want to drop a column with foreign key reference, you have to do it like this:Laravel 4.2+ introduces a new naming convention:I had multiple foreign keys in my table and then I had to remove foreign key constraints one by one by passing column name as index of the array in down method:Using below statement does not workBecause dropForeign does not consider them seperate columns that we want to remove. So we have to drop them one by one.Pass an array with col nameThe key (for me) to solving this was to make sure that the $table->dropForeign() command was being passed the right relationship name, not necessarily the column name. You do not want to pass the column name, as would be much more intuitive IMHO.What worked for me was:So the string I passed to dropForeign() that worked for me was in the format of:[local table]_[foreign key field]_foreignIf you have access to a tool like Sequel Pro or Navicat, being able to visualize those will be very helpful.Something that occurred to me was that I didn't know where to put the Schema::table block. Later I discovered that the key is on the SQL error: So the Schema::table block needs to go in the down() function of the lu_benefits_categories migration and before the Schema::dropIfExists line:After that, the php artisan migrate:refresh or php artisan migrate:reset will do the trick.

Laravel back button

cosapostolo

[Laravel back button](https://stackoverflow.com/questions/12333739/laravel-back-button)

I am trying to create a simple back button on a page. The user can arrive to this page from two different pages so I would like to know from which page he arrived. Is that possible?

2012-09-08 19:21:20Z

I am trying to create a simple back button on a page. The user can arrive to this page from two different pages so I would like to know from which page he arrived. Is that possible?In Laravel, you can do something like this: <a href="{{Request::referrer()}}">Back</a> (assuming you're using blade).  In Laravel 4Laravel documentationI know this is an oldish question but I found it whilst looking for the same solution. The solution above doesn't appear to work in Laravel 4, you can however use this now:Hope this helps people who look for this feature in L4(Source: https://github.com/laravel/framework/pull/501/commits)Laravel 5.2+, back buttonThe following is a complete Blade (the templating engine Laravel uses) solution:The options array with the class is optional, in this case it specifies the styling for a Bootstrap 3 button.Indeed using {{ URL:previous() }} do work, but if you're using a same named route to display multiple views, it will take you back to the first endpoint of this route.In my case, I have a named route, which based on a parameter selected by the user, can render 3 different views. Of course, I have a default case for the first enter in this route, when the user doesn't selected any option yet.When I use URL:previous(), Laravel take me back to the default view, even if the user has selected some other option. Only using javascript inside the button I accomplished to be returned to the correct view:I'm tested this on Laravel 5.3, just for clarification.On 5.1 I could only get this to work.One of the below solve your problemotherYou can use javascript for this provblem. 

It's retrieve link from browser history.

Accessing Laravel .env variables in blade

Anna Jeanine

[Accessing Laravel .env variables in blade](https://stackoverflow.com/questions/43040967/accessing-laravel-env-variables-in-blade)

I am trying to get some API keys which I have stored in my .env file to use in the blade javascript. I have added two keys like:   In blade I need to use the Google Maps API and OverheidIO API key. I have tried getting one of the default .env variables just in case I have formatted the custom .env variables wrong.:Could someone help me call the google maps api and overheidio api key in the blade? 

2017-03-27 08:05:07Z

I am trying to get some API keys which I have stored in my .env file to use in the blade javascript. I have added two keys like:   In blade I need to use the Google Maps API and OverheidIO API key. I have tried getting one of the default .env variables just in case I have formatted the custom .env variables wrong.:Could someone help me call the google maps api and overheidio api key in the blade? Five most important commands if your Laravel is not working as expected after some modifications in .env or database folder or because of any other modifications.

Here is full explanation:

https://www.youtube.com/watch?v=Q1ynDMC8UGgI have it implemented in the following way:My recommendation is to execute the following command: composer self-updateIf you want to get the environment of the app then try this:I have not tried other variables.VERY IMPORTANTAll env() like: env('APP_ENV') calls WON'T WORK in production (when you use php artisan config:cache)What to use?

 - use env() only in config files

 - use App::environment() for checking the environment (APP_ENV in .env).

 - use config('app.var') for all other env variables, ex. config('app.debug')

 - create own config files for your own ENV variables. Example:

In your .env:example config app/myconfig.phpAccess in your code:More details see HEREIt causes problems to use env() anywhere else than in the config/ folder. Use env in there and then config () in the other parts of the appshould fix itThis command should be written after you edit .env file to access variables in easy way get values here: config/app.php

in blade:in class/controller:i was also having trouble getting value from .env file, then i did this and it helped :Here's a link to the documentation: https://laravel.com/docs/6.x/configuration#retrieving-environment-configurationIn the sample below, I spit out the actual error when I'm in my development environment but give a generic message if in any other environment.

Laravel: Error [PDOException]: Could not Find Driver in PostgreSQL

Hyperion

[Laravel: Error [PDOException]: Could not Find Driver in PostgreSQL](https://stackoverflow.com/questions/25329302/laravel-error-pdoexception-could-not-find-driver-in-postgresql)

I'm trying to connect with PostgreSQL database through Laravel in order to do a php artisan migrate but doesn't seem to be directed since it's reading the database name of MySQL. Here are the commands from database.php:If I remove the MySQL paths I'll get:The extension=pdo_pgsql.dll and extension=pgsql.dll are uncommented.Done the PATH trick in the 'System Variables' and rebooted. No chance. Thanks for the help so far.These are my drivers php_pdo_driver.h & php_pdo.h from C:\Program Files (x86)\PostgreSQL\EnterpriseDB-ApachePHP\php\SDK\include\ext\pdoInformation from phpinfo:

2014-08-15 15:28:37Z

I'm trying to connect with PostgreSQL database through Laravel in order to do a php artisan migrate but doesn't seem to be directed since it's reading the database name of MySQL. Here are the commands from database.php:If I remove the MySQL paths I'll get:The extension=pdo_pgsql.dll and extension=pgsql.dll are uncommented.Done the PATH trick in the 'System Variables' and rebooted. No chance. Thanks for the help so far.These are my drivers php_pdo_driver.h & php_pdo.h from C:\Program Files (x86)\PostgreSQL\EnterpriseDB-ApachePHP\php\SDK\include\ext\pdoInformation from phpinfo:Be sure to configure the 'default' key in app/config/database.phpFor postgres, this would be 'default' => 'postgres',If you are receiving a [PDOException] could not find driver error, check to see if you have the correct PHP extensions installed.  You need pdo_pgsql.so and pgsql.so installed and enabled.  Instructions on how to do this vary between operating systems.  For Windows, the pgsql extensions should come pre-downloaded with the official PHP distribution.  Just edit your php.ini and uncomment the lines extension=pdo_pgsql.so and extension=pgsql.soAlso, in php.ini, make sure extension_dir is set to the proper directory.  It should be a folder called extensions or ext or similar inside your PHP install directory.Finally, copy libpq.dll from C:\wamp\bin\php\php5.*\ into C:\wamp\bin\apache*\bin and restart all services through the WampServer interface.If you still get the exception, you may need to add the postgres \bin directory to your PATH:This should hopefully resolve any problems.  For more information see:For PDOException: could not find driver for MySQL, and if it is Debian based OS,For PHP 7 in Ubuntu you can also do:So, now you can do not uncomment lines in php.iniUPD:

I have a same error, so problem was not in driver.

I changed my database.ini, but every time I saw an error.

And I change database config in .env and errors gone.This worked for me:$ sudo apt-get install php-gd php-mysql

I realize this is an old question but I found it in a Google search so I'm going to go ahead and answer just in case someone else runs across this. I'm on a Mac and had the same issue, but solved it by using HomeBrew. Once you've got it installed, you can just run this command:And replace the 56 with whatever version of PHP you're using without the decimal point.I had the same issue. This is what worked for me.There are 2 php.ini files:NOTE: This is using my version of PHP and Apache, change to what yours are.The php.ini file located in the both folders is what you need to update, the extentions:These are what you need to uncomment (remove the ; symbol).Restart both Wamp and the Command Prompt.Hopefully it will work for you :).For those wanting to use Postgresql on OpenSuse (and co), try the following:Solved after 3 hours... 

I am using WAMP (PHP 7.2.4), PostgreSQL 10, Laravel 5.6.29. 

Loaded PHP extensions (pgsql, pdo_pgsql) from Wampserver 3.3, then I was able to connect to the PostgreSQL server with a simple php testcode from the www directory. But $ php artisan migrate still returned I checked the shell (git bash for windows) with $ php --ini, that returned C:\wamp64\bin\php\php7.2.4\php.ini instead of c:\wamp64\bin\apache\apache2.4.33\bin\php.ini, loaded by WAMP

So you have to uncomment pgsql and pdo_pgsql extensions also in C:\wamp64\bin\php\php7.2.4\php.ini, and then migrate will work ...In Windows 8 PC with Laragon 3.4.0 180809, I faced the same issue. It happened in my case because I updated Laragon and it added a new version of PHP. So in laragon/bin/php/ I actually had two directories:I added 7.1.20 into my PATH variable. But in my Command Console, running php --ini was showing that the path actually was fetching from the older one: php-7.1.7-Win32-VC14-x64. So I deleted the old one (for safety, I put it in Recycle Bin). But Laragon failed to start after that.So, in laragaon/etc/apache2/mod_php.conf, I changed the path to the latest PHP version. Then restarted Laragon and the issue is resolved. 😊Reference: How to add another PHP version - Laragon ForumI got this problem too. I have solved this issue already. If u are using Wamp then perform the following steps.If it does not work, please check your .env and config/database again.I had the same error on PHP 7.3.7 docker with laravel:This works for meThis will install the pgsql and pdo_pgsql drivers.Now run this command to uncomment the lines extension=pdo_pgsql.so and extension=pgsql.so from php.iniOld thread I know,  but I lost a couple of hours of my life with this.  You also need to set the DB info in the .env file.  You don't have to specify the driver here because the default specified in database.php is used (I think).  I was struggling because it had DB_CONNECTION=mysql in the .env file and I was using pgsql.In my case, I had two versions of PHP installed. So all I had to do was use$ /opt/lampp/bin/php artisan serve  instead of $ php artisan serve sudo apt-get -y install php*-mysql ( just run this command ) This worked for me:I am working with 32bit Ubuntu 14I see you are using Windows. I was not able to fix this with enabling any of the extensions that come with my Windows WAMP Server. I tried PDO_ODBC and others and even found the Microsoft Official PDO_SQLSRV. The solution for me was to install the PDO_SQLSRV drivers from a 3rd party website. I found the drivers through 

http://robsphp.blogspot.nl/2012/06/unofficial-microsoft-sql-server-driver.html I usually don't use DLLs from random websites, but I was desperate and this worked for me. Hoping it might save others numerous hours of frustration.Using Laravel V 5.5.39 with Php 7.1.12 is working fine, but later (newer) php versions cause the problem. So, change Php version and you will get the solution 100% .

Laravel: Using try…catch with DB::transaction()

enchance

[Laravel: Using try…catch with DB::transaction()](https://stackoverflow.com/questions/22906844/laravel-using-try-catch-with-dbtransaction)

We all use DB::transaction() for multiple insert queries. In doing so, should a try...catch be placed inside it or wrapping it? Is it even necessary to include a try...catch when a transaction will automatically fail if something goes wrong?Sample try...catch wrapping a transaction:The opposite, a DB::transaction() wrapping a try...catch:Or simply a transaction w/o a try...catch

2014-04-07 08:09:13Z

We all use DB::transaction() for multiple insert queries. In doing so, should a try...catch be placed inside it or wrapping it? Is it even necessary to include a try...catch when a transaction will automatically fail if something goes wrong?Sample try...catch wrapping a transaction:The opposite, a DB::transaction() wrapping a try...catch:Or simply a transaction w/o a try...catchIn the case you need to manually 'exit' a transaction through code (be it through an exception or simply checking an error state) you shouldn't use DB::transaction() but instead wrap your code in DB::beginTransaction and DB::commit/DB::rollback():See the transaction docs.If you use PHP7, use Throwable in catch for catching user exceptions and fatal errors.For example:If your code must be compartable with PHP5, use Exception and Throwable:You could wrapping the transaction over try..catch or even reverse them,

here my example code I used to in laravel 5,, if you look deep inside DB:transaction() in Illuminate\Database\Connection that the same like you write manual transaction.Laravel Transactionso you could write your code like this, and handle your exception like throw message back into your form via flash or redirect to another page. REMEMBER return inside closure is returned in transaction() so if you return redirect()->back() it won't redirect immediately, because the it returned at variable which handle the transaction.Wrap Transactionthen the alternative is throw boolean variable and handle redirect outside transaction function or if your need to retrieve why transaction failed you can get it from $e->getMessage() inside catch(Exception $e){...} I've decided to give an answer to this question because I think it can be solved using a simpler syntax than the convoluted try-catch block. The Laravel documentation is pretty brief on this subject.Instead of using try-catch, you can just use the DB::transaction(){...} wrapper like this:You should then see that the User and the Log record cannot exist without eachother.Some notes on the implementation above:Tested on Laravel 5.8

Laravel 5.2 - Use a String as a Custom Primary Key for Eloquent Table becomes 0

Abrar Jahin

[Laravel 5.2 - Use a String as a Custom Primary Key for Eloquent Table becomes 0](https://stackoverflow.com/questions/34582535/laravel-5-2-use-a-string-as-a-custom-primary-key-for-eloquent-table-becomes-0)

I am trying to use email as my table's primary key, so my eloquent code is-And my DB is like this-but if I do this-I am getting this-So, the verification token/primary key becomes 0.Can anyone please help?

2016-01-03 22:48:33Z

I am trying to use email as my table's primary key, so my eloquent code is-And my DB is like this-but if I do this-I am getting this-So, the verification token/primary key becomes 0.Can anyone please help?This was added to the upgrade documentation on Dec 29, 2015, so if you upgraded before then you probably missed it.When fetching any attribute from the model it checks if that column should be cast as an integer, string, etc.By default, for auto-incrementing tables, the ID is assumed to be an integer in this method:https://github.com/laravel/framework/blob/5.2/src/Illuminate/Database/Eloquent/Model.php#L2790So the solution is:On the model set $incrementing to falseThis will stop it from thinking it is an auto increment field.Laravel Docs - Eloquent - Defining ModelsTheres two properties on the model you need to set. The first $primaryKey to tell the model what column to expect the primary key on. The second $incrementing so it knows the primary key isn't a linear auto incrementing value.For more info see the Primary Keys section in the documentation on Eloquent.I was using Postman to test my Laravel API. I received an error that stated I had to enter public $timestamps = false; to my model. Then, I tested again with Postman and saw that an "id" = 0 variable was being created in my database. I finally had to add public $incrementing false; to fix my API.keep using the id and get the email :

Download files in laravel using Response::download

star18bit

[Download files in laravel using Response::download](https://stackoverflow.com/questions/20415444/download-files-in-laravel-using-responsedownload)

In Laravel application I'm trying to achieve a button inside view that can allow user to download file without navigating to any other view or route

Now I have two issues: 

(1) below function throwing (2) Download button should not navigate user to anywhere and rather just download files on a same view, My current settings, routing a view to '/download'Here is how Im trying to achieve: Button:Route :Controller :

2013-12-06 03:33:22Z

In Laravel application I'm trying to achieve a button inside view that can allow user to download file without navigating to any other view or route

Now I have two issues: 

(1) below function throwing (2) Download button should not navigate user to anywhere and rather just download files on a same view, My current settings, routing a view to '/download'Here is how Im trying to achieve: Button:Route :Controller :Try this."./download/info.pdf"will not work as you have to give full physical path.Update 20/05/2016Laravel 5, 5.1, 5.2 or 5.* users can use the following method instead of Response facade. However, my previous answer will work for both Laravel 4 or 5. (the $header array structure change to associative array =>- the colon after 'Content-Type' was deleted - if we don't do those changes then headers will be added in wrong way: the name of header wil be number started from 0,1,...)File downloads are super simple in Laravel 5.As @Ashwani mentioned Laravel 5 allows file downloads with response()->download() to return file for download. We no longer need to mess with any headers. To return a file we simply:from within the controller.Reusable Download Route/ControllerNow let's make a reusable file download route and controller so we can server up any file in our public/files directory.Create the controller:Create the route in app/Http/routes.php:Make download method in app/Http/Controllers/DownloadsController:Now simply drops some files in the public/files directory and you can server them up by linking to /download/filename.ext:If you pulled in Laravel Collective's Html package you can use the Html facade:In the accepted answer, for Laravel 4 the headers array is constructed incorrectly. Use:Quite a few of these solutions suggest referencing the public_path() of the Laravel application in order to locate the file. Sometimes you'll want to control access to the file or offer real-time monitoring of the file. In this case, you'll want to keep the directory private and limit access by a method in a controller class. The following method should help with this:There are other paths that you could use as well, described on

Laravel's helper functions documentationWhile using laravel 5 use this code as you don`t need headers.return response()->download($pathToFile); .If you are using Fileentry you can use below function for downloading.// Try this to download any file. laravel 5.*// you need to use facade "use Illuminate\Http\Response;" I think that you can use With this you be sure that is a pdf.This is html part  This is Route :This is function : If you want to use the JavaScript download functionality then you can also doAlso remember to paste the info.pdf file in your public directory of your projectyou can use simply inside your controller:

return response()->download($filePath);

Happy coding :)

Laravel - Pass more than one variable to view

pjmil

[Laravel - Pass more than one variable to view](https://stackoverflow.com/questions/20110757/laravel-pass-more-than-one-variable-to-view)

I have this site and one of its pages creates a simple list of people from the database. I need to add one specific person to a variable I can access.How do I modify the return $view->with('persons', $persons); line to also pass the $ms variable to the view? 

2013-11-21 01:31:00Z

I have this site and one of its pages creates a simple list of people from the database. I need to add one specific person to a variable I can access.How do I modify the return $view->with('persons', $persons); line to also pass the $ms variable to the view? Just pass it as an array:Or chain them, like @Antonio mentioned.This is how you do it:You can also use compact():Or do it in one line:Or even send it as an array:But, in this case, you would have to access them this way:Passing multiple variables to a Laravel viewRead here about Passing Data to Views in LaravelCame across a similar problem, but if you do not necessarily want to return a view with view file, you can do this:This Answer seems to be bit helpful while declaring the large numbe of variable in the function Laravel 5.7.*For Example When you see the last line of the returns it not looking goodSo As You see all the variables as declared as array of $viewShareVars and Accessed in Viewthe native php function get_defined_vars() get all the defined variables from the function and array_keys will grab the variable namesso in your view you can access all the declared variable inside the functionas {{$todayPostActive}}Please try this,For passing multiple array data from controller to view, try it. It is working. In this example, I am passing subject details from a table and subject details contain category id, the details like name if category id is fetched from another table category.Its simple :)

change the date format in laravel view page

user3386779

[change the date format in laravel view page](https://stackoverflow.com/questions/40038521/change-the-date-format-in-laravel-view-page)

I want to change the date format which is fetched from database.

now I got  2016-10-01{{$user->from_date}} .I want to change the format 'd-m-y' in laravel 5.3

2016-10-14 08:29:28Z

I want to change the date format which is fetched from database.

now I got  2016-10-01{{$user->from_date}} .I want to change the format 'd-m-y' in laravel 5.3Try this:It will convert date into d-m-Y format.Note: This solution is a general solution that works for php and any of its frameworks. For a Laravel specific method, try the solution provided by Hamelraj.In Laravel use Carbon its good In your Model set:after in your view :worksYou can check Date Mutators: https://laravel.com/docs/5.3/eloquent-mutators#date-mutatorsYou need set in your User model column from_date in $dates array and then you can change format in $dateFormatThe another option is also put this method to your User model:and then in view if you run {{ $user->from_date }} you will be see format that you want.Easy to use date in blade template use Carbon that wayMethod One:Using the strtotime() to time is the best format to change the date to the given format.strtotime() - Parse about any English textual datetime description into a Unix timestampThe function expects to be given a string containing an English date format and will try to parse that format into a Unix timestamp (the number of seconds since January 1 1970 00:00:00 UTC), relative to the timestamp given in now, or the current time if now is not supplied. Example:Output:Method Two:date_format() - Return a new DateTime object, and then format the date:Output:There are 3 ways that you can do:1) Using Laravel Model2) Using PHP strtotime3) Using CarbonI had a similar problem, I wanted to change the format, but I also wanted the flexibility of being able to change the format in the blade template engine too.I, therefore, set my model up as the following:The setToStringFormat will set all the dates to use this format for this model.

The advantage of this for me is that I could have the format that I wanted without the mutator, because with the mutator, the attribute is returned as a string meaning that in the blade template I would have to write something like this if I wanted to change the format in the template:Which isn't very clean.Instead, the attribute is still returned as a Carbon instance, however it is first returned in the desired format.

That means that in the template I could write the following, cleaner, code:In addition to being able to reformat the Carbon instance, I can also call various Carbon methods on the attribute in the template.There is probably an oversight to this approach; I'm going to wager it is not a good idea to specify the string format at the top of the model in case it affects other scripts. From what I have seen so far, that has not happened. It has only changed the default Carbon for that model only.In this instance, it might be a good set the Carbon format back to what it was originally at the bottom of the model script. This is a bodged idea, but it would work for each model to have its own format.

Contrary, if you are having the same format for each model then in your AppServiceProvider instead. That would just keep the code neater and easier to maintain.You can use Carbon::createFromTimestampBLADESometimes changing the date format doesn't work properly, especially in Laravel. So in that case, it's better to use:Then you can avoid error like "1970-01-01"!In Laravel you can add a function inside app/Helper/helper.php likeAnd call this function on any controller like thisHope it helps!

Laravel Escaping All HTML in Blade Template

Dr.Neo

[Laravel Escaping All HTML in Blade Template](https://stackoverflow.com/questions/26023823/laravel-escaping-all-html-in-blade-template)

I'm building a small CMS in Laravel and I tried to show the content (which is stored in the DB). It is showing the HTML tags instead of executing them. Its like there is an auto html_entity_decode for all printed data.I tried to print the content using the curly brace.and triple curly brace.And they give the same result. I need to execute those HTML tags instead of escaping them.

2014-09-24 18:21:02Z

I'm building a small CMS in Laravel and I tried to show the content (which is stored in the DB). It is showing the HTML tags instead of executing them. Its like there is an auto html_entity_decode for all printed data.I tried to print the content using the curly brace.and triple curly brace.And they give the same result. I need to execute those HTML tags instead of escaping them.Change your syntax from {{ }} to {!! !!}.As The Alpha said in a comment above (not an answer so I thought I'd post), in Laravel 5, the {{ }} (previously non-escaped output syntax) has changed to {!! !!}. Replace {{ }}  with {!! !!} and it should work.use this tag {!! description text !!}Include the content in {!  !} .I had the same issue. Thanks for the answers above, I solved my issue. If there are people facing the same problem, here is two way to solve it:I hope it helps.There is no problem with displaying HTML code in blade templates.For test, you can add to routes.php only one route:and in hello.blade.php file:For the following code you will get output as on imageSo probably page_desc in your case is not what you expect. But as you see it can be potential dangerous if someone uses for example '` tag so you should probably in your route before assigning to blade template filter some tagsEDITI've also tested it with putting the same code into database:Output is exactly the same in this caseEdit2I also don't know if Pages is your model or it's a vendor model. For example it can have accessor inside:and then when you get page_desc attribute you will get modified page_desc with htmlspecialchars. So if you are sure that data in database is with raw html (not escaped) you should look at this Pages class{{html_entity_decode ($post->content())}} saved the issue for me with Laravel 4.0. Now My HTML content is interpreted as it should. 

Laravel 5 Class 'form' not found

Dan Hastings

[Laravel 5 Class 'form' not found](https://stackoverflow.com/questions/28753767/laravel-5-class-form-not-found)

I have added "illuminate/html": "5.*" to composer.json and ran "composer update".I ran this command in the root of the website. I modified the composer.json file in /root/.composer... and in the root of the project and neither have made a difference.This downloaded the class and it seemed to install. I have added the following to file config/app.php.I think I have an idea what is wrong, but I don’t know how to fix it. My install is in '/var/www/website'. I have checked the file path and the Html folder does not exist.I was able to find the class files, but in a different directory.I manually copied the files over to the main Laravel illuminate/html folder, but this hasn't worked either.

2015-02-26 22:12:44Z

I have added "illuminate/html": "5.*" to composer.json and ran "composer update".I ran this command in the root of the website. I modified the composer.json file in /root/.composer... and in the root of the project and neither have made a difference.This downloaded the class and it seemed to install. I have added the following to file config/app.php.I think I have an idea what is wrong, but I don’t know how to fix it. My install is in '/var/www/website'. I have checked the file path and the Html folder does not exist.I was able to find the class files, but in a different directory.I manually copied the files over to the main Laravel illuminate/html folder, but this hasn't worked either.This may not be the answer you're looking for, but I'd recommend using the now community maintained repository Laravel Collective Forms & HTML as the main repositories have been deprecated.Laravel Collective is in the process of updating their website.  You may view the documentation on GitHub if needed.Form isn't included in laravel 5.0 as it was on 4.0, steps to include it:Begin by installing laravelcollective/html package through Composer. Edit your project's composer.json file to require:  Next, update composer from the Terminal:Next, add your new provider to the providers array of config/app.php:Finally, add two class aliases to the aliases array of config/app.php:At this point, Form should be working  SourceUpdate Laravel 5.8 (2019-04-05):   In Laravel 5.8, the providers in the config/app.php can be declared as:instead of: This notation is the same for the aliases.You can also try running the following commands in Terminal or Command:The above worked for me.Just type the following command in terminal at the project directory and installation is done according the Laravel version:Then add these lines in config/app.phpThere is an update to this for Laravel 5.2.  Notice this is a slightly different format from what is indicated above.Begin by installing this package through Composer. Edit your project's composer.json file to require laravelcollective/html.Next, update Composer from the Terminal:Next, add your new provider to the providers array of config/app.php:Finally, add two class aliases to the aliases array of config/app.php:After making this update this code worked for me on a new installation of Laravel 5.2:I got this information here: https://laravelcollective.com/docs/5.2/htmlBegin by installing this package through Composer. Run the following from the terminal:Next, add your new provider to the providers array of config/app.php:Finally, add two class aliases to the aliases array of config/app.php:SRC:https://laravelcollective.com/docs/5.3/htmlIn Laravel Version - 4, HTML and Form existed, but not now.Why:The only reason is they have collected some user requirements and they want it more lightweight and so they removed it as in the sense that a user can add it manually.What to do to add HTML & Forms in Laravel 5.2 or 5.3:For 5.2:Go to the Laravel Collective site and installation processes have demonstrated their.Like for 5.2: on the command line, run the commandThen, in the provider array which is in config/app.php. Add this line at last using a comma(,):For using HTML and FORM text we need to alias them in the aliases array of config/app.php. Add the two lines at the lastAnd for 5.3:Just run the commandAnd the rest of the procedure is like 5.2.Then you can use Laravel Form and other HTML links in your projects. For this, follow this documentation:5.2: https://laravelcollective.com/docs/5.2/html5.3:  https://laravelcollective.com/docs/5.3/htmlDemo Code:To open a form, open and close a tag:And for creating label and input text with a Bootstrap form-control class and other use:And for more, use the documentation, https://laravelcollective.com/.Use Form, not form. The capitalization counts.I have tried everything, but only this helped:

Laravel 5.2 - pluck() method returns array

Limon Monte

[Laravel 5.2 - pluck() method returns array](https://stackoverflow.com/questions/34405138/laravel-5-2-pluck-method-returns-array)

I'm trying to upgrade my project L5.1 -> L5.2. In upgrade guide there's one thing which isn't clear for me:That's ok, rename refactoting from lists() to pluck() isn't a problem. But what with useful pluck() method which was in L5.0 and L5.1?From the 5.0 documentation:What is the alternative for old pluck() method in L5.2?UPDATE:Example: L5.1:L5.2:

2015-12-21 22:07:54Z

I'm trying to upgrade my project L5.1 -> L5.2. In upgrade guide there's one thing which isn't clear for me:That's ok, rename refactoting from lists() to pluck() isn't a problem. But what with useful pluck() method which was in L5.0 and L5.1?From the 5.0 documentation:What is the alternative for old pluck() method in L5.2?UPDATE:Example: L5.1:L5.2:The current alternative for pluck() is value().laravel pluck returns an arrayif your query is:then the array is like this (key is the index of the item. auto incremented value):but if you do like this:then the key is actual index in the database. you can set any value as key.To get first occurence, You can either useor use,In the original example, why not use the select() method in your database query?This will be faster than using a PHP framework, for it'll utilize the SQL query to do the row selection for you. For ordinary collections, I don't believe this applies, but since you're using a database...Larvel 5.3: Specifying a Select Clause

Laravel Blade passing variable with string through @include causes error

joeyfb

[Laravel Blade passing variable with string through @include causes error](https://stackoverflow.com/questions/29739745/laravel-blade-passing-variable-with-string-through-include-causes-error)

In Laravel 5.0.27 I am including a view with with a variable and the following code:and I get the following error...I've narrowed down that the error is solely from the "(" in the "mainContent" variable string, and when I remove the "(" the error disappears and everything runs fine. I can't find anything in documentation on this or any similar errors listed online. Does anyone know if this is expected behavior or if this is a bug that should be reported?Thanks so much for your time!

2015-04-20 05:12:20Z

In Laravel 5.0.27 I am including a view with with a variable and the following code:and I get the following error...I've narrowed down that the error is solely from the "(" in the "mainContent" variable string, and when I remove the "(" the error disappears and everything runs fine. I can't find anything in documentation on this or any similar errors listed online. Does anyone know if this is expected behavior or if this is a bug that should be reported?Thanks so much for your time!It's not a bug but a limitation of blade syntax due to regex. Solution came from github:In 5.8v, included views inherit all variables from the parent as per in documentation:

Calling other function in the same controller?

Himmators

[Calling other function in the same controller?](https://stackoverflow.com/questions/17861412/calling-other-function-in-the-same-controller)

I've this controller, and the function read($q) return error Call to undefined function sendRequest()I'm assuming it's because I'm referencing the function in the wrong manner, but I can't find any explanations for how to do it.

2013-07-25 14:49:56Z

I've this controller, and the function read($q) return error Call to undefined function sendRequest()I'm assuming it's because I'm referencing the function in the wrong manner, but I can't find any explanations for how to do it.Try:Since PHP is not a pure Object-Orieneted language, it interprets sendRequest() as an attempt to invoke a globally defined function (just like nl2br() for example), but since your function is part of a class ('InstagramController'), you need to use $this to point the interpreter in the right direction.Yes. Problem is in wrong notation. Use:Instead. Or for static methods. Also read this for getting idea of OOP - http://www.php.net/manual/en/language.oop5.basic.php

Laravel Migration table already exists but i want to add new not the older

MD. Atiqur Rahman

[Laravel Migration table already exists but i want to add new not the older](https://stackoverflow.com/questions/26077458/laravel-migration-table-already-exists-but-i-want-to-add-new-not-the-older)

I previously created users table. Now I have created a new migration to create a new books table inside my schema. When I try to run the commandIt shows: Here is my new migration table:How can I get rid of the error?

2014-09-27 17:45:31Z

I previously created users table. Now I have created a new migration to create a new books table inside my schema. When I try to run the commandIt shows: Here is my new migration table:How can I get rid of the error?You need to runif that also fails just go in and drop all the tables which you may have to do as it seems your migration table is messed up or your user table when you ran a previous rollback did not drop the table.EDIT:The reason this happens is that you ran a rollback previously and it had some error in the code or did not drop the table. This still however messes up the laravel migration table and as far as it's concerned you now have no record of pushing the user table up. The user table does already exist however and this error is throw.In v5.x, you might still face the problem. So, try to delete related table manually first usingphp artisan tinkerThenSchema::drop('books')(and exit with q)Now, you can successfully php artisan migrate:rollback and php artisan migrate.If this happens repeatedly you should check that the down() method in your migration is showing the right table name. (Can be a gotcha if you've changed your table names.)I had the same trouble. The reason is that your file name in migrations folder does not match with name of migration in your database (see migrations table). They should be the same.You can use

    php artisan migrate:fresh 

to drop all tables and migrate then.

Hope it helpsAlso u may insert befor

Schema::create('books', function(Blueprint $table) the following code Schema::drop('books');EDIT: (for laravel)Just Came across this issue while working on a project in laravel. My tables were messed up, needed to frequent changes on columns. Once the tables were there I wasn't able to run php artisan migrate anymore.I've done following to get rid of the issue-Previous Comment, regarding lumen[Well, pretty late to the party (and possibly a different party than what I was looking for). I banged my head, screamed out loud and by the grace of gray skull just found a solution.]I'm developing an restful app using lumen and I'm new to it. This is my first project/experiment using laraval and lumen. My dependencies-Anyway, everything was fine until yesterday night but suddenly phpunit started complaining about an already existed table.Duh! Items table should exist in the database, or else how am i supposed to save items! Anyway the problem only persisted in the test classes, but strangely not in the browser (I checked with chrome, firefox and postman altering headers). I was getting JSON responses with data as expected.I dropped the database and recreated it with lots of migrate, refresh, rollback. Everything was fine but in phpunit.Out of desperation I removed my migration files (of course I took a backup first ) then hit phpunit in the terminal. Same thing all over again.Suddenly I remembered that I put a different database name in the phpunit.xml file for testing purpose only. I checked that database and guess what! There was a table named items. I removed this table manually, run phpunit, everything started working just fine.I'm documenting my experience for future references only and with hope this might help someone in future.I inherited some real bad code from someone who wasn't using migrations!?, so manually pasted the filenames into the migrations, forgetting to remove the trailing .phpSo that caused the 'table exists' error despite the filename and migration matching.2018_05_07_142737_create_users_table.php - WRONG

2018_05_07_142737_create_users_table - CORRECTYou can delete all the tables but it will be not a good practice, instead try this commandMake sure to use the naming convention correctly. I have tested this in version laravel 5.7

It is important to not try this command when your site is on server because it drops all information.I had a similar problem after messing with foreign key constraints. One of my tables (notes) was gone and one kept coming back (tasks) even after dropping it in MySQL, preventing me from running: php artisan migrate/refresh/reset, which produced the above 42s01 exception.What I did to solve it was ssh into vagrant then go into MySQL (vagrant ssh, mysql -u homestead -p secret), then: DROP DATABASE homestead; Then CREATE DATABASE homestead; Then exit mysql and run:php artisan migrate`.Obviously this solution will not work for people not using vagrant/homestead.

Not claiming in any way this is a proper workflow but it solved my problem which looks a lot like the above one. I think my answer will help more. I faced this error also. Then I deleted specific migration file and tried to recreate by php artisan. But before get this point 1 or 2 days ago while I was watching laracast videos about migation, I was thinking rollback and migrate specific table. For some reason I deleted specific migration file and tried recreate but doing so I got:When I check that file I saw the line below at top of array in the autoload_classmap.php file:Altough rollback or delete a migration file, the record related with the migration file remains in the composer autoload_classmap.php file. To solve this problem, I have found composer command below from somewhere I can't remember.When I rand this code, the line related with the migration file that I deleted is gone. Then I ran:Finally I recreated my migration file with same nameyou drop all tabel in your database, then edit your migration file php artisan migrate again ^_^done your table !!After rollback check your tables , be sure of deletion.If there is a problem delete tables manually from database application like phpmyadmin ( I'm using sequel pro for mac ).Correct your down methods in the migration .Note : Do rollback then migrate .. Don't use migrate:refresh to notice where is the error been .After that you may test with new db for testing. to detect where is the problem.Also try reading this questiongo to phpmyadmin  and drop the database that you created for laravel then create it again then go to cmd(if use windows) root project and type php artisan migrateYou can always check for a table existence before creating it.Check solution: Laravel Official Solution As outlined in the Migrations guide to fix this all you have to do is edit your app\Providers\AppServiceProvider.php file and inside the boot method set a default string length:After above command you need to delete all remaining tables manually and then run the command:First drop the users table in the database.Then go to command propmt and type php artisan migrateall sets.I think this answer helps.Add this to AppServiceProvider.php2014_10_12_100000_create_password_resets_table.php2014_10_12_000000_create_users_table.phpI solved your problem by deleting the "user" table in sequel-pro (there is no data in my user table) and then you can run php artisan migrateHere are before and after screen shotsbefore I delete the user table userafter I delete the table user

I think this happens because the latest laravel class (at 12th February 2018) has removed the function of ->index() and ->unique()In laravel 5.4, If you are having this issue.  Check this link-or-Go to this page in app/Providers/AppServiceProvider.php

and add code down belowEdit AppServiceProvider.php will be found at app/Providers/AppServiceProvider.php and addThen run On your terminal.

It helped me, may be it will work for you as well.Drop all database table and run this line in your project path via CMDI also had this issue, just came across this answer on a Youtube Video. Not sure if it's ideal, but it's the best I've seen.Seems the AppServiceProvider.php file of the providers directory by giving the Schema a length. In this case 191. Works like magic.Screenshot. He then ran: php artisan migrate:fresh. Hope this works.I had the same issue, the problem is in the name saved in the table migrations inside database, because in my database exists 2017_10_18_200000_name and in files 2016_10_18_200000_name, after change the name of file that work.First check the migrations table in your DB and sure that your migration files in database folder in your project is equal to this table data. Sometimes if you create migration files by manual appear this error when run migrate command in composer.DANGER - most of these answers will wipe your database and is not recommended for production use.It's clear there are a lot of "solutions" for this problem, but all these solutions I read through are very destructive solutions and none of them work for a production database. Based on the number of solutions, it also seems that there could be several causes to this error. My error was being caused by a missing entry in my migrations table. I'm not sure exactly how it happened but by adding it back in I no longer received the error.Solution :Laravel Migration table already exists... ||

It Works in Laravel 5.8 alsoand inside the boot method set a default string length:and openand change it to save all the files and go to command promptAnswer is very straight forward : First take a backup of folder bootstrap/cache.Then delete all the files from bootstrap/cache folder .Now run:Creating a database literally takes seconds.Export your current database in case it has sensitive data.Check your migrations and eliminate all wrong methods in it.Drop database and Re-create database.Then you can return the data previously in the database.

Laravel 5.1 Unknown database type enum requested

karthick

[Laravel 5.1 Unknown database type enum requested](https://stackoverflow.com/questions/33140860/laravel-5-1-unknown-database-type-enum-requested)

While running php artisan migrate, I got the following errorHow to resolve this issue.Code:

2015-10-15 05:52:54Z

While running php artisan migrate, I got the following errorHow to resolve this issue.Code:The official Laravel 5.1 documentation states:It doesn't matter if you're trying to change another column, if the table contains a enum anywhere it won't work. It's a Doctrine DBAL issue.As a workaround you could either drop the column and add a new one (column data will be lost):or use a DB statement:Source: https://github.com/laravel/framework/issues/1186It is a known issue as stated in Laravel 5.1 documentation.It happens when you have a enum column in your database table. Whether you are trying to rename another column, or change another column to nullable, this bug will appear. It's an issue with Doctrine\DBAL. An easy fix for this is to just add this constructor method in your database migration file.This will map all the ENUM columns to VARCHAR(), and the column will accept any string.Credit to @Gmatkowski's answer at https://stackoverflow.com/a/32860409/1193201A real dirty solution, that gets the job done none the less would be toby ading these lines just above line 113Beware that updating vendor files directly is not advisable because in the event the vonder chooses to update the plugin, you changes could be overwrittenYou should not use enum at all. Even with laravel 5.8, problem is not resolved.Thank's to everyone who reminded thatThe official Laravel 5.1 documentation states:Plus you will have the same problem when adding available options into enum column declaration.It brings me to a conclusion that You should use enum with care. or even You should not use enum at all.I cannot vote up any answer that offer to replace enum with string. NO, you need to create a lookup table and replace enum with unsignedInteger as a foreign key.It is a lot of work and you'll be upset doing it without previous unit-test coverage, but this is a right solution.You may be even fired for doing this correctly, because it is taking too long, but, don't worry, you'll find a better job. :)Here is an example of how difficult would it be adding available options into enum column declarationsay you have this:and you need to make more types availableI get rid of this problem by creating a new Migration Class and making my migrations extending from it. Maybe there are multiple ways to make it more "standard" but this is just a very simple case which works perfectly for our team.Then as explained before just extend your migration from itI think the easiest way to fix this issue is adding a mapping type to doctrine.yaml if applicable so that enum will be treated as string.

Consuming my own Laravel API

robjmills

[Consuming my own Laravel API](https://stackoverflow.com/questions/16520691/consuming-my-own-laravel-api)

I'm developing a Laravel 4 app that will make the same CRUD operations on my dataset available through a JSON REST API and a Web UI. It seems that to prevent breaking the DRY principle that my UI should consume my own API by routing all requests from the UI back to the API. I'm unsure though about the best approach to making this work. Presumably I would have separate UI and API controllers and somehow route the requests through. Or should I be looking at a different approach altogether?Thanks.

2013-05-13 11:12:27Z

I'm developing a Laravel 4 app that will make the same CRUD operations on my dataset available through a JSON REST API and a Web UI. It seems that to prevent breaking the DRY principle that my UI should consume my own API by routing all requests from the UI back to the API. I'm unsure though about the best approach to making this work. Presumably I would have separate UI and API controllers and somehow route the requests through. Or should I be looking at a different approach altogether?Thanks.I'm actually tinkering with the same idea and it's pretty neat. With Laravel you do have the ability to make internal requests (some might refer to this as HMVC, but I won't). Here's the basics of an internal request.$response will now contain the returned response of the API. Typically this will be returned a JSON encoded string which is great for clients, but not that great for an internal API request. You'll have to extend a few things here but basically the idea is to return the actual object back through for the internal call, and for external requests return the formatted JSON response. You can make use of things like $response->getOriginalContent() here for this kind of thing.What you should look at doing is constructing some sort of internal Dispatcher that allows you to dispatch API requests and return the original object. The dispatcher should also handle malformed requests or bad responses and throw exceptions to match.The idea itself is solid. But planning an API is hard work. I'd recommend you write up a good list of all your expected endpoints and draft a couple of API versions then select the best one.NOTE: As vcardillo pointed out below, route filters are not called with these methods.I am currently doing the same thing, and Jason's answer got me going in a great direction. Looking at the Symfony\Component\HttpFoundation\Request documentation, I figured out how to POST, as well as everything else I'd need to do. Assuming you're using a form, here is some code that could help you:GET:POST:POST w/ cookiesPOST w/ filesI hope this helps someone else. If you aren't using a form, or you are but not using Laravel's Input / Cookie facade, replace the Input / Cookie facades with your own content.Taylor Otwell suggested using app()->handle() rather than Route::dispatch() to achieve a clean request.For Route::dispatch($request) I noticed if the endpoint of your non-GET request (parameters on the HTTP request body) uses a dependency injected \Illuminate\Http\Request or \Illuminate\Foundation\Http\FormRequest extending instance, state of the parameters, cookies, files, etc. are from the original HTTP request. i.e., for your application's controller action method.If parameter names and post method type for your app controller and API controller are the same, you won't notice the difference since the original parameter values are passed on. But when you're manually assembling the 3rd parameter of Request::create(), Route::dispatch() will result in it being ignored.app()->handle() fixes that context problem in the Laravel request lifecycle.Caveat: app()->handle() affects  Illuminate\Support\Facades\Request, refreshing it with this new request instance. As a knock-on effect, calls like Request::isXmlHttpRequest() or redirect()->back() invoked after app()->handle() will cause unpredictable behaviour. I'd suggest tracking the context of your original request and instead use redirect()->to(route('...')) so you strictly control flow and state of your app.Given all these corner cases, it may be best to just do a manual curl using a Guzzle HTTP client.If you're consuming your own API, use app()->handle() instead of Route::dispatch() as Derek MacDonald has suggested.app()->handle() creates a fresh request, while Route::dispatch() runs the route within the stack, effectively ignoring parameters that are part of the request that you're sending.Edit: Just a heads-up. Taylor Otwell advises against using sub-requests to make internal API calls, as they mess the current route. You can an HTTP API client like Guzzle instead to make the API calls.If you are looking for using passport login api internally, then you need to add the parameters to original request:You can use Optimus API consumer, the API is clean and simple, example making an internal request:In it's core, it uses Illuminate\Routing\Router and Illuminate\Http\Request to make the callIf you are looking for using passport login api internally, then you need to add the parameters to original request:

Laravel Mail::send() sending to multiple to or bcc addresses

haakym

[Laravel Mail::send() sending to multiple to or bcc addresses](https://stackoverflow.com/questions/26584904/laravel-mailsend-sending-to-multiple-to-or-bcc-addresses)

I can't seem to successfully send to multiple addresses when using Laravel's Mail::send() callback, the code does however work when I only specify one recipient.I've tried chaining:and passing an array:but neither seem to work and I get failure messages when returning Mail::failures(), a var_dump() of Mail::failures() shows the email addresses that I tried to send to, for example:Clearly doing something wrong, would appreciate any help as I'm not understanding the API either: http://laravel.com/api/4.2/Illuminate/Mail/Message.html#method_toI realise I could put the Mail::send() method in a for/foreach loop and Mail::send() for each email address, but this doesn't appear to me to be the optimal solution, I was hoping I would also be able to ->bcc() to all addresses once everything was working so the recipients wouldn't see who else the mail is being sent to.

2014-10-27 09:55:40Z

I can't seem to successfully send to multiple addresses when using Laravel's Mail::send() callback, the code does however work when I only specify one recipient.I've tried chaining:and passing an array:but neither seem to work and I get failure messages when returning Mail::failures(), a var_dump() of Mail::failures() shows the email addresses that I tried to send to, for example:Clearly doing something wrong, would appreciate any help as I'm not understanding the API either: http://laravel.com/api/4.2/Illuminate/Mail/Message.html#method_toI realise I could put the Mail::send() method in a for/foreach loop and Mail::send() for each email address, but this doesn't appear to me to be the optimal solution, I was hoping I would also be able to ->bcc() to all addresses once everything was working so the recipients wouldn't see who else the mail is being sent to.I've tested it using the following code:Result - empty array for failures.But of course you need to configure your app/config/mail.php properly. So first make sure you can send e-mail just to one user and then test your code with many users. Moreover using this simple code none of my e-mails were delivered to free mail accounts, I got only emails to inboxes that I have on my paid hosting accounts, so probably they were caught by some filters (it's maybe simple topic/content issue but I mentioned it just in case you haven't received some of e-mails) .If you want to send emails simultaneously to all the admins, you can do something like this:In your .env file add all the emails as comma separated values:so when you going to send the email just do this (yes! the 'to' method of message builder instance accepts an array):So,and...will now send the mail to all the admins.the accepted answer does not work any longer with laravel 5.3 because mailable tries to access ->email and results in a working code for laravel 5.3 is this:   With Laravel 5.6, if you want pass multiple emails with names, you need to pass array of associative arrays. Example pushing multiple recipients into the $to array:Fixed two recipients:The 'name' key is not mandatory. You can set it to 'name' => NULL or do not add to the associative array, then only 'email' will be used.In a scenario where you intend to push a single email to different recipients at one instance (i.e CC multiple email addresses), the solution below works fine with Laravel 5.4 and above.where document is any class that further customizes your email.This works great - i have access to the request object and the email arrayI am using Laravel 5.6 and the Notifications Facade.If I set a variable with comma separating the e-mails and try to send it, I get the error:

"Address in mail given does not comply with RFC 2822, 3.6.2"So, to solve the problem, I got the solution idea from @Toskan, coding the following.It worked for me to send to one or many recipients. 😉it works for me fine,

if you a have string, then simply explode it first. $emails = array();

Laravel Socialite: InvalidStateException

rap-2-h

[Laravel Socialite: InvalidStateException](https://stackoverflow.com/questions/30660847/laravel-socialite-invalidstateexception)

I'm using Laravel Socialite to add a Facebook connect button on a website. Sometimes, I've got this error on callback:I don't know what it mean and did not found anything yet about this error. The real problem is it seems to be a random exception (don't understood why it happens). So what this error means and how to avoid it?It seems it's not the same problem as Laravel 5 geting InvalidStateException in AbstractProvider.php, cause in my case it's random.

2015-06-05 07:32:50Z

I'm using Laravel Socialite to add a Facebook connect button on a website. Sometimes, I've got this error on callback:I don't know what it mean and did not found anything yet about this error. The real problem is it seems to be a random exception (don't understood why it happens). So what this error means and how to avoid it?It seems it's not the same problem as Laravel 5 geting InvalidStateException in AbstractProvider.php, cause in my case it's random.I ran into this issue last night and solve it with the following solution.More information on my issue, I've got in the function handleProviderCallback() when it re-direct back from Facebook login. It seems to be the same as your issue.Furthermore I found my issue occurs when I open my site without www. When I open my site with www.mysite.com - no problem. At first I think my issue is random until I've got the clue by Chris Townsend's reply to the question - Thank you very much.The SolutionBe sure to delete your cookies from browser when testing it after these modifications are done. Old cookies can still produce problems.Resolved :tl;drIf you need to read a given parameter state returned by a thirdparty service, you can set Socialite to avoid this checking with the stateless method:I think Socialite is already prepared to avoid this issue.https://github.com/laravel/socialite/blob/2.0/src/Two/AbstractProvider.php#L77https://github.com/laravel/socialite/blob/2.0/src/Two/AbstractProvider.php#L374https://github.com/laravel/socialite/blob/2.0/src/Two/AbstractProvider.php#L222For instance, state is very useful to pass data throught google:ref: https://developers.google.com/identity/protocols/OAuth2UserAgent#overviewAlso check access right on your storage/framework/sessions folder. In my case, since this folder is empty in new Laravel project, it has been left out during initially commit to the GIT repository. Afterwards I created it manually on production server, but obviously with the wrong access rights, hence it was not writable for the session driver (when set to 'file').I was only experiencing this error when logging in via mobile web with the facebook app instead of facebook in browser. The facebook app uses the facebook browser after login instead of your current browser, so is unaware of previous state.In my case it was caused by missing parameters in $fillable array in User class. When i added all missing parameters, it started to work properly..I've got same happen only when I open my web on mobile and open the dialog by facebook application on my phone.I think:

This happen because open facebook app to get response from Facebook API make we lost some cookie. it's become stateless.

Then I just use the option that socialite are already made to avoid stateless request.It's worked to me. hope it help you I had the same problem and I just cleared the cache to solve this problem. I just ran this command and started the process again.I hope this answer may help someone.this solved it for me 

$request->session()->put('state',Str::random(40));

$user = Socialite::driver('github')->stateless()->user();If you still need help you can use my code, it works for me. You just need to create two routes and update the users table. Don't forget to make password nullable, since you won't get one from the facebook users

The code in my controller:I fixed this just disabling the SESSION DRIVER as database... file driver worked fine for me after hours trying to fix this s...I had a similar issue, I've gotin the function handleProviderCallback() when it re-directs back from Facebook login. It seems to be the same as your issue.Furthermore I found my issue occurs when I open my site without www. When I open my site with www.mysite.com - no problem. At first I think my issue is random until I've got the clue by Chris Townsend's reply to the question.The SolutionGo to your www root, check the laravel file config/session.php. Check session Session Cookie Domain. The default configuration is I made a change to After php artisan cache:clear and composer dump-autoload, I can login with no issue from both www.mysite.com and mysite.comBe sure to delete your cookies from browser when testing it after these modifications are done. Old cookies can still produce problems.Got the Solution - Update November 2018On your Controller within the callback() method$user = $service->createOrGetUser(Socialite::driver('facebook')->user());$user = $service->createOrGetUser(Socialite::driver('facebook')->stateless()->user());Laravel 6.16.0

php 7.4.2I came across this exact issue. Turns out I recently changed same_site to strict and socialite was throwing InvalidStateException exception. Then I changed it to back to null and all worked fine.This issue has nothing to do with a lot of the solutions above, is rather as simple as changing your callback URL from 'http://localhost:8000/callback/twitter to http://127.0.0.1:8000/callback/twitter in your config/services.php and on your twitter app set up on your twitter application.the http://localhost in the URL is the issue, replace with http://127.0.0.1I want to share you my solution . I go to my AbstractProvider.php file and in the line of problem I stop the throw new InvalidStateException and call the redirect function like that:

Laravel 5 Querying with relations causes「Call to a member function addEagerConstraints() on null」error

Tomkarho

[Laravel 5 Querying with relations causes「Call to a member function addEagerConstraints() on null」error](https://stackoverflow.com/questions/31546081/laravel-5-querying-with-relations-causes-call-to-a-member-function-addeagercons)

I have been trying to create a simple user management system but keep on hitting road blocks when it comes to querying relations.  For example I have users and roles and whenever I try to make a query for all users and their roles I get an error.  The one in the title is only the latest one I've encountered.My User and Role Models look like this:My migration table for many-to-many relationship between the two looks like this:And then I try to get all records with their relation in a controller:So I need another pair of eyes to tell me what is it I am missing here?

2015-07-21 17:44:50Z

I have been trying to create a simple user management system but keep on hitting road blocks when it comes to querying relations.  For example I have users and roles and whenever I try to make a query for all users and their roles I get an error.  The one in the title is only the latest one I've encountered.My User and Role Models look like this:My migration table for many-to-many relationship between the two looks like this:And then I try to get all records with their relation in a controller:So I need another pair of eyes to tell me what is it I am missing here?You are missing return statements in the methods that define relations. They need to return relation definition.ReplaceWith

Laravel - Using (:any?) wildcard for ALL routes?

qwerty

[Laravel - Using (:any?) wildcard for ALL routes?](https://stackoverflow.com/questions/13297278/laravel-using-any-wildcard-for-all-routes)

I am having a bit of trouble with the routing.I'm working on a CMS, and i need two primary routes. /admin and /(:any). The admin controller is used for the route /admin, and the view controller should be used for anything else than /admin. From the view controller, i will then parse the url and show the correct content.This is what i have:The first route works, but the second one doesn't. I played around with it a little bit, and it seems if i use (:any) without the question mark, it only works if i put something after /. If i do put the question mark there, it doesn't work at all.I want all of the following routes to go to view@index:Is this possible without hardcoding a bunch of (:any?)/(:any?)/(:any?)/(:any?) (which i don't even know works)?What's the best way to go about this?

2012-11-08 20:29:31Z

I am having a bit of trouble with the routing.I'm working on a CMS, and i need two primary routes. /admin and /(:any). The admin controller is used for the route /admin, and the view controller should be used for anything else than /admin. From the view controller, i will then parse the url and show the correct content.This is what i have:The first route works, but the second one doesn't. I played around with it a little bit, and it seems if i use (:any) without the question mark, it only works if i put something after /. If i do put the question mark there, it doesn't work at all.I want all of the following routes to go to view@index:Is this possible without hardcoding a bunch of (:any?)/(:any?)/(:any?)/(:any?) (which i don't even know works)?What's the best way to go about this?Edit: There has been some confusion since the release of Laravel 4 regarding this topic, this answer was targeting Laravel 3.There are a few ways to approach this.The first method is matching (:any)/(:all?):Not the best solution because it gets broken into multiple parameters, and for some reason (:all) doesn't work by itself (bug?)The second solution is to use a regular expression, this is a better way then above in my opinion.There is one more method, which would let you check if there are cms pages even when the route may have matched other patterns, provided those routes returned a 404. This method modifies the event listener defined in routes.php:However, my preferred method is #2. I hope this helps. Whatever you do, make sure you define all your other routes above these catch all routes, any routes defined after will never trigger.This solution works fine on Laravel 5:This is for Lumen instead:Hitting a 404 status seems a bit wrong to me. This can get you in all kind of problems when logging the 404's. I recently bumped into the same wildcard routing problem in Laravel 4 and solved it with the following snippet:This should solve your problem in a controlled way. The regular expression can be simplified to:But you should use this at your own risk.Edit (addition):As this overwrites a lot of routes, you should consider wrapping it in an "App::before" statement:This way, it will not overwrite custom routes you define later on.The above code will capture the recursive sub urls you mentioned:Any other special cases, such as admin/*, you can capture before this one.Add this in the end of routes filefrom http://scotch.io/tutorials/simple-and-easy-laravel-routingJust spelling-out my experience in case it helps someone piece something together.I built a self-API-consuming React app on Laravel.

It has a single view served by Laravel/Lumen.

It uses the React router.

Clicking links in the app always worked, but typing-in URLs needed the following consideration:In Laravel I used the following in my web.php routes file:And everything worked.Then I switched the project to Lumen.

Thanks to this post, I used the following in my web.php routes file:This worked for first level URLS such as:However,did not.I looked in the network tab in Google Developer tools and noticed that the URL for app.js was appending /something in front of app.js on second and higher tier URLS, such as:All I had to do was add a leading slash to my app.js source  in my single view page such as:Instead of:so:This worked in Laravel (It was a Blade file that may have automatically resolved the js/app.js URL)withBut, I had to do this in Lumen (Not a Blade file):withThanks for the solution William. However methods 1 & 2 aren't working anymore Laravel 4, and in order to use solution #3 in Laravel 4 you will have to fire the 404 event in your start/global.php file.Now we can handle this in our routes.php file:Having basic lumen scaffolding. In my case, I have 2 frontend apps and api routes

Laravel Eloquent - Attach vs Sync

