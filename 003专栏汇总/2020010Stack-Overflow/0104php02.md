startsWith() and endsWith() functions in PHP

Click Upvote

[startsWith() and endsWith() functions in PHP](https://stackoverflow.com/questions/834303/startswith-and-endswith-functions-in-php)

How can I write two functions that would take a string and return if it starts with the specified character/string or ends with it?For example:

2009-05-07 12:14:27Z

How can I write two functions that would take a string and return if it starts with the specified character/string or ends with it?For example:Use this if you don't want to use a regex.You can use substr_compare function to check start-with and ends-with:This should be one of the fastest solutions on PHP 7 (benchmark script). Tested against 8KB haystacks, various length needles and full, partial and no match cases. strncmp is a touch faster for starts-with but it cannot check ends-with.Updated 23-Aug-2016(Sorted fastest to slowest)(Sorted fastest to slowest)startswith_benchmark.phpAll answers so far seem to do loads of unnecessary work, strlen calculations, string allocations (substr), etc. The 'strpos' and 'stripos' functions return the index of the first occurrence of \$needle in \$haystack:Credit To:Check if a string ends with another stringCheck if a string begins with another stringThe regex functions above, but with the other tweaks also suggested above:This question already has many answers, but in some cases you can settle for something simpler than all of them.

If the string you're looking for is known (hardcoded), you can use regular expressions without any quoting etc.Check if a string starts with 'ABC':ends with 'ABC':In my simple case, I wanted to check if a string ends with slash:The advantage: since it's very short and simple, you don't have to define a function (such as endsWith()) as shown above.But again -- this is not a solution for every case, just this very specific one.If speed is important for you, try this.(I believe it is the fastest method)Works only for strings and if \$haystack is only 1 character Here are two functions that don't introduce a temporary string, which could be useful when needles are substantially big:I realize this has been finished, but you may want to look at strncmp as it allows you to put the length of the string to compare against, so:You can use strpos and strrpos  Here's a multi-byte safe version of the accepted answer, it works fine for UTF-8 strings:Short and easy-to-understand one-liners without regular expressions.startsWith() is straight forward.endsWith() uses the slightly fancy and slow strrev():Focusing on startswith, if you are sure strings are not empty, adding a test on the first char, before the comparison, the strlen, etc., speeds things up a bit:It is somehow (20%-30%) faster. Adding another char test, like $haystack{1}===$needle{1} does not seem to speedup things much, may even slow down.=== seems faster than ==

Conditional operator (a)?b:c seems faster than if(a) b; else c;For those asking "why not use strpos?" calling other solutions "unnecessary work"strpos is fast, but it is not the right tool for this job.To understand, here is a little simulation as an example:What the computer does "inside"?Assuming strlen does not iterate the whole string (but even in that case) this is not convenient at all.I hope that the below answer may be efficient and also simple:I usually end up going with a library like underscore-php these days. The library is full of other handy functions.The answer by mpen is incredibly thorough, but, unfortunately, the provided benchmark has a very important and detrimental oversight.Because every byte in needles and haystacks is completely random, the probability that a needle-haystack pair will differ on the very first byte is 99.609375%, which means that, on average, about 99609 of the 100000 pairs will differ on the very first byte. In other words, the benchmark is heavily biased towards startswith implementations which check the first byte explicitly, as strncmp_startswith2 does.If the test-generating loop is instead implemented as follows:the benchmark results tell a slightly different story:Of course, this benchmark may still not be perfectly unbiased, but it tests the efficiency of the algorithms when given partially matching needles as well.in short:The substr function can return false in many special cases, so here is my version, which deals with these issues:Tests (true means good):Also, the substr_compare function also worth looking.

http://www.php.net/manual/en/function.substr-compare.phpThis may workSource: https://stackoverflow.com/a/4419658Why not the following?Output:Keep in mind, strpos will return false if the needle was not found in the haystack, and will return 0 if, and only if, needle was found at index 0 (AKA the beginning).And here's endsWith:In this scenario there is no need for a function startsWith() aswill return true or false accurately.It seems odd it's this simple with all the wild functions running rampant here.I would do it like this Just a recommendation:That extra line, comparing the first character of the strings, can make the

false case return immediately, therefore making many of your comparisons

a lot faster (7x faster when I measured).  In the true case you pay virtually no price in performance for that single line so I think it's worth including.  (Also, in practice, when you test many strings for a specific starting chunk, most comparisons will fail since in a typical case you're looking for something.)You also can use regular expressions:Many of the previous answers will work just as well. However, this is possibly as short as you can make it and have it do what you desire. You just state that you'd like it to 'return true'. So I've included solutions that returns boolean true/false and the textual true/false.Based on James Black's answer, here is its endsWith version:Note: I have swapped the if-else part for James Black's startsWith function, because strncasecmp is actually the case-insensitive version of strncmp.Here’s an efficient solution for PHP 4. You could get faster results if on PHP 5 by using substr_compare instead of strcasecmp(substr(...)).No-copy and no-intern-loop:

How do you use bcrypt for hashing passwords in PHP?

Vilx-

[How do you use bcrypt for hashing passwords in PHP?](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

Every now and then I hear the advice "Use bcrypt for storing passwords in PHP, bcrypt rules".But what is bcrypt? PHP doesn't offer any such functions, Wikipedia babbles about a file-encryption utility and Web searches just reveal a few implementations of Blowfish in different languages. Now Blowfish is also available in PHP via mcrypt, but how does that help with storing passwords? Blowfish is a general purpose cipher, it works two ways. If it could be encrypted, it can be decrypted. Passwords need a one-way hashing function.What is the explanation?

2011-01-25 15:34:04Z

Every now and then I hear the advice "Use bcrypt for storing passwords in PHP, bcrypt rules".But what is bcrypt? PHP doesn't offer any such functions, Wikipedia babbles about a file-encryption utility and Web searches just reveal a few implementations of Blowfish in different languages. Now Blowfish is also available in PHP via mcrypt, but how does that help with storing passwords? Blowfish is a general purpose cipher, it works two ways. If it could be encrypted, it can be decrypted. Passwords need a one-way hashing function.What is the explanation?bcrypt is a hashing algorithm which is scalable with hardware (via a configurable number of rounds). Its slowness and multiple rounds ensures that an attacker must deploy massive funds and hardware to be able to crack your passwords. Add to that per-password salts (bcrypt REQUIRES salts) and you can be sure that an attack is virtually unfeasible without either ludicrous amount of funds or hardware.bcrypt uses the Eksblowfish algorithm to hash passwords. While the encryption phase of Eksblowfish and Blowfish are exactly the same, the key schedule phase of Eksblowfish ensures that any subsequent state depends on both salt and key (user password), and no state can be precomputed without the knowledge of both. Because of this key difference, bcrypt is a one-way hashing algorithm. You cannot retrieve the plain text password without already knowing the salt, rounds and key (password). [Source]Password hashing functions have now been built directly into PHP >= 5.5. You may now use password_hash() to create a bcrypt hash of any password:To verify a user provided password against an existing hash, you may use the password_verify() as such:There is a compatibility library on GitHub created based on the source code of the above functions originally written in C, which  provides the same functionality. Once the compatibility library is installed, usage is the same as above (minus the shorthand array notation if you are still on the 5.3.x branch).You can use crypt() function to generate bcrypt hashes of input strings. This class can automatically generate salts and verify existing hashes against an input. If you are using a version of PHP higher or equal to 5.3.7, it is highly recommended you use the built-in function or the compat library. This alternative is provided only for historical purposes.You can use this code like this:Alternatively, you may also use the Portable PHP Hashing Framework.So, you want to use bcrypt? Awesome! However, like other areas of cryptography, you shouldn't be doing it yourself. If you need to worry about anything like managing keys, or storing salts or generating random numbers, you're doing it wrong.The reason is simple: it's so trivially easy to screw up bcrypt. In fact, if you look at almost every piece of code on this page, you'll notice that it's violating at least one of these common problems.Leave it for the experts. Leave it for people whose job it is to maintain these libraries. If you need to make a decision, you're doing it wrong.Instead, just use a library. Several exist depending on your requirements.Here is a breakdown of some of the more common APIs.Starting in PHP 5.5, a new API for hashing passwords is being introduced. There is also a shim compatibility library maintained (by me) for 5.3.7+. This has the benefit of being a peer-reviewed and simple to use implementation.Really, it's aimed to be extremely simple.Resources:This is another API that's similar to the PHP 5.5 one, and does a similar purpose. Resources:This is a slightly different approach to password hashing. Rather than simply supporting bcrypt, PasswordLib supports a large number of hashing algorithms. It's mainly useful in contexts where you need to support compatibility with legacy and disparate systems that may be outside of your control. It supports a large number of hashing algorithms. And is supported 5.3.2+References:This is a layer that does support bcrypt, but also supports a fairly strong algorithm that's useful if you do not have access to PHP >= 5.3.2... It actually supports PHP 3.0+ (although not with bcrypt).ResourcesNote: Don't use the PHPASS alternatives that are not hosted on openwall, they are different projects!!!If you notice, every one of these libraries returns a single string. That's because of how BCrypt works internally. And there are a TON of answers about that. Here are a selection that I've written, that I won't copy/paste here, but link to:There are many different choices. Which you choose is up to you. However, I would HIGHLY recommend that you use one of the above libraries for handling this for you. Again, if you're using crypt() directly, you're probably doing something wrong. If your code is using hash() (or md5() or sha1()) directly, you're almost definitely doing something wrong.Just use a library...You'll get a lot of information in Enough With The Rainbow Tables: What You Need To Know About Secure Password Schemes or Portable PHP password hashing framework.The goal is to hash the password with something slow, so someone getting your password database will die trying to brute force it (a 10 ms delay to check a password is nothing for you, a lot for someone trying to brute force it). Bcrypt is slow and can be used with a parameter to choose how slow it is.You can create a one-way hash with bcrypt using PHP's crypt() function and passing in an appropriate Blowfish salt. The most important of the whole equation is that A) the algorithm hasn't been compromised and B) you properly salt each password. Don't use an application-wide salt; that opens up your entire application to attack from a single set of Rainbow tables. PHP - Crypt FunctionEdit: 2013.01.15 - If your server will support it, use martinstoeckli's solution instead.Everyone wants to make this more complicated than it is. The crypt() function does most of the work.Example:I know it should be obvious, but please don't use 'password' as your password.Version 5.5 of PHP will have built-in support for BCrypt, the functions password_hash() and password_verify(). Actually these are just wrappers around the function crypt(), and shall make it easier to use it correctly. It takes care of the generation of a safe random salt, and provides good default values.The easiest way to use this functions will be:This code will hash the password with BCrypt (algorithm 2y), generates a random salt from the OS random source, and uses the default cost parameter (at the moment this is 10). The second line checks, if the user entered password matches an already stored hash-value.Should you want to change the cost parameter, you can do it like this, increasing the cost parameter by 1, doubles the needed time to calculate the hash value:In contrast to the "cost" parameter, it is best to omit the "salt" parameter, because the function already does its best to create a cryptographically safe salt.For PHP version 5.3.7 and later, there exists a compatibility pack, from the same author that made the password_hash() function. For PHP versions before 5.3.7 there is no support for crypt() with 2y, the unicode safe BCrypt algorithm. One could replace it instead with 2a, which is the best alternative for earlier PHP versions.An alternative is to use scrypt, specifically designed to be superior to bcrypt by Colin Percival in his paper. There is an scrypt PHP extension in PECL. Ideally this algorithm would be rolled into PHP so that it could be specified for the password_* functions (ideally as "PASSWORD_SCRYPT"), but that's not there yet.Current thinking: hashes should be the slowest available, not the fastest possible. This suppresses rainbow table attacks.Also related, but precautionary: An attacker should never have unlimited access to your login screen. To prevent that: Set up an IP address tracking table that records every hit along with the URI. If more than 5 attempts to login come from the same IP address in any five minute period, block with explanation. A secondary approach is to have a two-tiered password scheme, like banks do. Putting a lock-out for failures on the second pass boosts security.Summary: slow down the attacker by using time-consuming hash functions. Also, block on too many accesses to your login, and add a second password tier.For OAuth 2 passwords:As we all know storing password in clear text in database is not secure.

the bcrypt is a hashing password technique.It is used to built password security.

one of the amazing function of bcrypt is it save us from hackers it is used to protect the password from hacking attacks because the password is stored in bcrypted form.the password_hash() function is used to create a new password hash. It uses a strong & robust hashing algorithm.The password_hash() function is very much compatible with the crypt() function. Therefore, password hashes created by crypt() may be used with password_hash() and vice-versa. The functions password_verify() and password_hash() just the wrappers around the function crypt(), and they make it much easier to use it accurately.SYNTAXThe following algorithms are currently supported by password_hash() function:PASSWORD_DEFAULT

PASSWORD_BCRYPT

PASSWORD_ARGON2I

PASSWORD_ARGON2IDParameters: This function accepts three parameters as mentioned above and described below:password: It stores the password of the user.

algo: It is the password algorithm constant that is used continuously while denoting the algorithm which is to be used when the hashing of password takes place.

options: It is an associative array, which contains the options. If this is removed and doesn’t include, a random salt is going to be used, and the utilization of a default cost will happen.

Return Value: It returns the hashed password on success or False on failure.Example:Below programs illustrate the password_hash() function in PHP:OUTPUT

How do I make a redirect in PHP?

Sam

[How do I make a redirect in PHP?](https://stackoverflow.com/questions/768431/how-do-i-make-a-redirect-in-php)

Is it possible to redirect a user to a different page through the use of PHP?Say the user goes to www.example.com/page.php and I want to redirect them to www.example.com/index.php, how would I do so without the use of a meta refresh? Is it possible?This could even protect my pages from unauthorized users.

2009-04-20 14:13:22Z

Is it possible to redirect a user to a different page through the use of PHP?Say the user goes to www.example.com/page.php and I want to redirect them to www.example.com/index.php, how would I do so without the use of a meta refresh? Is it possible?This could even protect my pages from unauthorized users.Summary of existing answers plus my own two cents:You can use the header() function to send a new HTTP header, but this must be sent to the browser before any HTML or text (so before the <!DOCTYPE ...> declaration, for example).die() or exit()Why you should use die() or exit(): The Daily WTFAbsolute or relative URLSince June 2014 both absolute and relative URLs can be used. See RFC 7231 which had replaced the old RFC 2616, where only absolute URLs were allowed.Status CodesPHP's "Location"-header still uses the HTTP 302-redirect code, but this is not the one you should use. You should consider either 301 (permanent redirect) or 303 (other).Note: W3C mentions that the 303-header is incompatible with "many pre-HTTP/1.1 user agents. Currently used browsers are all HTTP/1.1 user agents. This is not true for many other user agents like spiders and robots.HTTP Headers and the header() function in PHPYou may use the alternative method of http_redirect($url); which needs the PECL package pecl to be installed.This function doesn't incorporate the 303 status code:This is more flexible:As mentioned header() redirects only work before anything is written out. They usually fail if invoked inmidst HTML output. Then you might use a HTML header workaround (not very professional!) like:Or a JavaScript redirect even.Use the header() function to send an HTTP Location header:Contrary to what some think, die() has nothing to do with redirection. Use it only if you want to redirect instead of normal execution.File example.php:Result of three executions:Resuming — obligatory die()/exit() is some urban legend that has nothing to do with actual PHP. It has nothing to do with client "respecting" the Location: header. Sending a header does not stop PHP execution, regardless of the client used.Don't forget to die()/exit()!Output JavaScript from PHP using echo, which will do the job.You can't really do it in PHP unless you buffer the page output and then later check for redirect condition. That might be too much of a hassle. Remember that headers are the first thing that is sent from the page. Most of the redirect is usually required later in the page. For that you have to buffer all the output of the page and check for redirect condition later. At that point you can either redirect page user header() or simply echo the buffered output.For more about buffering (advantages)What is output buffering?but if you use header function then some times you will get "warning

 like header already send" to resolve that do not echo or print before sending headers or you can simply use die() or exit() after header function. here you will not face any problem Most of these answers are forgetting a very important step!Leaving that vital second line out might see you end up on The Daily WTF. The problem is that browsers do not have to respect the headers which your page return, so with headers being ignored, the rest of the page will be executed without a redirect.Use:Or if you have already opened PHP tags, use this:You can also redirect to external pages, e.g.:Make sure you include  exit() or  include die().You can use session variables to control access to pages and authorize valid users as well:http://php.net/manual/en/reserved.variables.session.php.Recently, I got cyber attacks and decided, I needed to know the users trying to access the Admin Panel or reserved part of the web Application.So, I added a log access for the IP address and user sessions in a text file, because I don't want to bother my database.Many of these answers are correct, but they assume you have an absolute URL, which may not be the case. If you want to use a relative URL and generate the rest, then you can do something like this...header( 'Location: http://www.yoursite.com/new_page.html' );Use the following code: I've already answered this question, but I'll do it again since in the meanwhile I've learnt that there are special cases if you're running in CLI (redirects cannot happen and thus shouldn't exit()) or if your webserver is running PHP as a (F)CGI (it needs a previously set Status header to properly redirect).I've also handled the issue of supporting the different HTTP redirection codes (301, 302, 303 and 307), as it was addressed in the comments of my previous answer. Here are the descriptions:To redirect the visitor to another page (particularly useful in a conditional loop), simply use the following code:In this case, mypage.php is the address of the page to which you would like to redirect the visitors. This address can be absolute and may also include the parameters in this format: mypage.php?param1=val1&m2=val2)Relative/Absolute PathWhen dealing with relative or absolute paths, it is ideal to choose an absolute path from the root of the server (DOCUMENT_ROOT). Use the following format:If ever the target page is on another server, you include the full URL:HTTP HeadersAccording to HTTP protocol, HTTP headers must be sent before any type of content. This means that no characters should ever be sent before the header — not even an empty space!Temporary/Permanent RedirectionsBy default, the type of redirection presented above is a temporary one. This means that search engines, such as Google Search, will not take the redirection into account when indexing.If you would like to notify search engines that a page has been permanently moved to another location, use the following code:For example, this page has the following code:When you click on the link above, you are automatically redirected to this page. Moreover, it is a permanent redirection (Status: 301 Moved Permanently). So, if you type the first URL into Google, you will automatically be redirected to the second, redirected link.Interpretation of PHP CodeThe PHP code located after the header() will be interpreted by the server, even if the visitor moves to the address specified in the redirection. In most cases, this means that you need a method to follow the header() function of the exit() function in order to decrease the load of the server:Use:This is a regular and normal PHP redirect, but you can make a redirecting page with a few seconds wait by the below code:In the eve of the semantic web, correctness is something to consider. Unfortunately, PHP's "Location"-header still uses the HTTP 302-redirect code, which, strictly, isn't the best one for redirection. The one it should use instead, is the 303 one.W3C is kind enough to mention that the 303-header is incompatible with "many pre-HTTP/1.1 user agents," which would amount to no browser in current use. So, the 302 is a relic, which shouldn't be used....or you could just ignore it, as everyone else...You can use some JavaScript methods like belowYes, you can use the header() function,And also best practice is to call the exit() function right after the header() function to avoid the below code execution.According to the documentation, header() must be called before any actual output is sent.Like others here said, sending the location header with:but you need to do it before you've sent any other output to the browser.Also, if you're going to use this to block un-authenticated users from certain pages, like you mentioned, keep in mind that some user agents will ignore this and continue on the current page anyway, so you'll need to die() after you send it.Here are my thoughts:IMHO, the best way to redirect an incoming request would be by using location headers, which goesOnce this statement is executed, and output sent out, the browser will begin re-directing the user. However, ensure that there hasn't been any output (any echo / var_dump) before sending headers, else it will lead to errors.Although this is a quick-and-dirty way to achieve what was originally asked, it would eventually turn out to be an SEO disaster, as this kind of redirect is always interpreted as a 301 / 302 redirect, hence search engines will always see your index page as a re-directed page, and not something of a landing page / main page.Hence it will affect the SEO settings of the website.The best way to redirect with PHP is the following code...Make sure no code will work afterAll the code must be executed before the above line.Suppose,Case 1:It will redirect properly to the location (index.php).Case 2:The above code will not redirect to the location (index.php).Yes, it's possible to use PHP. We will redirect to another page.Try following code:We can do it in two ways:1. Using header, a built-in PHP functiona) Simple redirect without parametersb) Redirect with GET parameters2. Redirect with JavaScript in PHPa) Simple redirect without parametersb) Redirect with GET parametersUse:There are multiple ways of doing this, but if you’d prefer php, I’d recommend the use of the header() function.BasicallyIf you want to kick it up a notch, it’s best to use it in functions. That way, you are able to add authentications and other checking elemnts in it.Let’s try with by checking the user’s level.So, suppose you have stored the user’s authority level in a session called u_auth.In the function.phpYou’ll then call the function for every page that you want to authenticate.Like in page.php or any other page.References;If you're running on Apache you can also use .htaccess for redirect.You can attempt to use the PHP header function to do the redirect. You will want to set the output buffer so your browser doesn't throw a redirect warning to the screen.I like the kind of redirection over time.try this one

Difference between require, include, require_once and include_once?

Scott B

[Difference between require, include, require_once and include_once?](https://stackoverflow.com/questions/2418473/difference-between-require-include-require-once-and-include-once)

In PHP:

2010-03-10 16:13:25Z

In PHP:There are require and include_once as well.So your question should be... The answer to 1 is described here.The answer to 2 can be found here.UseBut basically, it's up to you when to use which.My suggestion is to just use require_once 99.9% of the time.Using require or include instead implies that your code is not reusable elsewhere, i.e. that the scripts you're pulling in actually execute code instead of making available a class or some function libraries.  If you are require/including code that executes on the spot, that's procedural code, and you need to get to know a new paradigm.  Like object oriented programming, function-based programming, or functional programming.If you're already doing OO or functional programming, using include_once is mostly going to be delaying where in the stack you find bugs/errors.  Do you want to know that the function do_cool_stuff() is not available when you go to call for it later, or the moment that you expect it to be available by requiring the library?  Generally, it's best to know immediately if something you need and expect isn't available, so just use require_once.Alternatively, in modern OOP, just autoload your classes upon use.Difference between _once functions and without _once functions:

without _once code will be included again whereas with _once functions PHP keeps track of the included files and will include it only once.Difference between require and include:

If a required file is not found PHP will emit a fatal error whereas for include only a warning will be emitted.include() will throw a warning if it can't include the file, but the rest of the script will run.require() will throw an E_COMPILE_ERROR and halt the script if it can't include the file.The include_once() and require_once() functions will not include the file a second time if it has already been included.See the following documentation pages:Whenever you are using require_once() can be use in a file to include another file when you need the called file only a single time in the current file. 

Here in the example I have an test1.php.and in another file that I have named test2.phpas you are watching the m requiring the the test1 file twice but the file will include the test1 once and for calling at the second time this will be ignored.  And without halting will display the output a single time.Whenever you are using 'include_once()` can be used in a file to include another file when you need the called file more than once in the current file. 

Here in the example I have a file named test3.php.And in another file that I have named test4.phpas you are watching the m including the test3 file will include the file a single time but halt the further execution.Use "include" for reusable PHP templates. Use "require" for required libraries."*_once" is nice, because it checks whether the file is already loaded or not, but it only makes sense for me in "require_once".You should keep class and function definitions organized in files.Use require_once() to load dependencies (classes, functions, constants).Use require() to load template-like files.Use include_once() to load optional dependencies (classes, functions, constants).Use include() to load optional template-like files.The difference is in the error the commands generate. With require, the file you want to use is really required and thus generates an E_ERROR if it is not found. include only generates an E_WARNING error if it fails which is more or less silent.So use it if the file is required to make the remaining code work and you want the script to fail the file is not available.For *_once():Same applies to require_once() of course.Reference: require(), include_once()This question was asked seven years ago, and none of answers provide  practical help for the question. In the modern PHP programming you mainly use required_once only once to include your autoloader class (composer autoloader often), and it will loads all of your classes and functions (functions files need to be explicitly added to composer.json file to be available in all other files). If for any reason your class is not loadable from autoloader you use require_once to load it.There are some occasions that we need to use require. For example, if you have a really big array definition and you don't want to add this to your class definition source code you can:If the file that you intend to include contains something executable or declares some variables you almost always need to use require, because if you use require_once apart from the first place your code will not be executed and/or your variables will not initiate silently, causing bugs that are absolutely hard to pinpoint.There is no practical use case for include and include_once really.With require the file must exist, if it doesn't then an error will display; whereas with include - if the file doesn't exist then then the page will continue loading.Require critical parts, like authorization and include all others.Multiple includes are just very bad design and must be avoided at all. So, *_once doesn't really matter.Include / Require you can include the same file more than once also:require_once / include_onceinclude() will generate a warning when it doesn't find a file, but require_once() will generate a fatal error.Another thing is if file is included before. Then require_once() will not include it again.From the manual:The same is true for the _once() variants.I was using function as below:There were constant values declared in xyz.php.I have to call this doSomething() function from another PHP script file.But I observed behavior while calling this function in a loop, for first iteration doSomething() was getting constant values within xyz.php, but later every iteration doSomething() was not able to get the constant values declared in xyz.php.I solved my problem by switching from require_once() to include(), updated doSomething() code is as below:Now every iteration call to doSomething() gets the constant values defined in xyz.php.In the age of PSR-0 / PSR-4 autoloaders, it may be completely unnecessary to use any of the statements if all you need is to make some functions / classes available to your code (of course, you still need to require_once autoloader itself in your bootstrap file and include templates if you still use PHP as a template engine).  If you are still confused, just use require_once for all time.They are all ways of including files.Require means it needs it. Require_once means it will need it but only requires it once. Include means it will include a file but it doesn’t need it to continue.Examples:There is also an include_once function which includes a file once.Don’t use capital letters where I have as I am typing from my phone.one thing I noticed, when using include I can only access the included files functions from the file that included it. With require_once, I can run that function in a second required_once file. also: I recommend adding Because when require_once kills the page, it can sometimes echo the directory of your website filesHere's a custom function I made to require files: usage example:Basically, if you require a wrong path, PHP throws a fatal error and the shutdown function is called, but when you include a wrong path, PHP will continue execution, but it will just display a warning that the file does not exist.From the English word require, PHP is told that the execution of the page or file depends on the file required.From my experience, it's norm to require important files such as configuration files, database classes and other important utilities.require has greater overhead than include, since it has to parse the file first. Replacing requires with includes is often a good optimization technique.Just use require and include.Because think how to work with include_once or require_once.

That is looking for log data which save included or required PHP files.

So that is slower than include and require.Just using like this...

How do I expire a PHP session after 30 minutes?

Tom

[How do I expire a PHP session after 30 minutes?](https://stackoverflow.com/questions/520237/how-do-i-expire-a-php-session-after-30-minutes)

I need to keep a session alive for 30 minutes and then destroy it. 

2009-02-06 13:14:14Z

I need to keep a session alive for 30 minutes and then destroy it. You should implement a session timeout of your own. Both options mentioned by others (session.gc_maxlifetime and session.cookie_lifetime) are not reliable. I'll explain the reasons for that.First:But the garbage collector is only started with a probability of session.gc_probability divided by session.gc_divisor. And using the default values for those options (1 and 100 respectively), the chance is only at 1%.Well, you could simply adjust these values so that the garbage collector is started more often. But when the garbage collector is started, it will check the validity for every registered session. And that is cost-intensive.Furthermore, when using PHP's default session.save_handler files, the session data is stored in files in a path specified in session.save_path. With that session handler, the age of the session data is calculated on the file's last modification date and not the last access date:So it additionally might occur that a session data file is deleted while the session itself is still considered as valid because the session data was not updated recently.And second:Yes, that's right. This only affects the cookie lifetime and the session itself may still be valid. But it's the server's task to invalidate a session, not the client. So this doesn't help anything. In fact, having session.cookie_lifetime set to 0 would make the session’s cookie a real session cookie that is only valid until the browser is closed.Conclusion / best solution:The best solution is to implement a session timeout of your own. Use a simple time stamp that denotes the time of the last activity (i.e. request) and update it with every request:Updating the session data with every request also changes the session file's modification date so that the session is not removed by the garbage collector prematurely.You can also use an additional time stamp to regenerate the session ID periodically to avoid attacks on sessions like session fixation:Notes:Note : if you want to change the time, just change the 30 with your desired time and do not change * 60: this will gives the minutes.In minutes : (30 * 60) 

In days : (n * 24 * 60 * 60 ) n = no of days  Is this to log the user out after a set time? Setting the session creation time (or an expiry time) when it is registered, and then checking that on each page load could handle that.E.g.:Edit: I've got a feeling you mean something else though.You can scrap sessions after a certain lifespan by using the session.gc_maxlifetime ini setting:Edit:

    ini_set('session.gc_maxlifetime', 60*30);This post shows a couple of ways of controlling the session timeout: http://bytes.com/topic/php/insights/889606-setting-timeout-php-sessionsIMHO the second option is a nice solution:Well i understand the aboves answers are correct but they are on application level, why don't we simply use .htaccess file to set the expire time ?Use the session_set_cookie_paramsfunciton for make this.Is necessary calling this function before session_start() call.Try this:See more in: http://php.net/manual/function.session-set-cookie-params.phpIt's actually easy with a function like the following. It uses database table name 'sessions' with fields 'id' and 'time'.Every time when the user visits your site or service again you should invoke this function to check if its return value is TRUE. If it's FALSE the user has expired and the session will be destroyed (Note: This function uses a database class to connect and query the database, of course you could also do it inside your function or something like that):Store a timestamp in the sessionNow, Check if the timestamp is within the allowed time window (1800 seconds is 30 minutes)Please use following block of code in your include file which loaded in every pages.Using timestamp...I have used 20 seconds to expire the session using timestamp. If you need 30 min add 1800 (30 min in seconds)...Use this class for 30 minYou can straight use a DB to do it as an alternative. I use a DB function to do it that I call chk_lgn. Check login checks to see if they are logged in or not and, in doing so, it sets the date time stamp of the check as last active in the user's db row/column.I also do the time check there. This works for me for the moment as I use this function for every page. P.S. No one I had seen had suggested a pure DB solution.Just Store the current time and If it exceeds 30 minutes by comparing then destroy the current session.

What are Long-Polling, Websockets, Server-Sent Events (SSE) and Comet?

user1437328

[What are Long-Polling, Websockets, Server-Sent Events (SSE) and Comet?](https://stackoverflow.com/questions/11077857/what-are-long-polling-websockets-server-sent-events-sse-and-comet)

I have tried reading some articles, but I am not very clear on the concepts yet.Would someone like to take a shot at explaining to me what these technologies are:One thing that I came across every time was, the server keeps a connection open and pushes data to the client. How is the connection kept open, and how does the client get the pushed data? (How does the client use the data, maybe some code might help?)Now, which one of them should I use for a real-time app. I have been hearing a lot about websockets (with socket.io [a node.js library]) but why not PHP?

2012-06-18 06:28:08Z

I have tried reading some articles, but I am not very clear on the concepts yet.Would someone like to take a shot at explaining to me what these technologies are:One thing that I came across every time was, the server keeps a connection open and pushes data to the client. How is the connection kept open, and how does the client get the pushed data? (How does the client use the data, maybe some code might help?)Now, which one of them should I use for a real-time app. I have been hearing a lot about websockets (with socket.io [a node.js library]) but why not PHP?In the examples below the client is the browser and the server is the webserver hosting the website.Before you can understand these technologies, you have to understand classic HTTP web traffic first.Comet is a collection of techniques prior to HTML5 which use streaming and long-polling to achieve real time applications. Read more on wikipedia or this article.You can use PHP with WebSockets, check out Ratchet. Tieme put a lot of effort into his excellent answer, but I think the core of the OPs question is how these technologies relate to PHP rather than how each technology works. PHP is the most used language in web development besides the obvious client side html, css, and javascript. Yet PHP has 2 major issues when it comes to real time applications: 1) PHP started as a very basic CGI. PHP has progressed very far since it's early stage, but it happened in small steps. PHP already had many millions of users by the time it became the embed-able and flexible C library that it is today, most of whom were dependent on it's earlier model of execution, so it hasn't yet made a solid attempt to escape the cgi model internally. Even the commandline interface invokes the PHP library (libphp5.so on linux, php5ts.dll on windows, etc) as if it still a cgi processing a GET/POST request. It still executes code as if it just has to build a "page" and then end it's life cycle. As a result, it has very little support for multi-thread or event driven programming (within PHP userspace), making it currently unpractical for real time, multi-user applications. Note that PHP does have extensions to provide event loops (such as libevent) and threads (such as pthreads) in PHP userspace, but very, very, few of the applications use these.2) PHP still has significant issues with garbage collection. Although these issues have been consistently improving (likely it's greatest step to end the life cycle as described above), even the best attempts at creating long running PHP applications require being restarted on a regular basis. This also make it unpractical for real time applications.PHP 7 will be a great step to fix these issues as well, and seems very promising as a platform for real-time applications. I have tried to make note about these and have collected and written examples from a java perspective.HTTP for Java DevelopersReverse Ajax - Old styleAsync Handling on server sideReverse Ajax - New styleServer Sent EventsPutting it here for any java developer who is looking into the same subject.You can easily use Node.JS in your web app only for real-time communication. Node.JS is really powerful when it's about WebSockets. Therefore "PHP Notifications via Node.js" would be a great concept.See this example:

Creating a Real-Time Chat App with PHP and Node.js

Get the full URL in PHP

DiegoP.

[Get the full URL in PHP](https://stackoverflow.com/questions/6768793/get-the-full-url-in-php)

I use this code to get the full URL:The problem is that I use some masks in my .htaccess, so what we see in the URL is not always the real path of the file.What I need is to get the URL, what is written in the URL, nothing more and nothing less—the full URL.I need to get how it appears in the Navigation Bar in the web browser, and not the real path of the file on the server.

2011-07-20 21:29:51Z

I use this code to get the full URL:The problem is that I use some masks in my .htaccess, so what we see in the URL is not always the real path of the file.What I need is to get the URL, what is written in the URL, nothing more and nothing less—the full URL.I need to get how it appears in the Navigation Bar in the web browser, and not the real path of the file on the server.Have a look at $_SERVER['REQUEST_URI'], i.e.(Note that the double quoted string syntax is perfectly correct)If you want to support both HTTP and HTTPS, you can useEditor's note: using this code has security implications. The client can set HTTP_HOST and REQUEST_URI to any arbitrary value it wants.Here are some more details about the issues and edge cases of the //example.com/path/ formatThis is a heavily modified version of http://snipplr.com/view.php?codeview&id=2734.scheme://username:password@domain:port/path?query_string#fragment_idThe parts in bold will not be included by the functionHTTP_HOST vs. SERVER_NAME

Is Port Number Required in HTTP "Host" Header Parameter?

https://stackoverflow.com/a/28049503/175071Examples for:  https://(www.)example.com/subFolder/myfile.php?var=blabla#555Notice!:Here's a solution using a ternary statement, keeping the code minimal:This is the smallest and easiest way to do this, assuming one's web server is using the standard port 443 for HTTPS.My favorite cross platform method for finding the current URL is:Simply use:Note: I just made an update to Timo Huovinen's code, so you won't get any GET parameters in the URL. This URL is plain and removes things like ?hi=i&am=a&get.Example:will be shown as:This is fine unless you use GET paramaters to define some specific content, in which case you should use his code! :-)Clear code, working in all webservers (Apache, nginx, IIS, ...):Here is my solution - code is inspired by Tracy Debugger. It was changed for support different server ports. You can get full current URL including $_SERVER['REQUEST_URI'] or just the basic server URL. Check my function:Here is test code:Use: If you want to support both HTTP and HTTPS:Same technique as the accepted answer, but with HTTPS support, and more readable:I've made this function to handle the URL:Use this one-liner to find the parent folder URL (if you have no access to http_build_url() that comes along with pecl_http):This is quite easy to do with your Apache environment variables. This only works with Apache 2, which I assume you are using.Simply use the following PHP code:Try this:$_SERVER is an array containing information such as headers, paths, and script locations. The entries in this array are created by the web server. There is no guarantee that every web server will provide any of these; servers may omit some, or provide others not listed here. That said, a large number of these variables are accounted for in the » CGI/1.1 specification, so you should be able to expect those.$HTTP_SERVER_VARS contains the same initial information, but is not a superglobal. (Note that $HTTP_SERVER_VARS and $_SERVER are different variables and that PHP handles them as such) You can use http_build_url with no arguments to get the full URL of the current page:I've made this class to handle my URI'sOf course you have to adapt it to your needs and system !?!It still needs to be perfected but it's a god solution for a centralized URI system :DThis is the solution for your problem:I used this statement.I hope this will help you.I have used the below code, and it is working fine for me, for both cases, HTTP and HTTPS.DemoHere is the basis of a more secure version of the accepted answer, using PHP's filter_input function, which also makes up for the potential lack of $_SERVER['REQUEST_URI']:You could use some different filters to tweak it to your liking.You can make use of HTTP_ORIGIN as illustrated in the snippet below:Very simple use:I think this method is good..try itThis works for both HTTP and HTTPS.Output something like this.For more: How to get the full URL of a page using PHP 

What is the difference between public, private, and protected?

Adam

[What is the difference between public, private, and protected?](https://stackoverflow.com/questions/4361553/what-is-the-difference-between-public-private-and-protected)

When and why should I use public, private, and protected functions and variables inside a class? What is the difference between them?Examples:

2010-12-05 22:13:14Z

When and why should I use public, private, and protected functions and variables inside a class? What is the difference between them?Examples:You use:More: (For comprehensive information)When you declare a method (function) or a property (variable) as public, those methods and properties can be accessed by:Example:When you declare a method (function) or a property (variable) as protected, those methods and properties can be accessed byOutsider members cannot access those variables. "Outsiders" in the sense that they are not object instances of the declared class itself.Example:The exact error will be this:When you declare a method (function) or a property (variable) as private, those methods and properties can be accessed by:Outsider members cannot access those variables. Outsiders in the sense that they are not object instances of the declared class itself and even the classes that inherit the declared class.Example:The exact error messages will be:This subject is not really out of scope, and I'm adding it here just to prove that reflection is really powerful. As I had stated in the above three examples, protected and private members (properties and methods) cannot be accessed outside of the class. However, with reflection you can do the extra-ordinary by even accessing protected and private members outside of the class!We have a class named Grandpas and say we have three properties. For easy understanding, consider there are three grandpas with names:Let us make them (assign modifiers) public, protected and private respectively. You know very well that protected and private members cannot be accessed outside the class. Now let's contradict the statement using reflection.Output:Please do not confuse with the below example. As you can still see, the private and protected members cannot be accessed outside of the class without using reflectionOutput:print_r, var_export and var_dump are debugger functions. They present information about a variable in a human-readable form. These three functions will reveal the protected and private properties of objects with PHP 5. Static class members will not be shown.It is typically considered good practice to default to the lowest visibility required as this promotes data encapsulation and good interface design. When considering member variable and method visibility think about the role the member plays in the interaction with other objects.If you "code to an interface rather than implementation" then it's usually pretty straightforward to make visibility decisions. In general, variables should be private or protected unless you have a good reason to expose them. Use public accessors (getters/setters) instead to limit and regulate access to a class's internals.To use a car as an analogy, things like speed, gear, and direction would be private instance variables. You don't want the driver to directly manipulate things like air/fuel ratio. Instead, you expose a limited number of actions as public methods. The interface to a car might include methods such as accelerate(), deccelerate()/brake(), setGear(), turnLeft(), turnRight(), etc.The driver doesn't know nor should he care how these actions are implemented by the car's internals, and exposing that functionality could be dangerous to the driver and others on the road. Hence the good practice of designing a public interface and encapsulating the data behind that interface.This approach also allows you to alter and improve the implementation of the public methods in your class without breaking the interface's contract with client code. For example, you could improve the accelerate() method to be more fuel efficient, yet the usage of that method would remain the same; client code would require no changes but still reap the benefits of your efficiency improvement.Edit: Since it seems you are still in the midst of learning object oriented concepts (which are much more difficult to master than any language's syntax), I highly recommend picking up a copy of PHP Objects, Patterns, and Practice by Matt Zandstra. This is the book that first taught me how to use OOP effectively, rather than just teaching me the syntax. I had learned the syntax years beforehand, but that was useless without understanding the "why" of OOP.private - can be accessed from WITHIN the class onlyprotected - can be accessed from WITHIN the class and INHERITING classespublic - can be accessed from code OUTSIDE the class as wellThis applies to functions as well as variables.The difference is as follows:Public :: A public variable or method can be accessed directly by any user of the class.Protected :: A protected variable or method cannot be accessed by users of the class but can be accessed inside a subclass that inherits from the class.Private :: A private variable or method can only be accessed internally from the class in which it is defined.This means that a private variable or method cannot be called from a child that extends the class.Visibility Scopes with Abstract Examples :: Makes easy UnderstandingThis visibility of a property or method is defined by pre-fixing declaration of one of three keyword (Public, protected and private)Public : If a property or method is defined as public, it means it can be both access and manipulated by anything that can refer to object.Protected : when a property or method visibility is set to protected members can only be access within the class itself and by inherited & inheriting classes. (Inherited:- a class can have all the properties and methods of another class).Private : When a property or method visibility is set to private, only the class that has the private members can access those methods and properties(Internally within the class), despite of whatever class relation there maybe.http://php.net/manual/en/language.oop5.visibility.phpPUBLIC:PROTECTED:PRIVATE:Read the Visibility of a method or variable on PHP Manual.Considering 'when':

I tend to declare everything as private initially, if I'm not exactly sure. Reason being, that it's usually much easier to turn a private method public than the other way round. That's because you can at least be sure that the private method hasn't been used anywhere but in the class itself. A public method may already be in use everywhere, possibly requiring an extensive re-write.Update: i go for a default of protected nowadays, because I've come to find that it's good enough for encapsulation and doesn't get in the way when I'm extending classes (which i try to avoid anyway). Only if i have a good reason to use the other two, i will.A good reason for a private method would be one that implements something inherent to that object that even an extending class should not change (factual reason, in addition to encapsulation, like internal state management). Eventually, it's still easy enough to track down where a protected method is being used usually, so i default to protected nowadays. Maybe not 100% objective "in the trenches" experience, I admit.PHP manual has a good read on the question here. For me, this is the most useful way to understand the three property types:Public: Use this when you are OK with this variable being directly accessed and changed from anywhere in your code. Example usage from outside of the class:Protected: Use this when you want to force other programmers (and yourself) to use getters/setters outside of the class when accessing and setting variables (but you should be consistent and use the getters and setters inside the class as well). This or private tend to be the default way you should set up all class properties. Why? Because if you decide at some point in the future (maybe even in like 5 minutes) that you want to manipulate the value that is returned for that property or do something with it before getting/setting, you can do that without refactoring everywhere you have used it in your project.Example usage from outside of the class:Private: private properties are very similar to protected properties. But the distinguishing feature/difference is that making it private also makes it inaccessible to child classes without using the parent class's getter or setter. So basically, if you are using getters and setters for a property (or if it is used only internally by the parent class and it isn't meant to be accessible anywhere else) you might as well make it private, just to prevent anyone from trying to use it directly and introducing bugs.Example usage inside a child class (that extends MyObject):They're there to allow for different levels of encapsulationVariables in PHP are cast in three different type:Public : values of this variable types are available in all scope and call on execution of you code.

declare as: public $examTimeTable;Private:  Values of this type of variable are only available on only to the class it belongs to.

 private $classRoomComputers;Protected: Values of this class only and only available when Access been granted in a form of inheritance or their child class. generally used :: to grant access by parent classprotected $familyWealth;Reviving an old question, but I think a really good way to think of this is in terms of the API that you are defining.Or in Semver terms:So in terms of maintaining code, its good to be careful about what things you make public or protected because these are the things you are promising to your users.When we follow object oriented php in our project , we should follow some rules to use access modifiers in php. Today we are going to learn clearly what is access modifier and how can we use it.PHP access modifiers are used to set access rights with PHP classes and their members that are the functions and variables defined within the class scope. In php there are three scopes for class members.Now, let us have a look at the following image to understand access modifier access level

Now, let us have a look at the following list to know about the possible PHP keywords used as access modifiers.public :- class or its members defined with this access modifier will be publicly accessible from anywhere, even from outside the scope of the class.private :- class members with this keyword will be accessed within the class itself. we can’t access private data from subclass. It protects members from outside class access.protected :- same as private, except by allowing subclasses to access protected superclass members.Now see the table to understand access modifier Read full article php access modifirePublic: is a default state when you declare a variable or method, can be accessed by anything directly to the object.Protected: Can be accessed only within the object and subclasses.Private: Can be referenced only within the object, not subclasses.The mentioned keywords are access modifiers and help us implement Encapsulation (or information hiding). They tell the compiler which other classes should have access to the field or method being defined.private - Only the current class will have access to the field or method.protected - Only the current class and subclasses (and sometimes also same-package classes) of this class will have access to the field or method.public - Any class can refer to the field or call the method.

mysql_fetch_array()/mysql_fetch_assoc()/mysql_fetch_row()/mysql_num_rows etc… expects parameter 1 to be resource or result

iamjonesy

[mysql_fetch_array()/mysql_fetch_assoc()/mysql_fetch_row()/mysql_num_rows etc… expects parameter 1 to be resource or result](https://stackoverflow.com/questions/2973202/mysql-fetch-array-mysql-fetch-assoc-mysql-fetch-row-mysql-num-rows-etc)

I am trying to select data from a MySQL table, but I get one of the following error messages:ororThis is my code:The same applies to code like andand and and

2010-06-04 10:18:08Z

I am trying to select data from a MySQL table, but I get one of the following error messages:ororThis is my code:The same applies to code like andand and andA query may fail for various reasons in which case both the mysql_* and the mysqli extension will return false from their respective query functions/methods. You need to test for that error condition and handle it accordingly.mysql_* extension:Check $result before passing it to mysql_fetch_array. You'll find that it's false because the query failed. See the mysql_query documentation for possible return values and suggestions for how to deal with them.mysqli extension

procedural style:oo-style:  using a prepared statement:These examples only illustrate what should be done (error handling), not how to do it. Production code shouldn't use or die when outputting HTML, else it will (at the very least) generate invalid HTML. Also, database error messages shouldn't be displayed to non-admin users, as it discloses too much information.This error message is displayed when you have an error in your query which caused it to fail. It will manifest itself when using:Note: This error does not appear if no rows are affected by your query. Only a query with an invalid syntax will generate this error.Troubleshooting StepsOther tipsmysql_* functions should not be used for new code. They are no longer maintained and the community has begun the deprecation process.  Instead you should learn about prepared statements and use either PDO or MySQLi. If you can't decide, this article will help to choose. If you care to learn, here is good PDO tutorial.Error occurred here was due to the use of single quotes ('). You can put your query like this:It's using mysql_real_escape_string for prevention of SQL injection. 

Though we should use MySQLi or PDO_MYSQL extension for upgraded version of PHP (PHP 5.5.0 and later), but for older versions mysql_real_escape_string will do the trick.As scompt.com explained, the query might fail. Use this code the get the error of the query or the correct result:See the documentation for mysql_query() for further information.The actual error was the single quotes so that the variable $username was not parsed. But you should really use mysql_real_escape_string($username) to avoid SQL injections.Put quotes around $username. String values, as opposed to numeric values, must be enclosed in quotes.Also, there is no point in using the LIKE condition if you're not using wildcards: if you need an exact match use = instead of LIKE.Please check once the database selected are not because some times database is not selectedCheck before MySQL query

and then go to next step Your code should be something like thisOnce done with that, you would get the query printed on the screen. Try this query on your server and see if it produces the desired results. Most of the times the error is in the query. Rest of the code is correct.You define the string using single quotes and PHP does not parse single quote delimited strings. In order to obtain variable interpolation you will need to use double quotes OR string concatenation (or a combination there of). See http://php.net/manual/en/language.types.string.php for more information.Also you should check that mysql_query returned a valid result resource, otherwise fetch_*, num_rows, etc will not work on the result as is not a result! IE:http://us.php.net/manual/en/function.mysql-query.php for more information.This query should work:The problem is single quotes, thus your query fails and returns FALSE and your WHILE loop can't execute. Using % allows you to match any results containing your string (such as SomeText-$username-SomeText).This is simply an answer to your question, you should implement stuff  mentioned in the other posts: error handling, use escape strings (users can type anything into the field, and you MUST make sure it is not arbitrary code), use PDO instead mysql_connect which is now depricated.Sometimes suppressing the query as @mysql_query(your query);If you tried everything here, and it does not work, you might want to check your MySQL database collation. Mine was set to to a Swedish collation. Then I changed it to utf8_general_ci and everything just clicked into gear.Instead of using a WHERE query, you can use this ORDER BY query. It's far better than this for use of a query.I have done this query and am getting no errors like parameter or boolean.Try this, it must be work, otherwise you need to print the error to specify your problemThere might be two reasons:Thirdly, the structure of query is prone to SQL injection. You may use prepared statements to avoid this security threat.Try the following code. It may work fine.Go to your config.php. I had the same problem. Verify the username and the password, and also sql select is the same name as the config.Don't use the depricated mysql_* function (depricated in php 5.5 will be removed in php 7). and you can make this with mysqli or pdohere is the complete select query And if there is a user with a unique user name, you can use "=" for that. There is no need to like.Your query will be:Include a connection string variable before the MySQL query. For example, $connt in this code:Any time you get the......it is likely because there is an issue with your query. The prepare() or query() might return FALSE (a Boolean), but this generic failure message doesn't leave you much in the way of clues. How do you find out what is wrong with your query? You ask!First of all, make sure error reporting is turned on and visible: add these two lines to the top of your file(s) right after your opening <?php tag:If your error reporting has been set in the php.ini you won't have to worry about this. Just make sure you handle errors gracefully and never reveal the true cause of any issues to your users. Revealing the true cause to the public can be a gold engraved invitation for those wanting to harm your sites and servers. If you do not want to send errors to the browser you can always monitor your web server error logs. Log locations will vary from server to server e.g., on Ubuntu the error log is typically located at /var/log/apache2/error.log. If you're examining error logs in a Linux environment you can use tail -f /path/to/log in a console window to see errors as they occur in real-time....or as you make them.Once you're squared away on standard error reporting adding error checking on your database connection and queries will give you much more detail about the problems going on. Have a look at this example where the column name is incorrect. First, the code which returns the generic fatal error message:The error is generic and not very helpful to you in solving what is going on.With a couple of more lines of code you can get very detailed information which you can use to solve the issue immediately. Check the prepare() statement for truthiness and if it is good you can proceed on to binding and executing.If something is wrong you can spit out an error message which takes you directly to the issue. In this case, there is no foo column in the table, solving the problem is trivial.If you choose, you can include this checking in a function or class and extend it by handling the errors gracefully as mentioned previously.Try ThisFirst, check your connection to the database. Is it connected successfully or not?If it's done, then after that I have written this code, and it works well:If you're using multiple queries in a script even you're including other pages which contains queries or database connection, then it might be possible that at any place you use db_close() that would close your database connection so make sure you're not doing this mistake in your scripts.If you don't have any MySQL Error appearing while checking, make sure that you properly created your database table. This happened to me. Look for any unwanted commas or quotes. Check your connection first.Then if you want to fetch the exact value from the database then you should write:Or you want to fetch the LIKE type of value then you should write:You can also check  wether $result is failing like so, before executing the fetch array  Usually an error occurs when your database conectivity fails, so be sure to connect your database or to include the database file.ORTry this code it work fine assign the post  variable to the variable      since $username is a php variable we need to pass it as string to mysqli so since in the query u started with a single quote we will use the double quote, single quote and a fullstop for the concatination purposes ("'.$username.'") if you started  with a double quote you would then reverse the quotes ('".$username."').but use of Mysql has depreciated much, use PDO instead.it is simple but very secure

How do I implement basic「Long Polling」?

dbr

[How do I implement basic「Long Polling」?](https://stackoverflow.com/questions/333664/how-do-i-implement-basic-long-polling)

I can find lots of information on how Long Polling works (For example, this, and this), but no simple examples of how to implement this in code.All I can find is cometd, which relies on the Dojo JS framework, and a fairly complex server system..Basically, how would I use Apache to serve the requests, and how would I write a simple script (say, in PHP) which would "long-poll" the server for new messages?The example doesn't have to be scaleable, secure or complete, it just needs to work!

2008-12-02 11:14:47Z

I can find lots of information on how Long Polling works (For example, this, and this), but no simple examples of how to implement this in code.All I can find is cometd, which relies on the Dojo JS framework, and a fairly complex server system..Basically, how would I use Apache to serve the requests, and how would I write a simple script (say, in PHP) which would "long-poll" the server for new messages?The example doesn't have to be scaleable, secure or complete, it just needs to work!It's simpler than I initially thought.. Basically you have a page that does nothing, until the data you want to send is available (say, a new message arrives).Here is a really basic example, which sends a simple string after 2-10 seconds. 1 in 3 chance of returning an error 404 (to show error handling in the coming Javascript example)msgsrv.phpNote: With a real site, running this on a regular web-server like Apache will quickly tie up all the "worker threads" and leave it unable to respond to other requests.. There are ways around this, but it is recommended to write a "long-poll server" in something like Python's twisted, which does not rely on one thread per request. cometD is an popular one (which is available in several languages), and Tornado is a new framework made specifically for such tasks (it was built for FriendFeed's long-polling code)... but as a simple example, Apache is more than adequate! This script could easily be written in any language (I chose Apache/PHP as they are very common, and I happened to be running them locally)Then, in Javascript, you request the above file (msg_srv.php), and wait for a response.  When you get one, you act upon the data. Then you request the file and wait again, act upon the data (and repeat)What follows is an example of such a page.. When the page is loaded, it sends the initial request for the msgsrv.php file.. If it succeeds, we append the message to the #messages div, then after 1 second we call the waitForMsg function again, which triggers the wait.The 1 second setTimeout() is a really basic rate-limiter, it works fine without this, but if msgsrv.php always returns instantly (with a syntax error, for example) - you flood the browser and it can quickly freeze up. This would better be done checking if the file contains a valid JSON response, and/or keeping a running total of requests-per-minute/second, and pausing appropriately.If the page errors, it appends the error to the #messages div, waits 15 seconds and then tries again (identical to how we wait 1 second after each message)The nice thing about this approach is it is very resilient. If the clients internet connection dies, it will timeout, then try and reconnect - this is inherent in how long polling works, no complicated error-handling is requiredAnyway, the long_poller.htm code, using the jQuery framework:I've got a really simple chat example as part of slosh.Edit: (since everyone's pasting their code in here)This is the complete JSON-based multi-user chat using long-polling and slosh.  This is a demo of how to do the calls, so please ignore the XSS problems.  Nobody should deploy this without sanitizing it first.Notice that the client always has a connection to the server, and as soon as anyone sends a message, everyone should see it roughly instantly.Tornado is designed for long-polling, and includes a very minimal (few hundred lines of Python) chat app in /examples/chatdemo , including server code and JS client code. It works like this:I think the client looks like a normal asynchronous AJAX request, but you expect it to take a "long time" to come back.The server then looks like this.So, the AJAX request goes to the server, probably including a timestamp of when it was last update so that your hasNewData() knows what data you have already got.

The server then sits in a loop sleeping until new data is available.  All the while, your AJAX request is still connected, just hanging there waiting for data.

Finally, when new data is available, the server gives it to your AJAX request and closes the connection.Here are some classes I use for long-polling in C#. There are basically 6 classes (see below).This is a nice 5-minute screencast on how to do long polling using PHP & jQuery:

http://screenr.com/SNHCode is quite similar to dbr's example above.Here is a simple long-polling example in PHP by Erik Dubbelboer using the Content-type: multipart/x-mixed-replace header:And here is a demo:http://dubbelboer.com/multipart.phpI used this to get to grips with Comet, I have also set up Comet using the Java Glassfish server and found lots of other examples by subscribing to cometdaily.comTake a look at this blog post which has code for a simple chat app in Python/Django/gevent.Below is a long polling solution I have developed for Inform8 Web. Basically you override the class and implement the loadData method. When the loadData returns a value or the operation times out it will print the result and return. If the processing of your script may take longer than 30 seconds you may need to alter the set_time_limit() call to something longer.Apache 2.0 license. Latest version on github 

https://github.com/ryanhend/Inform8/blob/master/Inform8-web/src/config/lib/Inform8/longpoll/LongPoller.phpRyanThanks for the code, dbr. Just a small typo in long_poller.htm around the lineI think it should befor it to work.For those interested, I tried a Django equivalent. Start a new Django project, say lp for long polling:Call the app msgsrv for message server:Add the following lines to settings.py to have a templates directory:Define your URL patterns in urls.py as such:And msgsrv/views.py should look like:Lastly, templates/long_poller.htm should be the same as above with typo corrected. Hope this helps.This is one of the scenarios that PHP is a very bad choice for. As previously mentioned, you can tie up all of your Apache workers very quickly doing something like this. PHP is built for start, execute, stop. It's not built for start, wait...execute, stop. You'll bog down your server very quickly and find that you have incredible scaling problems.That said, you can still do this with PHP and have it not kill your server using the nginx HttpPushStreamModule: http://wiki.nginx.org/HttpPushStreamModuleYou setup nginx in front of Apache (or whatever else) and it will take care of holding open the concurrent connections. You just respond with payload by sending data to an internal address which you could do with a background job or just have the messages fired off to people that were waiting whenever the new requests come in. This keeps PHP processes from sitting open during long polling.This is not exclusive to PHP and can be done using nginx with any backend language. The concurrent open connections load is equal to Node.js so the biggest perk is that it gets you out of NEEDING Node for something like this. You see a lot of other people mentioning other language libraries for accomplishing long polling and that's with good reason. PHP is just not well built for this type of behavior naturally.Why not consider the web sockets instead of long polling? They are much efficient and easy to setup. However they are supported only in modern browsers. Here is a quick reference.The WS-I group published something called "Reliable Secure Profile" that has a Glass Fish and .NET implementation that apparently inter-operate well.With any luck there is a Javascript implementation out there as well.There is also a Silverlight implementation that uses HTTP Duplex.  You can connect javascript to the Silverlight object to get callbacks when a push occurs.There are also commercial paid versions as well.For a ASP.NET MVC implementation, look at SignalR which is available on NuGet.. note that the NuGet is often out of date from the Git source which gets very frequent commits.Read more about SignalR on a blog on by Scott Hanselman You can try icomet(https://github.com/ideawu/icomet), a C1000K C++ comet server built with libevent. icomet also provides a JavaScript library, it is easy to use as simple asicomet supports a wide range of Browsers and OSes, including Safari(iOS, Mac), IEs(Windows), Firefox, Chrome, etc. Simplest NodeJSProduction wise scenario in Express for exmaple you would get response in the middleware. Do you what you need to do, can scope out all of the long polled methods to Map or something (that is visible to other flows), and invoke <Response> response.end() whenever you are ready. There is nothing special about long polled connections. Rest is just how you normally structure your application.If you dont know what i mean by scoping out, this should give you ideaAs you see, you could really respond to all connections, one, do whatever you want. There is id for every request so you should be able to use map and access specific out of api call.

Remove empty array elements

Will

[Remove empty array elements](https://stackoverflow.com/questions/3654295/remove-empty-array-elements)

Some elements in my array are empty strings based on what the user has submitted. I need to remove those elements. I have this:But it doesn't work. $linksArray still has empty elements. I have also tried doing it with the empty() function, but the outcome is the same.

2010-09-06 21:06:57Z

Some elements in my array are empty strings based on what the user has submitted. I need to remove those elements. I have this:But it doesn't work. $linksArray still has empty elements. I have also tried doing it with the empty() function, but the outcome is the same.As you're dealing with an array of strings, you can simply use array_filter(), which conveniently handles all this for you:Keep in mind that if no callback is supplied, all entries of array equal to FALSE (see converting to boolean) will be removed. So if you need to preserve elements that are i.e. exact string '0', you will need a custom callback:You can use array_filter to remove empty elements:If you have (int) 0 in your array, you may use the following:EDIT: Maybe your elements are not empty per se but contain one or more spaces... You can use the following before using array_filterThe most popular answer on this topic is absolutely INCORRECT.Consider the following PHP script:Why is this?  Because a string containing a single '0' character also evaluates to boolean false, so even though it's not an empty string, it will still get filtered.  That would be a bug.Passing the built-in strlen function as the filtering function will work, because it returns a non-zero integer for a non-empty string, and a zero integer for an empty string.  Non-zero integers always evaluate to true when converted to boolean, while zero integers always evaluate to false when converted to boolean.So, the absolute, definitive, correct answer is:"If no callback is supplied, all entries of input equal to FALSE will be removed." -- http://php.net/manual/en/function.array-filter.phpYou can just doarray_filter: "If no callback is supplied, all entries of input equal to FALSE will be removed." This means that elements with values NULL, 0, '0', '', FALSE, array() will be removed too.The other option is doingwhich will remove elements with values NULL, '' and FALSE.Hope this helps :)Here is an example.To sum up:Another one liner to remove empty ("" empty string) elements from your array.Note: This code deliberately keeps null, 0 and false elements.Or maybe you want to trim your array elements first:Note: This code also removes null and false elements.This is my suggested code:I thinks use array_filter is good, but not enough, because values be like space and \n,... keep in the array and this is usually bad.So I suggest you use mixture ‍‍array_filter and array_map.array_map is for trimming, array_filter is for remove empty values, strlen is for keep 0 value, and array_values is for re indexing if you needed.http://phpio.net/s/5yg0If you are working with a numerical array and need to re-index the array after removing empty elements, use the array_values function:Also see: PHP reindex array?The most voted answer is wrong or at least not completely true as the OP is talking about blank strings only. Here's a thorough explanation:First of all, we must agree on what empty means. Do you mean to filter out:To filter out empty strings only:To only filter out strictly false values, you must use a callback function:The callback is also useful for any combination in which you want to filter out the "falsey" values, except some. (For example, filter every null and false, etc, leaving only 0):Third and fourth case are (for our purposes at last) equivalent, and for that all you have to use is the default:I had to do this in order to keep an array value of (string) 0For multidimensional array I use the following script to remove empty elements from an arrayJust want to contribute an alternative to loops...also addressing gaps in keys...In my case I wanted to keep sequential array keys when the operation was complete (not just odd numbers, which is what I was staring at. Setting up code to look just for odd keys seemed fragile to me and not future-friendly.)I was looking for something more like this: http://gotofritz.net/blog/howto/removing-empty-array-elements-php/The combination of array_filter and array_slice does the trick.

$example = array_filter($example);

$example = array_slice($example,0);No idea on efficiencies or benchmarks but it works.outputuse array_filter function to remove empty values:Just one line :

Update (thanks to @suther):Remove empty array elements¡it works!As per your method, you can just catch those elements in an another array and use that one like follows,try this ** 

**ExampleWith these types of things, it's much better to be explicit about what you want and do not want.It will help the next guy to not get caught by surprise at the behaviour of array_filter() without a callback. For example, I ended up on this question because I forgot if array_filter() removes NULL or not. I wasted time when I could have just used the solution below and had my answer.Also, the logic is language angnostic in the sense that the code can be copied into another language without having to under stand the behaviour of a php function like array_filter when no callback is passed.In my solution, it is clear at glance as to what is happening. Remove a conditional to keep something or add a new condition to filter additional values.Disregard the actual use of array_filter() since I am just passing it a custom callback - you could go ahead and extract that out to its own function if you wanted. I am just using it as sugar for a foreach loop.Another benefit of this approach is that you can break apart the filtering predicates into an abstract function that filters a single value per array and build up to a composable solution.See this example and the inline comments for the output.Now you can dynamically create a function called filterer() using pipe() that will apply these partially applied functions for you.I think array_walk is much more suitable hereAs for False it's ok to remove it, because AFAIK the user can't submit boolean values.

What is thread safe or non-thread safe in PHP?

O..

[What is thread safe or non-thread safe in PHP?](https://stackoverflow.com/questions/1623914/what-is-thread-safe-or-non-thread-safe-in-php)

I saw different binaries for PHP, like non-thread or thread safe? What does this mean? What is the difference between these packages?

2009-10-26 09:41:33Z

I saw different binaries for PHP, like non-thread or thread safe? What does this mean? What is the difference between these packages?Different web servers implement different techniques for handling incoming HTTP requests in parallel. A pretty popular technique is using threads -- that is, the web server will create/dedicate a single thread for each incoming request. The Apache HTTP web server supports multiple models for handling requests, one of which (called the worker MPM) uses threads. But it supports another concurrency model called the prefork MPM which uses processes -- that is, the web server will create/dedicate a single process for each request.There are also other completely different concurrency models (using Asynchronous sockets and I/O), as well as ones that mix two or even three models together. For the purpose of answering this question, we are only concerned with the two models above, and taking Apache HTTP server as an example.PHP itself does not respond to the actual HTTP requests -- this is the job of the web server. So we configure the web server to forward requests to PHP for processing, then receive the result and send it back to the user. There are multiple ways to chain the web server with PHP. For Apache HTTP Server, the most popular is "mod_php". This module is actually PHP itself, but compiled as a module for the web server, and so it gets loaded right inside it.There are other methods for chaining PHP with Apache and other web servers, but mod_php is the most popular one and will also serve for answering your question.You may not have needed to understand these details before, because hosting companies and GNU/Linux distros come with everything prepared for us.Since with mod_php, PHP gets loaded right into Apache, if Apache is going to handle concurrency using its Worker MPM (that is, using Threads) then PHP must be able to operate within this same multi-threaded environment -- meaning, PHP has to be thread-safe to be able to play ball correctly with Apache!At this point, you should be thinking "OK, so if I'm using a multi-threaded web server and I'm going to embed PHP right into it, then I must use the thread-safe version of PHP". And this would be correct thinking. However, as it happens, PHP's thread-safety is highly disputed. It's a use-if-you-really-really-know-what-you-are-doing ground.In case you are wondering, my personal advice would be to not use PHP in a multi-threaded environment if you have the choice!Speaking only of Unix-based environments, I'd say that fortunately, you only have to think of this if you are going to use PHP with Apache web server, in which case you are advised to go with the prefork MPM of Apache (which doesn't use threads, and therefore, PHP thread-safety doesn't matter) and all GNU/Linux distributions that I know of will take that decision for you when you are installing Apache + PHP through their package system, without even prompting you for a choice. If you are going to use other webservers such as nginx or lighttpd, you won't have the option to embed PHP into them anyway. You will be looking at using FastCGI or something equal which works in a different model where PHP is totally outside of the web server with multiple PHP processes used for answering requests through e.g. FastCGI. For such cases, thread-safety also doesn't matter. To see which version your website is using put a file containing <?php phpinfo(); ?> on your site and look for the Server API entry. This could say something like CGI/FastCGI or Apache 2.0 Handler.If you also look at the command-line version of PHP -- thread safety does not matter.Finally, if thread-safety doesn't matter so which version should you use -- the thread-safe or the non-thread-safe? Frankly, I don't have a scientific answer! But I'd guess that the non-thread-safe version is faster and/or less buggy, or otherwise they would have just offered the thread-safe version and not bothered to give us the choice!For me, I always choose non-thread safe version because I always use nginx, or run PHP from the command line.The non-thread safe version should be used if you install PHP as a CGI binary, command line interface or other environment where only a single thread is used.A thread-safe version should be used if you install PHP as an Apache module in a worker MPM (multi-processing model) or other environment where multiple PHP threads run concurrently.Apache MPM prefork with modphp is used because it is easy to configure/install. Performance-wise it is fairly inefficient. My preferred way to do the stack, FastCGI/PHP-FPM. That way you can use the much faster MPM Worker. The whole PHP remains non-threaded, but Apache serves threaded (like it should).So basically, from bottom to topLinuxApache + MPM Worker + ModFastCGI (NOT FCGI) |(or)| Cherokee |(or)| NginxPHP-FPM + APCModFCGI does not correctly support PHP-FPM, or any external FastCGI applications. It only supports non-process managed FastCGI scripts. PHP-FPM is the PHP FastCGI process manager.As per PHP Documentation,Following Libraries are not thread safe. They are not recommended for use in a multi-threaded environment.

Get first key in a (possibly) associative array?

Alex S

[Get first key in a (possibly) associative array?](https://stackoverflow.com/questions/1028668/get-first-key-in-a-possibly-associative-array)

What's the best way to determine the first key in a possibly associative array? My first thought it to just foreach the array and then immediately breaking it, like this:Thus having $key contain the first key, but this seems inefficient. Does anyone have a better solution?

2009-06-22 18:13:59Z

What's the best way to determine the first key in a possibly associative array? My first thought it to just foreach the array and then immediately breaking it, like this:Thus having $key contain the first key, but this seems inefficient. Does anyone have a better solution?Starting from PHP 7.3, there is a new built in function called array_key_first() which will retrieve the first key from the given array without resetting the internal pointer. Check out the documentation for more info.You can use reset and key:It's essentially the same as your initial code, but with a little less overhead, and it's more obvious what is happening.Just remember to call reset, or you may get any of the keys in the array. You can also use end instead of reset to get the last key.If you wanted the key to get the first value, reset actually returns it:There is one special case to watch out for though (so check the length of the array first):array_keys returns an array of keys. Take the first entry. Alternatively, you could call reset on the array, and subsequently key. The latter approach is probably slightly faster (Thoug I didn't test it), but it has the side effect of resetting the internal pointer.Interestingly enough, the foreach loop is actually the most efficient way of doing this.Since the OP specifically asked about efficiency, it should be pointed out that all the current answers are in fact much less efficient than a foreach.I did a benchmark on this with php 5.4, and the reset/key pointer method (accepted answer) seems to be about 7 times slower than a foreach. Other approaches manipulating the entire array (array_keys, array_flip) are obviously even slower than that and become much worse when working with a large array.Foreach is not inefficient at all, feel free to use it!Edit 2015-03-03:Benchmark scripts have been requested, I don't have the original ones but made some new tests instead. This time I found the foreach only about twice as fast as reset/key. I used a 100-key array and ran each method a million times to get some noticeable difference, here's code of the simple benchmark:On my php 5.5 this outputs:reset+key http://3v4l.org/b4DrN/perf#tabs

foreach http://3v4l.org/gRoGD/perf#tabskey($an_array) will give you the first keyedit per Blixt: you should call reset($array); before key($an_array) to reset the pointer to the beginning of the array.You could tryFor 2018+

Starting with PHP 7.3, there is an array_key_first() function that achieve exactly this:

Documentation is available here. 😉If efficiency is not that important for you, you can use array_keys($yourArray)[0] in PHP 5.4 (and higher).Examples:The advantage over solution: is that you can pass array_keys($arr)[0] as a function parameter (i.e. doSomething(array_keys($arr)[0], $otherParameter)).HTHPlease find the following:Working Example:This could also be a solution.I have tested it and it works.Working Code:To enhance on the solution of Webmut, I've added the following solution:The output for me on PHP 7.1 is:If I do this for an array of size 10000, then the results becomeThe array_keys method times out at 30 seconds (with only 1000 elements, the timing for the rest was about the same, but the array_keys method had about 7.5 seconds).The best way that worked for me was array_keys  gets array of keys from initial array and then array_shift cuts from it first element value.

You will need PHP 5.4+ for this.This is the easier way I had ever found. Fast and only two lines of code :-Dphp73:http://php.net/manual/en/function.array-key-first.phpA one-liner:Today I had to search for the first key of my array returned by a POST request. (And note the number for a form id etc)Well, I've found this:

Return first key of associative array in PHPhttp://php.net/keyI've done this, and it work.Maybe it will eco 15min of an other guy.

CYA.You can play with your arrayTo get the first element of array you can use current and for last element you can use endEditJust for the sake for not getting any more down votes for the answer you can convert you key to value using array_keys and use as shown above.

How do I send a POST request with PHP?

Fred Tanrikut

[How do I send a POST request with PHP?](https://stackoverflow.com/questions/5647461/how-do-i-send-a-post-request-with-php)

Actually I want to read the contents that come after the search query, when it is done. The problem is that the URL only accepts POST methods, and it does not take any action with GET method...I have to read all contents with the help of domdocument or file_get_contents(). Is there any method that will let me send parameters with POST method and then read the contents via PHP?

2011-04-13 10:06:00Z

Actually I want to read the contents that come after the search query, when it is done. The problem is that the URL only accepts POST methods, and it does not take any action with GET method...I have to read all contents with the help of domdocument or file_get_contents(). Is there any method that will let me send parameters with POST method and then read the contents via PHP?CURL-less method with PHP5:See the PHP manual for more information on the method and how to add headers, for example:You could use cURL:I use the following function to post data using curl. $data is an array of fields to post (will be correctly encoded using http_build_query). The data is encoded using application/x-www-form-urlencoded.@Edward mentions that http_build_query may be omitted since curl will correctly encode array passed to CURLOPT_POSTFIELDS parameter, but be advised that in this case the data will be encoded using multipart/form-data.I use this function with APIs that expect data to be encoded using application/x-www-form-urlencoded. That's why I use http_build_query().I recommend you to use the open-source package guzzle that is fully unit tested and uses the latest coding practices.Installing GuzzleGo to the command line in your project folder and type in the following command (assuming you already have the package manager composer installed). If you need help how to install Composer, you should have a look here.Using Guzzle to send a POST requestThe usage of Guzzle is very straight forward as it uses a light-weight object-oriented API:There's another CURL method if you are going that way.This is pretty straightforward once you get your head around the way the PHP curl extension works, combining various flags with setopt() calls. In this example I've got a variable $xml which holds the XML I have prepared to send - I'm going to post the contents of that to example's test method.First we initialised the connection, then we set some options using setopt(). These tell PHP that we are making a post request, and that we are sending some data with it, supplying the data. The CURLOPT_RETURNTRANSFER flag tells curl to give us the output as the return value of curl_exec rather than outputting it. Then we make the call and close the connection - the result is in $response.If you by any chance are using Wordpress to develop your app (it's actually a convenient way to get authorization, info pages etc even for very simple stuff), you can use the following snippet:It uses different ways of making the actual HTTP request, depending on what is available on the web server. For more details, see the HTTP API documentation.If you don't want to develop a custom theme or plugin to start the Wordpress engine, you can just do the following in an isolated PHP file in the wordpress root:It won't show any theme or output any HTML, just hack away with the Wordpress APIs!I'd like to add some thoughts about the curl-based answer of Fred Tanrikut. I know most of them are already written in the answers above, but I think it is a good idea to show an answer that includes all of them together. Here is the class I wrote to make HTTP-GET/POST/PUT/DELETE requests based on curl, concerning just about the response body:You can also make some cool service tests by using this simple class.Another alternative of the curl-less method above is to use the native stream functions:A POST function with these can simply be like this:The better way of sending GET or POST requests with PHP is as below:The code is taken from official documentation here http://docs.php.net/manual/da/httprequest.send.phpThere is one more which you can useClick here for detailsI was looking for a similar problem and found a better approach of doing this. So here it goes.You can simply put the following line on the redirection page (say page1.php).I need this to redirect POST requests for REST API calls. This solution is able to redirect with post data as well as custom header values.Here is the reference link.Here is using just one command without cURL. Super simple.Try PEAR's HTTP_Request2 package to easily send POST requests. Alternatively, you can use PHP's curl functions or use a PHP stream context.HTTP_Request2 also makes it possible to mock out the server, so you can unit-test your code easily

How do I convert a string to a number in PHP?

Sara

[How do I convert a string to a number in PHP?](https://stackoverflow.com/questions/8529656/how-do-i-convert-a-string-to-a-number-in-php)

I want to convert these types of values, '3', '2.34', '0.234343', etc. to a number. In JavaScript we can use Number(), but is there any similar method available in PHP?

2011-12-16 04:08:14Z

I want to convert these types of values, '3', '2.34', '0.234343', etc. to a number. In JavaScript we can use Number(), but is there any similar method available in PHP?You don't typically need to do this, since PHP will coerce the type for you in most circumstances. For situations where you do want to explicitly convert the type, cast it:There are a few ways to do so:To avoid problems try intval($var). Some examples:In whatever (loosely-typed) language you can always cast a string to a number by adding a zero to it.However, there is very little sense in this as PHP will do it automatically at the time of using this variable, and it will be cast to a string anyway at the time of output.  Note that you may wish to keep dotted numbers as strings, because after casting to float it may be changed unpredictably, due to float numbers' nature.You can use:Or you can use:If you want get a float for $value = '0.4', but int for $value = '4', you can write:It is little bit dirty, but it works.You can always add zero to it!Instead of having to choose whether to convert the string to int or float, you can simply add a 0 to it, and PHP will automatically convert the result to a numeric type.In PHP you can use intval(string) or floatval(string) functions to convert strings to numbers.Yes, there is a similar method in PHP, but it is so little known that you will rarely hear about it. It is an arithmetic operator called "identity", as described here:Aritmetic OperatorsTo convert a numeric string to a number, do as follows:Just a little note to the answers that can be useful and safer in some cases.

You may want to check if the string actually contains a valid numeric value first and only then convert it to a numeric type (for example if you have to manipulate data coming from a db that converts ints to strings). You can use is_numeric() and then floatval():Here is the function that achieves what you are looking for. First we check if the value can be understood as a number, if so we turn it into an int and a float.  If the int and float are the same (e.g., 5 == 5.0) then we return the int value.  If the int and float are not the same (e.g., 5 != 5.3) then we assume you need the precision of the float and return that value.  If the value isn't numeric we throw a warning and return null.I've found that in JavaScript a simple way to convert a string to a number is to multiply it by 1. It resolves the concatenation problem, because the "+" symbol has multiple uses in JavaScript, while the "*" symbol is purely for mathematical multiplication.Based on what I've seen here regarding PHP automatically being willing to interpret a digit-containing string as a number (and the comments about adding, since in PHP the "+" is purely for mathematical addition), this multiply trick works just fine for PHP, also.I have tested it, and it does work... Although depending on how you acquired the string, you might want to apply the trim() function to it, before multiplying by 1.Here is a function I wrote to simplify things for myself:It also returns shorthand versions of boolean, integer, double and real.Calling type with parseNumeric set to true will convert numeric strings before checking type.Thus:type("5", true) will return inttype("3.7", true) will return floattype("500") will return stringJust be careful since this is a kind of false checking method and your actual variable will still be a string. You will need to convert the actual variable to the correct type if needed. I just needed it to check if the database should load an item id or alias, thus not having any unexpected effects since it will be parsed as string at run time anyway.EditIf you would like to detect if objects are functions add this case to the switch:In addition to Boykodev's answer I suggest this:You can use this to convert a string to an int in PHP.Simply you can write like this:You can use:But the best solution is to use:OrOnly multiply the number by 1 so that the string is converted to type number.You can change the data type as followsFor historical reasons "double" is returned in case of a float.PHP DocumentationAll suggestions lose the numeric type.This seems to me a best practice:PHP will do it for you within limitsThere is a way:Using is_* won't work, since the variable is a: string.Using the combination of json_encode() and then json_decode() it's converted to it's "true" form. If it's a true string then it would output wrong.Will output: string(2) "Me" int(0) float(0)I got the question "say you were writing the built in function for casting an integer to a string in PHP, how would you write that function" in a programming interview. Here's a solution.I've been reading through answers and didn't see anybody mention the biggest caveat in PHP's number conversion.The most upvoted answer suggests doing the following:That's brilliant. PHP does direct casting. But what if we did the following?Does PHP consider such conversions valid? Apparently yes. PHP reads the string until it finds first non-numerical character for the required type. Meaning that for integers, numerical characters are [0-9]. As a result, it reads 3, since it's in [0-9] character range, it continues reading. Reads . and stops there since it's not in [0-9] range.Same would happen if you were to cast to float or double. PHP would read 3, then ., then 1, then 4, and would stop at i since it's not valid float numeric character.As a result, "million" >= 1000000 evaluates to false, but "1000000million" >= 1000000 evaluates to true.See also: https://www.php.net/manual/en/language.operators.comparison.php how conversions are done while comparinghttps://www.php.net/manual/en/language.types.string.php#language.types.string.conversion how strings are converted to respective numbersIf you don't know in advance if you have a float or an integer,

and if the string may contain special characters (like space, €, etc),

and if it may contain more than 1 dot or comma,

you may use this function:  Different approach:

Create a folder if it doesn't already exist

Scott B

[Create a folder if it doesn't already exist](https://stackoverflow.com/questions/2303372/create-a-folder-if-it-doesnt-already-exist)

I've run into a few cases with WordPress installs with Bluehost where I've encountered errors with my WordPress theme because the uploads folder wp-content/uploads was not present.Apparently the Bluehost cPanel WordPress installer does not create this folder, though HostGator does.So I need to add code to my theme that checks for the folder and creates it otherwise.

2010-02-20 19:26:09Z

I've run into a few cases with WordPress installs with Bluehost where I've encountered errors with my WordPress theme because the uploads folder wp-content/uploads was not present.Apparently the Bluehost cPanel WordPress installer does not create this folder, though HostGator does.So I need to add code to my theme that checks for the folder and creates it otherwise.Try this:Note that 0777 is already the default mode for directories and may still be modified by the current umask.Here is the missing piece. You need to pass 'recursive' flag as third argument (boolean true) in mkdir call like this:Something a bit more universal since this comes up on google.  While the details are more specific, the title of this question is more universal.This will take a path, possibly with a long chain of uncreated directories, and keep going up one directory until it gets to an existing directory.  Then it will attempt to create the next directory in that directory, and continue till it's created all the directories.  It returns true if successful.Could be improved by providing a stopping level so it just fails if it goes beyond user folder or something and by including permissions.What about a helper function like this:It will return true if the directory was successfully created or already exists, and false if the directory couldn't be created.A better alternative is this (shouldn't give any warnings):Faster way to create folder:Recursively create directory path:Inspired by Python's os.makedirs()Within WordPress there's also the very handy function wp_mkdir_p which will recursively create a directory structure.  Source for reference:-I need the same thing for a login site. I needed to create a directory with a two variables.

The $directory is the main folder where I wanted to create another sub-folder with the users license number.This is the most up-to-date solution without error suppression:You can try also:If you want to avoid the file_exists VS is_dir problem, I would suggest you to look hereI tried this and it only creates the directory if the directory does not exist. It does not care it there is a file with that name.Considering the question's environment.And quoting from: http://php.net/manual/en/function.mkdir.phpManual says that the only required parameter is the $pathname!so, We can simply code:We don't have to pass any parameter or check if folder exists or even pass mode parameter unless needed; for the following reasons:This is just another way to look into the question and not claiming a better or most optimal solution.Tested on PHP7, Production Server, LinuxWe should always modularise our code and I've written the same check it below...

We first check the directory, if the directory is absent we create the directory.You first need to check if directory exists file_exists('path_to_directory')Then use mkdir(path_to_directory) to create a directoryMore about mkdir() hereFull code here:The accepted answer works but it is not the right solution due to the permissions. 0777 permissions allow everyone to access/read/write the directory. This is not what we want for upload directory in the web server. Here is the correct and complete solution suggested.0644 are the right permissions for uploads directory because we do not usually want uploaded on the server to be executed there. true is the third parameter for setting recursive property to  true or false. It allows the creation of nested directories specified in the pathname.

SQL injection that gets around mysql_real_escape_string()

Richard Knop

[SQL injection that gets around mysql_real_escape_string()](https://stackoverflow.com/questions/5741187/sql-injection-that-gets-around-mysql-real-escape-string)

Is there an SQL injection possibility even when using mysql_real_escape_string() function?Consider this sample situation. SQL is constructed in PHP like this:I have heard numerous people say to me that code like that is still dangerous and possible to hack even with mysql_real_escape_string() function used. But I cannot think of any possible exploit?Classic injections like this:do not work.Do you know of any possible injection that would get through the PHP code above?

2011-04-21 07:56:11Z

Is there an SQL injection possibility even when using mysql_real_escape_string() function?Consider this sample situation. SQL is constructed in PHP like this:I have heard numerous people say to me that code like that is still dangerous and possible to hack even with mysql_real_escape_string() function used. But I cannot think of any possible exploit?Classic injections like this:do not work.Do you know of any possible injection that would get through the PHP code above?Consider the following query:mysql_real_escape_string() will not protect you against this.

The fact that you use single quotes (' ') around your variables inside your query is what protects you against this. The following is also an option:The short answer is yes, yes there is a way to get around mysql_real_escape_string(). The long answer isn't so easy. It's based off an attack demonstrated here.So, let's start off by showing the attack...In certain circumstances, that will return more than 1 row. Let's dissect what's going on here:Congratulations, you just successfully attacked a program using mysql_real_escape_string()...It gets worse. PDO defaults to emulating prepared statements with MySQL. That means that on the client side, it basically does a sprintf through mysql_real_escape_string() (in the C library), which means the following will result in a successful injection:Now, it's worth noting that you can prevent this by disabling emulated prepared statements:This will usually result in a true prepared statement (i.e. the data being sent over in a separate packet from the query). However, be aware that PDO will silently fallback to emulating statements that MySQL can't prepare natively: those that it can are listed in the manual, but beware to select the appropriate server version).I said at the very beginning that we could have prevented all of this if we had used mysql_set_charset('gbk') instead of SET NAMES gbk. And that's true provided you are using a MySQL release since 2006.If you're using an earlier MySQL release, then a bug in mysql_real_escape_string() meant that invalid multibyte characters such as those in our payload were treated as single bytes for escaping purposes even if the client had been correctly informed of the connection encoding and so this attack would still succeed.  The bug was fixed in MySQL 4.1.20, 5.0.22 and 5.1.11.But the worst part is that PDO didn't expose the C API for mysql_set_charset() until 5.3.6, so in prior versions it cannot prevent this attack for every possible command!

 It's now exposed as a DSN parameter.As we said at the outset, for this attack to work the database connection must be encoded using a vulnerable character set.  utf8mb4 is not vulnerable and yet can support every Unicode character: so you could elect to use that instead—but it has only been available since MySQL 5.5.3.  An alternative is utf8, which is also not vulnerable and can support the whole of the Unicode Basic Multilingual Plane.Alternatively, you can enable the NO_BACKSLASH_ESCAPES SQL mode, which (amongst other things) alters the operation of mysql_real_escape_string().  With this mode enabled, 0x27 will be replaced with 0x2727 rather than 0x5c27 and thus the escaping process cannot create valid characters in any of the vulnerable encodings where they did not exist previously (i.e. 0xbf27 is still 0xbf27 etc.)—so the server will still reject the string as invalid.  However, see @eggyal's answer for a different vulnerability that can arise from using this SQL mode.The following examples are safe:Because the server's expecting utf8...Because we've properly set the character set so the client and the server match.Because we've turned off emulated prepared statements.Because we've set the character set properly.Because MySQLi does true prepared statements all the time.If you:ORYou're 100% safe.Otherwise, you're vulnerable even though you're using mysql_real_escape_string()...In homage to @ircmaxell's excellent answer (really, this is supposed to be flattery and not plagiarism!), I will adopt his format:Starting off with a demonstration...This will return all records from the test table.  A dissection:As my learned friend put it: congratulations, you just successfully attacked a program using mysql_real_escape_string()...mysql_set_charset() cannot help, as this has nothing to do with character sets; nor can mysqli::real_escape_string(), since that's just a different wrapper around this same function.The problem, if not already obvious, is that the call to mysql_real_escape_string() cannot know with which character the literal will be quoted, as that's left to the developer to decide at a later time.  So, in NO_BACKSLASH_ESCAPES mode, there is literally no way that this function can safely escape every input for use with arbitrary quoting (at least, not without doubling characters that do not require doubling and thus munging your data).It gets worse.  NO_BACKSLASH_ESCAPES may not be all that uncommon in the wild owing to the necessity of its use for compatibility with standard SQL (e.g. see section 5.3 of the SQL-92 specification, namely the <quote symbol> ::= <quote><quote> grammar production and lack of any special meaning given to backslash).  Furthermore, its use was explicitly recommended as a workaround to the (long since fixed) bug that ircmaxell's post describes.  Who knows, some DBAs might even configure it to be on by default as means of discouraging use of incorrect escaping methods like addslashes().Also, the SQL mode of a new connection is set by the server according to its configuration (which a SUPER user can change at any time); thus, to be certain of the server's behaviour, you must always explicitly specify your desired mode after connecting.So long as you always explicitly set the SQL mode not to include NO_BACKSLASH_ESCAPES, or quote MySQL string literals using the single-quote character, this bug cannot rear its ugly head: respectively escape_quotes_for_mysql() will not be used, or its assumption about which quote characters require repeating will be correct.For this reason, I recommend that anyone using NO_BACKSLASH_ESCAPES also enables ANSI_QUOTES mode, as it will force habitual use of single-quoted string literals.  Note that this does not prevent SQL injection in the event that double-quoted literals happen to be used—it merely reduces the likelihood of that happening (because normal, non-malicious queries would fail).In PDO, both its equivalent function PDO::quote() and its prepared statement emulator call upon mysql_handle_quoter()—which does exactly this: it ensures that the escaped literal is quoted in single-quotes, so you can be certain that PDO is always immune from this bug.As of MySQL v5.7.6, this bug has been fixed.  See change log:Taken together with the bug explained by ircmaxell, the following examples are entirely safe (assuming that one is either using MySQL later than 4.1.20, 5.0.22, 5.1.11; or that one is not using a GBK/Big5 connection encoding):...because we've explicitly selected an SQL mode that doesn't include NO_BACKSLASH_ESCAPES....because we're quoting our string literal with single-quotes....because PDO prepared statements are immune from this vulnerability (and ircmaxell's too, provided either that you're using PHP≥5.3.6 and the character set has been correctly set in the DSN; or that prepared statement emulation has been disabled)....because PDO's quote() function not only escapes the literal, but also quotes it (in single-quote ' characters); note that to avoid ircmaxell's bug in this case, you must be using PHP≥5.3.6 and have correctly set the character set in the DSN....because MySQLi prepared statements are safe.Thus, if you:OROR...then you should be completely safe (vulnerabilities outside the scope of string escaping aside).Well, there's nothing really that can pass through that, other than % wildcard. It could be dangerous if you were using LIKE statement as attacker could put just % as login if you don't filter that out, and would have to just bruteforce a password of any of your users.

People often suggest using prepared statements to make it 100% safe, as data can't interfere with the query itself that way.

But for such simple queries it probably would be more efficient to do something like $login = preg_replace('/[^a-zA-Z0-9_]/', '', $login);

PHP equivalent of .NET/Java's toString()

Antoine Aubry

[PHP equivalent of .NET/Java's toString()](https://stackoverflow.com/questions/28098/php-equivalent-of-net-javas-tostring)

How do I convert the value of a PHP variable to string?I was looking for something better than concatenating with an empty string:Like the ToString() method in Java or .NET.

2008-08-26 13:56:49Z

How do I convert the value of a PHP variable to string?I was looking for something better than concatenating with an empty string:Like the ToString() method in Java or .NET.You can use the casting operators:There are more details for string casting and conversion in the Strings section of the PHP manual, including special handling for booleans and nulls.This is done with typecasting:In a class you can define what is output by using the magical method __toString. An example is below:Some more type casting examples:Use print_r:You can also use it like: This will set $myText to a string, like:Use var_export to get a little bit more info (with types of variable,...):You can either use typecasting:or StringValue:or SetType:They all work for the same thing in terms of Type-Juggling.A value can be converted to a string using the (string) cast or the strval() function. (Edit: As Thomas also stated).It also should be automatically casted for you when you use it as a string.You are looking for strval:For primitives just use (string)$var or print this variable straight away. PHP is dynamically typed language and variable will be casted to string on the fly.If you want to convert objects to strings you will need to define __toString() method that returns string. This method is forbidden to throw exceptions.Putting it in double quotes should work:I think it is worth mentioning that you can catch any output (like print_r, var_dump) in a variable by using output buffering:Thanks to:

How can I capture the result of var_dump to a string?Another option is to use the built in settype function:This actually performs a conversion on the variable unlike typecasting and allows you to have a general way of converting to multiple types.In addition to the answer given by Thomas G. Mayfield: If you follow the link to the string casting manual, there is a special case which is quite important to understand:(string) cast is preferable especially if your variable $a is an object, because PHP will follow the casting protocol according to its object model by calling __toString() magic method (if such is defined in the class of which $a is instantiated from).PHP does something similar toThe (string) casting operation is a recommended technique for PHP5+ programming making code more Object-Oriented. IMO this is a nice example of design similarity (difference) to other OOP languages like Java/C#/etc., i.e. in its own special PHP way (whenever it's for the good or for the worth).As others have mentioned, objects need a __toString method to be cast to a string. An object that doesn't define that method can still produce a string representation using the spl_object_hash function.I have a base Object class with a __toString method that defaults to calling md5(spl_object_hash($this)) to make the output clearly unique, since the output from spl_object_hash can look very similar between objects.This is particularly helpful for debugging code where a variable initializes as an Object and later in the code it is suspected to have changed to a different Object. Simply echoing the variables to the log can reveal the change from the object hash (or not).Some, if not all, of the methods in the previous answers fail when the intended string variable has a leading zero, for example, 077543.An attempt to convert such a variable fails to get the intended string, because the variable is converted to base 8 (octal).All these will make $str have a value of 32611:I think this question is a bit misleading since,

toString() in Java isn't just a way to cast something to a String. That is what casting via (string) or String.valueOf() does, and it works as well in PHP.Note that this can be problematic as Java is type-safe (see here for more details).But as I said, this is casting and therefore not the equivalent of Java's toString().toString in Java doesn't just cast an object to a String. It instead will give you the String representation. And that's what __toString() in PHP does.And from the other side:What do I mean by "giving the String representation"?

Imagine a class for a library with millions of books.These are both valid approaches but with very different  goals, neither is a perfect solution for every case and you have to chose wisely which fits better for your needs.Sure, there are even more options:All of these methods will return a String, some of them using __toString internally and some others will fail on Objects. Take a look at the PHP documentation for more details.The documentation says that you can also do:It's the same as cast, but I think it looks prettier.Source:Double quotes should work too... it should create a string, then it should APPEND/INSERT the casted STRING value of $myVar in between 2 empty strings.You can always create a method named .ToString($in) that returnsIf you're converting anything other than simple types like integers or booleans, you'd need to write your own function/method for the type that you're trying to convert, otherwise PHP will just print the type (such as array, GoogleSniffer, or Bidet).PHP is dynamically typed, so like Chris Fournier said, "If you use it like a string it becomes a string". If you're looking for more control over the format of the string then printf is your answer.You can also use the var_export PHP function.For objects, you may not be able to use the cast operator. Instead, I use the json_encode() method.For example, the following will output contents to the error log:Try this little strange, but working, approach to convert the textual part of stdClass to string type:I use variableToString. It handles every PHP type and is flexible (you can extend it if you want).

How do I catch a PHP Fatal Error

too much php

[How do I catch a PHP Fatal Error](https://stackoverflow.com/questions/277224/how-do-i-catch-a-php-fatal-error)

I can use set_error_handler() to catch most PHP errors, but it doesn't work for fatal (E_ERROR) errors, such as calling a function that doesn't exist. Is there another way to catch these errors?I am trying to call mail() for all errors and am running PHP 5.2.3.

2008-11-10 06:42:27Z

I can use set_error_handler() to catch most PHP errors, but it doesn't work for fatal (E_ERROR) errors, such as calling a function that doesn't exist. Is there another way to catch these errors?I am trying to call mail() for all errors and am running PHP 5.2.3.Log fatal errors using register_shutdown_function, which requires PHP 5.2+:You will have to define the error_mail and format_error functions. For example:Use Swift Mailer to write the error_mail function.See also:Just came up with this solution (PHP 5.2.0+):Different error types defined at http://www.php.net/manual/en/errorfunc.constants.phpPHP doesn't provide conventional means for catching and recovering from fatal errors. This is because processing should not typically be recovered after a fatal error. String matching an output buffer (as suggested by the original post the technique described on PHP.net) is definitely ill-advised. It's simply unreliable.Calling the mail() function from within an error handler method prove to be problematic, too. If you had a lot of errors, your mail server would be loaded with work, and you could find yourself with a gnarly inbox. To avoid this, you might consider running a cron to scan error logs periodically and send notifications accordingly. You might also like to look into system monitoring software, such as Nagios.To speak to the bit about registering a shutdown function:It's true that you can register a shutdown function, and that's a good answer.The point here is that we typically shouldn't try to recover from fatal errors, especially not by using a regular expression against your output buffer. I was responding to the accepted answer, which linked to a suggestion on php.net which has since been changed or removed.That suggestion was to use a regex against the output buffer during exception handling, and in the case of a fatal error (detected by the matching against whatever configured error text you might be expecting), try to do some sort of recovery or continued processing. That would not be a recommended practice (I believe that's why I can't find the original suggestion, too. I'm either overlooking it, or the php community shot it down).It might be worth noting that the more recent versions of PHP (around 5.1) seem to call the shutdown function earlier, before the output buffering callback is envoked.  In version 5 and earlier, that order was the reverse (the output buffering callback was followed by the shutdown function). Also, since about 5.0.5 (which is much earlier than the questioner's version 5.2.3), objects are unloaded well before a registered shutdown function is called, so you won't be able to rely on your in-memory objects to do much of anything.So registering a shutdown function is fine, but the sort of tasks that ought to be performed by a shutdown function are probably limited to a handful of gentle shutdown procedures.The key take-away here is just some words of wisdom for anyone who stumbles upon this question and sees the advice in the originally accepted answer. Don't regex your output buffer.Well it seems possible to catch Fatal Errors some other way :)Fatal errors or recoverable fatal errors now throw instances of Error in PHP 7 or higher versions. Like any other exceptions, Error objects can be caught using a try/catch block.Example:https://3v4l.org/67vbkOr you can use Throwable interface to catch all exceptions.Example:https://3v4l.org/Br0MGFor more information: http://php.net/manual/en/language.errors.php7.phpI developed a way to catch all error types in PHP (almost all)! I have no sure about E_CORE_ERROR ( I think will not works only for that error)! But, for other fatal errors (E_ERROR, E_PARSE, E_COMPILE...) works fine using only one error handler function! There goes my solution:Put this following code on your main file (index.php):I hope this helps many people! I was searching for this solution too long time and didn't find! Then I developed one!You can't catch/handle fatal errors, but you can log/report them.

For quick debugging I modified one answer to this simple codeYou cannot throw exception inside registered shutdown function like that:But you can capture and redirect request to another page.If you are using php >= 5.1.0

Just do something like this with the ErrorException class:This class allows you to start the specific ErrorHandler sometimes if you need it. And then you can also stop the Handler.Use this class e.g. like this:Link to the full class code: https://github.com/zendframework/zf2/blob/master/library/Zend/Stdlib/ErrorHandler.phpIt can also handle FATAL_ERRORS using the register_shutdown_function function. According to this class a FATAL_ERROR is one of the following array(E_ERROR, E_PARSE, E_CORE_ERROR, E_COMPILE_ERROR, E_USER_ERROR).I need to handle fatal errors for a production to instead show a static styled 503 Service Unavailable HTML output. This is surely a reasonable approach to "catching fatal errors". This is what I've done:I have a custom error handling function "error_handler" which will display my "503 service unavailable" HTML page on any E_ERROR, E_USER_ERROR etc. This will now be called on the shutdown function catching my fatal error.in my custom error_handler function, if the error is E_ERROR or E_USER_ERROR etc. I also call @ob_end_clean(); to empty the buffer, thus removing PHP's "fatal error" message.Take important note of the strict isset() checking and @ silencing functions since we dont want our error_handler scripts to generate any errors.In still agreeing with keparo, catching fatal errors does defeat the purpose of "FATAL error" so its not really intended for you to do further processing. Do not run any mail() functions in this shutdown process as you will certainly back up the mail server or your inbox. Rather log these occurrences to file and schedule a cron to find these error.log files and mail them to administrators.PHP has catchable fatal errors. They are defined as E_RECOVERABLE_ERROR. The PHP manual describes an E_RECOVERABLE_ERROR as:You can "catch" these "fatal" errors by using set_error_handler() and checking for E_RECOVERABLE_ERROR. I find it useful to throw an Exception when this error is caught, then you can use try/catch.This question and answer provides a useful example: How can I catch a "catchable fatal error" on PHP type hinting?E_ERROR errors, however, can be handled, but not recovered from as the engine is in an unstable state.Just a nice trick to get the current error_handler method =)Also i wan't to note that if you call Php stops displaying the error, otherwise the error text will be send to the client prior to your error handlerSince most answers here are unnecesarily verbose, here's my non-ugly version of the top voted answer:Not really. Fatal errors are called that, because they are fatal. You can't recover from them.I developed this function to make it possible to "sandbox" code that could cause a fatal error. Since exceptions thrown from the closure register_shutdown_function don't get emitted from the pre-fatal error call stack, I'm forced to exit after this function to provide a uniform way of using it.There are certain circumstances that even fatal errors should be caught (you might need to do some clean up before exiting gracefully and dont just die..).

I have implemented a pre_system hook on my codeigniter applications so that I can get my fatal errors through emails, and this helped me finding bugs that were not reported (or were reported after they were fixed, as I already knew about them :)).

Sendemail check if the error has already been reported so that it does not spam you with known errors multiple times.I wrote up a Wiki-style Q&A with a Complete solution for catching All errors in PHP; which can be viewed/gleaned/stolen/critiqued here.The solution includes 5 methods that wrap all errors PHP can generate, that will eventually pass said errors up to an 'ErrorHandler' typed object. Hope some folks get some use out of it. Even if you don't steal it outright, I'm sure that the solution is at least a good example of how to handle errors in PHP - in every respect.@Lucas Batistussi got points for creativity - I figure I could share my solution as well and shoot for some similar points...

How should a model be structured in MVC? [closed]

Dietpixel

[How should a model be structured in MVC? [closed]](https://stackoverflow.com/questions/5863870/how-should-a-model-be-structured-in-mvc)

I am just getting a grasp on the MVC framework and I often wonder how much code should go in the model. I tend to have a data access class that has methods like this:My models tend to be an entity class that is mapped to the database table.Should the model object have all the database mapped properties as well as the code above or is it OK to separate that code out that actually does the database work?Will I end up having four layers?

2011-05-03 00:28:42Z

I am just getting a grasp on the MVC framework and I often wonder how much code should go in the model. I tend to have a data access class that has methods like this:My models tend to be an entity class that is mapped to the database table.Should the model object have all the database mapped properties as well as the code above or is it OK to separate that code out that actually does the database work?Will I end up having four layers?The first thing that I must clear up is: the model is a layer.Second: there is a difference between classical MVC and what we use in web development. Here's a bit of an older answer I wrote, which briefly describes how they are different.The model is not a class or any single object. It is a very common mistake to make (I did too, though the original answer was written when I began to learn otherwise), because most frameworks perpetuate this misconception.Neither is it an Object-Relational Mapping technique (ORM) nor an abstraction of database tables. Anyone who tells you otherwise is most likely trying to 'sell' another brand-new ORM or a whole framework.In proper MVC adaptation, the M contains all the domain business logic and the Model Layer is mostly made from three types of structures:The communication between the model layer and other parts of the MVC triad should happen only through Services. The clear separation has a few additional benefits: For both the View and Controller instances (what you could call: "UI layer") to have access these services,  there are two general approaches: As you might suspect, the DI container is a lot more elegant solution (while not being the easiest for a beginner). The two libraries, that I recommend considering for this functionality would be Syfmony's standalone DependencyInjection component or Auryn. Both the solutions using a factory and a DI container would let you also share the instances of various servers to be shared between the selected controller and view for a given request-response cycle.Now that you can access to the model layer in the controllers, you need to start actually using them: Your controllers have a very clear task: take the user input and, based on this input, change the current state of business logic. In this example the states that are changed between are "anonymous user" and "logged in user". Controller is not responsible for validating user's input, because that is part of business rules and controller is definitely not calling SQL queries, like what you would see here or here (please don't hate on them, they are misguided, not evil).Ok, user has logged in (or failed). Now what? Said user is still unaware of it. So you need to actually produce a response and that is the responsibility of a view. In this case, the view produced one of two possible responses, based on the current state of model layer. For a different use-case you would have the view picking different templates to render, based on something like "current selected of article" .The presentation layer can actually get quite elaborate, as described here: Understanding MVC Views in PHP.Of course, there are situations, when this is a overkill.MVC is just a concrete solution for Separation of Concerns principle. MVC separates user interface from the business logic, and it in the UI it separated handling of user input and the presentation. This is crucial. While often people describe it as a "triad", it's not actually made up from three independent parts. The structure is more like this: It means, that, when your presentation layer's logic is close to none-existent, the pragmatic approach is to keep them as single layer. It also can substantially simplify some aspects of model layer. Using this approach the login example (for an API) can be written as:While this is not sustainable, when you have complicate logic for rendering a response body, this simplification is very useful for more trivial scenarios. But be warned, this approach will become a nightmare, when attempting to use in large codebases with complex presentation logic. Since there is not a single "Model" class (as explained above), you really do not "build the model". Instead you start from making Services, which are able to perform certain methods. And then implement Domain Objects and Mappers.In the both approaches above there was this login method for the identification service. What would it actually look like. I am using a slightly modified version of the same functionality from a library, that I wrote .. because I am lazy:As you can see, at this level of abstraction, there is no indication of where the data was fetched from. It might be a database, but it also might be just a mock object for testing purposes. Even the data mappers, that are actually used for it, are hidden away in the private methods of this service.To implement an abstraction of persistence, on the most flexible approaches is to create custom data mappers. From: PoEAA bookIn practice they are implemented for interaction with specific classes or superclasses. Lets say you have Customer and Admin in your code (both inheriting from a User superclass). Both would probably end up having a separate matching mapper, since they contain different fields. But you will also end up with shared and commonly used operations. For example: updating the "last seen online" time. And instead of making the existing mappers more convoluted, the more pragmatic approach is to have a general "User Mapper", which only update that timestamp.Everything that is business logic belongs in a model, whether it is a database query, calculations, a REST call, etc.You can have the data access in the model itself, the MVC pattern doesn't restrict you from doing that. You can sugar coat it with services, mappers and what not, but the actual definition of a model is a layer that handles business logic, nothing more, nothing less. It can be a class, a function, or a complete module with a gazillion objects if that's what you want.It's always easier to have a separate object that actually executes the database queries instead of having them being executed in the model directly: this will especially come in handy when unit testing (because of the easiness of injecting a mock database dependency in your model):Also, in PHP, you rarely need to catch/rethrow exceptions because the backtrace is preserved, especially in a case like your example. Just let the exception be thrown and catch it in the controller instead.In Web-"MVC" you can do whatever you please.The original concept (1) described the model as the business logic. It should represent the application state and enforce some data consistency. That approach is often described as "fat model".Most PHP frameworks follow a more shallow approach, where the model is just a database interface. But at the very least these models should still validate the incoming data and relations.Either way, you're not very far off if you separate the SQL stuff or database calls into another layer. This way you only need to concern yourself with the real data/behaviour, not with the actual storage API. (It's however unreasonable to overdo it. You'll e.g. never be able to replace a database backend with a filestorage if that wasn't designed ahead.)More oftenly most of the applications will have data,display and processing part and we just put all  those in the letters M,V and C.  Model(M)-->Has the attributes that holds state of application and it dont know any thing about V and C.  View(V)-->Has displaying format for the application and and only knows about how-to-digest model on it and does not bother about C.Controller(C)---->Has processing part of application and acts as wiring between M and V and it depends on both M,V unlike M and V.  Altogether there is separation of concern between each.

In future any change or enhancements can be added very easily.In my case I have a database class that handle all the direct database interaction such as querying, fetching, and such. So if I had to change my database from MySQL to PostgreSQL there won't be any problem. So adding that extra layer can be useful.Each table can have its own class and have its specific methods, but to actually get the data, it lets the database class handle it:Table object classLI hope this example helps you create a good structure.

Show a number to two decimal places

Rich Bradshaw

[Show a number to two decimal places](https://stackoverflow.com/questions/4483540/show-a-number-to-two-decimal-places)

What's the correct way to round a PHP string to two decimal places?The output should be 520.00;How should the round_to_2dp() function definition be?

2010-12-19 15:10:30Z

What's the correct way to round a PHP string to two decimal places?The output should be 520.00;How should the round_to_2dp() function definition be?You can use number_format():Example:This function returns a string.Alternatively,Use round() (use if you are expecting a number in float format only, else use number_format() as an answer given by Codemwnci):From the manual:...http://php.net/manual/en/function.round.phpe.g.Try:The output will be:You can use the PHP printf or sprintf functions:Example with sprintf:You can run the same without echo as well. Example: sprintf("%.3f", $num);Output:Alternatively, with printf:Output:Another more exotic way to solve this issue is to use bcadd() with a dummy value for the $right_operand of 0.Use the PHP number_format() function.For example,The output will be:Use the PHP number_format() function.round_to_2dp is a user-defined function, and nothing can be done unless you posted the declaration of that function.However, my guess is doing this: number_format($number, 2);This will display exactly two digits after the decimal point.Advantage:If you want to display two digits after a float value only and not for int, then use this.It will return 5.98 without rounding the number.For conditional rounding off ie. show decimal where it's really needed otherwise whole number123.56 => 12.56123.00 => 123I make my own.The rounding correctly rounds the number and the sprintf forces it to 2 decimal places if it happens to to be only 1 decimal place after rounding.This will give you 2 number after decimal.Here I get two decimals after the . (dot) using a function...Results from the above function:New Correct AnswerUse the PHP native function bcdivIf you want to use two decimal digits in your entire project, you can define:Then the following function will produce your desired result:But if you don't use the bcscale function, you need to write the code as follows to get your desired result.To know moreNumber without roundHere's another solution with strtok and str_pad:Adding to other answers, since number_format() will, by default, add thousands separator.To remove this, do this:You can use PHP round() function.

htmlentities() vs. htmlspecialchars()

Eric Hogue

[htmlentities() vs. htmlspecialchars()](https://stackoverflow.com/questions/46483/htmlentities-vs-htmlspecialchars)

What are the differences between htmlspecialchars() and htmlentities(). When should I use one or the other?

2008-09-05 18:29:12Z

What are the differences between htmlspecialchars() and htmlentities(). When should I use one or the other?From the PHP documentation for htmlentities:From the PHP documentation for htmlspecialchars:The difference is what gets encoded. The choices are everything (entities) or "special" characters, like ampersand, double and single quotes, less than, and greater than (specialchars).I prefer to use htmlspecialchars whenever possible.For example:htmlspecialchars may be used:Because:htmlentities is only necessary if your pages use encodings such as ASCII or LATIN-1 instead of UTF-8 and you're handling data with an encoding different from the page's.This is being encoded with htmlentities. implode( "\t", array_values( get_html_translation_table( HTML_ENTITIES ) ) ):This is being encoded with htmlspecialchars.implode( "\t", array_values( get_html_translation_table( HTML_SPECIALCHARS ) ) ):You should use htmlspecialchars($strText, ENT_QUOTES) when you just want your string to be XML and HTML safe:For example, encode However, if you also have additional characters that are Unicode or uncommon symbols in your text then you should use htmlentities() to ensure they show up properly in your HTML page.Notes: I just found out about the get_html_translation_table function. You pass it HTML_ENTITIES or HTML_SPECIALCHARS and it returns an array with the characters that will be encoded and how they will be encoded. htmlspecialchars () does the minimum amount of encoding to ensure that your string is not parsed as HTML. This leaves your string more human-readable than it would be if you used htmlentities () to encode absolutely everything that has an encoding.htmlentities — Convert all applicable characters to HTML entities.htmlspecialchars — Convert special characters to HTML entities.The translations performed translation characters on the below: You can check the following code for more information about what's htmlentities and htmlspecialchars:https://gist.github.com/joko-wandiro/f5c935708d9c37d8940bYou probably want to use some Unicode character encoding, for example UTF-8, and htmlspecialchars. Because there isn't any need to generate "HTML entities" for "all [the] applicable characters" (that is what htmlentities does according to the documentation) if it's already in your character set.One small example, I needed to have 2 client names indexed in a function:I originally $term = get_term_by('name', htmlentities($name), 'client'); which resulted in term names that only included the ampersand array item (&) but not the accented item. But when I changed the variable setting to htmlspecialchars both were able to run through the function. Hope this helps!https://dev.w3.org/html5/html-author/charrefNot fully, pls track the link for fully document.The  differences between htmlspecialchars() and htmlentities() is very small. Lets see some examples:htmlspecialchars(string $string)  takes multiple arguments where as the first argument is a string and all other arguments (certain flags, certain encodings etc. ) are optional. htmlspecialchars   converts special characters in the string to HTML entities. For example if you have  < br >  in your string, htmlspecialchars will convert it into &lt; b &gt;. Whereas   characters like  µ † etc. have no  special significance in HTML. So they will be not converted to  HTML entities by htmlspecialchars function as shown in the below example. htmlentities ( string $string) is very similar to  htmlspecialchars and takes multiple arguments where as the first argument is a string and all other arguments are optional (certain flags, certain encodings etc.). Unlike  htmlspecialchars,   htmlentities converts not only special characters in the string to HTML entities but all applicable characters to HTML entities.

Converting an integer to a string in PHP

kman99

[Converting an integer to a string in PHP](https://stackoverflow.com/questions/1035634/converting-an-integer-to-a-string-in-php)

Is there a way to convert an integer to a string in PHP?

2009-06-23 22:37:45Z

Is there a way to convert an integer to a string in PHP?You can use the strval() function to convert a number to a string.From a maintenance perspective its obvious what you are trying to do rather than some of the other more esoteric answers.  Of course, it depends on your context.There's many ways to do this.Two examples:See the PHP Manual on Types Juggling for more.Now $foo is a string.But, you may want to get used to casting. As casting is the proper way to accomplish something of that sort:Another way is to encapsulate in quotes:There are a number of ways to "convert" an integer to a string in PHP.The traditional computer science way would be to cast the variable as a string:You could also take advantage of PHP's implicit type conversion and string interpolation:Finally, similar to the above, any function that accepts and returns a string could be used to convert and integer. Consider the following:I wouldn't recommend the final option, but I've seen code in the wild that relied on this behavior, so thought I'd pass it along.All these answers are great, but they all return you an empty string if the value is zero.Try the following:Use:Or it could be:Or:There are many possible conversion ways:You can either use the period operator and concatenate a string to it (and it will be type casted to a string):Or, more correctly, you can just type cast the integer to a string:As the answers here demonstrates nicely, yes, there are several ways. However, in PHP you rarely actually need to do that. The "dogmatic way" to write PHP is to rely on the language's loose typing system, which will transparently coerce the type as needed. For integer values, this is usually without trouble. You should be very careful with floating point values, though.You can simply use the following:I would say it depends on the context. strval() or the casting operator (string) could be used. However, in most cases PHP will decide what's good for you if, for example, you use it with echo or printf...One small note: die() needs a string and won't show any int :)So the echo will be return string.is faster than 

What is the difference between client-side and server-side programming?

deceze

[What is the difference between client-side and server-side programming?](https://stackoverflow.com/questions/13840429/what-is-the-difference-between-client-side-and-server-side-programming)

I have this code:Why does this not write "bar" into my text file, but alerts "42"?NB: Earlier revisions of this question were explicitly about PHP on the server and JavaScript on the client. The essential nature of the problem and solutions is the same for any pair of languages when one is running on the client and the other on the server (even if they are the same language). Please take this in to account when you see answers talking about specific languages.

2012-12-12 13:03:00Z

I have this code:Why does this not write "bar" into my text file, but alerts "42"?NB: Earlier revisions of this question were explicitly about PHP on the server and JavaScript on the client. The essential nature of the problem and solutions is the same for any pair of languages when one is running on the client and the other on the server (even if they are the same language). Please take this in to account when you see answers talking about specific languages.Your code is split into two entirely separate parts, the server side and the client side.The two sides communicate via HTTP requests and responses. PHP is executed on the server and outputs some HTML and maybe JavaScript code which is sent as response to the client where the HTML is interpreted and the JavaScript is executed. Once PHP has finished outputting the response, the script ends and nothing will happen on the server until a new HTTP request comes in.The example code executes like this:Step 1, PHP executes all code between <?php ?> tags. The result is this:The file_put_contents call did not result in anything, it just wrote " + foo + " into a file. The <?php echo 42; ?> call resulted in the output "42", which is now in the spot where that code used to be.This resulting HTML/JavaScript code is now sent to the client, where it gets evaluated. The alert call works, while the foo variable is not used anywhere.All PHP code is executed on the server before the client even starts executing any of the JavaScript. There's no PHP code left in the response that JavaScript could interact with.To call some PHP code, the client will have to send a new HTTP request to the server. This can happen using one of three possible methods:Here's a question outlining these method in greater detailYou can also use JavaScript to make the browser open a new page using window.location or submit a form, emulating possibilities 1. and 2.To determine why PHP code doesn't work in JavaScript code we need to understand what client side and server side languages are, and how they work. Server-side languages (PHP etc.):  They retrieve records from databases, maintain state over the stateless HTTP connection, and do a lot of things that require  security. They reside on the server, these programs never have their source code exposed to the user.                               So you can easily see that server side languages handle HTTP requests and process them, and, as @deceze said, PHP is executed on the server and outputs some HTML, and maybe JavaScript code, which is sent as a response to the client, where the HTML is interpreted and JavaScript is executed.On the other hand, Client Side Languages (like JavaScript) reside in browser and run in the browser. Client-side scripting generally refers to the class of computer programs on the web that are executed client-side, by the user's web browser, instead of server-side.JavaScript is visible to the user and can be easily modified, so for security stuff we must not rely on JavaScript. So when you make a HTTP request on server, the server first reads the PHP file carefully to see if there are any tasks that need to be executed, and sends a response to the client side. Again, as @deceze said, *Once PHP has finished outputting the response, the script ends and nothing will happen on the server until a new HTTP request comes in.*So now what can I do if I need to call PHP? It depends how you need to do it: either by reloading the page or by using an AJAX call.Good Read:Your Javascript will execute on the client, not on the server. This means that foo is not evaluated on the server side and therefore its value can't be written to a file on the server.The best way to think about this process is as if you're generating a text file dynamically. The text you're generating only becomes executable code once the browser interprets it. Only what you place between <?php tags is evaluated on the server.By the way, making a habit of embedding random pieces of PHP logic in HTML or Javascript can lead to seriously convoluted code. I speak from painful experience.In web application every task execute in a manner of request and response.Client side programming is with html code  with Java script and its frameworks, libraries executes in the internet explorer, Mozilla, chrome browsers.

In the java scenario

server side programming servlets executes in the Tomcat, web-logic , j boss, WebSphere seversI will try to explain it in a simple way.Client-Side is what users see/ code, which is visible on the browser.Client Side Programming includes HTML(HTML, HTML5, DHTML), CSS(CSS, CSS3) and JavaScript(JavaScript, ES5, ES6, ES7, TypeScript, JQuery, ReactJs, AngularJs, BackboneJs or any other JavaScript Front-end framework).Client-Side programming focus on "how a page will look like" and its behavior over browsers.Server-Side Programming includes code which provides data to Client-Side. The user is never able to see the server-side.Server Side Programming involves Programming Language(Java, PHP, .Net, C#, C, C++, NodeJS etc), Database(SQL, Oracle, MySql, PostgreySql, No-Sql, MongoDB, etc), Third Party API(Rest, Soap), Business Logic.Server-Side Programming focus on "how to make data available for Client-Side."Client-Side request data or request to store data, from Server-side via API provided by Server-Side. This request and response of data are done by following HTTP/FTP protocol like REST API, SOAP API.

Insert new item in array on any position in PHP

kusanagi

[Insert new item in array on any position in PHP](https://stackoverflow.com/questions/3797239/insert-new-item-in-array-on-any-position-in-php)

How can I insert a new item into an array on any position, for example in the middle of array?

2010-09-26 09:39:22Z

How can I insert a new item into an array on any position, for example in the middle of array?You may find this a little more intuitive. It only requires one function call to array_splice:A function that can insert at both integer and string positions:Integer usage:String Usage:This way you can insert arrays:There is no native PHP function (that I am aware of) that can do exactly what you requested. I've written 2 methods that I believe are fit for purpose:While faster and probably more memory efficient, this is only really suitable where it is not necessary to maintain the keys of the array.If you do need to maintain keys, the following would be more suitable;Based on @Halil great answer, here is simple function how to insert new element after a specific key,

while preserving integer keys:If you want to keep the keys of the initial array and also add an array that has keys, then use the function below:Call example:This is what worked for me for the associative array:The function source - this blog post. There's also handy function to insert BEFORE specific key.This is also a working solution:credits go to:

http://binarykitten.com/php/52-php-insert-element-and-shift.htmlSolution by jay.lee is perfect. In case you want to add item(s) to a multidimensional array, first add a single dimensional array and then replace it afterwards.Adding an item in same format to this array will add all new array indexes as items instead of just item. Note: Adding items directly to a multidimensional array with array_splice will add all its indexes as items instead of just that item.You can use thisNormally, with scalar values:To insert a single array element into your array don't forget to wrap the array in an array (as it was a scalar value!):otherwise all the keys of the array will be added piece by piece.Hint for adding an element at the beginning of an array:then:but:if unsure, then DONT USE THESE:ORbecause with + original array will be overwritten. (see source)Try this one:Call example:For inserting elements into an array with string keys you can do something like this:

Convert a date format in PHP

matthy

[Convert a date format in PHP](https://stackoverflow.com/questions/2487921/convert-a-date-format-in-php)

I am trying to convert a date from yyyy-mm-dd to dd-mm-yyyy (but not in SQL); however I don't know how the date function requires a timestamp, and I can't get a timestamp from this string.How is this possible?

2010-03-21 17:11:12Z

I am trying to convert a date from yyyy-mm-dd to dd-mm-yyyy (but not in SQL); however I don't know how the date function requires a timestamp, and I can't get a timestamp from this string.How is this possible?Use strtotime() and date():(See the strtotime and date documentation on the PHP site.)Note that this was a quick solution to the original question. For more extensive conversions, you should really be using the DateTime class to parse and format :-)If you'd like to avoid the strtotime conversion (for example, strtotime is not being able to parse your input) you can use,Or, equivalently:You are first giving it the format $dateString is in. Then you are telling it the format you want $newDateString to be in.Or if the source-format always is "Y-m-d" (yyyy-mm-dd), then just use DateTime:Use:Without the date conversion overhead, I am not sure it'll matter much.This code works for every date format. You can change the order of replacement variables such $3-$1-$2 due to your old date format.For more, see the documentation for strtotime.Or even shorter:Also another obscure possibility:I don't know if I would use it but still :)The most voted answer is actually incorrect!The PHP strtotime manual here states that "The function expects to be given a string containing an English date format". What it actually means is that it expects an American US date format, such as "m-d-Y" or "m/d/Y".That means that a date provided as "Y-m-d" may get misinterpreted by strtotime. You should provide the date in the expected format.I wrote a little function to return dates in several formats. Use and modify at will. If anyone does turn that into a class, I'd be glad if that would be shared.There are two ways to implement this:1.2.You can try the strftime() function. Simple example: strftime($time, '%d %m %Y'); Use this function to convert from any format to any formatGiven below is PHP code to generate tomorrow's date using mktime() and change its format to dd/mm/yyyy format and then print it using echo.You can change the format using the date() and the strtotime().$date = '9/18/2019';echo date('d-m-y',strtotime($date)); Result:18-09-19We can change the format by changing the ( d-m-y ).For this specific conversion we can also use a format string.Obviously this won't work for many other date format conversions, but since we're just rearranging substrings in this case, this is another possible way to do it.Simple way Use strtotime() and date():With timeUse date_create and date_formatTry this.

How to check if a string starts with a specified string? [duplicate]

Andrew

[How to check if a string starts with a specified string? [duplicate]](https://stackoverflow.com/questions/2790899/how-to-check-if-a-string-starts-with-a-specified-string)

I'm trying to check if a string starts with http. How can I do this check?

2010-05-07 18:43:37Z

I'm trying to check if a string starts with http. How can I do this check?If you're trying to make sure it's not another protocol. I'd use http:// instead, since https would also match, and other things such as http-protocol.com.And in general:Use strpos():Remember the three equals signs (===). It will not work properly if you only use two. This is because strpos() will return false if the needle cannot be found in the haystack.There is also the strncmp() function and strncasecmp() function which is perfect for this situation:In general:The advantage over the substr() approach is that strncmp() just does what needs to be done, without creating a temporary string.You can use a simple regex (updated version from user viriathus as eregi is deprecated)or if you want a case insensitive searchRegexes allow to perform more complex tasksPerformance wise, you don't need to create a new string (unlike with substr) nor parse the whole string if it doesn't start with what you want. You will have a performance penalty though the 1st time you use the regex (you need to create/compile it).You can check if your string starts with http or https using the small function below.Also work:

How to read a large file line by line?

adnan masood

[How to read a large file line by line?](https://stackoverflow.com/questions/13246597/how-to-read-a-large-file-line-by-line)

I want to read a file line by line, but without completely loading it in memory.My file is too large to open in memory, and if try to do so I always get out of memory errors.The file size is 1 GB.

2012-11-06 07:49:10Z

I want to read a file line by line, but without completely loading it in memory.My file is too large to open in memory, and if try to do so I always get out of memory errors.The file size is 1 GB.You can use the fgets() function to read the file line by line:You can use an object oriented interface class  for a file - SplFileObject http://php.net/manual/en/splfileobject.fgets.php (PHP 5 >= 5.1.0)If you're opening a big file, you probably want to use Generators alongside fgets() to avoid loading the whole file into memory:Use it like this:This way you can process individual file lines inside the foreach().Note: Generators require >= PHP 5.5There is a file() function that returns an array of the lines contained in the file.Use buffering techniques to read the file.The obvious answer wasn't there in all the responses.

PHP has a neat streaming delimiter parser available made for exactly that purpose.This how I manage with very big file (tested with up to 100G). And it's faster than fgets()Be careful with the 'while(!feof ... fgets()' stuff, fgets can get an error (returnfing false) and loop forever without reaching the end of file.  codaddict was closest to being correct but when your 'while fgets' loop ends, check feof; if not true, then you had an error.One of the popular solutions to this question will have issues with the new line character. It can be fixed pretty easy with a simple str_replace.SplFileObject is useful when it comes to dealing with large files.Function to Read with array return

Best Practices for Custom Helpers in Laravel 5

Calebe Oliveira

[Best Practices for Custom Helpers in Laravel 5](https://stackoverflow.com/questions/28290332/best-practices-for-custom-helpers-in-laravel-5)

I would like to create helper functions to avoid repeating code between views in Laravel 5:view.blade.phpThey're basically text formatting functions. Where and how can I create a file with these functions?

2015-02-03 02:25:12Z

I would like to create helper functions to avoid repeating code between views in Laravel 5:view.blade.phpThey're basically text formatting functions. Where and how can I create a file with these functions?Create a helpers.php file in your app folder and load it up with composer:After adding that to your composer.json file, run the following command:If you don't like keeping your helpers.php file in your app directory (because it's not a PSR-4 namespaced class file), you can do what the laravel.com website does: store the helpers.php in the bootstrap directory. Remember to set it in your composer.json file:This answer is applicable to general custom classes within Laravel. For a more Blade-specific answer, see Custom Blade Directives in Laravel 5.Step 1: Create your Helpers (or other custom class) file and give it a matching namespace.  Write your class and method:Step 2: Create an alias:Step 3: Run composer dump-autoload in the project rootStep 4: Use it in your Blade template:Extra Credit: Use this class anywhere in your Laravel app:Source: http://www.php-fig.org/psr/psr-4/Why it works: https://github.com/laravel/framework/blob/master/src/Illuminate/Support/ClassLoader.phpWhere autoloading originates from:

http://php.net/manual/en/language.oop5.autoload.phpmy initial thought was the composer autoload as well, but it didn't feel very Laravel 5ish to me. L5 makes heavy use of Service Providers, they are what bootstraps your application.To start off I created a folder in my app directory called Helpers. Then within the Helpers folder I added files for functions I wanted to add. Having a folder with multiple files allows us to avoid one big file that gets too long and unmanageable.Next I created a HelperServiceProvider.php by running the artisan command:Within the register method I added this snippetlastly register the service provider in your config/app.php in the providers arraynow any file in your Helpers directory is loaded, and ready for use.UPDATE 2016-02-22There are a lot of good options here, but if my answer works for you, I went ahead and made a package for including helpers this way. You can either use the package for inspiration or feel free to download it with Composer as well. It has some built in helpers that I use often (but which are all inactive by default) and allows you to make your own custom helpers with a simple Artisan generator. It also addresses the suggestion one responder had of using a mapper and allows you to explicitly define the custom helpers to load, or by default, automatically load all PHP files in your helper directory. Feedback and PRs are much appreciated!Github: browner12/helpersThis is what is suggested by JeffreyWay in this Laracasts Discussion.Having sifted through a variety of answers on SO and Google, I still couldn't find an optimal approach. Most answers suggest we leave the application and rely on 3rd party tool Composer to do the job, but I'm not convinced coupling to a tool just to include a file is wise.Andrew Brown's answer came the closest to how I think it should be approached, but (at least in 5.1), the service provider step is unnecessary. Heisian's answer highlights the use of PSR-4 which brings us one step closer. Here's my final implementation for helpers in views:First, create a helper file anywhere in your apps directory, with a namespace:  Next, alias your class in config\app.php, in the aliases array:And that should be all you need to do. PSR-4 and the alias should expose the helper to your views, so in your view, if you type:It should output:Yes, there is another way to do this!Step 1: Register a custom Blade directive:Step 2: Use your custom Blade directive:Outputs:THIS IS MY CUSTOM BLADE DIRECTIVE!!

Custom LinkSource: https://laravel.com/docs/5.1/blade#extending-bladeAdditional Reading: https://mattstauffer.co/blog/custom-conditionals-with-laravels-blade-directivesIf you want to learn how to best make custom classes that you can use anywhere, see Custom Classes in Laravel 5, the Easy WayThis is my HelpersProvider.php file:You should create a folder called Helpers under the app folder, then create file called whatever.php inside and add the string whatever inside the $helpers array.Done!I'm no longer using this option, I'm currently using composer to load static files like helpers.You can add the helpers directly at:For Custom Helper Libraries in my Laravel project, I have created a folder with name Libraries in my Laravel/App Directory and within Libraries directory, I have created various files for different helper libraries.After creating my helper files I simply include all those files in my composer.json file like thisand execute Since OP asked for best practices, I think we're still missing some good advices here.A single helpers.php file is far from a good practice. Firstly because you mix a lot of different kind of functions, so you're against the good coding principles. Moreover, this could hurt not only the code documentation but also the code metrics like Cyclomatic Complexity, Maintainability Index and Halstead Volume. The more functions you have the more it gets worse.Code documentation would be Ok using tools like phpDocumentor, but using Sami it won't render procedural files. Laravel API documentation is such a case - there's no helper functions documentation: https://laravel.com/api/5.4Code metrics can be analyzed with tools like PhpMetrics. Using PhpMetrics version 1.x to analyze Laravel 5.4 framework code will give you very bad CC/MI/HV metrics for both src/Illuminate/Foundation/helpers.php and src/Illuminate/Support/helpers.php files.Multiple contextual helper files (eg. string_helpers.php, array_helpers.php, etc.) would certainly improve those bad metrics resulting in an easier code to mantain. Depending on the code documentation generator used this would be good enough.It can be further improved by using helper classes with static methods so they can be contextualized using namespaces. Just like how Laravel already does with Illuminate\Support\Str and Illuminate\Support\Arr classes. This improves both code metrics/organization and documentation. Class aliases could be used to make them easier to use.Structuring with classes makes the code organization and documentation better but on the other hand we end up loosing those great short and easy to remember global functions. We can further improve that approach by creating function aliases to those static classes methods. This can be done either manually or dynamically.Laravel internally use the first approach by declaring functions in the procedural helper files that maps to the static classes methods. This might be not the ideal thing as you need to redeclare all the stuff (docblocks/arguments).

I personally use a dynamic approach with a HelperServiceProvider class that create those functions in the execution time:One can say this is over engineering but I don't think so. It works pretty well and contrary to what might be expected it does not cost relevant execution time at least when using PHP 7.x.Here's a bash shell script I created to make Laravel 5 facades very quickly.Run this in your Laravel 5 installation directory.Example:If you run that example, it will create the directories Facades and Providers under 'your_laravel_installation_dir/app/MyApp'.After it is done, it will display a message similar to the following:So update the Providers and Alias list in 'config/app.php'Run composer -o dumpautoloadThe "./app/MyApp/Facades/Helper.php" will originally look like this:Now just add your methods in "./app/MyApp/Facades/Helper.php".Here is what "./app/MyApp/Facades/Helper.php" looks like after I added a Helper function.This function expects a pattern and can accept an optional second boolean argument.If the current URL matches the pattern passed to it, it will output 'active' (or 'class="active"' if you add 'true' as a second argument to the function call).I use it to highlight the menu that is active.instead of including your custom helper class, you can actually add to your config/app.php file under aliases.should be look like this.and then to your Controller, include the Helper using the method 'use Helper' so you can simply call some of the method on your Helper class.or in resources view you can directly call the Helper class already.But this is still the developer coding style approach to be followed. We may have different way of solving problems, and i just want to share what i have too for beginners.Create custom helpers’ directory:

First create Helpers directory in app directory.

Create hlper class definition:

Let’s now create a simple helper function that will concatenate two strings. Create a new file MyFuncs.php in /app/Helpers/MyFuncs.php Add the following codenamespace App\Helpers; defines the Helpers namespace under App namespace.

class MyFuncs {…} defines the helper class MyFuncs.

public static function full_name($first_name,$last_name) {…}  defines a static function that accepts two string parameters and returns a concatenated stringHelpers service provide classService providers are used to auto load classes. We will need to define a service provider that will load all of our helper classes in /app/Helpers directory.Run the following artisan command:php artisan make:provider HelperServiceProviderThe file will be created in /app/Providers/HelperServiceProvider.phpAdd the following code:HERE,We now need to register the HelperServiceProvider and create an alias for our helpers.Open /config/app.php fileLocate the providers array variableAdd the following line Locate the aliases array variableAdd the following lineSave the changes

Using our custom helperWe will create a route that will call our custom helper function Open /app/routes.phpAdd the following route definitionHERE,First create helpers.php inside App\Http directory.

Then add the following code inside the composer.jsonNext run the following commandNow you can define your custom function inside the helpers.php file.Another Way that I used was:

1) created a file in app\FolderName\fileName.php and had this code inside it i.e2) After that in our blade that's it. and it worksBest Practice to write custom helpers is 1) Inside the app directory of the project root, create a folder named Helpers (Just to separate and structure the code).2) Inside the folder write psr-4 files or normal php filesIf the PHP files are in the format of psr-4 then it will be auto loaded, else add the following line in the composer.json which is inside the project root directoryInside the autoload key, create a new key named files to load files at the time of auto load,inside the files object add the path starting from app directory., here is an example.PS : try running composer dump-autoload if the file dosen't loaded.Create Helpers.php in app/Helper/Helpers.php Add in composer and composer updateuse in Controller use in view

change in config->app.php file call in viewin dir bootstrap\autoload.phpadd this file****

create new helper Use for the controller and any view file In laravel 5.3 and above, the laravel team moved all procedural files (routes.php) out of the app/ directory, and the entire app/ folder is psr-4 autoloaded. The accepted answer will work in this case but it doesn't feel right to me. So what I did was I created a helpers/ directory at the root of my project and put the helper files inside of that, and in my composer.json file I did this:This way my app/ directory is still a psr-4 autoloaded one, and the helpers are a little better organized. Hope this helps someone.There are some great answers here but i think this is the simplest.

In Laravel 5.4 (and prob earlier versions too) you can create a class somewhere convenient for you, eg App/Libraries/Helper.phpThen you can simply call it in your Blade template like this:If you don't want to use @inject then just make the 'uppercasePara' function as static and embed the call in your Blade template like this:No need for aliases. Laravel resolves the concrete class automatically.

Check if PHP session has already started

Logan

[Check if PHP session has already started](https://stackoverflow.com/questions/6249707/check-if-php-session-has-already-started)

I have a PHP file that is sometimes called from a page that has started a session and sometimes from a page that doesn't have session started. Therefore when I have session_start() on this script I sometimes get the error message for "session already started". For that I've put these lines:but this time I got this warning message:Is there a better way to check if session has already started?If I use @session_start will it make things work properly and just shut up the warnings?

2011-06-06 09:00:51Z

I have a PHP file that is sometimes called from a page that has started a session and sometimes from a page that doesn't have session started. Therefore when I have session_start() on this script I sometimes get the error message for "session already started". For that I've put these lines:but this time I got this warning message:Is there a better way to check if session has already started?If I use @session_start will it make things work properly and just shut up the warnings?Recommended way for versions of PHP >= 5.4.0 , PHP 7Reference: http://www.php.net/manual/en/function.session-status.phpFor versions of PHP < 5.4.0For versions of PHP prior to PHP 5.4.0:Though, IMHO, you should really think about refactoring your session management code if you don't know whether or not a session is started...That said, my opinion is subjective, and there are situations (examples of which are described in the comments below) where it may not be possible to know if the session is started.PHP 5.4 introduced session_status(), which is more reliable than relying on session_id().Consider the following snippet:So, to check whether a session is started, the recommended way in PHP 5.4 is now:you can do this, and it's really easy.Hope it helps :)Prior to PHP 5.4 there is no reliable way of knowing other than setting a global flag.Consider:Or:So, prior to PHP 5.4 you should set a global boolean.For all php versionCheck this :Source http://php.netUse session_id(), it returns an empty string if not set. It's more reliable than checking the $_COOKIE.hope it helps !This should work for all PHP versions. It determines the PHP version, then checks to see if the session is started based on the PHP version. Then if the session is not started it starts it.The only thing you need to do is:Not sure about efficiency of such solution, but this is from working project

This is also used if you need to define the default language@ before a function call suppresses any errors that may be reported during the function call.Adding a @ before session_start tells PHP to avoid printing error messages.For example:Using session_start() after you've already printed something to the browser results in an error so PHP will display something like "headers cannot be sent: started at (line 12)", @session_start() will still fail in this case, but the error message is not printed on screen.Before including the files or redirecting to new page use the exit() function, otherwise it will give an error. This code can be used in all cases:On PHP 5.3 this works for me:then you have. If you do not put the not at if statement beginning the session will start any way I do not why.  Response BASED on @Meliza Ramos Response(see first response) and http://php.net/manual/en/function.phpversion.php , ACTIONS:only use openSession()Actually, it is now too late to explain it here anyway as its been solved.

This was a .inc file of one of my projects where you configure a menu for a restaurant by selecting a dish and remove/add or change the order.

The server I was working at did not had the actual version so I made it more flexible. It's up to the authors wish to use and try it out.Is this code snippet work for you?You should reorganize your code so that you call session_start() exactly once per page execution.PHP_VERSION_ID is available as of PHP 5.2.7, so check this first and if necessary , create it. 

session_status is available as of PHP 5.4 , so we have to check this too:Based on my practice, before accessing the $_SESSION[] you need to call session_start every time to use the script. See the link below for manual.http://php.net/manual/en/function.session-start.phpFor me at least session_start is confusing as a name. A session_load can be more clear.i ended up with double check of status. php 5.4+You can use the following solution to check if a PHP session has already started:This is what I use to determine if a session has started. By using empty and isset as follows:Replace session_start(); with:

How to get the file extension in PHP? [duplicate]

Keith Power

[How to get the file extension in PHP? [duplicate]](https://stackoverflow.com/questions/10368217/how-to-get-the-file-extension-in-php)

I wish to get the file extension of an image I am uploading, but I just get an array back. Is there a way to just get the extension itself?

2012-04-28 22:46:11Z

I wish to get the file extension of an image I am uploading, but I just get an array back. Is there a way to just get the extension itself?No need to use string functions. You can use something that's actually designed for what you want: pathinfo():This will work as well:A better method is using strrpos + substr (faster than explode for that) :But, to check the type of a file, using mime_content_type is a better way :

http://www.php.net/manual/en/function.mime-content-type.phpYou could try with this for mime type$image['mime'] will return the mime type.This function doesn't require GD library. You can find the documentation here.This returns the mime type of the image.Some people use the $_FILES["file"]["type"] but it's not reliable as been given by the browser and not by PHP.You can use pathinfo() as ThiefMaster suggested to retrieve the image extension.First make sure that the image is being uploaded successfully while in development before performing any operations with the image.How about 

Convert from MySQL datetime to another format with PHP

Tim Boland

[Convert from MySQL datetime to another format with PHP](https://stackoverflow.com/questions/136782/convert-from-mysql-datetime-to-another-format-with-php)

I have a datetime column in MySQL. How can I convert it to the display as mm/dd/yy H:M (AM/PM) using PHP?

2008-09-25 23:10:30Z

I have a datetime column in MySQL. How can I convert it to the display as mm/dd/yy H:M (AM/PM) using PHP?If you're looking for a way to normalize a date into MySQL format, use the followingThe line $phpdate = strtotime( $mysqldate ) accepts a string and performs a series of heuristics to turn that string into a unix timestamp.The line $mysqldate = date( 'Y-m-d H:i:s', $phpdate ) uses that timestamp and PHP's date function to turn that timestamp back into MySQL's standard date format.(Editor Note: This answer is here because of an original question with confusing wording, and the general Google usefulness this answer provided even if it didnt' directly answer the question that now exists)To convert a date retrieved from MySQL into the format requested (mm/dd/yy H:M (AM/PM)):Refer to the PHP date formatting options to adjust the format.If you are using PHP 5, you can also tryReference: http://php.net/manual/en/function.date.phpFinally the right solution for PHP 5.3 and above:

(added optional Timezone to the Example like mentioned in the comments)An easier way would be to format the date directly in the MySQL query, instead of PHP.  See the MySQL manual entry for DATE_FORMAT.If you'd rather do it in PHP, then you need the date function, but you'll have to convert your database value into a timestamp first.Forget all. Just use:To correctly format a DateTime object in PHP for storing in MySQL use the standardised format that MySQL uses, which is ISO 8601.PHP has had this format stored as a constant since version 5.1.1, and I highly recommend using it rather than manually typing the string each time.This, and a list of other PHP DateTime constants are available at http://php.net/manual/en/class.datetime.php#datetime.constants.typesThis should format a field in an SQL query:Use the date function:Depending on your MySQL datetime configuration. Typically: 2011-12-31 07:55:13 format. This very simple function should do the magic:Or a bit more advance to match the question.If you dont want to change every function in your PHP code, to show the expected date format, change it at the source - your database.It is important to name the rows with the as operator as in the example above (as dateFrom, as dateUntil). The names you write there are the names, the rows will be called in your result.The output of this example will be [Day of the month, numeric (0..31)].[Month name (January..December)].[Year, numeric, four digits]Example: 5.August.2015Change the dots with the separator of choice and check the DATE_FORMAT(date,format) function for more date formats.You can also have your query return the time as a Unix timestamp. That would get rid of the need to call strtotime() and make things a bit less intensive on the PHP side...Then in PHP just use the date() function to format it whichever way you'd like.or I like this approach as opposed to using MySQL's DATE_FORMAT function, because it allows you to reuse the same query to grab the data and allows you to alter the formatting in PHP.It's annoying to have two different queries just to change the way the date looks in the UI.You can have trouble with dates not returned in Unix Timestamp, so this works for me...This will work...Using PHP version 4.4.9 & MySQL 5.0, this worked for me:PubDate is the column in MySQL.

Showing all errors and warnings [duplicate]

oshirowanen

[Showing all errors and warnings [duplicate]](https://stackoverflow.com/questions/5438060/showing-all-errors-and-warnings)

UPDATE 2:I have now removed the following from the .php file:I have set display_erros in php.ini as follows:Error reporting is set to the following in php.ini:After restarting Apache, I still get no errors/warnings.UPDATE 1:I have changed error_reporting in php.ini from:toAfter which I restarted Apache, e.g.But the page will still not display errors/warnings of any kind.ORIGINAL QUESTION:The following script is generating a warning because the $err being inside the if statement. Why is this warning not being displayed on the PHP page in a web browser?I have to look at the Apache logs to see the warning.  Also, if I deliberately change the "insert into" to "delete into", it does not display an error on the PHP page. Why are the errors not displaying on the actual PHP page?

2011-03-25 20:55:39Z

UPDATE 2:I have now removed the following from the .php file:I have set display_erros in php.ini as follows:Error reporting is set to the following in php.ini:After restarting Apache, I still get no errors/warnings.UPDATE 1:I have changed error_reporting in php.ini from:toAfter which I restarted Apache, e.g.But the page will still not display errors/warnings of any kind.ORIGINAL QUESTION:The following script is generating a warning because the $err being inside the if statement. Why is this warning not being displayed on the PHP page in a web browser?I have to look at the Apache logs to see the warning.  Also, if I deliberately change the "insert into" to "delete into", it does not display an error on the PHP page. Why are the errors not displaying on the actual PHP page?Display errors could be turned off in the php.ini or your Apache configuration file.You can turn it on in the script:You should see the same messages in the PHP error log.I was able to get all errors via the below code:Straight from the php.ini file:For pure development I go for:Also don't forget to put display_errors to onAfter that, restart your server for Apache on Ubuntu:PHP errors can be displayed by any of below methods:For more details:Displaying PHP errorsSet these on php.ini:From your PHP page, use a suitable filter for error reporting.Filers can be made according to requirements.You can see a detailed description here.

What's the difference between isset() and array_key_exists()? [duplicate]

Zacky112

[What's the difference between isset() and array_key_exists()? [duplicate]](https://stackoverflow.com/questions/3210935/whats-the-difference-between-isset-and-array-key-exists)

How do the following two function calls compare:

2010-07-09 08:14:23Z

How do the following two function calls compare:array_key_exists will definitely tell you if a key exists in an array, whereas isset will only return true if the key/variable exists and is not null.There is another important difference: isset doesn't complain when $a does not exist, while array_key_exists does.Between array_key_exists and isset, though both are very fast [O(1)], isset is significantly faster. If this check is happening many thousands of times, you'd want to use isset.It should be noted that they are not identical, though -- when the array key exists but the value is null, isset will return false and array_key_exists will return true. If the value may be null, you need to use array_key_exists.Answer to an old question as no answer here seem to address the 'warning' problem (explanation follows)Basically, in this case of checking if a key exists in an array, issetand array_key_existsSo how do we check if a key exists which value may be null in a variablewithout getting a warning, without missing the existing key when its value is null (what were the PHP devs thinking would also be an interesting question, but certainly not relevant on SO). And of course we don't want to use @It seems is_array should be involved in the equation, but it gives a warning if $var is not defined, so that could be a solution:which is likely to be faster if the tests are mainly on non-null values. Otherwise for an array with mostly null valueswill do the work.The main difference when working on arrays is that array_key_exists returns true when the value is null, while isset will return false when the array value is set to null.See isset on the PHP documentation site.The PHP function array_key_exists() determines if a particular key, or numerical index, exists for an element of an array. However, if you want to determine if a key exists and is associated with a value, the PHP language construct isset() can tell you that (and that the value is not null). array_key_exists()cannot return information about the value of a key/index.Function isset() is faster, check http://www.php.net/manual/en/function.array-key-exists.php#82867Complementing (as an algebraic curiosity) the  @deceze answer with the @ operator, and indicating cases where is "better" to use @ ... Not really better  if you need (no log and) micro-performance optimization:PS: you can change/correct/complement this text, it is a Wiki.The two are not exactly the same. I couldn't remember the exact differences, but they are outlined very well in What's quicker and better to determine if an array key exists in PHP?.The common consensus seems to be to use isset whenever possible, because it is a language construct and therefore faster. However, the differences should be outlined above.

How to secure database passwords in PHP?

user18359

[How to secure database passwords in PHP?](https://stackoverflow.com/questions/97984/how-to-secure-database-passwords-in-php)

When a PHP application makes a database connection it of course generally needs to pass a login and password. If I'm using a single, minimum-permission login for my application, then the PHP needs to know that login and password somewhere. What is the best way to secure that password? It seems like just writing it in the PHP code isn't a good idea.

2008-09-18 23:27:03Z

When a PHP application makes a database connection it of course generally needs to pass a login and password. If I'm using a single, minimum-permission login for my application, then the PHP needs to know that login and password somewhere. What is the best way to secure that password? It seems like just writing it in the PHP code isn't a good idea.Several people misread this as a question about how to store passwords in a database.  That is wrong.  It is about how to store the password that lets you get to the database.The usual solution is to move the password out of source-code into a configuration file.  Then leave administration and securing that configuration file up to your system administrators.  That way developers do not need to know anything about the production passwords, and there is no record of the password in your source-control.If you're hosting on someone else's server and don't have access outside your webroot, you can always put your password and/or database connection in a file and then lock the file using a .htaccess:The most secure way is to not have the information specified in your PHP code at all.If you're using Apache that means to set the connection details in your httpd.conf or virtual hosts file file. If you do that you can call mysql_connect() with no parameters, which means PHP will never ever output your information.This is how you specify these values in those files:Then you open your mysql connection like this:Or like this:Store them in a file outside web root.For extremely secure systems we encrypt the database password in a configuration file (which itself is secured by the system administrator). On application/server startup the application then prompts the system administrator for the decryption key. The database password is then read from the config file, decrypted, and stored in memory for future use. Still not 100% secure since it is stored in memory decrypted, but you have to call it 'secure enough' at some point!This solution is general, in that it is useful for both open and closed source applications.Advantages:This method is suggested by Heroku, who are very successful. if it is possible to create the database connection in the same file where the credentials are stored. Inline the credentials in the connect statement.Otherwise it is best to unset the credentials after the connect statement, because credentials that are not in memory, can't be read from memory ;)Your choices are kind of limited as as you say you need the password to access the database. One general approach is to store the username and password in a seperate configuration file rather than the main script. Then be sure to store that outside the main web tree. That was if there is a web configuration problem that leaves your php files being simply displayed as text rather than being executed you haven't exposed the password.Other than that you are on the right lines with minimal access for the account being used. Add to thatPeter If you are using PostgreSQL, then it looks in ~/.pgpass for passwords automatically.  See the manual for more information.Previously we stored DB user/pass in a configuration file, but have since hit paranoid mode -- adopting a policy of Defence in Depth.If your application is compromised, the user will have read access to your configuration file and so there is potential for a cracker to read this information.  Configuration files can also get caught up in version control, or copied around servers.We have switched to storing user/pass in environment variables set in the Apache VirtualHost. This configuration is only readable by root -- hopefully your Apache user is not running as root.The con with this is that now the password is in a Global PHP variable.To mitigate this risk we have the following precautions:Put the database password in a file, make it read-only to the user serving the files.Unless you have some means of only allowing the php server process to access the database, this is pretty much all you can do.If you're talking about the database password, as opposed to the password coming from a browser, the standard practice seems to be to put the database password in a PHP config file on the server.You just need to be sure that the php file containing the password has appropriate permissions on it. I.e. it should be readable only by the web server and by your user account.Just putting it into a config file somewhere is the way it's usually done. Just make sure you:We have solved it in this way:An additional trick is to use a PHP separate configuration file that looks like that :This does not prevent you from setting access rules properly. But in the case your web site is hacked, a "require" or an "include" will just exit the script at the first line so it's even harder to get the data.Nevertheless, do not ever let configuration files in a directory that can be accessed through the web. You should have a "Web" folder containing your controler code, css, pictures and js. That's all. Anything else goes in offline folders.Best way is to not store the password at all!

For instance, if you're on a Windows system, and connecting to SQL Server, you can use Integrated Authentication to connect to the database without a password, using the current process's identity.If you do need to connect with a password, first encrypt it, using strong encryption (e.g. using AES-256, and then protect the encryption key, or using asymmetric encryption and have the OS protect the cert), and then store it in a configuration file (outside of the web directory) with strong ACLs.

Correct file permissions for WordPress [closed]

John Crawford

[Correct file permissions for WordPress [closed]](https://stackoverflow.com/questions/18352682/correct-file-permissions-for-wordpress)

I've had a look over here but didn't find any details on the best file permissions.  I also took a look at some of WordPress's form's questions over here too but anybody that suggests 777 obviously needs a little lesson in security.In short my question is this.  What permissions should I have for the following:and then all the files in each of those folders?

2013-08-21 08:39:57Z

I've had a look over here but didn't find any details on the best file permissions.  I also took a look at some of WordPress's form's questions over here too but anybody that suggests 777 obviously needs a little lesson in security.In short my question is this.  What permissions should I have for the following:and then all the files in each of those folders?When you setup WP you (the webserver) may need write access to the files. So the access rights may need to be loose.After the setup you should tighten the access rights, according to Hardening WordPress all files except for wp-content should be writable by your user account only. wp-content must be writable by www-data too.Maybe you want to change the contents in wp-content later on. In this case you couldWhatever you do, make sure the files have rw permissions for www-data.Giving the full access to all wp files to www-data user (which is in this case the web server user) can be dangerous. 

So rather do NOT do this:It can be useful however in the moment when you're installing or upgrading WordPress and its plug-ins. But when you finished it's no longer a good idea to keep wp files owned by the web server.It basically allows the web server to put or overwrite any file in your website.

This means that there is a possibility to take over your site if someone manage to use the web server (or a security hole in some .php script) to put some files in your website.To protect your site against such an attack you should to the following:Source and additional information: http://codex.wordpress.org/Hardening_WordPressFor those who have their wordpress root folder under their home folder:** Ubuntu/apacheCREDIT Granting write permissions to www-data groupYou want to call usermod on your user. So that would be:** Assuming www-data group existsYou should get something like:** youUserGroupName is usually similar to you user name** mode of `/home/yourUserName/youWebSiteFolder/wp-content/' changed from 0755 (rwxr-xr-x) to 0775 (rwxrwxr-x)The result should look something like:Equivalent to:chmod -R ug+rw foldernamePermissions will be like 664 for files or 775 for directories.P.s. if anyone encounters error 'could not create directory' when updating a plugin, do:

server@user:~/domainame.com$ sudo chown username:www-data -R wp-content

when you are at the root of your domain.

Assuming: wp-config.php has

FTP credentials on LocalHost

define('FS_METHOD','direct');Best to read the wordpress documentation on this https://wordpress.org/support/article/changing-file-permissions/I set permissions to:In my case I created a specific user for WordPress which is different from the apache default user that prevent access from the web to those files owned by that user.Then it gives permission to apache user to handle the upload folder and finally set secure enough file and folder permissions.EDITEDIf you're using W3C Total Cache you should do the next also:Then it'll work!EDITEDAfter a while developing WordPress sites I'd recommend different file permissions per environment:In production, I wouldn't give access to users to modify the filesystem, I'll only allow them to upload resources and give access to some plugins specific folders to do backups, etc. But managing projects under Git and using deploy keys on the server, it isn't good update plugins on staging nor production. I leave here the production file setup:www-data:www-data = apache or nginx user and groupStaging will share the same production permissions as it should be a clone of it.Finally, development environment will have access to update plugins, translations, everything...www-data:www-data = apache or nginx user and group

your-user:root-group = your current user and the root groupThese permissions will give you access to develop under themes and your-plugin folder without asking permission. The rest of the content will be owned by the Apache or Nginx user to allow WP to manage the filesystem.Before creating a git repo first run these commands:Correct permissions for the file is 644

Correct permissions for the folder is 755To change the permissions , use terminal and following commands.755 for folders and 644 for files.I think the below rules are recommended for a default wordpress site:It actually depends on the plugins you plan to use as some plugins change the root document of the wordpress. but generally I recommend something like this for the wordpress directory.This will assign the "root" (or whatever the user you are using) as the user in every single file/folder, R means recursive, so it just doesn't stop at the "html" folder. if you didn't use R, then it only applicable to the "html" directory. This will set the owner/group of "wp-content" to "www-data" and thus allowing the web server to install the plugins through the admin panel. This will set the permission of every single file in "html" folder (Including files in subdirectories) to 644, so outside people can't execute any file, modify any file, group can't execute any file,  modify any file and only the user is allowed to modify/read files, but still even the user can't execute any file. This is important because it prevents any kind of execution in "html" folder, also since the owner of the html folder and all other folders except the wp-content folder are "root" (or your user),  the www-data can't modify any file outside of the wp-content folder, so even if there is any vulnerability in the web server, and if someone accessed to the site unauthorizedly, they can't delete the main site except the plugins. This will restrict the permission of accessing to "wp-config.php" to user/group with rw-r----- these permissions. And if a plugin or update complained it can't update, then access to the SSH and use this command, and grant the temporary permission to "www-data" (web server) to update/install through the admin panel, and then revert back to the "root" or your user once it's completed. And in Nginx (same procedure for the apache)to protect the wp-admin folder from unauthorized accessing, and probing. apache2-utils is required for encrypting the  password even if you have nginx installed, omit c if you plan to add more users to the same file.Now visit this location Use this codes to protect "wp-admin" folder with a password, now it will ask the password/username if you tried to access to the "wp-admin". notice, here you use the ".htpasswd" file which contains the encrypted password. Now restart the nginx. Commands:Where ftp-user is what user you are using to upload the filesTo absolutely make sure that your website is secure and you are using correct permissions for your folders, use a security plugin like these:https://en-ca.wordpress.org/plugins/all-in-one-wp-security-and-firewall/https://en-ca.wordpress.org/plugins/wordfence/These plugins will scan your Wordpress installation and notify you about any potential issues. These will also warn you about any insecure folder permissions. In addition to that, these plugins will recommend you what permissions should be assigned to the folders.I can't tell you whether or not this is correct, but I am using a Bitnami image over Google Compute App Engine. I has having problems with plugins and migration, and after further messing things up by chmod'ing permissions, I found these three lines which solved all my problems. Not sure if it's the proper way but worked for me.For OS X use this command:Define in wp_config file.chown - changes ownership of files/dirs. Ie. owner of the file/dir changes to the specified one, but it doesn't modify permissions.Based on all the reading and agonizing on my own sites and after having been hacked I have come up with the above list that includes permissions for a security plugin for Wordpress called Wordfence. (Not affiliated with it)In our example, the wordpress document root is 

    /var/www/html/example.com/public_htmlOpen up the permissions so that www-data can write to the document root as follows:Now from the dashboard in your site, as an admin you can perform updates.Secure Site after Updates are finished by following these steps:The above command changes permissions of everything in the wordpress install to the wordpress FTP user.The above command ensures that the security plugin Wordfence has access to its logs. The uploads directory is also writeable by www-data.The above command also ensures that the security plugin has required read write access for its proper function.Directory and Files PermissionsSet the permissions for wp-config.php to 640 so that only wp-user can read this file and no one else. Permissions of 440 didn't work for me with above file ownership.Wordpress automatic updates using SSH were working with fine with PHP5 but broke with PHP7.0 due to problems with php7.0-ssh2 bundeld with Ubuntu 16.04 and I couldn't find how to install the right version and make it work. Fortunately a very reliable plugin called ssh-sftp-updater-support (free) makes automatic updates using SFTP possible without need for libssh2. So the above permissions never have to be loosened except in rare cases as needed.

urlencode vs rawurlencode?

Gary Willoughby

[urlencode vs rawurlencode?](https://stackoverflow.com/questions/996139/urlencode-vs-rawurlencode)

If I want to create a URL using a variable I have two choices to encode the string. urlencode() and rawurlencode().What exactly are the differences and which is preferred?

2009-06-15 13:33:35Z

If I want to create a URL using a variable I have two choices to encode the string. urlencode() and rawurlencode().What exactly are the differences and which is preferred?It will depend on your purpose. If interoperability with other systems is important then it seems rawurlencode is the way to go. The one exception is legacy systems which expect the query string to follow form-encoding style of spaces encoded as + instead of %20 (in which case you need urlencode).rawurlencode follows RFC 1738 prior to PHP 5.3.0 and RFC 3986 afterwards (see http://us2.php.net/manual/en/function.rawurlencode.php)Note on RFC 3986 vs 1738. rawurlencode prior to php 5.3 encoded the tilde character (~) according to RFC 1738. As of PHP 5.3, however, rawurlencode follows RFC 3986 which does not require encoding tilde characters.urlencode encodes spaces as plus signs (not as %20 as done in rawurlencode)(see http://us2.php.net/manual/en/function.urlencode.php)This corresponds to the definition for application/x-www-form-urlencoded in RFC 1866.Additional Reading:You may also want to see the discussion at http://bytes.com/groups/php/5624-urlencode-vs-rawurlencode.Also, RFC 2396 is worth a look. RFC 2396 defines valid URI syntax. The main part we're interested in is from 3.4 Query Component: As you can see, the + is a reserved character in the query string and thus would need to be encoded as per RFC 3986 (as in rawurlencode).Proof is in the source code of PHP.I'll take you through a quick process of how to find out this sort of thing on your own in the future any time you want. Bear with me, there'll be a lot of C source code you can skim over (I explain it). If you want to brush up on some C, a good place to start is our SO wiki.Download the source (or use http://lxr.php.net/ to browse it online), grep all the files for the function name, you'll find something such as this:PHP 5.3.6 (most recent at time of writing) describes the two functions in their native C code in the file url.c.RawUrlEncode()UrlEncode()Okay, so what's different here?They both are in essence calling two different internal functions respectively: php_raw_url_encode and php_url_encodeSo go look for those functions!One quick bit of knowledge before I move forward, EBCDIC is another character set, similar to ASCII, but a total competitor. PHP attempts to deal with both. But basically, this means byte EBCDIC 0x4c byte isn't the L in ASCII, it's actually a <. I'm sure you see the confusion here.Both of these functions manage EBCDIC if the web server has defined it.Also, they both use an array of chars (think string type) hexchars look-up to get some values, the array is described as such:Beyond that, the functions are really different, and I'm going to explain them in ASCII and EBCDIC.URLENCODE:RAWURLENCODE:Note: Many programmers have probably never seen a for loop iterate this way, it's somewhat hackish and not the standard convention used with most for-loops, pay attention, it assigns x and y, checks for exit on len reaching 0, and increments both x and y. I know, it's not what you'd expect, but it's valid code.Differences:They basically iterate differently, one assigns a + sign in the event of ASCII 20.URLENCODE:RAWURLENCODE:Disclaimer: I haven't touched C in years, and I haven't looked at EBCDIC in a really really long time. If I'm wrong somewhere, let me know.Based on all of this, rawurlencode is the way to go most of the time. As you see in Jonathan Fingland's answer, stick with it in most cases. It deals with the modern scheme for URI components, where as urlencode does things the old school way, where + meant "space."If you're trying to convert between the old format and new formats, be sure that your code doesn't goof up and turn something that's a decoded + sign into a space by accidentally double-encoding, or similar "oops" scenarios around this space/20%/+ issue.If you're working on an older system with older software that doesn't prefer the new format, stick with urlencode, however, I believe %20 will actually be backwards compatible, as under the old standard %20 worked, just wasn't preferred. Give it a shot if you're up for playing around, let us know how it worked out for you.Basically, you should stick with raw, unless your EBCDIC system really hates you. Most programmers will never run into EBCDIC on any system made after the year 2000, maybe even 1990 (that's pushing, but still likely in my opinion).yieldswhileyieldsThe difference being the asd%20asd vs asd+asdurlencode differs from RFC 1738 by encoding spaces as + instead of %20One practical reason to choose one over the other is if you're going to use the result in another environment, for example JavaScript.In PHP urlencode('test 1') returns 'test+1' while rawurlencode('test 1') returns 'test%201' as result.But if you need to "decode" this in JavaScript using decodeURI() function then decodeURI("test+1") will give you "test+1" while decodeURI("test%201") will give you "test 1" as result.In other words the space (" ") encoded by urlencode to plus ("+") in PHP will not be properly decoded by decodeURI in JavaScript.In such cases the rawurlencode PHP function should be used.I believe spaces must be encoded as:The following example shows the correct use of rawurlencode and urlencode:Output:What happens if you encode path and query string components the other way round? For the following example:The difference is in the return values, i.e:urlencode():rawurlencode():The two are very similar, but the latter (rawurlencode) will replace spaces with a '%' and two hex digits, which is suitable for encoding passwords or such, where a '+' is not e.g.:The only difference is in the way spaces are treated:urlencode - based on legacy implementation converts spaces to +rawurlencode - based on RFC 1738 translates spaces to %20The reason for the difference is because + is reserved and valid (unencoded) in urls.  Fair enough, I have a simple strategy that I follow when making these decisions which I will share with you in the hope that it may help.I think it was the HTTP/1.1 specification RFC 2616 which called for "Tolerant applications" When faced with questions like these the best strategy is always to consume as much as possible and produce what is standards compliant.So my advice is to use rawurlencode to produce standards compliant RFC 1738 encoded strings and use urldecode to be backward compatible and accomodate anything you may come across to consume.Now you could just take my word for it but lets prove it shall we...It would appear that PHP had exactly this in mind, even though I've never come across anyone refusing either of the two formats, I cant think of a better strategy to adopt as your defacto strategy, can you? nJoy!The biggest reason I've seen to use rawurlencode() in most cases is because urlencode encodes text spaces as + (plus signs) where rawurlencode encodes them as the commonly-seen %20:I have specifically seen certain API endpoints that accept encoded text queries expect to see %20 for a space and as a result, fail if a plus sign is used instead. Obviously this is going to differ between API implementations and your mileage may vary.I believe urlencode is for query parameters, whereas the rawurlencode is for the path segments. This is mainly due to %20 for path segments vs + for query parameters. See this answer which talks about the spaces: When to encode space to plus (+) or %20?However %20 now works in query parameters as well, which is why rawurlencode is always safer. However the plus sign tends to be used where user experience of editing and readability of query parameters matter.Note that this means rawurldecode does not decode + into spaces (http://au2.php.net/manual/en/function.rawurldecode.php). This is why the $_GET is always automatically passed through urldecode, which means that + and %20 are both decoded into spaces.If you want the encoding and decoding to be consistent between inputs and outputs and you have selected to always use + and not %20 for query parameters, then urlencode is fine for query parameters (key and value).The conclusion is:Path Segments - always use rawurlencode/rawurldecodeQuery Parameters - for decoding always use urldecode (done automatically), for encoding, both rawurlencode or urlencode is fine, just choose one to be consistent, especially when comparing URLs.simple 

* rawurlencode the path 

- path is the part before the "?"

- spaces must be encoded as %20 

* urlencode the query string 

- Query string is the part after the "?"

-spaces are better encoded as "+"

= rawurlencode is more compatible generally 

How to find the php.ini file used by the command line?

Amokrane Chentir

[How to find the php.ini file used by the command line?](https://stackoverflow.com/questions/2750580/how-to-find-the-php-ini-file-used-by-the-command-line)

I need to enable pdo_mysql in my EasyPhp environment, so I went to php.ini file and uncommented the following line:Unfortunately I still have the same problem.

I'm using the CLI so I suppose I need to locate the php.ini file used by the CLI. How can I find it?

2010-05-01 15:53:00Z

I need to enable pdo_mysql in my EasyPhp environment, so I went to php.ini file and uncommented the following line:Unfortunately I still have the same problem.

I'm using the CLI so I suppose I need to locate the php.ini file used by the CLI. How can I find it?Just run php --ini and look for Loaded Configuration File in output for the location of php.ini used by your CLIYou can get a full phpinfo() using :And, in there, there is the php.ini file used :On Windows use find instead:You can use get_cfg_var('cfg_file_path') for that:

And you can simply set the location of the php.ini. You're using the command line version, so using the -c parameter you can specifiy the location, e.g.Run php --ini in your terminal, you'll get all details about ini filesFor more, use helping command php --help It'll display all the possible options. Somtimes things aren't always as they seem when in comes to config files in general. So here I'm applying my usual methods for exploring what files are opened by a process.I use a very powerful and useful command-line program called strace to show me what's really going on behind my back!Strace digs out kernel (system) calls that your program makes and dumps the output into the file specified by -oIt's easy to use grep to search for occurrences of php.ini in this log. It's pretty obvious looking at the following typical response to see what is going on.If you want all the configuration files loaded, this is will tell you:Some systems load things from more than one ini file. On my ubuntu system, it looks like this:On OSX Mavericks, running:Returned:In the /etc/ directory was:(as well as php-fpm.conf.default)I was able to copy php.ini.default to php.ini, add date.timezone = "US/Central" to the top (right below [php]), and the problem is solved. (At least the error message is gone.)If you need to pass it to another app, you can do something like:returns the path only. php -c $(php --ini | grep Loaded | cut -d" " -f12) will pass in the config file (useful for fpm)From what I remember when I used to use EasyPHP, the php.ini file is either in C:\Windows\ or C:\Windows\System32Do This will output all files named php.ini.Find out which one you're using, usually apache2/php.iniIn your php.ini file set your extension directory, e.g:You will see in you PHP folder there is an ext folder with all the dll's and extensions.Save CLI phpinfo output into local file:In docker container  phpmyadmin/phpmyadmin no php.ini file. But there are two files :

 php.ini-debug and php.ini-productionTo solve the problem, simply rename one of the files to php.ini and restart docker container.There is no php.ini used by the command line. You have to copy the file from ...EasyPHP-<<version>>\apache\php.ini  to ...EasyPHP-<<version>>\php\php.ini than edit the one in php directoryReference:

How to Create Multiple Where Clause Query Using Laravel Eloquent?

veksen

[How to Create Multiple Where Clause Query Using Laravel Eloquent?](https://stackoverflow.com/questions/19325312/how-to-create-multiple-where-clause-query-using-laravel-eloquent)

I'm using the Laravel Eloquent query builder and I have a query where I want a WHERE clause on multiple conditions. It works, but it's not elegant. Example:Is there a better way to do this, or should I stick with this method?

2013-10-11 18:56:44Z

I'm using the Laravel Eloquent query builder and I have a query where I want a WHERE clause on multiple conditions. It works, but it's not elegant. Example:Is there a better way to do this, or should I stick with this method?In Laravel 5.3 (and still true as of 6.x) you can use more granular wheres passed as array:Personally I haven't found use-case for this over just multiple where calls, but fact is you can use it.Since June 2014 you can pass an array to whereAs long as you want all the wheres use and operator, you can group them this way:Then:The above will result in such query:Query scopes may help you to let your code more readable. http://laravel.com/docs/eloquent#query-scopesUpdating this answer with some example: In your model, create scopes methods like this: Then, you can call this scopes while building your query: You can use subqueries in anonymous function like this:In this case you could use something like this:It should supply you with a query like:Conditions using Array:Will produce query like bellow:Conditions using Antonymous Function:Will produce query like bellow:Multiple where clauses finally getting the resultThe whereColumn method can be passed an array of multiple conditions. These conditions will be joined using the and operator.Example:For more information check this section of the documentation

https://laravel.com/docs/5.4/queries#where-clausesORORBe sure to apply any other filters to sub queries, otherwise the or might gather all records.You can use eloquent in Laravel 5.3All resultsPartial resultsWithout a real example, it is difficult to make a recommendation.  However, I've never needed to use that many WHERE clauses in a query and it may indicate a problem with the structure of your data.It may be helpful for you to learn about data normalization:

http://en.wikipedia.org/wiki/Third_normal_formuse whereIn condition and pass the array$array = [1008,1009,1010];User::whereIn('users.id',  $array)->get();You can use array in where clause as shown in below.Use ThisAs per my suggestion if you are doing filter or searching then you should go with :Using pure Eloquent, implement it like so. This code returns all logged in users whose accounts are active. 

  $users = \App\User::where('status', 'active')->where('logged_in', true)->get();

What is the difference between bindParam and bindValue?

koen

[What is the difference between bindParam and bindValue?](https://stackoverflow.com/questions/1179874/what-is-the-difference-between-bindparam-and-bindvalue)

What is the difference between PDOStatement::bindParam() and PDOStatement::bindValue()?

2009-07-24 20:00:58Z

What is the difference between PDOStatement::bindParam() and PDOStatement::bindValue()?The answer is in the documentation for bindParam:And executeExample:orFrom the manual entry for PDOStatement::bindParam:So, for example:or Here are some I can think about :With some DB engines, stored procedures can have parameters that can be used for both input (giving a value from PHP to the procedure) and ouput (returning a value from the stored proc to PHP) ; to bind those parameters, you've got to use bindParam, and not bindValue.From Prepared statements and stored procedures Use bindParam to insert multiple rows with one time binding:For the most common purpose, you should use bindValue.bindParam has two tricky or unexpected behaviors:Source: http://php.net/manual/en/pdostatement.bindparam.php#94711The simplest way to put this into perspective for memorization by behavior (in terms of PHP):You don't have to struggle any longer, when there exists a way lilke this:

Fastest way to check if a string is JSON in PHP?

Kirk Ouimet

[Fastest way to check if a string is JSON in PHP?](https://stackoverflow.com/questions/6041741/fastest-way-to-check-if-a-string-is-json-in-php)

I need a really, really fast method of checking if a string is JSON or not. I feel like this is not the best way:Any performance enthusiasts out there want to improve this method?

2011-05-18 08:18:03Z

I need a really, really fast method of checking if a string is JSON or not. I feel like this is not the best way:Any performance enthusiasts out there want to improve this method?The function json_last_error returns the last error occurred during the JSON encoding and decoding. So the fastest way to check the valid JSON isNote that json_last_error is supported in PHP >= 5.3.0 only.It is always good to know the exact error during the development time. Here is full program to check the exact error based on PHP docs.Since json_last_error is not supported in PHP 5.2, you can check if the encoding or decoding returns boolean FALSE. Here is an exampleHope this is helpful. Happy Coding!All you really need to do is this...This request does not require a separate function even. Just wrap is_object around json_decode and move on. Seems this solution has people putting way too much thought into it.Using json_decode to "probe" it might not actually be the fastest way. If it's a deeply nested structure, then instantiating a lot of objects of arrays to just throw them away is a waste of memory and time. So it might be faster to use preg_match and the RFC4627 regex to also ensure validity:The same in PHP:Not enough of a performance enthusiast to bother with benchmarks here however. This will return true if your string represents a json array or object:It rejects json strings that only contains a number, string or boolean, although those strings are technically valid json.It is the shortest way I can come up with.The simplest and fastest way that I use is following;It is because  json_decode() returns NULL if the entered string is not json or invalid json.   If you have to validate your JSON in multiple places, you can always use the following function.In the above function, you will get true in return if it is a valid JSON.http://tr.php.net/manual/en/function.json-decode.php return value is null when invalid encoding detected.You must validate your input to make sure the string you pass is not empty and is, in fact, a string. An empty string is not valid JSON.I think in PHP it's more important to determine if the JSON object even has data, because to use the data you will need to call json_encode() or json_decode(). I suggest denying empty JSON objects so you aren't unnecessarily running encodes and decodes on empty data.Easy method is to check the json result..This will do it:As shown in other answers, json_last_error() returns any error from our last json_decode(). However there are some edge use cases where this function alone is not comprehensive enough. For example, if you json_decode() an integer (eg: 123), or a string of numbers with no spaces or other characters (eg: "123"), the json_last_error() function will not catch an error.To combat this, I've added an extra step that ensures the result of our json_decode() is either an object or an array. If it's not, then we return false.To see this in action, check these two examples:in GuzzleHttp:Earlier i was just checking for a null value, which was wrong actually.The above piece of code works fine with strings. However as soon as i provide number, it breaks up.for example.To fix it what i did was very simple.Another simple wayWe need to check if passed string is not numeric because in this case json_decode raises no error.I've tried some of those solution but nothing was working for me. I try this simple thing :I think it's a fine solutiuon since JSON decode without the second parameter give an object.EDIT : If you know what will be the input, you can adapt this code to your needs. In my case I know I have a Json wich begin by "{", so i don't need to check if it's an array.Should be something like this:UnitTestUsing PHPBench with the following class, the below results were achieved:Conclusion: The fastest way to check if json is valid is to return json_decode($json, true) !== null).I don't know about performance or elegance of my solution, but it's what I'm using:Since all my JSON encoded strings start with {" it suffices to test for this with a RegEx. I'm not at all fluent with RegEx, so there might be a better way to do this. Also: strpos() might be quicker.Just trying to give in my tuppence worth.P.S. Just updated the RegEx string to /^[\[\{]\"/ to also find JSON array strings. So it now looks for either [" or {" at the beginning of the string.Expanding on this answer How about the following:Hi here's a little snippet from my library, in this first condition I'm just checking if the data is json then return it if correctly decoded, please note the substr usage for performance ( I haven't seen yet any json file not begining neither by { or [I found this question after coming across something similar in my work, yesterday. My solution in the end was a hybrid of some of the approaches above:The custom functionCasesResourceshttps://gist.github.com/rafasashi/93d06bae83cc1a1f440bFreshly-made function for PHP 5.2 compatibility, if you need the decoded data on success:Usage:Some tests:A simple modification to henrik's answer to touch most required possibilities.The fastest way to maybe decode a possible JSON object to a PHP object/array:Another suggestion from me :)Here's a performant and simple function I created (which uses basic string validation before using json_decode for larger strings):

Why would one omit the close tag?

danidacar

[Why would one omit the close tag?](https://stackoverflow.com/questions/4410704/why-would-one-omit-the-close-tag)

I keep reading it is poor practice to use the PHP close tag ?> at the end of the file. The header problem seems irrelevant in the following context (and this is the only good argument so far): Every good practice book and wiki starts with this 'rule' but nobody offers good reasons.

Is there another good reason to skip the ending PHP tag?

2010-12-10 16:00:39Z

I keep reading it is poor practice to use the PHP close tag ?> at the end of the file. The header problem seems irrelevant in the following context (and this is the only good argument so far): Every good practice book and wiki starts with this 'rule' but nobody offers good reasons.

Is there another good reason to skip the ending PHP tag?Sending headers earlier than the normal course may have far reaching consequences. Below are just a few of them that happened to come to my mind at the moment:Bonus: a few gotchas (actually currently one) related to these 2 characters:The reason you should leave off the php closing tag (?>) is so that the programmer doesn't accidentally send extra newline chars.The reason you shouldn't leave off the php closing tag is because it causes an imbalance in the php tags and any programmer with half a mind can remember to not add extra white-space.So for your question:No, there isn't another good reason to skip the ending php tags.I will finish with some arguments for not bothering with the closing tag:It's a newbie coding style recommendation, well-intentioned, and advised by the manual.Discouraging any use of the ?> close tag merely delays explaining basic PHP processing behaviour and language semantics to eschew infrequent issues. It is practical still for collaborative software development due to proficiency variations in participants.So there are context-dependent but practical alternatives to an imperative close tag omission.Manual babysitting of ?> close tags is not very contemporary either way. There always have been automation tools for that (even if just sed/awk or regex-oneliners). In particular:Which could generally be used to --unclose php tags for third-party code, or rather just fix any (and all) actual whitespace/BOM issues:It also handles --long tag conversion etc. for runtime/configuration compatibility.It isn't a tag…But if you have it, you risk having white space after it. If you then use it as an include at the top of a document, you could end up inserting white space (i.e. content) before you attempt to send HTTP headers … which isn't allowed.It's pretty useful not to let the closing ?> in.The file stays valid to PHP (not a syntax error) and as @David Dorward said it allows to avoid having white space / break-line (anything that can send a header to the browser) after the ?>.For example,won't be valid.But will.For once, you must be lazy to be secure.According to the docs, it's preferable to omit the closing tag if it's at the end of the file for the following reason:PHP Manual > Language Reference >  Basic syntax > PHP tags Well, I know the reason, but I can't show it:Source: http://framework.zend.com/manual/en/coding-standard.php-file-formatting.htmlWell, there are two ways of looking at it.  If you believe the first route, then all PHP files require closing end tags. To omit them will create an invalid XML file. Then again, without having an opening <?xml version="1.0" charset="latin-1" ?> declaration, you won't have a valid XML file anyway...  So it's not a major issue...If you believe the second route, that opens the door for two types of .php files:Based on that, code-only files are OK to end without a closing ?> tag. But the XML-code files are not OK to end without a closing ?> since it would invalidate the XML.But I know what you're thinking. You're thinking what does it matter, you're never going to render a PHP file directly, so who cares if it's valid XML. Well, it does matter if you're designing a template. If it's valid XML/HTML, a normal browser will simply not display the PHP code (it's treated like a comment). So you can mock out the template without needing to run the PHP code within...I'm not saying this is important. It's just a view that I don't see expressed too often, so what better place to share it...Personally, I do not close tags in library files, but do in template files... I think it's a personal preference (and coding guideline) based more than anything hard...In addition to everything that's been said already, I'm going to throw in another reason that was a huge pain for us to debug.Apache 2.4.6 with PHP 5.4 actually segmentation faults on our production machines when there's empty space behind the closing php tag. I just wasted hours until I finally narrowed down the bug with strace.Here is the error that Apache throws:"Is there another good reason (other than the header problem) to skip the ending php tag?"You don't want to inadvertently output extraneous whitepace characters when generating binary output, CSV data, or other non-HTML output.I would say that the arguments in favor of omitting the tag look stronger (helps to avoid big headache with header() + it's PHP/Zend "recommendation"). I admit that this isn't the most "beautiful" solution I've ever seen in terms of syntax consistency, but what could be better ?As my question was marked as duplicate of this one, I think it's O.K. to post why NOT omitting closing tag ?> can be for some reasons desired.Nothing prevents you from writing valid XML/HTML/SGML code. PHP documentation is aware of this. Excerpt:Of course PHP syntax is not strict SGML/XML/HTML and you create a document, which is not SGML/XML/HTML, just like you can turn HTML into XHTML to be XML compliant or not.If I understand the question correctly, it has to do with output buffering and the affect this might have on closing/ending tags.  I am not sure that is an entirely valid question.  The problem is that the output buffer does not mean all content is held in memory before sending it out to the client.  It means some of the content is.The programmer can purposely flush the buffer, or the output buffer so does the output buffer option in PHP really change how the closing tag affects coding?  I would argue that it does not.  And maybe that is why most of the answers went back to personal style and syntax.There are 2 possible use of php code:in case 1. the closing tag is totally unusefull, also I would like to see just 1 (one) php open tag and NO (zero) closing tag in such a case. This is a good practice as it make code clean and separate logic from presentation.

For presentation case (2.) some found it is natural to close all tags (even the PHP-processed ones), that leads to confution, as the PHP has in fact 2 separate use case, that should not be mixed: logic/calculus and presentation

PHP cURL custom headers

123

[PHP cURL custom headers](https://stackoverflow.com/questions/8115683/php-curl-custom-headers)

I'm wondering if/how you can add custom headers to a cURL HTTP request in PHP. I'm trying to emulate how iTunes grabs artwork and it uses these non-standard headers:How could I add these headers to a request?

2011-11-13 23:35:07Z

I'm wondering if/how you can add custom headers to a cURL HTTP request in PHP. I'm trying to emulate how iTunes grabs artwork and it uses these non-standard headers:How could I add these headers to a request?http://www.php.net/manual/en/function.curl-setopt.phpUse the following SyntaxHere is one basic function:Usage example:

How to override trait function and call it from the overridden function?

Shu

[How to override trait function and call it from the overridden function?](https://stackoverflow.com/questions/11939166/how-to-override-trait-function-and-call-it-from-the-overridden-function)

Scenario:This code doesn't work, and I cannot find a way to call a trait function like it was inherited. I tried calling self::calc($v), static::calc($v), parent::calc($v), A::calc($v) and the following:Nothing works.  Is there a way to make it work or must I override completely the trait function which is much more complex than this :)

2012-08-13 17:19:28Z

Scenario:This code doesn't work, and I cannot find a way to call a trait function like it was inherited. I tried calling self::calc($v), static::calc($v), parent::calc($v), A::calc($v) and the following:Nothing works.  Is there a way to make it work or must I override completely the trait function which is much more complex than this :)Your last one was almost there:The trait is not a class. You can't access its members directly. It's basically just automated copy and paste...If the class implements the method directly, it will not use the traits version.  Perhaps what you are thinking of is:Because the child classes do not implement the method directly, they will first use that of the trait if there otherwise use that of the parent class.If you want, the trait can use method in the parent class (assuming you know the method would be there) e.g.You can also provide for ways to override, but still access the trait method as follows:You can see it work at http://sandbox.onlinephpfunctions.com/code/e53f6e8f9834aea5e038aec4766ac7e1c19cc2b5An alternative approach if interested - with an extra intermediate class to use the normal OOO way. This simplifies the usage with parent::methodname Using another trait:

Laravel 5 Failed opening required bootstrap/../vendor/autoload.php

Scott

[Laravel 5 Failed opening required bootstrap/../vendor/autoload.php](https://stackoverflow.com/questions/28468625/laravel-5-failed-opening-required-bootstrap-vendor-autoload-php)

I have recently installed Laravel 5 via composer. I tried creating a new controller using artisan and I get the following error:Am I missing something?

2015-02-12 03:11:08Z

I have recently installed Laravel 5 via composer. I tried creating a new controller using artisan and I get the following error:Am I missing something?Run composer with --no-scripts This shall fix the issue. I tried this on Mac and Linux.Which OS you are using ?

For Windows :

Go to Command Promptset path to www/{ur project}For me : www/laravel5Then type this command :  composer installIt will automatically install all dependency in vendor/Run composer install in your root project folder (or php composer.phar install).Turns out I didn't enable openssl in my php.ini so when I created my new project with composer it was installed from source. I changed that and ran now the vendor folder was created.Did you create a new project or did you clone an existing project?If you cloned an existing project it's very important to runThat way all the dependencies that are missing will be installed.But if you create a new project you should run this command to make a new project using composerI encountered the same problem. It occurred because composer was not able to install the dependencies specified in composer.json file.

try running If this does not solve the problem, make sure

the following php modules are installed

php-mbstring

php-domTo install this extensions run the following in terminalonce the installation is completetry running the command in your project root folderJust run this inside the directory where you installed your projectYou need to regenerate autoload.php file. you can use dump-autoload to do that without having to go through an install or update.useto generate autoload.php file again in /vendor directory.Following this below step solved my problem. You may tryAfter checking php version and a lot of research , the problem was on Composer side so just run the following commandcomposer install --ignore-platform-reqsWhen the new project created the laravel require to load vendors to autoload the libraries , 

We use composer update to Composer is a  dependency manager allows you to delegate responsibility for managing your dependencies to a third party.Just run the following commands,Orgo to your project folder via cmd. run the following commandit will install the missing vendor folder and files in your project. but in some cases, it gives an error like "Your configuration does not allow connection to ....." in cmd.for that go to your composer.json file, change "secure-http": true to "secure-http": falsebut in some cases (as was in my case) you may not find such line in your file. for that do the following action:to and run again composer update command.hope this will solve problem.This solution worked for me. The reason is not to have a vendor folder in your application. Follow these steps:That command add vendor folder to your projectJust setup a new project using composer instead of laravel like this:I also had that error. But none of the above solved the issue. So i uninstalled and again installed the composer. Then i did composer update. and the problem was fixed.I had same problem with laravel and artisan, the solution:Before you carry out the following instructions you need to make sure you have composer installed globally on your machine;

Open you Mac terminal and run the following command:once composer is installed globally run the following command after you are in the directory of the project:once completed in it update and install all the required packages.We got an error because we have missing vendor folder in our project, The vendor directory contains our Composer dependencies.Need /vendor folder because all packages are there and including all the classes Laravel uses, A problem can be solved after following just two steps:These two commands, we will Recreate the vendor folder in our project and after that our project will be working smoothly.I added composer.lock file to .gitignore, after commit that file to repository error is gone :)Something I realise is your composer.json file will have some sort of script like what works for me: removing post install cmd helped running composer install without any issue.Hope this helpsCheers!!Delete vendor folder and run composer install command. It is working 100%You are missing vendor folder, probably its new cloned repository or new project the vendor folder is populated by composer binary which reads composer.json file or system requirements and installs packaged under vendor folder and create an autoload script that has all classedDelete Vendor then composer installIn my case I had to enable another extension, namely php_mbstring.dll in the php.ini file before it could work. It's listed under extension=php_mbstring.dll. Find it in the php.ini file and remove the semi-colon (;) in front of it and save the file.After this run install composer again in the root directory of your Laravel applcication and is should work.If you are a Windows user you may uninstall Composer. Then install Composer. After that you install Laravel. Maybe it will work.my problem is solved by if you any other problem you can clear cache and config

Clear Route cache:Clear View cache: Clear Config cache: I got this when I did composer update instead of composer install.

How can I connect to a Tor hidden service using cURL in PHP?

frosty

[How can I connect to a Tor hidden service using cURL in PHP?](https://stackoverflow.com/questions/15445285/how-can-i-connect-to-a-tor-hidden-service-using-curl-in-php)

I'm trying to connect to a Tor hidden service using the following PHP code:When I run it, I get the following error:However, when I run the following command from my command line in Ubuntu:I get a response as expectedThe PHP cURL documentations says this:I believe the reason it works from the command line is because Tor (the proxy) is resolving the .onion hostname, which it recognizes. When running the PHP code above, my guess is that cURL or PHP is trying to resolve the .onion hostname and doesn't recognize it. I've searched for a way to tell cURL/PHP to let the proxy resolve the hostname, but I can't find a way.There is a very similar Stack Overflow question, cURL request using socks5 proxy fails when using PHP, but it works through the command line.

2013-03-16 03:39:25Z

I'm trying to connect to a Tor hidden service using the following PHP code:When I run it, I get the following error:However, when I run the following command from my command line in Ubuntu:I get a response as expectedThe PHP cURL documentations says this:I believe the reason it works from the command line is because Tor (the proxy) is resolving the .onion hostname, which it recognizes. When running the PHP code above, my guess is that cURL or PHP is trying to resolve the .onion hostname and doesn't recognize it. I've searched for a way to tell cURL/PHP to let the proxy resolve the hostname, but I can't find a way.There is a very similar Stack Overflow question, cURL request using socks5 proxy fails when using PHP, but it works through the command line.You need to set option CURLOPT_PROXYTYPE to CURLPROXY_SOCKS5_HOSTNAME, which sadly wasn't defined in old PHP versions, circa pre-5.6; if you have earlier in  but you can explicitly use its value, which is equal to 7:I use Privoxy and cURL to scrape Tor pages:After installing Privoxy you need to add this line to the configuration file (/etc/privoxy/config). Note the space and '.' a the end of line.Then restart Privoxy.Try to add this:TL;DR: Set CURLOPT_PROXYTYPE to use CURLPROXY_SOCKS5_HOSTNAME if you have a modern PHP, the value 7 otherwise, and/or correct the CURLOPT_PROXY value.As you correctly deduced, you cannot resolve .onion domains via the normal DNS system, because this is a reserved top-level domain specifically for use by Tor and such domains by design have no IP addresses to map to.Using CURLPROXY_SOCKS5 will direct the cURL command to send its traffic to the proxy, but will not do the same for domain name resolution. The DNS requests, which are emitted before cURL attempts to establish the actual connection with the Onion site, will still be sent to the system's normal DNS resolver. These DNS requests will surely fail, because the system's normal DNS resolver will not know what to do with a .onion address unless it, too, is specifically forwarding such queries to Tor.Instead of CURLPROXY_SOCKS5, you must use CURLPROXY_SOCKS5_HOSTNAME. Alternatively, you can also use CURLPROXY_SOCKS4A, but SOCKS5 is much preferred. Either of these proxy types informs cURL to perform both its DNS lookups and its actual data transfer via the proxy. This is required to successfully resolve any .onion domain.There are also two additional errors in the code in the original question that have yet to be corrected by previous commenters. These are:Here is the correct code in full, with comments to indicate the changes.You can also omit setting CURLOPT_PROXYTYPE entirely by changing the CURLOPT_PROXY value to include the socks5h:// prefix:

When do I use the PHP constant「PHP_EOL」?

Christian Oudard

[When do I use the PHP constant「PHP_EOL」?](https://stackoverflow.com/questions/128560/when-do-i-use-the-php-constant-php-eol)

When is it a good idea to use PHP_EOL?I sometimes see this in code samples of PHP. Does this handle DOS/Mac/Unix endline issues?

2008-09-24 17:34:39Z

When is it a good idea to use PHP_EOL?I sometimes see this in code samples of PHP. Does this handle DOS/Mac/Unix endline issues?Yes, PHP_EOL is ostensibly used to find the newline character in a cross-platform-compatible way, so it handles DOS/Unix issues.Note that PHP_EOL represents the endline character for the current system. For instance, it will not find a Windows endline when executed on a unix-like system.From main/php.h of PHP version 7.1.1 and version 5.6.30:As you can see PHP_EOL can be "\r\n" (on Windows servers) or "\n" (on anything else). On PHP versions prior 5.4.0RC8, there were a third value possible for PHP_EOL: "\r" (on MacOSX servers). It was wrong and has been fixed on 2012-03-01 with bug 61193.As others already told you, you can use PHP_EOL in any kind of output (where any of these values are valid - like: HTML, XML, logs...) where you want unified newlines. Keep in mind that it's the server that it's determining the value, not the client. Your Windows visitors will get the value from your Unix server which is inconvenient for them sometimes.I just wanted to show the possibles values of PHP_EOL backed by the PHP sources since it hasn't been shown here yet...You use PHP_EOL when you want a new line, and you want to be cross-platform.This could be when you are writing files to the filesystem (logs, exports, other).  You could use it if you want your generated HTML to be readable.  So you might follow your <br /> with a PHP_EOL.You would use it if you are running php as a script from cron and you needed to output something and have it be formatted for a screen.You might use it if you are building up an email to send that needed some formatting.You can use this constant when you read or write text files on the server's filesystem.Line endings do not matter in most cases as most software are capable of handling text files regardless of their origin. You ought to be consistent with your code.If line endings matter, explicitly specify the line endings instead of using the constant. For example:I'd like to throw in an answer that addresses "When not to use it" as it hasn't been covered yet and can imagine it being used blindly and no one noticing the there is a problem till later down the line. Some of this contradicts some of the existing answers somewhat.If outputting to a webpage in HTML, particularly text in <textarea>, <pre> or <code> you probably always want to use \n and not PHP_EOL.The reason for this is that while code may work perform well on one sever - which happens to be a Unix-like platform - if deployed on a Windows host (such the Windows Azure platform) then it may alter how pages are displayed in some browsers (specifically Internet Explorer - some versions of which will see both the \n and \r).I'm not sure if this is still an issue since IE6 or not, so it might be fairly moot but seems worth mentioning if it helps people prompt to think about the context. There might be other cases (such as strict XHTML) where suddently outputting \r's on some platforms could cause problems with the output, and I'm sure there are other edge cases like that.As noted by someone already, you wouldn't want to use it when returning HTTP headers - as they should always follow the RFC on any platform.I wouldn't use it for something like delimiters on CSV files (as someone has suggested). The platform the sever is running on shouldn't determine the line endings in generated or consumed files.No, PHP_EOL does not handle endline issues, because the system where you use that constant is not the same system where you send the output to.I would not recommend using PHP_EOL at all. Unix/Linux use \n, MacOS / OS X changed from \r to \n too and on Windows many applications (especially browsers) can display it correctly too. On Windows, it is also easy change existing client-side code to use \n only and still maintain backward-compatibility: Just change the delimiter for line trimming from \r\n to \n and wrap it in a trim() like function.I found PHP_EOL very useful for file handling, specially if you are writing multiple lines of content into a file.For example, you have a long string that you want to break into the multiple lines while writing into plain file. Using \r\n might not work so simply put PHP_EOL into your script and the result is awesome.Check out this simple example below:The definition of PHP_EOL is that it gives you the newline character of the operating system you're working on.In practice, you should almost never need this. Consider a few cases:PHP_EOL is so ridiculously long that it's really not worth using it.There is one obvious place where it might be useful: when you are writing code that predominantly uses single quote strings. Its arguable as to whether:The art of it is to be consistent. The problem with mix and matching '' and "" is that when you get long strings, you don't really want to have to go hunting for what type of quote you used. As with all things in life, it depends on the context.DOS/Windows standard "newline" is CRLF (= \r\n) and not LFCR (\n\r). If we put the latter, it's likely to produce some unexpected (well, in fact, kind of expected! :D) behaviors.Nowadays almost all (well written) programs accept the UNIX standard LF (\n) for newline code, even mail sender daemons (RFC sets CRLF as newline for headers and message body).I have a site where a logging-script writes a new line of text to a textfile after an action from the user, who can be using any OS.Using PHP_EOL don't seem to be optimal in this case. If the user is on Mac OS and writes to the textfile it will put \n. When opening the textfile on a windows computer it doesn't show a line break. For this reason i use "\r\n" instead which works when opening the file on any OS.Handy with error_log() if you're outputting multiple lines.I've found a lot of debug statements look weird on my windows install since the developers have assumed unix endings when breaking up strings.I use the PHP_EOL constant in some command line scripts I had to write. I develop on my local Windows machine and then test on a Linux server box. Using the constant meant I didn't have to worry about using the correct line ending for each of the different platforms.You are writing code that predominantly uses single quote strings.I am using WebCalendar and found that Mac iCal barfs on importing a generated ics file because the end-of-line is hardcoded in xcal.php as "\r\n". I went in and replaced all occurrences with PHP_EOL and now iCal is happy! 

I also tested it on Vista and Outlook was able to import the file as well, even though the end of line character is "\n".When jumi (joomla plugin for PHP) compiles your code for some reason it removes all backslashes from your code. Such that something like $csv_output .= "\n"; becomes $csv_output .= "n";Very annoying bug!Use PHP_EOL instead to get the result you were after.On some system may be useful to use this constant because if, for example, you are sending an email, you can use PHP_EOL to have a cross-system script working on more systems... but even if it's useful sometime you can find this constant undefined, modern hosting with latest php engine do not have this problem but I think that a good thing is write a bit code that saves this situation:So you can use PHP_EOL without problems... obvious that PHP_EOL should be used on script that should work on more systems at once otherwise you can use \n or \r or \r\n...Note: PHP_EOL can beHope this answer help.I just experienced this issue when outputting to a Windows client. Sure, PHP_EOL is for server side, but most content output from php is for windows clients. So I have to place my findings here for the next person.A)    echo 'My Text' . PHP_EOL;   // Bad because this just outputs \n  and most versions of windows notepad display this on a single line, and most windows accounting software can't import this type of end of line character.B)   echo 'My Text \r\n';  //Bad because single quoted php strings do not interpret \r\nC)   echo "My Text \r\n";   // Yay it works!   Looks correct in notepad, and works when importing the file to other windows software such as windows accounting and windows manufacturing software.I prefer to use \n\r. Also I am on a windows system and \n works just fine in my experience.Since PHP_EOL does not work with regular expressions, and these are the most useful way of dealing with text, then I really never used it or needed to.

Creating default object from empty value in PHP?

Paul

[Creating default object from empty value in PHP?](https://stackoverflow.com/questions/8900701/creating-default-object-from-empty-value-in-php)

I see this error only after upgrading my PHP environment to PHP 5.4 and beyond. The error points to this line of code:Error:Code:Do I first need to declare my $res object?

2012-01-17 19:43:09Z

I see this error only after upgrading my PHP environment to PHP 5.4 and beyond. The error points to this line of code:Error:Code:Do I first need to declare my $res object?Your new environment may have E_STRICT warnings enabled in error_reporting for PHP versions <= 5.3.x, or simply have error_reporting set to at least E_WARNING with PHP versions >= 5.4. That error is triggered when $res is NULL or not yet initialized:PHP will report a different error message if $res is already initialized to some value but is not an object:In order to comply with E_STRICT standards prior to PHP 5.4, or the normal E_WARNING error level in PHP >= 5.4, assuming you are trying to create a generic object and assign the property success, you need to declare $res as an object of stdClass in the global namespace:This message has been E_STRICT for PHP <= 5.3. Since PHP 5.4, it was unluckilly changed to E_WARNING. Since E_WARNING messages are useful, you don't want to disable them completely.To get rid of this warning, you must use this code:This is fully equivalent replacement. It assures exactly the same thing which PHP is silently doing - unfortunatelly with warning now - implicit object creation. You should always check if the object already exists, unless you are absolutely sure that it doesn't. The code provided by Michael is no good in general, because in some contexts the object might sometimes be already defined at the same place in code, depending on circumstances.Simply,Or you could instantiate classes with:and fill values with:More infos:

https://www.php.net/manual/en/language.types.object.php#language.types.object.castingIf you put "@" character begin of the line then PHP doesn't show any warning/notice for this line. For example:For preventing this warning for this line you must put "@" character begin of the line like this:I'm using this trick when developing. I don't like disable all warning messages becouse if you don't handle warnings correctly then they will become a big error in future.Try this:Try this if you have array and add objects to it.This sends ARRAY of Objects for later use~!I had similar problem and this seem to solve the problem. You just need to initialize the $res object to a class . Suppose here the class name is test.This is a warning which I faced in PHP 7, the easy fix to this is by initializing the variable before using itOnce you have intialized it then you can use it for objectsThis problem is caused because your are assigning to an instance of object which is not initiated. For eg:Your case:Solution:A simple way to get this error is to type (a) below, meaning to type (b)(a) $this->my->variable(b) $this->my_variableTrivial, but very easily overlooked and hard to spot if you are not looking for it.You may need to check if variable declared and has correct type.See PHP anonymous classes.I had a similar problem while trying to add a variable to an object returned from an API.  I was iterating through the data with a foreach loop.This threw the "Creating default object from empty value" Exception in Laravel.I fixed it with a very small change.By simply making $data a reference.I hope that helps somebody a it was annoying the hell out of me!no you do not .. it will create it when you add the success value to the object.the default class is inherited if you do not specify one.Try using: I put the following at the top of the faulting PHP file and the error was no longer display:

「date(): It is not safe to rely on the system's timezone settings…」

user1852837

[「date(): It is not safe to rely on the system's timezone settings…」](https://stackoverflow.com/questions/16765158/date-it-is-not-safe-to-rely-on-the-systems-timezone-settings)

I got this error when I requested to update the PHP version from 5.2.17 to PHP 5.3.21 on the server.

2013-05-27 01:05:31Z

I got this error when I requested to update the PHP version from 5.2.17 to PHP 5.3.21 on the server.You probably need to put the timezone in a configuration line in your php.ini file. You should have a block like this in your php.ini file:If not, add it (replacing the timezone by yours). After configuring, make sure to restart httpd (service httpd restart).Here is the list of supported timezones.If you cannot modify your php.ini configuration, you could as well use the following snippet at the beginning of your code:The list of timezones can be found at http://www.php.net/manual/en/timezones.php.Add the following in your index.php file. I first came across this when I moved my application from my XAMPP server to Apache 2.2 and PHP 5.4...I would advise you do it in your index.php file instead of the php.ini file.instead of worked for me (shows current year and no more shows the error message).

(Thanks to Chris above)If these are not your optionsInstead of date you could use gmdate.I have used gmdate( "Y" ) when I needed a year for a copyright snipplet.If you are using CodeIgniter and can't change php.ini, I added the following to the beginning of index.php:I always keep this line inside codeigniter's root index.php.So that my code works at any serverList of Supported Timezones here@Justis pointed me to the right direction, but his code did not work for me. This did:Documentation: http://www.php.net/manual/en/function.date-default-timezone-get.phpThis solution is not only for those who does not have full system access. It is necessary for any script when you provide it to anyone else but you. You never know on what server the script will run when you distribute it to someone else.This issue has been bugging me for SOME time as im trying to inject a "createbucket.php" script into composer and i keep being told my time-zone is incorrect.In the end the only thing that fixed the issue was to:

$ sudo nano /etc/php.iniSearch for timezoneEnsure you remove the ;Then finally And you'll be good to go :)I had to put it in double quotes.You can set the timezone in your .htaccess fileIn addition to setting the date.timezone=   as mentioned in several answers,

I found an error in the php.ini file that was keeping it from getting to the date.timezone.

The way I found it was by running php from the command line in a terminal.

this caused an error to be reported at line 114.  In my case I had uncommented a setting for displaying errors that had '|'  between 2 values.  It did not like it.

I removed one of the values and the |  and everything was good after thatA simple method for two time zone. For php (or your location).A quick solution whilst your rectify the incompatibilities, is to disable error reporting in your index.php file:Insert the line below into your index.php below define( ‘_JEXEC’, 1 );I am hosting my EC2 and S3 bucket in us-west-2 (Oregon) region. When I was calling $s3client->listBuckets() to list existing buckets in my php, I was getting exception - "Uncaught exception 'Exception' with message 'DateTime::__construct(): It is not safe to rely on the system's timezone settings...". 

I made below changes to make it work. Sharing these details in case someone is facing similar issue and any of above answers have not helped.After this I am able to list buckets successfully without any exception. Hope this helps.If you using Plesk, try it, First, Open PHP Settings, at the bottom of page, change date.timezone from DEFAULT to UTC. I had this error running php-fpm in a chroot jail.  I tried creating etc/php.ini and /usr/share/zoneinfo in the chroot directory, but it just didn't work.  I even tried strace-ing the php-fpm daemons to see what file they were missing - nothing jumped out.So in case Google brings you here because you get this error when using php-fpm configured for chroot, you can probably fix it by adding this line to /etc/php-fpm.d/www.conf in the ENV section:A php-fpm restart is normally required for it to take effect.  Hope this helps somebody out there.In my particular case, I have PHP configured to use PHP-FPM (FastCGI Process Manager). When executing phpinfo() from CLI I saw correct timezone that I had set in the php.ini, however it was still incorrect in the browser and causing my code to fail. I simply needed to restart the php-fpm service on the server.You may also need to restart the httpd service if you edited the php.iniThis answer above from CtrlX is the correct answer, but it may not work completely.

I added this line to my php.ini file:but it did not remove the PHP error for all my files because some of my PHP scripts are in subfolders. So I had to edit .htaccess file to setup php.ini to be used recursively (in subfolders):where account_name is your cpanel account name and public_html is the folder your php.ini file is in.For docker user:

Create a local timezone.ini file in your project, set up the config in docker-compose.yml, timezone.iniIf you don't have access to the file php.ini, create or edit a .htaccess file in the root of your domain or sub and add this (generated by cpanel):There are two options for the resolve this First, change into the php.ini file and put default timezoneOnce, you have set the timezone in php.ini restart the serverSecondly, Change the run time

assign time zone based on your need

How to convert an array to object in PHP?

streetparade

[How to convert an array to object in PHP?](https://stackoverflow.com/questions/1869091/how-to-convert-an-array-to-object-in-php)

How can i convert an array like this to object?

2009-12-08 18:56:06Z

How can i convert an array like this to object?In the simplest case, it's probably sufficient to "cast" the array as an object:Another option would be to instantiate a standard class as a variable, and loop through your array while re-assigning the values:As Edson Medina pointed out, a really clean solution is to use the built-in json_ functions:This also (recursively) converts all of your sub arrays into objects, which you may or may not want. Unfortunately it has a 2-3x performance hit over the looping approach.Warning! (thanks to Ultra for the comment):you can simply use type casting to convert an array to object.The easy way would beBut that's not what you want. If you want objects you want to achieve something, but that's missing in this question. Using objects just for the reason of using objects makes no sense.Quick hack:Not pretty, but works.Here are three ways:Its way to simple, This will create an object for recursive arrays as well:Depending on where you need that and how to access the object there are different ways to do it.For example: just typecast itHowever, the most compatible one is using a utility method (not yet part of PHP) that implements standard PHP casting based on a string that specifies the type (or by ignoring it just de-referencing the value):The usage example in your case (Online Demo):This one worked for meusage :returns :like usual you can loop it like:There's no built-in method to do it as far as I'm aware, but it's as easy as a simple loop:You can expound on that if you need it to build your object recursively.You can use the (object) function to convert your array into an object. The result will be an object that contains arrays: Actually if you want to use this with multi-dimensional arrays you would want to use some recursion.I would definitly go with a clean way like this :if you submit:you will get this:I found this more logical comparing the above answers from Objects should be used for the purpose they've been made for (encapsulated cute little objects).Also using get_object_vars ensure that no extra attributes are created in the manipulated Object (you don't want a car having a family name, nor a person behaving 4 wheels).The one I use (it is a class member):You could also use an ArrayObject, for example:recursion is your friend:This requires PHP7 because I chose to use a lambda function to lock away the 'innerfunc' within the main function. The lambda function is called recursively, hence the need for: "use ( &$innerfunc )". You could do it in PHP5 but could not hide the innerfunc.Little complicated but easy to extend technique:Suppose you have an array Suppose you have have a Person class which may have more or less attributes from this array. for exampleIf you still wanna change your array to the person object. You can use ArrayIterator Class. Now you have iterator object. Create a class extending FilterIterator Class; where you have to define the abstract method accept. Follow the exampleThe above impelmentation will bind the property only if it exists in the class. Add one more method in the class PersonIteratorMake sure you have mutators defined in your class. 

Now you are ready to call these function where you want to create object.use this function that i've made:Usage:Easy:Example:Then, the following is true:one liner You could also do this by adding (object) on left of variable to create a new object.http://codepad.org/9YmD1KsUUsing json_encode is problematic because of the way that it handles non UTF-8 data. It's worth noting that the json_encode/json_encode method also leaves non-associative arrays as arrays. This may or may not be what you want. I was recently in the position of needing to recreate the functionality of this solution but without using json_ functions. Here's what I came up with:Best Method in the WORLD :)if you use different methods you will have problems. This is the best method. You have ever seen.You can use Reflection:CakePHP has a recursive Set::map class that basically maps an array into an object. You may need to change what the array looks like in order to make the object look the way you want it.http://api.cakephp.org/view_source/set/#line-158Worst case, you may be able to get a few ideas from this function.Obviously just an extrapolation of some other folks' answers, but here's the recursive function that will convert any mulch-dimensional array into an object:And remember that if the array had numeric keys they can still be referenced in the resulting object by using {} (for instance: $obj->prop->{4}->prop)Inspired by all these codes, i tried to create a enhanced version with support to: specific class name, avoid constructor method, 'beans' pattern and strict mode (set only existing properties):This function works as same as json_decode(json_encode($arr), false).Output:Output:Output:Multidimensional arrays into an object. this code is used for conversion of Bing search API try and catch method.i have done it with quite simple way, 

PHP: How to use array_filter() to filter array keys?

maček

[PHP: How to use array_filter() to filter array keys?](https://stackoverflow.com/questions/4260086/php-how-to-use-array-filter-to-filter-array-keys)

The callback function in array_filter() only passes in the array's values, not the keys.If I have:What's the best way to delete all keys in $my_array that are not in the $allowed array?Desired output:

2010-11-23 19:41:05Z

The callback function in array_filter() only passes in the array's values, not the keys.If I have:What's the best way to delete all keys in $my_array that are not in the $allowed array?Desired output:PHP 5.6 introduced a third parameter to array_filter(), flag, that you can set to ARRAY_FILTER_USE_KEY to filter by key instead of value:Clearly this isn't as elegant as array_intersect_key($my_array, array_flip($allowed)), but it does offer the additional flexibility of performing an arbitrary test against the key, e.g. $allowed could contain regex patterns instead of plain strings.You can also use ARRAY_FILTER_USE_BOTH to have both the value and the key passed to your filter function. Here's a contrived example based upon the first, but note that I'd not recommend encoding filtering rules using $allowed this way:With array_intersect_key and array_flip:I needed to do same, but with a more complex array_filter on the keys. Here's how I did it, using a similar method.This outputs the result:Here is a more flexible solution using a closure:Outputs:So in the function, you can do other specific tests.If you are looking for a method to filter an array by a string occurring in keys, you can use:The result of print_r($mResult) is An adaption of this answer that supports regular expressionsOutputRegardless of how I like Vincent's solution for Maček's problem, it doesn't actually use array_filter. If you came here from a search engine you maybe where looking for something like this (PHP >= 5.3):It passes the array you're filtering as a reference to the callback. As array_filter doesn't conventionally iterate over the array by increasing it's public internal pointer you have to advance it by yourself.What's important here is that you need to make sure your array is reset, otherwise you might start right in the middle of it.In PHP >= 5.4 you could make the callback even shorter:Here's a less flexible alternative using unset():The result of print_r($array) being:This is not applicable if you want to keep the filtered values for later use but tidier, if you're certain that you don't.Starting from PHP 5.6, you can use the ARRAY_FILTER_USE_KEY flag in array_filter:

Otherwise, you can use this function (from TestDummy):

And here is an augmented version of mine, which accepts a callback or directly the keys:

Last but not least, you may also use a simple foreach:Perhaps an overkill if you need it just once, but you can use YaLinqo library* to filter collections (and perform any other transformations). This library allows peforming SQL-like queries on objects with fluent syntax. Its where function accepts a calback with two arguments: a value and a key. For example:(The where function returns an iterator, so if you only need to iterate with foreach over the resulting sequence once, ->toArray() can be removed.)* developed by mearray filter function from php:$array - It is the input array$callback_function - The callback function to use，If the callback function returns true, the current value from array is returned into the result array.$flag - It is optional parameter, it will determine what arguments are sent to callback function. If this parameter empty then callback function will take array values as argument. If you want to send array key as argument then use $flag as ARRAY_FILTER_USE_KEY. If you want to send both keys and values you should use $flag as ARRAY_FILTER_USE_BOTH .For Example : Consider simple arrayIf you want to filter array based on the array key, We need to use ARRAY_FILTER_USE_KEY as third parameter of array function array_filter.If you want to filter array based on the array key and array value, We need to use ARRAY_FILTER_USE_BOTH as third parameter of array function array_filter.Sample Callback functions:It will output With this function you can filter a multidimensional array Naive and ugly (but seems to be faster) solution?Only tried this in php 7.3.11 but an ugly loop seems to execute in about a third of the time. Similar results on an array with a few hundred keys. Micro-optimization, probably not useful in RW, but found it surprising and interesting:

Call to undefined function curl_init().? [duplicate]

Pramod Kumar Sharma

[Call to undefined function curl_init().? [duplicate]](https://stackoverflow.com/questions/6382539/call-to-undefined-function-curl-init)

When i am going to implement Authorize.net payment gateway. However, I got this error: Please let me know what is wrong in it.

2011-06-17 07:15:54Z

When i am going to implement Authorize.net payment gateway. However, I got this error: Please let me know what is wrong in it.If you're on Windows:Go to your php.ini file and remove the ; mark from the beginning of the following line:After you have saved the file you must restart your HTTP server software (e.g. Apache) before this can take effect.For Ubuntu 13.0 and above, simply use the debundled package. In a terminal type the following to install it and do not forgot to restart server.Or if you're using the old PHP5orThen restart apache to activate the package withThe CURL extension ext/curl is not installed or enabled in your PHP installation. Check the manual for information on how to install or enable CURL on your system.You have to enable curl with php. Here is the instructions for same

List of Big-O for PHP functions

Kendall Hopkins

[List of Big-O for PHP functions](https://stackoverflow.com/questions/2473989/list-of-big-o-for-php-functions)

After using PHP for a while now, I've noticed that not all built-in PHP functions are as fast as expected. Consider these two possible implementations of a function that finds if a number is prime using a cached array of primes.This is because in_array is implemented with a linear search O(n) which will linearly slow down as $prime_array grows. Where the array_key_exists function is implemented with a hash lookup O(1) which will not slow down unless the hash table gets extremely populated (in which case it's only O(n)).So far I've had to discover the big-O's via trial and error, and occasionally looking at the source code. Now for the question...Is there a list of the theoretical (or practical) big O times for all* the built-in PHP functions?*or at least the interesting onesFor example, I find it very hard to predict the big O of functions listed because the possible implementation depends on unknown core data structures of PHP: array_merge, array_merge_recursive, array_reverse, array_intersect, array_combine, str_replace (with array inputs), etc.

2010-03-18 23:12:32Z

After using PHP for a while now, I've noticed that not all built-in PHP functions are as fast as expected. Consider these two possible implementations of a function that finds if a number is prime using a cached array of primes.This is because in_array is implemented with a linear search O(n) which will linearly slow down as $prime_array grows. Where the array_key_exists function is implemented with a hash lookup O(1) which will not slow down unless the hash table gets extremely populated (in which case it's only O(n)).So far I've had to discover the big-O's via trial and error, and occasionally looking at the source code. Now for the question...Is there a list of the theoretical (or practical) big O times for all* the built-in PHP functions?*or at least the interesting onesFor example, I find it very hard to predict the big O of functions listed because the possible implementation depends on unknown core data structures of PHP: array_merge, array_merge_recursive, array_reverse, array_intersect, array_combine, str_replace (with array inputs), etc.Since it doesn't seem like anyone has done this before I thought it'd be good idea to have it for reference somewhere. I've gone though and either via benchmark or code-skimming to characterize the array_* functions. I've tried to put the more interesting Big-O near the top. This list is not complete.Note: All the Big-O where calculated assuming a hash lookup is O(1) even though it's really O(n). The coefficient of the n is so low, the ram overhead of storing a large enough array would hurt you before the characteristics of lookup Big-O would start taking effect. For example the difference between a call to array_key_exists at N=1 and N=1,000,000 is ~50% time increase.Interesting Points:Lookups:array_key_exists O(n) but really close to O(1) - this is because of linear polling in collisions, but because the chance of collisions is very small, the coefficient is also very small. I find you treat hash lookups as O(1) to give a more realistic big-O. For example the different between N=1000 and N=100000 is only about 50% slow down.isset( $array[$index] ) O(n) but really close to O(1) - it uses the same lookup as array_key_exists. Since it's language construct, will cache the lookup if the key is hardcoded, resulting in speed up in cases where the same key is used repeatedly. in_array O(n) - this is because it does a linear search though the array until it finds the value.array_search O(n) - it uses the same core function as in_array but returns value.Queue functions:array_push O(∑ var_i, for all i)array_pop O(1) array_shift O(n) - it has to reindex all the keysarray_unshift O(n + ∑ var_i, for all i) - it has to reindex all the keysArray Intersection, Union, Subtraction:array_intersect_key if intersection 100% do O(Max(param_i_size)*∑param_i_count, for all i), if intersection 0% intersect O(∑param_i_size, for all i)array_intersect if intersection 100% do O(n^2*∑param_i_count, for all i), if intersection 0% intersect O(n^2)array_intersect_assoc if intersection 100% do O(Max(param_i_size)*∑param_i_count, for all i), if intersection 0% intersect O(∑param_i_size, for all i)array_diff O(π param_i_size, for all i) - That's product of all the param_sizesarray_diff_key O(∑ param_i_size, for i != 1) - this is because we don't need to iterate over the first array.array_merge O( ∑ array_i, i != 1 ) - doesn't need to iterate over the first array+ (union) O(n), where n is size of the 2nd array (ie array_first + array_second) - less overhead than array_merge since it doesn't have to renumberarray_replace O( ∑ array_i, for all i )Random:shuffle O(n)array_rand O(n) - Requires a linear poll.Obvious Big-O:array_fill O(n)array_fill_keys O(n)range O(n)array_splice O(offset + length)array_slice O(offset + length) or O(n) if length = NULLarray_keys O(n)array_values O(n)array_reverse O(n)array_pad O(pad_size)array_flip O(n)array_sum O(n)array_product O(n)array_reduce O(n)array_filter O(n)array_map O(n)array_chunk O(n)   array_combine O(n)I'd like to thank Eureqa for making it easy to find the Big-O of the functions. It's an amazing free program that can find the best fitting function for arbitrary data.EDIT:For those who doubt that PHP array lookups are O(N), I've written a benchmark to test that (they are still effectively O(1) for most realistic values).The explanation for the case you specifically describe is that associative arrays are implemented as hash tables - so lookup by key (and correspondingly, array_key_exists) is O(1).  However, arrays aren't indexed by value, so the only way in the general case to discover whether a value exists in the array is a linear search.  There's no surprise there.I don't think there's specific comprehensive documentation of the algorithmic complexity of PHP methods.  However, if it's a big enough concern to warrant the effort, you can always look through the source code.You almost always want to use isset instead of array_key_exists. I'm not looking at the internals, but I'm pretty sure that array_key_exists is O(N) because it iterates over each and every key of the array, while isset tries to access the element using the same hash algorithm that is used when you access an array index. That should be O(1).One "gotcha" to watch out for is this:I was curious, so I benchmarked the difference:is_set: 0.132308959961 seconds

array_key_exists: 2.33202195168 secondsOf course, this doesn't show time complexity, but it does show how the 2 functions compare to each other.To test for time complexity, compare the amount of time it takes to run one of these functions on the first key and the last key.If people were running into trouble in practice with key collisions, they would implement containers with a secondary hash lookup or balanced tree.  The balanced tree would give O(log n) worst case behavior and O(1) avg. case (the hash itself). The overhead is not worth it in most practical in memory applications, but perhaps there are databases that implement this form of mixed strategy as their default case.

Traits vs. interfaces

datguywhowanders

[Traits vs. interfaces](https://stackoverflow.com/questions/9205083/traits-vs-interfaces)

I've been trying to study up on PHP lately, and I find myself getting hung up on traits. I understand the concept of horizontal code reuse and not wanting to necessarily inherit from an abstract class. What I don't understand is: What is the crucial difference between using traits versus interfaces?I've tried searching for a decent blog post or article explaining when to use one or the other, but the examples I've found so far seem so similar as to be identical.

2012-02-09 03:40:21Z

I've been trying to study up on PHP lately, and I find myself getting hung up on traits. I understand the concept of horizontal code reuse and not wanting to necessarily inherit from an abstract class. What I don't understand is: What is the crucial difference between using traits versus interfaces?I've tried searching for a decent blog post or article explaining when to use one or the other, but the examples I've found so far seem so similar as to be identical.An interface defines a set of methods that the implementing class must implement.When a trait is use'd the implementations of the methods come along too--which doesn't happen in an Interface.That is the biggest difference.From the Horizontal Reuse for PHP RFC:Public Service Announcement:I want to state for the record that I believe traits are almost always a code smell and should be avoided in favor of composition. It's my opinion that single inheritance is frequently abused to the point of being an anti-pattern and multiple inheritance only compounds this problem. You'll be much better served in most cases by favoring composition over inheritance (be it single or multiple). If you're still interested in traits and their relationship to interfaces, read on ...Let's start by saying this:To write OO code you need to understand that OOP is really about the capabilities of your objects. You've got to think about classes in terms of what they can do instead of what they actually do. This is in stark contrast to traditional procedural programming where the focus is on making a bit of code "do something."If OOP code is about planning and design, an interface is the blueprint and an object is the fully constructed house. Meanwhile, traits are simply a way to help build the house laid out by the blueprint (the interface).So, why should we use interfaces? Quite simply, interfaces make our code less brittle. If you doubt this statement, ask anyone who's been forced to maintain legacy code that wasn't written against interfaces.The interface is a contract between the programmer and his/her code. The interface says, "As long as you play by my rules you can implement me however you like and I promise I won't break your other code."So as an example, consider a real-world scenario (no cars or widgets):You start out by writing a class to cache request responses using APC:Then, in your HTTP response object, you check for a cache hit before doing all the work to generate the actual response:This approach works great. But maybe a few weeks later you decide you want to use a file-based cache system instead of APC. Now you have to change your controller code because you've programmed your controller to work with the functionality of the ApcCacher class rather than to an interface that expresses the capabilities of the ApcCacher class. Let's say instead of the above you had made the Controller class reliant on a CacherInterface instead of the concrete ApcCacher like so:To go along with that you define your interface like so:In turn you have both your ApcCacher and your new FileCacher classes implement the CacherInterface and you program your Controller class to use the capabilities required by the interface.This example (hopefully) demonstrates how programming to an interface allows you to change the internal implementation of your classes without worrying if the changes will break your other code.Traits, on the other hand, are simply a method for re-using code. Interfaces should not be thought of as a mutually exclusive alternative to traits. In fact, creating traits that fulfill the capabilities required by an interface is the ideal use case.You should only use traits when multiple classes share the same functionality (likely dictated by the same interface). There's no sense in using a trait to provide functionality for a single class: that only obfuscates what the class does and a better design would move the trait's functionality into the relevant class.Consider the following trait implementation:A more concrete example: imagine both your FileCacher and your ApcCacher from the interface discussion use the same method to determine whether a cache entry is stale and should be deleted (obviously this isn't the case in real life, but go with it). You could write a trait and allow both classes to use it to for the common interface requirement.One final word of caution: be careful not to go overboard with traits. Often traits are used as a crutch for poor design when unique class implementations would suffice. You should limit traits to fulfilling interface requirements for best code design.A trait is essentially PHP's implementation of a mixin, and is effectively a set of extension methods which can be added to any class through the addition of the trait. The methods then become part of that class' implementation, but without using inheritance.From the PHP Manual (emphasis mine):An example:With the above trait defined, I can now do the following:At this point, when I create an instance of class MyClass, it has two methods, called foo() and bar() - which come from myTrait. And - notice that the trait-defined methods already have a method body - which an Interface-defined method can't.Additionally - PHP, like many other languages, uses a single inheritance model - meaning that a class can derive from multiple interfaces, but not multiple classes. However, a PHP class can have multiple trait inclusions - which allows the programmer to include reusable pieces - as they might if including multiple base classes.A few things to note:Polymorphism:In the earlier example, where MyClass extends SomeBaseClass, MyClass is an instance of SomeBaseClass. In other words, an array such as SomeBaseClass[] bases can contain instances of MyClass. Similarly, if MyClass extended IBaseInterface, an array of IBaseInterface[] bases could contain instances of MyClass. There is no such polymorphic construct available with a trait - because a trait is essentially just code which is copied for the programmer's convenience into each class which uses it.Precedence:As described in the Manual:So - consider the following scenario:When creating an instance of MyClass, above, the following occurs:ConclusionI think traits are useful to create classes that contain methods which can be used as methods of several different classes.For example:You can have and use this "error" method in any class that uses this trait.While with interfaces you can only declare the method signature, but not its functions' code. Also, to use an interface you need to follow a hierarchy, using implements. This is not the case with traits.It is completely different!For beginners above answer might be difficult, This is the easiest way to understand it:Traitsso if you want to have sayHello function in other classes without re-creating the whole function you can use traits,Cool right!Not only functions you can use anything in the trait(function,variables,const..). also you can use multiple traits:use SayWorld,AnotherTraits; Interfaceso this is how interface different from traits: You have to re-create everything in the interface in implemented class. interface doesn't have implementation. and interface can only have functions and const, it cannot have variables.I hope this helps!This is a good way of thinking about it in most circumstances, but there are a number of subtle differences between the two.For a start, the instanceof operator will not work with traits (ie, a trait is not a real object) so you can't us that to see if a class has a certain trait (or to see if two otherwise unrelated classes share a trait). That's what they mean by it being a construct for horizontal code re-use.There are functions now in PHP that will let you get a list of all the traits a class uses, but trait-inheritance means you'll need to do recursive checks to reliably check if a class at some point has a specific trait (there's example code on the PHP doco pages). But yeah, it's certainly not as simple and clean as instanceof is, and IMHO it's a feature that would make PHP better.Also, abstract classes are still classes, so they don't solve multiple-inheritance related code re-use problems. Remember you can only extend one class (real or abstract) but implement multiple interfaces.I've found traits and interfaces are really good to use hand in hand to create pseudo multiple inheritance. Eg:Doing this means you can use instanceof to determine if the particular Door object is Keyed or not, you know you'll get a consistent set of methods etc, and all the code is in one place across all the classes that use the KeyedTrait.Traits are simply for code reuse.Interface just provides the signature of the functions that is to be defined in the class where it can be used depending on the programmer's discretion. Thus giving us a prototype for a group of classes.For reference-

http://www.php.net/manual/en/language.oop5.traits.phpYou can consider a trait as an automated "copy-paste" of code, basically.Using traits is dangerous since there is no mean to know what it does before execution.However, traits are more flexible because of their lack of limitations such as inheritance.Traits can be useful to inject a method which checks something into a class, for example, the existence of another method or attribute. A nice article on that (but in French, sorry).For French-reading people who can get it, the GNU/Linux Magazine HS 54 has an article on this subject.If you know English and know what trait means, it is exactly what the name says. It is a class-less pack of methods and properties you attach to existing classes by typing use. Basically, you could compare it to a single variable. Closures functions can use these variables from outside of the scope and that way they have the value inside. They are powerful and can be used in everything. Same happens to traits if they are being used.Other answers did a great job of explaining differences between interfaces and traits. I will focus on a useful real world example, in particular one which demonstrates that traits can use instance variables - allowing you add behavior to a class with minimal boilerplate code.Again, like mentioned by others, traits pair well with interfaces, allowing the interface to specify the behavior contract, and the trait to fulfill the implementation.Adding event publish / subscribe capabilities to a class can be a common scenario in some code bases. There's 3 common solutions:How well does each work?#1 Doesn't work well. It would, until the day you realize you can't extend the base class because you're already extending something else. I won't show an example of this because it should be obvious how limiting it is to use inheritance like this. #2 & #3 both work well. I'll show an example which highlights some differences.First, some code that will be the same between both examples:An interface  And some code to demonstrate usage:Ok, now lets show how the implementation of the Auction class will differ when using traits.First, here's how #2 (using composition) would look like:Here's how #3 (traits) would look like:Note that the code inside the EventEmitterTrait is exactly the same as what's inside the EventEmitter class except the trait declares the triggerEvent() method as protected. So, the only difference you need to look at is the implementation of the Auction class.And the difference is large. When using composition, we get a great solution, allowing us to reuse our EventEmitter by as many classes as we like. But, the main drawback is the we have a lot of boilerplate code that we need to write and maintain because for each method defined in the Observable interface, we need to implement it and write boring boilerplate code that just forwards the arguments onto the corresponding method in our composed the EventEmitter object. Using the trait in this example lets us avoid that, helping us reduce boilerplate code and improve maintainability. However, there may be times where you don't want your Auction class to implement the full Observable interface - maybe you only want to expose 1 or 2 methods, or maybe even none at all so that you can define your own method signatures. In such a case, you might still prefer the composition method. But, the trait is very compelling in most scenarios, especially if the interface has lots of methods, which causes you to write lots of boilerplate.* You could actually kinda do both - define the EventEmitter class in case you ever want to use it compositionally, and define the EventEmitterTrait trait too, using the EventEmitter class implementation inside the trait :)The trait is same as a class we can use for multiple inheritance purposes and also code reusability.We can use trait inside the class and also we can use multiple traits in the same class with 'use keyword'.The interface is using for code reusability same as a traitthe interface is extend multiple interfaces so we can solve the multiple inheritance problems but when we implement the interface then we should create all the methods inside the class.

For more info click below link: http://php.net/manual/en/language.oop5.traits.php

http://php.net/manual/en/language.oop5.interfaces.phpAn interface is a contract that says「this object is able to do this thing」, whereas a trait is giving the object the ability to do the thing.A trait is essentially a way to「copy and paste」code between classes.Try reading this article, What are PHP traits?The main difference is that, with interfaces, you must define the actual implementation of each method within each class that implements said interface, so you can have many classes implement the same interface but with different behavior, while traits are just chunks of code injected in a class; another important difference is that trait methods can only be class-methods or static-methods, unlike interface methods which can also (and usually are) be instance methods.

Download File to server from URL

xaav

[Download File to server from URL](https://stackoverflow.com/questions/3938534/download-file-to-server-from-url)

Well, this one seems quite simple, and it is. All you have to do to download a file to your server is:Only there is one problem. What if you have a large file, like 100mb. Then, you will run out of memory, and not be able to download the file.What I want is a way to write the file to the disk as I am downloading it. That way, I can download bigger files, without running into memory problems.

2010-10-15 00:09:07Z

Well, this one seems quite simple, and it is. All you have to do to download a file to your server is:Only there is one problem. What if you have a large file, like 100mb. Then, you will run out of memory, and not be able to download the file.What I want is a way to write the file to the disk as I am downloading it. That way, I can download bigger files, without running into memory problems.Since PHP 5.1.0, file_put_contents() supports writing piece-by-piece by passing a stream-handle as the $data parameter:From the manual:(Thanks Hakre.)Try using cURLI'm not sure but I believe with the CURLOPT_FILE option it writes as it pulls the data, ie. not buffered.Above there is examle (cited by prodigitalson) of code wchih not work (reason: missing fopen in CURLOPT_FILE - http://www.webdeveloper.com/forum/showthread.php?268299-RESOLVED-PHP-script-for-a-cronjob-download-file-unpzck-run-another-php-script ). I cant add comment there becose I have too low number of points so Below I give working example (it also work for "local url"):There are 3 ways:You can find examples from here.Use a simple method in php copy() Note: if the destination file already exists, it will be overwrittenPHP copy() FunctionNote: You need to set permission 777 for the destination folder.

Use this method when you are downloading to your local machine.Special Note: 777 is a permission in Unix based system with full read/write/execute permission to owner, group and everyone. In general we give this permission to assets which are not much needed to be hidden from public on a web server. Example: images folder.I use this to download fileA PHP 4 & 5 Solution:readfile() will not present any memory issues, even when sending large files, on its own.

A URL can be used as a filename with this function if the fopen wrappers have been enabled.http://php.net/manual/en/function.readfile.php

Default value in Doctrine

Jiew Meng

[Default value in Doctrine](https://stackoverflow.com/questions/3376881/default-value-in-doctrine)

How do I set a default value in Doctrine 2?

2010-07-31 04:59:15Z

How do I set a default value in Doctrine 2?Database default values are not "portably" supported. The only way to use database default values is through the columnDefinition mapping attribute where you specify the SQL snippet (DEFAULT cause inclusive) for the column the field is mapped to.You can use:PHP-level default values are preferred as these are also properly available on newly created and persisted objects (Doctrine will not go back to the database after persisting a new object to get the default values).Note that this uses SQL DEFAULT, which is not supported for some fields like BLOB and TEXT.Set up a constructor in your entity and set the default value there.Use: and not: For instance:One more reason why read the documentation for Symfony will never go out of trend. There is a simple solution for my specific case and is to set the field type option empty_data to a default value.Again, this solution is only for the scenario where an empty input in a form sets the DB field to null.None of the previous answers helped me with my specific scenario but I found a solution.I had a form field that needed to behave as follow:I then tried all the recommendations given in here. Let me list them:Symfony form fields override default values set on the Entity class. 

Meaning, your schema for your DB can have a default value defined but if you leave a non-required field empty when submitting your form, the form->handleRequest() inside your form->isValid() method will override those default values on your Entity class and set them to the input field values. If the input field values are blank, then it will set the Entity property to null.http://symfony.com/doc/current/book/forms.html#handling-form-submissionsSet the default value on your controller after form->handleRequest() inside your form->isValid() method:Not a beautiful solution but it works. I could probably make a validation group but there may be people that see this issue as a data transformation rather than data validation, I leave it to you to decide.I also tried to override the Entity setter this way:This, even though it looks cleaner, it doesn't work. The reason being that the evil form->handleRequest() method does not use the Model's setter methods to update the data (dig into form->setData() for more details).The workaround I used was a LifeCycleCallback. Still waiting to see if there is any more "native" method, for instance @Column(type="string", default="hello default value").You can do it using xml as well:Here is how I solved it for myself. Below is an Entity example with default value for MySQL. However, this also requires the setup of a constructor in your entity, and for you to set the default value there.Works for me on a mysql database also:None of this worked for me. I found some documentation on doctrine's site that says to set the value directly to set a default value.https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/faq.html#how-can-i-add-default-values-to-a-columnThis inserted the value I wanted.Adding to @romanb brilliant answer.This adds a little overhead in migration, because you obviously cannot create a field with not null constraint and with no default value.With this answer, I encourage you to think why do you need the default value in the database in the first place? And usually it is to allow creating objects with not null constraint.If you use yaml definition for your entity,

the following works for me on a postgresql database:I struggled with the same problem. I wanted to have the default value from the database into the entities (automatically). Guess what, I did it :)While setting the value in the constructor would work, using the Doctrine Lifecycle events might be a better solution.By leveraging the prePersist Lifecycle Event, you could set your default value on your entity only on initial persist.Be careful when setting default values on property definition! Do it in constructor instead, to keep it problem-free. If you define it on property definition, then persist the object to the database, then make a partial load, then not loaded properties will again have the default value. That is dangerous if you want to persist the object again.

When should I use Memcache instead of Memcached?

Xeoncross

[When should I use Memcache instead of Memcached?](https://stackoverflow.com/questions/1442411/when-should-i-use-memcache-instead-of-memcached)

It seems that PHP has two memcached libraries named memcache and memcached. What is the difference and how do you know which one to use? Is one outdated? It seems that memcached offers more methods so I would assume that means it has had the most development - but it also seems to require external C/C++ libraries so I'm not sure if I can install it.It seems that memcache has been around longer, does not require additional libraries, and has pre-compiled binaries for even windows! I would think that it would be the better choice for now. However, being new to memcached (server) I'm not sure if there is some super important features in memcached (php) that make it worth the extra trouble.

2009-09-18 03:07:52Z

It seems that PHP has two memcached libraries named memcache and memcached. What is the difference and how do you know which one to use? Is one outdated? It seems that memcached offers more methods so I would assume that means it has had the most development - but it also seems to require external C/C++ libraries so I'm not sure if I can install it.It seems that memcache has been around longer, does not require additional libraries, and has pre-compiled binaries for even windows! I would think that it would be the better choice for now. However, being new to memcached (server) I'm not sure if there is some super important features in memcached (php) that make it worth the extra trouble.Memcached client library was just recently released as stable. It is being used by digg ( was developed for digg by Andrei Zmievski, now no longer with digg) and implements much more of the memcached protocol than the older memcache client. The most important features that memcached has are:All of this points were enough for me to switch to the newest client, and can tell you that it works like a charm. There is that external dependency on the libmemcached library, but have managed to install it nonetheless on Ubuntu and Mac OSX, so no problems there so far.If you decide to update to the newer library, I suggest you update to the latest server version as well as it has some nice features as well. You will need to install libevent for it to compile, but on Ubuntu it wasn't much trouble.I haven't seen any frameworks pick up the new memcached client thus far (although I don't keep track of them), but I presume Zend will get on board shortly.Zend Framework 2 has an adapter for Memcached which can be found hereWhen using Windows, the comparison is cut short: memcache appears to be the only client available.This is 2013.  Forget about the 2009 comments.  Likewise, if you are running serious traffic loads, do not even contemplate how to make-do with a windows based memcache.

When dealing with a very large scale (500+ front end web servers) and 20+ back end database servers and replicants (mysql & mssql mix), a farm of memcached servers (12 servers in group) supports multiple high volume OLTP applications answering 25K ~ 40K mc->get calls per-second.  These calls are those that do NOT have to reach a database.IMHO, this use of memcached provided SERIOUS $$$,$$$savings on CAPEX for new DB servers & licences as well as on support contracts for large commercial designs.Memcached is a newer API, it also provides memcached as a session provider which could be great if you have a farm of server. After the version is still really low 0.2 but I have used both and I didn't encounter major problem, so I would go to memcached since it's new. 

How to enable PHP short tags?

seedg

[How to enable PHP short tags?](https://stackoverflow.com/questions/2185320/how-to-enable-php-short-tags)

I have a web application on a Linux server which starts with <?I needed to copy this application to a windows environment and everything is working fine except that an SQL statement is being rendered differently. I don't know if this has to do with the script beginning with <?php instead of <? because I don't know from where to enable the <? from the PHP.ini so I changed it to <?phpI know that these 2 statements are supposed to mean the same but I need to test it with <? in order to ensure that the application is exactly the same. This way I can eliminate another possibility.Thanks

2010-02-02 15:44:10Z

I have a web application on a Linux server which starts with <?I needed to copy this application to a windows environment and everything is working fine except that an SQL statement is being rendered differently. I don't know if this has to do with the script beginning with <?php instead of <? because I don't know from where to enable the <? from the PHP.ini so I changed it to <?phpI know that these 2 statements are supposed to mean the same but I need to test it with <? in order to ensure that the application is exactly the same. This way I can eliminate another possibility.ThanksSetin php.iniAnd restart your Apache server.This can be done by enabling short_open_tag in php.ini:If you don't have access to the php.ini you can try to enable them trough the .htaccess file but it's possible the hosting company disabled this if you are on shared hosting:For the people thinking that short_open_tags are bad practice as of php 5.4 the <?= ... ?> shorttag will supported everywhere, regardless of the settings so there is no reason not to use them if you can control the settings on the server. Also said in this link: short_open_tagThis can be done by enabling short_open_tag in php.ini:1.To locate php.ini file,on comment line executeyou will get some thing like this,See 2nd line from the comment output.The file will be in the mentioned path.2.Open php.ini file and find short_open_tag. By default it is in off change it to on.3.Restart the server,execute this comment ThanksTo set short tags to open from a Vagrant install script on Ubuntu:I can see all answers above are partially correct only.

In reality all 21st Century PHP apps will have FastCGI Process Manager(php-fpm) so once you have added php-info() into your test.php script and checked the correct path for php.iniIMPORTANT: then you must restart your php-fpm process so this can work!and then finally restart your nginx/http serveryou need to turn on short_open_tags.As simple, as that, follow the following steps:In CentOS 6(tested on Centos 7 too) you can't set short_open_tag in /etc/php.ini for php-fpm.

You will have error:You must edit config for your site, which can found in /etc/php-fpm.d/www.conf

And write at end of file:If you are using Ubuntu with Apache+php5, then on current versions there are 2 places where you need to change to short_open_tag = Onif you edit your php.ini file, remember to restart your service (apache2, etc) for the edits to php.ini to take effectFor Wamp Server users there is easier way:

You may enable that setting simply (left) click once on the WampServer icon, choose PHP -> PHP settings -> short open tag. Wait for a second, then WampServer will automatically restart your PHP and also its web service.originally from: http://osticket.com/forums/showthread.php?t=3149if using xampp, you will notice the php.ini file has twice mentioned short_open_tag . Enable the second one to short_open_tag = On . The first one is commented out and you might be tempted to uncomment and edit it but it is over-ridden by a second short_open_tagIf you are using xampp in windows then please do followingFind short_open_tag using ctrl+f utilityYou will found ;short_open_tagkindly remove the semicolon (;) from line.and keep it as short_open_tag = onFinally, restart your Apache serverTo enable short_open_tag for a particular domain with php-fpm, you must edit :Where xxxxx is the socket number of the domain.And add : php_value[short_open_tag] =  OnThat works on php7.2 on ubuntu 16, same answer as above by Bradley Flood, although the directory in which the config file is stored has changed.Also you can change the version in the php string to match your currently installed version.in php.ini 

And restart your Apache Server.I'v Changed the short_open_tag Off to On on my  aws centos 7 instance and php7(PHP 7.0.33 (cli) (built: Dec  6 2018 22:30:44) ( NTS )), but its not reflecting the php info page and the code. So  I refer may docs and find a solution on my case. Add an extra line after the short_open_tag   as asp_tags = On after that restart Apache It works on the code and I go the output correctly php.ini fileSet the asp_tags = On and short_open_tag = On in both the files \apache\Apache2.2.21\bin\php.ini and \bin\php\php5.3.8\php.ini  and then restart the apache server.

How to run single test method with phpunit?

Alex

[How to run single test method with phpunit?](https://stackoverflow.com/questions/26095051/how-to-run-single-test-method-with-phpunit)

I am struggling to run a single test method named testSaveAndDrop in the file escalation/EscalationGroupTest.php with phpunit. I tried the following combinations: In each case all test methode in the file escalation/EscalationGroupTest.php are executed. How to select just ONE method instead?The name of the class is EscalationGroupTest and the version of phpunit is 3.2.8.

2014-09-29 07:56:30Z

I am struggling to run a single test method named testSaveAndDrop in the file escalation/EscalationGroupTest.php with phpunit. I tried the following combinations: In each case all test methode in the file escalation/EscalationGroupTest.php are executed. How to select just ONE method instead?The name of the class is EscalationGroupTest and the version of phpunit is 3.2.8.The following command runs the test on a single method: For newer versions of phpunit, it is just:I prefer marking the test in annotation asThen running it withNo need to specify the full path in the command line, but you have to remember removing this before commit, not to clutter the code.You may also specify several groups for a single testHere's the more generic answer:If you are sure the method name is unique you can only filter by method name (this works for me)However it is safer to specify the file path/reference as wellExample: Quick note: I've noticed that if I have a function named testSave and another function named testSaveAndDrop using command phpunit --filter testSave will also run testSaveAndDrop and any other function that starts with testSave*, it's weird!!Following command will execute exactly testSaveAndDrop test. So, something like thisWithout = and with 'https://phpunit.de/manual/3.7/en/textui.htmlfor run phpunit test in laravel by many way ..  for test single class :for test single method :for run tests from all class within namespace  : for more way run test see moreExample with custom method name.Example with test keywordIf you're in netbeans you can right click in the test method and click "Run Focused Test Method".You Can try this i am able to run single Test cases Eg:If you want to run single Test cases in Laravel 5.5 TryEg:The reason your tests are all being run is that you have the --filter flag after the file name.  PHPUnit is not reading the options at all and so is running all the test cases.From the help screen:So move the --filter argument before the test file that you want as mentioned in @Alex and 

@Ferid Mövsümov answers.  And you should only have the test that you want run.If you're using an XML configuration file, you can add the following inside the phpunit tag:See https://phpunit.de/manual/current/en/appendixes.configuration.htmlI am late to the party though. But as personal I hate to write the whole line. Instead, I use the following shortcuts in the .bash_profile file make sure to source .bash_profile the file after adding any new alias else it won't work. Usage:If you use Visual Studio Code you can use the following package to make your tests breeze. You can then set the keybinding in the settings. I use Command + T binding in my MAC.Now once you place your cursor on any function and then use the key binding then it will automatically run that single test. If you need to run the whole class then place the cursor on top of the class and then use the key binding.If you have any other things then always tweek with the TerminalHappy Coding!You must use --filter to run a single test method

php phpunit --filter "/::testMethod( .*)?$/" ClassTest ClassTest.phpThe above filter will run testMethod alone.

How to set HTTP header to UTF-8 using PHP which is valid in W3C validator?

manycheese

[How to set HTTP header to UTF-8 using PHP which is valid in W3C validator?](https://stackoverflow.com/questions/4279282/how-to-set-http-header-to-utf-8-using-php-which-is-valid-in-w3c-validator)

I have several PHP pages echoing out various things into HTML pages with the following code.However, when I validate using the W3C validator it comes up with:I am quite new to PHP, and I was wondering if I could and should change the header for the PHP files to match the HTML files.

2010-11-25 16:50:25Z

I have several PHP pages echoing out various things into HTML pages with the following code.However, when I validate using the W3C validator it comes up with:I am quite new to PHP, and I was wondering if I could and should change the header for the PHP files to match the HTML files.Use header to modify the HTTP header:Note to call this function before any output has been sent to the client. Otherwise the header has been sent too and you obviously can’t change it any more. You can check that with headers_sent. See the manual page of header for more information.First make sure the PHP files themselves are UTF-8 encoded.The meta tag is ignored by some browser. If you only use ASCII-characters, it doesn't matter anyway.http://en.wikipedia.org/wiki/List_of_HTTP_header_fieldsThis is a problem with your web server sending out an HTTP header that does not match the one you define. For instructions on how to make the server send the correct headers, see this page.Otherwise, you can also use PHP to modify the headers, but this has to be done before outputting any text using this code:More information on how to send out headers using PHP can be found in the documentation for the header function.You can also use a shorter way:See RFC 2616. It's valid to specify only character set.For a correct implementation, you need to change a series of things.Database (immediately after the connection):PHP sends headers automatically if set up to use internal encoding:

Extract numbers from a string

Bizboss

[Extract numbers from a string](https://stackoverflow.com/questions/6278296/extract-numbers-from-a-string)

I want to extract the numbers from a string that contains numbers and letters like:I want here to get the number 11 or any other number.

2011-06-08 11:53:56Z

I want to extract the numbers from a string that contains numbers and letters like:I want here to get the number 11 or any other number.If you just want to filter everything other than the numbers out, the easiest is to use filter_var:This should do better job!...Using preg_replace:Output: 1111111111 For floating numbers,Thanks for pointing out the mistake.  @mickmackusaI do not own the credit for this, but I just have to share it. This regex will get numbers from a string, including decimal points/places, as well as commas:/((?:[0-9]+,)*[0-9]+(?:\.[0-9]+)?)/Cited from here:

php - regex - how to extract a number with decimal (dot and comma) from a string (e.g. 1,120.01)?Using preg_replaceYou can use preg_match:You can use following function:  The first argument in implode in this specific case says "separate each element in matches[0] with a single space." Implode will not put a space (or whatever your first argument is) before the first number or after the last number.Something else to note is $matches[0] is where the array of matches (that match this regular expression) found are stored. For further clarification on what the other indexes in the array are for see: http://php.net/manual/en/function.preg-match-all.phptry this,use preg_replaceDEMOOrOrThis will return only the numeric valuewe can extract int from it like demo : http://sandbox.onlinephpfunctions.com/code/82d58b5983e85a0022a99882c7d0de90825aa398Follow this step it will convert string to numberAnother way to do it :One of the simple method I found without using regex for begineers was:}other way(unicode string even):This script creates a file at first , write numbers to a line and changes to a next line if gets a character other than number. At last, again it sorts out the numbers to a list.Depending on your use case, this might also be an option:Though I'd agree a regex or filter_var() would be more useful in the stated case.for utf8 str:This functions will also handle the floating numbers

PHP code is not being executed, instead code shows on the page

Gui

[PHP code is not being executed, instead code shows on the page](https://stackoverflow.com/questions/5121495/php-code-is-not-being-executed-instead-code-shows-on-the-page)

I'm trying to execute some PHP code on a project (using Dreamweaver) but the code isn't being run.When I check the source code, the PHP code appears as HTML tags (I can see it in the source code). Apache is running properly (I'm working with XAMPP), the PHP pages are being opened properly but the PHP code isn't being executed.Does someone have a suggestion about what is happening?Note: The file is already named as filename.phpEdit:

The Code..:

2011-02-25 19:06:51Z

I'm trying to execute some PHP code on a project (using Dreamweaver) but the code isn't being run.When I check the source code, the PHP code appears as HTML tags (I can see it in the source code). Apache is running properly (I'm working with XAMPP), the PHP pages are being opened properly but the PHP code isn't being executed.Does someone have a suggestion about what is happening?Note: The file is already named as filename.phpEdit:

The Code..:Sounds like there is something wrong with your configuration, here are a few things you can check:And lastly check the PHP manual for further setup tips.php7 : I'm running Apache on Ubuntu and my issue was that the /etc/apache2/mods-available/php5.conf file was missing this:I added it back in and php was parsing php files correctly.note for php 7 users, add this to your httpd.conf file:I found another problem causing this issue and already solved it. I accidentally saved my script in UTF-16 encoding. It seems that PHP5 can't recognize <?php tag in 16 bit encoding by default.I'm posting this answer because my Virtualmin/Webmin admin interface decided it was a good idea to disable my PHP engine.. took me a while to find the solution, so I thought I'd share it with you guys:Also, be sure to check that none of your website config files related to this specific host or virtualhost have any php_admin_value's in them that turn off PHP, like this:When in doubt, comment it...And restart your webserver.You're just opening your php file into browser. You have to open it using localhost url. if you open a file directly from your directory it will not execute the php code in any case.use: http://locahost/index.php or http:127.0.0.1/index.phpEnable php short code. In your case, you are using <? which is php short code for <?php. By default php short codes are disabled.Also use: sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt if you are a ubuntu user.I know it should sound silly... but seldom it happens.Check if you are trying to execute php from and not from ps> you can notice that if you write from shellit answer with the code (it means php functions)..This just happened to me again, along with the server downloading html files, rather than processing. I had not use the webserver apache for some time on the computer and meanwhile Ubuntu updated like two more versions from originally installed LTS. Now it is So the php worked after like so:The webserver was now parsing the php. Maybe now got to update some webs since php7.0 now running where as it was before running php5. Oh well.I've solved this by uninstalling XAMPP, and installing WAMP.

Thanks for the help.I faced this issue on php 7.1 that comes with High Sierra (OS X 10.13.5), editing /etc/apache2/httpd.conf with following changes helped:on my ubuntu 14.04, apache 2.4, php 5.5.9 install,  I tried with a sample.php on /var/www/html (default document root) and it worked ok. 

So the problem was on my Virtual Servers config.

The solution was to include, on the Directory def containing the .php, this line:i had similar problem but in my case solution was different.

my file that held php code was called "somename.html"

changed it to "somename.php" worked fineFor fresh setup of LAMP running php 7

edit the file /etc/httpd/conf/httpd.conf

Note: make sure to make backup for it before changing anything.Paste this at the very bottom of the file:Then, search for LoadModule and paste the following line:This line will simply ask httpd to load the php 7 moduleThen restart httpdCheck all the packages you have installed for php using:Install all relevant php packages, especially php-devel on your machine.This was in my .htaccessindex.html contained PHP code.  By default, PHP won't process files with extentions like htm* as PHP code.You can override this, by adding the following to .htaccess:Make sure the script contains before the code that should be executed. There should be no space between <? and php in this.I think the problem that it is showing code instead of the result is that it is not going to local host . recheck what address u r going in. are u going to a local file directory or to the local host.from the screenshot u sent it is going to ur computer not to the localhost."file:/// " it should be  "localhost/"Reinstalling the mcrypt module worked for me.I had a case that I accidentally started untaring my files directory in root.  It added the .htaccess file from my files folder that would block all phpBottom line check the .htaccess file on root.If you have configuration like this:  Uncomment next lines in your httpd.confIt works for meAdd AddType application/x-httpd-php .php to your httpd.conf file if you are using Apache 2.4Just spent hours of trying to get PHP 5 to run with Apache 2.4 on Windows 10. Finally for me it was a typo in httpd.conf LoadModule. Drew attention to writing and exact module path through the last answer in this apachelounge thread of denny2018. Thank you!I had LoadModule php5_module "c:/php/php5apache2.dll" but correct for apache 2.4 is:So I also missed the _4 before (for apache 2.4). The full snippet that worked for me:Just tried PHP 7. There the LoadModule line in httpd.conf for Apache 2.4 readsCurrently php manual shows up c:/php/php5apache2.dll which of course needs to be adjusted.in my case (Apache/2.4.34), after uncommenting the specific module frommy problem was gone.In case we are in the same page do followingsudo apt-get install php -y

sudo apt-get install php-{bcmath,bz2,intl,gd,mbstring,mysql,zip,fpm} -yTo enable PHP 7.2 FPM in Apache2 do:a2enmod proxy_fcgi setenvifa2enconf php7.2-fpmAfter that, I faced above issue. There are similar questions like this.I don't know why but it only happened for my .php files in /var/www/html/ root folder. everything was ok for sub-directories. (for example wordpress and phpmyadmin worked fine)So here is my solution. I decided to enable php module. so I ran this command:a2enmod php7.2but I got this errors:so I decided to disable mpm by running following commands:then restart apache:systemctl restart apache2then enable php7.2 (my installed version):sudo a2enmod php7.2and right now everything works fine.the file that you put in /var/www/html/ should have .php

forexample   example.php if it is example it is not working but if you change it to example.php it works.

Call a REST API in PHP

Michiel

[Call a REST API in PHP](https://stackoverflow.com/questions/9802788/call-a-rest-api-in-php)

Our client had given me a REST API to which I need to make a PHP call to. But as a matter of fact the documentation given with the API is very limited, so I don't really know how to call the service.I've tried to Google it, but the only thing that came up was an already expired Yahoo! tutorial on how to call the service. Not mentioning the headers or anything in depth information. Is there any decent information around how to call a REST API, or some documentation about it? Because even on W3schools, they only describes the SOAP method. What are different options for making rest API in PHP?

2012-03-21 10:33:38Z

Our client had given me a REST API to which I need to make a PHP call to. But as a matter of fact the documentation given with the API is very limited, so I don't really know how to call the service.I've tried to Google it, but the only thing that came up was an already expired Yahoo! tutorial on how to call the service. Not mentioning the headers or anything in depth information. Is there any decent information around how to call a REST API, or some documentation about it? Because even on W3schools, they only describes the SOAP method. What are different options for making rest API in PHP?You can access any REST API with PHPs cURL Extension. However, the API Documentation (Methods, Parameters etc.) must be provided by your Client!Example:If you have a url and your php supports it, you could just call file_get_contents:if $response is JSON, use json_decode to turn it into php array:if $response is XML, use simple_xml class:http://sg2.php.net/manual/en/simplexml.examples-basic.phpUse Guzzle.  It's a "PHP HTTP client that makes it easy to work with HTTP/1.1 and takes the pain out of consuming web services".  Working with Guzzle is much easier than working with cURL.Here's an example from the Web site:CURL is the simplest way to go. Here is a simple callUse HTTPFULHttpful is a simple, chainable, readable PHP library intended to make speaking HTTP sane. It lets the developer focus on interacting with APIs instead of sifting through curl set_opt pages and is an ideal PHP REST client. Httpful includes...Ex.Send off a GET request. Get automatically parsed JSON response.The library notices the JSON Content-Type in the response and automatically parses the response into a native PHP object.You will need to know if the REST API you are calling supports GET or POST, or both methods.  The code below is something that works for me, I'm calling my own web service API, so I already know what the API takes and what it will return. It supports both GET and POST methods, so the less sensitive info goes into the URL (GET), and the info like username and password is submitted as POST variables. Also, everything goes over the HTTPS connection.Inside the API code, I encode an array I want to return into json format, then simply use PHP command echo $my_json_variable to make that json string availabe to the client.So as you can see, my API returns json data, but you need to know (or look at the returned data to find out) what format the response from the API is in.This is how I connect to the API from the client side:BTW, I also tried to use file_get_contents() method as some of the users here suggested, but that din't work well for me.  I found out the curl method to be faster and more reliable.There are plenty of clients actually. One of them is Pest - check this out. And keep in mind that these REST calls are simple http request with various methods: GET, POST, PUT and DELETE.If you are using Symfony there's a great rest client bundle that even includes all of the ~100 exceptions and throws them instead of returning some meaningless error code + message.You should really check it:

https://github.com/CircleOfNice/CiRestClientBundleI love the interface:Works for all http methods.You can use file_get_contents to issue any http POST/PUT/DELETE/OPTIONS/HEAD methods, in addition to the GET method as the function name suggests.How to post data in PHP using file_get_contents?as @Christoph Winkler mentioned this is a base class for achieving it:curl_helper.phpThen you can always include the file and use it e.g.: any.phpIf you are open to use third party tools you'd have a look at this one:

https://github.com/CircleOfNice/DoctrineRestDriverThis is a completely new way to work with APIs.First of all you define an entity which is defining the structure of incoming and outcoming data and annotate it with datasources:Now it's pretty easy to communicate with the REST API:You can go with POSTMAN, an application who makes APIs easy. 

Fill request fields and then it will generate code for you in different languages.

Just click code on the right side and select your prefered language.

How do I create a simple 'Hello World' module in Magento?

Alan Storm

[How do I create a simple 'Hello World' module in Magento?](https://stackoverflow.com/questions/576908/how-do-i-create-a-simple-hello-world-module-in-magento)

How can the following be accomplished in Magento?Any other information about Magento's code structure will also be very helpful.

2009-02-26 01:07:06Z

How can the following be accomplished in Magento?Any other information about Magento's code structure will also be very helpful.First and foremost, I highly recommend you buy the PDF/E-Book from PHP Architect. It's US$20, but is the only straightforward "Here's how Magento works" resource I've been able to find. I've also started writing Magento tutorials at my own website.Second, if you have a choice, and aren't an experienced programmer or don't have access to an experienced programmer (ideally in PHP and Java), pick another cart. Magento is well engineered, but it was engineered to be a shopping cart solution that other programmers can build modules on top of. It was not engineered to be easily understood by people who are smart, but aren't programmers.Third, Magento MVC is very different from the Ruby on Rails, Django, CodeIgniter, CakePHP, etc. MVC model that's popular with PHP developers these days. I think it's based on the Zend model, and the whole thing is very Java OOP-like. There's two controllers you need to be concerned about. The module/frontName controller, and then the MVC controller.Fourth, the Magento application itself is built using the same module system you'll be using, so poking around the core code is a useful learning tactic. Also, a lot of what you'll be doing with Magento is overriding existing classes. What I'm covering here is creating new functionality, not overriding. Keep this in mind when you're looking at the code samples out there.I'm going to start with your first question, showing you how to setup a controller/router to respond to a specific URL. This will be a small novel. I might have time later for the model/template related topics, but for now, I don't. I will, however, briefly speak to your SQL question.Magento uses an EAV database architecture. Whenever possible, try to use the model objects the system provides to get the information you need. I know it's all there in the SQL tables, but it's best not to think of grabbing data using raw SQL queries, or you'll go mad.Final disclaimer. I've been using Magento for about two or three weeks, so caveat emptor. This is an exercise to get this straight in my head as much as it is to help Stack Overflow.All additions and customizations to Magento are done through modules. So, the first thing you'll need to do is create a new module. Create an XML file in app/modules named as followsMyCompanyName is a unique namespace for your modifications, it doesn't have to be your company's name, but that the recommended convention my magento. HelloWorld is the name of your module.Now that the module file is in place, we'll need to let Magento know about it (and check our work). In the admin applicationNow, we make sure that Magento knows about the moduleIf you can live with the performance slow down, you might want to turn off the application cache while developing/learning. Nothing is more frustrating then forgetting the clear out the cache and wondering why your changes aren't showing up.Next, we'll need to setup a directory structure for the module. You won't need all these directories, but there's no harm in setting them all up now.And add a configuration fileand inside the configuration file, add the following, which is essentially a "blank" configuration.Oversimplifying things, this configuration file will let you tell Magento what code you want to run.Next, we need to setup the module's routers. This will let the system know that we're handling any URLs in the form ofSo, in your configuration file, add the following section.What you're saying here is "any URL with the frontName of helloworld ...should use the frontName controller MyCompanyName_HelloWorld".So, with the above configuration in place, when you load the helloworld page above, you'll get a 404 page. That's because we haven't created a file for our controller. Let's do that now.Now try loading the page. Progress! Instead of a 404, you'll get a PHP/Magento exceptionSo, open the file we just created, and paste in the following code. The name of the class needs to be based on the name you provided in your router.What we've just setup is the module/frontName controller. 

This is the default controller and the default action of the module.

If you want to add controllers or actions, you have to remember that the tree first part of a Magento URL are immutable they will always go this way http://example.com/magento/index.php/frontName/controllerName/actionNameSo if you want to match this urlYou will have to have a FooController, which you can do this way :Please note that the default controller IndexController and the default action indexAction can by implicit but have to be explicit if something come after it.

So http://example.com/magento/index.php/helloworld/foo will match the controller FooController and the action indexAction and NOT the action fooAction of the IndexController. If you want to have a fooAction, in the controller IndexController you then have to call this controller explicitly like this way :

http://example.com/magento/index.php/helloworld/index/foo because the second part of the url is and will always be the controllerName.

This behaviour is an inheritance of the Zend Framework bundled in Magento.You should now be able to hit the following URLs and see the results of your echo statementsSo, that should give you a basic idea on how Magento dispatches to a controller. From here I'd recommended poking at the existing Magento controller classes to see how models and the template/layout system should be used.I've been wrestling with Magento for the last month or so and I'm still trying to figure it out. So this is a case of the blind leading the blind. There's little in the way of documentation and the forum/wiki is chaotic at best. Not only that, but there are several solutions that are either outdated or far from optimal.

I'm not sure if you have a project or just trying to figure it out, but it's probably easier if you started with modifying existing functionality as opposed to creating something completely new. For that I'd definately go with the "Recommended articles for developers" in the wiki. The new payment method one was a real eye-opener.For debugging I'd definitely recommend using FirePHP and looking at your HTML source  when something goes wrong. The ole echo debug method doesn't really work all that well.The general architecture is so mind-numbingly complex, that even if I completely understood it, I'd need to write a book to cover it. The best I can do is give you advice I wish someone had given me when I first started...Stay away from core files. Don't modify them, instead write your own module and override what you need.Magento uses config files consisting of XML to decide what it needs to do. In order to get it to run your own stuff as opposed to core functionality you need the correct xml. Unfortunately there is no guide on how to build you XML; you need to look at examples and do some serious testing. To complicate things the content of these files is largely case-sensitive. However if you master these you can override any part of the basic functionality which makes for a very powerful system.Magento uses methods like Mage::getModel('mymodel'), Mage::getSingleton('mysingleton'), Mage::helper('myhelper') to return objects of certain classes. It finds these by default in its core namespace. If you want it to use your own, you need to override these in your config.xml file.The name of your classes must correspond to the folder they're in.A lot of the objects in Magento ultimately extend something called a Varien_Object. This is a general purpose class (kind of like a swiss army knife) and its purpose in life is to allow you to define your own methods/variables on the fly. For example you'll see it used as a glorified array to pass data from one method to another. During development make sure you caching is disabled. It'll make magento excruciatingly slow, but it'll save you a lot of head trauma (from banging it on your desk).You'll see $this being used a lot. It means a different class depending on what file you see it. get_class($this) is your friend, especially in conjunction with FirePHP.Jot things down on paper. A lot. There are countless little factoids that you're gonna need 1-2 days after you encounter them.Magento loves OO. Don't be surprised if tracing a method takes you through 5-10 different classes.Read the designer's guide here. It's meant mostly for graphics designers, but you need it to understand where and why the output from your module will end up. For that don't forget to turn on "Template path hints" in the developer section of the admin panel.There's more, but I'll stop here before this turns into a dissertation.I will rather recommend Mage2Gen, this will help you generate the boilerplate and you can just focus on the core business logic. it just helps speed up the things.  A Magento Module is a group of directories containing blocks, controllers, helpers, and models that are needed to create a specific store feature. It is the unit of customization in the Magento platform. Magento Modules can be created to perform multiple functions with supporting logic to influence user experience and storefront appearance. It has a life cycle that allows them to be installed, deleted, or disabled. From the perspective of both merchants and extension developers, modules are the central unit of the Magento platform.Declaration of ModuleWe have to declare the module by using the configuration file. As Magento 2 search for configuration module in etc directory of the module. So now we will create configuration file module.xml.The code will look like this:Registration of Module

The module must be registered in the Magento 2 system by using Magento Component Registrar class. Now we will create the file registration.php in the module root directory:The Code will look like this:Check Module Status

After following the steps above, we would have created a simple module. Now we are going to check the status of the module and whether it is enabled or disabled by using the following command line:Share your feedback once you have gone through complete processI was trying to make my module from magaplaza hello world tutorial, but something went wrong. I imported code of this module https://github.com/astorm/magento2-hello-world from github and it worked. 

from that module, i created it a categories subcategories ajax select drop downs Module. After installing it in aap/code directory of your magento2 installation follow this URL.. http://www.example.com/hello_mvvm/hello/world

You can download its code from here https://github.com/sanaullahAhmad/Magento2_cat_subcat_ajax_select_dropdowns  and place it in your aap/code folder.

than run these commands...Now you can check module functionality with following URL http://{{www.example.com}}/hello_mvvm/hello/worldAnd, I suggest you to learn about system configuration.How to Show All Categories on System Configuration Field?Here I solved with a good example. It working. You can check and learn the flow of code.There are other too many examples also that you should learn.

How to install a specific version of package using Composer?

gdaras

[How to install a specific version of package using Composer?](https://stackoverflow.com/questions/40914114/how-to-install-a-specific-version-of-package-using-composer)

I am trying to install a specific version of a package using Composer. I tried composer install and composer require but they are installing the latest version of the package. What if I want an older version?

2016-12-01 15:12:54Z

I am trying to install a specific version of a package using Composer. I tried composer install and composer require but they are installing the latest version of the package. What if I want an older version?composer require vendor/package:versionfor example:composer require refinery29/test-util:0.10.2Add double quotes to use caret operator in version number.just use php composer.phar require  For example :Also available with install.https://getcomposer.org/doc/03-cli.md#require

https://getcomposer.org/doc/03-cli.md#installSuppose you want to install Laravel Collective. It's currently at version 6.x but you want version 5.8.  You can run the following command:A good example is shown here in the documentation:

https://laravelcollective.com/docs/5.5/htmlAs @alucic mentioned, use:or you can use:You should probably review this stackoverflow post about differences between composer install and composer update.Related to question about version numbers, you can review Composer documentation on versions, but here in short:So, with Tilde you will get automatic updates of patches but minor and major versions will not be updated. However, if you use Caret you will get patches and minor versions, but you will not get major (breaking changes) versions.Tilde Version is considered "safer" approach, but if you are using reliable dependencies (well-maintained libraries) you should not have any problems with Caret Version (because minor changes should not be breaking changes.In your composer.json, you can put:then run composer install or composer update from the directory containing composer.json.  Sometimes, for me, composer is hinky, so I'll start with composer clear-cache; rm -rf vendor; rm composer.lock before composer install to make sure it's getting fresh stuff.Of course, as the other answers point out you can run the following from the terminal:And on versioning:

- Composer's official versions article

- Ecosia Search

How to convert string to boolean php

laukok

[How to convert string to boolean php](https://stackoverflow.com/questions/7336861/how-to-convert-string-to-boolean-php)

How can I convert string to boolean?it returns,but it should be boolean false.

2011-09-07 15:54:26Z

How can I convert string to boolean?it returns,but it should be boolean false.Strings always evaluate to boolean true unless they have a value that's considered "empty" by PHP (taken from the documentation for empty):If you need to set a boolean based on the text value of a string, then you'll need to check for the presence or otherwise of that value. EDIT: the above code is intended for clarity of understanding.  In actual use the following code may be more appropriate: or maybe use of the filter_var function may cover more boolean values:filter_var covers a whole range of values, including the truthy values "true", "1", "yes" and "on". See here for more details.This method was posted by @lauthiamkok in the comments.  I'm posting it here as an answer to call more attention to it.Depending on your needs, you should consider using filter_var() with the FILTER_VALIDATE_BOOLEAN flag.The String "false"  is actually considered a "TRUE" value by PHP.

The documentation says:so if you do:orin both cases $bool will be TRUE. So you have to do it manually, like GordonM suggests.When working with JSON, I had to send a Boolean value via $_POST. I had a similar problem when I did something like:In the code above, my Boolean was converted into a JSON string.To overcome this, you can decode the string using json_decode():(This should normally work with Boolean values converted to string and sent to the server also by other means, i.e., other than using JSON.)you can use json_decode to decode that booleanIt handles all possible variants of $stringIf your "boolean" variable comes from a global array such as $_POST and $_GET, you can use filter_input() filter function. Example for POST:If your "boolean" variable comes from other source you can use filter_var() filter function.Example:You can use boolval($strValue)Examples:Documentation

http://php.net/manual/es/function.boolval.phpthe easiest thing to do is this:Doing it this way, you can loop through a series of 'true', 'TRUE', 'false' or 'FALSE' and get the string value to a boolean.Other answers are over complicating things. This question is simply logic question. Just get your statement right.Now your answer will be either I have to note that filter_var( $boolString, FILTER_VALIDATE_BOOLEAN ); still will be a better option if you need to have strings like on/yes/1 as alias for true.orYou must specify You can use settype method too!SetType($var,"Boolean")

Echo $var //see 0 or 1I do it in a way that will cast any case insensitive version of the string "false" to the boolean FALSE, but will behave using the normal php casting rules for all other strings. I think this is the best way to prevent unexpected behavior.Or as a function:The answer by @GordonM is good.

But it would fail if the $string is already true (ie, the string isn't a string but boolean TRUE)...which seems illogical.Extending his answer, I'd use:I was getting confused with wordpress shortcode attributes, I decided to write a custom function to handle all possibilities. maybe it's useful for someone:I am using the below approach:hmmmm i had such problem and i did in simple way and its working ok Edited to show a possibility not mentioned here, because my original answer was far from related to the OP's question.preg_match(); Is possible to use. However, in most applications it will be much more heavy to use than other answers here./(?:true)|(?:1)/i Can also be used if needed in certain situations. It will not return correctly when it evaluates a string containing both "false" and "1".A simple way is to check against an array of values that you consider true.You should be able to cast to a boolean using (bool) but I'm not sure without checking whether this works on the strings "true" and "false".This might be worth a pop thoughIt is worth knowing that the following will evaluate to the boolean False when put inside Everytyhing else will evaluate to true.As descried here:

http://www.php.net/manual/en/language.types.boolean.php#language.types.boolean.casting

Make XAMPP/Apache serve file outside of htdocs [closed]

cmcculloh

[Make XAMPP/Apache serve file outside of htdocs [closed]](https://stackoverflow.com/questions/1408/make-xampp-apache-serve-file-outside-of-htdocs)

Is it possible to configure xampp to serve up a file outside of the htdocs directory?For instance, say I have a file located as follows:C:\projects\transitCalculator\trunk\TransitCalculator.phpand my xampp files are normally served out from:C:\xampp\htdocs\(because that's the default configuration) Is there some way to make Apache recognize and serve up my TransitCalculator.php file without moving it under htdocs? Preferably I'd like Apache to serve up/have access to the entire contents of the projects directory, and I don't want to move the projects directory under htdocs.edit: edited to add Apache to the question title to make Q/A more "searchable"

2008-08-04 16:54:49Z

Is it possible to configure xampp to serve up a file outside of the htdocs directory?For instance, say I have a file located as follows:C:\projects\transitCalculator\trunk\TransitCalculator.phpand my xampp files are normally served out from:C:\xampp\htdocs\(because that's the default configuration) Is there some way to make Apache recognize and serve up my TransitCalculator.php file without moving it under htdocs? Preferably I'd like Apache to serve up/have access to the entire contents of the projects directory, and I don't want to move the projects directory under htdocs.edit: edited to add Apache to the question title to make Q/A more "searchable"Ok, per pix0r's, Sparks' and Dave's answers it looks like there are three ways to do this:Now you can access that directory by browsing to http://transitcalculator.localhost/.Notes: You can relocate it by editing the DocumentRoot setting in XAMPP\apache\conf\httpd.conf.It should currently be:Change it to:A VirtualHost would also work for this and may work better for you as you can host several projects without the need for subdirectories.  Here's how you do it:httpd.conf (or extra\httpd-vhosts.conf relative to httpd.conf. Trailing slashes "\" might cause it not to work):HOSTS file (c:\windows\system32\drivers\etc\hosts usually):Now restart XAMPP and you should be able to access http://transitcalculator.localhost/ and it will map straight to that directory.This can be helpful if you're trying to replicate a production environment where you're developing a site that will sit on the root of a domain name.  You can, for example, point to files with absolute paths that will carry over to the server:whereas in an environment using aliases or subdirectories, you'd need keep track of exactly where the "images" directory was relative to the current file.You can set Apache to serve pages from anywhere with any restrictions but it's normally distributed in a more secure form.Editing your apache files (http.conf is one of the more common names) will allow you to set any folder so it appears in your webroot.EDIT:alias myapp c:\myapp\I've edited my answer to include the format for creating an alias in the http.conf file which is sort of like a shortcut in windows or a symlink under un*x where Apache 'pretends' a folder is in the webroot.  This is probably going to be more useful to you in the long term.If you're trying to get XAMPP to use a network drive as your document root you have to use UNC paths in httpd.conf. XAMPP will not recognize your mapped network drives.For example the following won't work,

DocumentRoot "X:/webroot"But this will,

DocumentRoot "//192.168.10.100/webroot" (note the forward slashes, not back slashes)Solution to allow Apache 2 to host websites outside of htdocs:Underneath the "DocumentRoot" directive in httpd.conf, you should see a directory block. Replace this directory block with:REMEMBER NOT TO USE THIS CONFIGURATION IN A REAL ENVIRONMENT

php var_dump() vs print_r()

ina

[php var_dump() vs print_r()](https://stackoverflow.com/questions/3406171/php-var-dump-vs-print-r)

What is the difference between var_dump() and print_r() in terms of spitting out an array as string?

2010-08-04 13:50:24Z

What is the difference between var_dump() and print_r() in terms of spitting out an array as string?The var_dump function displays structured information about variables/expressions including its type and value. Arrays are explored recursively with values indented to show structure. It also shows which array values and object properties are references.The print_r() displays information about a variable in a way that's readable by humans. array values will be presented in a format that shows keys and elements. Similar notation is used for objects.Example:var_dump($obj) will display below output in the screen.And, print_r($obj) will display below output in the screen.More InfoGenerally,  print_r( ) output is nicer, more concise and easier to read, aka more human-readable but cannot show data types. With print_r() you can also store the output into a variable:which var_dump() cannot do. Yet var_dump() can show data types.var_dump() will show you the type of the thing as well as what's in it.So you'll get => (string)"var" Example is here.print_r() will just output the content.Would output => "var" Example is here.If you're asking when you should use what, I generally use print_r() for displaying values and var_dump() for when having issues with variable types.var_dump displays structured information about the object / variable. This includes type and values. Like print_r arrays are recursed through and indented.print_r displays human readable information about the values with a format presenting keys and elements for arrays and objects.The most important thing to notice is var_dump will output type as well as values while print_r does not.Significant differences between var_dump and print_rboth the functions dumps information about the variable, but var_dump multiple parameters which will be dumped, where as print_r can take two parameters out of which first parameter is the variable you want to dump and second is a boolean value.var_dump can't return any value it can only dump/print the values where as print_r can return the variable information if we set second parameter of print_r to true. The returned value of print_r will be in string format. The information printed by print_r is much more in readable format where as var_dump prints raw values.print_r function can be used in many contexts where as var_dump can be used in debugging purposes mainly since it can't return value.I'd aditionally recommend putting the output of var_dump() or printr into a pre tag when outputting to a browser.Will give a more readable result.var_dump($var) shows in-depth details, by providing  additional details of With large arrays, print_r can show far more information than is useful. You can truncate it like this, showing the first 2000 characters or however many you need.var_dump() :-Example :-output :-print_r() :-Example :-Output:-print_r() and var_dump() are Array debugging functions used in PHP for debugging purpose. print_r() function returns the array keys and its members as Array([key] = value) whereas var_dump() function returns array list with its array keys with data type and length as well e.g Array(array_length){[0] = string(1)'a'}.We can pass multiple parameters with var_dump

like:

Detect encoding and make everything UTF-8

caw

[Detect encoding and make everything UTF-8](https://stackoverflow.com/questions/910793/detect-encoding-and-make-everything-utf-8)

I'm reading out lots of texts from various RSS feeds and inserting them into my database.Of course, there are several different character encodings used in the feeds, e.g. UTF-8 and ISO 8859-1.Unfortunately, there are sometimes problems with the encodings of the texts. Example:What can I do to avoid the cases 2 and 3?How can I make everything the same encoding, preferably UTF-8? When must I use utf8_encode(), when must I use utf8_decode() (it's clear what the effect is but when must I use the functions?) and when must I do nothing with the input?How do I make everything the same encoding? Perhaps with the function mb_detect_encoding()? Can I write a function for this? So my problems are:Would a function like this work?I've tested it, but it doesn't work. What's wrong with it?

2009-05-26 13:50:34Z

I'm reading out lots of texts from various RSS feeds and inserting them into my database.Of course, there are several different character encodings used in the feeds, e.g. UTF-8 and ISO 8859-1.Unfortunately, there are sometimes problems with the encodings of the texts. Example:What can I do to avoid the cases 2 and 3?How can I make everything the same encoding, preferably UTF-8? When must I use utf8_encode(), when must I use utf8_decode() (it's clear what the effect is but when must I use the functions?) and when must I do nothing with the input?How do I make everything the same encoding? Perhaps with the function mb_detect_encoding()? Can I write a function for this? So my problems are:Would a function like this work?I've tested it, but it doesn't work. What's wrong with it?If you apply utf8_encode() to an already UTF-8 string, it will return garbled UTF-8 output.I made a function that addresses all this issues. It´s called Encoding::toUTF8().You don't need to know what the encoding of your strings is. It can be Latin1 (ISO 8859-1), Windows-1252 or UTF-8, or the string can have a mix of them. Encoding::toUTF8() will convert everything to UTF-8.I did it because a service was giving me a feed of data all messed up, mixing UTF-8 and Latin1 in the same string.Usage:Download:https://github.com/neitanod/forceutf8I've included another function, Encoding::fixUFT8(), which will fix every UTF-8 string that looks garbled.Usage:Examples:will output:I've transformed the function (forceUTF8) into a family of static functions on a class called Encoding. The new function is Encoding::toUTF8().You first have to detect what encoding has been used. As you’re parsing RSS feeds (probably via HTTP), you should read the encoding from the charset parameter of the Content-Type HTTP header field. If it is not present, read the encoding from the encoding attribute of the XML processing instruction. If that’s missing too, use UTF-8 as defined in the specification.Edit   Here is what I probably would do:I’d use cURL to send and fetch the response. That allows you to set specific header fields and fetch the response header as well. After fetching the response, you have to parse the HTTP response and split it into header and body. The header should then contain the Content-Type header field that contains the MIME type and (hopefully) the charset parameter with the encoding/charset too. If not, we’ll analyse the XML PI for the presence of the encoding attribute and get the encoding from there. If that’s also missing, the XML specs define to use UTF-8 as encoding.Detecting the encoding is hard.mb_detect_encoding works by guessing, based on a number of candidates that you pass it. In some encodings, certain byte-sequences are invalid, an therefore it can distinguish between various candidates. Unfortunately, there are a lot of encodings, where the same bytes are valid (but different). In these cases, there is no way to determine the encoding; You can implement your own logic to make guesses in these cases. For example, data coming from a Japanese site might be more likely to have a Japanese encoding.As long as you only deal with Western European languages, the three major encodings to consider are utf-8, iso-8859-1 and cp-1252. Since these are defaults for many platforms, they are also the most likely to be reported wrongly about. Eg. if people use different encodings, they are likely to be frank about it, since else their software would break very often. Therefore, a good strategy is to trust the provider, unless the encoding is reported as one of those three. You should still doublecheck that it is indeed valid, using mb_check_encoding (note that valid is not the same as being - the same input may be valid for many encodings). If it is one of those, you can then use mb_detect_encoding to distinguish between them. Luckily that is fairly deterministic; You just need to use the proper detect-sequence, which is UTF-8,ISO-8859-1,WINDOWS-1252. Once you've detected the encoding you need to convert it to your internal representation (UTF-8 is the only sane choice). The function utf8_encode transforms ISO-8859-1 to UTF-8, so it can only used for that particular input type. For other encodings, use mb_convert_encoding.A really nice way to implement an isUTF8-function can be found on php.net:This cheatsheet lists some common caveats related to UTF-8 handling in PHP:

http://developer.loftdigital.com/blog/php-utf-8-cheatsheetThis function detecting multibyte characters in a string might also prove helpful (source):A little heads up. You said that the "ß" should be displayed as "ÂŸ" in your database.This is probably because you're using a database with Latin-1 character encoding or possibly your PHP-MySQL connection is set wrong, this is, P believes your MySQL is set to use UTF-8, so it sends data as UTF-8, but your MySQL believes PHP is sending data encoded as ISO 8859-1, so it may once again try to encode your sent data as UTF-8, causing this kind of trouble.Take a look at mysql_set_charset. It may help you.Your encoding looks like you encoded into UTF-8 twice; that is, from some other encoding, into UTF-8, and again into UTF-8. As if you had ISO 8859-1, converted from ISO 8859-1 to UTF-8, and treated the new string as ISO 8859-1 for another conversion into UTF-8.Here's some pseudocode of what you did:You should try:That is presuming that in the "middle" conversion you used ISO 8859-1. If you used Windows-1252, then convert into Windows-1252 (latin1). The original source encoding is not important; the one you used in flawed, second conversion is.This is my guess at what happened; there's very little else you could have done to get four bytes in place of one extended ASCII byte.The German language also uses ISO 8859-2 and Windows-1250 (Latin-2).The interesting thing about mb_detect_encoding and mb_convert_encoding is that the order of the encodings you suggest does matter:So you might want to use a specific order when specifying expected encodings. Still, keep in mind that this is not foolproof.You need to test the character set on input since responses can come coded with different encodings.I force all content been sent into UTF-8 by doing detection and translation using the following function:That routine will turn all PHP variables that come from the remote host into UTF-8.Or ignore the value if the encoding could not be detected or converted.You can customize it to your needs.Just invoke it before using the variables.Working out the character encoding of RSS feeds seems to be complicated.  Even normal web pages often omit, or lie about, their encoding.So you could try to use the correct way to detect the encoding and then fall back to some form of auto-detection (guessing).I know this is an older question, but I figure a useful answer never hurts. I was having issues with my encoding between a desktop application, SQLite, and GET/POST variables. Some would be in UTF-8, some would be in ASCII, and basically everything would get screwed up when foreign characters got involved.Here is my solution. It scrubs your GET/POST/REQUEST (I omitted cookies, but you could add them if desired) on each page load before processing. It works well in a header. PHP will throw warnings if it can't detect the source encoding automatically, so these warnings are suppressed with @'s.I was checking for solutions to encoding since ages, and this page is probably the conclusion of years of search! I tested some of the suggestions you mentioned and here's my notes:This is my test string:I do an INSERT to save this string on a database in a field that is set as utf8_general_ciThe character set of my page is UTF-8.If I do an INSERT just like that, in my database, I have some characters probably coming from Mars...So I need to convert them into some "sane" UTF-8. I tried utf8_encode(), but still aliens chars were invading my database...So I tried to use the function forceUTF8 posted on number 8, but in the database the string saved looks like this:So collecting some more information on this page and merging them with other information on other pages I solved my problem with this solution:Now in my database I have my string with correct encoding.NOTE:

Only note to take care of is in function mysql_client_encoding!

You need to be connected to the database, because this function wants a resource ID as a parameter.But well, I just do that re-encoding before my INSERT so for me it is not a problem.It's simple: when you get something that's not UTF-8, you must encode that into UTF-8.So, when you're fetching a certain feed that's ISO 8859-1 parse it through utf8_encode.However, if you're fetching an UTF-8 feed, you don't need to do anything.php.net/mb_detect_encodingori really don't know what the results are, but i'd suggest you just take some of your feeds with different encodings and try if mb_detect_encoding works or not.update

auto is short for "ASCII,JIS,UTF-8,EUC-JP,SJIS". it returns the detected charset, which you can use to convert the string to utf-8 with iconv.i haven't tested it, so no guarantee. and maybe there's a simpler way.@harpax that worked for me.  In my case, this is good enough:After sorting out your php scripts, don't forget to tell mysql what charset you are passing and would like to recceive.Example: set character set utf8Passing utf8 data to a latin1 table in a latin1 I/O session gives those nasty birdfeets. I see this every other day in oscommerce shops. Back and fourth it might seem right. But phpmyadmin will show the truth. By telling mysql what charset you are passing it will handle the conversion of mysql data for you.How to recover existing scrambled mysql data is another thread to discuss. :)This version is for German language but you can modifiy the $CHARSETS and the $TESTCHARS

Get encoding from headers and convert it to utf-8.ÂŸ is Mojibake for ß.  In your database, you may have hexYou should not use any encoding/decoding functions in PHP; instead, you should set up the database and the connection to it correctly.If MySQL is involved, see: Trouble with utf8 characters; what I see is not what I storedI find solution here http://deer.org.ua/2009/10/06/1/I think that @ is bad decision, and make some changes to solution from deer.org.ua;The most voted answer doesn't work. Here is mine and hope it helps.When you try to handle multi languages like Japanese and Korean you might get in trouble. mb_convert_encoding with 'auto' parameter doesn't work well. Setting mb_detect_order('ASCII,UTF-8,JIS,EUC-JP,SJIS,EUC-KR,UHC') doesn't help since it will detect EUC-* wrongly.I concluded that as long as input strings comes from HTML, it should use 'charset' in a meta element. I use Simple HTML DOM Parser because it supports invalid HTML.The below snippet extracts title element from a web page. If you would like to convert entire page, then you may want to remove some lines.I had same issue with phpQuery (ISO-8859-1 instead of UTF-8) and this hack helped me:mb_internal_encoding('UTF-8'), phpQuery::newDocumentHTML($html, 'utf-8'), mbstring.internal_encoding and other manipulations didn't take any effect.Try without 'auto'That is:instead of:More information can be found here: mb_detect_encoding

What is the difference between the | and || or operators?

GloryFish

[What is the difference between the | and || or operators?](https://stackoverflow.com/questions/35301/what-is-the-difference-between-the-and-or-operators)

I have always used || (two pipes) in OR expressions, both in C# and PHP. Occasionally I see a single pipe used: |. What is the difference between those two usages? Are there any caveats when using one over the other or are they interchangeable?

2008-08-29 21:11:17Z

I have always used || (two pipes) in OR expressions, both in C# and PHP. Occasionally I see a single pipe used: |. What is the difference between those two usages? Are there any caveats when using one over the other or are they interchangeable?Just like the & and && operator, the double Operator is a "short-circuit" operator.For example:If condition1 is true, condition 2 and 3 will NOT be checked.This will check conditions 2 and 3, even if 1 is already true. As your conditions can be quite expensive functions, you can get a good performance boost by using them.There is one big caveat, NullReferences or similar problems. For example:If class is null, the if-statement will stop after class != null is false. If you only use &, it will try to check class.someVar and you get a nice NullReferenceException. With the Or-Operator that may not be that much of a trap as it's unlikely that you trigger something bad, but it's something to keep in mind.No one ever uses the single & or | operators though, unless you have a design where each condition is a function that HAS to be executed. Sounds like a design smell, but sometimes (rarely) it's a clean way to do stuff. The & operator does "run these 3 functions, and if one of them returns false, execute the else block", while the | does "only run the else block if none return false" - can be useful, but as said, often it's a design smell.There is a Second use of the | and & operator though: Bitwise Operations.|| is the logical OR operator. It sounds like you basically know what that is. It's used in conditional statements such as if, while, etc.Evaluates to true if either condition1 OR condition2 is true.| is the bitwise OR operator. It's used to operate on two numbers. You look at each bit of each number individually and, if one of the bits is 1 in at least one of the numbers, then the resulting bit will be 1 also. Here are a few examples:Hopefully that makes sense.So to answer the last two questions, I wouldn't say there are any caveats besides "know the difference between the two operators." They're not interchangeable because they do two completely different things.One is a "bitwise or".The other is a logic or.Good question.  These two operators work the same in PHP and C#.| is a bitwise OR.  It will compare two values by their bits.  E.g. 1101 | 0010 = 1111.  This is extremely useful when using bit options.  E.g. Read = 01 (0X01) Write = 10 (0X02)  Read-Write = 11 (0X03).  One useful example would be opening files.  A simple example would be:  || is a logical OR.  This is the way most people think of OR and compares two values based on their truth.  E.g. I am going to the store or I will go to the mall.  This is the one used most often in code. For example:PHP Resource: http://us3.php.net/language.operators.bitwiseC# Resources: http://msdn.microsoft.com/en-us/library/kxszd0kx(VS.71).aspxhttp://msdn.microsoft.com/en-us/library/6373h346(VS.71).aspxSimple example in javaoutput : & - (Condition 1 & Condition 2): checks both cases even if first one is false&& - (Condition 1 && Condition 2): dosen't bother to check second case if case one 

                                   is false && - operator will make your code run faster, professionally & is rarely used| - (Condition 1 | Condition 2): checks both cases even if case 1 is true|| - (Condition 1 || Condition 2): dosen't  bother to check second case if first 

                                   one is true || - operator will make your code run faster, professionally | is rarely usedThe single pipe, |, is one of the bitwise operators.From Wikipedia: By their mathematical definition, OR and AND are binary operators; they verify the LHS and RHS conditions regardless, similarly to | and &. || and && alter the properties of the OR and AND operators by stopping them when the LHS condition isn't fulfilled.The | operator performs a bitwise OR of its two operands (meaning both sides must evaluate to false for it to return false) while the || operator will only evaluate the second operator if it needs to.http://msdn.microsoft.com/en-us/library/kxszd0kx(VS.71).aspxhttp://msdn.microsoft.com/en-us/library/6373h346(VS.71).aspxThe singe pipe "|" is the "bitwise" or and should only be used when you know what you're doing. The double pipe "||" is a logical or, and can be used in logical statements, like "x == 0 || x == 1".Here's an example of what the bitwise or does: if a=0101 and b=0011, then a|b=0111. If you're dealing with a logic system that treats any non-zero as true, then the bitwise or will act in the same way as the logical or, but it's counterpart (bitwise and, "&") will NOT. Also the bitwise or does not perform short circuit evaluation.A single pipe (|) is the bitwise OR operator.Two pipes (||) is the logical OR operator.They are not interchangeable.|| (two pipes) is usually a logical or while | (one pipe) is a binary or.  Off the top of my head, I can't think of any time the difference would be a big gotcha (other than when you're assigning the result to something else).  However I sure someone else will have a situation where it matters.Edit: Wow, six other answers in the time it took me to write this.Bitwise (|) vs. logical(||)!

Think of logical as the Comparable objects in Java, comparing some distinguishable "parts" while the bitwise operator looks at these objects and instead of seeing if they are visually twins (like logical does), does a DNA sample and looks at the 0's and 1's instead.

Deleting all files from a folder using PHP?

getaway

[Deleting all files from a folder using PHP?](https://stackoverflow.com/questions/4594180/deleting-all-files-from-a-folder-using-php)

For example I had a folder called `Temp' and I wanted to delete or flush all files from this folder using PHP. Could I do this?

2011-01-04 13:35:43Z

For example I had a folder called `Temp' and I wanted to delete or flush all files from this folder using PHP. Could I do this?If you want to remove 'hidden' files like .htaccess, you have to useIf you want to delete everything from folder (including subfolders) use this combination of array_map, unlink and glob:This call can also handle empty directories ( thanks for the tip, @mojuba!)Here is a more modern approach using the Standard PHP Library (SPL).This code from http://php.net/unlink:See readdir and unlink.Assuming you have a folder with A LOT of files reading them all and then deleting in two steps is not that performing.

I believe the most performing way to delete files is to just use a system command. For example on linux I use :Or this if you want recursive deletion without the need to write a recursive functionthe same exact commands exists for any OS supported by PHP.

Keep in mind this is a PERFORMING way of deleting files. $absolutePathToFolder MUST be checked and secured before running this code and permissions must be granted.The simple and best way to delete all files from a folder in PHPGot this source code from here - http://www.codexworld.com/delete-all-files-from-folder-using-php/Another solution:

This Class delete all files, subdirectories and files in the sub directories.unlinkr function recursively deletes all the folders and files in given path by making sure it doesn't delete the script itself.if you want to delete all files and folders where you place this script then call it as followingif you want to just delete just php files then call it as followingyou can use any other path to delete the files as well This will delete all files in home/user/temp directory.Posted a general purpose file and folder handling class for copy, move, delete, calculate size, etc., that can handle a single file or a set of folders. https://gist.github.com/4689551To use: To copy (or move) a single file or a set of folders/files:Delete a single file or all files and folders in a path:Calculate the size of a single file or a set of files in a set of folders:For me, the solution with readdir was best and worked like a charm. With glob, the function was failing with some scenarios.I updated the answer of @Stichoza to remove files through subfolders.There's a package called "Pusheh". Using it, you can clear a directory or remove a directory completely (Github link). It's available on Packagist, also.For instance, if you want to clear Temp directory, you can do:If you're interested, see the wiki.

Simplest way to profile a PHP script

Mark Biek

[Simplest way to profile a PHP script](https://stackoverflow.com/questions/21133/simplest-way-to-profile-a-php-script)

What's the easiest way to profile a PHP script?I'd love tacking something on that shows me a dump of all function calls and how long they took but I'm also OK with putting something around specific functions.I tried experimenting with the microtime function:but that sometimes gives me negative results.  Plus it's a lot of trouble to sprinkle that all over my code.

2008-08-21 20:40:38Z

What's the easiest way to profile a PHP script?I'd love tacking something on that shows me a dump of all function calls and how long they took but I'm also OK with putting something around specific functions.I tried experimenting with the microtime function:but that sometimes gives me negative results.  Plus it's a lot of trouble to sprinkle that all over my code.The PECL APD extension is used as follows:After, parse the generated file using pprofp.Example output:Warning: the latest release of APD is dated 2004, the extension is no longer maintained and has various compability issues (see comments).You want xdebug I think. Install it on the server, turn it on, pump the output through kcachegrind (for linux) or wincachegrind (for windows) and it'll show you a few pretty charts that detail the exact timings, counts and memory usage (but you'll need another extension for that).It rocks, seriously :DNo extensions are needed, just use these two functions for simple profiling.Here is an example, calling prof_flag() with a description at each checkpoint, and prof_print() at the end:Output looks like this:Start   0.004303Connect to DB   0.003518Perform query   0.000308Retrieve data   0.000009Close DB   0.000049DoneCross posting my reference from SO Documentation beta which is going offline.An extension to PHP called Xdebug is available to assist in profiling PHP applications, as well as runtime debugging.  When running the profiler, the output is written to a file in a binary format called "cachegrind".  Applications are available on each platform to analyze these files.  No application code changes are necessary to perform this profiling.To enable profiling, install the extension and adjust php.ini settings. Some Linux distributions come with standard packages (e.g. Ubuntu's php-xdebug package). In our example we will run the profile optionally based on a request parameter.  This allows us to keep settings static and turn on the profiler only as needed.Next use a web client to make a request to your application's URL you wish to profile, e.g.As the page processes it will write to a file with a name similar to By default the number in the filename is the process id which wrote it.  This is configurable with the xdebug.profiler_output_name setting.Note that it will write one file for each PHP request / process that is executed.  So, for example, if you wish to analyze a form post, one profile will be written for the GET request to display the HTML form.  The XDEBUG_PROFILE parameter will need to be passed into the subsequent POST request to analyze the second request which processes the form.  Therefore when profiling it is sometimes easier to run curl to POST a form directly.Analyzing the OutputOnce written the profile cache can be read by an application such as KCachegrind or Webgrind. PHPStorm, a popular PHP IDE, can also display this profiling data.KCachegrind, for example, will display information including:What to Look ForObviously performance tuning is very specific to each application's use cases.  In general it's good to look for:Note: Xdebug, and in particular its profiling features, are very resource intensive and slow down PHP execution.  It is recommended to not run these in a production server environment.If subtracting microtimes gives you negative results, try using the function with the argument true (microtime(true)). With true, the function returns a float instead of a string (as it does if it is called without arguments).Honestly, I am going to argue that using NewRelic for profiling is the best.It's a PHP extension which doesn't seem to slow down runtime at all and they do the monitoring for you, allowing decent drill down.  In the expensive version they allow heavy drill down (but we can't afford their pricing model).Still, even with the free/standard plan, it's obvious and simple where most of the low hanging fruit is.  I also like that it can give you an idea on DB interactions too.PECL XHPROF looks interensting too. It has clickable HTML interface for viewing reports and pretty straightforward documentation. I have yet to test it though.Poor man's profiling, no extensions required. Supports nested profiles and percent of total:Example:Yields:I like to use phpDebug for profiling.

http://phpdebug.sourceforge.net/www/index.htmlIt outputs all time / memory usage for any SQL used as well as all the included files. Obviously, it works best on code that's abstracted. For function and class profiling I'll just use microtime() + get_memory_usage() + get_peak_memory_usage(). I would defiantly give BlackFire a try. There is this virtualBox I've put together using puphpet, to test different php frameworks which coms with BlackFire, please feel free to fork and/or distribute if required :) https://github.com/webit4me/PHPFrameworksFor benchmarking, like in your example, I use the pear Benchmark package. You set markers for measuring. The class also provides a few presentation helpers, or you can process the data as you see fit.I actually have it wrapped in another class with a __destruct method. When a script exits, the output is logged via log4php to syslog, so I have a lot of performance data to work from.XDebug is not stable and it's not always available for particular php version. For example on some servers I still run php-5.1.6, -- it's what comes with RedHat RHEL5 (and btw still receives updates for all important issues), and recent XDebug does not even compile with this php. So I ended up with switching to DBG debugger

Its php benchmarking provides timing for functions, methods, modules and even lines.You all should definitely check this new php profiler.https://github.com/NoiseByNorthwest/php-spxIt redefines the way of how php profilers collects and presents the result.

Instead of outputting just a total number of particular function calls and total time spent of executing it - PHP-SPX presents the whole timeline of request execution in a perfectly readable way. Below is the screen of GUI it provides.

Converting string to Date and DateTime

Chris Pinski

[Converting string to Date and DateTime](https://stackoverflow.com/questions/6238992/converting-string-to-date-and-datetime)

If I have a PHP string in the format of mm-dd-YYYY (for example, 10-16-2003), how do I properly convert that to a Date and then a DateTime in the format of YYYY-mm-dd? The only reason I ask for both Date and DateTime is because I need one in one spot, and the other in a different spot.

2011-06-04 19:46:07Z

If I have a PHP string in the format of mm-dd-YYYY (for example, 10-16-2003), how do I properly convert that to a Date and then a DateTime in the format of YYYY-mm-dd? The only reason I ask for both Date and DateTime is because I need one in one spot, and the other in a different spot.Use strtotime() on your first date then date('Y-m-d') to convert it back:Make note that there is a difference between using forward slash / and hyphen - in the strtotime() function. To quote from php.net:You need to be careful with m/d/Y and m-d-Y formats. PHP considers / to mean m/d/Y and - to mean d-m-Y. I would explicitly describe the input format in this case:That way you are not at the whims of a certain interpretation.To parse the date, you should use:

    DateTime::createFromFormat();Ex:However, careful, because this will crash with:You actually need to check that the formatting went fine, first:Now instead of crashing, you will get an exception, which you can catch, propagate, etc.$dateDE has the wrong format, it should be "16.10.2013";Edit: you can also pass a DateTimeZone to DateTime() constructor to ensure the creation of the date for the desired time zone, not the server default one.For first DateFor New DateIf you have format dd-mm-yyyy then in PHP it won't work as expected. In PHP document they have below guideline. So, you just can't use as you wish. When your try to use dd/mm/yyyy format with this then it will remove FALSE. You can tweak with the following.Like we have date "07/May/2018" and we need date "2018-05-07" as mysql compatible   It works for me. enjoy :)Since no one mentioned this, here's another way:$date = date_create_from_format("m-d-Y", "10-16-2003")->format("Y-m-d");If you wish to accept dates using American ordering (month, date, year) for European style formats (using dash or period as day, month, year) while still accepting other formats, you can extend the DateTime class:Or, you can make a function to accept m-d-Y and output Y-m-d:

Remove new lines from string and replace with one empty space

James

[Remove new lines from string and replace with one empty space](https://stackoverflow.com/questions/3760816/remove-new-lines-from-string-and-replace-with-one-empty-space)

Want to remove all new lines from string.I've this regex, it can catch all of them, the problem is I don't know with which function should I use it.$string should become:

2010-09-21 13:34:43Z

Want to remove all new lines from string.I've this regex, it can catch all of them, the problem is I don't know with which function should I use it.$string should become:You have to be cautious of double line breaks, which would cause double spaces. Use this really efficient regular expression:Multiple spaces and newlines are replaced with a single space.Edit: As others have pointed out, this solution has issues matching single newlines in between words. This is not present in the example, but one can easily see how that situation could occur. An alternative is to do the following:A few comments on the accepted answer:The + means "1 or more". I don't think you need to repeat \s. I think you can simply write '/\s+/'.Also, if you want to remove whitespace first and last in the string, add trim.With these modifications, the code would be:Just use preg_replace()You could get away with str_replace() on this one, although the code doesn't look as clean:See it live on ideoneYou should use str_replace for its speed and using double quotes with an arrayPCRE regex replacements can be done using preg_replace:

http://php.net/manual/en/function.preg-replace.phpWould replace new line or return characters with a space. If you don't want anything to replace them, change the 2nd argument to ''.I'm not sure if this has any value against the already submitted answers but I can just as well post it.Use this:replace series of newlines with an empty string:or you probably want to replace newlines with a single space:Escape sequence \R matches a generic newlineRegex101 DemoLine breaks in text are generally represented as:\r\n - on a windows computer\r - on an Apple computer\n - on LinuxWhats about:This should be a pretty robust solution because \n doesn't work correctly in all systems if i'm not wrong ...I was surprised to see how little everyone knows about regex.Strip newlines in php isIn perlMeaning replace any newline character at the end of the line (for efficiency) - optionally preceded by a carriage return - with a space.\n or \015 is newline.

\r or \012 is carriage return.

? in regex means match 1 or zero of the previous character.

$ in regex means match end of line.The original and best regex reference is perldoc perlre, every coder should know this doc pretty well:

http://perldoc.perl.org/perlre.html

Note not all features are supported by all languages.this is the pattern I would usemaybe this works:This one also removes tabsYou can try below code will preserve any white-space and new lines in your text.Many of these solutions didn't work for me.

This did the trick though:-Here is the reference:-

PCRE and New Linesthis below code work all text please use it:You can remove new line and multiple white spaces.

Tracking the script execution time in PHP

twk

[Tracking the script execution time in PHP](https://stackoverflow.com/questions/535020/tracking-the-script-execution-time-in-php)

PHP must track the amount of CPU time a particular script has used in order to enforce the max_execution_time limit.  Is there a way to get access to this inside of the script?  I'd like to include some logging with my tests about how much CPU was burnt in the actual PHP (the time is not incremented when the script is sitting and waiting for the database).I am using a Linux box.  

2009-02-11 00:58:31Z

PHP must track the amount of CPU time a particular script has used in order to enforce the max_execution_time limit.  Is there a way to get access to this inside of the script?  I'd like to include some logging with my tests about how much CPU was burnt in the actual PHP (the time is not incremented when the script is sitting and waiting for the database).I am using a Linux box.  On unixoid systems (and in php 7+ on Windows as well), you can use getrusage, like:Note that you don't need to calculate a difference if you are spawning a php instance for every test.If all you need is the wall-clock time, rather than the CPU execution time, then it is simple to calculate: Note that this will include time that PHP is sat waiting for external resources such as disks or databases, which is not used for max_execution_time.Shorter version of talal7860's answerAs pointed out, this is 'wallclock time' not 'cpu time'The easiest way:I created an ExecutionTime class out of phihag answer that you can use out of box:usage:Gringod at developerfusion.com gives this good answer:From (http://www.developerfusion.com/code/2058/determine-execution-time-in-php/)The cheapest and dirtiest way to do it is simply make microtime() calls at places in your code you want to benchmark.  Do it right before and right after database queries and it's simple to remove those durations from the rest of your script execution time.A hint: your PHP execution time is rarely going to be the thing that makes your script timeout.  If a script times out it's almost always going to be a call to an external resource.PHP microtime documentation:

http://us.php.net/microtimeIt is going to be prettier if you format the seconds output like:will printThis is much better thanI think you should look at xdebug.  The profiling options will give you a head start toward knowing many process related items.http://www.xdebug.org/To show minutes and seconds you can use:I wrote a function that check remaining execution time.Warning: Execution time counting is different on Windows and on Linux platform.Using:You may only want to know the execution time of parts of your script. The most flexible way to time parts or an entire script is to create 3 simple functions (procedural code given here but you could turn it into a class by putting class timer{} around it and making a couple of tweaks). This code works, just copy and paste and run:As an alternative you can just put this line in your code blocks and check php logs, for really slow functions it's pretty useful: For serious debugging use XDebug + Cachegrind, see https://blog.nexcess.net/2011/01/29/diagnosing-slow-php-execution-with-xdebug-and-kcachegrind/Further expanding on Hamid's answer, I wrote a helper class that can be started and stopped repeatedly (for profiling inside a loop).return microtime(true) - $_SERVER["REQUEST_TIME_FLOAT"];

Proper Repository Pattern Design in PHP?

Jonathan

[Proper Repository Pattern Design in PHP?](https://stackoverflow.com/questions/16176990/proper-repository-pattern-design-in-php)

Preface: I'm attempting to use the repository pattern in an MVC architecture with relational databases.I've recently started learning TDD in PHP, and I'm realizing that my database is coupled much too closely with the rest of my application. I've read about repositories and using an IoC container to "inject" it into my controllers. Very cool stuff. But now have some practical questions about repository design. Consider the follow example.All of these find methods use a select all fields (SELECT *) approach. However, in my apps, I'm always trying to limit the number of fields I get, as this often adds overhead and slows things down. For those using this pattern, how do you deal with this?While this class looks nice right now, I know that in a real-world app I need a lot more methods. For example:As you can see, there could be a very, very long list of possible methods. And then if you add in the field selection issue above, the problem worsens. In the past I'd normally just put all this logic right in my controller:With my repository approach, I don't want to end up with this:I see the benefit in using interfaces for repositories, so I can swap out my implementation (for testing purposes or other). My understanding of interfaces is that they define a contract that an implementation must follow. This is great until you start adding additional methods to your repositories like findAllInCountry(). Now I need to update my interface to also have this method, otherwise, other implementations may not have it, and that could break my application. By this feels insane...a case of the tail wagging the dog.This leads me to believe that repository should only have a fixed number of methods (like save(), remove(), find(), findAll(), etc). But then how do I run specific lookups? I've heard of the Specification Pattern, but it seems to me that this only reduces an entire set of records (via IsSatisfiedBy()), which clearly has major performance issues if you're pulling from a database.Clearly, I need to rethink things a little when working with repositories. Can anyone enlighten on how this is best handled?

2013-04-23 18:50:05Z

Preface: I'm attempting to use the repository pattern in an MVC architecture with relational databases.I've recently started learning TDD in PHP, and I'm realizing that my database is coupled much too closely with the rest of my application. I've read about repositories and using an IoC container to "inject" it into my controllers. Very cool stuff. But now have some practical questions about repository design. Consider the follow example.All of these find methods use a select all fields (SELECT *) approach. However, in my apps, I'm always trying to limit the number of fields I get, as this often adds overhead and slows things down. For those using this pattern, how do you deal with this?While this class looks nice right now, I know that in a real-world app I need a lot more methods. For example:As you can see, there could be a very, very long list of possible methods. And then if you add in the field selection issue above, the problem worsens. In the past I'd normally just put all this logic right in my controller:With my repository approach, I don't want to end up with this:I see the benefit in using interfaces for repositories, so I can swap out my implementation (for testing purposes or other). My understanding of interfaces is that they define a contract that an implementation must follow. This is great until you start adding additional methods to your repositories like findAllInCountry(). Now I need to update my interface to also have this method, otherwise, other implementations may not have it, and that could break my application. By this feels insane...a case of the tail wagging the dog.This leads me to believe that repository should only have a fixed number of methods (like save(), remove(), find(), findAll(), etc). But then how do I run specific lookups? I've heard of the Specification Pattern, but it seems to me that this only reduces an entire set of records (via IsSatisfiedBy()), which clearly has major performance issues if you're pulling from a database.Clearly, I need to rethink things a little when working with repositories. Can anyone enlighten on how this is best handled?I thought I'd take a crack at answering my own question. What follows is just one way of solving the issues 1-3 in my original question.Disclaimer: I may not always use the right terms when describing patterns or techniques. Sorry for that.I'm splitting my persistent storage (database) interaction into two categories: R (Read) and CUD (Create, Update, Delete). My experience has been that reads are really what causes an application to slow down. And while data manipulation (CUD) is actually slower, it happens much less frequently, and is therefore much less of a concern.CUD (Create, Update, Delete) is easy. This will involve working with actual models, which are then passed to my Repositories for persistence. Note, my repositories will still provide a Read method, but simply for object creation, not display. More on that later.R (Read) is not so easy. No models here, just value objects. Use arrays if you prefer. These objects may represent a single model or a blend of many models, anything really. These are not very interesting on their own, but how they are generated is. I'm using what I'm calling Query Objects.Let's start simple with our basic user model. Note that there is no ORM extending or database stuff at all. Just pure model glory. Add your getters, setters, validation, whatever.Before I create my user repository, I want to create my repository interface. This will define the "contract" that repositories must follow in order to be used by my controller. Remember, my controller will not know where the data is actually stored.Note that my repositories will only every contain these three methods. The save() method is responsible for both creating and updating users, simply depending on whether or not the user object has an id set.Now to create my implementation of the interface. As mentioned, my example was going to be with an SQL database. Note the use of a data mapper to prevent having to write repetitive SQL queries.Now with CUD (Create, Update, Delete) taken care of by our repository, we can focus on the R (Read). Query objects are simply an encapsulation of some type of data lookup logic. They are not query builders. By abstracting it like our repository we can change it's implementation and test it easier. An example of a Query Object might be an AllUsersQuery or AllActiveUsersQuery, or even MostCommonUserFirstNames.You may be thinking "can't I just create methods in my repositories for those queries?" Yes, but here is why I'm not doing this:For my example I'll create a query object to lookup "AllUsers". Here is the interface:This is where we can use a data mapper again to help speed up development. Notice that I am allowing one tweak to the returned dataset—the fields. This is about as far as I want to go with manipulating the performed query. Remember, my query objects are not query builders. They simply perform a specific query. However, since I know that I'll probably be using this one a lot, in a number of different situations, I'm giving myself the ability to specify the fields. I never want to return fields I don't need!Before moving on to the controller, I want to show another example to illustrate how powerful this is. Maybe I have a reporting engine and need to create a report for AllOverdueAccounts. This could be tricky with my data mapper, and I may want to write some actual SQL in this situation. No problem, here is what this query object could look like:This nicely keeps all my logic for this report in one class, and it's easy to test. I can mock it to my hearts content, or even use a different implementation entirely.Now the fun part—bringing all the pieces together. Note that I am using dependency injection. Typically dependencies are injected into the constructor, but I actually prefer to inject them right into my controller methods (routes). This minimizes the controller's object graph, and I actually find it more legible. Note, if you don't like this approach, just use the traditional constructor method.The important things to note here are that when I'm modifying (creating, updating or deleting) entities, I'm working with real model objects, and performing the persistance through my repositories.However, when I'm displaying (selecting data and sending it to the views) I'm not working with model objects, but rather plain old value objects. I only select the fields I need, and it's designed so I can maximum my data lookup performance.My repositories stay very clean, and instead this "mess" is organized into my model queries.I use a data mapper to help with development, as it's just ridiculous to write repetitive SQL for common tasks. However, you absolutely can write SQL where needed (complicated queries, reporting, etc.). And when you do, it's nicely tucked away into a properly named class.I'd love to hear your take on my approach!July 2015 Update:I've been asked in the comments where I ended up with all this. Well, not that far off actually. Truthfully, I still don't really like repositories. I find them overkill for basic lookups (especially if you're already using an ORM), and messy when working with more complicated queries.I generally work with an ActiveRecord style ORM, so most often I'll just reference those models directly throughout my application. However, in situations where I have more complex queries, I'll use query objects to make these more reusable. I should also note that I always inject my models into my methods, making them easier to mock in my tests.Based on my experience, here are some answers to your questions:Q: How do we deal with bringing back fields we don't need?A: From my experience this really boils down to dealing with complete entities versus ad-hoc queries.A complete entity is something like a User object. It has properties and methods, etc. It's a first class citizen in your codebase.An ad-hoc query returns some data, but we don't know anything beyond that. As the data gets passed around the application, it is done so without context. Is it a User? A User with some Order information attached? We don't really know.I prefer working with full entities. You are right that you will often bring back data you won't use, but you can address this in various ways:The downsides of working with ad-hoc queries:Q: I will have too many methods in my repository.A: I haven't really seen any way around this other than consolidating calls. The method calls in your repository really map to features in your application. The more features, the more data specific calls. You can push back on features and try to merge similar calls into one.The complexity at the end of the day has to exist somewhere. With a repository pattern we've pushed it into the repository interface instead of maybe making a bunch of stored procedures.Sometimes I have to tell myself, "Well it had to give somewhere! There are no silver bullets."I use the following interfaces: My Repository is database agnostic; in fact it doesn't specify any persistence; it could be anything: SQL database, xml file, remote service, an alien from outer space etc.

For searching capabilities, the Repository constructs an Selector which can be filtered, LIMIT-ed, sorted and counted. In the end, the selector fetches one or more Entities from the persistence.Here is some sample code:Then, one implementation:The ideea is that the generic Selector uses Filter but the implementation SqlSelector uses SqlFilter; the SqlSelectorFilterAdapter adapts a generic Filter to a concrete SqlFilter. The client code creates Filter objects (that are generic filters) but in the concrete implementation of the selector those filters are transformed in SQL filters.Other selector implementations, like InMemorySelector, transform from Filter to InMemoryFilter using their specific InMemorySelectorFilterAdapter; so, every selector implementation comes with its own filter adapter.Using this strategy my client code (in the bussines layer) doesn't care about a specific repository or selector implementation.P.S. This is a simplification of my real codeI'll add a bit on this as I am currently trying to grasp all of this myself.  This is a perfect place for your ORM to do the heavy lifting.  If you are using a model that implements some kind of ORM, you can just use it's methods to take care of these things.  Make your own orderBy functions that implement the Eloquent methods if you need to.  Using Eloquent for instance:What you seem to be looking for is an ORM.  No reason your Repository can't be based around one.  This would require User extend eloquent, but I personally don't see that as a problem.If you do however want to avoid an ORM, you would then have to "roll your own" to get what you're looking for.Interfaces aren't supposed be hard and fast requirements. Something can implement an interface and add to it.  What it can't do is fail to implement a required function of that interface.  You can also extend interfaces like classes to keep things DRY.That said, I'm just starting to get a grasp, but these realizations have helped me.I can only comment on the way we (at my company) deal with this. First of all performance is not too much of an issue for us, but having clean/proper code is.First of all we define Models such as a UserModel that uses an ORM to create UserEntity objects. When a UserEntity is loaded from a model all fields are loaded. For fields referencing foreign entities we use the appropriate foreign model to create the respective entities. For those entities the data will be loaded ondemand. Now your initial reaction might be ...???...!!! let me give you an example a bit of an example:In our case $db is an ORM that is able to load entities. The model instructs the ORM to load a set of entities of a specific type. The ORM contains a mapping and uses that to inject all the fields for that entity in to the entity. For foreign fields however only the id's of those objects are loaded. In this case the OrderModel creates OrderEntitys with only the id's of the referenced orders. When PersistentEntity::getField gets called by the OrderEntity the entity instructs it's model to lazy load all the fields into the OrderEntitys. All the OrderEntitys associated with one UserEntity are treated as one result-set and will be loaded at once.The magic here is that our model and ORM inject all data into the entities and that entities merely provide wrapper functions for the generic getField method supplied by PersistentEntity. To summarize we always load all the fields, but fields referencing a foreign entity are loaded when necessary. Just loading a bunch of fields is not really a performance issue. Load all possible foreign entities however would be a HUGE performance decrease.Now on to loading a specific set of users, based on a where clause. We provide an object oriented package of classes that allow you to specify simple expression that can be glued together. In the example code I named it GetOptions. It's a wrapper for all possible options for a select query. It contains a collection of where clauses, a group by clause and everything else. Our where clauses are quite complicated but you could obviously make a simpler version easily.A simplest version of this system would be to pass the WHERE part of the query as a string directly to the model.I'm sorry for this quite complicated response. I tried to summarize our framework as quickly and clear as possible. If you have any additional questions feel free to ask them and I'll update my answer.EDIT: Additionally if you really don't want to load some fields right away you could specify a lazy loading option in your ORM mapping. Because all fields are eventually loaded through the getField method you could load some fields last minute when that method is called. This is not a very big problem in PHP, but I would not recommend for other systems.These are some different solutions I've seen. There are pros and cons to each of them, but it is for you to decide.This is an important aspect especially when you take in to account Index-Only Scans. I see two solutions to dealing with this problem. You can update your functions to take in an optional array parameter that would contain a list of a columns to return. If this parameter is empty you'd return all of the columns in the query. This can be a little weird; based off the parameter you could retrieve an object or an array. You could also duplicate all of your functions so that you have two distinct functions that run the same query, but one returns an array of columns and the other returns an object.I briefly worked with Propel ORM a year ago and this is based off what I can remember from that experience. Propel has the option to generate its class structure based off the existing database schema. It creates two objects for each table. The first object is a long list of access function similar to what you have currently listed; findByAttribute($attribute_value). The next object inherits from this first object. You can update this child object to build in your more complex getter functions.Another solution would be using __call() to map non defined functions to something actionable. Your __call method would be would be able to parse the findById and findByName into different queries.I hope this helps at least some what.I suggest https://packagist.org/packages/prettus/l5-repository as vendor to implement Repositories/Criterias etc ... in Laravel5 :DI agree with @ryan1234 that you should pass around complete objects within the code and should use generic query methods to get those objects. For external/endpoint usage I really like the GraphQL method.My gut tells me this maybe requires an interface that implements query optimized methods alongside generic methods. Performance sensitive queries should have targeted methods, while infrequent or light-weight queries get handled by a generic handler, maybe the the expense of the controller doing a little more juggling.The generic methods would allow any query to be implemented, and so would prevent breaking changes during a transition period. The targeted methods allow you to optimize a call when it makes sense to, and it can be applied to multiple service providers.This approach would be akin to hardware implementations performing specific optimized tasks, while software implementations do the light work or flexible implementation.I think graphQL is a good candidate in such a case to provide a large scale query language without increasing the complexity of data repositories.However, there's another solution if you don't want to go for the graphQL for now. By using a DTO where an object is used for carring the data between processes, in this case between the service/controller and the repository.An elegant answer is already provided above, however I'll try to give another example that I think it's simpler and could serve as a starting point for a new project. As shown in the code, we would need only 4 methods for CRUD operations. the find method would be used for listing and reading by passing object argument.

Backend services could build the defined query object based on a URL query string or based on specific parameters.The query object (SomeQueryDto) could also implement specific interface if needed. and is easy to be extended later without adding complexity.Example usage:

How to convert an image to base64 encoding?

Volatil3

[How to convert an image to base64 encoding?](https://stackoverflow.com/questions/3967515/how-to-convert-an-image-to-base64-encoding)

Can you please guide me how can I convert an image from a URL to base64 encoding?

2010-10-19 10:44:03Z

Can you please guide me how can I convert an image from a URL to base64 encoding?I think that it should be:Easy:bear in mind that this will enlarge the data by 33%, and you'll have problems with files whose size exceed your memory_limit. Use also this way to represent image in base64 encode format...

find PHP function file_get_content and next to use function base64_encodeand get result to prepare str as data:" . file_mime_type . " base64_encoded string. Use it in img src attribute. see following code can I help for you.Just in case you are (for whatever reason) unable to use curl nor file_get_contents, you can work around:I was trying to use this resource but kept getting an error, I found the code above worked perfectly.Just replaced IMAGE URL HERE with the URL of your image - http://www.website.com/image.jpgVery simple and to be commonly used:Note: The Mime-Type of the file will be added automatically (taking help from this PHP documentation).Here is the code for upload to encode and save it to the MySQLFor showing the image use thisHere is an example using a cURL call.. This is better than the file_get_contents() function. Of course, use base64_encode()You can also do this via curl, just you need a path to an image file and pass it to the function given below..

How to check for null in Twig?

Fluffy

[How to check for null in Twig?](https://stackoverflow.com/questions/3264889/how-to-check-for-null-in-twig)

What construct should I use to check whether a value is NULL in a Twig template?

2010-07-16 12:38:33Z

What construct should I use to check whether a value is NULL in a Twig template?Depending on what exactly you need:Additionally the is sameas test, which does a type strict comparison of two values, might be of interest for checking values other than null (like false):How to set default values in twig: http://twig.sensiolabs.org/doc/filters/default.htmlOr if you don't want it to display when null:Without any assumptions the answer is:But this will be true only if var is exactly NULL, and not any other value that evaluates to false (such as zero, empty string and empty array). Besides, it will cause an error if var is not defined. A safer way would be:which can be shortened to:If you don't provide an argument to the default filter, it assumes NULL (sort of default default). So the shortest and safest way (I know) to check whether a variable is empty (null, false, empty string/array, etc):I don't think you can. This is because if a variable is undefined (not set) in the twig template, it looks like NULL or none (in twig terms). I'm pretty sure this is to suppress bad access errors from occurring in the template.Due to the lack of a "identity" in Twig (===) this is the best you can doWhich translates to:Which if your good at your type juggling, means that things such as 0, '', FALSE, NULL, and an undefined var will also make that statement true.My suggest is to ask for the identity to be implemented into Twig.you can use the following code to check whetherYou can also use one line to do that:Also if your variable is an ARRAY, there are few options too:ORThis will only works if your array is defined AND is NULL

MySQL query to get column names?

Haroldo

[MySQL query to get column names?](https://stackoverflow.com/questions/4165195/mysql-query-to-get-column-names)

I'd like to get all of a mysql table's col names into an array in php?Is there a query for this? 

2010-11-12 13:42:23Z

I'd like to get all of a mysql table's col names into an array in php?Is there a query for this? The best way is to use the INFORMATION_SCHEMA metadata virtual database.  Specifically the INFORMATION_SCHEMA.COLUMNS table...It's VERY powerful, and can give you TONS of information without need to parse text (Such as column type, whether the column is nullable, max column size, character set, etc)...Oh, and it's standard SQL (Whereas SHOW ... is a MySQL specific extension)...For more information about the difference between SHOW... and using the INFORMATION_SCHEMA tables, check out the MySQL Documentation on INFORMATION_SCHEMA in general...You can use following query for MYSQL:Below is the example code which shows How to implement above syntax in php to list the names of columns: For Details about output of SHOW COLUMNS FROM TABLE visit: MySQL Refrence.Seems there are 2 ways:orMore on DESCRIBE here: http://dev.mysql.com/doc/refman/5.0/en/describe.htmlI have done this in the past.Edit: Today I learned the better way of doing this. Please see ircmaxell's answer.Parse the output of SHOW COLUMNS FROM table;Here's more about it here: http://dev.mysql.com/doc/refman/5.0/en/show-columns.htmlUse mysql_fetch_field() to view all column data.  See manual."Warning

This extension is deprecated as of PHP 5.5.0, and will be removed in the future."An old PHP function "mysql_list_fields()" is deprecated. So, today the best way to get names of fields is a query "SHOW COLUMNS FROM table_name [LIKE 'name']". So, here is a little example:when you want to check your all table structure with some filed then use this code. In this query i select column_name,column_type and table_name for more details . I use order by column_type so i can see it easily. If you want to check only double type filed then you can do it easily if you want to check which field allow null type etc then you can use this you want to check more then thik link also help you.https://dev.mysql.com/doc/refman/5.7/en/columns-table.htmlSHOW COLUMNS in mysql 5.1 (not 5.5) uses a temporary disk table.So it can be considered slow for some cases. At least, it can bump up your created_tmp_disk_tables value. Imagine one temporary disk table per connection or per each page request.SHOW COLUMNS is not really so slow, possibly because it uses file system cache. Phpmyadmin says ~0.5ms consistently. This is nothing compared to 500ms-1000ms of serving a wordpress page. But still, there are times it matters. There is a disk system involvement, you never know what happens when server is busy, cache is full, hdd is stalled etc.Retrieving column names through SELECT * FROM ... LIMIT 1 was around ~0.1ms, and it can use query cache as well.So here is my little optimized code to get column names from a table, without using show columns if possible:Notes:Not sure if this is what you were looking for, but this worked for me:That returns a simple array of the column names / variable names in your table or array as strings, which is what I needed to dynamically build MySQL queries. My frustration was that I simply don't know how to index arrays in PHP very well, so I wasn't sure what to do with the results from DESC or SHOW. Hope my answer is helpful to beginners like myself!To check result:  print_r($col_names);Try this one out I personally use it:IN WORDPRESS:This question is old, but I got here looking for a way to find a given query its field names in a dynamic way (not necessarily only the fields of a table). And since people keep pointing this as the answer for that given task in other related questions, I'm sharing the way I found it can be done, using Gavin Simpson's tips:This can be easily modded to insert the field names in an array.Using a simple: $sql="SELECT * FROM myTable LIMIT 1" can give you the fields of any table, without needing to use SHOW COLUMNS or any extra php module, if needed (removing the data dump part).Hopefully this helps someone else.if you use php, use this gist.it can get select fields full info with no result，and all custom fields such as:if above sql return no data,will also get the field names aname, bname, b's other field namejust two line:This query fetches a list of all columns in a database without having to specify a table name. It returns a list of only column names: However, when I ran this query in phpmyadmin, it displayed a series of errors. Nonetheless, it worked. So use it with caution. The simplest solution out of all Answers:ororif you only need the field names and types (perhaps for easy copy-pasting into Excel):remove if you want all data typesi no expert, but this works for me..I have tried this query in SQL Server and this worked for me :

Laravel 4 Eloquent Query Using WHERE with OR AND OR?

Farzher

[Laravel 4 Eloquent Query Using WHERE with OR AND OR?](https://stackoverflow.com/questions/16995102/laravel-4-eloquent-query-using-where-with-or-and-or)

How do I say WHERE (a = 1 OR b =1 ) AND (c = 1 OR d = 1)For more complicated queries am I supposed to use raw SQL?

2013-06-08 01:29:42Z

How do I say WHERE (a = 1 OR b =1 ) AND (c = 1 OR d = 1)For more complicated queries am I supposed to use raw SQL?Make use of Parameter Grouping (Laravel 4.2). For your example, it'd be something like this:If you want to use parameters for a,b,c,d in Laravel 4if you want to use parentheses in laravel 4 and don't forget return

In Laravel 4 (at least) you need to use $a, $b in parentheses as in the exampleThis is my result:

Incase you're looping the OR conditions, you don't need the the second $query->where from the other posts (actually I don't think you need in general, you can just use orWhere in the nested where if easier)$a, $b, $c, $d can be dynamic values by the querySimply Use in Laravel Eloquent:Will produce a query like:You can also use query scopes to make things a bit tidier, so you can do something like:Then in your model You can also query the first or condition and later you can apply another or conditionnow apply another condition on that $model variableAnother way without using Modal Database: stocks 

Columns:id,name,company_name,exchange_name,status

Best way to use sql brackets use callback function in laravel eloquent.Lest say if you have a query that contain brackets inside a bracketslest say you want to make values dynamics

Why check both isset() and !empty()

silow

[Why check both isset() and !empty()](https://stackoverflow.com/questions/4559925/why-check-both-isset-and-empty)

Is there a difference between isset and !empty. If I do this double boolean check, is it correct this way or redundant? and is there a shorter way to do the same thing?

2010-12-30 04:08:40Z

Is there a difference between isset and !empty. If I do this double boolean check, is it correct this way or redundant? and is there a shorter way to do the same thing?This is completely redundant. empty is more or less shorthand for !isset($foo) || !$foo, and !empty is analogous to isset($foo) && $foo. I.e. empty does the reverse thing of isset plus an additional check for the truthiness of a value.  Or in other words, empty is the same as !$foo, but doesn't throw warnings if the variable doesn't exist. That's the main point of this function: do a boolean comparison without worrying about the variable being set.The manual puts it like this:You can simply use !empty($vars[1]) here.isset() tests if a variable is set and not null:http://us.php.net/manual/en/function.isset.phpempty() can return true when the variable is set to certain values:http://us.php.net/manual/en/function.empty.phpTo demonstrate this, try the following code with $the_var unassigned, set to 0, and set to 1.The accepted answer is not correct.isset() is NOT equivalent to !empty().You will create some rather unpleasant and hard to debug bugs if you go down this route. e.g. try running this code:https://3v4l.org/J4nBbEmpty just check is the refered variable/array has an value if you check the php doc(empty) you'll see this things are considered emtpy while isset check if the variable isset and not null which can also be found in the php doc(isset) It is not necessary.php.net"Empty": only works on variables. Empty can mean different things for different variable types

(check manual: http://php.net/manual/en/function.empty.php)."isset": checks if the variable exists and checks for a true NULL or false value.

Can be unset by calling "unset". Once again, check the manual.Use of either one depends of the variable type you are using. I would say, it's safer to check for both, because you are checking first of all if the variable exists, and if it isn't really NULL or empty.if we use same page to add/edit via submit button like belowthen we should not use bcoz edit_id is set all the time whether it is add or edit page , instead  we should use  check below condition Returns FALSE if var has a non-empty and non-zero value.That’s a good thing to know. In other words, everything from NULL, to 0 to「」will return TRUE when using the empty() function.Returns TRUE if var exists; FALSE otherwise.In other words, only variables that don’t exist (or, variables with strictly NULL values) will return FALSE on the isset() function. All variables that have any type of value, whether it is 0, a blank text string, etc. will return TRUE.

Get the current script file name

Alex

[Get the current script file name](https://stackoverflow.com/questions/4221333/get-the-current-script-file-name)

If I have PHP script, how can I get the filename from inside that script?Also, given the name of a script of the form jquery.js.php, how can I extract just the "jquery.js" part?

2010-11-19 01:24:11Z

If I have PHP script, how can I get the filename from inside that script?Also, given the name of a script of the form jquery.js.php, how can I extract just the "jquery.js" part?Just use the PHP magic constant __FILE__ to get the current filename.But it seems you want the part without .php. So...A more generic file extension remover would look like this...Using standard string library functions is much quicker, as you'd expect.When you want your include to know what file it is in (ie. what script name was actually requested), use:Because when you are writing to a file you usually know its name.Edit: As noted by Alec Teal, if you use symlinks it will show the symlink name instead.See http://php.net/manual/en/function.pathinfo.phpHere is the difference between basename(__FILE__, ".php") and basename($_SERVER['REQUEST_URI'], ".php").basename(__FILE__, ".php") shows the name of the file where this code is included - It means that if you include this code in header.php and current page is index.php, it will return header not index.basename($_SERVER["REQUEST_URI"], ".php") - If you use include this code in header.php  and current page is index.php, it will return index not header.This might help:it will work even if you are using include.alex's answer is correct but you could also do this without regular expressions like so:Here is a list what I've found recently searching an answer:Don't forget to remove :)you can also use this:A more general way would be using pathinfo(). Since Version 5.2 it supports PATHINFO_FILENAME.Sowill also do what you need.$argv[0]I've found it much simpler to use $argv[0].  The name of the executing script is always the first element in the $argv array.  Unlike all other methods suggested in other answers, this method does not require the use of basename() to remove the directory tree.  For example:Try ThisThis works for me, even when run inside an included PHP file, and you want the filename of the current php file running:Result:__FILE__ use examples based on localhost server results:As some said basename($_SERVER["SCRIPT_FILENAME"], '.php') and basename( __FILE__, '.php') are good ways to test this. To me using the second was the solution for some validation instructions I was making

How do I read any request header in PHP

Sabya

[How do I read any request header in PHP](https://stackoverflow.com/questions/541430/how-do-i-read-any-request-header-in-php)

How should I read any header in PHP?For example the custom header: X-Requested-With.

2009-02-12 14:21:25Z

How should I read any header in PHP?For example the custom header: X-Requested-With.IF: you only need a single header, instead of all headers, the quickest method is:

ELSE IF: you run PHP as an Apache module or, as of PHP 5.4, using FastCGI (simple method):apache_request_headers()

ELSE: In any other case, you can use (userland implementation):

See Also:

getallheaders() - (PHP >= 5.4) cross platform edition Alias of apache_request_headers() 

apache_response_headers() - Fetch all HTTP response headers.

headers_list() - Fetch a list of headers to be sent.RFC3875, 4.1.18:You should find all HTTP headers in the $_SERVER global variable prefixed with HTTP_ uppercased and with dashes (-) replaced by underscores (_).For instance your X-Requested-With can be found in:It might be convenient to create an associative array from the $_SERVER variable. This can be done in several styles, but here's a function that outputs camelcased keys:Now just use $headers['XRequestedWith'] to retrieve the desired header.PHP manual on $_SERVER: http://php.net/manual/en/reserved.variables.server.phpSince PHP 5.4.0 you can use getallheaders function which returns all request headers as an associative array:Earlier this function worked only when PHP was running as an Apache/NSAPI module.strtolower is lacking in several of the proposed solutions, RFC2616 (HTTP/1.1) defines header fields as case-insensitive entities.  The whole thing, not just the value part.So suggestions like only parsing HTTP_ entries are wrong.Better would be like this:Notice the subtle differences with previous suggestions.  The function here also works on php-fpm (+nginx).Pass a header name to this function to get its value without using for loop. Returns null if header not found.Note: this works only with Apache server, see: http://php.net/manual/en/function.getallheaders.phpNote: this function will process and load all of the headers to the memory and it's less performant than a for loop.To make things simple, here is how you can get just the one you want:Simple:or when you need to get one at a time:The other headers are also in the super global array $_SERVER, you can read about how to get at them here: http://php.net/manual/en/reserved.variables.server.phpI was using CodeIgniter and used the code below to get it. May be useful for someone in future.Here's how I'm doing it. You need to get all headers if $header_name isn't passed:It looks a lot simpler to me than most of the examples given in other answers.  This also gets the method (GET/POST/etc.) and the URI requested when getting all of the headers which can be useful if you're trying to use it in logging.Here's the output:Here is an easy way to do it.This small PHP snippet can be helpful to you:I use this function to get the custom headers, if the header starts from "HTTP_X_" we push in the array :)if only one key is required to retrieved, For example "Host" address is required, then we can use So that we can avoid loops and put it inline to the echo outputsPHP 7: Null Coalesce OperatorThis work if you have an Apache serverPHP Code:Result:

Insert string at specified position

Alex

[Insert string at specified position](https://stackoverflow.com/questions/8251426/insert-string-at-specified-position)

Is there a PHP function that can do that?I'm using strpos to get the position of a substring and I want to insert a string after that position.

2011-11-24 02:01:38Z

Is there a PHP function that can do that?I'm using strpos to get the position of a substring and I want to insert a string after that position.http://php.net/substr_replacesubstr on PHP ManualTry it, it will work for any number of substringsUse the stringInsert function rather than the putinplace function. I was using the later function to parse a mysql query. Although the output looked alright, the query resulted in a error which took me a while to track down. The following is my version of the stringInsert function requiring only one parameter.I have one my old function for that:This is a small powerful function that performs its job flawlessly.This was my simple solution too append text to the next line after it found the keyword.Output:Just wanted to add something: I found tim cooper's answer very useful, I used it to make a method which accepts an array of positions and does the insert on all of them so here that is:EDIT: Looks like my old function assumed $insertstr was only 1 character and that the array was sorted. This works for arbitrary character length.Simple and another way to solve :Strange answers here! You can insert strings into other strings easily with sprintf [link to documentation]. The function is extremely powerful and can handle multiple elements and other data types too.gives you the string

Are arrays in PHP passed by value or by reference?

Frank

[Are arrays in PHP passed by value or by reference?](https://stackoverflow.com/questions/2030906/are-arrays-in-php-passed-by-value-or-by-reference)

When an array is passed as an argument to a method or function is it passed by reference?What about doing this:Is $b a reference to $a?

2010-01-08 21:32:24Z

When an array is passed as an argument to a method or function is it passed by reference?What about doing this:Is $b a reference to $a?For the second part of your question, see the array page of the manual, which states (quoting) :And the given example :

For the first part, the best way to be sure is to try ;-)Consider this example of code :It'll give this output :Which indicates the function has not modified the "outside" array that was passed as a parameter : it's passed as a copy, and not a reference.If you want it passed by reference, you'll have to modify the function, this way :And the output will become :As, this time, the array has been passed "by reference".

Don't hesitate to read the References Explained section of the manual : it should answer some of your questions ;-)With regards to your first question, the array is passed by reference UNLESS it is modified within the method / function you're calling. If you attempt to modify the array within the method / function, a copy of it is made first, and then only the copy is modified. This makes it seem as if the array is passed by value when in actual fact it isn't.For example, in this first case, even though you aren't defining your function to accept $my_array by reference (by using the & character in the parameter definition), it still gets passed by reference (ie: you don't waste memory with an unnecessary copy).However if you modify the array, a copy of it is made first (which uses more memory but leaves your original array unaffected).FYI - this is known as "lazy copy" or "copy-on-write".a) the method/function only reads the array argument => implicit (internal) reference

b) the method/function modifies the array argument  => value

